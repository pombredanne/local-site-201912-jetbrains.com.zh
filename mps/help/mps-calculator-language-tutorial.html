<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>MPS计算器语言教程-帮助|帮助MPS</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="MPS_Calculator_Language_Tutorial"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索MPS帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected="">默认</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_mac_os_x" data-group="primary">Eclipse（Mac OS X）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_mac_os_x" data-group="primary">Mac OS X</option><option value="primary_mac_os_x_10.5_" data-group="primary">Mac OS X 10.5以上</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="secondary_default" data-group="secondary">默认</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_jbuilder" data-group="secondary">JBuilder的</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">Mac OS X 10.5以上</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 id="MPS_Calculator_Language_Tutorial.xml" data-toc="MPS_Calculator_Language_Tutorial">MPS计算器语言教程</h1>    <p id="e80b32d3">在本教程中</p>    <ul data-skip-index="skip"><li class="list__item"><a href="#ed68b466">介绍</a></li><li class="list__item"><a href="#6007bd2d">实施模板</a></li></ul>    <h3 id="ed68b466">介绍</h3>    <p id="21095b5b">本教程将指导MPS语言设计的许多领域。您将定义一种简单的独立语言的抽象结构，为它们设计设计器，约束类型，范围，最后准备一个生成Java代码的生成器。根据您之前对MPS的了解，本教程可能需要大约一天的时间才能完成。本教程主要针对语言设计师，他们需要评估MPS，并且希望看到的不只是一个简单的例子。Java的基础知识将帮助您更轻松地完成生成器。</p>    <h4 id="daf64d06">先决条件</h4>    <p id="a4d05018">经验表明，如果您希望在本教程中避免不必要的毛刺，则需要熟悉MPS投影编辑器。如果您遵循<a href="fast-track-to-mps.html">了MPS的快速入门教程</a> ，那么您已经做好了充分的准备。如果没有，请立即执行。<br>它将指导您完成MPS和投影编辑的基础知识，逐步以可消化的块形式为您提供新信息，以便最终回到本计算器教程时，您将有充分的知识从该教程中受益。</p>    <h4 id="Our_goal">我们的目标</h4>    <p id="f3f1ccc3">在本教程中，我们将创建一种计算器语言。该语言将定义几个描述某种计算的简单实体。我们称这些实体为<i id="fa9cc366">计算器</i> 。计算器具有一组输入和输出值，此外，它还定义了一个或多个数学公式，以使用可用的输入值来计算输出值。</p>    <p id="6e35bd54">我们使用一个人工的用例：一个Java / PHP <i id="034fcd0a">开发人员</i> ，她想通过简单地输入在Java和PHP项目上花费的小时数来快速计算自己的收入。生成的应用程序将如下所示（ <b id="7e363571">输出</b>值是根据小时值自动计算的）：</p>    <figure><img alt="image001" title="image001" src="/help/img/idea/2019.2/image001.png" id="e2536af6" width="245" height="146"></figure>    <p id="25accbb8">我们的目标是通过仅编写以下4行代码（“ 10”和“ 5”只是表示Java和PHP的相应付款率的常量），使我们的<i id="1a6d6b6d">开发人员</i>可以创建这样的应用程序：</p>    <code class="code">计算器MySalary输入PHP Hours输入Java Hours输出Java Hours * 10 + PHP Hours * 5</code>    <p id="1ebbf859">整个基于Swing的应用程序将从这四行DSL代码生成。</p>    <aside class="note " rel="1ebbf859" id="7cdff545" data-title="">        <p id="64d8fba4">您也可以观看本教程的屏幕录像。<a href="https://www.youtube.com/watch?v=T1RErEvbgRc" rel="noopener noreferrer" data-external="true" target="_blank">第1集</a>涵盖了教程的核心，而<a href="https://www.youtube.com/watch?v=SOUrdcvUOtA" rel="noopener noreferrer" data-external="true" target="_blank">第2集</a>着重于约束和类型系统定义。</p>    </aside>        <h4 id="Major_Steps">主要步骤</h4>    <p id="c6824af7">在本教程中，我们：</p>    <ul class="list _ul"><li class="list__item" id="13a2249d"><p>创建一种允许我们使用前面提到的语法实现计算器的语言。我们的语言将定义构成计算器的基本逻辑概念，其构造规范，关系和个人行为。</p></li><li class="list__item" id="4e711236"><p>创建一个生成器，该生成器将定义用于从计算器构建挥杆应用程序的规则。</p></li><li class="list__item" id="88e54046"><p>用我们的语言实现计算器。</p></li></ul>    <aside class="note " rel="d6576776" id="89ec18ca" data-title="">        <p id="2aa2baab">对于这样一个简单的应用程序，似乎语言创建需要花费很多精力。显然，可以使用任何现有语言来创建它，而使用MPS则要快得多。但是，我们的目标是演示当您需要一个非常具体的功能（应该多次重新实现）时，MPS如何提供帮助。它还显示了当人们使用适当的语言执行特定任务时，如何进行简单直接的开发。在我们的例子中，只知道如何编写简单表达式的人可以创建这样的计算器，而无需知道如何使用Swing。</p>    </aside>    <h4 id="Creating_a_project">建立专案</h4>    <p id="d40f53b0">MPS中的项目可能由语言，解决方案或两者组成。再进一步，您将了解其结构。</p>    <p id="b4bd5e88">首先，我们开始MPS。</p>    <p id="c1beb1aa">您会看到带有不同选项的欢迎屏幕：您可以从此处快速打开示例，开始浏览文档等。</p>    <p id="d59553da">由于我们要创建一种新的语言，因此我们需要首先创建一个新项目。</p>    <p id="f0012d7a">单击<b id="ffe9efae">文件|新项目</b> 。向导出现：</p>    <figure><img alt="image002" title="image002" src="/help/img/idea/2019.2/image002.png" id="d5286e19" width="736" height="605"></figure>    <p id="ad685bc2">让我们将项目命名为“计算器”：</p>    <figure><img alt="image003" title="image003" src="/help/img/idea/2019.2/image003.png" id="86a8d5b6" width="736" height="605"></figure>    <p id="2f6b939b">现在，我们需要命名我们要创建的语言（DSL）：</p>    <figure><img alt="image004" title="image004" src="/help/img/idea/2019.2/image004.png" id="d0e56610" width="736" height="605"></figure>    <p id="6e6b70e7">我们建议您使用以下命名约定。此约定类似于Java包所使用的约定： <i id="0f98e691">companyName</i> 。 <i id="0f98e691">含义ful.name</i> 。因此，让我们将语言<i id="00e765dd">命名为jetbrains.mps.tutorial.calculator</i> 。</p>    <p id="764051fd">此外，选中“ <i id="33fb200d">创建沙箱解决方案”</i>复选框。解决方案是用指定语言编写的一组模型。我们将立即使用该解决方案来测试我们新创建的语言。</p>    <p id="abaf3451">理想情况下，您将有单独的语言项目和使用这些语言的解决方案。但是，我们建议您的项目包含针对所开发语言的“沙盒”解决方案，以便您可以通过编写示例应用程序立即测试新语言。</p>    <p id="04a856da">现在是时候按<b id="0c6f8dfe">OK了</b> 。</p>    <p id="afbcc9b8">在打开的“ <b id="a7b11c86">项目视图”</b>中，展开标记有<i id="3145d0e1">语言</i>符号的<b id="bcb1a855"><i id="d05b06f1">jetbrains.mps.tutorial.calculator</i></b>树节点（ <img alt="image007" title="image007" src="/help/img/idea/2019.2/image007.gif" id="cb635c65" width="16" height="16" class="inline-icon-16"> ）：</p>    <figure><img alt="image007 1" title="image007 1" src="/help/img/idea/2019.2/image007_1.png" id="12037f17" width="1186" height="746"></figure>    <p id="6f5182ac">其上方带有“ S”标记的树节点（ <img alt="image009" title="image009" src="/help/img/idea/2019.2/image009.gif" id="2e441e4d" width="16" height="16" class="inline-icon-16"> ）代表我们的解决方案，而“ <b id="4c84150e"><i id="0102d560">模块池”</i></b>节点（ <img alt="image010" title="image010" src="/help/img/idea/2019.2/image010.gif" id="19a18a5f" width="16" height="16" class="inline-icon-16"> ）包含所有可用语言和解决方案的集合，供您参考。我们将在以后的章节中仔细研究这些项目。</p>        <p id="06974281">让我们首先探讨<i id="51b99cee">语言</i>节点的结构。这也将帮助我们了解MPS背后的基本思想。</p>    <p id="70aa525e">我们看到该语言的子节点标有“ M”菱形图标。它们被称为<i id="ea17ef14">方面模型</i> 。与其他通常将程序存储在文本文件中的语言不同，在MPS中，它们存储在模型中。每个模型代表一棵<i id="39f5a233">节点</i>树，其中每个节点可以具有父节点，子节点，属性和对其他节点的引用。每个节点由其<i id="00655cbf">概念</i>定义。</p>    <aside class="note " rel="70aa525e" id="7900f7dd" data-title="">        <p id="7f40b667">            <i id="b3326c23">概念</i>是MPS中的基本术语，是其主要结构要素之一。</p>    </aside>    <p id="94fc55a2">包含我们语言的方面模型描述了语言的不同特征（它们的图标因颜色而异）。现在，我们考虑我们的语言将需要的4个基本方面模型：</p>    <ul class="list _ul"><li class="list__item" id="01808844"><p>            <i id="f027bd37">结构</i> -描述语言的语法</p></li><li class="list__item" id="2d5b6ba9"><p>            <i id="3b6739cb">编辑器</i> -描述用该语言编写的模型在编辑器中的外观</p></li><li class="list__item" id="f9e26892"><p>            <i id="e991ac99">约束</i> -描述类似哪个名称适合节点，变量引用可以指向哪个变量等内容。</p></li><li class="list__item" id="4352db54"><p>            <i id="a6bed3ed">类型系统</i> -描述如何计算节点类型</p></li></ul>    <h4 id="Calculator_concept">计算器概念</h4>    <p id="528cffb1">让我们开始研究我们的语言。</p>    <p id="ad3c2b29">首先，我们需要在案例<i id="9e46140a">计算器中</i>创建一个顶级概念。此概念的每个实例将包含输入和输出字段。</p>    <p id="2973dde8">要创建概念，请右键单击<b id="4b861e92"><i id="9dd0190a">结构</i></b>方面模型，然后选择“ <b id="b817a2b1">新建” |“新建”。概念</b> ：</p>    <figure><img alt="image008" title="image008" src="/help/img/idea/2019.2/image008.png" id="4f15fd39" width="1076" height="701"></figure>    <p id="78df1774">概念声明在编辑器中打开：</p>    <img alt="image009" title="image009" src="/help/img/idea/2019.2/image009.gif" id="1c0f1159" width="16" height="16" class="inline-icon-16">    <p id="ce07d15e">概念声明定义节点的类并指定该类中节点的结构。</p>    <aside class="note " rel="ce07d15e" id="dec0299a" data-title="">        <p id="b6155194">如果您使用过XML模式或DTD，那么它可以作为一个很好的类比来帮助您了解MPS中定义节点概念及其各个元素所使用的方法。</p>        <p id="a51ae015">可以用面向对象的语言对对象和类进行有限的类比。就像类通过字段，方法和其他成员声明其实例的结构一样，概念通过属性，引用和子级声明来指定其实例的结构。</p>    </aside>    <aside class="note " rel="MPS_Calculator_Language_Tutorial.xml" id="74d51f31" data-title="">        <p id="133058ab">与仅在运行时存在而在程序代码中不存在的对象不同，节点实例在设计时存在（因为正在编辑程序）。程序源代码由节点实例组成。</p>    </aside>    <br>    <p id="b1675134">节点可以具有以下元素，这些元素在概念声明的相应部分中定义：</p>    <ul class="list _ul"><li class="list__item" id="7f0c24f6"><p>            <b id="6e6743e0">属性</b>将原始值存储在节点内。例如，您可以将节点的名称定义为属性。</p></li><li class="list__item" id="89e34c6a"><p>            <b id="2577ad37">引用</b>存储到其他节点的链接。例如，我们可以使用它们来存储对局部变量的引用。</p></li><li class="list__item" id="e209f3b4"><p>            <b id="41677b10">子</b>节点存储聚合的节点，即物理上包含在当前节点内的节点。例如，方法声明汇总其返回类型和参数。在我们的例子中，这些将是输入和输出字段。</p></li><li class="list__item" id="b8f3e4bd"><p>            <b id="61af144e">其他部分</b>相当高级，我们将不在本教程中讨论。您可以在《 MPS用户指南》中阅读有关它们的信息。</p></li></ul>    <p id="0543ee85">概念声明形成继承层次结构。默认情况下，每个概念都会扩展<i id="0f291ab7">BaseConcept</i>概念（您可以在extend关键字之后立即看到它）。但是，您可以根据需要指定另一个直接父级。如果一个概念扩展了另一个概念，则它将继承其父代的所有属性，子代和引用。</p>    <aside class="note " rel="0543ee85" id="d3a72488" data-title="">        <p id="e0e73019">要在编辑器中编辑元素，请将插入符号放置在其占位符处，并用灰色<b id="078bbb5d"><i id="d1a3fe89">&lt;&gt;</i></b>符号包围。要在占位符之间快速导航，请按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Tab / Shift + Tab</span></kbd> 。</p>        <p id="01150ce2">在占位符内时，请不要忘记使用<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space</span></kbd> ，因为在大多数情况下，MPS会列出自动完成的相关建议。</p>        <p id="7e0d792a">            <kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space</span></kbd>几乎适用于MPS编辑器中的所有位置。如果您只是想知道可以在特定位置输入什么，只需按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space即可</span></kbd> 。可能的选项将显示在完成菜单中。您可以考虑查看<a href="https://www.youtube.com/watch?v=zlVA60NhzWE" rel="noopener noreferrer" data-external="true" target="_blank">介绍性的屏幕</a>广播，其中<a href="https://www.youtube.com/watch?v=zlVA60NhzWE" rel="noopener noreferrer" data-external="true" target="_blank">介绍</a>了使用MPS投影编辑器的基本原理。</p>    </aside>    <br>    <p id="7c738e10">因此，我们将概念命名为<i id="6417ed50">Calculator</i> 。</p>    <p id="d2db8cfd">按<kbd data-primary_default="Tab" data-primary_default_for_gnome="Tab" data-primary_default_for_kde="Tab" data-primary_default_for_xwin="Tab" data-primary_eclipse="Tab" data-primary_eclipse_mac_os_x="Tab" data-primary_emacs="Tab" data-primary_jbuilder="Tab" data-primary_mac_os_x="Tab" data-primary_mac_os_x_10.5_="Tab" data-primary_netbeans="Tab" data-primary_visual_studio="Tab" data-secondary_default="⇥" data-secondary_default_for_gnome="⇥" data-secondary_default_for_kde="⇥" data-secondary_default_for_xwin="⇥" data-secondary_eclipse="⇥" data-secondary_eclipse_mac_os_x="⇥" data-secondary_emacs="⇥" data-secondary_jbuilder="⇥" data-secondary_mac_os_x="⇥" data-secondary_mac_os_x_10.5_="⇥" data-secondary_netbeans="⇥" data-secondary_visual_studio="⇥">Tab</kbd>直到进入“实例可以是根”占位符，然后按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space</span></kbd>将其值设置为<b id="f98399ff">true</b> 。您也可以直接输入true，而不必在任何地方都按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space</span></kbd> 。这将使我们能够通过<b id="ee563c38">Project View中</b>的<b id="ef9c9cd9">Create Root Node</b>菜单项创建Calculator实例（正确的方法如我们对Calculator概念本身所做的那样）：</p>    <img alt="image010" title="image010" src="/help/img/idea/2019.2/image010.gif" id="427adf91" width="16" height="16" class="inline-icon-16">    <p id="969b5153">我们将进一步需要按名称引用我们的计算器。我们可以在其中创建一个属性<i id="6d03da94">名称</i> ；但是，有更好的方法（和推荐的做法）。我们必须使我们的概念实现<i id="affc2d8b">INamedConcept</i>接口。此概念界面仅包含一个属性<i id="a7bb6019">-name</i> 。MPS IDE知道此接口，并为实现该接口的概念提供了更高级的支持。例如，如果要创建对<i id="5e0b9842"><u id="240bdbce">INamedConcept</u></i>的引用，则它们的名称将显示在完成菜单中；或者在<b id="59b2ce56">Project View中浏览</b>节点时，您将在树中看到<i id="16c3b1cd">INamedConcept</i>的名称。</p>    <p id="758c4de1">将插入号放置在Implements关键字之后的<b id="2ddea902"><i id="a8cdbfde">&lt;none&gt;</i></b>占位符上，然后按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space</span></kbd> （有关有效使用编辑器的更多详细信息，请参见<a href="#Appendix_A">附录A</a> ）：</p>    <img alt="image011" title="image011" src="/help/img/idea/2019.2/image011.gif" id="3a612132" width="16" height="16" class="inline-icon-16">    <p id="c6c03f77">选择<i id="2ab96f2d">INamedConcept</i> ，然后按<kbd data-primary_default="Enter" data-primary_default_for_gnome="Enter" data-primary_default_for_kde="Enter" data-primary_default_for_xwin="Enter" data-primary_eclipse="Enter" data-primary_eclipse_mac_os_x="Enter" data-primary_emacs="Enter" data-primary_jbuilder="Enter" data-primary_mac_os_x="Enter" data-primary_mac_os_x_10.5_="Enter" data-primary_netbeans="Enter" data-primary_visual_studio="Enter" data-secondary_default="⏎" data-secondary_default_for_gnome="⏎" data-secondary_default_for_kde="⏎" data-secondary_default_for_xwin="⏎" data-secondary_eclipse="⏎" data-secondary_eclipse_mac_os_x="⏎" data-secondary_emacs="⏎" data-secondary_jbuilder="⏎" data-secondary_mac_os_x="⏎" data-secondary_mac_os_x_10.5_="⏎" data-secondary_netbeans="⏎" data-secondary_visual_studio="⏎">Enter</kbd> ：</p>    <figure><img alt="image012" title="image012" src="/help/img/idea/2019.2/image012.png" id="16415592" width="1186" height="746"></figure>    <p id="3b9be583">我们为节点定义了语法。现在我们需要定义它的各个方面。让我们创建一个编辑器。</p>    <h4 id="Creating_an_editor_for_Calculator">为计算器创建编辑器</h4>    <p id="b7fdc210">MPS编辑器看起来像一个文本编辑器，但并非完全一样。它是一种结构编辑器，可直接与语法树配合使用。</p>    <p id="bc8e1030">您可能想知道为什么几乎所有现有语言都是基于文本的人为什么要使用结构编辑器。在我们要扩展它们之前，基于文本的语言才是好的。基于文本的语言通常具有解析器。为了使解析具有确定性，应仔细设计语法，这在使用语言扩展的情况下几乎是不可能的。如果扩展语言，则应该扩展其语法，但是由于我们不知道其他扩展可能会做什么，因此无法确定该语法是否足够。考虑两种语言扩展，它们增加了对Java的货币价值支持。他们两个都将添加money关键字。当我们解析使用这两种语言扩展的代码时，我们不知道如何解释money关键字。应该从第一种语言还是从第二种语言将其解释为关键字？在结构编辑器的情况下，将程序直接存储为语法树而无需中间文本表示，就没有这种问题。</p>    <p id="f78f7e8e">MPS中的结构编辑器使用单元表示节点。像节点一样，单元形成一棵树。单元格有几种类型：</p>    <ul class="list _ul"><li class="list__item" id="6f28c759"><p>            <b id="f614ce6c">属性单元格</b>用于编辑节点的属性</p></li><li class="list__item" id="43a640e9"><p>            <b id="44404f27">常数单元格</b>始终显示相同的值</p></li><li class="list__item" id="9086ce3c"><p>            <b id="23bd3fa0">收集单元</b>用于布置其中的其他单元</p></li></ul>    <p id="ebeeb606">我们希望计算器的编辑器如下所示：</p>    <p id="4ebd1c71">        <b id="85308c46">计算器</b>名称</p>    <p id="d2d2473f">为了实现这样的设计，我们执行以下操作（使用<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space</span></kbd>保持）：</p>    <ul class="list _ul"><li class="list__item" id="9c3c312b"><p>创建一个缩进收集单元。缩进集合布局单元格文本方式类似。</p></li><li class="list__item" id="132065ee"><p>在集合内部创建一个常量单元格和属性单元格。</p></li></ul>    <p id="cd68265d">要为计算器概念定义新的编辑器，您必须在<b id="897e8abd">编辑器</b>选项卡的底行中选择“ <b id="897e8abd">编辑器”</b>选项卡-由于尚未为此概念定义编辑器方面，因此将显示带有<b id="b592b1aa">无编辑器</b>标签的空白选项卡。您可以单击此空白编辑器窗格，然后从帮助菜单中选择<b id="9bb0393c">概念编辑器</b> 。</p>    <figure><img alt="image012 1" title="image012 1" src="/help/img/idea/2019.2/image012_1.png" id="23afa47d" width="1076" height="635"></figure>    <p id="e54d2bf1">创建一个新的编辑器</p>    <figure><img alt="image013" title="image013" src="/help/img/idea/2019.2/image013.png" id="ad41d216" width="1186" height="746"></figure>    <p id="3e7ea13b">让我们创建一个根缩进收集单元。按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space</span></kbd>并在其中选择[-：</p>    <figure><img alt="image014" title="image014" src="/help/img/idea/2019.2/image014.png" id="fba42892" width="1075" height="635"></figure>    <p id="f6424ee7">现在，让我们创建一个常量单元格：</p>    <figure><img alt="image015" title="image015" src="/help/img/idea/2019.2/image015.png" id="faa6d5ae" width="1076" height="636"></figure>    <p id="eb80ee0f">并在其中输入<i id="8b4e5aa3">计算器</i> ：</p>    <figure><img alt="image016" title="image016" src="/help/img/idea/2019.2/image016.png" id="a50f3ff9" width="1186" height="746"></figure>    <p id="c57d4292">如果键入：“ calculator，则可以一步输入此常数。<b id="8134c5af">“</b>符号将使细胞恒定的单元。</p>    <p id="038373a6">现在，我们需要一个用于<i id="328d1e8b">名称</i>属性的属性单元格（来自<i id="2d70f882">INamedConcept</i>概念界面）。要在水平列表的末尾插入另一个单元格，请在计算器字末尾按<kbd data-primary_default="Enter" data-primary_default_for_gnome="Enter" data-primary_default_for_kde="Enter" data-primary_default_for_xwin="Enter" data-primary_eclipse="Enter" data-primary_eclipse_mac_os_x="Enter" data-primary_emacs="Enter" data-primary_jbuilder="Enter" data-primary_mac_os_x="Enter" data-primary_mac_os_x_10.5_="Enter" data-primary_netbeans="Enter" data-primary_visual_studio="Enter" data-secondary_default="⏎" data-secondary_default_for_gnome="⏎" data-secondary_default_for_kde="⏎" data-secondary_default_for_xwin="⏎" data-secondary_eclipse="⏎" data-secondary_eclipse_mac_os_x="⏎" data-secondary_emacs="⏎" data-secondary_jbuilder="⏎" data-secondary_mac_os_x="⏎" data-secondary_mac_os_x_10.5_="⏎" data-secondary_netbeans="⏎" data-secondary_visual_studio="⏎">Enter</kbd> ，然后选择<b id="677b88cb"><i id="aebd45ce">{name}</i></b>作为结束：</p>    <figure><img alt="image017" title="image017" src="/help/img/idea/2019.2/image017.png" id="425cc0d9" width="1209" height="635"></figure>    <p id="d365357e">现在，在定义了基础知识之后，我们可以构建语言并尝试创建其概念的实例。要构建语言， <b id="3c5c52df">请</b>从<b id="5f03370e">项目视图的</b>我们的语言弹出菜单中选择“ <b id="3c5c52df">制作语言”</b>操作。</p>    <aside class="note " rel="d365357e" id="026c728e" data-title="">        <p id="f7d13d57">讲一种语言</p>        <p id="d75211c6">实施语言更改后，需要“制作”语言以使更改生效。请记住，将来在尝试在程序中使用更新的语言之前，使用弹出菜单中的“ Make Language” /“ Rebuild Language”命令运行“ make”或完整的“ rebuild”命令。</p>    </aside>    <figure><img alt="image018" title="image018" src="/help/img/idea/2019.2/image018.png" id="b8734a0a" width="1077" height="636"></figure>    <p id="2b73017f">代码已生成，因此您可以在MPS模型中创建和编辑此概念的实例。在最初的项目创建过程中，MPS可能已经为您创建了一个空的解决方案模型。如果由于某种原因您没有模型，我们现在可以在<i id="5fe3fde2">jetbrains.mps.tutorial.calculator.sandbox中</i>创建一个新的MPS模型：右键单击项目树中的sandbox节点，然后选择<i id="405d9bc2">New |</i>从弹出菜单中进行<i id="405d9bc2">建模</i> 。</p>    <figure><img alt="image018 1" title="image018 1" src="/help/img/idea/2019.2/image018_1.png" id="6409c808" width="1073" height="635"></figure>    <p id="2dd3dd9f">在“新模型”对话框的“ <b id="860db50f">模型名称”</b>字段中，键入<b id="a839e90f">jetbrains.mps.tutorial.calculator.sandbox</b> 。</p>    <figure><img alt="image018 2" title="image018 2" src="/help/img/idea/2019.2/image018_2.png" id="bcd34dd0" width="777" height="348"></figure>    <p id="ea40a52a">然后按<b id="c69fef9b">确定</b>按钮。为了在该模型中使用<b id="44b019d8">jetbrains.mps.tutorial.calculator</b>语言，您必须通过在显示的“ <b id="a79ffb20">模型属性”</b>对话框的“ <b id="66d76648">使用的语言”</b>部分中按<b id="6a3f141e">+</b>按钮并选择jetbrains.mps.tutorial.calculator语言来导入它：</p>    <figure><img alt="image018 3" title="image018 3" src="/help/img/idea/2019.2/image018_3.png" id="2094f6d8" width="948" height="428"></figure>    <p id="6444071f">现在，您可以在“ <b id="4a1b16dc">模型属性”</b>对话框中按“ <b id="0d423ca5">确定</b> ”以最终创建一个沙箱模型并在那里开始使用Calculator实例。</p>    <h4 id="Define_your_first_calculator">定义您的第一个计算器</h4>    <p id="a5c0db53">单击沙盒模型，然后从“新建”菜单中选择“计算器”：</p>    <figure><img alt="image019" title="image019" src="/help/img/idea/2019.2/image019.png" id="62a3111a" width="1075" height="673"></figure>    <p id="5f2d8c72">您将有一个简单的计算器，可以在其中输入名称：</p>    <figure><img alt="image020" title="image020" src="/help/img/idea/2019.2/image020.png" id="49c2e1a9" width="1186" height="746"></figure>    <p id="a0b671fe">在属性单元格中键入名称。对于我们的示例，我们使用<i id="51a4da10">MyCalc</i>名称。</p>    <p id="919b50e8">如您所见，计算器的编辑器与我们在<i id="7e217f31">编辑器</i>方面编写的非常相似。</p>    <h4 id="Input_Fields">输入栏位</h4>    <p id="09f5308b">现在让我们为输入字段创建概念。该字段将实现<i id="b08a4e15">INamedConcept，</i>因为我们要在输出字段中引用它。我们需要它，因为当我们引用一个节点时，我们需要在完成菜单中看到它。如果使用<i id="75a2ea7c">INamedConcept</i>实例，则它们的名称会正确显示，因为MPS可以了解这些实例的名称。当然可以引用<i id="4320a41d">INamedConcept</i>以外的概念，但是<i id="6a838df7">INamedConcept</i>是最简单的方法。</p>    <figure><img alt="image021" title="image021" src="/help/img/idea/2019.2/image021.png" id="6f9aa3f4" width="1186" height="746"></figure>    <p id="9240b9f9">让我们为其创建一个编辑器：</p>    <figure><img alt="image022" title="image022" src="/help/img/idea/2019.2/image022.png" id="99b6e3ad" width="1186" height="746"></figure>    <p id="7fec0319">为了使计算器包含输入字段，我们需要稍微调整其结构和编辑器。让我们为输入计算器创建InputField类型的子代，其基数为0..n。为此，请在儿童部分插入一个插入符号，然后按<kbd data-primary_default="Enter" data-primary_default_for_gnome="Enter" data-primary_default_for_kde="Enter" data-primary_default_for_xwin="Enter" data-primary_eclipse="Enter" data-primary_eclipse_mac_os_x="Enter" data-primary_emacs="Enter" data-primary_jbuilder="Enter" data-primary_mac_os_x="Enter" data-primary_mac_os_x_10.5_="Enter" data-primary_netbeans="Enter" data-primary_visual_studio="Enter" data-secondary_default="⏎" data-secondary_default_for_gnome="⏎" data-secondary_default_for_kde="⏎" data-secondary_default_for_xwin="⏎" data-secondary_eclipse="⏎" data-secondary_eclipse_mac_os_x="⏎" data-secondary_emacs="⏎" data-secondary_jbuilder="⏎" data-secondary_mac_os_x="⏎" data-secondary_mac_os_x_10.5_="⏎" data-secondary_netbeans="⏎" data-secondary_visual_studio="⏎">Enter</kbd>或<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Insert</span></kbd> 。之后，将InputField指定为目标Concept，将子名称设置为inputField，并将基数设置为0..n：</p>    <figure><img alt="image023" title="image023" src="/help/img/idea/2019.2/image023.png" id="7967a056" width="1186" height="746"></figure>    <p id="7496d3fd">现在，我们在名称单元格中添加新行。将光标放在名称单元上时，将出现一个灯泡。可以用灯泡调用的动作称为<i id="f1d60dcc">意图</i> 。他们中有很多使用不同的语言。如果您不知道如何输入内容，则除了按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space之外，</span></kbd>还可以按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Alt + Enter</span></kbd>并使用相应的意图。现在按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Alt + Enter</span></kbd>并应用“ <i id="b3becf89">添加新行”</i>意图。</p>    <figure><img alt="image024" title="image024" src="/help/img/idea/2019.2/image024.png" id="ccef95a5" width="1073" height="633"></figure>    <p id="dbd8c7c4">现在我们要在编辑器中显示输入字段的垂直列表。在{name}标签末尾按<kbd data-primary_default="Enter" data-primary_default_for_gnome="Enter" data-primary_default_for_kde="Enter" data-primary_default_for_xwin="Enter" data-primary_eclipse="Enter" data-primary_eclipse_mac_os_x="Enter" data-primary_emacs="Enter" data-primary_jbuilder="Enter" data-primary_mac_os_x="Enter" data-primary_mac_os_x_10.5_="Enter" data-primary_netbeans="Enter" data-primary_visual_studio="Enter" data-secondary_default="⏎" data-secondary_default_for_gnome="⏎" data-secondary_default_for_kde="⏎" data-secondary_default_for_xwin="⏎" data-secondary_eclipse="⏎" data-secondary_eclipse_mac_os_x="⏎" data-secondary_emacs="⏎" data-secondary_jbuilder="⏎" data-secondary_mac_os_x="⏎" data-secondary_mac_os_x_10.5_="⏎" data-secondary_netbeans="⏎" data-secondary_visual_studio="⏎">Enter</kbd> ，然后按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space</span></kbd> 。在此处选择％inputField％：</p>    <figure><img alt="image025" title="image025" src="/help/img/idea/2019.2/image025.png" id="e2f7e27d" width="1156" height="637"></figure>    <p id="15b97149">我们希望输入字段垂直放置。因此，应在每个单元格之后添加新行。可以有意地做到这一点：按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Alt + Enter</span></kbd>并选择<i id="49f9bf38">为儿童添加新行</i> 。</p>    <figure><img alt="image026" title="image026" src="/help/img/idea/2019.2/image026.png" id="c314ebe5" width="1074" height="633"></figure>    <p id="0edc2b7b">现在，让我们使用左侧“ <i id="5873cbc5">项目视图”</i>面板中“ <i id="8ee54fd7">语言”</i>节点上的弹出菜单来设置<i id="8ee54fd7">语言</i> （您也可以按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl / Cmd + F9</span></kbd>来完成此操作），然后看一下我们的沙箱：</p>    <figure><img alt="image027" title="image027" src="/help/img/idea/2019.2/image027.png" id="abd3f358" width="1186" height="746"></figure>    <p id="68221651">编辑器已更新。现在，我们在该行下方的单元格中有了一个名称，可以在其中添加新的输入字段。让我们添加几个输入字段：</p>    <figure><img alt="image028" title="image028" src="/help/img/idea/2019.2/image028.png" id="7c8c4064" width="1186" height="746"></figure>    <h4 id="Output_fields">输出栏位</h4>    <p id="16854988">让我们为输出字段创建一个概念。它不需要包含属性名称，因为我们只想在输入字段中引用值（与实现INamedConcept的InputField比较）：</p>    <figure><img alt="image029" title="image029" src="/help/img/idea/2019.2/image029.png" id="e1175794" width="1186" height="746"></figure>    <p id="9e0ea03c">让我们为其创建一个编辑器：</p>    <figure><img alt="image030" title="image030" src="/help/img/idea/2019.2/image030.png" id="1948dab7" width="1186" height="746"></figure>    <p id="fa29bc0b">让我们向计算器概念添加一个OutputField类型的子代：</p>    <figure><img alt="image031" title="image031" src="/help/img/idea/2019.2/image031.png" id="01025374" width="1186" height="746"></figure>    <p id="2bbab225">现在，我们更改其编辑器。您可以在此处使用复制/粘贴；使用<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl +向上/向下</span></kbd>选择单元格，然后<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">按Ctrl + C / V</span></kbd>复制/粘贴。为了在％inputField％集合之后粘贴节点，请在右括号“-）”上按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + V。</span></kbd>将inputField替换为outputField。</p>    <figure><img alt="image032" title="image032" src="/help/img/idea/2019.2/image032.png" id="8754255b" width="1186" height="746"></figure>    <p id="4fd58bcd">我们用一个空单元格将输入字段与输出字段分开。要添加它，请将插入号放置在inputField的单元格之后，然后按Enter，选择常量，然后使用“ <b id="20e27a18">添加新行</b>意图”在此常量之后添加行分隔符。</p>    <figure><img alt="image033" title="image033" src="/help/img/idea/2019.2/image033.png" id="d5e3453b" width="1186" height="746"></figure>    <p id="07200bc9">现在，让我们制作语言（右键单击“ <i id="e32611f1">语言”</i>或点击<i id="d48900c7">Control / Cmd + F9</i> ），然后看一下我们的沙箱概念：</p>    <figure><img alt="图片034" title="图片034" src="/help/img/idea/2019.2/image034.png" id="7e737b73" width="1186" height="746"></figure>    <p id="e7595136">我们可以添加输出字段，但是不能在其中键入任何表达式，因为我们没有声明任何允许存储表达式的内容：</p>    <figure><img alt="图片035" title="图片035" src="/help/img/idea/2019.2/image035.png" id="601c10f2" width="1186" height="746"></figure>    <h4 id="Adding_expressions_support">添加表达式支持</h4>    <p id="4e8ac222">在MPS中，我们有BaseLanguage，它是MPS的Java对应版本。创建新语言时，通常会对其进行扩展或重用BaseLanguage中的概念。让我们将其表达语言重新用于我们的输出字段。为此，我们需要使我们的语言扩展BaseLanguage。MPS中的语言扩展意味着您可以使用和扩展扩展语言中的概念。我们想使用BaseLanguage中的Expression概念，因此我们需要将其添加到扩展语言部分。打开语言属性对话框：</p>    <figure><img alt="image036" title="image036" src="/help/img/idea/2019.2/image036.png" id="ea7a6f09" width="1075" height="668"></figure>    <p id="5551984b">让我们将BaseLanguage添加到扩展语言列表中。为此，请选择“ <b id="2c2a10f7">依赖关系”</b>标签，然后点击“添加”按钮（ <img alt="image011" title="image011" src="/help/img/idea/2019.2/image011.gif" id="f8893123" width="16" height="16" class="inline-icon-16"> ），然后选择<i id="90e84aaf">jetbrains.mps.baseLanguage</i> 。然后从<i id="33dc1a99">范围</i>下拉菜单中选择<b id="afb4c3b3">扩展</b> 。</p>    <figure><img alt="image037" title="image037" src="/help/img/idea/2019.2/image037.png" id="7fac9e6a" width="924" height="690"></figure>    <p id="80857cd5">BaseLanguage包含一个<i id="508676e1">表达</i>概念。它表示形式为“ 2”，“ 2 + 3”，“ abc + abc”等的表达式。这正是我们输出字段表达式所需要的。让我们来看看它。按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + N</span></kbd>并从那里的BaseLanguage中选择Expression：</p>    <figure><img alt="image038" title="image038" src="/help/img/idea/2019.2/image038.png" id="afbbfe2c" width="1074" height="635"></figure>    <p id="f9ce8b25">表达本身是一个抽象概念。让我们看一下：</p>    <figure><img alt="image039" title="image039" src="/help/img/idea/2019.2/image039.png" id="f60e79e8" width="1186" height="746"></figure>    <p id="d8049da9">表达式没有自己的属性。因此，让我们看一下它的子概念，以了解我们在MPS中具有哪些类型的表达式。在弹出菜单中选择“在层次结构中显示概念”操作：</p>    <figure><img alt="image040" title="image040" src="/help/img/idea/2019.2/image040.png" id="f3785999" width="1076" height="635"></figure>    <p id="2f9b0eac">如您所见，有许多不同语言的表达式。表达被广泛扩展：</p>    <figure><img alt="image041" title="image041" src="/help/img/idea/2019.2/image041.png" id="73e56a98" width="1186" height="746"></figure>    <p id="2e993594">现在，将一个类型为expression的子代添加到OutputField：</p>    <figure><img alt="image042" title="image042" src="/help/img/idea/2019.2/image042.png" id="bbc1f24a" width="1186" height="746"></figure>    <p id="e741d91d">并相应地更改其编辑器（您可以在此处使用<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space</span></kbd> ）：</p>    <figure><img alt="图片043" title="图片043" src="/help/img/idea/2019.2/image043.png" id="f647d27a" width="1186" height="746"></figure>    <p id="6400a63e">现在，让我们来制作语言（右键单击“ <i id="5dcd1ca5">语言”</i>或点击<i id="3fb49908">Control / Cmd + F9</i> ），然后看看我们得到了什么：</p>    <figure><img alt="image044" title="image044" src="/help/img/idea/2019.2/image044.png" id="6e3309d7" width="1186" height="746"></figure>    <p id="b2eee706">您可能需要将BaseLanguage添加到模型的依赖项中：</p>    <figure><img alt="image044 1" title="image044 1" src="/help/img/idea/2019.2/image044_1.png" id="41d0ac98" width="1077" height="698"></figure>    <figure><img alt="image044 2" title="image044 2" src="/help/img/idea/2019.2/image044_2.png" id="3ef20c60" width="1060" height="538"></figure>    <p id="9981cacf">现在我们可以在输出字段中键入表达式，但是不幸的是，我们仍然无法在其中引用输入字段：</p>    <figure><img alt="图片045" title="图片045" src="/help/img/idea/2019.2/image045.png" id="85fdb594" width="1186" height="746"></figure>    <h4 id="Extending_Expressions_concept">扩展表达式概念</h4>    <p id="8577fe67">为了支持对输入字段的引用，我们需要创建自己的表达类型。让我们将其命名为“ InputFieldReference”，并使其扩展<i id="d88b13a4">Expression</i> 。创建它：</p>    <figure><img alt="image046" title="image046" src="/help/img/idea/2019.2/image046.png" id="03a4f3bb" width="1186" height="746"></figure>    <p id="3569c5c6">我们在这里添加了参考。它具有类型InputField和1基数。仅具有一个1-基数引用的概念称为智能引用，并且在编辑器中具有特殊支持。您稍后会学到更多。现在让我们为其创建一个编辑器。选择％field％-&gt;：</p>    <figure><img alt="image047" title="image047" src="/help/img/idea/2019.2/image047.png" id="393820e0" width="1106" height="634"></figure>    <p id="a4afd275">在最右边的单元格中，选择{name}：</p>    <figure><img alt="image048" title="image048" src="/help/img/idea/2019.2/image048.png" id="9e3cf14a" width="1186" height="746"></figure>    <p id="eb90313c">我们使用％field％-&gt; {name}来显示由字段引用引用的节点的名称。</p>    <p id="9a597b3e">现在讲我们的语言，看看我们所拥有的。现在，我们可以为节点输入输入字段：</p>    <figure><img alt="image049" title="image049" src="/help/img/idea/2019.2/image049.png" id="aa1070c7" width="1075" height="635"></figure>    <p id="6b40493e">由于智能引用，这是可能的。这是他们的工作方式。如果在当前上下文中可以使用作为智能引用的概念，则MPS会查看它可以引用的可能节点列表，并为每个这样的节点添加一个完成项。这就是为什么在完成菜单中有宽度，高度，深度的原因。</p>    <h4 id="Creating_a_generator">创建一个发电机</h4>    <p id="620e2467">让我们为我们的语言创建一个生成器-我们想用Java生成一个实现。MPS可能已经为您创建了一个，但如果没有，请在“语言”弹出菜单中选择“ <b id="3e64ef00">新建”-&gt;“生成器”</b>菜单项：</p>    <figure><img alt="image050" title="image050" src="/help/img/idea/2019.2/image050.png" id="b63cf248" width="899" height="598"></figure>    <p id="462c9e7d">将生成器名称保留为空：</p>    <figure><img alt="image051" title="image051" src="/help/img/idea/2019.2/image051.png" id="90b78fd8" width="736" height="289"></figure>    <p id="52839513">现在您的语言包含一个新的生成器：</p>    <figure><img alt="图片052" title="图片052" src="/help/img/idea/2019.2/image052.png" id="92431bae" width="1186" height="746"></figure>    <p id="9e011ef0">生成器的入口点是映射配置。它指定要转换的节点以及如何进行转换：</p>    <figure><img alt="image053" title="image053" src="/help/img/idea/2019.2/image053.png" id="1b2f639d" width="1186" height="746"></figure>    <h4 id="Deciding_what_to_generate">决定产生什么</h4>    <p id="61c36806">在开始开发生成器之前，我们需要考虑要生成哪种代码。我们可能想要生成如下内容：</p>    <code class="code">公共类Sandbox扩展JFrame {private JTextField myInput1 = new JTextField（）;私有JTextField myOutput = new JTextField（）;私人MyListener myListener = new MyListener（）; public Sandbox（）{setTitle（“ Sandbox”）; setLayout（new GridLayout（0，2））; myInput1.getDocument（）。addDocumentListener（myListener）; add（new JLabel（“ Input 1”））;添加（myInput1）; add（new JLabel（“ Output”））; add（myOutput）; update（）; setDefaultCloseOperation（JFrame。EXIT_ON_CLOSE）;包（）; setVisible（true）; } private void update（）{int i1 = 0;尝试{i1 = Integer.parseInt（myInput1.getText（））; } catch（NumberFormatException e）{} myOutput.setText（“” +（i1））; }私有类MyListener实现DocumentListener {public void insertUpdate（DocumentEvent e）{update（）; } public void removeUpdate（DocumentEvent e）{update（）; } public voidchangedUpdate（DocumentEvent e）{update（）; }} public static void main（String [] args）{SwingUtilities.invokeLater（new Runnable（）{public void run（）{new Sandbox（）;}））; }}</code>    <br>    <p id="0145a632">这是我们的应用程序执行后的外观：</p>    <figure><img alt="image054" title="image054" src="/help/img/idea/2019.2/image054.png" id="57ca6edf" width="170" height="91"></figure>    <p id="92713c28">现在让我们实现它。</p>    <h4 id="Implementing_generator">实现生成器</h4>    <p id="7a0b81ea">首先，为主类创建一个骨架。我们需要使用update方法，main方法和调用update方法等的DocumentListener创建一个类。让我们从新菜单中选择一个新类：</p>    <figure><img alt="image055" title="image055" src="/help/img/idea/2019.2/image055.png" id="c72c04b0" width="1074" height="652"></figure>    <p id="f9bc15a7">您将得到：</p>    <figure><img alt="image056" title="image056" src="/help/img/idea/2019.2/image056.png" id="68486dde" width="1186" height="746"></figure>    <p id="e977b784">如您所见，MPS在类的顶部添加了根模板注释。生成器模型内部的每个非生成器语言节点均视为模板。每个模板都应有一个输入节点，即用于生成该节点的节点。需要根模板注释才能指定此输入节点的类型。让我们将输入设置为“计算器”：</p>    <figure><img alt="image057" title="image057" src="/help/img/idea/2019.2/image057.png" id="c8773e58" width="1186" height="746"></figure>    <p id="488d4c7b">让我们给这个类起个名字：</p>    <figure><img alt="image058" title="image058" src="/help/img/idea/2019.2/image058.png" id="623bf089" width="1186" height="746"></figure>    <p id="2e269914">现在，让我们在映射中创建一个规则，该规则将从输入模型中的每个计算器使用此模板生成一个类。让我们将其添加到映射中：</p>    <figure><img alt="图片059" title="图片059" src="/help/img/idea/2019.2/image059.png" id="b6a7da35" width="1186" height="746"></figure>    <p id="af9487e6">此规则指示从输入模型中获取每个<i id="60d56f7b">计算器</i> ，并将其应用于<i id="361b1f11">计算器模板</i> 。让我们重建语言（右键单击<i id="f58299b6">Language</i>并选择<i id="dfebd04b">Rebuild Language</i> ），然后预览从我们的模型生成的文本：</p>    <figure><img alt="image060" title="image060" src="/help/img/idea/2019.2/image060.png" id="acf03851" width="1076" height="690"></figure>    <p id="818949c7">我们将把输出获得到一个新的编辑器选项卡中，该选项卡标有生成的Java文件的名称：</p>    <figure><img alt="image061" title="image061" src="/help/img/idea/2019.2/image061.png" id="90db0422" width="1186" height="746"></figure>    <p id="37767b13">如您所见，输出中有一类名为CalculatorImpl的类。</p>    <h3 id="6007bd2d">实施模板</h3>    <aside class="note " rel="6007bd2d" id="4bafac25" data-title="">        <p id="f1fd9a1a">为什么这么乏味？</p>        <p id="d010febd">您可能现在或以后在生成生成器的过程中会问这个问题，尤其是如果您不精通Java编程的话。请记住，本教程并不是作为激励示例而创建的，它可以使您以最小的努力快速获得具有功能的应用程序。其目的是使您了解广泛的核心原则，以便您更好地了解底层机制。在MPS中实现语言的语言实现者需要了解MPS生成器以及Java，因为Java是MPS中代码生成的最常见目标。我们可以给您三个建议：</p>        <ol class="list _decimal"><li class="list__item" id="63a15b78"><p>有关快速有趣的示例，请随时<a href="fast-track-to-mps.html">转至MPS</a>的<a href="fast-track-to-mps.html">快速入门教程</a> ，观看截屏视频并尝试与MPS捆绑在一起的示例。一旦确定MPS可以为您提供所需的解决方案，您就可以回到本教程。</p></li><li class="list__item" id="79f40f51"><p>打开在MPS安装期间已安装在主文件夹中的计算器教程示例项目，并在继续使用本已实现的语言进行播放的同时继续本教程。</p></li><li class="list__item" id="d3013602"><p>用艰苦而勇敢的方式做到这一点-继续本教程，最后获得自己的语言实现。</p></li></ol>    </aside>    <p id="b2cbf144">让我们使用我们在源模型中为其指定的Calculator节点的名称作为模板。将插入号放在班级名称上。按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Alt + Enter</span></kbd>并选择<i id="68350151">Add Property Macro</i> ：</p>    <figure><img alt="image062" title="image062" src="/help/img/idea/2019.2/image062.png" id="fbce7031" width="1074" height="635"></figure>    <p id="39554059">通过属性宏，我们可以为属性指定一个值，该值取决于输入节点。让我们在检查器中输入：</p>    <figure><img alt="image063" title="image063" src="/help/img/idea/2019.2/image063.png" id="16858eb0" width="1186" height="746"></figure>    <p id="637346f1">现在，让我们再次重建语言（右键单击<i id="0353cec2">Language</i>并选择<i id="6f21c779">Rebuild Language</i> ），然后预览从我们的沙箱模型生成的代码。您将看到一个具有正确名称的类，该类与Calculator实例的名称相对应：</p>    <figure><img alt="image064" title="image064" src="/help/img/idea/2019.2/image064.png" id="e1dce5a1" width="1186" height="746"></figure>    <p id="c779282d">现在，让我们将类的其余部分输入模板。为此，我们需要导入与Java类相对应的模型。如果一个模型导入另一个模型，则导入模型可以引用另一个模型的节点。为了简化与Java的互操作，MPS可以创建与jar文件或具有类的文件夹相对应的模型。这些模型的名称为package.name@java_stub形式，可以从模型属性对话框中添加：</p>    <figure><img alt="image065" title="image065" src="/help/img/idea/2019.2/image065.png" id="49dbcc9d" width="1196" height="679"></figure>    <p id="c8b132fa">让我们将javax.swing @ java_stub，javax.swing.event @ java_stub，java.awt @ java_stub和javax.swing.text@java_stub模型导入模板模型：</p>    <figure><img alt="image066" title="image066" src="/help/img/idea/2019.2/image066.png" id="7316930d" width="934" height="597"></figure>    <p id="a64e5510">让我们从JFrame继承我们的类，在Calculator模板中创建一个main方法，一个documentListener字段和一个update方法。请注意，应在创建调用之前创建更新方法。</p>    <figure><img alt="图片067" title="图片067" src="/help/img/idea/2019.2/image067.png" id="e341f450" width="1187" height="746"></figure>    <p id="585c7585">现在，让我们创建将为我们设置框架的代码：</p>    <figure><img alt="图片068" title="图片068" src="/help/img/idea/2019.2/image068.png" id="0a0d1917" width="1066" height="712"></figure>    <p id="45e19bea">将属性宏放在“计算器”字符串上，然后将node.name添加到检查器，以便标题反映计算器的名称：</p>    <figure><img alt="图片069" title="图片069" src="/help/img/idea/2019.2/image069.png" id="1abecc36" width="1066" height="712"></figure>    <p id="0b93c6e9">现在让我们为每个输入字段创建一个可视文本字段组件。首先，我们需要添加一个JTextField类型的文本字段：</p>    <figure><img alt="image070" title="image070" src="/help/img/idea/2019.2/image070.png" id="4caba907" width="1066" height="712"></figure>    <p id="4fe2cb05">现在，我们将确保为每个计算器的输入字段创建一个这样的文本字段。让我们选择整个字段声明（使用<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Up / Down</span></kbd>快捷键），然后选择“添加节点宏”：</p>    <figure><img alt="image071" title="image071" src="/help/img/idea/2019.2/image071.png" id="b30c0785" width="954" height="600"></figure>    <p id="51213324">我们得到以下内容：</p>    <figure><img alt="图片072" title="图片072" src="/help/img/idea/2019.2/image072.png" id="8509b102" width="1066" height="712"></figure>    <p id="35d9a1d8">从完成菜单中选择循环：</p>    <figure><img alt="图片073" title="图片073" src="/help/img/idea/2019.2/image073.png" id="17ed9528" width="953" height="602"></figure>    <p id="0c4d8545">循环宏使您可以重复多次在宏下进行构造：一次由检查器中的代码返回的集合中的每个节点。</p>    <p id="3d2c431f">在循环的检查器中，键入以下内容：</p>    <figure><img alt="image074" title="image074" src="/help/img/idea/2019.2/image074.png" id="e10b08d8" width="1066" height="712"></figure>    <p id="420c63b3">这意味着我们希望在源计算器中具有的每个inputField的类中都有一个字段。</p>    <p id="b5afd14f">让我们给每个可视文本字段一个唯一的名称。我们需要在其名称中添加一个属性宏，然后在宏中键入以下代码：</p>    <figure><img alt="image075" title="image075" src="/help/img/idea/2019.2/image075.png" id="e0824cdc" width="1066" height="712"></figure>    <p id="e396de27">该代码将为我们的变量赋予<b id="92f7c137">唯一的</b>名称，例如inputField_a，inputField_b等。</p>    <p id="f51ecd4d">我们还需要对outputFields做同样的事情：</p>    <figure><img alt="image076" title="image076" src="/help/img/idea/2019.2/image076.png" id="bab9db25" width="1066" height="712"></figure>    <p id="7335c242">唯一的区别是我们在$ LOOP $中使用node.outputField，并使用“ outputField”作为基本名称。为了使您的更改可用于MPS，请使用语言。</p>    <p id="c73e55ab">让我们做一个沙盒，看看我们有什么：</p>    <figure><img alt="image077" title="image077" src="/help/img/idea/2019.2/image077.png" id="01460b76" width="1066" height="712"></figure>    <p id="c7d08113">如您所见，字段已生成。现在，我们要将这些字段添加到可视框架。输入：</p>    <figure><img alt="image078" title="image078" src="/help/img/idea/2019.2/image078.png" id="d26a955b" width="1066" height="712"></figure>    <p id="5615a198">本质上，您创建一个<i id="c5bc8caf">BlockStatement</i> （用{}包装的代码），以便我们可以将BlockStatement的内容视为属于单个InputField的单个单元。然后，我们可以轻松地为每个计算器的InputField重复该块。用<i id="8baad532">$ LOOP $</i>将块和其中的代码<i id="1cde2bbc">括起来</i> ，并使用<i id="1cde2bbc">node.inputField</i>作为检查器中的值：</p>    <figure><img alt="image079" title="image079" src="/help/img/idea/2019.2/image079.png" id="c0def1bd" width="1066" height="712"></figure>    <p id="11d934b7">在JLabel的构造函数的参数中添加一个属性宏，以便标签将具有与相应输入字段名称相同的文本：</p>    <figure><img alt="image080" title="image080" src="/help/img/idea/2019.2/image080.png" id="709a3eda" width="1066" height="712"></figure>    <p id="669a9525">创建对字段声明的引用（其中存储当前字段）会更加复杂。从对inputField的引用，我们需要生成对从当前inputField生成的相应JTextField的引用。为此，我们需要标记字段声明并使用该标签来查找字段。</p>    <p id="18b60426">转到映射并添加以下内容：</p>    <figure><img alt="图片081" title="图片081" src="/help/img/idea/2019.2/image081.png" id="5849779b" width="1066" height="712"></figure>    <p id="0616b99e">现在我们有一个存储空间，用于存储由原始<i id="9762a1a8">InputFields</i>索引的生成的<i id="65134f8c">FieldDeclarations</i> 。这意味着<i id="96fdb5b3">inputField</i>标签将引用从<i id="19c1e54c">InputField</i>生成的<i id="08e16fb8">FieldDeclaration</i>类型的节点。现在，将标签添加到生成的字段的LOOP宏中：</p>    <figure><img alt="image082" title="image082" src="/help/img/idea/2019.2/image082.png" id="a2111d68" width="955" height="601"></figure>    <p id="9adcddb8">现在，我们需要将对inputField的引用更改为通过标签使用查找找到的引用。为此，我们需要在字段引用中添加引用宏：</p>    <figure><img alt="image083" title="image083" src="/help/img/idea/2019.2/image083.png" id="40c1d4d4" width="956" height="599"></figure>    <p id="16b2eef3">转到检查器并输入以下内容：</p>    <figure><img alt="image084" title="image084" src="/help/img/idea/2019.2/image084.png" id="13f6878e" width="899" height="596"></figure>    <p id="10a475ba">你将会有：</p>    <figure><img alt="image085" title="image085" src="/help/img/idea/2019.2/image085.png" id="b5ccde06" width="1066" height="712"></figure>    <p id="444630eb">对第二个引用执行相同的操作：</p>    <figure><img alt="image086" title="image086" src="/help/img/idea/2019.2/image086.png" id="f0a6c0e7" width="1066" height="712"></figure>    <p id="ae660058">现在，让我们制作语言（右键单击“ <i id="4a962358">语言”，</i>然后选择“ <i id="be8b5114">重建语言”</i> ），然后看一下我们从沙箱模型生成的内容：</p>    <figure><img alt="image087" title="image087" src="/help/img/idea/2019.2/image087.png" id="f57ea39c" width="1066" height="712"></figure>    <p id="3e599a5d">如您所见，引用设置正确。</p>    <p id="a73780a5">现在，让我们对输出字段执行相同的操作。同样，我们需要创建初始化代码，并用<i id="c44b96e3">$ LOOP $</i>宏将其包围。创建用于字段声明的标签，并将其放在outputField的$ LOOP $上。然后，我们需要使用此标签来创建参考。进行以下更改后，模板中的代码应如下所示：</p>    <figure><img alt="image088" title="image088" src="/help/img/idea/2019.2/image088.png" id="a24b56cc" width="1066" height="712"></figure>    <p id="fe35b340">现在，让我们实现剩下的唯一事情：使用计算值更新结果的代码。我们想要这样的东西：</p>    <code class="code">公共无效update（）{int i1 = 0;尝试{i1 = Integer.parseInt（myInput1.getText（））; } catch（NumberFormatException e）{} myOutput.setText（“” +（i1））; }</code>    <br>    <p id="347474b8">我们为每个输入节点创建一个int局部变量，并在该字段中为其分配一个值。让我们为此类变量创建一个循环宏。确保“;”在$ LOOP $宏中：</p>    <figure><img alt="图片089" title="图片089" src="/help/img/idea/2019.2/image089.png" id="b5bdf785" width="1066" height="712"></figure>    <p id="4e42c802">让我们为每个变量生成一个唯一的名称：</p>    <figure><img alt="image090" title="image090" src="/help/img/idea/2019.2/image090.png" id="5cf35c9d" width="1066" height="712"></figure>    <p id="63795970">让我们初始化这些变量。为了引用我们的变量，我们需要创建另一个标签：</p>    <figure><img alt="image091" title="image091" src="/help/img/idea/2019.2/image091.png" id="4dc5a379" width="1066" height="712"></figure>    <p id="de7e4036">并将其分配给局部变量声明。为此，您需要使用<i id="c0473aff">$ MAP_SRC $</i>宏将局部变量<i id="c0473aff">引起来</i> 。在大多数情况下，此宏仅用于向我们要引用的节点添加标签，而这些节点没有任何其他宏关联。</p>    <p id="99f2d811">确保选择LocalVariableDeclaration，而不是LocalVariableDeclarationStatement。要检查这一点，请看一下分号。如果它在宏括号之外，请选择正确的节点：</p>    <figure><img alt="image092" title="image092" src="/help/img/idea/2019.2/image092.png" id="59c2fb6e" width="1066" height="712"></figure>    <p id="5ce7206a">将需要另一个LOOP来使用计算器输入字段中的值正确初始化这些局部变量。首先，添加一个try ... catch块。您将拥有：</p>    <figure><img alt="图片093" title="图片093" src="/help/img/idea/2019.2/image093.png" id="a7d878c2" width="1066" height="712"></figure>    <p id="1e960c1c">用LOOP宏将其包围：</p>    <figure><img alt="image094" title="image094" src="/help/img/idea/2019.2/image094.png" id="98d8bfa3" width="1066" height="712"></figure>    <p id="5f629152">请确保<b id="e3b168d4">整个语句</b> （包括结尾分号的行）都由LOOP宏包装。然后创建引用宏，并使用标签查找这些引用的相应目标（即分别为LocalVariableDeclarations和InputFields）。使用局部变量：</p>    <figure><img alt="image095" title="image095" src="/help/img/idea/2019.2/image095.png" id="9105cbaa" width="1066" height="712"></figure>    <p id="56efe674">带现场参考：</p>    <figure><img alt="image096" title="image096" src="/help/img/idea/2019.2/image096.png" id="2f278d98" width="1066" height="712"></figure>    <p id="9d13279c">现在我们需要将输出值设置到表示计算出的输出的文本字段中。输入以下代码：</p>    <figure><img alt="image097" title="image097" src="/help/img/idea/2019.2/image097.png" id="117a5feb" width="1066" height="712"></figure>    <p id="a124d6b4">用LOOP宏将其包围：</p>    <figure><img alt="image098" title="image098" src="/help/img/idea/2019.2/image098.png" id="b7c0716d" width="1066" height="712"></figure>    <p id="2b3c522d">再次，请确保将<b id="540d5356">包括结尾分号在内</b>的<b id="540d5356">整个语句</b>包装在LOOP宏中。然后将引用宏添加到outputField：</p>    <figure><img alt="image099" title="image099" src="/help/img/idea/2019.2/image099.png" id="153b5d4b" width="1066" height="712"></figure>    <p id="2bb11531">现在我们需要设置文本，以便显示计算结果。因此，我们需要将输出字段的表达式生成为null值所在的位置。删除setText（）方法的null参数，然后键入：“” +（null）。在每个步骤上使用Ctrl + Space。我们在此处添加括号以确保输出代码正确。如果没有括号，表达式为2–3，则输出代码将为“” + 2 – 3，这是不正确的。另一方面，“” +（2-3）是正确的：</p>    <figure><img alt="image100" title="image100" src="/help/img/idea/2019.2/image100.png" id="29b66eae" width="1066" height="712"></figure>    <p id="ee4d98fd">将节点宏添加到空值并将其更改为$ COPY_SRC $宏。$ COPY_SRC $宏用检查器中代码返回的节点的副本替换宏下的节点。我们返回node.expression：</p>    <figure><img alt="image101" title="image101" src="/help/img/idea/2019.2/image101.png" id="d0b06e0e" width="1066" height="712"></figure>    <p id="8184dfd4">剩下的唯一事情就是处理InputFieldReference。我们还没有发电机。我们需要将引用替换为从JTextField检索到的值，该值对应于所引用的输入字段。因此，相应地将相应的<i id="ae628737">i</i>变量存储在<i id="53f4b2e6">LocalVar</i>标签中。要为InputFieldReference创建生成器，我们需要定义一个归约规则。归约规则适用于在生成过程中复制的所有节点，例如，在$ COPY_SRC $宏中。让我们在映射配置中创建相应的归约规则：</p>    <figure><img alt="image102" title="image102" src="/help/img/idea/2019.2/image102.png" id="624e58e1" width="1066" height="712"></figure>    <p id="56fec8c0">由于模板不会很长，因此我们将使用带有上下文的嵌入式模板。从完成列表中选择&lt;带上下文的在线模板&gt;。</p>    <figure><img alt="image103 1" title="image103 1" src="/help/img/idea/2019.2/image103_1.png" id="bc6722d5" width="1121" height="602"></figure>    <p id="d526a4f5">我们将InputNodeReference转换为局部变量引用，因此我们必须创建将包含此类局部变量引用的有效上下文节点。让我们使用BlockStatement作为上下文节点：</p>    <figure><img alt="image103 2" title="image103 2" src="/help/img/idea/2019.2/image103_2.png" id="aa0f0fb7" width="955" height="601"></figure>    <p id="742dd71c">在此BlockStatement内部，我们定义局部变量i并创建引用它的简单表达式：</p>    <figure><img alt="image103 3" title="image103 3" src="/help/img/idea/2019.2/image103_3.png" id="9baa9de7" width="1066" height="712"></figure>    <p id="e9defd2d">内联模板将使用对本地变量<i id="c9388308">i的</i>引用，因此我们应将其标记为模板片段。按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Alt + Enter</span></kbd>并选择“创建模板片段”意图：</p>    <figure><img alt="image103 4" title="image103 4" src="/help/img/idea/2019.2/image103_4.png" id="0aee76ba" width="994" height="600"></figure>    <p id="4b70e145">现在让我们为该局部变量引用创建引用宏：</p>    <figure><img alt="image103 5" title="image103 5" src="/help/img/idea/2019.2/image103_5.png" id="8257e9d3" width="1032" height="601"></figure>    <p id="7f09262e">并指定适当的参考查询以从<i id="8c4a260a">LocalVar</i>获取正确的<i id="eab24bd6">i</i> ：</p>    <figure><img alt="图片103 6" title="图片103 6" src="/help/img/idea/2019.2/image103_6.png" id="96ae029d" width="1066" height="712"></figure>    <p id="d9f2f0b8">现在，让我们重建语言（右键单击“ <i id="4ea8576a">语言”，</i>然后选择“ <i id="f6d21607">重建语言”</i> ），然后查看沙盒模型会发生什么。如您所见，MPS完全生成我们想要的代码：</p>    <figure><img alt="图片106" title="图片106" src="/help/img/idea/2019.2/image106.png" id="4256f232" width="1066" height="712"></figure>    <h4 id="Entering_Salar_program">进入薪资计划</h4>    <p id="ae6ca9d9">完成语言及其生成器后，我们可以进入薪水计划。这里是：</p>    <figure><img alt="image107" title="image107" src="/help/img/idea/2019.2/image107.png" id="b68d8d6b" width="1243" height="747"></figure>    <h4 id="Running_generated_code">运行生成的代码</h4>    <p id="94197590">为了运行代码，您需要创建解决方案模型：</p>    <figure><img alt="图片108" title="图片108" src="/help/img/idea/2019.2/image108.png" id="d86d1bac" width="1131" height="668"></figure>    <p id="e8a89a70">您的资源将在解决方案source_gen目录中可用。（不要忘记切换到文件系统视图）：</p>    <figure><img alt="图像109" title="图像109" src="/help/img/idea/2019.2/image109.png" id="977c0a90" width="1243" height="747"></figure>    <p id="e0615702">您可以使用自己喜欢的Java IDE运行它们。</p>    <p id="f5d54d67">我们完成了语言的主要部分，现在让我们做些精炼。</p>    <h4 id="Creating_a_scope_for_InputFieldReference">为InputFieldReference创建范围</h4>    <p id="3d0a4f8f">如果我们在沙箱模型中创建另一个Calculator根，我们将能够引用第一个计算器的输入字段，这是不正确的：</p>    <figure><img alt="image110" title="image110" src="/help/img/idea/2019.2/image110.png" id="4ef2a9ca" width="1140" height="636"></figure>    <p id="768af33a">让我们修复它。为此，我们需要定义<i id="2c5a3342">InputFieldReference</i>概念的范围。为此，我们定义了一个约束：打开<i id="96f45db3">InputFieldReference</i> ，转到“ <i id="6ba48548">约束”</i>选项卡，并为其创建约束根：我们将使用范围解析的新的分层（ <i id="caff2d77">继承</i> ）机制。此机制将范围解析委托给实现<i id="a89d0768">ScopeProvider</i>的祖先。因此，我们的<i id="00cf10e9">InputFieldReference会</i>搜索<i id="94e1aa58">InputField</i>节点，并依靠其祖先构建这些列表。</p>    <figure><img alt="图片111" title="图片111" src="/help/img/idea/2019.2/image111.png" id="25188f1e" width="1243" height="747"></figure>    <p id="c80e7859">添加<i id="1298341d">引用约束</i>并选择字段作为其链接：</p>    <figure><img alt="image112" title="image112" src="/help/img/idea/2019.2/image112.png" id="d96e59ce" width="1165" height="636"></figure>    <p id="eee5c798">现在让我们为此链接创建一个范围。转到合并<i id="29dc4f10">范围</i>部分，然后<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">按Ctrl + Space</span></kbd> 。我们需要指定如何解析<i id="a06f8497">InputFieldReference</i>可以链接到的元素：</p>        <figure><img alt="图片113 1" title="图片113 1" src="/help/img/idea/2019.2/image113_1.png" id="39ec0e64" width="1243" height="747"></figure>    <p id="a7f6f733">一旦指定在搜索<i id="9b6bbd4e">InputField</i>时<i id="30aa4a5f">继承</i>了<i id="953a3e65">InputFieldReference</i>的作用域，就必须指出<i id="4f902370">Calculator</i>是<i id="19f9fa08">ScopeProvider</i> 。这样可以确保<i id="9d863fbe">Calculator</i>在为所有作为其后代放置的<i id="0891485c">InputFieldReferences</i>的作用域建立范围时具有发言权。</p>    <p id="c16a4838">每当查询了<i id="e60c9299">InputField</i>的范围，我们的情况下， <i id="b35c6957">计算器</i>应该返回其所有<i id="e668336b">InputFields</i>的列表。因此，在“ <i id="e521af7c">计算器”</i>的“ <i id="ab95dab8">行为”</i>方面，我们重写<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + O</span></kbd>的<i id="d0e4a94a">getScope（）</i>方法：</p>    <figure><img alt="image113 3" title="image113 3" src="/help/img/idea/2019.2/image113_3.png" id="b0e24055" width="494" height="684"></figure>    <p id="995671bc">如果未解决<i id="3c8abad4">Scope</i> ，我们需要导入包含它的模型<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + R</span></kbd> （ <i id="2199849a">jetbrains.mps.scope</i> ）：</p>    <p id="91736760">我们还需要<i id="d2fd0c6c">BaseLanguage，</i>因为我们需要对一些功能进行编码。需要导入<i id="ea38d5fb">smodel</i>语言才能查询节点。这些语言应该已经自动为您导入。如果没有，则可以使用<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + L</span></kbd>快捷键导入它们。</p>    <p id="c7088ac1">现在，我们终于可以完成作用域定义代码，从本质上讲，它从计算器中返回所有输入字段：</p>    <figure><img alt="image114" title="image114" src="/help/img/idea/2019.2/image114.png" id="c0b99821" width="1077" height="747"></figure>    <p id="8ebd237c">        <i id="10ac81b0">快速提示：注意使用SimpleRoleScope类。它是可以帮助您构建自己的自定义范围的几个帮助程序类之一。通过导航到SimpleRoleScope <kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + N</span></kbd>并打开包含的包结构<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Alt + F1</span></kbd>来检出它们。</i>    </p>    <p id="baf67d0b">设置语言后（右键单击“ <i id="09a1f7f2">语言”</i>并选择<i id="d5e2236f">“创建语言”</i> ），您将不再能够从第二个计算器中的第一个计算器访问字段：</p>    <figure><img alt="第115节" title="第115节" src="/help/img/idea/2019.2/image115.png" id="8e435f61" width="1019" height="506"></figure>    <p id="3c7f0278">但是您仍然可以访问第一个计算器中的字段：</p>    <figure><img alt="image116" title="image116" src="/help/img/idea/2019.2/image116.png" id="bf73d1d2" width="1107" height="508"></figure>    <h4 id="Creating_a_type_system_rule_for_InputFieldReference">为InputFieldReference创建类型系统规则</h4>    <p id="e43450b0">现在，我们可以输入如下内容：</p>    <figure><img alt="图片117" title="图片117" src="/help/img/idea/2019.2/image117.png" id="64cebf95" width="1027" height="644"></figure>    <p id="f6e5fa04">这段代码是不正确的，因为宽度必须为布尔值，因为它被用作三元运算符条件的一部分。为了使该错误可见，我们需要为我们的概念创建一个类型系统规则。我们开始做吧。打开InputFieldReference并转到<i id="59f7cab5">Typesystem</i>选项卡。在此处创建一个InferenceRule：</p>    <figure><img alt="图片118" title="图片118" src="/help/img/idea/2019.2/image118.png" id="b6fd9dce" width="1027" height="644"></figure>    <p id="720a9248">我们的类型引擎使用类型方程和不等式进行操作。方程式指定哪些节点的类型应相等。在等式中，指定哪些节点的类型应该是彼此的子类型。我们需要添加一个方程式，指出我们的引用类型始终为<i id="aa1241f3">int</i> 。让我们定义方程式。在完成菜单中选择等号：</p>    <figure><img alt="图片119" title="图片119" src="/help/img/idea/2019.2/image119.png" id="ba89da32" width="918" height="534"></figure>    <p id="dbde1b22">在其左侧选择typeOf：</p>    <figure><img alt="image120" title="image120" src="/help/img/idea/2019.2/image120.png" id="7c1ce12c" width="915" height="534"></figure>    <p id="dcc1c0be">在typeof内输入“ inputFieldReference”：</p>    <figure><img alt="image121" title="image121" src="/help/img/idea/2019.2/image121.png" id="b57187c6" width="1027" height="644"></figure>    <p id="3bb49fde">在等式的右侧选择&lt;quotation&gt;：</p>    <figure><img alt="图片122" title="图片122" src="/help/img/idea/2019.2/image122.png" id="45ac1c02" width="916" height="534"></figure>    <p id="cd7a3cee">报价是一种特殊的构造，它使我们能够将报价内的节点作为值。通常，我们要创建的节点非常复杂，因此使用顺序的属性/子项/引用分配来创建它们是容易出错且无聊的活动。报价大大简化了此类任务。</p>    <p id="45cdfce3">在其中键入IntegerType：</p>    <figure><img alt="image123" title="image123" src="/help/img/idea/2019.2/image123.png" id="c95eea79" width="916" height="533"></figure>    <p id="915d2870">现在我们的规则已经完成：</p>    <figure><img alt="图像124" title="图像124" src="/help/img/idea/2019.2/image124.png" id="2b2f0ac8" width="1027" height="644"></figure>    <p id="91616129">让我们来制作语言（右键单击“ <i id="9d4d613d">语言”</i>并选择“ <i id="763161ff">制作语言”</i> ），然后看看有错误的代码：</p>    <figure><img alt="image125" title="image125" src="/help/img/idea/2019.2/image125.png" id="fdd3fdea" width="1027" height="644"></figure>    <p id="a8e18cc3">现在突出显示。您可以按Ctrl + F1并查看错误消息：“类型int不是布尔值的子类型”。</p>    <h4 id="Appendix_A">如何使用MPS编辑器</h4>    <p id="3c602db3">尽管看起来像文本编辑器，但MPS编辑器并不是一个完全正确的编辑器。因此，使用它不同于使用文本编辑器。在本节中，我们将描述使用MPS编辑器的基础知识。</p>    <p id="811a2f75">导航的工作方式类似于文本编辑器。您可以使用箭头键， <kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Page Up / Down</span></kbd>和<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Home / end</span></kbd> ，它们的行为与文本编辑器中的行为相同。选择的工作原理有所不同：您不能在编辑器中选择任意间隔，因为MPS中没有这样的东西。您只能选择一个单元格或一组相邻的单元格。要选择当前单元格的父级，请按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Up</span></kbd> 。要选择当前单元格的子级，请按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Down</span></kbd> 。如果要选择相邻的单元格，请使用<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Shift +左/右</span></kbd> 。</p>    <p id="bf641b0e">与文本编辑器（其中代码完成是可选的）不同，MPS可以立即使用此功能。您几乎可以在任何地方按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Space</span></kbd> ，然后在当前位置查看可能项目的列表。如果要浏览语言的功能，最好的方法是在您感兴趣的地方使用此快捷方式，然后查看完成菜单的内容。</p>    <p id="77d5d7c6">MPS的另一个常用功能是意图。意图是可以应用于编辑器中的节点的动作。如果您在编辑器中看到一个灯泡，则可以应用意图。如果按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Alt + Enter</span></kbd> ，则灯泡将扩展到菜单，以便您选择所需的操作。</p>    <p id="657243cb">在MPS中，我们经常希望将新元素添加到可能存在多个此类元素的地方。例如，我们可以在方法主体中添加新语句，在类声明中添加新方法，等等。为此，您可以使用两个快捷键： <kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Insert</span></kbd>和<kbd data-primary_default="Enter" data-primary_default_for_gnome="Enter" data-primary_default_for_kde="Enter" data-primary_default_for_xwin="Enter" data-primary_eclipse="Enter" data-primary_eclipse_mac_os_x="Enter" data-primary_emacs="Enter" data-primary_jbuilder="Enter" data-primary_mac_os_x="Enter" data-primary_mac_os_x_10.5_="Enter" data-primary_netbeans="Enter" data-primary_visual_studio="Enter" data-secondary_default="⏎" data-secondary_default_for_gnome="⏎" data-secondary_default_for_kde="⏎" data-secondary_default_for_xwin="⏎" data-secondary_eclipse="⏎" data-secondary_eclipse_mac_os_x="⏎" data-secondary_emacs="⏎" data-secondary_jbuilder="⏎" data-secondary_mac_os_x="⏎" data-secondary_mac_os_x_10.5_="⏎" data-secondary_netbeans="⏎" data-secondary_visual_studio="⏎">Enter</kbd> 。前者在当前项目之前添加一个新项目。后者在当前项目之后添加一个新项目。为了删除当前项目，请按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Ctrl + Delete</span></kbd> 。</p><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月30日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="shapes-an-introductory-mps-tutorial.html">形状-MPS入门教程</a> <a class="navigation-links__next" href="scopes.html">范围</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>