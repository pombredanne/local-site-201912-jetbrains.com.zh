<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>测试语言-帮助|帮助MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Testing+languages.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索MPS帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected>默认</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_mac_os_x" data-group="primary">Eclipse（Mac OS X）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_mac_os_x" data-group="primary">Mac OS X</option><option value="primary_mac_os_x_10.5_" data-group="primary">Mac OS X 10.5以上</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="secondary_default" data-group="secondary">默认</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_jbuilder" data-group="secondary">JBuilder的</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">Mac OS X 10.5以上</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="testing-languages.xml" data-toc="Testing+languages.html">测试语言</h1>   <h2 id="testinglanguages">测试语言</h2>   <p id="548d3f5b">      </p><ul data-skip-index="skip"><li class="list__item"><a href="#testinglanguages">测试语言</a></li><li class="list__item"><a href="#introduction">介绍</a></li><li class="list__item"><a href="#quicknavigationtable">快速导航表</a></li><li class="list__item"><a href="#testscreation">测试创建</a></li><li class="list__item"><a href="#1.createatest%C2%A0aspectinyourlanguage">1。用您的语言创建测试方面</a></li><li class="list__item"><a href="#2.createatestmodel">2。创建一个测试模型</a></li><li class="list__item"><a href="#unittestingwithbtestcase">使用BTestCase进行单元测试</a></li><li class="list__item"><a href="#testinfo">测试信息</a></li><li class="list__item"><a href="#testingaspectsoflanguagedefinitions">测试语言定义的各个方面</a></li><li class="list__item"><a href="#nodetests">节点测试</a></li><li class="list__item"><a href="#checkingforcorrectness">检查正确性</a></li><li class="list__item"><a href="#checkingfortypesystemanddata-flowerrorsandwarnings">检查类型系统和数据流错误和警告</a></li><li class="list__item"><a href="#type-systemspecificoptions">类型系统特定的选项</a></li><li class="list__item"><a href="#testingscopes">测试范围</a></li><li class="list__item"><a href="#testandutilitymethods">测试和实用方法</a></li><li class="list__item"><a href="#editortests">编辑器测试</a></li><li class="list__item"><a href="#inspectingtheeditorstate">检查编辑器状态</a></li><li class="list__item"><a href="#migrationtests">迁移测试</a></li><li class="list__item"><a href="#generatortests">发电机测试</a></li><li class="list__item"><a href="#runningthetests">运行测试</a></li><li class="list__item"><a href="#insidemps">内部MPS</a></li><li class="list__item"><a href="#fromabuildscript">从构建脚本</a></li><li class="list__item"><a href="#runningeditortestsinideaplugin">在IDEA插件中运行编辑器测试</a></li></ul>   <p></p>      <h2 id="introduction">介绍</h2>   <p id="beb44451">测试是语言设计师工作的重要组成部分。MPS必须提供针对<i id="3e6a5427">BaseLanguage</i>代码和语言的测试工具。虽然<i id="ee7915cf">jetbrains.mps.baselanguage.unitTest</i>语言使<i id="ee7915cf">类似</i> <b id="16d2b78f">JUnit</b>的单元测试能够测试<i id="d6b1ed54">BaseLanguage</i>代码，但<b id="d4d9ae59">语言测试</b>语言<i id="6ba4845b">jetbrains.mps.lang.test</i>提供了一个有用的界面来创建语言测试。</p>   <aside class="tip sideblock" rel="beb44451" id="91d9bc21" data-title="">      <p id="243f0d6f">为了最大程度地减少测试断言对测试代码的影响， <b id="eadff092">语言测试</b>语言通过<b id="caef45a4">注释来</b>描述测试方面（以类似于生成器语言使用生成器<i id="6c1e3c8d">宏</i>注释模板代码的方式）。</p>   </aside>   <h2 id="quicknavigationtable">快速导航表</h2>      <p id="f046b274">语言定义的不同方面通过不同的方式进行测试：</p>   <div class="table-wrapper"><table width="100%" id="328bc9fc"><thead><tr id="b7562f0c" class="ijRowHead"><th id="f7a92678" width="30%">            <p id="87e871c5">语言定义方面</p>         </th><th id="f807f2df" width="70%">            <p id="9243fe43">测试方式</p>         </th></tr></thead><tbody><tr id="a8b11dbc" class="ijRowOdd"><td id="1caab034">            <p id="6d110236">意向<br>动作<br>侧变换<br>编辑器ActionMap<br>键映射</p>         </td><td id="7148ef4e">            <p id="4dcc639b">使用<i id="a601d6d4">jetbrains.mps.lang.test</i>语言创建<i id="60bd1ac3">EditorTestCases</i> 。您可以通过提供一个初始代码段，定义一组编辑操作来对初始代码执行操作来设置阶段，并且还可以将预期结果作为另一段代码来提供。测试的预期输出与实际输出之间的任何差异都将报告为错误。<br>有关详细信息，请参见“ <a href="#editortests">编辑器测试”部分</a> 。</p>         </td></tr><tr id="e73f9606" class="ijRowEven"><td id="4ee89a32">            <p id="5f09da42">约束条件<br>范围<br>类型系统<br>数据流</p>         </td><td id="4c3934b3">            <p id="8bf531d8">使用<i id="26f21ce7">jetbrains.mps.lang.test</i>语言创建<i id="53eea807">NodesTestCases</i> 。在这些测试用例中，编写“正确”代码段，并确保未在其上报告任何错误或警告。同样，编写“无效”代码段并断言在正确的节点中报告了错误或警告。<br>有关详细信息，请参见“ <a href="#nodetests">节点测试”部分</a> 。</p>         </td></tr><tr id="bca5b0a7" class="ijRowOdd"><td id="c2637f96">            <p id="eb75c3e7">发电机<br>TextGen</p>         </td><td id="239bb30a">            <p id="b0e7a20e">使用<i id="66bd1a88"> </i>创建<i id="125fa173">GeneratorTests的</i>语言。这些使您可以转换测试模型，并检查生成的代码是否符合预期的结果。<br>有关详细信息，请参见“ <a href="#generatortests">发电机测试”部分</a> 。</p>            <p id="1240a8c6">目前没有针对这些方面的内置测试工具。随着时间的流逝，有一些实践为我们服务：</p>            <ul class="list _ul"><li class="list__item" id="4b380d19"><p>检查生成过程的最合理方法可能是生成模型，我们已经知道了正确的生成结果，然后将生成的输出与预期的输出进行比较。例如，如果您生成的代码存储在VCS中，则可以在每次测试后检查是否存在差异。</p></li><li class="list__item" id="f541e60e"><p>您也可以考虑提供代码片段，这些代码片段可以代表生成器的极端情况，并检查生成器是否从中成功生成输出，或者是否失败。</p></li><li class="list__item" id="17b0ff16"><p>编译和运行生成的代码还可以提高您对生成器正确性的信心。</p></li></ul>         </td></tr><tr id="65182d97" class="ijRowEven"><td id="3f353889">            <p id="70d619a0">移居</p>         </td><td id="378775c6">            <p id="e5ef76cc">使用<i id="7cbe0209">jetbrains.mps.lang.test</i>语言创建<i id="f28d4900">MigrationTestCases</i> 。在这些测试用例中，编写代码片段以在其上运行迁移。<br>有关详细信息，请参见“ <a href="#migrationtests">迁移测试”部分</a> 。</p>         </td></tr></tbody></table></div>   <h2 id="testscreation">测试创建</h2>   <p id="0271bff9">有两个选项可将测试模型添加到您的项目中。</p>   <h3 id="1.createatest aspectinyourlanguage">1。用您的语言创建测试方面</h3>   <p id="e04a3d4e">这更易于设置，但只能包含不需要在新启动的MPS实例中运行的测试。因此通常可以进行简单的基本语言单元测试。要创建<i id="983d71bc">测试</i>方面，请右键单击语言节点，然后选择<code class="code">New->Test Aspect</code> 。</p>   <p id="748d7ab2">      </p><figure><img alt="T2" title="T2" src="/help/img/idea/2019.2/T2.png" id="7c29e177" width="651" height="309"></figure>   <p></p>   <p id="3255e7e2">现在，您可以开始在“ <i id="0b11b264">测试”</i>方面创建单元测试。</p>   <p id="98912b14">      </p><figure><img alt="T1" title="T1" src="/help/img/idea/2019.2/T1.png" id="cad0ba55" width="808" height="218"></figure>      <br>右键单击“ <i id="19bc604e">测试”</i>方面将为您提供运行所有测试的选项。然后，测试报告将显示在屏幕底部的“ <i id="6a5ff047">运行”</i>面板中。<p></p>   <h3 id="2.createatestmodel">2。创建一个测试模型</h3>   <p id="42a92e47">此选项使您更具灵活性。在新的或现有的解决方案中创建测试模型。确保模型的构造型设置为<i id="b612d999">tests</i> 。</p>   <p id="e57ebde0">      </p><figure><img alt="T3" title="T3" src="/help/img/idea/2019.2/T3.png" id="07da910f" width="542" height="245"></figure>   <p></p>   <p id="4efbbd0e">打开模型的属性，并添加<i id="26bd1248">jetbrains.mps.baselanguage.unitTest</i>语言，以便能够创建单元测试。添加<i id="c403ec58">jetbrains.mps.lang.test</i>语言以创建语言（节点）测试。</p>   <p id="795e5396">      </p><figure><img alt="T4" title="T4" src="/help/img/idea/2019.2/T4.png" id="86622b1c" width="536" height="444"></figure>   <p></p>   <p id="a0fdc9fe">另外，您需要确保包含测试模型的解决方案具有种类集-如果不需要其他两个选项（ <i id="4e26a9aa">Core插件</i>或<i id="a83cba6e">Editor插件</i> ），则通常选择<i id="0e653b42">Other</i> 。</p>   <p id="994360a9">      </p><figure><img alt="T8" title="T8" src="/help/img/idea/2019.2/T8.png" id="541bda59" width="536" height="444"></figure>      <br>右键单击模型，可以创建新的单元或语言测试。查看所有可用的根本概念：<p></p>   <p id="a6ad6ea6">      </p><figure><img alt="T5" title="T5" src="/help/img/idea/2019.2/T5.png" id="cc52843b" width="885" height="302"></figure>      <br>       <figure><img alt="T6" title="T6" src="/help/img/idea/2019.2/T6.png" id="a48fb0b3" width="924" height="333"></figure>   <p></p>   <h3 id="unittestingwithbtestcase">使用BTestCase进行单元测试</h3>   <p id="eff2c938">至于BaseLanguage测试用例，代表用<i id="da6786fc">baseLanguage</i>编写的单元测试。那些熟悉<b id="71a562f4">JUnit的</b>人很快就会在家中。</p>   <p id="d0efdeb7">      </p><figure><img alt="T7" title="T7" src="/help/img/idea/2019.2/T7.png" id="267085c5" width="1090" height="407"></figure>   <p></p>   <p id="0eda407b"><i id="96ac87ff">BTestCase</i>有四个部分：一个用于指定测试<b id="a613122a">成员</b> （字段），这些部分可被<b id="3aff6f60">测试方法</b>重用；一个用于指定<b id="cf14aae0">初始化</b>代码，一个用于<b id="e30ac09e">清理</b>代码，最后一个部分用于实际<b id="a1a2a841">测试方法</b> 。该语言还提供了一些方便的断言语句，代码完成可以揭示这些语句。</p>   <h3 id="testinfo">测试信息</h3>   <p id="b1264142">为了能够运行节点测试，您需要通过测试模型根目录中的<i id="7610240c">TestInfo</i>节点提供更多信息。</p>   <p id="4ff70fee">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/testInfox1.png"><img alt="testInfox1" title="testInfox1" src="/help/img/idea/2019.2/testInfox1.png" id="6e2c4d9a" width="500" height="476"></a></figure>   <p></p>   <p id="4d9dcaf5">特别是<i id="cb00cb4b">Project path</i>属性值得您注意。在这里，您需要提供到项目根目录的路径，可以是绝对路径或相对路径，也可以是对MPS中定义的<b id="6423c7ce">路径变量</b> （ <i id="c72fa80b">项目设置->路径变量</i> ）的引用。</p>   <p id="7662bf3b">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/pathVariables1.png"><img alt="pathVariables1" title="pathVariables1" src="/help/img/idea/2019.2/pathVariables1.png" id="70cb368f" width="300" height="1344"></a></figure>   <p></p>   <p id="2bc8a2ee">要使路径变量在Ant脚本中可用，请在构建文件中使用<code class="code">mps.macro.</code>前缀（请参见<a href="#fromabuildscript">下面的示例</a> ）。</p>      <h2 id="testingaspectsoflanguagedefinitions">测试语言定义的各个方面</h2>         <h3 id="nodetests">节点测试</h3>   <p id="8ea456a4"><i id="750ba570">NodesTestCase</i>包含三个部分：</p>   <p id="84f35d48">      </p><figure><img alt="T10" title="T10" src="/help/img/idea/2019.2/T10.png" id="987d05ec" width="278" height="164"></figure>      <br>第一个包含应验证的代码。<b id="88f2e007">测试方法</b>部分可能包含<i id="bfd6bac0">baseLanguage</i>代码，该代码进一步调查第一部分中指定的节点。<b id="60676082">实用程序方法</b>部分可以保存可重用的<i id="4fb6e4b1">baseLanguage</i>代码，通常可从<b id="39dc8cd1">测试方法中</b>调用该代码。<p></p>   <h4 id="checkingforcorrectness">检查正确性</h4>   <p id="2f12d05f">要测试类型系统正确计算类型并报告正确的错误和警告，请首先以所需的语言编写一段代码。然后，选择要测试其正确性的节点，然后选择“ <i id="321cc8ff">添加节点操作测试注释”</i>意图。</p>   <p id="f4bee88b">      </p><figure><img alt="T11" title="T11" src="/help/img/idea/2019.2/T11.png" id="3d24e4f6" width="348" height="251"></figure>       <figure><img alt="T12" title="T12" src="/help/img/idea/2019.2/T12.png" id="94b81d91" width="377" height="253"></figure>       <figure><img alt="T13" title="T13" src="/help/img/idea/2019.2/T13.png" id="b76c73e9" width="382" height="256"></figure>      <br>这将使用<b id="c05ca052">check</b>属性为代码添加注释，然后可以通过设置check类型使其更加具体：<p></p>   <p id="3618eb89">      </p><figure><img alt="T14" title="T14" src="/help/img/idea/2019.2/T14.png" id="662d6fc5" width="877" height="311"></figure>   <p></p>   <p id="7d3e960c">      </p><figure><img alt="T15" title="T15" src="/help/img/idea/2019.2/T15.png" id="13c915a1" width="473" height="236"></figure>      <br>       <i id="3dd12afe">请注意，许多选项已被弃用，不应再使用。</i>   <p></p>   <p id="72cdd608"><b id="2458e83c">for错误消息</b>选项可确保在检查的节点内潜在的错误消息被报告为测试失败。因此，在给定的示例中，我们正在检查整个<i id="301cdef2">Script中</i>是否没有错误。</p>   <h4 id="checkingfortypesystemanddata-flowerrorsandwarnings">检查类型系统和数据流错误和警告</h4>   <p id="684c966f">另一方面，如果您要测试MPS正确报告某个特定节点有错误或警告，请使用<b id="afc4f5f4">具有错误</b> / <b id="2c3e6949">具有警告</b>选项。</p>   <p id="ac424230">      </p><figure><img alt="T16" title="T16" src="/help/img/idea/2019.2/T16.png" id="77a6ee7e" width="462" height="254"></figure>   <p></p>   <p id="a10222e8">      </p><figure><img alt="T17" title="T17" src="/help/img/idea/2019.2/T17.png" id="9ce8bd49" width="655" height="236"></figure>      <br>这适用于警告和错误。可以使用单个注释声明多个警告和错误。<p></p>   <p id="5baac6b7">      </p><figure><img alt="T26 1" title="T26 1" src="/help/img/idea/2019.2/T26_1.png" id="d58901fd" width="1540" height="314"></figure>      <br>您甚至可以将检查与希望报告错误/警告的规则联系在一起。当光标悬停在节点上时， <i id="69d36a2c">按Alt + Enter</i> ，然后选择“ <b id="64b97b59">指定规则引用”</b>选项：<p></p>   <p id="ddaa9036">      </p><figure><img alt="T18" title="T18" src="/help/img/idea/2019.2/T18.png" id="3f557a19" width="636" height="259"></figure>      <br>       <figure><img alt="T19" title="T19" src="/help/img/idea/2019.2/T19.png" id="00af453d" width="689" height="239"></figure>   <p></p>   <p id="2b43eae6">规则的标识符已添加。您可以按<i id="6178e190">Control / Cmd + B（或单击）</i>导航到规则的定义。</p>   <p id="cb6db873">      </p><figure><img alt="T29" title="T29" src="/help/img/idea/2019.2/T29.png" id="44eb206b" width="952" height="252"></figure>      <br>运行时，测试将检查指定的规则是否确实是报告错误的规则。<p></p>   <h4 id="type-systemspecificoptions">类型系统特定的选项</h4>   <p id="47088050"><b id="757256c5">check</b>命令提供了几个选项来测试节点的计算出的类型。</p>   <p id="5a601284">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/T100.png"><img alt="T100" title="T100" src="/help/img/idea/2019.2/T100.png" id="defa65e1" width="900" height="700"></a></figure>      <br>       <figure><a class="lightbox" href="/help/img/idea/2019.2/T101.png"><img alt="T101" title="T101" src="/help/img/idea/2019.2/T101.png" id="2665fede" width="900" height="568"></a></figure>   <p></p>   <p id="e3539f1f">多个期望可以方便地组合：</p>   <p id="1d52c4bc">      </p><figure><img alt="T37" title="T37" src="/help/img/idea/2019.2/T37.png" id="d872951f" width="592" height="52"></figure>   <p></p>   <h4 id="testingscopes">测试范围</h4>   <p id="56a70daf"><b id="82ddc623">范围测试注释</b>允许测试验证范围规则将正确的项目带入适用的范围：</p>   <p id="c3924924">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/T102.png"><img alt="T102" title="T102" src="/help/img/idea/2019.2/T102.png" id="5eb4e5e9" width="900" height="728"></a></figure>      <br>“ <i id="6839d092">检查器”面板</i>包含必须显示在完成菜单中并且是带注释的单元格的有效目标的预期项目的列表：<p></p>   <p id="4fb28fd1">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/T103.png"><img alt="T103" title="T103" src="/help/img/idea/2019.2/T103.png" id="9d3c870a" width="900" height="898"></a></figure>      <br>       <figure><a class="lightbox" href="/help/img/idea/2019.2/T104.png"><img alt="T104" title="T104" src="/help/img/idea/2019.2/T104.png" id="40625dec" width="900" height="426"></a></figure>   <p></p>   <h4 id="testandutilitymethods">测试和实用方法</h4>   <p id="8e02f41f"><b id="08256c76">测试方法</b>可以通过标签引用<b id="08256c76">测试</b>中的节点。您可以使用意图将标签分配给节点：</p>   <p id="131e11d0">      </p><figure><img alt="T32" title="T32" src="/help/img/idea/2019.2/T32.png" id="17a1266d" width="557" height="251"></figure>      <br>然后，标签将在测试方法中可用。<p></p>   <p id="43c5928b">      </p><figure><img alt="T33" title="T33" src="/help/img/idea/2019.2/T33.png" id="870d1ed1" width="648" height="380"></figure>   <p></p>      <h3 id="editortests">编辑器测试</h3>   <p id="50b512cf">编辑器测试可让您测试编辑器的动态性-动作，意图和替代。</p>   <p id="6e3c4185">      </p><figure><img alt="T20" title="T20" src="/help/img/idea/2019.2/T20.png" id="6f070b93" width="842" height="254"></figure>   <p></p>   <p id="c64a03c5">一个空的编辑测试用例需要一个<b id="e1f59ace">名字</b> ，可选的<b id="df46e17e">说明</b> ，安装所应当的编辑器改造<b id="675a6e7b">前</b>的代码，转换（结果） <b id="e15b0dd3">后</b>的代码，最后实际触发其变换<b id="df65a7cb">代码</b>部分的代码。</p>   <p id="b5bdc0eb">      </p><figure><img alt="T21" title="T21" src="/help/img/idea/2019.2/T21.png" id="5f74722b" width="273" height="143"></figure>      <br>例如，测试了<b id="40658b16">Robot_Kaja</b>语言的<i id="7f001341">IfStatement</i>可以通过打字的<b id="6f6fd54d">if</b>关键字将如下所示前<b id="c92c6696">而</b>转化为<i id="f4a03376">WhileStatement：</i><p></p>   <p id="35fefe62">      </p><figure><img alt="T22" title="T22" src="/help/img/idea/2019.2/T22.png" id="c519b85c" width="830" height="324"></figure>      <br>在<b id="884fc7a3">代码</b>部分中， <i id="5b64109e">jetbrains.mps.lang.test</i>语言为您提供了多个选项来调用用户启动的动作-使用<b id="637eaf6a">类型</b> ， <b id="7bb89799">按键</b> ， <b id="1ae215b7">调用动作</b>或<b id="ee695ed4">意图</b> 。显然，您可以为普通的<i id="560fce00">baseLanguage</i>代码组合特殊的测试命令。<p></p>   <aside class="tip sideblock" rel="35fefe62" id="03a4c752" data-title="">      <p id="ee64b15c">为了能够指定所需的动作和意图，您需要将其模型导入测试模型。通常，在测试编辑器对用户生成的动作的反应时，最需要使用<i id="3bef2ddc">jetbrains.mps.ide.editor.actions</i>模型。</p>   </aside>   <p id="6f74c169"> </p>   <p id="a65b5907">要在代码中标记<b id="c2ca67b1">插入符号</b>的位置，请使用适当的意图，将光标置于所需的位置：</p>   <p id="0c979f94">      </p><figure><img alt="T23" title="T23" src="/help/img/idea/2019.2/T23.png" id="e97d80e9" width="357" height="227"></figure>   <p></p>   <p id="f9564d10">光标位置可以在<b id="7ad6268c">之前</b>和<b id="01c24417">之后的</b>代码中指定：</p>   <p id="98e07da9">      </p><figure><img alt="T25" title="T25" src="/help/img/idea/2019.2/T25.png" id="5cb8cc75" width="843" height="344"></figure>   <p></p>   <p id="a4256001"><i id="9c3f1517">单元格</i>编辑器注释具有额外的属性，可以微调插入符号在带注释的编辑器单元格中的位置。这些可以在“ <i id="cce2e721">检查器”</i>面板中设置。</p>   <h4 id="inspectingtheeditorstate">检查编辑器状态</h4>   <p id="13126bfb">一些编辑器测试可能希望更彻底地检查编辑器的状态。<i id="adcc5610">编辑器组件</i>表达式使您可以访问光标下的编辑器组件。您可以检查并修改其状态，如以下示例所示：</p>   <p id="1d0f89b3">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ec1.png"><img alt="ec1" title="ec1" src="/help/img/idea/2019.2/ec1.png" id="eda214f7" width="500" height="278"></a></figure>   <p></p>   <p id="73996ba3">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ec2.png"><img alt="ec2" title="ec2" src="/help/img/idea/2019.2/ec2.png" id="e064745a" width="500" height="230"></a></figure>   <p></p>   <p id="e8ffa40c">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ec3.png"><img alt="ec3" title="ec3" src="/help/img/idea/2019.2/ec3.png" id="879ea892" width="500" height="234"></a></figure>   <p></p>   <p id="ad9d1232">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ec4.png"><img alt="ec4" title="ec4" src="/help/img/idea/2019.2/ec4.png" id="1c0044cc" width="500" height="196"></a></figure>   <p></p>   <p id="432ecf5e"><i id="27d28c9e">适用意图的</i>表达式让您测试是否可以在给定的编辑器上下文中调用特定意图：</p>   <p id="69d3ac51">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/iiap.png"><img alt="iiap" title="iiap" src="/help/img/idea/2019.2/iiap.png" id="9d509e60" width="500" height="408"></a></figure>   <p></p>   <p id="ddbe44f6">您还可以分别使用<i id="dbe5a5fc">模型</i>和<i id="a0143a8e">项目</i>表达式来掌握<b id="56c27f5b">模型</b>和<b id="c45fc4ec">项目</b> 。</p>       <h3 id="migrationtests">迁移测试</h3>   <p id="651960f5">迁移测试可用于检查迁移脚本是否使用指定的输入产生了预期的结果。</p>   <p id="07ac90b6">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/new-migration-test.png"><img alt="新的迁移测试" title="新的迁移测试" src="/help/img/idea/2019.2/new-migration-test.png" id="c1a594fa" width="500" height="427"></a></figure>   <p></p>   <p id="741c646c">要创建迁移测试用例，您应该指定其名称和要测试的迁移脚本。在许多情况下，分别测试单个迁移脚本就足够了，但是，如果您需要测试迁移之间的交互方式，则可以在一个测试用例中安全地指定多个迁移脚本。</p>   <p id="9feeafc3">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/empty-migration-test.png"><img alt="空迁移测试" title="空迁移测试" src="/help/img/idea/2019.2/empty-migration-test.png" id="c2f056ba" width="500" height="229"></a></figure>   <p></p>   <p id="598595d1">另外，迁移测试用例包含要传递到迁移过程中的节点，以及那些预期会作为迁移输出出现的节点。</p>   <p id="5648577f">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/input-output.png"><img alt="输入输出" title="输入输出" src="/help/img/idea/2019.2/input-output.png" id="b514dbda" width="500" height="407"></a></figure>   <p></p>   <p id="31ff7017">运行时，迁移测试的行为如下：</p>   <ol class="list _decimal"><li class="list__item" id="29f99ad5"><p>输入节点作为根被复制到具有单个模型的空模块中。</p></li><li class="list__item" id="3c08efdc"><p>迁移脚本在该模块上运行。</p></li><li class="list__item" id="46813703"><p>将迁移后该模块中包含的根与预期输出进行比较</p></li><li class="list__item" id="f7699ffc"><p>调用有关迁移的check（）方法以确保它返回问题的空列表</p></li></ol>   <p id="69443c66">为了简化编写迁移测试的过程，可以使用当前部署的迁移脚本从输入节点自动生成预期的输出。为此，请使用“从输入生成输出”的意图。</p>   <p id="d3c881e2">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/generate-output.png"><img alt="产生输出" title="产生输出" src="/help/img/idea/2019.2/generate-output.png" id="74aa2565" width="500" height="334"></a></figure>   <p></p>       <h3 id="generatortests">发电机测试</h3>   <p id="5ad28d44">可以使用发电机测试来测试发电机。他们的目标是确保一个或一组发电机按预期进行转换。IDE支持进程内和进程外执行模式，以及MPS Ant构建脚本的执行。与MPS中的所有测试一样，用户指定：</p>   <ol class="list _decimal"><li class="list__item" id="8f9ebcd6"><p>输入模型形式的前提条件</p></li><li class="list__item" id="cf34e9ad"><p>输出模型形式的发电机的预期输出</p></li><li class="list__item" id="4c38c354"><p>生成器集，以显式<a href="generation-plan.html">生成器计划的</a>形式应用于输入模型；如果省略，则使用隐式生成器计划。</p></li></ol>   <p id="3dbbc92d"><i id="41faa0ae">jetbrains.mps.lang.test.generator</i>允许您创建<i id="17edcce3">GeneratorTests</i> 。<i id="43a49312">jetbrains.mps.lang.modelapi</i>语言将使您可以使用<b id="1fd7d512">模型/模型<i id="c59dd8ad">名称</i> /</b>语法创建方便的模型引用。</p>   <p id="89067221">      </p><figure><img alt="GT1" title="GT1" src="/help/img/idea/2019.2/GT1.png" id="ae41030c" width="500" height="514"></figure>   <p></p>   <p id="5ae3cf44">请注意，生成器测试的结构为您提供了一个称为<b id="a28ae3a5">Arguments</b>的部分，在其中需要指定所有模型（输入，预期输出以及可选的还有包含生成计划的模型），以及一个名为<b id="71ec8247">Assertions</b>的部分，其中需要进行转换和匹配被指定。</p>   <p id="06961bb3">在测试报告中向用户显示了发电机输出与预期输出不匹配的故障：</p>   <p id="69762726">      </p><figure><img alt="GT2" title="GT2" src="/help/img/idea/2019.2/GT2.png" id="a05ef54c" width="500" height="930"></figure>   <p></p>   <h2 id="runningthetests">运行测试</h2>   <h3 id="insidemps">内部MPS</h3>   <p id="beb7e16c">要在模型中运行测试，只需在“ <i id="24638ce8">项目视图”</i>面板中右键单击该模型，然后选择<b id="8e33bbe0">“运行测试”</b> ：</p>   <p id="56fc402a">      </p><figure><img alt="T39" title="T39" src="/help/img/idea/2019.2/T39.png" id="1a7e49e4" width="480" height="774"></figure>   <p></p>   <p id="c40fdc73">如果模型包含任何<i id="59419ec9">jetbrains.mps.lang.test</i>测试，则在后台静默启动MPS的新实例（这就是为什么与普通<i id="be09eec9">baseLanguage</i>单元测试相比，运行这些实例要花很多时间）并执行测试的原因在那个新的MPS实例中。创建一个新的运行配置，然后您可以重新使用或自定义它：</p>   <p id="8438e986">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/testrunconfig.png"><img alt="testrunconfig" title="testrunconfig" src="/help/img/idea/2019.2/testrunconfig.png" id="47bb9040" width="900" height="906"></a></figure>   <p></p>   <p id="f37873c3">“ <b id="43ae7534">运行配置”</b>对话框为您提供了用于调整测试性能的选项。</p>   <ul class="list _ul"><li class="list__item" id="2dfd0fbd"><p>         <b id="6976cab1">覆盖默认设置位置</b> -指定要在其中保存缓存的目录。默认情况下，MPS选择临时目录。每次运行都会清除该目录。</p></li><li class="list__item" id="9351e082">         <p id="e69b6b4e">            <b id="e7e45f2a">在同一过程中执行</b> -为了加快测试速度，可以在所谓的过程中模式下运行测试。它是专门为需要运行MPS实例的测试而设计的。（例如，对于语言类型系统测试，MPS应该可以安全地动态检查节点的类型。）<br>原始方法是在后台启动一个新的MPS实例，然后在该实例中运行测试。相反，此选项允许所有测试在相同的原始MPS流程中运行，因此无需创建新实例。设置选项“ <b id="78b4551a">在同一过程中执行”</b> （默认设置）后，将在当前MPS环境中执行测试。要以原始方式（在单独的过程中）运行测试，应取消选中此选项。这种测试执行方式适用于MPS中的所有测试类型。因此，它甚至适用于编辑器测试！</p>         <aside class="tip sideblock" rel="e69b6b4e" id="3907fa84" data-title="">            <p id="5f92b32e">尽管对于进行中的测试执行而言，性能要好得多，但是此工作流中仍存在某些缺点。请注意，测试是在与项目相同的MPS环境中执行的，因此有可能在测试中编写的代码可能具有潜在的危险，有时甚至造成真正的伤害。例如，处理当前项目的测试可能会破坏整个项目。因此，使用此功能的用户在编写测试时需要小心。<br>在某些情况下，测试不能在进程中执行。在这种情况下，可以在检查器中切换一个选项以禁止对该特定测试进行进程内执行。</p>         </aside>         <p id="4c6ceece">测试报告显示在屏幕底部的“ <b id="8ac95613">运行”</b>面板中：</p>      </li><li class="list__item" id="88178968">         <p id="55d1bc61">JUnit运行配置接受在运行测试之前部署的插件。用户可以提供在测试执行期间要部署的想法插件的列表。JUnit运行配置中也提供了之前的任务“ Assemble Plugins”。它会自动构建给定的插件并将工件复制到设置目录。</p>      </li></ul>   <p id="213619ab">      </p><figure><img alt="T41" title="T41" src="/help/img/idea/2019.2/T41.png" id="bf0f00ff" width="1136" height="401"></figure>   <p></p>   <p id="5e09ee37"> </p>   <h3 id="fromabuildscript">从构建脚本</h3>   <p id="c0a55362">为了使生成的构建脚本提供可用于使用Ant运行测试的<i id="d1102e35">测试</i>目标，您需要将<i id="5472ae3b">jetbrains.mps.build.mps</i>和<i id="f91b3ffd">jetbrains.mps.build.mps.tests</i>语言导入到您的构建脚本中，使用<i id="6bed3c1b">module-tests</i>插件进行声明，并指定<i id="88f07053">测试模块配置</i> 。</p>   <p id="fe86173c">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/testScript1.png"><img alt="testScript1" title="testScript1" src="/help/img/idea/2019.2/testScript1.png" id="8a007cd5" width="900" height="1972"></a></figure>   <p></p>   <p id="b9a4de24">要定义Ant将传递给JUnit的宏（例如，在测试中的TestInfo根目录中使用），请在其前面添加前缀<code class="code">mps.macro.</code> ：</p>   <p id="1055d57b">      </p><figure><img alt="image2016 10 13 17 29 27" title="image2016 10 13 17 29 27" src="/help/img/idea/2019.2/image2016-10-13-17-29-27.png" id="7e9cb868" width="614" height="156"></figure>   <p></p>   <h2 id="runningeditortestsinideaplugin">在IDEA插件中运行编辑器测试</h2>   <p id="44bb7148">使用新的JUnit测试套件（ <i id="5bdc1f61">jetbrains.mps.idea.core.tests。PluginsTestSuite</i> ），可以在使用MPS插件时在IntelliJ IDEA中针对您的语言执行编辑器测试。要使用此功能，您必须创建一个简单的ANT脚本，该脚本会将所有必需的插件安装到IntelliJ平台中，并通过指定测试模块名称来执行测试。</p><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月30日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="using-mps-debugger.html">使用MPS调试器</a> <a class="navigation-links__next" href="mps-dependencies.html">依赖项</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>