<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Testing languages - Help | MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Testing+languages.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Default</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_jbuilder">JBuilder</option><option data-group="primary" value="primary_mac_os_x">Mac OS X</option><option data-group="primary" value="primary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default">Default</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_jbuilder">JBuilder</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Testing+languages.html" id="testing-languages.xml">Testing languages</h1>   <h2 id="testinglanguages">Testing languages</h2>   <p id="548d3f5b">      <ul data-skip-index="skip"><li class="list__item"><a href="#testinglanguages">Testing languages</a></li><li class="list__item"><a href="#introduction">Introduction</a></li><li class="list__item"><a href="#quicknavigationtable">Quick navigation table</a></li><li class="list__item"><a href="#testscreation">Tests creation</a></li><li class="list__item"><a href="#1.createatest%C2%A0aspectinyourlanguage">1. Create a Test&nbsp;aspect in your language</a></li><li class="list__item"><a href="#2.createatestmodel">2. Create a test model</a></li><li class="list__item"><a href="#unittestingwithbtestcase">Unit testing with BTestCase</a></li><li class="list__item"><a href="#testinfo">TestInfo</a></li><li class="list__item"><a href="#testingaspectsoflanguagedefinitions">Testing aspects of language definitions</a></li><li class="list__item"><a href="#nodetests">Node tests</a></li><li class="list__item"><a href="#checkingforcorrectness">Checking for correctness</a></li><li class="list__item"><a href="#checkingfortypesystemanddata-flowerrorsandwarnings">Checking for type system and data-flow errors and warnings</a></li><li class="list__item"><a href="#type-systemspecificoptions">Type-system specific options</a></li><li class="list__item"><a href="#testingscopes">Testing scopes</a></li><li class="list__item"><a href="#testandutilitymethods">Test and utility methods</a></li><li class="list__item"><a href="#editortests">Editor tests</a></li><li class="list__item"><a href="#inspectingtheeditorstate">Inspecting the editor state</a></li><li class="list__item"><a href="#migrationtests">Migration tests</a></li><li class="list__item"><a href="#generatortests">Generator tests</a></li><li class="list__item"><a href="#runningthetests">Running the tests</a></li><li class="list__item"><a href="#insidemps">Inside MPS</a></li><li class="list__item"><a href="#fromabuildscript">From a build script</a></li><li class="list__item"><a href="#runningeditortestsinideaplugin">Running Editor tests in IDEA Plugin</a></li></ul>   </p>      <h2 id="introduction">Introduction</h2>   <p id="beb44451">Testing is an essential part of language designer's work. To be of any good MPS has to provide testing facilities both for <i id="3e6a5427">BaseLanguage</i> code and for languages. While the&nbsp;<i id="ee7915cf">jetbrains.mps.baselanguage.unitTest</i>&nbsp;language enables <b id="16d2b78f">JUnit</b>-like unit tests to test <i id="d6b1ed54">BaseLanguage</i> code,&nbsp;the <b id="d4d9ae59">Language test</b> language&nbsp;<i id="6ba4845b">jetbrains.mps.lang.test</i> provides a useful interface for creating language tests.</p>   <aside class="tip sideblock" data-title="" rel="beb44451" id="91d9bc21">      <p id="243f0d6f">To minimize impact of test assertions on the test code, the <b id="eadff092">Language test</b> language describes the testing aspects through <b id="caef45a4">annotations</b> (in a similar way that the generator language annotates template code with generator <i id="6c1e3c8d">macros</i>).</p>   </aside>   <h2 id="quicknavigationtable">Quick navigation table</h2>      <p id="f046b274">Different aspects of language definitions are tested with different means:</p>   <div class="table-wrapper"><table width="100%" id="328bc9fc"><thead><tr id="b7562f0c" class="ijRowHead"><th id="f7a92678" width="30%">            <p id="87e871c5">Language definition aspects</p>         </th><th id="f807f2df" width="70%">            <p id="9243fe43">The way to test</p>         </th></tr></thead><tbody><tr id="a8b11dbc" class="ijRowOdd"><td id="1caab034">            <p id="6d110236">Intentions <br> Actions <br> Side-transforms <br> Editor ActionMaps <br> KeyMaps</p>         </td><td id="7148ef4e">            <p id="4dcc639b">Use the <i id="a601d6d4">jetbrains.mps.lang.test</i>&nbsp;language to create <i id="60bd1ac3">EditorTestCases</i>. You set the stage by providing an initial piece of code, define a set of editing actions to perform against the initial code and also provide an expected outcome as another piece of code. Any differences between the expected and real output of the test will be reported as errors. <br>See the <a href="#editortests">Editor Tests section</a> for details.</p>         </td></tr><tr id="e73f9606" class="ijRowEven"><td id="4ee89a32">            <p id="5f09da42">Constraints <br> Scopes <br> Type-system <br> Dataflow</p>         </td><td id="4c3934b3">            <p id="8bf531d8">Use the&nbsp;<i id="26f21ce7">jetbrains.mps.lang.test</i>&nbsp;language to create&nbsp;<i id="53eea807">NodesTestCases</i>. In these test cases write snippets of "correct" code and ensure no error or warning is reported on them. Similarly, write "invalid" pieces of code and assert that an error or a warning is reported in the correct node. <br>See the&nbsp;<a href="#nodetests">Nodes Tests section</a>&nbsp;for details.</p>         </td></tr><tr id="bca5b0a7" class="ijRowOdd"><td id="c2637f96">            <p id="eb75c3e7">Generator <br> TextGen</p>         </td><td id="239bb30a">            <p id="b0e7a20e">Use the <i id="66bd1a88">&nbsp;</i>language to create <i id="125fa173">GeneratorTests</i>. These let you transform test models and check whether the generated code matches the expected outcome.<br>See the&nbsp;<a href="#generatortests">Generator Tests section</a>&nbsp;for details.</p>            <p id="1240a8c6">There is currently no built-in testing facility for these aspects. There are a few practices that have worked for us over time:</p>            <ul class="list _ul"><li class="list__item" id="4b380d19"><p>Perhaps the most reasonable way to check the generation process is by generating models, for which we already know the correct generation result, and then comparing the generated output with the expected one. For example, if your generated code is stored in a VCS, you could check for differences&nbsp;after each run of the tests.</p></li><li class="list__item" id="f541e60e"><p>You may also consider providing code snippets that may represent corner cases for the generator and check whether the generator successfully generates output from them, or whether it fails.</p></li><li class="list__item" id="17b0ff16"><p>Compiling and running the generated code may also increase your confidence about the correctness of your generator.</p></li></ul>         </td></tr><tr id="65182d97" class="ijRowEven"><td id="3f353889">            <p id="70d619a0">Migrations</p>         </td><td id="378775c6">            <p id="e5ef76cc">Use the&nbsp;<i id="7cbe0209">jetbrains.mps.lang.test</i>&nbsp;language to create <i id="f28d4900">MigrationTestCases</i>. In these test cases write pieces of code to run migration on them.<br>See the&nbsp;<a href="#migrationtests">Migration Tests section</a>&nbsp;for details.</p>         </td></tr></tbody></table></div>   <h2 id="testscreation">Tests creation</h2>   <p id="0271bff9">There are two options to add test models into your projects.</p>   <h3 id="1.createatest&nbsp;aspectinyourlanguage">1. Create a TestÂ aspect in your language</h3>   <p id="e04a3d4e">This is easier to setup, but can only contain tests that do not need to run in a newly started MPS instance. So typically can hold plain&nbsp;baselanguage&nbsp;unit tests. To create the <i id="983d71bc">Test</i>&nbsp;aspect,&nbsp;right-click on the language node and choose chose <code class="code">New-&gt;Test Aspect</code>.</p>   <p id="748d7ab2">      <figure><img alt="T2" title="T2" src="/help/img/idea/2019.2/T2.png" id="7c29e177" width="651" height="309"></figure>   </p>   <p id="3255e7e2">Now you can start creating unit tests in the <i id="0b11b264">Test</i>&nbsp;aspect.</p>   <p id="98912b14">      <figure><img alt="T1" title="T1" src="/help/img/idea/2019.2/T1.png" id="cad0ba55" width="808" height="218"></figure>      <br> Right-clicking on the <i id="19bc604e">Test</i>&nbsp;aspect will give you the option to run all tests. The test report will then show up in a <i id="6a5ff047">Run</i>&nbsp;panel at the bottom of the screen.</p>   <h3 id="2.createatestmodel">2. Create a test model</h3>   <p id="42a92e47">This option gives you more flexibility.&nbsp;Create a test model, either in a new or an existing solution. Make sure the model's stereotype is set to <i id="b612d999">tests</i>.</p>   <p id="e57ebde0">      <figure><img alt="T3" title="T3" src="/help/img/idea/2019.2/T3.png" id="07da910f" width="542" height="245"></figure>   </p>   <p id="4efbbd0e">Open the model's properties and add the&nbsp;<i id="26bd1248">jetbrains.mps.baselanguage.unitTest</i>&nbsp;language in order to be able to create unit tests. Add the&nbsp;<i id="c403ec58">jetbrains.mps.lang.test</i>&nbsp;language in order to create language (node) tests.</p>   <p id="795e5396">      <figure><img alt="T4" title="T4" src="/help/img/idea/2019.2/T4.png" id="86622b1c" width="536" height="444"></figure>   </p>   <p id="a0fdc9fe">Additionally, you need to make sure the solution containing your test model has a kind set -&nbsp;typically choose&nbsp;<i id="0e653b42">Other</i>, if you do not need either of the two other options (<i id="4e26a9aa">Core plugin</i>&nbsp;or&nbsp;<i id="a83cba6e">Editor plugin</i>).&nbsp;</p>   <p id="994360a9">      <figure><img alt="T8" title="T8" src="/help/img/idea/2019.2/T8.png" id="541bda59" width="536" height="444"></figure>      <br> Right-clicking on the model allows you to create new unit or language tests. See all the root concepts that are available:</p>   <p id="a6ad6ea6">      <figure><img alt="T5" title="T5" src="/help/img/idea/2019.2/T5.png" id="cc52843b" width="885" height="302"></figure>      <br>       <figure><img alt="T6" title="T6" src="/help/img/idea/2019.2/T6.png" id="a48fb0b3" width="924" height="333"></figure>   </p>   <h3 id="unittestingwithbtestcase">Unit testing with BTestCase</h3>   <p id="eff2c938">As for BaseLanguage Test Case, represents a unit test written in <i id="da6786fc">baseLanguage</i>. Those are familiar with <b id="71a562f4">JUnit</b>&nbsp;will be quickly at home.</p>   <p id="d0efdeb7">      <figure><img alt="T7" title="T7" src="/help/img/idea/2019.2/T7.png" id="267085c5" width="1090" height="407"></figure>   </p>   <p id="0eda407b">A <i id="96ac87ff">BTestCase</i>&nbsp;has four sections - one to specify test <b id="a613122a">members</b> (fields), which are reused by <b id="3aff6f60">test methods</b>, one to specify <b id="cf14aae0">initialization</b> code, one for <b id="e30ac09e">clean up</b> code and finally a section for the actual <b id="a1a2a841">test methods</b>. The language also provides a couple of handy assertion statements, which code completion reveals.</p>   <h3 id="testinfo">TestInfo</h3>   <p id="b1264142">In order to be able to run node tests, you need to provide more information through a <i id="7610240c">TestInfo</i>&nbsp;node in the root of your test model.</p>   <p id="4ff70fee">      <figure><a class="lightbox" href="/help/img/idea/2019.2/testInfox1.png"><img alt="testInfox1" title="testInfox1" src="/help/img/idea/2019.2/testInfox1.png" id="6e2c4d9a" width="500" height="476"></a></figure>   </p>   <p id="4d9dcaf5">Especially the <i id="cb00cb4b">Project path</i>&nbsp;attribute is worth your attention. This is where you need to provide a path to the project root, either as an absolute or relative path, or as a reference to a <b id="6423c7ce">Path Variable</b>&nbsp;defined in MPS (<i id="c72fa80b">Project Settings -&gt; Path Variables</i>).</p>   <p id="7662bf3b">      <figure><a class="lightbox" href="/help/img/idea/2019.2/pathVariables1.png"><img alt="pathVariables1" title="pathVariables1" src="/help/img/idea/2019.2/pathVariables1.png" id="70cb368f" width="300" height="1344"></a></figure>   </p>   <p id="2bc8a2ee">To make the path variable available in Ant scripts, define it in your build file with the&nbsp;<code class="code">mps.macro.</code>&nbsp;prefix (see <a href="#fromabuildscript">example below</a>).</p>      <h2 id="testingaspectsoflanguagedefinitions">Testing aspects of language definitions</h2>         <h3 id="nodetests">Node tests</h3>   <p id="8ea456a4">A <i id="750ba570">NodesTestCase</i>&nbsp;contains three sections:</p>   <p id="84f35d48">      <figure><img alt="T10" title="T10" src="/help/img/idea/2019.2/T10.png" id="987d05ec" width="278" height="164"></figure>      <br> The first one contains code that should be verified. The section for <b id="88f2e007">test methods</b>&nbsp;may contain <i id="bfd6bac0">baseLanguage</i> code that further investigates nodes specified in the first section. The <b id="60676082">utility methods</b>&nbsp;section may hold reusable <i id="4fb6e4b1">baseLanguage</i> code, typically invoked from the <b id="39dc8cd1">test methods</b>.</p>   <h4 id="checkingforcorrectness">Checking for correctness</h4>   <p id="2f12d05f">To test that the type system correctly calculates types and that proper errors and warnings are reported, you write a piece of code in your desired language first. Then select the nodes, that you'd like to have tested for correctness and choose the <i id="321cc8ff">Add Node Operations Test Annotation</i>&nbsp;intention.</p>   <p id="f4bee88b">      <figure><img alt="T11" title="T11" src="/help/img/idea/2019.2/T11.png" id="3d24e4f6" width="348" height="251"></figure>       <figure><img alt="T12" title="T12" src="/help/img/idea/2019.2/T12.png" id="94b81d91" width="377" height="253"></figure>       <figure><img alt="T13" title="T13" src="/help/img/idea/2019.2/T13.png" id="b76c73e9" width="382" height="256"></figure>      <br> This will annotate the code with a <b id="c05ca052">check</b>&nbsp;attribute, which then can be made more concrete by setting a type of the check:</p>   <p id="3618eb89">      <figure><img alt="T14" title="T14" src="/help/img/idea/2019.2/T14.png" id="662d6fc5" width="877" height="311"></figure>   </p>   <p id="7d3e960c">      <figure><img alt="T15" title="T15" src="/help/img/idea/2019.2/T15.png" id="13c915a1" width="473" height="236"></figure>      <br>       <i id="3dd12afe">Note that many of the options have been deprecated and should no longer be used.</i>   </p>   <p id="72cdd608">The <b id="2458e83c">for error messages</b>&nbsp;option ensures that potential error messages inside the checked node get reported as test failures. So, in the given example, we are checking that there are no errors in the whole <i id="301cdef2">Script</i>.</p>   <h4 id="checkingfortypesystemanddata-flowerrorsandwarnings">Checking for type system and data-flow errors and warnings</h4>   <p id="684c966f">If, on the other hand, you want to test that a particular node is correctly reported by MPS as having an error or a warning, use the <b id="afc4f5f4">has error</b>&nbsp;/ <b id="2c3e6949">has warning</b>&nbsp;option.</p>   <p id="ac424230">      <figure><img alt="T16" title="T16" src="/help/img/idea/2019.2/T16.png" id="77a6ee7e" width="462" height="254"></figure>   </p>   <p id="a10222e8">      <figure><img alt="T17" title="T17" src="/help/img/idea/2019.2/T17.png" id="9ce8bd49" width="655" height="236"></figure>      <br>This works for both warnings and errors. Multiple warnings and errors can be declared with a single annotation.</p>   <p id="5baac6b7">      <figure><img alt="T26 1" title="T26 1" src="/help/img/idea/2019.2/T26_1.png" id="d58901fd" width="1540" height="314"></figure>      <br> You can even tie the check with the rule that you expect to report the error / warning. Hit <i id="69d36a2c">Alt + Enter</i>&nbsp;when with cursor over the node and pick the <b id="64b97b59">Specify Rule References</b>&nbsp;option:</p>   <p id="ddaa9036">      <figure><img alt="T18" title="T18" src="/help/img/idea/2019.2/T18.png" id="3f557a19" width="636" height="259"></figure>      <br>       <figure><img alt="T19" title="T19" src="/help/img/idea/2019.2/T19.png" id="00af453d" width="689" height="239"></figure>   </p>   <p id="2b43eae6">An identifier of the rule has been added. You can navigate by <i id="6178e190">Control/Cmd + B (or click)</i>&nbsp;to the definition of the rule.</p>   <p id="cb6db873">      <figure><img alt="T29" title="T29" src="/help/img/idea/2019.2/T29.png" id="44eb206b" width="952" height="252"></figure>      <br> When run, the test will check that the specified rule is really the one that reports the error.</p>   <h4 id="type-systemspecificoptions">Type-system specific options</h4>   <p id="47088050">The <b id="757256c5">check</b>&nbsp;command offers several options to test the calculated type of a node.</p>   <p id="5a601284">      <figure><a class="lightbox" href="/help/img/idea/2019.2/T100.png"><img alt="T100" title="T100" src="/help/img/idea/2019.2/T100.png" id="defa65e1" width="900" height="700"></a></figure>      <br>       <figure><a class="lightbox" href="/help/img/idea/2019.2/T101.png"><img alt="T101" title="T101" src="/help/img/idea/2019.2/T101.png" id="2665fede" width="900" height="568"></a></figure>   </p>   <p id="e3539f1f">Multiple expectations can be combined conveniently:</p>   <p id="1d52c4bc">      <figure><img alt="T37" title="T37" src="/help/img/idea/2019.2/T37.png" id="d872951f" width="592" height="52"></figure>   </p>   <h4 id="testingscopes">Testing scopes</h4>   <p id="56a70daf">The <b id="82ddc623">Scope Test Annotation</b>&nbsp;allows the test to verify that the scoping rules bring the correct items into the applicable scope:</p>   <p id="c3924924">      <figure><a class="lightbox" href="/help/img/idea/2019.2/T102.png"><img alt="T102" title="T102" src="/help/img/idea/2019.2/T102.png" id="5eb4e5e9" width="900" height="728"></a></figure>      <br> The <i id="6839d092">Inspector panel</i>&nbsp;holds the list of expected items that must appear in the completion menu and that are valid targets for the annotated cell:</p>   <p id="4fb28fd1">      <figure><a class="lightbox" href="/help/img/idea/2019.2/T103.png"><img alt="T103" title="T103" src="/help/img/idea/2019.2/T103.png" id="9d3c870a" width="900" height="898"></a></figure>      <br>       <figure><a class="lightbox" href="/help/img/idea/2019.2/T104.png"><img alt="T104" title="T104" src="/help/img/idea/2019.2/T104.png" id="40625dec" width="900" height="426"></a></figure>   </p>   <h4 id="testandutilitymethods">Test and utility methods</h4>   <p id="8e02f41f">The <b id="08256c76">test methods</b>&nbsp;may refer to nodes in your tests through labels. You assign labels to nodes using intentions:</p>   <p id="131e11d0">      <figure><img alt="T32" title="T32" src="/help/img/idea/2019.2/T32.png" id="17a1266d" width="557" height="251"></figure>      <br> The labels then become available in the test methods.</p>   <p id="43c5928b">      <figure><img alt="T33" title="T33" src="/help/img/idea/2019.2/T33.png" id="870d1ed1" width="648" height="380"></figure>   </p>      <h3 id="editortests">Editor tests</h3>   <p id="50b512cf">Editor tests allow you to test the dynamism of the editor - actions, intentions and substitutions.</p>   <p id="6e3c4185">      <figure><img alt="T20" title="T20" src="/help/img/idea/2019.2/T20.png" id="6f070b93" width="842" height="254"></figure>   </p>   <p id="c64a03c5">An empty editor test case needs a <b id="e1f59ace">name</b>, an optional <b id="df46e17e">description</b>, setup the code as it should look&nbsp;<b id="675a6e7b">before</b> an editor transformation, the code&nbsp;<b id="e15b0dd3">after</b> the transformation (result) and finally the actual trigger that transforms the code in the <b id="df65a7cb">code</b>&nbsp;section.</p>   <p id="b5bdc0eb">      <figure><img alt="T21" title="T21" src="/help/img/idea/2019.2/T21.png" id="5f74722b" width="273" height="143"></figure>      <br> For example, a test that an <i id="7f001341">IfStatement</i> of the <b id="40658b16">Robot_Kaja</b>&nbsp;language can be transformed into a <i id="f4a03376">WhileStatement</i> by typing <b id="c92c6696">while</b>&nbsp;in front of the <b id="6f6fd54d">if</b>&nbsp;keyword would look as follows:</p>   <p id="35fefe62">      <figure><img alt="T22" title="T22" src="/help/img/idea/2019.2/T22.png" id="c519b85c" width="830" height="324"></figure>      <br> In the <b id="884fc7a3">code</b>&nbsp;section the&nbsp;<i id="5b64109e">jetbrains.mps.lang.test</i>&nbsp;language gives you several options to invoke user-initiated actions - use <b id="637eaf6a">type</b>, <b id="7bb89799">press keys</b>, <b id="1ae215b7">invoke action</b>&nbsp;or <b id="ee695ed4">invoke intention</b>. Obviously you can combine the special test commands for the plain <i id="560fce00">baseLanguage</i> code.</p>   <aside class="tip sideblock" data-title="" rel="35fefe62" id="03a4c752">      <p id="ee64b15c">In order to be able to specify the desired actions and intentions, you need to import their models into the test model. Typically the <i id="3bef2ddc">jetbrains.mps.ide.editor.actions</i> model is the most needed one when testing the editor reactions to user-generated actions.</p>   </aside>   <p id="6f74c169">&nbsp;</p>   <p id="a65b5907">To mark the position of the&nbsp;<b id="c2ca67b1">caret</b>&nbsp;in the code, use the appropriate intention with the cursor located at the desired position:</p>   <p id="0c979f94">      <figure><img alt="T23" title="T23" src="/help/img/idea/2019.2/T23.png" id="e97d80e9" width="357" height="227"></figure>   </p>   <p id="f9564d10">The cursor position can be specified in both the <b id="7ad6268c">before</b>&nbsp;and the <b id="01c24417">after</b>&nbsp;code:</p>   <p id="98e07da9">      <figure><img alt="T25" title="T25" src="/help/img/idea/2019.2/T25.png" id="5cb8cc75" width="843" height="344"></figure>   </p>   <p id="a4256001">The <i id="9c3f1517">cell</i>&nbsp;editor annotation has extra properties to fine-tune the position of the caret in the annotated editor cell. These can be set in the <i id="cce2e721">Inspector</i>&nbsp;panel.</p>   <h4 id="inspectingtheeditorstate">Inspecting the editor state</h4>   <p id="13126bfb">Some editor tests may wish to inspect the state of the editor more thoroughly. The&nbsp;<i id="adcc5610">editor component</i> expression gives you access to the editor component under cursor. You can inspect its state as well as modify it, like in these samples:</p>   <p id="1d0f89b3">      <figure><a class="lightbox" href="/help/img/idea/2019.2/ec1.png"><img alt="ec1" title="ec1" src="/help/img/idea/2019.2/ec1.png" id="eda214f7" width="500" height="278"></a></figure>   </p>   <p id="73996ba3">      <figure><a class="lightbox" href="/help/img/idea/2019.2/ec2.png"><img alt="ec2" title="ec2" src="/help/img/idea/2019.2/ec2.png" id="e064745a" width="500" height="230"></a></figure>   </p>   <p id="e8ffa40c">      <figure><a class="lightbox" href="/help/img/idea/2019.2/ec3.png"><img alt="ec3" title="ec3" src="/help/img/idea/2019.2/ec3.png" id="879ea892" width="500" height="234"></a></figure>   </p>   <p id="ad9d1232">      <figure><a class="lightbox" href="/help/img/idea/2019.2/ec4.png"><img alt="ec4" title="ec4" src="/help/img/idea/2019.2/ec4.png" id="1c0044cc" width="500" height="196"></a></figure>   </p>   <p id="432ecf5e">The&nbsp;<i id="27d28c9e">is intention applicable</i> expression let's you test, whether a particular intention can be invoked in the given editor context:</p>   <p id="69d3ac51">      <figure><a class="lightbox" href="/help/img/idea/2019.2/iiap.png"><img alt="iiap" title="iiap" src="/help/img/idea/2019.2/iiap.png" id="9d509e60" width="500" height="408"></a></figure>   </p>   <p id="ddbe44f6">You can also get hold of the&nbsp;<b id="56c27f5b">model</b> and&nbsp;<b id="c45fc4ec">project</b> using the&nbsp;<i id="dbe5a5fc">model</i> and&nbsp;<i id="a0143a8e">project</i> expressions, respectively.</p>       <h3 id="migrationtests">Migration tests</h3>   <p id="651960f5">Migrations tests can be used to check that migration scripts produce expected results using specified input.</p>   <p id="07ac90b6">      <figure><a class="lightbox" href="/help/img/idea/2019.2/new-migration-test.png"><img alt="new migration test" title="new migration test" src="/help/img/idea/2019.2/new-migration-test.png" id="c1a594fa" width="500" height="427"></a></figure>   </p>   <p id="741c646c">To create a migration test case you should specify its name and the migration scripts to test. In many cases it should be enough to test individual migration scripts separately, but you can safely specify more than one migration script in a single test case, if you need to test how migrations interact with one another.</p>   <p id="9feeafc3">      <figure><a class="lightbox" href="/help/img/idea/2019.2/empty-migration-test.png"><img alt="empty migration test" title="empty migration test" src="/help/img/idea/2019.2/empty-migration-test.png" id="c2f056ba" width="500" height="229"></a></figure>   </p>   <p id="598595d1">Additionally, migration test cases contain nodes to be passed into the migration process and those also nodes that are expected to come out as the ouptut of the migration.</p>   <p id="5648577f">      <figure><a class="lightbox" href="/help/img/idea/2019.2/input-output.png"><img alt="input output" title="input output" src="/help/img/idea/2019.2/input-output.png" id="b514dbda" width="500" height="407"></a></figure>   </p>   <p id="31ff7017">When running, migration tests behave the following way:</p>   <ol class="list _decimal"><li class="list__item" id="29f99ad5"><p>Input nodes are copied as roots into an empty module with single model.</p></li><li class="list__item" id="3c08efdc"><p>Migration scripts run on that module.</p></li><li class="list__item" id="46813703"><p>Roots contained in that module after migration are compared with the expected ouput</p></li><li class="list__item" id="f7699ffc"><p>The check() method of the concerned migration(s) is invoked to ensure that it returns an empty list of problems</p></li></ol>   <p id="69443c66">To simplify the process of writing migration tests, the expected output can be generated automatically from the input nodes using the currently deployed migration scripts. To do this, use the intention called 'Generate Output from Input'.</p>   <p id="d3c881e2">      <figure><a class="lightbox" href="/help/img/idea/2019.2/generate-output.png"><img alt="generate output" title="generate output" src="/help/img/idea/2019.2/generate-output.png" id="74aa2565" width="500" height="334"></a></figure>   </p>       <h3 id="generatortests">Generator tests</h3>   <p id="5ad28d44">Generators can be tested with generator tests. Their goal is to ensure that a generator, or set of generators, do their transformations as expected. Both in-process and out-of-process execution modes are supported from the IDE, as well as execution from MPS Ant build scripts. As with all tests in MPS the user specifies:</p>   <ol class="list _decimal"><li class="list__item" id="8f9ebcd6"><p>the pre-conditions in form of input models</p></li><li class="list__item" id="cf34e9ad"><p>the expected output of the generator in form of output models</p></li><li class="list__item" id="4c38c354"><p>the set of generators to apply to the input models in form of an explicit&nbsp;<a href="generation-plan.html">generator plan</a>&nbsp;or, if omitted, the implicit generator plan is used.</p></li></ol>   <p id="3dbbc92d">The&nbsp;<i id="41faa0ae">jetbrains.mps.lang.test.generator</i> allows you to create&nbsp;<i id="17edcce3">GeneratorTests</i>. The <i id="43a49312">jetbrains.mps.lang.modelapi</i> language will let you create convenient model references using the&nbsp;<b id="1fd7d512">model/<i id="c59dd8ad">name of the model</i>/</b> syntax.</p>   <p id="89067221">      <figure><img alt="GT1" title="GT1" src="/help/img/idea/2019.2/GT1.png" id="ae41030c" width="500" height="514"></figure>   </p>   <p id="5ae3cf44">Notice that the structure of a generator test gives you a section called <b id="a28ae3a5">Arguments</b>, where all the models need to be specified (input, expected output and optionally also models holding the generation plans), and a section called&nbsp;<b id="71ec8247">Assertions</b>, where the desired transformations and matching are specified.</p>   <p id="06961bb3">A failure to match the generator output with the expected output is presented to the user in the test report:</p>   <p id="69762726">      <figure><img alt="GT2" title="GT2" src="/help/img/idea/2019.2/GT2.png" id="a05ef54c" width="500" height="930"></figure>   </p>   <h2 id="runningthetests">Running the tests</h2>   <h3 id="insidemps">Inside MPS</h3>   <p id="beb7e16c">To run tests in a model, just right-click the model in the <i id="24638ce8">Project View</i>&nbsp;panel and choose <b id="8e33bbe0">Run tests</b>:</p>   <p id="56fc402a">      <figure><img alt="T39" title="T39" src="/help/img/idea/2019.2/T39.png" id="1a7e49e4" width="480" height="774"></figure>   </p>   <p id="c40fdc73">If the model contains any of the&nbsp;<i id="59419ec9">jetbrains.mps.lang.test</i>&nbsp;tests, a new instance of MPS is silently started in the background (that's why it takes quite some time to run these compared to plain <i id="be09eec9">baseLanguage</i> unit tests) and the tests are executed in that new MPS instance. A new run configuration is created, which you can then re-use or customize:</p>   <p id="8438e986">      <figure><a class="lightbox" href="/help/img/idea/2019.2/testrunconfig.png"><img alt="testrunconfig" title="testrunconfig" src="/help/img/idea/2019.2/testrunconfig.png" id="47bb9040" width="900" height="906"></a></figure>   </p>   <p id="f37873c3">The <b id="43ae7534">Run configurations</b>&nbsp;dialog gives you options to tune the performance of tests.</p>   <ul class="list _ul"><li class="list__item" id="2dfd0fbd"><p>         <b id="6976cab1">Override the default settings location</b>&nbsp;-&nbsp;specify the directory to save the caches in. By default, MPS chooses the temp directory. The directory is cleared on every run.</p></li><li class="list__item" id="9351e082">         <p id="e69b6b4e">            <b id="e7e45f2a">Execute in the same process</b>&nbsp;-&nbsp;to speed up testing tests can be run in a so-called in-process mode. It was designed specifically for tests, which need to have an MPS instance running.&nbsp;(For example, for the language type-system tests MPS should safely be able to check the types of nodes on the fly.)<br> The original way was to have a new MPS instance started in the background and run the tests in this instance. This option, instead, allows to have all tests run in the same original MPS process, so no new instance needs to be created. When the option <b id="78b4551a">Execute in the same process</b>&nbsp;is set (the default setting), the test is executed in the current MPS environment. To run tests in the original way (in a separate process) you should uncheck this option.&nbsp;This way of tests' execution is applicable to all test kinds in MPS. Thus it works even for the editor tests!</p>         <aside class="tip sideblock" data-title="" rel="e69b6b4e" id="3907fa84">            <p id="5f92b32e">Although the performance is so much better for in-process test execution, there are certain drawbacks in this workflow. Note, that the tests are executed in the same MPS environment that holds the project, so there is a possibility, that the code you write in your test may be potentially dangerous and sometimes cause real harm. For example, a test, which disposes the current project, could destroy the whole project. So the user of this feature needs to be careful when writing the tests.<br> There are certain cases when the test must not be executable in-process. In that case it is possible to switch an option in the inspector to prohibit the in-process execution for that specific test.</p>         </aside>         <p id="4c6ceece">The test report is shown in the <b id="8ac95613">Run</b>&nbsp;panel at the bottom of the screen:</p>      </li><li class="list__item" id="88178968">         <p id="55d1bc61">The JUnit run configuration accepts plugins to deploy before running the tests. The user can provide a list of idea plugins to be deployed during the test execution.            The before task 'Assemble Plugins' is available in the JUnit run configuration as well. It automatically builds the given plugins and copies the artifacts to the settings directory.         </p>      </li></ul>   <p id="213619ab">      <figure><img alt="T41" title="T41" src="/help/img/idea/2019.2/T41.png" id="bf0f00ff" width="1136" height="401"></figure>   </p>   <p id="5e09ee37">&nbsp;</p>   <h3 id="fromabuildscript">From a build script</h3>   <p id="c0a55362">In order to have your generated build script offer the <i id="d1102e35">test</i> target that you could use to run the tests using Ant, you need to import the <i id="5472ae3b">jetbrains.mps.build.mps</i>&nbsp;and&nbsp;<i id="f91b3ffd">jetbrains.mps.build.mps.tests</i>&nbsp;languages into your build script, declare using the <i id="6bed3c1b">module-tests</i>&nbsp;plugin and specify a <i id="88f07053">test modules configuration</i>.</p>   <p id="fe86173c">      <figure><a class="lightbox" href="/help/img/idea/2019.2/testScript1.png"><img alt="testScript1" title="testScript1" src="/help/img/idea/2019.2/testScript1.png" id="8a007cd5" width="900" height="1972"></a></figure>   </p>   <p id="b9a4de24">To define a macro that Ant will pass to JUnit (e.g. for use in TestInfo roots in your tests), prefix it with&nbsp;<code class="code">mps.macro.</code>:</p>   <p id="1055d57b">      <figure><img alt="image2016 10 13 17 29 27" title="image2016 10 13 17 29 27" src="/help/img/idea/2019.2/image2016-10-13-17-29-27.png" id="7e9cb868" width="614" height="156"></figure>   </p>   <h2 id="runningeditortestsinideaplugin">Running Editor tests in IDEA Plugin</h2>   <p id="44bb7148">With the new JUnit test suite (<i id="5bdc1f61">jetbrains.mps.idea.core.tests.PluginsTestSuite</i>) it is possible to execute editor tests for your languages in IntelliJ IDEA, when using the MPS plugin. To make use of this functionality you have to create a simple ANT script that will install all the necessary plugins into the IntelliJ platform and executing the tests by specifying test module name(s).</p><div class="last-modified" data-skip-index="skip">Last modified: 30 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="using-mps-debugger.html">Using the MPS Debugger</a><a class="navigation-links__next" href="mps-dependencies.html">Dependencies</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>