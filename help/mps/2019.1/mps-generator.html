<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta name="robots" content="noindex"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><meta charset="UTF-8"><title>Generator - Help | MPS</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Generator.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Windows/Linux Default</option><option data-group="primary" value="primary_default_for_gnome">GNOME</option><option data-group="primary" value="primary_default_for_kde">KDE</option><option data-group="primary" value="primary_default_for_xwin">XWin</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Default (Mac OS X 10.5+)</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_intellij_idea_classic_os_x">IntelliJ IDEA Classic (Mac OS X)</option><option data-group="secondary" value="secondary_xcode">Xcode</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_resharper">ReSharper</option><option data-group="secondary" value="secondary_resharper_osx">ReSharper (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs (Mac OS X)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Generator.html" id="mps-generator.xml">Generator</h1>   <aside class="tip sideblock" data-title="" rel="mps-generator.xml" id="3ff688a1">      <p id="dca6033a">For a quick how-to document on the MPS generator please check out the <a href="generator-cookbook.html">Generator Cookbook</a>.</p>   </aside>         <ul data-skip-index="skip"><li class="list__item"><a href="#introduction">Introduction</a></li><li class="list__item"><a href="#overview">Overview</a></li><li class="list__item"><a href="#generatormodule">Generator Module</a></li><li class="list__item"><a href="#creatinganewgenerator">Creating a New Generator</a></li><li class="list__item"><a href="#generatorproperties">Generator Properties</a></li><li class="list__item"><a href="#generatinggenerator">Generating Generator</a></li><li class="list__item"><a href="#transformation">Transformation</a></li><li class="list__item"><a href="#mappingconfigurations">Mapping Configurations</a></li><li class="list__item"><a href="#generatorrules">Generator Rules</a></li><li class="list__item"><a href="#macros">Macros</a></li><li class="list__item"><a href="#externaltemplates">External Templates</a></li><li class="list__item"><a href="#templateswitches">Template Switches</a></li><li class="list__item"><a href="#generatingfromant">Generating from Ant</a></li><li class="list__item"><a href="#examples">Examples</a></li></ul>      <h2 id="introduction">Introduction</h2>   <p id="237dfb43">Generator is a part of language specification that defines the <a href="http://en.wikipedia.org/wiki/Formal_semantics_of_programming_languages" data-external="true" target="_blank" rel="noopener noreferrer">denotational</a> semantics for the concepts in the language.</p>   <p id="343edcc1">MPS follows the <b id="e4d2632d">model-to-model transformation</b> approach. The MPS generator specifies translation of constructions encoded in the input language into constructions encoded in the output language. The process of model-to-model transformation may involve many intermediate models and ultimately results in sn&nbsp;<b id="02feee97">output model</b>, in which all constructions are in a language whose semantics are already defined elsewhere.</p>   <p id="f5dad681">For instance, most concepts in <i id="573aab8f">baseLanguage</i> (classes, methods etc) are "machine understandable", therefore&nbsp;<i id="94aff494">baseLanguage</i> is often used as the output language.</p>   <p id="451ec998">The target assets are created by applying <b id="46b76d52">model-to-text transformation</b>, which must be supported by the output language. The <i id="50c1f21f">language aspect</i>&nbsp;to define model-to-text transformation is called <a href="textgen.html">TextGen</a> and is available as a separate tab in concept's editor. MPS provides destructive update of generated assets only.</p>   <p id="b33267e1">For instance, <i id="12b1017f">baseLanguage</i>'s <i id="563ee575">TextGen</i> aspect generates <i id="8e7146bb">*.java</i> files at the following location:<br> &lt;<i id="c4089ec8">generator output path</i>&gt;\&lt;<i id="58e80e70">model name</i>&gt;\&lt;<i id="58fe4ef4">ClassName</i>&gt;.java<br> where:<br>       <b id="a140e695">Generator output path</b> - is specified in the module, which owns the input model.<br>      <b id="7379572b">Model name</b> - is a path segment created by replacing '.' with the file separator in the input model's name.</p>   <aside class="tip sideblock" data-title="" rel="b33267e1" id="b59934a7">      <p id="a0463a71">For a quick how-to document on the MPS generator please check out the <a href="generator-cookbook.html">Generator Cookbook</a>.</p>   </aside>      <h2 id="overview">Overview</h2>   <h3 id="generatormodule">Generator Module</h3>   <p id="0ab33907">Unlike any other language aspect, the generator aspect is not a single model. Generator specification can comprise <b id="87423fd2">many generator models</b> as well as <b id="096c63b2">utility models</b>. A&nbsp;<i id="9623742b">Generator Model</i> contains <i id="9b30cdb7">templates</i>, <i id="ca0644b4">mapping configurations</i> and other constructions of the generator language.</p>   <p id="2d3026d4">      <i id="25584080">A Generator Model</i> is distinguished from a regular model by the model stereotype - '<i id="f4b003ac">generator</i>' (shown after the model name as &lt;<i id="c69365e0">name</i>&gt;@<b id="ef91ca08">generator</b>).<br> The screenshot below shows the generator module of the <a href="smodel-language.html">smodel language</a> as an example.</p>         <figure><img alt="gug generator module" title="gug generator module" src="/help/img/idea/2019.1/gug-generator-module.png" id="f1cf421d" width="382" height="494"></figure>      <aside class="tip sideblock" data-title="" rel="283f15f6" id="74bb1729">      <p id="a6a5cef6">You can research the <i id="e094cdd3">smodel</i> (and any other) language generator by yourself:</p>      <ul class="list _ul"><li class="list__item" id="f2fe21b7"><p>download MPS (<a href="http://www.jetbrains.com/mps/download/index.html" data-external="true" target="_blank" rel="noopener noreferrer">here</a>);</p></li><li class="list__item" id="0be1f1b6"><p>create new project (can be empty project);</p></li><li class="list__item" id="70bb83a0"><p>use the <i id="a0265c85">Go To -&gt; Go to Language</i> command in the main menu to navigate to the smodel language (its full name is <i id="e69fd5af">jetbrains.mps.lang.smodel</i>)</p></li></ul>   </aside>   <h4 id="creatinganewgenerator">Creating a New Generator</h4>   <p id="d2ac0bc1">A new generator is created by using the <i id="01427621">New -&gt; Generator</i> command in the language's popup menu.</p>   <p id="98592171">Technically, it is possible to create more than one generator for one language, but at the time of writing MPS does not provide full support for this feature. Therefore, languages normally have only one (or none) generator. For that reason, the generator's name is not important. Everywhere in the MPS GUI a generator module can be identified by its language name.</p>   <p id="2cb4cc0f">When creating a new generator module, MPS will also create the generator model 'main@generator' containing an empty <b id="bf3c1926">mapping configuration</b> node.</p>   <h4 id="generatorproperties">Generator Properties</h4>   <p id="4c28247a">As a module, generator can depend on other modules, have <i id="421ddcee">used languages</i> and <i id="6e2ff0e1">used devkits</i> (see <a href="mps-project-structure.html#modulemetainformation">Module meta-information</a>).</p>   <p id="1ccaf61c">The generator properties dialog also has two additional properties:</p>   <ul class="list _ul"><li class="list__item" id="85e39426"><p>         <b id="80b35926">depends on generators</b> - specifies the dependencies on other generators; this allows the dependent generator to make references to templates defined in another generator;</p></li><li class="list__item" id="a692788e"><p>         <b id="bc0cecab">mapping constraints</b> - priority relationships between mapping rules can be specified. If such a relationship involves other generator rules, then declaring a dependency on that generator is also required.</p></li></ul>   <h4 id="generatinggenerator">Generating Generator</h4>   <p id="79988804">MPS generator engine (or the Generator language runtime) uses <b id="a5cfa14a">mixed compilation/interpretation mode</b> for transformation execution.</p>   <p id="548987b0">Templates are interpreted and filled at runtime, but all functions in rules, macros, and scripts must be pre-compiled.</p>   <p id="67105552"> To avoid any confusion, always follow this rule: after any changes made to the generator model, the model must be re-generated (<i id="e194859f">Shift+F9</i>). Even better is to use <i id="9913fe15">Ctrl+F9</i>, which will re-generate all modified models in the generator module.</p>   <h3 id="transformation">Transformation</h3>   <p id="4064f7d9">The transformation is described by means of <b id="9fb8cf04">templates</b>. Templates are written using the&nbsp;<b id="f5efb642">output language</b> and so can be edited with the same cell editor that would normally be used to write 'regular code' in that language. Therefore, without any additional effort the 'template editor' has the same level of tooling support right away&nbsp;- syntax/error highlighting, auto-completion, etc. The templates are then parametrized by referencing into the <b id="8e4c752b">input model</b>.</p>   <p id="7bc1df0d">The applicability of individual templates is defined by&nbsp;<a href="#generatorrules">#Generator Rules</a>, which are grouped into <a href="#mappingconfigurations">#Mapping Configurations</a>.</p>   <h4 id="mappingconfigurations">Mapping Configurations</h4>   <p id="9ecfb06d">A <i id="26a52f90">Mapping Configuration</i> is a minimal unit, which can form a single generation step. It contains <a href="#generatorrules">#Generator Rules</a>, defines <i id="dba30e61">mapping labels</i> and may include <i id="6bc5e2a0">pre-</i> and <i id="9cc2024a">post-processing scripts</i>.</p>   <h4 id="generatorrules">Generator Rules</h4>   <p id="3fbaf1b3">Applicability of each transformation is defined by <b id="ee89c0bb">generator rules</b>.<br> There are six types of generator rules:</p>   <ul class="list _ul"><li class="list__item" id="7ecf33fb"><p>conditional root rule</p></li><li class="list__item" id="6f631325"><p>root mapping rule</p></li><li class="list__item" id="13657593"><p>weaving rule</p></li><li class="list__item" id="28e68c30"><p>reduction rule</p></li><li class="list__item" id="de2b78f3"><p>pattern rule</p></li><li class="list__item" id="557046f5"><p>abandon root rule</p></li><li class="list__item" id="5fd68281"><p>drop attribute rule (<i id="426d7c89">new in 3.3</i>)</p></li></ul>   <p id="cb738504">Each generator rule consists of a <i id="71331949">premise</i> and a <i id="1ba90c70">consequence</i> (except for the <i id="5842dd47">abandon root rule </i>and <i id="2b0904fe">drop attribute rule</i>, with predefined consequence that cannot be specified by the user).</p>   <p id="9d6ea073">All rules except for the <i id="fbd50801">conditional root rule</i> contain a reference to the concept of the&nbsp;<b id="65305814">input node</b> (or just input concept) in its premises. All rule premises also contain an optional <b id="3f761ddf">condition function</b>.</p>   <p id="e0f7afa0">Rule consequence commonly contains a reference to an <b id="25e3d613">external template</b> (i.e. a template declared as a root node in the same or different model) or so-called <b id="e6113ed7">in-line template</b> (conditional root rule and root mapping rule can only have reference to an external template). There are also several other versions of consequences.</p>   <p id="a6acc96b">The following screenshot shows the contents of a generator model and a mapping configuration example.<br>      <figure><img alt="gug mapping configuration" title="gug mapping configuration" src="/help/img/idea/2019.1/gug-mapping-configuration.png" id="2cee9331" width="1255" height="740"></figure>   </p>   <h4 id="macros">Macros</h4>   <p id="e2997a2a">The code in templates can be parameterized through macros. The generator language defines three kinds of macros:</p>   <ul class="list _ul"><li class="list__item" id="abc5c6c7"><p>         <b id="1883bff0">property macro</b> - computes a property value;</p></li><li class="list__item" id="202ec6db"><p>         <b id="db4883b6">reference macro</b> - computes the target (node) of a reference;</p></li><li class="list__item" id="61dde9b3"><p>         <b id="26a8310a">node macro</b> - is used to control template filling at generation time. There are several versions of node macro - LOOP-macro is an example.</p></li></ul>   <p id="33af94a4">Macros implement a special kind of so-called annotation concept and can wrap property, reference or node cells (depending on the kind of macro) in the template code.</p>   <p id="cf47f992">Code wrapping (i.e. the creation of a new macro) is done by pressing <i id="62b757f0">Ctrl+Shift+M</i> or by applying the 'Create macro' intention.</p>   <p id="08379a84">The following screenshot shows an example of a property macro.<br>      <figure><img alt="gug property macro sample" title="gug property macro sample" src="/help/img/idea/2019.1/gug-property-macro-sample.png" id="9a5a6782" width="790" height="253"></figure>   </p>   <p id="5c4b3388">Macro functions and other parameterization options are edited in the inspector view. Property macro, for instance, requires specifying the value function, which will provide the value of the property at generation time. In the example above, output class node will get the same name that the <i id="66e4ed7a">input node</i> has.</p>   <p id="cf5f9030">The <i id="4ec2b2c1">node</i> parameter in all functions of the generator language always represents the context node to which the transformation is currently being applied (the <i id="98fcacad">input node</i>).</p>   <p id="9ba9a89b">Some macros (such as LOOP and SWITCH-macro) can replace the input node with a new one, so that subsequent template code (i.e. code that is wrapped by those macros) will be applied to the new input node.</p>   <h4 id="externaltemplates">External Templates</h4>   <p id="126f90ae">External templates are created as a root node in the generator model.</p>   <p id="bf3dbbfa">There are two kinds of external templates in MPS.</p>   <p id="95f151aa">One of them is <b id="799a85ba">root template</b>. Any root node created in generator model is treated as a <i id="bf227236">root template</i> unless this node is a part of the generator language (i.e. mapping configuration is not a <i id="5af038b6">root template</i>). <i id="feab6965">Root template</i> is created as a normal root node (via <i id="5efbfcf6">Create Root Node</i> menu in the model's popup).</p>   <p id="617b8a8d">The following screenshot shows an example of a root template.</p>         <figure><img alt="gug root template sample" title="gug root template sample" src="/help/img/idea/2019.1/gug-root-template-sample.png" id="fe8220a0" width="640" height="415"></figure>      <p id="f45ff29e">This <i id="20759935">root template</i> will transform input node (a <i id="799ce01c">Document</i>) into a <i id="7be6dbf0">class</i> (<i id="daea890b">baseLanguage</i>). The <i id="960c6836">root template header</i> is added automatically upon creation, but the concept of the input node is specified by the user.</p>   <p id="9c53c0d2"> It is a good practice to specify the input concept, because this allows MPS to perform static type checking in the code of the macro function.</p>   <p id="2871e1e4">      <i id="a9389273">A Root template</i> (reference) can be used as a consequence in conditional root rules and root mapping rules. ( When used in a conditional root rule, the input node is not available).</p>   <p id="a4c93c2c">The second kind of template is defined in the generator language and its concept name is 'TemplateDeclaration'. It is created via the 'template declaration' action in the <i id="02b762e6">Create Root Node</i> menu.</p>         <figure><img alt="gug new template declaration menu" title="gug new template declaration menu" src="/help/img/idea/2019.1/gug-new-template-declaration-menu.png" id="a57d94cd" width="1013" height="187"></figure>      <p id="096995ce">The following screenshot shows an example of template declaration.</p>         <figure><img alt="gug template declaration sample" title="gug template declaration sample" src="/help/img/idea/2019.1/gug-template-declaration-sample.png" id="526aad81" width="771" height="494"></figure>      <p id="2fb51251">The actual template code is 'wrapped' in a <b id="d7a6e5f0">template fragment</b>. Any code outside template fragment is not used in transformation and serves as a context (for example you can have a Java class, but export only one of its method as a template).</p>   <p id="22b1f903">      <i id="7b35a062">Template declaration</i> can have parameters, declared in the header. Parameters are accessible through the #generation context.</p>   <p id="2848cf9d">      <i id="ebdb112e">Template declaration</i> is used in consequence of weaving, reduction and pattern rules. It is also used as an <i id="86916700">included template</i> in INCLUDE-macro (only for templates without parameters) or as a <i id="661e88ca">callee</i> in CALL-macro.</p>   <h4 id="templateswitches">Template Switches</h4>   <p id="94956262">A template switch is used when two or more alternative transformations are possible in a certain place in template code. In that case, the template code that allows alternatives is wrapped in a SWITCH-macro, which has reference to a Template Switch. Template Switch is created as a root node in the generator model via the <i id="b607bcab">Create Root Node</i> menu (this command can be seen in the 'menu' screenshot above).</p>   <p id="7ae5ee1d">The following screenshot shows an example of a template switch.</p>         <figure><img alt="gug template switch sample" title="gug template switch sample" src="/help/img/idea/2019.1/gug-template-switch-sample.png" id="486cf945" width="815" height="422"></figure>         <h2 id="generatingfromant">Generating from Ant</h2>   <p id="1c94f98d">The Ant MPS generator task exposes properties configurable from the build script (parallel, threads, in-place, warnings). The build language uses the Ant Generate task under the hood to transform models during the build process. This task now exposes parameters familiar from the&nbsp;<i id="fc49fbbc">Generator settings page</i>:</p>   <ul class="list _ul"><li class="list__item" id="cb3b2119">         <b id="0a90c677">strict generation mode</b>      </li><li class="list__item" id="83cbdd6d">         <b id="ef368d1a">parallel generation with configurable number of threads</b>      </li><li class="list__item" id="684dcd18">         <b id="d2adad73">option to enable in-place transformation</b>      </li><li class="list__item" id="b3c050c9"><p>         <b id="35e8dd2f">option to control generation warnings/errors</b>.</p></li></ul>   <p id="f783f4e5">These options are also exposed at build language with the&nbsp;<code class="code">BuildMps_GeneratorOptions</code>&nbsp;concept, so that build scripts have more control over the process.</p>   <h2 id="examples">Examples</h2>   <p id="961f0a04">If you're feeling like it's time for more practical experience, check out the <a href="generator-demos.html">generator demos</a>.<br> The demos contain examples of usage of all the concepts discussed above.</p>   <hr id="c0c4d828"><div class="last-modified" data-skip-index="skip">Last modified: 5 July 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="data-flow.html">Data flow</a><a class="navigation-links__next" href="generator-language.html">Generator Language</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>