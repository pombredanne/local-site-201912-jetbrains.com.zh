<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta name="robots" content="noindex"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><meta charset="UTF-8"><title>Transformation Menu Language - Help | MPS</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Transformation+Menu+Language.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Windows/Linux Default</option><option data-group="primary" value="primary_default_for_gnome">GNOME</option><option data-group="primary" value="primary_default_for_kde">KDE</option><option data-group="primary" value="primary_default_for_xwin">XWin</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Default (Mac OS X 10.5+)</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_intellij_idea_classic_os_x">IntelliJ IDEA Classic (Mac OS X)</option><option data-group="secondary" value="secondary_xcode">Xcode</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_resharper">ReSharper</option><option data-group="secondary" value="secondary_resharper_osx">ReSharper (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs (Mac OS X)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Transformation+Menu+Language.html" id="transformation-menu-language.xml">Transformation Menu Language</h1>   <h2 id="overview">Overview</h2>         <ul data-skip-index="skip"><li class="list__item"><a href="#overview">Overview</a></li><li class="list__item"><a href="#definingamenu">Defining a Menu</a></li><li class="list__item"><a href="#defaultmenu">Default Menu</a></li><li class="list__item"><a href="#namedmenu">Named Menu</a></li><li class="list__item"><a href="#menucontributions">Menu Contributions</a></li><li class="list__item"><a href="#sectionlocations">Section locations</a></li><li class="list__item"><a href="#menuparts">Menu Parts</a></li><li class="list__item"><a href="#sidetransformations">Side transformations</a></li><li class="list__item"><a href="#substitutemenus">Substitute menus</a></li><li class="list__item"><a href="#defaultbehaviorforcode-completion">Default behavior for code-completion</a></li><li class="list__item"><a href="#substitutemenu(default)">Substitute menu (default)</a></li><li class="list__item"><a href="#substitutemenu(named)">Substitute menu (named)</a></li><li class="list__item"><a href="#substitutemenucontribution">Substitute menu contribution</a></li><li class="list__item"><a href="#options">Options</a></li><li class="list__item"><a href="#interactionofcellmenuandcell-specifictransformationmenu">Interaction of Cell Menu and Cell-specific Transformation Menu</a></li><li class="list__item"><a href="#includetransformationmenufortheproperty/reference">Include transformation menu for the property/reference</a></li><li class="list__item"><a href="#exampleonreferences">Example on references</a></li><li class="list__item"><a href="#exampleonproperties">Example on properties</a></li><li class="list__item"><a href="#showitemtrace">Show Item Trace</a></li></ul>      <p id="19986f48">Transformation menu language is used to define <i id="6e09020e">transformation menus</i> that describe a hierarchical structure of submenus and actions that will appear in various <i id="da9638f9">locations</i> in the editor. Currently there are several possible locations where transformation menus are shown: <a href="editor-actions.html">side transform menus</a>, <a href="editor-actions.html">substitute menus</a>,&nbsp;<a href="context-assistant.html">context assistant</a>, and <a href="context-actions-tool.html">context actions tool</a>. Language designers and plugin authors can define additional locations and specify required or optional&nbsp;<i id="cdb8f6cc">features</i> for each location (such as an icon or a tooltip), as documented in <a href="extending-the-transformation-menu-language.html">Extending the Transformation Menu Language</a>.</p>   <aside class="tip sideblock" data-title="" rel="19986f48" id="673554d6">      The <b id="1bc8e3a7">Transformation Menu Language</b> provides a way to describe side-transforms and substitute actions in MPS. The core capabilities of the new approach include:               <ul class="list _ul"><li class="list__item" id="b69c932e"><p>the ability to explicitly specify side-transform / substitute menu content for a particular cell in the editor</p></li><li class="list__item" id="fb6acae8"><p>no need for the "remove defaults" instruction, which often failed to work reliably in the past</p></li><li class="list__item" id="68321319"><p>easy mixing substitute actions from the substitute DSL with arbitrary /low-level/&nbsp;UI actions</p></li><li class="list__item" id="6d5639f0"><p>the same action can be visible in different places (parts) of the editor</p></li><li class="list__item" id="a801daf4"><p>supporting different action sets for alternative presentations (editors/projections)</p></li><li class="list__item" id="e9251b04"><p>actions are now defined in the editor aspect of the language</p></li></ul>         </aside>   <h2 id="definingamenu">Defining a Menu</h2>   <p id="fd3ebcd7">Transformation menus define UI actions that will be shown in various locations. At design time a menu is specified as a list of sections, each section contains a list of menu&nbsp;parts for a particular set of locations.&nbsp;At runtime the menu parts and the locations are used to generate the contents of the menus (menu items).</p>   <p id="f529bb64">Menu definitions come in two flavors:&nbsp;<b id="1acba94d">default</b>&nbsp;and&nbsp;<b id="fb897e49">named</b>. Menu definitions can also be extended through&nbsp;<b id="65a0865f">menu contributions</b>.</p>         <figure><a class="lightbox" href="/help/img/idea/2019.1/transformx1.png"><img alt="transformx1" title="transformx1" src="/help/img/idea/2019.1/transformx1.png" id="93944281" width="500" height="380"></a></figure>      <h3 id="defaultmenu">Default Menu</h3>   <p id="c598b294">Each concept has a default transformation menu associated. If the language designer does not provide one explicitly, a transformation menu defined for the closest super-concept is assumed. If none is specified for any of the super-concepts, the one defined on&nbsp;<i id="9140750f">BaseConcept</i> is used, which contains the substitute actions suitable for that position (see below the section on substitute actions).</p>   <p id="77d3ff2f">A default menu is used in situations where the language designer hasn't specified which menu to display.</p>         <figure><a class="lightbox" href="/help/img/idea/2019.1/tml1.png"><img alt="tml1" title="tml1" src="/help/img/idea/2019.1/tml1.png" id="29d2195a" width="500" height="724"></a></figure>      <h3 id="namedmenu">Named Menu</h3>   <p id="698e97c6">A named menu is an additional menu for a concept. Like the default menu it also specifies an applicable concept and contains a list of sections. As the term suggests, a named menu has an explicitly set name. A named menu is meant to be set as the transformation menu of a cell or included into another menu via the&nbsp;<b id="873bc1c5">Include Menu menu part</b>.</p>         <figure><a class="lightbox" href="/help/img/idea/2019.1/tml2.png"><img alt="tml2" title="tml2" src="/help/img/idea/2019.1/tml2.png" id="53937940" width="500" height="286"></a></figure>      <p id="1a0f3764">Attaching a named menu to an editor cell:</p>         <figure><a class="lightbox" href="/help/img/idea/2019.1/image2016-5-30-17-9-40.png"><img alt="image2016 5 30 17 9 40" title="image2016 5 30 17 9 40" src="/help/img/idea/2019.1/image2016-5-30-17-9-40.png" id="7c47f14a" width="500" height="990"></a></figure>      <p id="e6e44b72">Note: Default transformation menus can also be attached to individual cells the same way named menus can.</p>   <h3 id="menucontributions">Menu Contributions</h3>   A menu contribution extends a given menu by contributing additional menu parts to it. This is in particular useful, when an extending language needs to add entries into a menu defined in the extended language. Contributions can actually only be defined in languages other than the one with the menu being contributed to.   When a menu is requested at runtime the original definition and all contributions are merged and the menu is created using the combined definition. A few important notes on contributions:         <ol class="list _decimal"><li class="list__item" id="7d882399"><p>The order, in which the individual definitions are merged is currently unspecified.</p></li><li class="list__item" id="725b474f"><p>A contribution cannot remove menu parts from the menu it contributes to.</p></li><li class="list__item" id="2f0be20a"><p>It is possible to define a contribution to the implicit default menu for a concept.</p></li></ol>               <figure><a class="lightbox" href="/help/img/idea/2019.1/tml3.png"><img alt="tml3" title="tml3" src="/help/img/idea/2019.1/tml3.png" id="2789603b" width="500" height="265"></a></figure>            <h3 id="sectionlocations">Section locations</h3>   <p id="1092db18">By specifying location for a section within the menu you indicate, into which part of the UI the actions should be inserted:</p>   <ul class="list _ul"><li class="list__item" id="c9e18d4d"><p>         <b id="1fbd6124">completion</b> - the completion menu</p></li><li class="list__item" id="52306c9c"><p>         <b id="d432bd90">context actions tool</b> - the <a href="context-actions-tool.html">Context Actions Tool</a> (requires import of <i id="2ba5ba2a">jetbrains.mps.editor.contextActionsTool.lang.menus</i> language)</p></li><li class="list__item" id="a0ae0855"><p>         <b id="6b018734">context assistant</b> - the <a href="context-assistant.html">Context Assistant</a>      </p></li><li class="list__item" id="6a7e2ec6"><p>         <b id="84215666">side transform</b> - left or right transformations</p></li></ul>         <figure><a class="lightbox" href="/help/img/idea/2019.1/Locations1.png"><img alt="Locations1" title="Locations1" src="/help/img/idea/2019.1/Locations1.png" id="bb0607de" width="500" height="340"></a></figure>      <h3 id="menuparts">Menu Parts</h3>   <p id="27ebb7ad">The following standard menu parts are available:</p>   <ul class="list _ul"><li class="list__item" id="4d2b73e1">         <p id="27d10e53">            <b id="921cedab">action</b> – a&nbsp;simple menu item specifying an action to be performed, its corresponding menu text and applicability.</p>      </li><li class="list__item" id="62a308a7"><p>         <b id="bd39d8eb">group</b> - a collection of menu items.</p></li><li class="list__item" id="b3171a17"><p>         <b id="ac400a98">include</b> -&nbsp;include a specific default or named menu (together with its contributions, if any). Inclusion cycles are detected at runtime and an error message is produced.</p></li><li class="list__item" id="7a2c509d"><p>         <b id="f39f3c62">include substitute menu</b> - include a default or named substitute menu to use as part of this menu.</p></li><li class="list__item" id="8b2753b0"><p>         <b id="c4b35174">parametrized</b> - an action that is parametrized with multiple values.</p></li><li class="list__item" id="540882f3"><p>         <b id="0d4a9502">submenu</b>&nbsp;– a submenu containing further parts.</p></li><li class="list__item" id="6d7c46dd"><p>         <b id="95d045cc">superconcepts menu</b> – includes the default menus of the superconcepts of the applicable concept since these are not included by default.</p></li><li class="list__item" id="ed5c32a4"><p>         <b id="7b413074">wrap substitute menu</b> - wraps a specified concept using the provided handler</p></li></ul>   <p id="72a117d8">Language <code class="code">jetbrains.mps.lang.editor.menus.extras</code>&nbsp;contains adapters to include various action-like entities from transformation menus:</p>   <ul class="list _ul"><li class="list__item" id="52a67c1e"><p>         <b id="ab10ae06">intention</b> – wraps an intention (a subconcept of <code class="code">BaseIntentionDeclaration</code>&nbsp;from <code class="code">jetbrains.mps.lang.intentions</code>).</p></li><li class="list__item" id="b96c07a5"><p>         <b id="740a5826">refactoring</b> – wraps a refactoring (<code class="code">Refactoring</code>&nbsp;from <code class="code">jetbrains.mps.lang.refactoring</code>).</p></li><li class="list__item" id="58ef01c9"><p>         <b id="e9a38118">plugin Action</b> – wraps a plugin action (<code class="code">ActionDeclaration</code>&nbsp;from <code class="code">jetbrains.mps.lang.plugin</code>).</p></li></ul>         <figure><a class="lightbox" href="/help/img/idea/2019.1/Oprions5.png"><img alt="Oprions5" title="Oprions5" src="/help/img/idea/2019.1/Oprions5.png" id="d9721b40" width="500" height="632"></a></figure>      <aside class="tip sideblock" data-title="" rel="50bd4e61" id="519bb5d1">      <p id="181baa1b">You may also like to check out a <a href="https://youtu.be/mK40e7bde_Y" data-external="true" target="_blank" rel="noopener noreferrer">video on Transformation Menu Language</a>.</p>   </aside>   <h2 id="sidetransformations">Side transformations</h2>   <p id="e260cc5e">When you edit code in a text editor, you can type it either from left to right:</p>   <div class="code-block" data-lang="none">1_ press +
    1+_ press 2
    1+2_</div>   <p id="8e9e3a17">or from right to left</p>   <div class="code-block" data-lang="none">_1 press 2
    2_1 press +
    2+_1</div>   <p id="6d5bc2ec">In order to emulate this behavior, MPS has side transform actions: left and right transforms. They allow you to create actions which will be available when you type on left or right part of your cell. For example, in MPS you can do the following:</p>   <div class="code-block" data-lang="none">1_ press + (red cell with + inside appears)
    1+_ press 2 (red cell disappear)
    1+2_</div>   <p id="4a13b38b">or the following:</p>   <div class="code-block" data-lang="none">_1 press + (red cell with + inside appears)
    +_1 press 2 (red cell disappear)
    2_+1</div>   <p id="dc63e6f8">The first case is called right transform. The second case is called left transform.</p>   <p id="29e61bf2">You define side transformations in the Transformation menus by choosing the <b id="33a62a78">side transform</b> location for the section:</p>         <figure><a class="lightbox" href="/help/img/idea/2019.1/SideTransforms100.png"><img alt="SideTransforms100" title="SideTransforms100" src="/help/img/idea/2019.1/SideTransforms100.png" id="4474e58f" width="500" height="766"></a></figure>      <p id="02bddc49">The language also enables language designers to include items of the side-transform menu to the completion menu on a <b id="21aa4706">specific cell</b>. To do this you attach to the desired cell a transformation menu that contains a&nbsp;<b id="2dde26a3">completion&nbsp;</b>section. That completion section&nbsp;will hold an&nbsp;<b id="b5dc59f3">include menu&nbsp;</b>part and specify the location of side transform. The items of side-transform menu will be included to the completion.</p>         <figure><a class="lightbox" href="/help/img/idea/2019.1/cellmenu1.png"><img alt="cellmenu1" title="cellmenu1" src="/help/img/idea/2019.1/cellmenu1.png" id="00b49fd9" width="500" height="140"></a></figure>      <p id="5c62367b">The location of the included menu can be specified using the intention "Specify Location".</p>   <h2 id="substitutemenus">Substitute menus</h2>   <p id="36feabf9">Substitute actions define user-invoked transformations to some parts of the model, during which one node is substituted by another node. The actually mapping of these substitute actions to the visual UI elements (completion menu, etc.) is then done through Transform menus (see the section above).</p>   <p id="06cad179">Typically substitute actions are triggered by pressing&nbsp;<i id="80b50e17">Ctrl + Space</i> in the editor. The completion menu that shows up contains options that, when selected by the user, will replace the node under caret.&nbsp;Unlike&nbsp;<b id="f20e140e">side-transformations</b>,&nbsp;<b id="ff2f5236">context assistant</b>&nbsp;or&nbsp;<b id="cc583c5d">context action tool</b>,&nbsp;<b id="ee6a974f">substitutions</b>&nbsp;have default behavior, which takes effect, unless the language author defines otherwise.</p>   <h3 id="defaultbehaviorforcode-completion">Default behavior for code-completion</h3>   <p id="68fe54d4">Without any menus implemented explicitly by the language author, MPS will still provide a completion menu with substitutions for the current node in either of these two cases:</p>   <ul class="list _ul"><li class="list__item" id="89ae8c5d"><p>The cursor is positioned at the front of a single-cell editor &nbsp;<figure><a class="lightbox" href="/help/img/idea/2019.1/transforms10.png"><img alt="transforms10" title="transforms10" src="/help/img/idea/2019.1/transforms10.png" id="dbe45294" width="100" height="277"></a></figure>         <figure><a class="lightbox" href="/help/img/idea/2019.1/transforms11.png"><img alt="transforms11" title="transforms11" src="/help/img/idea/2019.1/transforms11.png" id="4e103658" width="100" height="553"></a></figure>      </p></li><li class="list__item" id="bb2cda67"><p>The user has selected the whole editor of a node<figure><a class="lightbox" href="/help/img/idea/2019.1/transforms12.png"><img alt="transforms12" title="transforms12" src="/help/img/idea/2019.1/transforms12.png" id="438cbe2f" width="100" height="288"></a></figure>         <figure><a class="lightbox" href="/help/img/idea/2019.1/transforms13.png"><img alt="transforms13" title="transforms13" src="/help/img/idea/2019.1/transforms13.png" id="8116947a" width="100" height="488"></a></figure>      </p></li></ul>   <p id="3643b611">In these cases pressing <i id="832f59df">Control + Space</i> will show a menu with all concepts from the imported languages applicable in the given context, which can substitute the current node in the model.</p>   <p id="2cfa1eac">MPS follows these steps to populate the default completion menu:</p>   <ol class="list _decimal"><li class="list__item" id="3fa18c30"><p>If your selection is inside of a position which allows concept A, then all enabled subconcepts of A will be available in the completion menu.</p></li><li class="list__item" id="5e7c81b6"><p>All abstract concepts are excluded</p></li><li class="list__item" id="ea555c2a"><p>All concepts, for which the 'can be a child' constraint returns false, are excluded</p></li><li class="list__item" id="8b281322"><p>All concepts, for which the 'can be a parent' constraint of a parent node returns false, are excluded</p></li><li class="list__item" id="c11d87d0"><p>If a concept contains a 1:1 reference, then it is not added to the completion menu itself. Instead, an item is added for each element in scope for that reference. We use a name <b id="6e0d005d">smart reference</b> for such items.</p></li></ol>   <p id="3539d547">To customize node substitutions, the&nbsp;<b id="b2585974">substitute menus</b>&nbsp;are used.</p>   <h3 id="substitutemenu(default)">Substitute menu (default)</h3>   <p id="aa401be5">By defining a default substitute menu for a concept you may customize the contents of the completion menu, which displays when the user presses&nbsp;<i id="013d7515">Control + Space</i>. It also has effect on sub-concepts of the concept, unless these sub-concepts define their own default substitute menus.</p>         <figure><a class="lightbox" href="/help/img/idea/2019.1/Substitution-menu-2.png"><img alt="Substitution menu 2" title="Substitution menu 2" src="/help/img/idea/2019.1/Substitution-menu-2.png" id="392dbdab" width="500" height="112"></a></figure>      <aside class="warning " data-title="" rel="87f2351c" id="ef8f503c">      <p id="b7da17ea">If you define a default substitute menu for a concept and leave it empty, the concept will not be included in the completion menu. This is the equivalent of using the <i id="62be9605">IDontSubstituteByDefault</i> interface in the previous versions of MPS.</p>               <figure><a class="lightbox" href="/help/img/idea/2019.1/EmptyMenu1.png"><img alt="EmptyMenu1" title="EmptyMenu1" src="/help/img/idea/2019.1/EmptyMenu1.png" id="925b4d7c" width="500" height="130"></a></figure>         </aside>   <p id="d38aeae7">However, if you want to assign the substitute menu to a particular cell of an editor, you will need to include your substitute menu in a transformation menu, because only transformation menus can be attached to editor cells.</p>         <figure><a class="lightbox" href="/help/img/idea/2019.1/IncludeDefaultSubstitute1.png"><img alt="IncludeDefaultSubstitute1" title="IncludeDefaultSubstitute1" src="/help/img/idea/2019.1/IncludeDefaultSubstitute1.png" id="3f06ab01" width="500" height="178"></a></figure>      <h3 id="substitutemenu(named)">Substitute menu (named)</h3>   <p id="fa316944">Named substitute menus give you the flexibility to create multiple substitute menus and use them in different contexts. Named substitute menus must be first included in another substitute menus or transformation menus to take effect.</p>   <h3 id="substitutemenucontribution">Substitute menu contribution</h3>   <p id="e82837eb">Just like with Transform menus, Substitute menu contributions contribute new entries into substitute menus defined in an extended language.</p>   <h3 id="options">Options</h3>   <ul class="list _ul"><li class="list__item" id="6cd6568b"><p>add concept - adds a single concept to the menu</p></li><li class="list__item" id="46ffa255"><p>concept list - adds a collection of concepts</p></li><li class="list__item" id="5f5501b7"><p>group - adds a groups of entries, if a condition is met</p></li><li class="list__item" id="f576efbd"><p>include - includes a specified menu</p></li><li class="list__item" id="6476c4d3"><p>parameterized - adds a parametrized substitute action</p></li><li class="list__item" id="71e8d3ee"><p>reference actions -&nbsp;&nbsp;includes and customises the appearance of the possible targets of a reference</p></li><li class="list__item" id="93a4a7aa"><p>subconcepts menu - includes all subconcepts of the concept</p></li><li class="list__item" id="447f5eb2"><p>substitute action -&nbsp;adds a single substitute action</p></li><li class="list__item" id="d44a0ce6"><p>wrap substitute menu -&nbsp;wraps a specified concept using the provided handler</p></li></ul>   <h2 id="interactionofcellmenuandcell-specifictransformationmenu">Interaction of Cell Menu and Cell-specific Transformation Menu</h2>   <p id="acff1861">If a cell has both "menu" and "transformation menu" specified the applicable entries from both menus are combined. Some cell menu parts (descendants of <code class="code">CellMenuPart_Abstract</code>&nbsp;such as <code class="code">CellMenuPart_PropertyPostfixHints</code>) do not yet have an equivalent transformation/substitution menu part.</p>   <h2 id="includetransformationmenufortheproperty/reference">Include transformation menu for the property/reference</h2>   <p id="20083020">The customization of the menu for the property/reference cells can be done with the <b id="4baea8c5">property/reference transformation menu parts</b>.&nbsp;Suppose you want to customize the completion menu of the reference/property cell. Previously, it could have been done by defining the "inline menu" in the inspector. Now it can be done also via the <b id="b5f55502">Transformation Menu</b>. We have introduced the property and the reference transformation menu parts. The <b id="ef4ea78a">reference transformation menu part</b> includes the actions, which set the target node to the specific reference. The target nodes come from the scope for that reference. The same goes for the property menu part: it takes the values of the property type and includes actions, which set the value to the specific properties.</p>   <h3 id="exampleonreferences">Example on references</h3>   <p id="f4aa0e64">Suppose we want to build the completion menu for a reference cell. The menu should contain the usual targets of the reference that are in scope, plus some other custom action. That could be done by attaching the following named transformation menu to the reference cell:</p>         <figure><a class="lightbox" href="/help/img/idea/2019.1/ClassCreator-CompletionMenu.png"><img alt="ClassCreator CompletionMenu" title="ClassCreator CompletionMenu" src="/help/img/idea/2019.1/ClassCreator-CompletionMenu.png" id="136676ad" width="700" height="682"></a></figure>      <br>      <p id="fb187977">So we will receive all the standard reference actions as well as our custom action in the completion:</p>         <img alt="Completion" title="Completion" src="/help/img/idea/2019.1/Completion.png" id="af34e4a9" width="700">      <p id="ff5e24d4">As you can see the reference menu part is the analog of the "primary choose referent menu" part in the "inline menu", but more customizable.&nbsp;Also, if no menu is attached to a cell, its reference menu will be used by default.</p>   <h3 id="exampleonproperties">Example on properties</h3>   <p id="db92904b">One more example - suppose you want to see all the possible values for a specific property in the context assistant when the cursor is on a <b id="f198e556">label</b>&nbsp;cell next to that property cell. Let's take a look at a piece of code in the Kaja language:</p>         <figure><a class="lightbox" href="/help/img/idea/2019.1/kaja-code.png"><img alt="kaja code" title="kaja code" src="/help/img/idea/2019.1/kaja-code.png" id="7658f502" width="300" height="252"></a></figure>      <p id="59db7be6">We want to see all the variants of the looking direction when we put the caret to the looking cell. So we attach the following menu to this label cell:</p>         <figure><img alt="looking direction" title="looking direction" src="/help/img/idea/2019.1/looking-direction.png" id="c093da85" width="950" height="154"></figure>      <br>            <br>      And get the result:         <br>            <figure><a class="lightbox" href="/help/img/idea/2019.1/dir-cont-assist-result.png"><img alt="dir cont assist result" title="dir cont assist result" src="/help/img/idea/2019.1/dir-cont-assist-result.png" id="912c6bec" width="500" height="252"></a></figure>            <br>            <p id="2a310534">The advantages of these menu parts over the "inline menu" include:</p>      <ol class="list _decimal"><li class="list__item" id="ce7b5465"><p>They can be attached to any cell, not just reference/property cells.</p></li><li class="list__item" id="325e738c"><p>They can be used in any menu location (context assistant, context menu), not only the completion.</p></li><li class="list__item" id="b981f69b"><p>The reference menu is more customizable (the property menu will also be customizable soon).</p></li></ol>               <br>            The menu discovery algorithm      <p id="539725bf">Understanding the process of how MPS picks the transformation menu will help you design menus with more confidence.</p>   <p id="38c94d21">The built-in behavior for discovery of transformation menus is to include the menu(s) of superconcept of the current concept, so by default MPS will look for a transform for the current concept, named <i id="e3e8d754">&lt;CurrentConcept&gt;</i>_TransformationMenu, then its super-concept's menu and so on, until BaseConcept_TransformationMenu.</p>   <aside class="tip sideblock" data-title="" rel="38c94d21" id="d53f3dba">      <p id="90cbb5e6">         <i id="ec8021e9">BaseConcept_TransformationMenu</i> really exists in MPS and contains an instruction to include the appropriate concept's substitute menu for the current link. Thanks to this a substitute menu that you define for a concept gets included and becomes available without any need to define a transformation menu explicitly.</p>      <p id="fe379811">&nbsp;</p>   </aside>   <p id="1cdbfab0">Substitute menus are similar to transformation menus, but their discovery works in the opposite direction: where the transformation menu for a concept A includes the menus of its superconcepts (up to BaseConcept), i.e. walks up the hierarchy, the substitute menu for A includes menus for its subconcepts, because only the sub-concepts can safely replace A in the model. Note that substitute menus are a bit different from transformation menus, because they are looked up not based on the concept of an existing node, but instead based on the link's target concept.</p>   <h2 id="showitemtrace">Show Item Trace</h2>   <p id="fa345f03">To track, which transformation or substitute menu contributed a particular action to the completion menu or to the context assistant, users just press&nbsp;<i id="d614e467">Control/Cmd + Alt + B</i>&nbsp;on the completion menu entry and an interactive trace report will show up.</p>   Sometimes it is hard to track how the action appeared in the completion or context assistant because of there are many substitute and transformation menus including each other.&nbsp;Now you may select some action in completion (by arrows) or in the context assistant (by pressing cmd/ctrl+alt+Enter) and then press cmd/ctrl+alt+B.&nbsp;You will see the trace in the project tool. This is the trace of the menu and menu part declaration which include each other starting from the top-level menu and ending with the action declaration. If the menu or the menu part declaration is explicit and is in the project, then it has bold style in tool and you can click on it and go to the declaration.         <br>Here how it looks like when we put the caret on the statement, show completion for the variable reference and then invoke "Show Item Trace":         <figure><a class="lightbox" href="/help/img/idea/2019.1/ActionTrace.png"><img alt="ActionTrace" title="ActionTrace" src="/help/img/idea/2019.1/ActionTrace.png" id="bbdda43f" width="500" height="462"></a></figure>      We see that what we see in completion is the default transformation menu for the Statement which includes the menu for superconcept which is the BaseConcept. It&nbsp;in its turn includes the substitute menu for the Statement, which in it's turn wraps the menu for the Expression. Then it comes to subconcepts of Expression, one of which is the VariableReference. VariableReference is the "smart reference" concept, so it tries to find all visible target of the Variable concept. So that's how the variable reference appears in the menu for the statement.<div class="last-modified" data-skip-index="skip">Last modified: 5 July 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="editor-actions.html">Editor Actions</a><a class="navigation-links__next" href="context-assistant.html">Context Assistant</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>