<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta name="robots" content="noindex"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><meta charset="UTF-8"><title>Editor language generation API - Help | MPS</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Editor+language+generation+API.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Windows/Linux Default</option><option data-group="primary" value="primary_default_for_gnome">GNOME</option><option data-group="primary" value="primary_default_for_kde">KDE</option><option data-group="primary" value="primary_default_for_xwin">XWin</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Default (Mac OS X 10.5+)</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_intellij_idea_classic_os_x">IntelliJ IDEA Classic (Mac OS X)</option><option data-group="secondary" value="secondary_xcode">Xcode</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_resharper">ReSharper</option><option data-group="secondary" value="secondary_resharper_osx">ReSharper (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs (Mac OS X)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Editor+language+generation+API.html" id="editor-language-generation-api.xml">Editor language generation API</h1>   <p id="60ec54a2">The editor language is supposed to be extended by numerous MPS users, so we designed the generator for the Editor language for ease of use - straightforward templates, human-readable generated code&nbsp;and use of meta-information more at the generation-time than at run-time. If any of your languages extend the editor language in order to provide new cell types, this document is for you.</p>   <h3 id="api:&nbsp;editorcell&nbsp;contract">API: EditorCell contract</h3>   <p id="90ac046c">The contract of&nbsp;<i id="324882aa">EditorCell.setBig()/.getBig()</i>&nbsp;methods was slightly changed. Please check the javadoc for details.</p>   <h3 id="api:editorcellfactory&nbsp;isnowavailableonlywithin&nbsp;updatesession">API: EditorCellFactory is now available only within UpdateSession</h3>   <p id="84c6472f">We made the&nbsp;<i id="d9a0e2b5">EditorCellFactory</i>&nbsp;instance controlled by the current&nbsp;<i id="114b29c9">UpdateSession</i>. In the same time we put some caches inside the&nbsp;<i id="60902f56">EditorCellFactory</i>&nbsp;implementation, making the editor building process faster in some situations. The&nbsp;<i id="d0e1e426">EditorContext.getCellFactory()</i>&nbsp;method was deprecated and will be removed in the next release.&nbsp;</p>   <h3 id="languageruntime:&nbsp;abstracteditorbuilder">Language Runtime: AbstractEditorBuilder</h3>   <p id="63969d08">      <i id="b8898f6f">AbstractEditorBuilder</i>&nbsp;runtime class was introduced and should be used as a common super-class of any classes containing cell factory methods. This class implements common utility methods and provides access to generic contextual parameters of editor cell creation process like:</p>   <ul class="list _ul"><li class="list__item" id="1f847ca2"><p>editorContext</p></li><li class="list__item" id="16d2fd3f"><p>node</p></li><li class="list__item" id="b3a585f6"><p>CellFactory</p></li><li class="list__item" id="644026ba"><p>UpdateSession</p></li></ul>   <p id="e3481eea">      <i id="65900b28">AbstractEditorBuilder</i>&nbsp;is used to capture some context of cell creation process and execute consequent cell factory methods within this context.</p>   <h3 id="generator:&nbsp;editorbuilder&nbsp;classes">Generator: EditorBuilder classes</h3>   <p id="1c21e3b3">A separate sub-class of&nbsp;<i id="73f9d05a">AbstractEditorBuilder</i>&nbsp;class will be generated now as a root class for each of available editor declaration hierarchies:&nbsp;</p>   <ul class="list _ul"><li class="list__item" id="d6ad7f03">         <i id="500389f7">ConceptEditorDeclaration.cellModel</i>      </li><li class="list__item" id="e188f692">         <i id="7627e86a">ConceptEditorDeclaration.inspectedCellModel</i>      </li><li class="list__item" id="7ad15ff9">         <i id="4f53124f">EditorComponentDeclaration</i>      </li><li class="list__item" id="6b5dcbb8">         <i id="f0bd8423">InlineEditorComponent</i>      </li></ul>   <p id="e83d8370">The MPS editor generator will continue creating classes, implementing&nbsp;<i id="8f4ae769">ConceptEditor</i>&nbsp;&amp;&nbsp;<i id="25eeeee9">ConceptEditorComponent</i>. These classes were used&nbsp;earlier as containers for cell&nbsp;factory methods. In the new version of MPS these classes are used as descriptors providing access to the contextual hints information &amp; instantiating actual&nbsp;<i id="3612546d">EditorBuilders</i>. Descriptor classes may be cached by the&nbsp;<i id="16c53bf4">EditorCellFactory</i>&nbsp;implementation.</p>   <h3 id="contextualparametersavailableforcellbuilders">Contextual parameters available for cell builders</h3>   <p id="5e702e42">The code, generated as a part of&nbsp;<i id="e3e78275">AbstractEditorBuilder</i>&nbsp;sub-classes may access contextual parameters by using existing methods of&nbsp;<i id="aabcd27e">AbstractEditorBuilder</i>&nbsp;class. In addition to that, all available meta-information is used to generate private fields with more specific types than those available in the method signatures of&nbsp;<i id="17e7c0cb">AbstractEditorBuilder</i>. For now each sub-class of&nbsp;<i id="aa52f86d">AbstractEditorBuilder</i>&nbsp;will hold private&nbsp;<i id="4595ecf8">node&lt;TheConcept&gt;&nbsp;myNode</i>&nbsp;field, where&nbsp;<i id="9037b908">TheConcept</i>&nbsp;is the actual concept associated with this&nbsp;<i id="f764d02d">AbstractEditorBuilder</i>. This means that any cell factory method may use such a private field in order to get typed access to the contextual node and directly access available properties, links and other information from the contextual node using s-model language.</p>   <h3 id="cellfactorycontextclass">CellFactoryContextClass</h3>   <p id="b813974b">      <i id="c20e4c8c">CellFactoryContextClass</i>&nbsp;is a handy utility class providing necessary context for templates, generating the code included into one of the generated&nbsp;<i id="05f0f0a0">AbstractEditorBuilder</i>&nbsp;sub-classes. By using this class as a contextual class template authors will automatically obtain all available methods and fields, the code generation environment will be supported by MPS platform, and so it's not necessary to reconstruct it for each and every editor template anymore. At the same time,&nbsp;<i id="da13e3eb">CellFactoryContextClass</i>&nbsp;can be used as a marker interface highlighting templates, which will generate code for one of the&nbsp;<i id="a53a2527">EditorBuilders</i>, simplifying the process of locating such code &amp; supporting it in the future.</p>   <h3 id="genericcellcreationcontext">GenericCellCreationContext</h3>   <p id="ae74fe9a">The<i id="5ea68934">&nbsp;GenericCellCreationContext</i>&nbsp;interface provides limited subset of contextual information, which is always available for the code called either as a part of&nbsp;<i id="829c3021">EditorBuilders</i>&nbsp;or from a separate class, executed as a part of cell creation (editor update) process. This interface should be used as a template context instead of&nbsp;<i id="068af961">CellFactoryContextClass</i>&nbsp;in those cases, when template authors are going to reuse the same template across the&nbsp;<i id="938f1bbf">EditorBuilders</i>&nbsp;generation process and some other places. For example, query methods which may be generated either inside&nbsp;<i id="ec878a8a">EditorBuilders</i>&nbsp;or within some style class.</p>   <h3 id="newsignaturefor&nbsp;createcell()&nbsp;methods">New signature for createCell() methods</h3>   <p id="ae6eceee">In the previous version of MPS, the cell factory methods were always generated with two additional parameters specifying the context of cell creation:&nbsp;<i id="457252cb">EditorContext</i>&nbsp;&amp;&nbsp;<i id="684b6a8f">node&lt;&gt;</i>. From now on it's not necessary to specify these parameters any more - the generated code can always access this information (as well as any other contextual info) by calling methods from the containing&nbsp;<i id="993c4b2b">EditorBuilder</i>&nbsp;class. The new editor generator will generate cell factory methods without any parameters.</p>   <h3 id="automaticmigrationscriptfornew&nbsp;createcell()&nbsp;methods">Automatic migration script for new createCell() methods</h3>   <p id="097cab30">For compatibility with the existing generators, we provide a migration script patching available templates and introducing the new&nbsp;<i id="f0f75082">createCell()</i>&nbsp;methods, which delegate to the old ones (with the two additional parameters) as a fallback. We recommend to execute this script first and then check all modifications and verify, if the modified generator still works correctly. The provided automatic migration supports only most frequent situations, so in some specific cases you may need to manually modify your generator in order to make it work again. The template, which generates the compatibility methods is called&nbsp;<i id="97ea7251">template_cellFactoryCompatibility</i>. If you later modify your generator to generate directly the new&nbsp;<i id="c864182d">createCellMethods</i>, you should remove any calls to&nbsp;<i id="c60db9bf">template_cellFactoryCompatibility</i>. We do recommend to review all existing generators &amp; patch obsolete templates generating the legacy&nbsp;<i id="1561fe08">createCell(...)</i>&nbsp;methods in the scope of the current MPS release - we are going to drop the compatibility template in the next version.</p>   <h3 id="mappinglabels">Mapping labels</h3>   <p id="36368ee7">Several mapping labels were introduced into the Editor generator (<i id="59a5edfa">MAPPING_main</i>) and may be used to simplify code generation:</p>   <h4 id="cellfactory.class.concept">cellFactory.class.concept</h4>         <i id="880be17c">cellFactory.class.concept: ConceptEditorDeclaration -&gt; ClassConcept</i>      <p id="1c9ada6c">This label expose a java class, generated for the&nbsp;<i id="cc2b0a93">EditorBuilder</i>&nbsp;of&nbsp;<i id="fe7bb019">ConceptEditorDeclaration.cellModel</i>   </p>   <h4 id="cellfactory.class.inspector">cellFactory.class.inspector</h4>         <i id="6b8c1aad">cellFactory.class.inspector: ConceptEditorDeclaration -&gt; ClassConcept</i>      <p id="b4d62398">This label exposes a java class, generated for the&nbsp;<i id="0ea5f9c5">EditorBuilder</i>&nbsp;of&nbsp;<i id="1b76b4dc">ConceptEditorDeclaration.inspectedCellModel</i>   </p>   <h4 id="cellfactory.class.component">cellFactory.class.component</h4>         <i id="1d5c3ace">cellFactory.class.component: EditorComponentDeclaration -&gt; ClassConcept</i>      <p id="81af006b">This label exposes a java class, generated for the&nbsp;<i id="a9320025">EditorBuilder</i>&nbsp;of&nbsp;<i id="62682272">EditorComponentDeclaration</i>   </p>   <h4 id="cellfactory.constructor">cellFactory.constructor</h4>         <i id="c226a7c1">cellFactory.constructor: EditorCellModel -&gt; ConstructorDeclaration</i>      <p id="166c4aea">Used to mark the constructor of the generated&nbsp;<i id="4898ee8a">EditorBuilder</i>&nbsp;class.</p>   <h4 id="cellfactory.factorymethod">cellFactory.factoryMethod</h4>         <i id="a3cfdde6">cellFactory.factoryMethod: EditorCellModel -&gt; InstanceMethodDeclaration</i>      <p id="e273c87a">The replacement for obsolete&nbsp;<i id="4d80c866">cellFactoryMethod</i>&nbsp;label, containing the new&nbsp;<i id="aa2cbb37">cellFactory</i>&nbsp;methods. This label should be used instead of&nbsp;<i id="cf5b7bbe">cellFactoryMethod</i>&nbsp;at the moment of modification of existing templates making them generating new&nbsp;<i id="c930ce8d">cellFactory</i>methods.</p>   <h4 id="generated.constructor">generated.constructor</h4>         <i id="0aca05e8">generated.constructor: &lt;no input concept&gt; -&gt; ConstructorDeclaration</i>      <p id="3effb11d">This label may be used together with existing&nbsp;<i id="7f01e7b7">generatedClass</i>&nbsp;one to mark generated constructor instances. This label may be used to avoid the ugly code for locating first constructor instance inside&nbsp;<i id="90bec6c8">node&lt;ClassConcept&gt;</i>, returned from the&nbsp;<i id="250f9d8f">generatedClass</i>&nbsp;mapping.&nbsp;</p>   <h3 id="celllayoutconstructorswitchintroduced">CellLayoutConstructor switch introduced</h3>   <p id="d64ea522">This template switch is used to instantiate proper cell layout while creating a collection cell. The previously used static&nbsp;<i id="a779d75b">createxxx()</i>&nbsp;methods inside&nbsp;<i id="16ee29eb">EditorCell_Collection</i>&nbsp;class have been deprecated and will be removed.&nbsp;</p>   <h3 id="newgeneratorforrefcellcellprovidersub-classes">New generator for RefCellCellProvider sub-classes</h3>   <p id="e2e81ad5">The generator for&nbsp;<i id="84d7c1c6">CellModel_RefCell</i>&nbsp;has been modified. The newly generated anonymous inner classes for&nbsp;<i id="32a79fce">RefCellCellProvider</i>&nbsp;do not use the logic located inside&nbsp;<i id="3720b0ac">RefCellCellProvider.createRefCell()</i>&nbsp;runtime method. The meta-information, available at generation-time, are used in oder to create complete content of this method. If you do generate sub-classes of&nbsp;<i id="35f86703">RefCellCellProvider</i>&nbsp;within your generators, you should consider reviewing such places and aligning your templates with the templates from MPS.</p>   <h3 id="inlinecellproviderreplacedwitheditorbuildersub-class">InlineCellProvider replaced with EditorBuilder sub-class</h3>   <p id="70a844b3">      <i id="483a6764">InlineCellProvider</i>&nbsp;is not being used by the MPS generator anymore. MPS uses the generated sub-classes of&nbsp;<i id="51c813b0">AbstractEditorBuilder</i>&nbsp;instead.&nbsp;Nevertheless, we modified some constraints inside&nbsp;<i id="e15ffdd1">InlineCellProvider</i>&nbsp;in order to make the lifecycle more transparent. We recommend to check the javadoc for&nbsp;<i id="af05abbf">InlineCellProvider</i>, if you are still using it.</p>   <h3 id="editorstylesgenerator">Editor Styles generator</h3>   <p id="6bd63bf7">A separate static inner class will be generated for each entry inside&nbsp;<i id="7dd99857">StyleSheet</i>&nbsp;&amp;&nbsp;<i id="f47cb9b1">StyleKeyPack</i>&nbsp;instances. The provided&nbsp;<i id="52e6b447">applyStyleClass</i>&nbsp;template may be used to properly instantiate &amp; call the new&nbsp;<i id="99c474cb">Style</i>&nbsp;classes. Legacy static .<i id="070901b3">applyxxx()</i>&nbsp;methods should be removed in the next release.</p>   <h3 id="styleclassitem&nbsp;constraintsmodification">StyleClassItem constraints modification</h3>   <p id="7f3ee528">We removed the&nbsp;<i id="914be0f4">canBeChild</i>&nbsp;constraints from the&nbsp;<i id="db7afb20">StyleClassItem</i>&nbsp;concept. These constraints were replaced with&nbsp;<i id="d4d34e23">canBeParent</i>&nbsp;constraints of the node, containing the&nbsp;<i id="d7836493">StyleClassItem</i>. In addition to that&nbsp;<i id="14594090">isApplicableToCell(node&lt;EditorCellModel&gt; cellModel)</i>&nbsp;behaviour method has been deprecated and is not used anymore. Instead we have introduced the following methods:</p>   <ul class="list _ul"><li class="list__item" id="3012d97f">         <i id="6ce1168d">isApplicableToCellConcept()</i>      </li><li class="list__item" id="5345690a">         <i id="a05b3a17">isApplicableForLayout()</i>      </li><li class="list__item" id="f0be1c17">         <i id="03d37110">isApplicableInLayout()</i>      </li></ul>   <p id="d7e69980">We recommend you to check the javadoc of&nbsp;<i id="796985cb">StyleClassItem</i>&nbsp;behavior methods, if you are implementing any custom&nbsp;<i id="d8d819a5">StyleClassItem</i>&nbsp;in your language.</p><div class="last-modified" data-skip-index="skip">Last modified: 5 July 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="diagramming-editor.html">Diagramming Editor</a><a class="navigation-links__next" href="constraints.html">Constraints</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>