<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Build Language - Help | MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Build+Language.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Default</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_jbuilder">JBuilder</option><option data-group="primary" value="primary_mac_os_x">Mac OS X</option><option data-group="primary" value="primary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default">Default</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_jbuilder">JBuilder</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Build+Language.html" id="build-language.xml">Build Language</h1>   <h2 id="whatismpsbuildlanguage?">What is MPS build language?</h2>   <p id="f6adf46f">Build Language is an extensible build automation DSL for defining builds in a declarative way. Generated into <a href="http://ant.apache.org" data-external="true" target="_blank" rel="noopener noreferrer">Ant</a>, it leverages Ant execution power while keeping your sources clean and free from clutter and irrelevant details. Organized as a stack of MPS languages with ANT at the bottom, it allows each part of your build procedure to be expressed at a different abstraction level. Building a complex artifact (like an MPS plug-in) could be specified in just one line of code, if you follow the language conventions, but, at the same time, nothing prevents you from diving deeper and customize the details like file management or manifest properties.</p>   <p id="eb9df039">As with many build automation tools, project definition is the core of the script. Additionally, and unlike most of the other tools, <i id="5dc3cea7">Build Language</i> gives you full control over the output directory layout. The expected build result is defined separately in the build script and not as a part of some (third-party) plugin.<br> Every build script is made up of three parts. The first is <b id="dfada1e0">dependencies</b>, something required that comes already built. Think of libraries or third-party languages, for example. Next is <b id="b3cd7830">the project structure</b>. It contains declarations of everything you have in your repository and what is going to be built, as well as the required build parameters. Note that declaring an item here does not trigger its build unless it is needed, i.e. referred to from the last part of the script - <b id="445cad31">the output layout</b>. The output could be as straightforward as a set of plain folders and copied files, or much more complex with zipped artifacts such as packaged plug-ins or MPS languages. For example, to build a jar file out of Java sources you need to declare a Java module in the project structure and the respective jar file with a reference to the module in the output layout.</p>   <p id="a4beac36">Thanks to MPS, <i id="f42a1cf1">Build Language</i> comes with concise textual notation and an excellent editing experience, including completion and on-the-fly validation. Extension languages (or plugins if we stick to the terminology of the other build tools) add additional abstractions on top of the language. In our experience, it is quite an easy process to create a new one compared to developing Maven or Gradle plugins.</p>   <h2 id="buildscriptstructure">Build script structure</h2>   <p id="7e857d42">See an example below of a build script, which builds a plugin for Intellij IDEA:</p>   <p id="9eeac185">      <figure><img alt="samplesScript" title="samplesScript" src="/help/img/idea/2019.2/samplesScript.png" id="52b12ce9" width="859" height="798"></figure>   </p>   <p id="c05ed1da">Let's look at it closely. The header of the script consists of general script information: the name of the script (<i id="d312468f">Complex</i>&nbsp;in the screenshot), the file it is generated into (<i id="5a8648a8">build.xml</i>) and the base directory of the script (in the screenshot one can see it is relative to the script location <i id="ec0413ad">../../</i> as well as full path).</p>   <p id="958d7adb">The body of the script consists of the following sections:</p>   <ul class="list _ul"><li class="list__item" id="80665c66"><p>         <i id="c7238196">use plugins</i> contains a list of plugins used in the script. Plugins in Build Language are similar to those in Gradle: they are extensions to the language that provide a number of tasks to do useful things, like compiling java code, running unit tests, packaging modules, etc. In the screenshot two plugins are used: <i id="42232ea9">java</i> and <i id="f8ac8d15">mps</i>,&nbsp;which means that the script can build java and mps code.</p></li><li class="list__item" id="da4dd43f"><p>         <i id="a04c5b58">macros</i> section defines path macros and variables used in the project (<i id="93dcc121">idea_home</i> and <i id="4109ae59">plugins_home</i>) together with their default values, which could be overridden during execution of the script.</p></li><li class="list__item" id="869f80e6"><p>         <i id="29d39e62">dependencies</i>&nbsp;defines script dependencies on other build scripts. If a script references to something defined in the other build script it must specify this script in the dependencies section. The example script on the screenshot depends on two other scripts <i id="f3550afa">IDEA</i> and <i id="2c27d96c">mpsPlugin</i>. These are provided by MPS, so in order to use them one has to specify the <i id="deaa1ff8">artifacts location</i> for them, i.e. place where ant can find the result of their work (in the example, <i id="b3c12ab0">idea_home</i> should point to the location of Intellij IDEA jars and <i id="3b4d9f42">plugins_home</i> should point to the location of MPS plugins for IDEA). One can as well depend on some build scripts in the same MPS project. In that case, artifacts location is not required and it is assumed that the required script would be built just prior to the current script (there is a target <i id="b4e62cae">buildDependents</i> to do so).</p></li><li class="list__item" id="ce44bc88"><p>         <i id="edab08a3">project structure</i> section contains the description of the project, i.e. which modules does it have, where the source code is located, what the modules classpath is etc. The example project in the screenshot consists of a single&nbsp;<i id="57d16ae1">idea plugin</i> named <i id="902cc74c">Complex</i> and of a group of MPS modules.</p></li><li class="list__item" id="594ebdf5"><p>         <i id="6c132652">default layout</i> defines how to package the project into the distribution. The example project on the screenshot is packaged into a zip file named <i id="1a33dcac">Complex.zip</i>.</p></li><li class="list__item" id="5176c3cb"><p>         <i id="41e636d8">additional aspects</i> defines some other things related to the project, for example, various settings, integration tests to run, and so on.</p></li></ul>   <h2 id="macros">Macros</h2>   <p id="b28eb883">There are two types of macros:</p>   <ul class="list _ul"><li class="list__item" id="ed5af07a"><p>         <b id="58d8f27b">Folder</b>&nbsp;- represents a physical folder in the file-system, if left empty (<i id="4f51783f">default</i>), the value is attempted to retrieve from a&nbsp;<b id="0324e075">path variable</b> defined in MPS with the same name</p></li><li class="list__item" id="71fd9b0b"><p>         <b id="d5279952">Var</b>&nbsp;- custom variable representing a value</p></li></ul>   <p id="a348711c">The <b id="0e043283">Vars</b>&nbsp;can be initialized in one of several ways:</p>   <ul class="list _ul"><li class="list__item" id="6e091abc"><p>reference to an earlier macro</p></li><li class="list__item" id="2564322e"><p>         <b id="e0eecb10">date</b>&nbsp;- a date value, a <b id="3e6af029">pattern</b>&nbsp;parameter that follows the Java's date format rules should be specified, e.g. yyyy-MM-dd, the date value of the time when the build script is run will be inserted into the macro&nbsp;</p></li><li class="list__item" id="b0577cd9"><p>         <b id="fe5109b7">load from file</b>&nbsp;- reads a specified property value from a specified property file</p></li><li class="list__item" id="d0a07e2c"><p>         <b id="e75f78ee">text</b>&nbsp;- a plain text value</p></li></ul>   <h2 id="built-inplugins">Built-in plugins</h2>   <p id="06080ddd">Build Language provides several built-in plugins.</p>   <h3 id="javaplugin">Java plugin</h3>   <p id="601d6c73">The Java plugin adds capability to compile and package java code. Source code is represented as java modules and java libraries.</p>   <p id="65469df7">Java module defines its content (source folders locations) and dependencies on other modules, libraries and jars. In content section java module can have:</p>   <ul class="list _ul"><li class="list__item" id="f312c91c"><p>         <i id="7475ead9">folder</i> – a path to source folder on disk;</p></li><li class="list__item" id="52a574a4"><p>         <i id="292db3d3">resources</i> – a fileset of resources. Consists of a path to resources folder and a list of selectors (<i id="c7aae136">include</i>, <i id="39b19ea0">exclude</i> or <i id="33fad652">includes</i>).</p></li><li class="list__item" id="114d3045"><p>         <i id="c0b2bf99">content root</i> – a root with several content folders.</p></li></ul>   <p id="95eadb6a">In dependencies section java module can have:</p>   <ul class="list _ul"><li class="list__item" id="85576cc6"><p>         <i id="aa158361">classpath</i> – an arbitrary xml with classpath;</p></li><li class="list__item" id="65580fd6"><p>         <i id="520052a3">external jar</i> – a jar file from other build script layout;</p></li><li class="list__item" id="a1bc1e89"><p>         <i id="b4ab0000">external jar in folder</i> – a jar file referenced by name in a folder from some other build script layout;</p></li><li class="list__item" id="4d481cec"><p>         <i id="0abad473">jar</i> – a path to local jar;</p></li><li class="list__item" id="dae6eaec"><p>         <i id="720c6599">library</i> – a reference to a java library;</p></li><li class="list__item" id="dcc2b01f"><p>         <i id="1af10771">module</i> – a reference to a java module.</p></li></ul>   <p id="2f0ea7af">Each java module is generated into its own ant target that depends on other targets according to the source module dependencies. For compiling cyclic module dependencies, a two-step compilation is performed:</p>   <ol class="list _decimal"><li class="list__item" id="5443f6d4"><p>A "cycle" target compiles all modules in the cycle together.</p></li><li class="list__item" id="0d9bf3cc"><p>Each module in the cycle is compiled with the result of compilation of "cycle" target in classpath.</p></li></ol>   <p id="424e0c36">Java library consists of jars (either specified by path or as references to the other project layout) and class folders. The available elements are:</p>   <ul class="list _ul"><li class="list__item" id="2e8f10b2"><p>         <i id="29a4c6ec">classes folder</i> – a folder with classes;</p></li><li class="list__item" id="0782f0ee"><p>         <i id="e522e9fe">external jar</i> – a jar file from other build script layout;</p></li><li class="list__item" id="fdec63bf"><p>         <i id="6e8924c8">external jars from</i> – a collection of jars from a folder from some other buils script layout;</p></li><li class="list__item" id="bd322640"><p>         <i id="9e90bbb7">jar</i> – a path to local jar;</p></li><li class="list__item" id="b5dd42b7"><p>         <i id="7f87bb7f">jars</i> – a path to local folder with jars and a list of selectors (<i id="b9eb1cc7">include</i>, <i id="e3437127">exclude</i> or <i id="c51d60d2">includes</i>).</p></li></ul>   <p id="18d521e7">Compilation settings for java modules are specified in <i id="def20e7d">java options</i>. There can be several java options in the build script, only one of them can be default. Each module can specify its own java options to be used for compilation.</p>   <h4 id="javatargets">Java Targets</h4>   <p id="145f401d">Java plugin adds the following targets:</p>   <ul class="list _ul"><li class="list__item" id="51901b49"><p>         <i id="5b85ba16">compileJava</i> compiles all java modules in the project.</p></li><li class="list__item" id="b3a5c961"><p>         <i id="257398a8">processResources</i> extension point for additional resource processing.</p></li><li class="list__item" id="d0882d2e"><p>         <i id="71f1c517">classes</i> does all compilation and resource processing in the project. It depends on targets <i id="0e9c7476">compileJava</i>, <i id="c2ba0f25">processResources</i>.</p></li><li class="list__item" id="db3f3543"><p>         <i id="657e0eff">test</i> extension point target for running unit tests.</p></li><li class="list__item" id="fcb8551c"><p>         <i id="aa6a7e8b">check</i> does all testing and checking of project correctness. It depends on target <i id="c6adb92a">test</i>.</p></li></ul>   <h3 id="mpsplugin">MPS plugin</h3>   <p id="1e3ec61e">The MPS plugin enables the build language in scripts to build mps modules. In order to use the MPS plugin one must add <i id="1fe56ee4">jetbrains.mps.build.mps</i> language into used languages.</p>   <h4 id="mpsmodulesandgroups">MPS modules and groups</h4>   <p id="97324c1f">The MPS plugin enables adding modules into project structure. On the screenshot there is an example of a language, declared in a build script.</p>   <p id="80f5c388">      <figure><img alt="sampleLanguage" title="sampleLanguage" src="/help/img/idea/2019.2/sampleLanguage.png" id="d5284fcc" width="620" height="302"></figure>   </p>   <p id="5095742b">Note that there is a lot of information about the module specified in the build script, most of which is displayed in the <b id="a30ea584">Inspector tool window</b>: <i id="23cb33a3">uuid</i> and <i id="702de745">fully qualified name</i>, <i id="e8771f73">full path</i> to descriptor file, <i id="8a4f3ddb">dependencies</i>, <i id="3d28ca30">runtime</i> (for a language) etc. This information is required for packaging the module. So, every time something changes for this module, for example a dependency is added, the build script has to be changed as well. There is of course a number of tools to do it easily. The typical process of writing and managing mps modules in the script looks as following:</p>   <ol class="list _decimal"><li class="list__item" id="793a28fc"><p>Adding a module to the script. One specifies, which type of module to add (a solution, a language or a devkit) and the path to the module descriptor file. Then the intention "<i id="01e01f26">Load required information from file</i>" can be used to read that file and fill the rest of the module specification automatically.<br>          <figure><img alt="loadRequired" title="loadRequired" src="/help/img/idea/2019.2/loadRequired.png" id="59dfddf9" width="559" height="162"></figure>      </p></li><li class="list__item" id="f0ccc47c"><p>Reflecting the changes made in the module. One can check a model with build scripts using the <b id="8b44d888">Model Checker</b> to find whether it is consistent with the module files. Model checker will show all problems in the script and allow you to fix them using "Perform Quick Fixes" button. Instead of Model checker one can use the same "Load required information from file" intention to fix each module individually.<br>          <figure><img alt="modelChecker" title="modelChecker" src="/help/img/idea/2019.2/modelChecker.png" id="08ceec52" width="1090" height="183"></figure>      </p></li></ol>   <p id="2213827d">Another thing to remember about MPS module declarations in a build scripts is that they do not rely on modules being loaded in MPS. All the information is taken from a module descriptor file on disk, while module itself could be unavailable from the build script.</p>   <p id="8ec40ec1">MPS modules can be added into an&nbsp;<i id="996b2c76">mps group</i> in order to structure the build script. An MPS Group is just a named set of modules, which can be referenced from the outside, for example one can add a module group into an IDEA plugin as one unit.</p>   <h3 id="moduleresources">Module resources</h3>   <p id="c60ea865">Resources required by a module (images, icons, etc.) should be specified using the&nbsp;<b id="8d17a6ef">resources</b> content root:</p>   <p id="e1f4a3b9">      <figure><a class="lightbox" href="/help/img/idea/2019.2/Resources.png"><img alt="Resources" title="Resources" src="/help/img/idea/2019.2/Resources.png" id="33ad8fba" width="500" height="752"></a></figure>   </p>   <h4 id="howgeneratingandcompilingmpsmodulesworksinternally">How generating and compiling MPS modules works internally</h4>   <p id="28dad572">As it was written above, a lot of information about a module is extracted into the build script and stored there. This mandates the user to properly update the script whenever module dependencies change. For a <i id="f5191b88">Solution</i>, it's both the reexported and non-reexported dependencies that are extracted to the script. For a Language, apart from the dependencies, runtime solutions and extended languages are also extracted.</p>   <p id="3d9ef41b">"Building" a module with build script consists of two parts: generating this module and compiling module sources. Generating is an optional step for projects that have their source code stored in version control system and keep it in sync with their models. For generating, one target is created that generates all modules in the build script. Modules are separated into "chunks" – groups of modules that can be generated together – and the&nbsp;<i id="daa11826">generate</i> task generates the chunks one by one. For example, a language and a solution written with the language cannot be generated together, therefore they go into separate chunks. Apart from the list of chunks to generate, the&nbsp;<i id="8ff732a3">generate</i> task is provided with a list of idea plugins to load and a list of modules from other build scripts that are required for the generation. This lists of plugins and modules is calculated from the dependencies and therefore their correctness is crucially important for successful generation. This is a major difference between generating a module from MPS and from a build script: while when generating a module from MPS, the generator has all modules in the project loaded and available; when generating a module from a build script, the generator only has whatever was explicitly specified in the module dependencies. So a build script can be used as some kind of a verifier of correctness of modules dependencies.</p>   <p id="0e9a921d">Compilation of a module is performed a bit differently: for every MPS module a java module is generated, so in the end each MPS module is compiled by an ordinary ant javac task (or similar other task, if it was selected in <i id="37bbaf08">Java Options</i>).</p>   <p id="2df38919">So in order to generate and compile, dependencies of a module are to be collected and embedded into the generated build xml file. Used languages and devkits are collected during generation of a build script from the module descriptor files. The other information is stored inside the build script node. In the picture below a module structure is shown for a project called "myproject", which uses some third-party MPS library called "mylibrary".</p>   <p id="d677d93a">      <figure><img alt="normal module structure" title="normal module structure" src="/help/img/idea/2019.2/normal-module-structure.png" id="1a4c5f81" width="982" height="362"></figure>   </p>   <p id="28468798">The arrows illustrate the dependency system between modules. The purple arrows denote dependencies that are extracted to the build script, the blue arrows indicate, which dependencies are not extracted. It can be easily observed that in order to compile and generate the modules from&nbsp;<b id="c351ba3c">my project</b>&nbsp;a knowledge of the "blue arrows" inside of mylibrary is not required. Which means that the actual module files from my library may not even be present during myproject build script generation. Every information that the generator needs is contained in the build script. Which is really very convenient: there is no need to download the whole library and specify its full location during build generation and so the generation process saves time and memory by not loading all module descriptors from project dependencies.</p>   <h4 id="sourcesandtests">Sources and tests</h4>   <p id="8634e52c">When an MPS solution contains test models, i.e models with the stereotype "@tests", they are generated into a folder "tests_gen" which is not compiled by default. To compile tests, one needs to specify in the build script that a solution has test models. This is done manually in the inspector. There are three options available for a solution: "with sources" (the default), "with tests" and "with sources and tests".<br>       <figure><img alt="withTests" title="withTests" src="/help/img/idea/2019.2/withTests.png" id="bc88af16" width="775" height="324"></figure>   </p>   <h4 id="mpssettings">MPS Settings</h4>   <p id="25d38376">      <i id="8743e56b">mps settings</i> allow to change the MPS-specific parameters for a build script. No more than one instance of <i id="cfce77b7">mps settings</i> can exist in the build script in the "additional aspects" section. Parameters that can be changed:</p>   <ul class="list _ul"><li class="list__item" id="ee34dc45"><p>         <i id="d6bf12f1">bootstrap</i> – setting this flag to "true" indicates that there are some bootstrapping dependencies between modules in the script. Normally the flag is set to false. See <a href="removing-bootstrapping-dependency-problems.html">Removing bootstrapping dependency problems</a> for details.</p></li><li class="list__item" id="18df3acb"><p>         <i id="95dac4e7">test generation</i> – if set to true, the build script tests modules generation and difference between generated files and files on disk. Files can be excluded from diff in <i id="c128b0d2">excludes</i> section.</p></li><li class="list__item" id="b392ff9e"><p>         <i id="a75de637">generation max heap size in mb</i> – maximum heap size for generation and generation testing.</p></li></ul>   <h4 id="testingmodulesgeneration">Testing Modules Generation</h4>   <p id="5bba1be5">Projects that keep their generated source files in version control can check that these generated files are up-to-date using build script. After setting <i id="f5cbcafd">test generration</i> in <i id="309ff122">mps settings</i> to true a call of <i id="a687f5de">gentest</i> task appears in <i id="63d344cc">test</i> target of generated build script. Similarly to <i id="f6b1a263">generate</i> task, <i id="ed3847e2">gentest</i> loads modules in the script, their dependencies from other build scripts and idea plugins that are required. For each module <i id="baac55b0">gentest</i> task invokes two tests: "%MODULE_NAME%.Test.Generating" and "%MODULE_NAME%.Test.Diffing". Test.Generating fails when module has errors during generation and Test.Diffing fails when generated files are different from the ones on disk (checked out from version control). Test results and statistic are formatted into an xml file supported by the TeamCity build server.</p>   <h4 id="ideaplugins">IDEA plugins</h4>   <p id="6b21cc95">      <i id="ccae8056">idea plugin</i> construction defines a plugin for IntelliJ IDEA or MPS with MPS modules in it. In the screenshot you can see an example of such plugin.</p>   <p id="f4d07656">      <figure><img alt="blxx1" title="blxx1" src="/help/img/idea/2019.2/blxx1.png" id="ac2e5854" width="500" height="610"></figure>   </p>   <p id="08c133ec">The first section of the plugin declaration consists of various information describing the plugin: its name and description, the name of the folder, the plugin vendor, etc.. The important string here is <b id="db225d2e">plugin id</b>,&nbsp;which goes after the keywords <i id="a98086e3">idea plugin</i>. This is the unique identifier of the plugin among all the others. There are three options of how the&nbsp;<i id="406fca44">plugin.xml</i> file gets constructed. It can either use solely the information contained in the&nbsp;<b id="097806b4">idea plugin</b> section fo the build script, enrich the information with content of a&nbsp;<b id="35c4276a">provided</b>&nbsp;<i id="b4b825e4">plugin.xml</i> file or use solely a&nbsp;<b id="d6b5d2a3">custom</b>&nbsp;<i id="3cfb26ec">plugin.xml</i> file.</p>   <p id="ec64eec9">      <figure><img alt="blxx2" title="blxx2" src="/help/img/idea/2019.2/blxx2.png" id="24304a64" width="500" height="286"></figure>   </p>   <p id="ec74e475">The next section inside&nbsp;<b id="e24399f9">idea plugin</b> is the actual plugin content – a set of modules or module groups included into the plugin.</p>   <p id="96b3d306">The last section is dedicated to the plugin dependencies on other plugins. The rule is that if we have a "moduleA" located in plugin "pluginA", which depends on "moduleB" located in "pluginB", then there should be a dependency of "pluginA" on "pluginB". A typesystem&nbsp;check exists&nbsp;that will identify and report such problems.</p>   <p id="0232a1e5">The <b id="697072e4">layout</b> of the plugin is specified last. There are two possible options how to package a plugin:</p>   <ul class="list _ul"><li class="list__item" id="6f9c5e87"><p>auto packaging -&nbsp;all the provided languages and solutions are put into the 'languages' folder under the plugin root directory</p></li><li class="list__item" id="04ffc77d">         <p id="ac43a739">manual packaging - the developer has to define the whole plugin layout manually</p>      </li></ul>   <p id="16cb65a3">      <figure><img alt="blxx3" title="blxx3" src="/help/img/idea/2019.2/blxx3.png" id="3aacb84a" width="500" height="290"></figure>   </p>   <h4 id="mpstargets">MPS Targets</h4>   <p id="d4d180cd">The MPS plugin provides the following targets:</p>   <ul class="list _ul"><li class="list__item" id="e7e4ba24"><p>         <i id="6927c47c">generate</i>&nbsp;- generates the mps modules that are included in the&nbsp;<i id="4f59fb3f">project structure</i>.</p></li><li class="list__item" id="3cbb6766"><p>         <i id="b683b034">cleanSources</i>&nbsp;- cleans the generated code (only for modules without bootstrapping dependencies). See more about bootstrapping dependencies in article <a href="removing-bootstrapping-dependency-problems.html">Removing bootstrapping dependency problems</a>.</p></li><li class="list__item" id="f1f23b19"><p>         <i id="ce7ebbd4">declare-mps-tasks</i> - a utility target that declares mps tasks such as <i id="d5bafb1b">generate</i> or <i id="d386be5a">copyModels</i>.</p></li><li class="list__item" id="8cd4b720"><p>         <i id="09bfd0d3">makeDependents</i>&nbsp;- invokes the&nbsp;<i id="3b14da36">generate</i> target for a transient closure of this script's dependencies&nbsp;(if there is one) and then invokes&nbsp;<i id="115e3d77">assemble</i>&nbsp;to put them together. It is guaranteed that each script is executed only after all its dependencies have been built.</p></li></ul>   <h3 id="moduletestingplugin">Module Testing plugin</h3>   <p id="acaaec3e">The <i id="bf704abd">Module testing</i> plugin, provided by <i id="cbfc8f37">jetbrains.mps.build.mps.tests language</i>, adds to build scripts the&nbsp;capability to execute <i id="4f53b866">NodeTestCases</i>&nbsp;and <i id="fb501a7a">EditorTestCases</i> in the MPS solutions. Tests are executed after all modules are compiled and packaged into a distribution, i.e. against the packaged code, so they are invoked in an environment that closely mimics the real use of the code.</p>   <h4 id="testmodulesconfigurations">Test modules configurations</h4>   <p id="1581b436">Solutions/module groups with tests are grouped into <i id="7ae2ed5b">test modules configurations</i>, which is a group of solutions with tests to be executed together in the same environment. All required dependencies (i.e. modules and plugins) are loaded into that environment.<br> In the screenshot, you can see a test modules configuration, named execution, which contains a solution <i id="c49ce50c">jetbrains.mps.execution.impl.tests</i> and a module group <i id="df02ba1b">debugger-tests</i>.<br>      <figure><img alt="blxx5" title="blxx5" src="/help/img/idea/2019.2/blxx5.png" id="eff54556" width="500" height="976"></figure>   </p>   <p id="cc70ca59">There is a precondition for solutions to be included into a test modules configuration. A solution should be specified as containing tests (by selecting "with tests" or "with sources and tests" in inspector). A module group should contain at least one module with tests.</p>   <p id="f065ef76">Test results and statistic are formatted into an xml file (which is supported by TeamCity).</p>   <p id="80450b8b">The test modules run configuration construction supports a possibility to specify additional idea plugins which ought to be loaded during the MPS ant test execution. The plugins required for the MPS ant test execution sometimes cannot be calculated automatically. There are scenarios when the tests need a particular plugin available and that information cannot be deduced from the modules containing the tests by the MPS build language engine. In such situations the needed plugins can be specified manually.</p>   <p id="29af0bea">      <figure><img alt="blxx4" title="blxx4" src="/help/img/idea/2019.2/blxx4.png" id="e1c7f0fd" width="500" height="288"></figure>   </p>   <h3 id="mps-runnerplugin">MPS-runner plugin</h3>   <p id="c08e6eda">The&nbsp;<i id="c735423a">MPS-runner</i>&nbsp;plugin, provided by&nbsp;<i id="557e501b">jetbrains.mps.build.mps.runner</i>,&nbsp;enables a new build script entry - <b id="1541e732">run code from solution</b>. By pointing it to a solution that holds your Java code the build script will be able to run it as part of the build process.</p>   <p id="961a34a4">      <figure><a class="lightbox" href="/help/img/idea/2019.2/Runner.png"><img alt="Runner" title="Runner" src="/help/img/idea/2019.2/Runner.png" id="6b3e745a" width="500" height="146"></a></figure>   </p>   <p id="0f16d104">A minimalistic build script that invokes a Java class located in a "sandbox" solution of a project could look somewhat like this:</p>   <p id="be9fddd3">      <figure><a class="lightbox" href="/help/img/idea/2019.2/Runner1.png"><img alt="Runner1" title="Runner1" src="/help/img/idea/2019.2/Runner1.png" id="72fc499e" width="500" height="1526"></a></figure>   </p>   <p id="dba47094">      The <b id="41db34a6">run code from solution</b> instruction allows to enable selected plugins in the MPS instance that will run the code. The corresponding plugin will be enabled, together with its dependencies.      <figure><a class="lightbox" href="/help/img/idea/2019.2/RunnerWithPlugins.png"><img alt="RunnerWithPlugins" title="RunnerWithPlugins" src="/help/img/idea/2019.2/RunnerWithPlugins.png" id="62270b92" width="500" height="170"></a></figure>   </p>   <h3 id="controlovertherepository">Control over the repository</h3>   <p id="ee7db116">The MPS ant task provides full control over the repository contents with several new tags -&nbsp;<i id="2047a865">module</i>,&nbsp;<i id="d4bbf4ec">modules</i>&nbsp;and&nbsp;<i id="8c082e9e">allmpsmodules</i>.</p>   <p id="74ecf6f7">      <figure><a class="lightbox" href="/help/img/idea/2019.2/Migrate.png"><img alt="Migrate" title="Migrate" src="/help/img/idea/2019.2/Migrate.png" id="3c2c3cee" width="500" height="220"></a></figure>   </p>   <h2 id="how-to's">How-to's</h2>   <p id="9aa456df">The following articles explain how to build a language plugin:</p>   <ul class="list _ul"><li class="list__item" id="a45f8baa">         <a href="building-intellij-idea-language-plugins.html">Building IntelliJ IDEA language plugins</a>      </li><li class="list__item" id="1ba31018">         <a href="building-mps-language-plugins.html">Building MPS language plugins</a>      </li><li class="list__item" id="509d7625">         <a href="building-standalone-ides-for-your-languages.html">Building standalone IDEs</a>      </li></ul>   <p id="954d76d1">Articles on the topic of building with MPS:</p>   <ul class="list _ul"><li class="list__item" id="a58ca686">         <a href="removing-bootstrapping-dependency-problems.html">Removing bootstrapping dependency problems</a>      </li></ul><div class="last-modified" data-skip-index="skip">Last modified: 30 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="pattern.html">Pattern</a><a class="navigation-links__next" href="howto-mps-and-ant.html">HowTo -- MPS and ant</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>