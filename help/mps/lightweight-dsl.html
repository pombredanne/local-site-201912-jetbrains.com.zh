<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>轻量级DSL-帮助MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Lightweight+DSL.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索MPS帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected>默认</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_mac_os_x" data-group="primary">Eclipse（Mac OS X）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_mac_os_x" data-group="primary">Mac OS X</option><option value="primary_mac_os_x_10.5_" data-group="primary">Mac OS X 10.5以上</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="secondary_default" data-group="secondary">默认</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_jbuilder" data-group="secondary">JBuilder的</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">Mac OS X 10.5以上</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="lightweight-dsl.xml" data-toc="Lightweight+DSL.html">轻量级DSL</h1>   <p id="131fdff5">多年发展的MPS核心语言使我们认识到用于IDE集成的语言描述DSL中的重复模式。从概念上讲，它们的外观和行为类似于由实现某些更高级别接口的普通类表示的更高级别构造。在面向语言程序设计的良好传统中，我们决定将这些模式反映在语言中，并将它们重新实现为在普通<i id="f0434ae3">BaseLanguage</i>类之上的瘦抽象。已经创建了新的<b id="8e2f899b">轻量级DSL</b>语言来启用这种抽象。</p>   <p id="de88030e"><i id="61a34ae5">jetbrains.mps.baselanguage.lightweightdsl</i>语言使内部DSL可以嵌入<i id="01eb141a">BaseLanguage</i>类中。通常，内部DSL比成熟的外部DSL更容易和更快地开发，它们通常重用宿主语言的语法并与周围的非DSL代码紧密集成。类似地，可以通过定义单个节点，然后将该节点编织到<i id="1a3954f1">BaseLanguage</i> ClassConcept或其子概念中来创建MPS中的<b id="9638544b">轻量级DSL</b> 。</p>   <p id="aab2b2b0">MPS本身在多个地方利用了这种机制：</p>   <ul class="list _ul"><li class="list__item" id="9d7fe247"><p>         <i id="bde63bd0">MigrationScript</i>概念只是一个BaseLanguage类，通过<i id="8228b288">Migration</i> DSLDescriptor进行了增强，它添加了一些额外的属性，成员和自定义成员</p></li><li class="list__item" id="973c31d7"><p>查找用法</p></li><li class="list__item" id="5fb900cb"><p>意向</p></li><li class="list__item" id="8c5c5518"><p>自定义语言方面</p></li></ul>   <p id="ce2cc880">您可以将轻量级DSL编织到普通的<i id="5e857b8a">BaseLanguage</i>类中，也可以编织到扩展<i id="191b37bc">ClassConcept</i>的概念中。</p>   <h2 id="enhancingplainclasses">提高普通班</h2>   <p id="1b1322c7">轻量级DSL语言的核心思想是允许DSL设计人员定义<b id="e8f1bc93">具有约束的接口</b> ，例如可选方法和属性，取决于约束的类型，可选方法参数，自定义类成员等。所述<i id="ddfc2a5e">DSLDescriptor</i>概念表示编纂，应该在执行<i id="7383cb7d">类</i>来实施这样的约束的接口的节点。例如，以下<i id="674cabd2">DSLDescriptor</i>实例将把<i id="448454ef">numberOfFrames</i>属性编织到类中，以及一个<i id="d6978041">calculateFoo（）</i>方法和一个自定义<i id="1a0a48e8">BuilderMember</i>节点：</p>   <p id="c858e9c1">dslclass SwingBuilder，用于概念ClassConcept {<br>属性numberOfFrames：整数；占位符<one frame=""> <br>方法calculateFoo（int值）：int;需要<br>自定义成员BuilderMember； <modifiers> <br>       <br>初始值设定项：<br>{node <classconcept>节点，模型模型=>}<br>}</classconcept></modifiers></one></p>   <p id="77a280fa">为了使特定的<i id="7402dbf6">DSLDescriptor</i>在类上生效，需要使用<i id="df34d267">DSLAnnotation</i>对其进行注释，这是通过意图完成的：</p>   <p id="07ef3f90">      </p><figure><img alt="ldsl1" title="ldsl1" src="/help/img/idea/2019.2/ldsl1.png" id="ab75134c" width="413" height="183"></figure>   <p></p>   <p id="8e88b6bf">      </p><figure><img alt="ldsl2" title="ldsl2" src="/help/img/idea/2019.2/ldsl2.png" id="22f1ab0d" width="379" height="188"></figure>   <p></p>   <p id="a0a0bf5e">添加注释后，将在<i id="38cf63f2">DSLDescriptor中</i>定义的必需元素或具有指定<b id="dd8744da">占位符的</b>元素添加到类中。删除必需的元素将导致在类上指示错误：</p>   <p id="c53d353f">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl3.png"><img alt="ldsl3" title="ldsl3" src="/help/img/idea/2019.2/ldsl3.png" id="6406dc8c" width="300" height="228"></a></figure>   <p></p>   <p id="f5193c1c">可以使用意图在一个步骤中重新添加所需的元素以及占位符：</p>   <p id="21b44fec">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl4.png"><img alt="ldsl4" title="ldsl4" src="/help/img/idea/2019.2/ldsl4.png" id="f00cc1e0" width="300" height="406"></a></figure>   <p></p>   <p id="86fdd653">标准的<b id="cd2e2ef7">实现方法</b>操作（ <i id="8e32128d">Control / Cmd + I</i> ）也可以用于必需的方法。</p>   <h2 id="defininga dsldescriptor">定义DSLDescriptor</h2>   <p id="b9d8f54f"><i id="37226c64">DSLDescriptor</i>可以向类添加四种类型的元素：</p>   <ul class="list _ul"><li class="list__item" id="f4ba6853"><p>属性</p></li><li class="list__item" id="c247b2dd"><p>方法</p></li><li class="list__item" id="e392c944"><p>自定义成员</p></li><li class="list__item" id="ccdda225"><p>初始化器</p></li></ul>   <p id="2b418a5b">其中的每一个都是<b id="f79df5b4">必需的</b> ，可以定义一个<b id="616fb923">占位符</b>以表示缺少的成员，并且可以将<i id="9ff1b0c2">自定义成员</i>标记为<b id="a4cb75a1">多个，</b>表示该类的一个以上节点可以是该类的成员。</p>   <h3 id="properties">性质</h3>   <p id="c8288fa8">属性具有<b id="22006427">名称，</b>并且可以是<b id="a82244b9">string</b> ， <b id="5a736268">int</b>或<b id="5957043f">boolean</b>类型。属性成为编织类的完全成员，并且可以从其他成员（包括通过this或其他<i id="55ade29f">DSLDescriptor</i>编织的成员）访问<i id="55ade29f">属性</i> 。</p>   <h3 id="methods">方法</h3>   <p id="0798d04d">方法提供了一种非常方便的方式来让您的轻量级DSL用户注入代码<i id="c5aa22ff">-DSLDescriptor</i>指定增强类可以或必须实现的方法的方法签名。与常规方法不同，可以根据宿主（增强型）类中的实际使用情况来确定这些编织方法的返回类型以及任何参数的类型。</p>   <h4 id="dependenttypes">依赖类型</h4>   <p id="1b3dc3b6">当为方法的返回类型或参数类型指定<b id="7db1cf12">依赖类型</b>时， <b id="7db1cf12">从属类型</b>指定为给定类计算方法的实际类型的方法。</p>   <p id="cbe18f67">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl5.png"><img alt="ldsl5" title="ldsl5" src="/help/img/idea/2019.2/ldsl5.png" id="70912607" width="900" height="636"></a></figure>   <p></p>   <h4 id="conditionalmethodparameters">条件方法参数</h4>   <p id="e965cb4a">方法可以将一些参数标记为<b id="b412eaca">conditional</b> ，以便只有在满足所提供的条件时，它们才在用户代码中可见。要将参数标记为<b id="79b06184">条件</b>参数，可以使用相应的用途：</p>   <p id="942d24d8">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl19.png"><img alt="ldsl19" title="ldsl19" src="/help/img/idea/2019.2/ldsl19.png" id="68bb7720" width="500" height="380"></a></figure>   <p></p>   <p id="506cebe7">实际条件在<b id="1d1591d0">检查器中</b>指定：</p>   <p id="f58cdfe5"> </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl20.png"><img alt="ldsl20" title="ldsl20" src="/help/img/idea/2019.2/ldsl20.png" id="2c15e39b" width="700" height="434"></a></figure>   <p></p>   <h3 id="custommembers">自订会员</h3>   <p id="6440c8bf">如果属性和方法都没有提供所需的抽象级别，则只需一点点额外的工作就可以使用自定义成员来编织任意概念。</p>   <p id="12b6939c">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl6.png"><img alt="ldsl6" title="ldsl6" src="/help/img/idea/2019.2/ldsl6.png" id="e56cf793" width="500" height="278"></a></figure>   <p></p>   <p id="8ea53de5"><i id="7c12d82f">CustomMemberDescriptor</i>指向一个概念（在本例中为<i id="b9bc4f91">BuilderMember</i> ），它将作为新成员被编织到类中。为此，该概念必须实现<i id="591d1d3d">MemberInstance</i>和<i id="3265f9ee">ClassifierMember</i>概念接口，并从覆盖的<i id="ff218586">getDeclaration（）</i>方法指向<i id="c420dab2">CustomMemberDescriptor</i> 。</p>   <p id="c0f6eb09">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl7.png"><img alt="ldsl7" title="ldsl7" src="/help/img/idea/2019.2/ldsl7.png" id="c7e1f6ca" width="500" height="660"></a></figure>   <p></p>   <p id="7c65c465">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl8.png"><img alt="ldsl8" title="ldsl8" src="/help/img/idea/2019.2/ldsl8.png" id="e8aa91c8" width="500" height="532"></a></figure>   <p></p>   <p id="e05d18bb">现在可以将指定概念的一个节点（或多个节点，如果<i id="a57bf0e0">CustomMemberDescriptor</i>定义为<b id="425d5918">multiple</b> ）实例化为主机类的成员，并在其中进行编辑：</p>   <p id="371f3320">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl9.png"><img alt="ldsl9" title="ldsl9" src="/help/img/idea/2019.2/ldsl9.png" id="61684c3a" width="500" height="1276"></a></figure>   <p></p>   <h3 id="initializer">初始化器</h3>   <p id="64b8550c">一旦使用<i id="1ebfea0c">DSLAnnotation</i>创建或注释了宿主类，初始化函数就有机会以编程方式增强宿主类。调用初始化程序时，节点（主机类）本身可能尚未添加到模型中，因此与节点一样提供了模型参数。如果导入<i id="5938ad28">smodel</i>语言，则可以操纵类和模型。通常，如果需要，初始化器将设置导入和使用的语言，或者为编织成员提供默认值和实现。</p>   <p id="ba3d75ef">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl10.png"><img alt="ldsl10" title="ldsl10" src="/help/img/idea/2019.2/ldsl10.png" id="e0bceeea" width="900" height="1180"></a></figure>   <p></p>   <h2 id="enhancingcustomclassconceptsub-concepts">增强自定义ClassConcept子概念</h2>   <p id="dc820c2a">如果您不是直接增强<i id="1080b170">BaseLanguage</i>类，而是增强<i id="5671d4cd">ClassConcept</i>类的特定子概念，则有一些细节。这使您可以结合使用外部和内部DSL的优势。一旦您的DSL需要自定义的编辑经验，专用的生成器或特定的类型系统规则，通常就可以创建<i id="721c7d71">ClassConcept</i>子概念，而不是使用普通的<i id="f38ea41d">BaseLanguage</i>类。因此，您将创建<i id="30975bc7">ClassConcept</i>的子概念，并使其实现<i id="02866a11">AutoInitDSLClass</i> 。</p>   <p id="66cfc22e">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl11.png"><img alt="ldsl11" title="ldsl11" src="/help/img/idea/2019.2/ldsl11.png" id="5579692f" width="500" height="628"></a></figure>   <p></p>   <p id="2a62a245">实施<i id="71d8c875">AutoInitDSLClass</i>确保每当你的概念的一个节点被创建时，在DSL的编织得到正确通过调用其<i id="0c1807a5">DSLDescriptor</i> <i id="68176ddf">已</i>定义的<b id="763fafac">初始化</b>初始化。</p>   <p id="86bb4782">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/ldsl12.png"><img alt="ldsl12" title="ldsl12" src="/help/img/idea/2019.2/ldsl12.png" id="65e8bffb" width="500" height="418"></a></figure>   <p></p>   <p id="4ec9f3de"><i id="cc83eb53">AutoInitDSLClass</i>接口还要求实现概念重写<i id="a0a3b293">getDescriptor（）</i>方法，该方法应返回要编织的特定<i id="0d5a0d80">DSLDescriptor</i>实例。</p>   <h2 id="samples">样品</h2>   <p id="a5fced31">可以在与MPS分发捆绑在一起的<b id="69867e07">lightweightDSL</b>示例项目中找到说明Lightweight DSL基本用法的示例。</p><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月30日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="custom-aspect.html">自定义方面</a> <a class="navigation-links__next" href="base-language.html">基础语言</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>