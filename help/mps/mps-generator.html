<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>发电机-帮助| MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Generator.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索MPS帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected>默认</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_mac_os_x" data-group="primary">Eclipse（Mac OS X）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_mac_os_x" data-group="primary">Mac OS X</option><option value="primary_mac_os_x_10.5_" data-group="primary">Mac OS X 10.5以上</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="secondary_default" data-group="secondary">默认</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_jbuilder" data-group="secondary">JBuilder的</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">Mac OS X 10.5以上</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="mps-generator.xml" data-toc="Generator.html">发电机</h1>   <aside class="tip sideblock" rel="mps-generator.xml" id="9c4c4b04" data-title="">      <p id="8b674455">有关MPS生成器的快速操作文档，请查阅<a href="generator-cookbook.html">生成器指南</a> 。</p>   </aside>   <p id="9bc33cea">      </p><ul data-skip-index="skip"><li class="list__item"><a href="#introduction">介绍</a></li><li class="list__item"><a href="#overview">总览</a></li><li class="list__item"><a href="#generatormodule">发电机模块</a></li><li class="list__item"><a href="#creatinganewgenerator">创建一个新的发电机</a></li><li class="list__item"><a href="#generatorproperties">发电机特性</a></li><li class="list__item"><a href="#generatinggenerator">发电机</a></li><li class="list__item"><a href="#transformation">转型</a></li><li class="list__item"><a href="#mappingconfigurations">映射配置</a></li><li class="list__item"><a href="#generatorrules">发电机规则</a></li><li class="list__item"><a href="#macros">巨集</a></li><li class="list__item"><a href="#externaltemplates">外部模板</a></li><li class="list__item"><a href="#templateswitches">模板开关</a></li><li class="list__item"><a href="#generatingfromant">从蚂蚁产生</a></li><li class="list__item"><a href="#examples">例子</a></li></ul>   <p></p>   <h2 id="introduction">介绍</h2>   <p id="98f2f145">生成器是语言规范的一部分，它定义了语言中概念的<a href="http://en.wikipedia.org/wiki/Formal_semantics_of_programming_languages" rel="noopener noreferrer" data-external="true" target="_blank">指称</a>语义。</p>   <p id="81edf627">MPS遵循<b id="367f1496">模型到模型的转换</b>方法。MPS生成器指定将以输入语言编码的构造转换为以输出语言编码的构造。模型到模型的转换过程可能涉及许多中间模型，并最终导致sn <b id="0e33d20d">输出模型</b> ，其中所有构造都使用其语义已经在其他位置定义的语言。</p>   <p id="90aaa89f">例如， <i id="a4ac7570">baseLanguage中的</i>大多数概念（类，方法等）都是“机器可理解的”，因此<i id="e7bf1db4">baseLanguage</i>通常被用作输出语言。</p>   <p id="d505d86f">通过应用<b id="c5630aaf">模型到文本的转换</b>来创建目标资产，该<b id="c5630aaf">转换</b>必须得到输出语言的支持。定义模型到文本转换的<i id="917ccf01">语言方面</i>称为<a href="textgen.html">TextGen</a> ，可以在概念编辑器中作为单独的选项卡使用。MPS仅提供破坏性的生成资产更新。</p>   <p id="6714babf">例如， <i id="f60b8a97">baseLanguage</i>的<i id="a5b7e8ef">TextGen</i>方面在以下位置生成<i id="5f348b03">* .java</i>文件：<br>< <i id="21444597">生成器输出路径</i> > \ < <i id="f4af55d5">模型名称</i> > \ < <i id="26514f10">类别</i> <i id="f4af55d5">名称</i> > .java<br>哪里：<br>       <b id="32855003">发电机输出路径</b> -在拥有输入模型的模块中指定。<br>      <b id="20bf68b6">型号名称</b> -是通过替换'。'创建的路径段。输入模型名称中带有文件分隔符。</p>   <aside class="tip sideblock" rel="6714babf" id="5c105da4" data-title="">      <p id="97cc72d6">有关MPS生成器的快速操作文档，请查阅<a href="generator-cookbook.html">生成器指南</a> 。</p>   </aside>      <h2 id="overview">总览</h2>   <h3 id="generatormodule">发电机模块</h3>   <p id="df054949">与任何其他语言方面不同，生成器方面不是单个模型。发电机规格可以包括<b id="5fddb3e5">许多发电机模型</b>以及<b id="3d0a0ff0">实用新型</b> 。<i id="84af8df1">生成器模型</i>包含生成器语言的<i id="768eb11b">模板</i> ， <i id="6c6aacc1">映射配置</i>和其他构造。</p>   <p id="011f78ac">      <i id="bce06ff7">生成器模型</i>与常规模型的区别在于模型原型<i id="b33ab5b3">-'generator</i> '（在模型名称后显示为< <i id="888f8f19">name</i> > @ <b id="0bc9c30c">generator</b> ）。<br>下面的屏幕截图显示了<a href="smodel-language.html">smodel语言</a>的生成器模块作为示例。</p>   <p id="6e5f5a78">      </p><figure><img alt="撬子生成器模块" title="撬子生成器模块" src="/help/img/idea/2019.2/gug-generator-module.png" id="e65bbdc1" width="382" height="494"></figure>   <p></p>   <aside class="tip sideblock" rel="6e5f5a78" id="14bb2b5f" data-title="">      <p id="fbded180">您可以自己研究<i id="b2187afc">smodel</i> （和任何其他）语言生成器：</p>      <ul class="list _ul"><li class="list__item" id="5ac12410"><p>下载MPS（ <a href="http://www.jetbrains.com/mps/download/index.html" rel="noopener noreferrer" data-external="true" target="_blank">在此处</a> ）；</p></li><li class="list__item" id="6000c0c3"><p>创建新项目（可以是空项目）；</p></li><li class="list__item" id="9647949b"><p>使用主菜单中的<i id="34c65720">转到->转到语言</i>命令导航到smodel语言（其全名是<i id="aa785c90">jetbrains.mps.lang.smodel</i> ）</p></li></ul>   </aside>   <h4 id="creatinganewgenerator">创建一个新的发电机</h4>   <p id="35bf6f92">通过使用语言的弹出菜单中的“ <i id="2205762b">新建”->“生成器”</i>命令来创建新的生成器。</p>   <p id="9d68c0c7">从技术上讲，可以为一种语言创建一个以上的生成器，但是在编写MPS时并未提供对此功能的完全支持。因此，语言通常只有一个（或没有）生成器。因此，生成器的名称并不重要。在MPS GUI的任何地方，生成器模块都可以通过其语言名称来识别。</p>   <p id="4d99b5d3">创建新的生成器模块时，MPS还将创建包含空<b id="6d262624">映射配置</b>节点的生成器模型“ main @ generator”。</p>   <h4 id="generatorproperties">发电机特性</h4>   <p id="21e95d01">作为一个模块，生成器可以依赖于其他模块， <i id="93f3207b">使用过的语言</i>和<i id="f15ca493">使用过的devkit</i> （请参阅<a href="mps-project-structure.html#modulemetainformation">模块元信息</a> ）。</p>   <p id="976516ff">生成器属性对话框还具有两个附加属性：</p>   <ul class="list _ul"><li class="list__item" id="5753da08"><p>         <b id="be956909">取决于生成器</b> -指定对其他生成器的依赖关系；这允许从属生成器引用另一个生成器中定义的模板；</p></li><li class="list__item" id="6e3dffd8"><p>         <b id="f68c4e1b">映射约束</b> -可以指定映射规则之间的优先级关系。如果这种关系涉及其他生成器规则，则还需要声明对该生成器的依赖性。</p></li></ul>   <h4 id="generatinggenerator">发电机</h4>   <p id="5d13c673">MPS生成器引擎（或生成器语言运行时）使用<b id="847bad62">混合编译/解释模式</b>进行转换执行。</p>   <p id="f1997765">模板在运行时进行解释和填充，但是规则，宏和脚本中的所有函数都必须预先编译。</p>   <p id="285c6c54">为避免混淆，请始终遵循以下规则：对生成器模型进行任何更改后，必须重新生成模型（ <i id="d285f87a">Shift + F9</i> ）。更好的是使用<i id="9547ca51">Ctrl + F9</i> ，它将在生成器模块中重新生成所有修改的模型。</p>   <h3 id="transformation">转型</h3>   <p id="1abef4ed">转换是通过<b id="2fbb752f">模板</b>描述的。模板是使用<b id="46700ea2">输出语言</b>编写的，因此可以使用通常用于以该语言编写“常规代码”的同一单元格编辑器进行编辑。因此，无需任何额外的努力，“模板编辑器”立即具有相同级别的工具支持-语法/错误突出显示，自动完成等。然后，通过引用<b id="ae4070e4">输入模型</b>对模板进行参数化。</p>   <p id="98b3957a">各个模板的适用性由<a href="#generatorrules">#Generator规则</a>定义， <a href="#generatorrules">该规则</a>分组为<a href="#mappingconfigurations">#Mapping配置</a> 。</p>   <h4 id="mappingconfigurations">映射配置</h4>   <p id="49af2618"><i id="55e73e92">映射配置</i>是一个最小单位，可以形成一个生成步骤。它包含<a href="#generatorrules">#Generator规则</a> ，定义了<i id="703814e7">映射标签，</i>并且可能包含<i id="e6cc7d97">预处理</i>和<i id="4d592232">后期处理脚本</i> 。</p>   <h4 id="generatorrules">发电机规则</h4>   <p id="fc09e658">每个转换的适用性由<b id="202aaec9">生成器规则</b>定义。<br>生成器规则有六种类型：</p>   <ul class="list _ul"><li class="list__item" id="4dbdf3c2"><p>条件根规则</p></li><li class="list__item" id="93561cc8"><p>根映射规则</p></li><li class="list__item" id="a884bf36"><p>编织规则</p></li><li class="list__item" id="a4f35dc0"><p>归约法则</p></li><li class="list__item" id="c08cff51"><p>模式规则</p></li><li class="list__item" id="1483e8ea"><p>放弃根治</p></li><li class="list__item" id="3ec8d31c"><p>放置属性规则（ <i id="9328ae78">3.3中的新增功能</i> ）</p></li></ul>   <p id="d7898834">每个生成器规则都包含一个<i id="001020cb">前提</i>和一个<i id="5535204d">结果</i> （“ <i id="8fb861b5">遗弃的根”规则</i>和“ <i id="bad6ea8d">丢弃”属性规则</i>除外，其具有用户无法指定的预定义结果）。</p>   <p id="aff28db0">除<i id="8080c7ad">条件根</i>规则外，所有规则均在其前提中包含对<b id="5f4416ac">输入节点</b>概念（或仅输入概念）的引用。所有规则前提还包含一个可选的<b id="4d53e2d5">条件函数</b> 。</p>   <p id="7fd81ab5">规则结果通常包含对<b id="2b69d1f3">外部模板</b>的引用（即，在相同或不同模型中声明为根节点的模板）或所谓的<b id="6e68bd04">内联模板</b> （条件根规则和根映射规则只能引用外部模板） ）。后果还有其他几种形式。</p>   <p id="f374cfde">以下屏幕快照显示了生成器模型的内容和映射配置示例。<br>      </p><figure><img alt="映射映射配置" title="映射映射配置" src="/help/img/idea/2019.2/gug-mapping-configuration.png" id="4b25029f" width="1255" height="740"></figure>   <p></p>   <h4 id="macros">巨集</h4>   <p id="eca7982f">模板中的代码可以通过宏进行参数化。生成器语言定义了三种宏：</p>   <ul class="list _ul"><li class="list__item" id="5a6a9e3a"><p>         <b id="64c97bd2">属性宏</b> -计算属性值；</p></li><li class="list__item" id="64aa3c2d"><p>         <b id="697dd6c1">参考宏</b> -计算<b id="697dd6c1">参考</b>的目标（节点）；</p></li><li class="list__item" id="09ef39f6"><p>         <b id="b176e597">节点宏</b> -用于在生成时控制模板填充。节点宏有多种版本-LOOP-macro是一个示例。</p></li></ul>   <p id="259a3ae1">宏实现一种特殊的所谓注解概念，并且可以在模板代码中包装属性，引用或节点单元（取决于宏的种类）。</p>   <p id="d7f05d77">通过按<i id="565b84e3">Ctrl + Shift + M</i>或应用“创建宏”的意图来完成代码包装（即，创建新的宏）。</p>   <p id="bdcd763b">以下屏幕截图显示了属性宏的示例。<br>      </p><figure><img alt="gug属性宏样本" title="gug属性宏样本" src="/help/img/idea/2019.2/gug-property-macro-sample.png" id="b19f13e9" width="790" height="253"></figure>   <p></p>   <p id="36cc01ab">在检查器视图中编辑宏功能和其他参数化选项。例如，属性宏需要指定值函数，该函数将在生成时提供属性的值。在上面的示例中，输出类节点将获得与<i id="bb6f84fa">输入节点</i>相同的名称。</p>   <p id="fa33593c">生成器语言的所有功能中的<i id="72b137f9">node</i>参数始终表示当前正在向其应用转换的上下文节点（ <i id="aa93b8df">输入节点</i> ）。</p>   <p id="041c10fd">某些宏（例如LOOP和SWITCH-macro）可以将输入节点替换为新的宏，以便将随后的模板代码（即由这些宏包装的代码）应用于新的输入节点。</p>   <h4 id="externaltemplates">外部模板</h4>   <p id="4cd40244">外部模板被创建为生成器模型中的根节点。</p>   <p id="f44e13c4">MPS中有两种外部模板。</p>   <p id="4b529c48">其中之一是<b id="e64b0292">根模板</b> 。在生成器模型中创建的任何根节点都将被视为<i id="930ff333">根模板，</i>除非该节点是生成器语言的一部分（即，映射配置不是<i id="3b6204ad">根模板</i> ）。<i id="8e3f22e2">根模板</i>被创建为普通根节点（通过模型弹出窗口中的“ <i id="65e6499f">创建根节点”</i>菜单）。</p>   <p id="2707afdb">以下屏幕截图显示了根模板的示例。</p>   <p id="98a6900f">      </p><figure><img alt="Gug根模板样本" title="Gug根模板样本" src="/help/img/idea/2019.2/gug-root-template-sample.png" id="9d8762ba" width="640" height="415"></figure>   <p></p>   <p id="7f00cd7e">此<i id="347d2b77">根模板</i>会将输入节点（一个<i id="baca1a16">Document</i> ）转换为一个<i id="50c6ddbb">类</i> （ <i id="c7ea3810">baseLanguage</i> ）。<i id="4f08fb2d">根模板头</i>在创建时自动添加，但是输入节点的概念由用户指定。</p>   <p id="88c505d0">最好指定输入概念，因为这允许MPS在宏函数的代码中执行静态类型检查。</p>   <p id="18b2e229">      <i id="cbf28410">根模板</i> （引用）可以作为条件根规则和根映射规则的结果。（在条件根规则中使用时，输入节点不可用）。</p>   <p id="079ba652">第二种模板是使用生成器语言定义的，其概念名称为“ TemplateDeclaration”。它是通过“ <i id="25083922">创建根节点”</i>菜单中的“模板声明”操作<i id="25083922">创建的</i> 。</p>   <p id="6f33069b">      </p><figure><img alt="gug新模板声明菜单" title="gug新模板声明菜单" src="/help/img/idea/2019.2/gug-new-template-declaration-menu.png" id="1139c933" width="1013" height="187"></figure>   <p></p>   <p id="e47d68fb">以下屏幕截图显示了模板声明的示例。</p>   <p id="253d7e29">      </p><figure><img alt="Gug模板声明样本" title="Gug模板声明样本" src="/help/img/idea/2019.2/gug-template-declaration-sample.png" id="d31d37d4" width="771" height="494"></figure>   <p></p>   <p id="d5d19979">实际的模板代码被“包装”在<b id="9d15436c">模板片段中</b> 。模板片段之外的任何代码都不会在转换中使用，而是用作上下文（例如，您可以有一个Java类，但是只能将其方法之一导出为模板）。</p>   <p id="f16c3cba">      <i id="d5a2ea9a">模板声明</i>可以具有在标头中<i id="d5a2ea9a">声明的</i>参数。可通过#generation上下文访问参数。</p>   <p id="72220b1c">      <i id="be742499">模板声明</i>用于编织，缩小和图案规则的结果。它也可以用作INCLUDE宏中的<i id="1331d92c">包含模板</i> （仅适用于没有参数的模板），也可以用作CALL宏中的<i id="bd7eb677">被调用者</i> 。</p>   <h4 id="templateswitches">模板开关</h4>   <p id="c83815ff">当模板代码中的某个位置可能进行两个或更多替代转换时，将使用模板开关。在这种情况下，允许替代的模板代码被包装在SWITCH宏中，该宏引用了模板开关。通过“ <i id="48cfec9f">创建根节点”</i>菜单将模板开关创建为生成器模型中的<i id="48cfec9f">根节点</i> （此命令可以在上方的“菜单”屏幕截图中看到）。</p>   <p id="7cc4dd71">以下屏幕截图显示了模板切换的示例。</p>   <p id="11ec857b">      </p><figure><img alt="Gug模板开关样本" title="Gug模板开关样本" src="/help/img/idea/2019.2/gug-template-switch-sample.png" id="5f8e9a38" width="815" height="422"></figure>   <p></p>      <h2 id="generatingfromant">从蚂蚁产生</h2>   <p id="90a15c89">Ant MPS生成器任务公开了可从构建脚本配置的属性（并行，线程，就地，警告）。在构建过程中，构建语言使用后台的Ant Generate任务来转换模型。现在，此任务将公开“ <i id="e54916b0">生成器设置”页面中</i>熟悉的参数：</p>   <ul class="list _ul"><li class="list__item" id="d1d17170">         <b id="99abed55">严格生成方式</b>      </li><li class="list__item" id="7ab61ab9">         <b id="0981b765">可配置线程数的并行生成</b>      </li><li class="list__item" id="b4884d6a">         <b id="afa17717">启用就地转换的选项</b>      </li><li class="list__item" id="84a0b83d"><p>         <b id="148d298e">用于控制生成警告/错误的选项</b> 。</p></li></ul>   <p id="a19330be">这些选项也会在构建语言中使用<code class="code">BuildMps_GeneratorOptions</code>概念，以便构建脚本可以更好地控制过程。</p>   <h2 id="examples">例子</h2>   <p id="3027091d">如果您觉得需要更多实践经验，请查看<a href="generator-demos.html">Generator演示</a> 。<br>演示包含上述所有概念的用法示例。</p>   <hr id="3742727d"><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月30日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="data-flow.html">数据流</a> <a class="navigation-links__next" href="generator-language.html">生成器语言</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>