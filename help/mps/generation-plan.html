<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>生成计划-帮助| MPS</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Generation+plan.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索MPS帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected>默认</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_mac_os_x" data-group="primary">Eclipse（Mac OS X）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_mac_os_x" data-group="primary">Mac OS X</option><option value="primary_mac_os_x_10.5_" data-group="primary">Mac OS X 10.5以上</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="secondary_default" data-group="secondary">默认</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_jbuilder" data-group="secondary">JBuilder的</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">Mac OS X 10.5以上</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="generation-plan.xml" data-toc="Generation+plan.html">发电计划</h1>         <h2 id="generationplan">发电计划</h2>      <p id="814caee7">生成计划允许开发人员为他们的模型明确指定所需的生成顺序，从而更好地控制生成过程。</p>      <h3 id="motivation">动机</h3>      <p id="7ed5d34a">对于大型项目，指定生成器的相互优先级可能变得很麻烦。另外，为了指定优先级，所涉及的语言需要通过声明适当的相互依赖关系来相互了解，这会破坏它们的（有时是期望的）独立性。生成计划将生成步骤的正确排序的责任放在了一个位置-生成计划。它们使语言设计人员能够以期望的顺序为最终用户模型提供直观的方式。生成计划列出了应包含在生成过程中的所有语言，对其进行适当排序，并可以选择指定检查点，生成器应在这些检查点处保留当前的瞬态模型。然后，可以将这些模型用于生成过程之后的自动跨模型参考解析。</p>      <p id="4580a2eb"> </p>      <aside class="tip sideblock" rel="4580a2eb" id="f7ca5afd" data-title="">         <p id="56886d77">这里描述的机制是一个初步的实现，可能会在以下MPS版本中进一步发展。总体方向是：</p>         <ul class="list _ul"><li class="list__item" id="3c70c03d"><p>为语言设计人员提供更大的灵活性，以便他们组织语言用户的版本</p></li><li class="list__item" id="d1988ac7"><p>使最终开发人员（又名语言用户）免于直接处理构建计划，genplan模型或构建方面的需要</p></li></ul>         <p id="2ea29a04">因此，实际的最终用户机制可能会更多地取决于语言设计者的意图。本文所述的方法基于构面和<b id="1775a591">genplan</b>模型，仅是如何完成自定义生成的示例。</p>      </aside>      <h3 id="definingagenerationplan">定义一个生成计划</h3>      <p id="7b50acff">为了创建一个<b id="353a37f1">生成计划</b> ，您首先需要创建一个模型。您可以考虑给模型一个<b id="9dd0b0b5">genplan</b>原型，以轻松将其与普通模型区分开，但这不是强制性的。</p>      <p id="448363b8">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/genplan4.png"><img alt="genplan4" title="genplan4" src="/help/img/idea/2019.2/genplan4.png" id="723f03a3" width="300" height="476"></a></figure>      <p></p>      <p id="06e663e0">导入<i id="9ee7cd8c">jetbrains.mps.lang.generator.plan</i>和<i id="2dc252df">jetbrains.mps.lang.s模型</i>语言后，您可以创建<i id="e515d839">Plan</i>概念的根节点，它将代表您的生成计划：</p>      <p id="c29c7bcf">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/genplan5.png"><img alt="genplan5" title="genplan5" src="/help/img/idea/2019.2/genplan5.png" id="cf65fcb5" width="300" height="402"></a></figure>      <p></p>      <p id="a20ef9b2">生成计划由<b id="9033449e">转换</b>和<b id="0a91c527">检查点组成</b> 。</p>      <p id="4c819e6c">         </p><figure><img alt="genplan1" title="genplan1" src="/help/img/idea/2019.2/genplan1.png" id="31649298" width="500" height="197"></figure>      <p></p>      <p id="4536f0d4">也可以显式指定所需的生成器。</p>      <p id="7608ed74">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Gen2.png"><img alt="第二代" title="第二代" src="/help/img/idea/2019.2/Gen2.png" id="ebb7f17c" width="500" height="922"></a></figure>      <p></p>      <p id="3a09c35b">         <b id="861fc128">转换</b>代表生成步骤，并包括应在该生成阶段中生成的语言。</p>      <p id="b88c2a93">         <b id="0d1acd23">Apply</b>表示对特定生成器的显式调用。<i id="2c5c5a25">带有扩展</i>语句的<i id="2c5c5a25">apply</i>在单个步骤中应用指定的生成器和扩展它们的生成器。这使语言设计者可以适应可能的扩展。</p>      <p id="e779e767">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Gen2.png"><img alt="第二代" title="第二代" src="/help/img/idea/2019.2/Gen2.png" id="e5b93106" width="500" height="922"></a></figure>      <p></p>      <p id="8e95debd">         <b id="6b05a814">Fork with</b>使计划可以分叉生成过程并分叉另一个生成计划。</p>      <p id="0ebc8cd1">         </p><figure><img alt="叉G" title="叉G" src="/help/img/idea/2019.2/ForkG.png" id="390d1850" width="500" height="340"></figure>      <p></p>      <p id="66e5a55c">引用的生成计划将从模型的副本开始（处于分叉步骤的状态）开始，并作为常规转换进行。从这时起，两个发电机将独立运行。</p>      <p id="1807bf3f">         <b id="a45a6c76">检查点</b>表示生成过程中应保留中间模型的点。在生成的后期将被解析的引用将能够通过<b id="f70da0af">映射标签</b>在存储的中间模型中查找节点的分辨率。您可以在“ <b id="71860368">项目视图”</b>工具窗口中查看以下检查点模型：</p>      <p id="ee3e815f">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/genplan9.png"><img alt="genplan9" title="genplan9" src="/help/img/idea/2019.2/genplan9.png" id="d4a33371" width="300" height="786"></a></figure>      <p></p>      <p id="ffbac504"><todo -="" may="" be="" this="" is="" no="" longer="" valid="">这些中间检查点模型将保留，直到您关闭MPS或重建模型或它们依赖的模型为止。或者，您可以手动删除它们：</todo></p>      <p id="a97ce4ac">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/genplan10.png"><img alt="genplan10" title="genplan10" src="/help/img/idea/2019.2/genplan10.png" id="4ca5bd84" width="300" height="250"></a></figure>      <p></p>      <p id="baa26048">检查点提供了不同计划之间的同步点。检查点模型用与构造模型的检查点名称匹配的构造型表示。使用<plan-name>-</plan-name>命名方案将模型与生成的源并存<plan-name><checkpoint name="">。</checkpoint></plan-name></p>      <p id="8351ca97">不同的语句允许捕获检查点的不同方面。</p>      <ul class="list _ul"><li class="list__item" id="cab1b2da"><p>            <i id="6f9844b3">声明检查点<name></name></i>语句-指定生成器计划可以在它们之间共享的标签。该声明并不记录/保持转换后的模型的状态，仅是其他生成计划可以引用的声明。 <i id="9389508b"></i>         </p></li><li class="list__item" id="f4daec41"><p>            <i id="54862e06">检查站<checkpoint></checkpoint></i> -记录/保留转换后的模型的状态。它可以就地声明检查点，也可以引用已<i id="711987e7">声明的检查点</i> 。</p></li><li class="list__item" id="4cb10713"><p>            <i id="9cb99c0b">与...同步<checkpoint></checkpoint></i>语句-指示生成计划在指定检查点的持久化模型中查找目标节点，但不持久化其自己的节点（对检查点的只读访问）。该语句不引入任何新状态，而是引用在其他地方声明的检查点。</p></li></ul>      <p id="23e953ab">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Gen1.png"><img alt="第一代" title="第一代" src="/help/img/idea/2019.2/Gen1.png" id="de5c4917" width="500" height="894"></a></figure>      <p></p>      <h3 id="specifyingagenerationplanformodels">指定模型的生成计划</h3>      <p id="0277f197">应该根据生成计划构建其模型的模块需要启用<b id="719ce8ef">Custom生成</b>方面并指向实际所需的<b id="14e66fa6">生成计划</b> ：</p>      <p id="044f44a1">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/genplan2.png"><img alt="genplan2" title="genplan2" src="/help/img/idea/2019.2/genplan2.png" id="6fcbcde0" width="500" height="565"></a></figure>      <p></p>      <p id="f84eaeca"> </p><figure><a class="lightbox" href="/help/img/idea/2019.2/genplan3.png"><img alt="genplan3" title="genplan3" src="/help/img/idea/2019.2/genplan3.png" id="d54fbeb4" width="500" height="960"></a></figure>      <p></p>      <h3 id="verifyingthegenerationplan">验证生成计划</h3>      <p id="35200a67">在构建世代轮廓时，模型弹出菜单中的“ <b id="80f1a382">显示世代方案”</b>动作将正确考虑<b id="bfcb99b0">世代方案</b> ：</p>      <p id="59d447d8">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/genplan7.png"><img alt="genplan7" title="genplan7" src="/help/img/idea/2019.2/genplan7.png" id="4a7fd22b" width="300" height="550"></a></figure>      <p></p>      <p id="e426455c">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/genplan6.png"><img alt="genplan6" title="genplan6" src="/help/img/idea/2019.2/genplan6.png" id="176c2362" width="500" height="1356"></a></figure>      <p></p>      <p id="84fbe574">要查看基于生成器优先级的原始生成计划，该计划将在没有显式<b id="03f0c8fd">生成计划</b>脚本的情况下使用，请在单击“ <i id="30607cfa">显示生成计划”</i>菜单项时按住<i id="3a7d2266">Alt</i>键：</p>      <p id="251cf855">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/genplan7.png"><img alt="genplan7" title="genplan7" src="/help/img/idea/2019.2/genplan7.png" id="b87fdbcd" width="300" height="550"></a></figure>      <p></p>      <p id="d8e6630d">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/genplan8.png"><img alt="genplan8" title="genplan8" src="/help/img/idea/2019.2/genplan8.png" id="56721c4f" width="500" height="1512"></a></figure>      <p></p>      <p id="4410fe58">         <i id="7912d1e1">请注意，报告在标题中指出它不是当前活动的计划。</i>      </p>      <h3 id="usingdevkitstoassociateagenerationplan">使用DevKit关联生成计划</h3>      <p id="f1979d9f">DevKits也可以关联一个生成计划。</p>      <p id="46c8fba7">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/devkit1.png"><img alt="devkit1" title="devkit1" src="/help/img/idea/2019.2/devkit1.png" id="d36e5bc0" width="500" height="490"></a></figure>      <p></p>      <p id="e602dc91">首先添加对DevKit应该包装的语言和解决方案的依赖。然后从导入的解决方案中指定<b id="3d21555b">生成计划</b> ，该计划将与DevKit关联。导入DevKit的任何<b id="6e78cbd7">模型</b>都将获得与DevKit相关的生成计划。</p>      <p id="1347ca4f">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/devkit2.png"><img alt="devkit2" title="devkit2" src="/help/img/idea/2019.2/devkit2.png" id="7c759527" width="500" height="383"></a></figure>      <p></p>      <aside class="warning " rel="1347ca4f" id="0daae3ed" data-title="">         <p id="2eb88b88">目前每个模型仅允许使用一个带计划的DevKit。</p>      </aside>      <h3 id="cross-modelgeneration">跨模型生成</h3>      <p id="85579ace">         <b id="c818a1ab">模型</b>是MPS中的生成单位。单个模型中的所有实体都是一起生成的，节点之间的引用可以使用<b id="80a39a1d">引用宏</b>和<b id="7f8846e1">映射标签</b>来解析。但是，默认情况下无法从其他模型访问映射标签。这使引用来自其他模型的节点的引用的生成变得复杂。幸运的是，如果模型共享一个<b id="5e52f65c">生成计划</b> ，则常规<b id="8c05c327">映射标签</b>可以支持具有交叉引用的相互独立的模型<b id="5e52f65c">生成</b> 。该机制利用检查点来捕获中间瞬态模型，然后将它们用于参考分辨率。</p>      <p id="1424b6fb">本质上，要在生成多个模型时保留跨模型引用，请确保您的模型共享一个<b id="4ec3768f">生成计划</b> 。当用于交叉模型参考解析的<b id="ca3e681d">映射标签</b>已填充时，该<b id="ca5757bf">生成计划</b>必须立即定义检查点。其余的将自动处理。参考宏可以<i id="f89c60c2">通过标签和输入</i>的常规<i id="f89c60c2">genContext.get输出</i> （对于通过缩减或根映射规则生成的节点）或<i id="fbfb5fb7">模型的genContext.get输出</i> （对于通过条件根映射规则生成的节点）来通过<b id="41cb5f8a">映射标签</b>解析<b id="41cb5f8a">映射标签</b>中的节点。</p>      <h3 id="linkingcheckpointmodels">链接检查点模型</h3>      <p id="5c10a772">现在，在检查点创建的模型将保留对序列中先前检查点模型的引用。这有助于生成器发现与跨越多个生成器阶段的输入匹配的映射节点。</p>      <h3 id="debuginformationinthecheckpointmodels">检查点模型中的调试信息</h3>      <p id="e315f7c7">为了简化跨模型生成方案的调试，每个<b id="ff7e8909">检查点模型</b>内部的专用根目录列出了映射标签名称以及指向存储的输入和输出节点的指针。对每个检查点处公开的映射标签进行调查，可以从实质上帮助调试跨模型生成方案并修复未解决的引用。因此，下次您的跨模型引用无法解析时，请检查相应的检查点模型以查看是否确实存在用于输入的标签。</p>      <p id="8127a932">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/checkpoints1.png"><img alt="检查点1" title="检查点1" src="/help/img/idea/2019.2/checkpoints1.png" id="73b146ad" width="300" height="362"></a></figure>      <p></p>      <aside class="tip sideblock" rel="8127a932" id="9ce68160" data-title="">         <p id="80e82b85">提供了有关为解决方案和DevKit设置生成计划的<a href="https://youtu.be/ktTzOg297ZQ" rel="noopener noreferrer" data-external="true" target="_blank">视频</a> 。</p>      </aside>      <h2 id="generatinglanguagedescriptormodels">生成语言描述符模型</h2>生成计划已得到增强，可以生成语言的描述符模型（称为<code class="code"><language.name>@descriptor</code> ）。现在，通过生成计划生成了结构，文本生成，类型系统，数据流和约束方面，并且它们使用了新的跨模型参考解析机制。语言作者定义的自定义方面也可以加入生成计划。如果您有自定义方面，则应确保其生成器扩展了<code class="code">jetbrains.mps.lang.descriptor</code>语言，因为这是为计划激活自定义扩展的方法。<p id="38bc3885"> </p>      <p id="346b2323">         <br>      </p>   <div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月30日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="mapping-priorities.html">映射优先级</a> <a class="navigation-links__next" href="generator-demos.html">生成器演示</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>