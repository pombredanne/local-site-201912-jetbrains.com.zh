<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Editor - Help | MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Editor.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Default</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_jbuilder">JBuilder</option><option data-group="primary" value="primary_mac_os_x">Mac OS X</option><option data-group="primary" value="primary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default">Default</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_jbuilder">JBuilder</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Editor.html" id="editor.xml">Editor</h1>   <p id="5636f37d">      <br> Once the structure for your language is defined, you will probably go and create the means to allow developers to conveniently build ASTs with it. Manipulating the ASTs directly would not be very intuitive nor productive. To hide the AST and offer the user comfortable and intuitive interaction is the role for language editors.</p>   <aside class="tip sideblock" data-title="" rel="5636f37d" id="d7048e79">      <p id="2afa6999">There are sometimes situations when manipulating the AST directly is necessary. For example, when the available editor definition does not give you access to all the properties of a node. The <b id="6cc521d9">reflective editor</b> gives you the power to cease the editor for a selected node and instead access the AST directly. Hit <b id="6676c548">F5</b> to revert back to the default editor.</p>      <p id="3214b2b7">         <figure><a class="lightbox" href="/help/img/idea/2019.2/ReflectiveEditorFix1.png"><img alt="ReflectiveEditorFix1" title="ReflectiveEditorFix1" src="/help/img/idea/2019.2/ReflectiveEditorFix1.png" id="ddfdfbc3" width="300" height="1930"></a></figure>      </p>   </aside>   <h2 id="editoroverview">Editor Overview</h2>   <p id="60f79bf0">An editor for a node serves as its view as well as its controller. An editor displays the node and lets the user modify, replace, delete it and so on. Nodes of different concepts have different editors. A language designer should create an editor for every concept in his/her language.</p>   <p id="36cb006d">In MPS, an editor consists of cells, which themselves contain other cells, some text, or a UI component. Each editor has its concept for which it is specified. A concept may have no more than one editor declaration (or can have none). If a concept does not have an editor declaration, its instances will be edited with an editor for the concept's nearest ancestor that has an editor declaration.</p>   <p id="0a255a11">To describe an editor for a certain concept (i.e. which cells have to appear in an editor for nodes of this concept), a language designer will use a dedicated language simply called <i id="a0d9222b">editor language</i>. You see, MPS applies the <i id="284c9ff8">Language Oriented Programming</i> principles to itself.</p>   <p id="529204c5">The description of an editor consists of descriptions for cells it holds. We call such descriptions "cell models." For instance, if you want your editor to consist of a unique cell with unmodifiable text, you create in your editor description a constant cell model and specify that text. If you want your editor to consist of several cells, you create a collection cell model and then, inside it, you specify cell models for its elements. And so on.</p>   <aside class="tip sideblock" data-title="" rel="529204c5" id="a5679bac">      <p id="d4c94493">For a quick how-to document on the MPS editor please check out the <a href="editor-cookbook.html">Editor Cookbook</a>.</p>   </aside>      <h2 id="typesofcellmodels">Types Of Cell Models</h2>   <div class="table-wrapper"><table width="100%" id="d8cb0a4f"><thead><tr id="704778ee" class="ijRowHead"><th id="1272cbe1">            <h4 id="constant&nbsp;cell">ConstantÂ cell</h4>         </th><th id="d005a388">            <p id="947e5dca">               <img alt="ConstantCell" title="ConstantCell" src="/help/img/idea/2019.2/ConstantCell.png" id="7d61f3c6" width="79" height="18" class="inline-icon-79"> This model describes a cell which will always contain the same text. Constant cells typically mirror "keywords" in text-based progamming languages.</p>         </th></tr></thead><tbody><tr id="81ae6191" class="ijRowOdd"><td id="97e5e6cc">            <h4 id="collectioncell">Collection cell</h4>         </td><td id="45edf214">            <p id="59c1567b">A cell which contains other cells. Can be horizontal <img alt="HorizontalCollection" title="HorizontalCollection" src="/help/img/idea/2019.2/HorizontalCollection.png" id="9c037ae7" width="106" height="18" class="inline-icon-106"> (cells in a collection are arranged in a row), vertical <figure><img alt="VerticalCollection" title="VerticalCollection" src="/help/img/idea/2019.2/VerticalCollection.png" id="636c30f1" width="86" height="48"></figure> (cells are on top of each other) or have so-called "indent layout" <img alt="IndentCollection" title="IndentCollection" src="/help/img/idea/2019.2/IndentCollection.png" id="496fef60" width="112" height="18" class="inline-icon-112"> (cells are arranged horizontally but if a line is too long it is wrapped like text to the next line, with indent before each next line).<br>In Inspector, you can specify whether the resulting cell collection will use folding or not, and whether it will use braces or not. Folding allows your cell list to contract into a single cell (fold) and to expand from it (unfold) when necessary. It is useful for a programmer writing in your language when editing a large root: he/she is able to fold some cells and hide all the information that is not necessary for the current task. For instance, when editing a large class, one can fold all method bodies except the method he/she is editing at the moment.&nbsp;<br>The <b id="5b68d509">collapse by default</b> property when set to true will ensure, that the collection shows up folded when displayed for the first time, unless the user unfolds it manually.</p>            <p id="d37291a7">Collection cells can also specify a <b id="9abffc6c">Context assistant</b>, which will provide intuitive visual actions to the user. Check out the <a href="context-assistant.html">Context assistant documentation</a> for details.&nbsp;</p>         </td></tr><tr id="10a0084d" class="ijRowEven"><td id="69178f7c">            <h4 id="propertycell">Property cell</h4>         </td><td id="2ba29012">            <p id="9709a28e">               <img alt="PropertyCell" title="PropertyCell" src="/help/img/idea/2019.2/PropertyCell.png" id="8a062457" width="91" height="18" class="inline-icon-91"> This cell model describes a cell which will show a value of a certain property of a node. The value of a property can be edited in a property cell, therefore, a property cell serves not only as a view also but as a controller. In an inspector, you can specify whether the property cell will be read-only or will allow its property value to be edited.</p>         </td></tr><tr id="df3f9827" class="ijRowOdd"><td id="0a234e73">            <h4 id="childcell">Child cell</h4>         </td><td id="b72c127b">            <p id="d9363d06">               <img alt="ChildCell" title="ChildCell" src="/help/img/idea/2019.2/ChildCell.png" id="8ecfd4c3" width="70" height="18" class="inline-icon-70"> This cell model contains a reference to a certain link declaration in a node's concept. The resulting cell will contain an editor for the link's target (almost always for the child, not the referent). For example if you have a binary operation, say " + ", with two children, "leftOperand" and "rightOperand", an editor model for your operation will be the following: a indent collection cell containing a referenced node cell for the left operand, a constant cell with " + ", and a referenced node cell for the right operand. It will be rendered as an editor for the right operand, then a cell with " + ", and then an editor for the left operand, arranged in a row. As we have seen, and as follows from its name, this type of cell model is typically used to show editors for children.</p>         </td></tr><tr id="6a0843db" class="ijRowEven"><td id="048f159b">            <h4 id="referentcell">Referent cell</h4>         </td><td id="aaff258c">            <p id="20918e95">               <img alt="ReferenceCell" title="ReferenceCell" src="/help/img/idea/2019.2/ReferenceCell.png" id="3ceefb92" width="204" height="18" class="inline-icon-204"> Used mainly to show reference targets. The main difference between a referent cell and a child cell is that we don't need, or don't want, to show the whole editor for a reference target. For example, when a certain node, say, a class type, has a reference to a java class, we don't want to show the whole editor for that class with its methods, fields, and so on; we just want to show its name. Therefore child cells cannot be used for such a purpose. One should use referent cells. <br> Referent cell allows you to show a different inlined editor for a reference target, instead of using target's own editor. In most cases it's very simple: a cell for a reference target usually consists only of a property cell with the target's name.</p>         </td></tr><tr id="8c3170a1" class="ijRowOdd"><td id="5a35b910">            <h4 id="childlistcell">Child list cell</h4>         </td><td id="c6ae9c6b">            <p id="75833941">               <img alt="ChildListCell" title="ChildListCell" src="/help/img/idea/2019.2/ChildListCell.png" id="26690f8f" width="269" height="18" class="inline-icon-269"> This cell is a collection containing multiple child cells for a node's children of the same role. For instance, an editor for a method call will contain a child list cell for rendering its actual arguments. Child list can be indent (text like), horizontal or vertical. <br>The cell generated from this cell model supports insertion and deletion of the children of the role given, thus serving both as a view and as a controller. The default keys for insertion are Insert and Enter (to insert a child before or after the selected one, respectively), and the default key for deletion is Delete. You also can specify a separator for your list. <br>A separator is a character which will be shown in constant cells between cells for the children. When you are inside the cell list and you press a key with this character, a new child will be inserted after the selected child. For instance, a separator for a list representing actual parameters in a method call is a comma. <br>In Inspector, you can specify whether the resulting cell list will use folding or not, and whether it will use braces or not. Folding allows your cell list to contract into a single cell (fold) and to expand from it (unfold) when necessary. It is useful for a programmer writing in your language when editing a large root: he/she is able to fold some cells and hide all the information in editor that is not necessary for the current task at the moment. For instance, when editing a large class, one can fold all method bodies except the method he/she is editing at the moment.</p>         </td></tr><tr id="fdc2398f" class="ijRowEven"><td id="633c0daf">            <h4 id="indentcell">Indent cell</h4>         </td><td id="23400c8b">            <p id="ca3adb77">               <img alt="IndentCell" title="IndentCell" src="/help/img/idea/2019.2/IndentCell.png" id="f53e6403" width="31" height="18" class="inline-icon-31"> An indent cell model will be generated into a non-selectable constant cell containing a whitespace. The main difference between a cell generated from an indent cell and one generated from a constant cell model containing whitespaces as its text is that the width of an indent cell will vary according to user-defined global editor settings. For instance, if a user defines an indent to be 4 spaces long, then every indent cell will occupy a space of 4 characters; if 2 spaces long, then every indent cell will be 2 characters.</p>         </td></tr><tr id="b26709d1" class="ijRowOdd"><td id="c1ad7f77">            <h4 id="uicomponentcell">UI component cell</h4>         </td><td id="1cae70e9">            <p id="1e057a59">               <img alt="ComponentCell" title="ComponentCell" src="/help/img/idea/2019.2/ComponentCell.png" id="585ae9b0" width="140" height="18" class="inline-icon-140"> This cell model allows a language designer to insert an arbitrary UI component inside an editor for a node. A language designer should write a function that returns a JComponent, and that component will be inserted into the generated cell. Note that such a component will be re-created every time an editor is rebuilt, so don't try to keep any state inside your component. Every state should be taken from and written into a model (i.e. node, its properties and references) - not a view (your component). <br> A good use case for such a cell model is when you keep a path to some file in a property, and your component is a button which activates a modal file chooser. The default selected path in a file chooser is read from the above-mentioned property, and the file path chosen by the user is written to that property.</p>         </td></tr><tr id="31dfa5ae" class="ijRowEven"><td id="c55bc7d1">            <h4 id="modelaccess">Model access</h4>         </td><td id="ca53dcd8">            <p id="12c47472">               <img alt="ModelAcces" title="ModelAcces" src="/help/img/idea/2019.2/ModelAcces.png" id="0c6f0ae7" width="119" height="18" class="inline-icon-119"> A model access cell model is a generalization of a property cell and, therefore, is more flexible. While a property cell simply shows the value of a property and allows the user to change that value, a model access cell may show an arbitrary text based on the node's state and modify the node in an arbitrary way based on what changes the user has made to the cell's text. <br> While making a property cell work requires you only to specify a property to access via that cell, making a model access cell work requires a language designer to write three methods: "get," "set," and "validate." The latter two are somewhat optional. <br> A "get" method takes a node and should return a String, which will be shown as the cell's text. A "set" method takes a String - the cell's text - and should modify a node according to this String, if necessary. A "validate" method takes the cell's text and returns whether it is valid or not. If a text in a cell becomes invalid after a user change, then it is marked red and is not passed to the "set" method. <br> If a "validate" method is not specified, a cell will always be valid. If a "set" method is not specified, no changes in a cell's text will affect its node itself.</p>         </td></tr><tr id="a7024178" class="ijRowOdd"><td id="82282b49">            <h4 id="nextapplicableeditor">Next applicable editor</h4>         </td><td id="d63ea9e3">            <p id="155321a8">A more specific editor may reuse a less specific editor of the same concept through the new <b id="33efbdb3">next applicable editor</b> editor cell. The <b id="fbebf046">next applicable editor</b> cell is used as a place holder, which will re-apply the logic for finding the less specific editor and insert the found editor in its place. For example, an editor specific to a particular <b id="ca64f0a1">context hint</b> may provide some visual ceremony around a <b id="21872135">next applicable editor</b> cell. By removing the <b id="48ec4d52">context hint</b> on the <b id="c070bf3d">next applicable editor</b> cell, MPS will reevaluate the editor-discovery logic and supply the found editor into the <b id="32c78a86">next applicable editor</b> cell.</p>            <p id="fa02367a">               <figure><a class="lightbox" href="/help/img/idea/2019.2/next1.png"><img alt="next1" title="next1" src="/help/img/idea/2019.2/next1.png" id="9eff4ac8" width="100" height="576"></a></figure>               <br>In particular this mechanism is frequently being used to implement editors for "commented out" nodes when customizing the generic <b id="538a87f9">comment out</b> functionality.</p>         </td></tr><tr id="bcae6fb2" class="ijRowEven"><td id="20a6b90a">            <h4 id="customcell">Custom cell</h4>         </td><td id="9ee05b08">            <p id="7f3f0bdc">               <img alt="CustomCell" title="CustomCell" src="/help/img/idea/2019.2/CustomCell.png" id="13cbd1c7" width="112" height="18" class="inline-icon-112"> If other cell models are not enough for a language designer to create the editor he/she wants, there's one more option left for him/her: to create a cell provider which will return an arbitrary custom cell. The only restriction is that it should implement an "EditorCell" interface.</p>         </td></tr></tbody></table></div>      <h3 id="editorcomponentsandeditorcomponentcells">Editor Components and editor component cells</h3>   <p id="98515917">Sometimes two or more editor declarations for different concepts have a common part, which is duplicated in each of those editors. To avoid redundancy, there's a mechanism called editor components. You specify a concept for which an editor component is created and create a cell model, just as in concept editor declaration. When written, the component could then be used in editor declarations for any of the specified concept's descendants. To use an editor component inside your editor declarations, one will create a specific cell model: editor component cell model, and set your editor component declaration as the target of this cell model's reference.</p>      <h2 id="celllayouts">Cell layouts</h2>   <p id="41ad475d">Each collection cell has property "cell layout", which describes how child nodes will be placed. There is several layouts:</p>   <ul class="list _ul"><li class="list__item" id="023e4fc0"><p>indent layout - places cells like text.</p></li><li class="list__item" id="e8eb1dfc"><p>horizontal layout - places cells horizontally in row.</p></li><li class="list__item" id="3327c587"><p>vertical layout - places cells vertically.</p></li></ul>   <p id="e539f780">The&nbsp;<b id="024b3250">indent layout</b> cell offers several properties to customize the layout, some are applicable to the layout cell itself, some to the cells inside the layout cell:</p>   <ul class="list _ul"><li class="list__item" id="7fe5ec03"><p>indent-layout-indent - this cell will have an&nbsp;<i id="632c0940">indent</i> prepended, if displayed as first on a line</p></li><li class="list__item" id="6abfa31a"><p>indent-layout-new-line - this cell will be the last on a line</p></li><li class="list__item" id="23ec3e72"><p>indent-layout-on-new-line - this cell will be first on the next line</p></li><li class="list__item" id="c20ba920"><p>indent-layout-new-line-children - all children cells of this collection cell will be displayed on separate lines</p></li><li class="list__item" id="c625b9ef"><p>indent-layout-wrap-anchor - when the children cells of this collection cell exceed the width of the screen, they will be wrapped to vertically align with this collection</p></li><li class="list__item" id="4ef100b2"><p>indent-layout-indent-anchor - all subsequent indents will be calculated relative to the indentation of the current collection cell</p></li><li class="list__item" id="9dd3f802"><p>indent-layout-no-wrap - The cell must never be wrapped so that it ends up first on a new line</p></li></ul>      <h2 id="styles">Styles</h2>   <p id="b690b10f">Styling the editor cells gives language designers a very powerful way to improve readability of the code. Having keywords, constants, calls, definitions, expressions, comments and other language elements displayed each in different colors or fonts helps developers grasp the syntax more easily. You can also use styling to mask areas of the editor as read-only, so that developers cannot edit them.</p>   <p id="6913983b">Each cell model has some appearance settings that determine the cell's presentation. They are, for instance, <i id="5e24388e">font color</i>, <i id="e5db965f">font style</i>, whether a cell is <i id="4defda9e">selectable</i>, and some others. Those settings are combined into an entity called <i id="6ba9b471">stylesheet</i>. A <b id="3aff304f">stylesheet</b> could be either <b id="a5148f8f">inline</b>, i.e. be described together with a particular cell model, or it could be <b id="e2405736">declared separately</b> and used in many cell models. Both <b id="8f211489">inline stylesheet</b>&nbsp;and <b id="ffc694de">style reference</b>&nbsp;are specified for each cell in its <i id="d15496bd">Inspector View</i>.</p>   <p id="2eb52706">      <figure><img alt="style2" title="style2" src="/help/img/idea/2019.2/style2.png" id="84d9cef6" width="404" height="287"></figure>   </p>   <p id="1048a1a0">      <figure><img alt="style1" title="style1" src="/help/img/idea/2019.2/style1.png" id="f1354487" width="394" height="250"></figure>   </p>   <p id="08ed6f9b">The settings do not have to be specified by a single value. A&nbsp;<b id="e27b3d21">query</b> option is also available for all settings, in which case a concept function needs to be implemented by the developer, which returns the desired value:</p>   <p id="5fcc8d17">      <figure><a class="lightbox" href="/help/img/idea/2019.2/image2017-10-19-18-2-53.png"><img alt="image2017 10 19 18 2 53" title="image2017 10 19 18 2 53" src="/help/img/idea/2019.2/image2017-10-19-18-2-53.png" id="12a4f7fd" width="500" height="260"></a></figure>   </p>   <p id="0465f085">It is a good practice to declare a few stylesheets for different purposes. Another good practice is to have a style guideline in mind when developing an editor for your language, as well as when developing extensions for your language. For example, in <i id="02d46798">BaseLanguage</i> there are styles for keywords (applied to those constant cells in the <i id="f09fb77e">BaseLanguage</i> editor, which correspond to keywords in Java), static fields (applied to static field declarations and static field references), instance fields, numeric literals, string literals, and so forth. When developing an extension to <i id="577e9b46">BaseLanguage</i>, you should apply keyword style to new keywords, field style to new types of fields, and so forth.</p>   <p id="2c34938c">A <b id="9bbe95bd">stylesheet</b> is quite similar to CSS stylesheets; it consists of a list of style classes, in which the values for some style properties are specified.&nbsp;MPS additionally provides a mechanism for extending styles as well as for property value overriding.</p>      <h2 id="styleproperties">Style properties</h2>      <h3 id="booleanstyleproperties">Boolean style properties</h3>   <ul class="list _ul"><li class="list__item" id="3d9b44f4"><p>         <i id="e9f4b086">selectable</i> - whether the cell can be selected. True by default.</p></li><li class="list__item" id="c0504aff"><p>         <i id="f802d707">read-only</i> -&nbsp;whether one can modify the cell and the nested cells or not. <i id="0ecdbf81">False</i> by default. Designed for freezing fragments of cell tree.</p></li><li class="list__item" id="ed19e668"><p>         <i id="781a2c40">editable</i> - whether one can modify text in a cell or not. By default is <i id="0521242f">false</i> for constant cell models, true for other cell models.</p></li><li class="list__item" id="5f44bee8"><p>         <i id="31c03b87">draw-border</i> - whether border will be drawn around a cell</p></li><li class="list__item" id="0101a31a"><p>         <i id="becb8b76">draw-brackets</i> - whether brackets will be drawn around a cell</p></li><li class="list__item" id="9ff9ce5d"><p>         <i id="4d0cab7d">first-position-allowed</i> /&nbsp;<i id="5938f57e">last-position-allowed</i> - for text-containing cells, specifies whether it is allowed that a caret is on the first/last position (i.e. before/after the whole text of a cell)</p></li></ul>   <p id="acde7a1c">You can either choose a property value from a completion menu or specify a query i.e. a function which returns a boolean value.</p>   <p id="292070ff">      <figure><img alt="Style3" title="Style3" src="/help/img/idea/2019.2/Style3.png" id="5348a60b" width="624" height="167"></figure>   </p>      <h3 id="paddingproperties.">Padding properties.</h3>   <ul class="list _ul"><li class="list__item" id="5d5d8050"><p>         <i id="ce4a81e4">padding-left/right/top/bottom</i>&nbsp;- a floating point number, which specifies the padding of a text cell, i.e. how much space will be between cell's text and cell's left and right sides, respectively.</p></li></ul>      <h3 id="punctuationproperties.">Punctuation properties.</h3>   <p id="3f3bdf70">All cells in a collection are separated with one space by default. Sometimes we need cells placed together.</p>   <ul class="list _ul"><li class="list__item" id="4bc23e7b"><p>         <i id="0e00144c">punctuation-left</i> - if this property is true, space from left side of the cell is deleted and first position in cell becomes not allowed.</p></li><li class="list__item" id="f3b906ff"><p>         <i id="8c77ba35">punctuation-right</i> - if this property is true, space from right side of the cell is deleted and last position in cell becomes not allowed.</p></li><li class="list__item" id="01cb421e"><p>         <i id="252621f3">horizontal-gap</i> - specifies gap size between cells in collection. Default value is 1 space.</p></li></ul>   <p id="353ff532">For example in code</p>   <div class="code-block" data-lang="none">(1 + 1)
</div>   <p id="15652b6f">we don't want spaces between "(" and "1", and between "1" and ")". So we should add property punctuation-right to the cell "(", and property<br> punctuation-left to the cell ")".</p>      <h3 id="colorstyleproperties">Color style properties</h3>   <ul class="list _ul"><li class="list__item" id="53e90712"><p>Text foreground color - cell text's color (affect text cells only)</p></li><li class="list__item" id="4cc519ce"><p>Text background color - cell text's background color (affects text cells only)</p></li><li class="list__item" id="c73b95e9"><p>Background color - the background color of a cell. Affects any cell. If a text cell has non-zero padding and some text background color, the cell's background color will be the color of its margins.<br> You can either choose a color from the completion menu or specify a query i.e. a function which returns a color.</p></li></ul>      <h3 id="indentlayoutproperties">Indent layout properties</h3>   <ul class="list _ul"><li class="list__item" id="6c2a04f4"><p>         <i id="e48d4184">indent-layout-indent</i>&nbsp;- all lines will be placed with indent. This property can be used for indent in code block.</p></li></ul>   <p id="ee0a912b">      <figure><img alt="BlockStatementEditor" title="BlockStatementEditor" src="/help/img/idea/2019.2/BlockStatementEditor.PNG" id="03fbedea" width="630" height="358"></figure>   </p>   <ul class="list _ul"><li class="list__item" id="8429b8a3"><p>         <i id="963522ee">indent-layout-new-line</i> - after this cell there will be a new line marker.</p></li></ul>   <p id="a9b55821">      <figure><img alt="SwitchCaseEditor" title="SwitchCaseEditor" src="/help/img/idea/2019.2/SwitchCaseEditor.PNG" id="1c95640d" width="337" height="326"></figure>   </p>   <ul class="list _ul"><li class="list__item" id="aaf75cbc"><p>         <i id="046c9288">indent-layout-on-new-line</i> - this cell will be placed on a new line</p></li></ul>   <ul class="list _ul"><li class="list__item" id="477f71b4"><p>         <i id="a906b535">indent-layout-new-line-children</i>&nbsp;- all children of collection will be placed on new line</p></li></ul>   <p id="3974eccc">      <figure><img alt="StatementListEditor" title="StatementListEditor" src="/help/img/idea/2019.2/StatementListEditor.PNG" id="76cc8bb5" width="706" height="324"></figure>   </p>   <ul class="list _ul"><li class="list__item" id="23950577"><p>         <i id="220cf387">indent-layout-no-wrap</i> - the line won't be wrapped before this cell</p></li></ul>      <h3 id="otherstyleproperties">Other style properties</h3>   <ul class="list _ul"><li class="list__item" id="e0fbc701">         <i id="0289752a">font family</i>      </li><li class="list__item" id="58243302">         <i id="05338391">font size</i>      </li><li class="list__item" id="f7aa789d"><p>         <i id="fc7f8f7c">font style&nbsp;</i>- can be either plain, bold, italic, or bold italic.</p></li><li class="list__item" id="b7f9b455">         <i id="e7aa346a">layout constraint</i> -&nbsp;<ul class="list _ul"><li class="list__item" id="5275de34">For flow layout<ul class="list _ul"><li class="list__item" id="54b7b1b2"><p>none - default behavior</p></li><li class="list__item" id="9bb9c117"><p>punctation - means that previous item in flow layout should always be placed on the same line as the item, which this constraint is assigned to.</p></li><li class="list__item" id="03ebfec7"><p>noflow - excludes a cell from flow layout. Current line is finished and item is placed below it. After this item a new line is started and normal flow layout is applied. This style can be used to embed a picture inside of text.</p></li></ul>            </li></ul>      </li><li class="list__item" id="68707ac3"><p>         <i id="f1a56c6f">underlined</i> - Can be either underlined, not underlined, or as is ('as is' means it depends on properties of the enclosing cell collection).</p></li></ul>      <h3 id="stylepropertiespropagation">Style properties propagation</h3>   <p id="0a018fe5">While some style properties affect only the cell to which they are applied, values of other properties are pushed down the cell subtree (nested cells) and applied to them until some of the child cells specifies its own value for the property. Such inheritable properties that are pushed down the cell hierarchy include <i id="90296b89">text-foreground-color</i>, <i id="8f23d3df">text-background-color</i>, <i id="ee3e39e2">background-color</i>, <i id="c1e04cfe">font-style</i>, <i id="e2283483">font-size</i>&nbsp;and many others.</p>   <h3 id="customstyles">Custom styles</h3>   <p id="186ad649">Language designers can define their own style attributes in Style Sheets and then use them in the editor. This increases the flexibility of the language editor definition. The attributes may hold values of different types and can optionally provide default values.</p>   <p id="6c26485a">      <figure><img alt="styles500" title="styles500" src="/help/img/idea/2019.2/styles500.png" id="ea7c55bc" width="292" height="123"></figure>   </p>   <p id="91a856a6">There are two types of custom style attributes:</p>   <ul class="list _ul"><li class="list__item" id="5aa50e46"><p>simple - applied to a single editor cell only</p></li><li class="list__item" id="00ed9f1d"><p>inherited - applied to a cell and all its descendant cells recursively</p></li></ul>   <p id="3e0d26c5">In order to use the style attribute in an editor definition, your language has to import the language defining the attribute and the <i id="ef303dcc">editor</i>&nbsp;aspect has to list the defining language among the used languages.<br> To refer to the custom attribute from within <i id="f676a135">BaseLanguage</i>&nbsp;code, you need to import <i id="50293bef">jetbrains.mps.lang.editor</i> to get access to the <i id="813020f4">StyleAttributeReferenceExpression</i> concept.</p>   <div class="code-block" data-lang="none">EditorCell cell = ...
cell.getStyle().get(styleAttribute/myValue/);
</div>   <h3 id="styleinheritance">Style inheritance</h3>   <p id="151702a6">To be truly usable, style classes need an extension mechanism in order to describe that a particular style class inherits values of all style properties, which are not overridden explicitly. We can use a special style property <i id="ac05d070">apply</i> to copy values of all properties specified in the parent style class into our style class. Using the&nbsp;<i id="77c7d54f">apply</i> property is semantically equivalent to copy-pasting all of the properties from the parent style class. An&nbsp;<i id="a1893f6a">apply-if</i>&nbsp;variant is also available to apply a style property value conditionally. Unlike traditional style-extension, the apply mechanism allows multiple classes to be inherited from.</p>   <p id="d144e034">The <i id="486b7454">unapply</i>&nbsp;property allows style classes to cease the effect of selected inherited properties. For example, a style class for commented-out code will push down styles that make code elements look all gray. Yet, links may need to be rendered in their usual colors so that the user can spot them and potentially click on them.</p>   <p id="fcdc30a9">Potential conflicts between properties specified in parent styles and/or the ones defined explicitly in the inheriting cell are resolved on the order basis.The&nbsp;last specified value overrides all previous values of the same style property.</p>   <p id="6d1c4745">For example, the <i id="a461210b">ConsoleRoot</i>&nbsp;concept provides a read-only editor with only a single point (the <i id="21ae5907">commandHolder</i>&nbsp;cell), where edits are allowed. First the <i id="35215dd4">readOnly</i>&nbsp;style class is set on the editor:</p>   <p id="4b83bd5b">      <figure><img alt="style4" title="style4" src="/help/img/idea/2019.2/style4.png" id="65d7ea36" width="506" height="297"></figure>   </p>   <p id="9b92ee0f">and then the <i id="108aff1c">readOnly</i>&nbsp;style class is unapplied for the <i id="a7ed8412">commandHolder</i>&nbsp;cell:</p>   <p id="a65901d7">      <figure><img alt="style5" title="style5" src="/help/img/idea/2019.2/style5.png" id="2df21545" width="507" height="297"></figure>   </p>   <p id="35df4f5e">The <i id="fd733fc1">readOnly</i>&nbsp;style class is defined as follows:</p>   <p id="491034b6">      <figure><img alt="style30" title="style30" src="/help/img/idea/2019.2/style30.png" id="7d721e2b" width="339" height="105"></figure>   </p>   <h3 id="stylepriorities">Style priorities</h3>   <p id="4416dfc7">A style class can be declared to take precedence over some other style class or multiple classes.</p>   <ol class="list _decimal"><li class="list__item" id="34354b1d"><p>If a style class does not dominate over anything, it is a <b id="70ca5500">low-level style class</b>.&nbsp;</p></li><li class="list__item" id="53c357ca"><p>If a style class declares to dominate, but does not specifies a style class that it <i id="abf18d79">dominates</i> over (no style class is specifies but words <i id="78255a39">dominate over</i>&nbsp;present), the style class is considered dominating over all low-level style classes.</p></li><li class="list__item" id="fa3ba68a"><p>The <i id="2ec00c4e">domination relation</i> is <b id="fedcd347">transitive</b>, <b id="70897b75">cycles</b> are not allowed.</p></li></ol>   <p id="2a596138">The domination relation makes sense only for styles with inheritable attributes. When one value of some style property is pushed down from parent and another value for the same property is specified in the style class applied to the current cell, the resulting behavior depends on the relationship between the two style classes:</p>   <ol class="list _decimal"><li class="list__item" id="29723bba"><p>If both style classes are <b id="1e4fce33">low-level</b>, the value pushed from parent will be ignored and replaced with value from style class of current cell.</p></li><li class="list__item" id="32978591"><p>If one of style classes dominates over the other, both values are&nbsp;kept&nbsp;and pushed down, but values from the style class, which dominates, hides the values from the other style class.</p></li><li class="list__item" id="222be9cf"><p>If, however, in some child cell the style class that dominates is unapplied (with special style property <i id="9f26a887">unapply</i>), values from the other style class will become resulting values for this property.</p></li></ol>   <p id="de9dbbf1">For example, a comment containing the word TODO should be styled more prominently then a plain comment. Thus the language concept representing a comment needs to apply a TODO-aware style (<i id="3d1db72d">TODO_Style</i>), which declares its dominance over a plain&nbsp;<i id="1975408a">Comment_Style</i>. The actual styling properties are, however, only applied if the comment really contains the TODO text (isToDo()), otherwise the plain&nbsp;<i id="5e9390a8">Comment_Style</i>&nbsp;properties are used.</p>   <p id="d34c488b">      <figure><img alt="style7" title="style7" src="/help/img/idea/2019.2/style7.png" id="f48465e9" width="893" height="83"></figure>   </p>   <p id="33bc3d40">Use the <i id="12242a27">"Add Dominance"</i>&nbsp;intention to append the <i id="1885c3b9">dominates over</i>&nbsp;clause to a style:</p>   <p id="84d48716">      <figure><img alt="style31" title="style31" src="/help/img/idea/2019.2/style31.png" id="bed6c5a0" width="244" height="103"></figure>   </p>   <h2 id="cellactions">Cell actions</h2>   <p id="bc078d33">Every cell model may have some actions associated with it. Such actions are meant to improve usability of editing. You can specify them in an inspector of any cell model.</p>      <h3 id="keymaps">Key maps</h3>   <p id="804cfaa7">You may specify a reference to a key map for your cell model. A key map is a root concept - a set of key map items each consisting of a keystroke and an action to perform. A cell generated from a cell model with a reference to a certain key map will execute appropriate actions on keystrokes.</p>   <p id="f40ca505">In a key map you must specify a concept for which a key map is applicable. For instance, if you want to do some actions with an expression, you must specify Expression as an applicable concept; then you may specify such a key map only for those cell models which are contained inside editor declarations for descendants of Expression, otherwise it is a type error.</p>   <p id="0370381d">If a key map property "everyModel" is "true," then this key map behaves as if it is specified for every cell in the editor. It is useful when you have many descendants of a certain concept which have many different editors, and your key map is applicable to their ancestor. You need not specify such a key map in every editor if you mark it as an "every model" key map.</p>   <p id="740c1d88">A key map item consists of the following features:</p>   <ul class="list _ul"><li class="list__item" id="04aecb7d"><p>A function which is executed when a key map item is triggered (returns nothing)</p></li><li class="list__item" id="a44f9afc"><p>A set of keystrokes which trigger this key map item</p></li><li class="list__item" id="3958e9b5"><p>A boolean function which determines if a key map item is applicable here (if not specified, then it's always applicable). If a key map item is not applicable the moment it is triggered, then it will not perform an action.</p></li><li class="list__item" id="a9ecbeb3"><p>You may specify caret policy for a key map item. Caret policy says where in a cell a caret should be located to make this key map item enabled. Caret policy may be either first position, last position, intermediate position, or any position. By default, caret policy is "any position." If a caret in a cell does not match the caret policy of a key map item the moment it is triggered, then this key map item will not perform an action.</p></li></ul>      <h3 id="actionmaps">Action maps</h3>   <p id="ddf28c87">A cell model may contain a reference to an action map. An action map overrides some default cell actions for a certain concept. An action map consists of several action map items. In an action map, you must specify a concept for which the action map is applicable.</p>   <p id="1d534153">An action map item contains:</p>   <ul class="list _ul"><li class="list__item" id="ffb95d8d"><p>an action description which is a string,</p></li><li class="list__item" id="b0e7aef6"><p>and a function which performs an action (returns nothing).</p></li></ul>   <p id="d07f9139">An action map item may override one of the default actions (see Actions). For instance, when you have a return statement without any action maps in its editor, and you press Delete on a cell with the keyword "return," the whole statement is deleted. But you may specify an action map containing a delete action map item, which instead of just deleting return statement replaces it with an expression statement containing the same expression as the deleted return statement.</p>action DELETE description: &lt;no description&gt;    execute: (node, editorContext)-&gt;void {        node &lt; ExpressionStatement &gt; expressionStatement = node. replace with new ( ExpressionStatement );        expressionStatement. expression. set ( node. expression );    }<p id="c23d1fa1">The SELECT_ALL action, which selects the whole contents of the editor and is triggered by&nbsp;<i id="d2dd7034">Control/Cmd + A</i>, can also be customised through <b id="012613e3">action maps</b>. The&nbsp;<code class="code">jetbrains.mps.nodeEditor.selection.SelectUpUtil</code>&nbsp;class with&nbsp;<code class="code">executeWhile</code>&nbsp;method can be leveraged to specify an upper selection boundary for this action.</p>   <p id="5dddbab2">      <figure><a class="lightbox" href="/help/img/idea/2019.2/mps-selectall.png"><img alt="mps selectall" title="mps selectall" src="/help/img/idea/2019.2/mps-selectall.png" id="d070e29b" width="500" height="518"></a></figure>   </p>   <p id="9b83595e">Action map items from an existing action map can be reused in a new action map via <b id="b3960c49">imports</b>. The users have two options:</p>   <ul class="list _ul"><li class="list__item" id="284af3ec"><p>to import all items from an action map</p></li><li class="list__item" id="0a69be3b"><p>to import only the item with a given action ID</p></li></ul>   <p id="5655d833">      <figure><a class="lightbox" href="/help/img/idea/2019.2/image2018-9-14-13-23-37.png"><img alt="image2018 9 14 13 23 37" title="image2018 9 14 13 23 37" src="/help/img/idea/2019.2/image2018-9-14-13-23-37.png" id="57c1b518" width="500" height="700"></a></figure>   </p>   <p id="944ad025">Importing actions follows the following rules:</p>   <ul class="list _ul"><li class="list__item" id="4f47b352"><p>Imports work transitively.</p></li><li class="list__item" id="90315bad"><p>Actions defined in the current cell action map have priority over actions defined in any of the imported cell action maps.</p></li><li class="list__item" id="ffaa73c9"><p>If multiple imported maps define an action of the same type, the most recently imported one takes precedence.</p></li><li class="list__item" id="01c70ba4"><p>Cyclic imports are not allowed.</p></li><li class="list__item" id="74f11ce3"><p>The applicable concept of any imported cell action map has to be the same concept or a super-concept of the applicable concept of this map.</p></li><li class="list__item" id="e97b35e3"><p>Action map imports work cross-language: an action map in the editor aspect of one language can import an action map from the editor aspect of another language.</p></li></ul>   <p id="337fe26b">The DELETE and BACKSPACE action handlers have specific semantics. If an action map <b id="9604e80c">defines or imports</b> a DELETE handler and <b id="476995bb">does not define or import</b> a BACKSPACE handler, a default BACKSPACE handler identical to the one for DELETE is registered automatically.</p>   <p id="678db2dc">The resolution of imported action handlers is dynamic (happens at run-time. When action map A imports items from action map B, the exact action handlers that will be registered are not resolved at generation time of action map A. Instead, code is generated that will register handlers provided by action map B at runtime. As a result, action map A does not have to be regenerated when action map B changes.</p>      <h2 id="cellmenus">Cell menus</h2>   <p id="854ebe0a">One may specify a custom completion menu for a certain cell. Open an inspector for your cell declaration, find a table named Common, find a row named menu, create a new cell menu descriptor. Cell menu descriptor consists of menu parts, which are of differend kinds, which are discussed below.</p>      <h3 id="propertyvaluesmenupart">Property values menu part</h3>   <p id="6d3afb72">This menu part is available on property cells, it specifies a list of property values for your property which will be shown in completion. One should write a function which returns a value of type list&lt;String&gt;.</p>      <h3 id="propertypostfixhintsmenupart">Property postfix hints menu part</h3>   <p id="4c892881">This menu part is available on property cells, it specifies a list of strings which serve as "good" postfixes for your property value. In such a menu part one should write a function which returns a value of type list&lt;String&gt;. Such a menu is useful if you want MPS to "guess" a good value for a property. For instance, one may decide that it will be a good variable name which is a variable type name but with the first letter being lowercased, or which ends with its type name: for a variable of type "Foo" good names will be "foo", "aFoo", "firstFoo", "goodFoo", etc. So one should write in a variable declaration's editor in a menu for property cell for variable name such a menu part:</p>property postfix hints   postfixes: (scope, operationContext, node)-&gt;list&lt;String&gt; {                  list &lt; String &gt; result;                  node &lt; Type &gt; nodeType = node. type;                  if ( nodeType != null ) {                     result = MyUtil.splitByCamels( nodeType. getPresentation() );                  } else {                     result = new list &lt; String &gt; { empty };                  }                  return  result;               }<p id="e2c09b12">where splitByCamels() will be a function which returns a list of postfixes of a string starting with capitals (for instance MyFooBar -&gt; MyFooBar, FooBar, Bar).</p>      <h3 id="primaryreplacechildmenu">Primary replace child menu</h3>   <p id="7020c1a2">It's a cell menu part which returns primary actions for child (those by default, as if no cell menu exists).</p>      <h3 id="primarychoosereferentmenu">Primary choose referent menu</h3>   <p id="12f04161">It's a cell menu part which returns primary actions for referent (those by default, as if no cell menu exists).</p>      <h3 id="replacenodemenu(customnode'sconcept)">Replace node menu (custom node's concept)</h3>   <p id="53b6b56b">This kind of cell menu parts allows to replace an edited node (i.e. node on which a completion menu is called) with instances of a certain specified concept and its subconcepts. Such a cell menu part is useful, for example, when you want a particular cell of your node's editor to be responsible for replacement of a whole node. For instance, consider an editor for binary operations. There's a common editor for all binary operations which consists of a cell for left operand, a cell for operation sign which is a cell for concept property "alias" and a cell for right operand.</p>[&gt; % leftExpression % ^{{ alias }} % rightExpression % &lt;]<p id="22b258c6">It is natural to create a cell menu for a cell with operation sign, which will allow to replace an operation sign with another one, (by replacing a whole node of course). For such a purpose one will write in the cell for operation sign a replace node menu part:</p>replace node (custom node concept)   replace with: BinaryOperation<p id="e6dbaa1f">The former left child and right child are added to newly created BinaryOperation according to <a href="editor-actions.html#node_factories">Node Factories</a> for BinaryOperation concept.</p>      <h3 id="replacechildmenu(customchild'sconcept)">Replace child menu (custom child's concept)</h3>   <p id="4ad4debe">Such a cell menu part is applicable to a cell for a certain child and specifies a specific concept which and subconcepts of which will be shown in completion menu (and instantiated when chosen and the instance will be set as a child). To specify that concept one should write a function which returns a value of a type node&lt;ConceptDeclaration&gt;.</p>      <h3 id="replacechildmenu(customaction).">Replace child menu (custom action).</h3>   <p id="c3d9d156">This kind of cell menu parts is applicable to a cell for a certain child and allows one to customize not only child concept, but the whole replace child action: matching text (text which will be shown in completion menu), description text (a description of an action, shown in the right part of completion menu), and the function which creates a child node when the action is selected from completion menu. Hence, to write such a menu one should specify matching text, description text and write a function returning a node (this node should be an instance of a target concept specified in a respective child link).</p>      <h3 id="genericmenuitem">Generic menu item</h3>   <p id="0854e835">This kind of cell menu part allows one to make MPS perform an arbitrary action when a respective menu item will be selected in a completion menu. One should specify matching text for a menu item and write a function which does what one wants. For instance, one may not want to show a child list cell for class fields if no class fields exist. Hence one can't use its default actions to create a new field. Instead, one can create somewhere in a class' editor a generic menu item with matching text "create field" which creates a new field for a class.</p>generic item   matching text: add field   handler: (node, model, scope, operationContext)-&gt;void {                node. field. add new ( &lt;default&gt; );             }   <h3 id="actiongroups">Action groups</h3>   <p id="12412beb">An action group is a cell menu part which returns a group of custom actions. At runtime, during the menu construction, several objects of a certain type, which are called parameter objects, are collected or created. For that parameter object type of an action group functions, which return their matching text and description text, are specified. A function which is triggered when a menu item with a parameter object is chosen is specified also.</p>   <p id="85310854">Thus, an action group description consists of:</p>   <ul class="list _ul"><li class="list__item" id="c6e4c04f"><p>a parameter object type;</p></li><li class="list__item" id="261491cd"><p>a function which returns a list of parameter objects of a specified type (takes an edited node, scope and operation context);</p></li><li class="list__item" id="92ba74e3"><p>a function which takes a parameter object of a specified type and returns matching text (a text which will be shown in a completion menu);</p></li><li class="list__item" id="f537d3aa"><p>a function which takes a parameter object of a specified type and returns description text for a parameter object;</p></li><li class="list__item" id="1625bfb6"><p>a function which performs an action when parameter object is chosen in a completion menu.</p></li></ul>   <p id="b9f7507b">A function which performs an action may be of different kinds, so there are three different kinds of cell action group menu parts:</p>   <ul class="list _ul"><li class="list__item" id="31776874"><p>Generic action group. Its action function, given a parameter object, performs an arbitrary action. Besides the parameter object, the function is provided with edited node, its model, scope and operation context.</p></li><li class="list__item" id="b0307882"><p>Replace child group. It is applicable to child cells and its action function, given a parameter object, returns a new child, which must have a type specified in a respective child link declaration. Besides the parameter object, the function is provided with edited node, its model, current child(i.e. a child being replaced), scope and operation context.</p></li><li class="list__item" id="a51e013a"><p>Replace node group. Its action function, given a parameter object, returns a node. Usually it is some referent of an edited node (i.e. node on which a completion menu is called). Besides the parameter object, the function is provided with edited node, its model, scope and operation context.</p></li></ul>      <h3 id="cellmenucomponents">Cell menu components</h3>   <p id="bcb6ad08">When some menu parts in different cells are equal one may want to extract them into a separate and unique entity, to avoid duplications. For such a purpose cell menu components are meant. A cell menu component consists of a cell menu descriptor (a container for cell menu parts) and a specification of an applicable feature. A specification of applicable feature contains a reference to a feature (i.e. child link declaration, reference link declaration or property declaration), to which a menu is applicable. For instance if your menu component will be used to replace some child its child link declaration should be specified here; etc.</p>   <p id="e12557aa">When a cell menu component is created, it can be used in cell menus via cell menu component menu part, which is a cell menu part which contains a reference to a certain menu component.<a href="smodel-language.html">SModel language</a>   </p>   <h2 id="customizingreferencepresentation">Customizing reference presentation</h2>   <p id="81018991">Specification of the matching text and in-editor textual presentation for references can be done directly in the editor aspect.</p>   <p id="fed3e9e2">The&nbsp;<i id="f6d86c06">ref. presentation</i> cell can have the displayed text customized:</p>   <p id="4433e224">      <figure><a class="lightbox" href="/help/img/idea/2019.2/RefCust1.png"><img alt="RefCust1" title="RefCust1" src="/help/img/idea/2019.2/RefCust1.png" id="d6e29734" width="500" height="722"></a></figure>   </p>   <p id="9cbbdd91">The&nbsp;<i id="bfad15ef">cell menu</i> can customise the text displayed in the completion menu:</p>   <p id="82702bf6">      <figure><a class="lightbox" href="/help/img/idea/2019.2/RefCust2.png"><img alt="RefCust2" title="RefCust2" src="/help/img/idea/2019.2/RefCust2.png" id="5afe4cb9" width="500" height="730"></a></figure>   </p>   <p id="c4a0a9b5">This functionality was previously achieved through&nbsp;<i id="fb859c95">Constraints</i>.</p>   <h2 id="migrationofpresentationqueryinreferenceconstraints">Migration of presentation query in reference constraints</h2>   <p id="e8a472d3">The design of the reference presentation part in the constraints&nbsp;aspect has been showing its its age and so has been replaced with the new functionality described above.Most of the code will be migrated automatically. Some code that produced with migration can be simplified so consider to review it.</p>   <p id="592d1691">There is a case when a presentation query can not be migrated: suppose you have an editor for a concept with reference link and then have a reference constraint with defined presentation part for its&nbsp;reference&nbsp;in one of its subconcepts. If editor component doesn't overriden in subconcept, MPS doesn't know where this presentation part should be inlined. In this case, you should manually migrate the presentation part usage to prevent uncorrected reference presentation in user code. There are several alternatives to do it:</p>   <ul class="list _ul"><li class="list__item" id="bad3a9b7"><p>Simply override the editor in subconcept. Move the code from presentation part to the proper reference cell.</p></li><li class="list__item" id="ac473bc3"><p>Extract the reference cell into a separate component and override the component for subconcept.</p></li><li class="list__item" id="bbfd1d04"><p>Create new behavior method that provides a presentation for the reference. Make reference cell delegates to created method. Override this method in subconcept.</p></li></ul>   <p id="a1af2f28">If you are expecting that your language may be extended in another project by someone else, do&nbsp;<b id="b424e573">not</b>&nbsp;remove deprecated presentation parts. Otherwise, extending languages may be migrated improperly.</p>   <h2 id="two-stepdeletion">Two-step deletion</h2>   <p id="10f54e25">In projectional editor it is sometimes hard to predict what part of the code will be deleted when you press <i id="ac941412">Delete</i> or <i id="472917a4">Backspace</i>. For example, when the caret is on the semicolon of the baseLanguage statement and you press <i id="e9da5892">Backspace</i>, the whole statement will be deleted.&nbsp;With <b id="36a0fc72">two step deletion</b>, you now can see what part of the code which will be deleted.<br>Here how it works: you press <i id="f3ae0c9a">Delete</i> or <i id="81c00d27">Backspace</i> and the part of the code, which is to be deleted, becomes highlighted. If it suits you, you press <i id="5ff49fe2">Delete</i> or <i id="5bba2069">Backspace</i> again and the code will be deleted. If after highlighting you realize that you don't want to delete this piece of code you can press <i id="b09e1558">Escape</i> or just move the caret and the highlighting will disappear.</p>   <p id="fb0a9ec3">Let's see the example:<br>Put the caret to the statement semicolon.</p>   <p id="2a6ead4d">      <figure><img alt="Semicolon" title="Semicolon" src="/help/img/idea/2019.2/Semicolon.png" id="349f15dc" width="706" height="124"></figure>   </p>   <p id="f45fd741">Press <i id="e31d99e6">Backspace</i>. The whole statement is highlighted. This means that if you press <i id="5e29c062">Backspace</i> again, the statement will be deleted.</p>   <p id="17217d07">      <figure><img alt="Semicolon highlighted" title="Semicolon highlighted" src="/help/img/idea/2019.2/Semicolon-highlighted.png" id="a578f9dc" width="720" height="120"></figure>   </p>   <p id="155172fe">Press <i id="8e201c95">Backspace</i> again. The statement is deleted.</p>   <p id="3948d8ca">      <figure><img alt="Deleted" title="Deleted" src="/help/img/idea/2019.2/Deleted.png" id="a3a476a5" width="702" height="116"></figure>   </p>   <p id="04b1bd9f">The same works by default for other nodes.</p>   <aside class="warning " data-title="" rel="04b1bd9f" id="74e49d34">      <p id="0f05cc3a">Note that if the node is selected, it will be removed immediately without highlighting. Also if the caret is on the editable text cell, the text parts will be also removed immediately.</p>   </aside>   <p id="5fa36b40">To turn on the two step deletion, check the "two step deletion" checkbox in&nbsp;<b id="1966a5fb">Preferences &gt; Editor &gt; General</b>.</p>   <h3 id="invokingtwo-stepdeletionfromcode">Invoking two-step deletion from code</h3>   <p id="06fa5745">The language designer may include the two step deletion scenario in her custom delete actions. The&nbsp;<b id="35310351">ApproveDelete_Operation&nbsp;</b>in&nbsp;<i id="2ce56f4d">jetbrains.mps.lang.editor&nbsp;</i>is introduced for that purpose. This operation is applied to the node:</p>   <p id="5be6bc66">      <figure><img alt="appr del" title="appr del" src="/help/img/idea/2019.2/appr-del.png" id="2d53f334" width="616" height="34" class="inline-icon-616"></figure>   </p>   <p id="3e0d0a01">This operation returns true iff it succeed and the node has not been approved for deletion before. More formally all the following conditions need to be met:</p>   <p id="93b839a6">1) The two-step deletion preferences option is checked.</p>   <p id="17d3ead2">2) The node has not been fully selected.</p>   <p id="be498dfd">3) The node has not been approved for deletion already.</p>   <p id="08d4192b">When all of these conditions are met, the node approved for deletion gets highlighted and the custom delete action may stop at this point.</p>   <p id="adbce6bc">If the same custom delete action is called immediately after approving the deletion, the <i id="14525364">approveDelete</i> operation will return false (because the node has been approved already) and the action will proceed with the deletion.</p>   <p id="bef36f2a">Let's see the typical scenario from the baseLanguage:</p>   <p id="9f7d0f89">      <figure><img alt="dotE" title="dotE" src="/help/img/idea/2019.2/dotE.png" id="e75759b8" width="1100" height="74"></figure>   </p>   <p id="13caf0e0">This is the part of the delete action for the&nbsp;<b id="b2c7b68d">Dot_Expression's</b>&nbsp;operation. This action first tries to approve the operation for the deletion and if it succeed the action stops. If ir does not succeed, that means that either node's operation has already been approved (= highlighted), or the node has been selected by the user or the "two step deletion" preferences option is turned off. In this case, we delete the operation and replace it with the node of the abstract concept.</p>   <h3 id="morecomplexcases">More complex cases</h3>   <p id="abfa7e9b">Sometimes the customized delete action needs to be more complicated than just deleting the current node.</p>   <p id="819b298f">Let's see an example scenario: we press delete on the "final" keyword on the&nbsp;<b id="1fa50f90">IncompleteMemberDeclaration</b>. There is a custom action, which sets the&nbsp;<i id="0903701d">final&nbsp;</i>property to false.<b id="657fac50">&nbsp;</b>In the editor, there is the cell, which is shown only if the&nbsp;<i id="1c50f114">final&nbsp;</i>property of the node is true, so after the action, the cell wouldn't be shown.</p>   <p id="2a99599f">If we want to highlight the final keyword before hiding it (by setting the <i id="6fc678a8">final</i> property to false), we approve it for the deletion this way:</p>   <p id="d6143489">      <figure><img alt="final" title="final" src="/help/img/idea/2019.2/final.png" id="7608821b" width="1256" height="76"></figure>   </p>   <h2 id="2bb22ce4">Custom style and priority of completion items (EXPERIMENTAL)</h2>   <figure><img alt="CompletionStylingConceptFunc" title="CompletionStylingConceptFunc" src="/help/img/idea/2019.2/CompletionStylingConceptFunc.png" id="d2030427" width="2590" height="226"></figure>   <p id="c8ec8330">   The language designers can set the style and the priority for the items in a completion menu.   In order to do so the language designer should create the <i id="4e9dd9cb">Completion Styling</i> root in the editor aspect of the language.   In order to specify the style of a completion menu item the language designer should first specify the item.<br>   We currently provide two possible selectors of the completion items:   </p>      <ul class="list _ul"><li class="list__item" id="58115e72"><p>Items which modify instances of a specific concept.This selector selects items which appear in the            completion menu when the user puts the caret on the node of the concept (or it's properties, references, or            children) and presses <i id="7a8ab891">Control + Space</i>         </p></li><li class="list__item" id="0fd7ce63"><p>Items which create instances of a specific concept. Those are mainly the substitute actions. For example,            when user selects the <i id="9972e4ab">ReturnStatement</i> which is in the <i id="24db1f8c">StatementList</i>and presses <i id="a5665dc3">Control + Space</i>, the items in the            completion menu are creating the instances of <i id="b3f71a80">Statement</i> and replace the <i id="25a61731">ReturnStatement</i> with those            instances. So the selector for actions creating instances of <i id="77a0daa0">Statement</i> will select those items.         </p></li></ul>   <p id="e6d63202">It is important that one item could be selected by several selectors. For example, in the situation above several selectors will match one completion item:</p>      <ul class="list _ul"><li class="list__item" id="ace6cf60"><p>for actions creating the instances of <i id="491a77d1">Statement</i> (because the item will replace the current node with another            <i id="1cc653e6">Statement</i>)         </p></li><li class="list__item" id="bd47d4ea"><p>for actions modifying instances of <i id="c24bb379">Statement</i> (because the current node is <i id="60b33fb8">ReturnStatement</i> which is also            <i id="b422cfc5">Statement</i>)         </p></li><li class="list__item" id="15a989ad"><p>for actions modifying instances of <i id="023e5d0c">StatementList:statement</i> (because the menu item will paste a new node into the            statement role of parent <i id="f88e397c">StatementList</i>)         </p></li></ul>   <p id="9e39537f">So you should prefer the most specific selector possible. For example, a selector or an actions modifying instances of <i id="352ec346">BaseConcept</i> is the least specific selector and will affect all completion menu items   </p>   <figure><img alt="CompletionStylingStrike" title="CompletionStylingStrike" src="/help/img/idea/2019.2/CompletionStylingStrike.png" id="318318af" width="1882" height="206"></figure>   <p id="c9d2d7f5">   Once the selector matches a menu item, the language designer could customize it's style. The <i id="09203448">style object</i> serves this purpose.<br>      Currently it is possible to:</p>      <ul class="list _ul"><li class="list__item" id="7f6b2aec"><p>make the item's font bold</p></li><li class="list__item" id="23a4d292"><p>make the item's font italic</p></li><li class="list__item" id="263ecb50"><p>strike out the item's text (useful for deprecating the concepts)</p></li><li class="list__item" id="22ea0302"><p>set the item's background and text color</p></li><li class="list__item" id="917003ed"><p>hide an item</p></li><li class="list__item" id="d73c50b3"><p>set the item's priority</p></li></ul>   <p id="89384ccb">Note that all the styles accumulate:</p>      <ul class="list _ul"><li class="list__item" id="00f5391d"><p>If at least one styler sets any of the bold/italic/hide styles, the item will be bold/italic/hidden.</p></li><li class="list__item" id="ccfe1fa4"><p>If the background or the text colors conflict, the first one specified will be used.</p></li><li class="list__item" id="c167f19c"><p>The priorities are used to sort the items. The biggest value set as a priority for an item by the stylers is used.</p></li><li class="list__item" id="373f2365"><p>Items are first sorted by priorities and then by the level of matching the user's text. Currently there is            no way to override this level.</p></li></ul>   <p id="0af32d0c">There are several parameters the language designer can use. They are stored in the item.</p>      <h3 id="cf35d6f2">Information parameters:</h3>      <ul class="list _ul"><li class="list__item" id="97e33174"><p>            <b id="e238f5b8">matchingText</b> - the text appearing on the left side of the item. This text is used to filter the items when            the user types the text in the completion menu.         </p></li><li class="list__item" id="6c636704"><p>            <b id="a7747e69">descriptionText</b> - the text appearing on the right side of the item.</p></li><li class="list__item" id="7f065e0e"><p><b id="ccea8ed5">parameterObject</b> - some of the items can be parameterized with an object. For example, items which change the            node's reference are parameterized with the target of the reference which they will set when executed.         </p></li><li class="list__item" id="ef477b2b"><p>            <b id="b8d94bdf">outputConcept</b> - some actions, like substitute actions create new nodes, the output concept is the concept            of the new node.         </p></li></ul>      <h3 id="a06a41f0">A few notable examples of stylers in baseLanguage:</h3>      <ul class="list _ul"><li class="list__item" id="d97c615e"><p>            <i id="d48d351f">ReturnStatementStyling</i> which makes a return item bold and sets its priority to non-zero, if it is last in            the current statement list.            <figure><img alt="CompletionStylingReturn" title="CompletionStylingReturn" src="/help/img/idea/2019.2/CompletionStylingReturn.png" id="9e316526" width="2286" height="330"></figure>         </p></li><li class="list__item" id="944e0a54"><p>            <i id="38fc81be">VariableReferencePriority</i> which sets the items priority to non-zero if the item references a variable            declaration.            <figure><img alt="CompletionStylingVarRef" title="CompletionStylingVarRef" src="/help/img/idea/2019.2/CompletionStylingVarRef.png" id="70bab816" width="2578" height="350"></figure>         </p></li></ul>      <h3 id="ac8e3c37">IMPORTANT NOTE:</h3>   <p id="98de7781">This feature is experimental and its design could be changed a lot in the future. The feedback regarding this feature will be very appreciated and will help us improve it.      There is a possibility to turn this functionality off: Settings-&gt;Editor-&gt;General-&gt;Use completion styling   </p><div class="last-modified" data-skip-index="skip">Last modified: 30 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="structure.html">Structure</a><a class="navigation-links__next" href="editor-actions.html">Editor Actions</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>