<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Generator User Guide Demo6 - Help | MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Generator+User+Guide+Demo6.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Default</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_jbuilder">JBuilder</option><option data-group="primary" value="primary_mac_os_x">Mac OS X</option><option data-group="primary" value="primary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default">Default</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_jbuilder">JBuilder</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Generator+User+Guide+Demo6.html" id="generator-user-guide-demo6.xml">Generator User Guide Demo6</h1>   <h2 id="generatoruserguidedemo6">Generator User Guide Demo 6</h2>   <p id="aa75d3ea">This demo is probably the most exciting one of all demos, because here we are going to create a 'real' language in the sense that this language will actually define a couple of higher-level concepts.<br>We will also see how easily this DSL can be integrated with existing languages - 'jetbrains.mps.sampleXML' and 'generator_demo.demoLang5' (created earlier in the&nbsp;<a href="generator-user-guide-demo5.html">Demo 5</a>).</p>   <h2 id="thecoreidea">The core idea</h2>   <p id="2cf05bcf">We'll allow for a more convenient syntax for entering XML&nbsp;<i id="c4322410">Elements</i>&nbsp;in the test models. Developers will use new syntax for&nbsp;<i id="87be4dc9">button</i>&nbsp;and&nbsp;<i id="be82f9ab">label</i>, which will be more compact and intuitive. At the same time, we'll be able to reuse the generator defined in the&nbsp;<i id="38098fbd">demoLang5</i>&nbsp;language that we built in Demo 5. The new&nbsp;<i id="a2feadd9">demoLang6</i>&nbsp;language will translate the new concepts into XML&nbsp;<i id="01cfe847">Elements</i>, which then can be accepted by the&nbsp;<i id="251f8d23">demoLang5</i>&nbsp;generator.</p>   <p id="40b523da">      <figure><img alt="gdf5" title="gdf5" src="/help/img/idea/2019.2/gdf5.png" id="0d590ddc" width="341" height="135"></figure>   </p>   <h2 id="newlanguage">New Language</h2>   <ul class="list _ul"><li class="list__item" id="b7252e87"><p>create new language 'generator_demo.demoLang6'</p></li><li class="list__item" id="5f534835"><p>in language properties dialog add&nbsp;<b id="06e0a43e">extended languages</b>&nbsp;: 'jetbrains.mps.sampleXML' and 'jetbrains.mps.baseLanguage'</p></li><li class="list__item" id="dd64644a"><p>create a new generator for this language, if it does not exist (see&nbsp;<a href="generator-user-guide-demo1.html">Demo 1</a>&nbsp;for details)</p></li><li class="list__item" id="4af7c437"><p>in demoLang6&nbsp;<b id="622d55e0">structure model</b>&nbsp;create new concept named 'Button' extending the concept 'ElementPart' (from 'jetbrains.mps.sampleXML')</p></li><li class="list__item" id="c5e3e5da"><p>in 'Button' concept declare a&nbsp;<b id="e33d3bad">property</b>&nbsp;named 'text' and set an&nbsp;<b id="f36f2da2">alias</b>&nbsp;(we need an alias to make auto-completion menu look nice):</p></li></ul>   <p id="5347a7e2">      <figure><img alt="error1" title="error1" src="/help/img/idea/2019.2/error1.png" id="5179e59c" width="767" height="312"></figure>   </p>   <ul class="list _ul"><li class="list__item" id="3b8ad757"><p>create an editor for the 'Button' concept:</p></li></ul>   <p id="5343aed9">      <figure><img alt="gdf2" title="gdf2" src="/help/img/idea/2019.2/gdf2.png" id="2c32bf19" width="698" height="315"></figure>      <br>The editor consists of three cells: two constant-cells (shown in bold) and one property-cell (shown as {<code class="code">text</code>}) which will render the actual value of the 'text' property.</p>   <ul class="list _ul"><li class="list__item" id="3c3a2b6b"><p>create a similar concept named 'Label'</p></li><li class="list__item" id="a9e44ee1"><p>re-generate the language (<i id="eb79da82">Ctrl-F9</i>)</p></li></ul>   <h2 id="newtestmodel">New Test Model</h2>   <p id="a1a69c06">Now let's try out our new DSL:</p>   <ul class="list _ul"><li class="list__item" id="010e7afe"><p>go to the 'test_models' solution</p></li><li class="list__item" id="ecfac552"><p>clone the 'test5' model into 'test6' (this time&nbsp;DO NOT&nbsp;replace&nbsp;<b id="8d4ab362">engage on generation language</b>&nbsp;<br>generator_demo.demoLang5 -&gt; generator_demo.demoLang6, since we still need the&nbsp;<i id="be9f1314">demoLang5</i>&nbsp;generator to run with&nbsp;<i id="3d5f634d">test6</i>)</p></li><li class="list__item" id="20474505"><p>add the 'generator_demo.demoLang6' language to the&nbsp;<b id="20b5b77b">used languages</b>&nbsp;section (new!), so we can use the&nbsp;<i id="b313a784">demoLang6</i>&nbsp;language for editing our model.</p></li></ul>   <p id="36685885">      <figure><img alt="gdf3" title="gdf3" src="/help/img/idea/2019.2/gdf3.png" id="b1077d1d" width="531" height="263"></figure>   </p>   <ul class="list _ul"><li class="list__item" id="1a67bc29"><p>in the 'test6' model open the 'Panel'&nbsp;document and replace the two 'label' elements with our new&nbsp;<i id="b36c9ef1">button</i>&nbsp;and&nbsp;<i id="b17d458b">label</i>&nbsp;concepts:</p></li></ul>   <p id="dce0c033">      <figure><img alt="gdf6" title="gdf6" src="/help/img/idea/2019.2/gdf6.png" id="5c35f010" width="637" height="296"></figure>   </p>   <p id="8a988560">With the new DSL our 'code' became clearer, shorter and less error prone. For instance, users now no longer can add elements inside labels or buttons.</p>   <h2 id="generator">Generator</h2>   <p id="25789181">We could generate methods and method calls out of&nbsp;<i id="1b7a3296">button</i>&nbsp;and&nbsp;<i id="ff7219e1">label</i>&nbsp;mimicking what has been done earlier for XML&nbsp;<i id="efbdd930">Elements</i>.&nbsp;But this isn't a good idea, because this way we would introduce indirect dependency between the&nbsp;<i id="5ad66ea7">demoLang6</i>&nbsp;generator and the&nbsp;<i id="be5367c6">demoLang5</i>&nbsp;generator (the&nbsp;<i id="c3169075">demoLang6</i>&nbsp;generator would have to know about the implementation details of the&nbsp;<i id="5a55a605">demoLang5</i>&nbsp;generator).</p>   <p id="213ca151">Luckily, we have a far better option.&nbsp;As we are on a higher level of abstraction now (comparing to XML), we can simply reduce our semantically rich concepts into lower-level concepts (XML Elements). We don't care anymore about who and how will transform those lower-level (XML) concepts further into even lower-level concepts.</p>   <h2 id="reductionrules">Reduction Rules</h2>   <p id="dbd1ec39">We'll employ reduction rules to convert our new concepts into XML&nbsp;<i id="6c435f42">Elements</i>. from the&nbsp;<i id="7eb3d509">sampleXML</i>&nbsp;language.</p>   <ul class="list _ul"><li class="list__item" id="91b3bd84"><p>open the (empty)&nbsp;<b id="0170852f">mapping configuration</b>&nbsp;'main' in the demoLang6 generator</p></li><li class="list__item" id="4c922f94"><p>add a new&nbsp;<b id="ccd35f06">reduction rule</b>&nbsp;applicable to the&nbsp;<i id="7dd65fb6">Button</i>&nbsp;concept</p></li><li class="list__item" id="0565da30"><p>choose an&nbsp;<b id="c138327d">in-line template</b>&nbsp;as the rule consequence (<i id="28e2603b">Control + Space</i>):</p></li></ul>   <p id="0ebcb7ed">      <figure><img alt="gdf7" title="gdf7" src="/help/img/idea/2019.2/gdf7.png" id="accf33f4" width="927" height="222"></figure>   </p>   <p id="179c1f8f">The template is going to be pretty straightforward and it will not require any surrounding 'context'. That's why it is not necessary to create a full-blown external template as we did in other demos.</p>   <p id="5fc5ce6c">Since we want to use XML&nbsp;<i id="62f86196">Elements</i>&nbsp;from the 'jetbrains.mps.sampleXML' language in generator templates, we first have to declare that language among&nbsp;<i id="15876970">Used Languages</i>&nbsp;by the&nbsp;<i id="58ccbf54">main@generator</i>&nbsp;model:</p>   <p id="84152b72">      <figure><img alt="gendemo61" title="gendemo61" src="/help/img/idea/2019.2/gendemo61.png" id="e3c9d000" width="1068" height="684"></figure>   </p>   <ul class="list _ul"><li class="list__item" id="8df10c2a"><p>back in the&nbsp;<i id="8091f3ee">main</i>&nbsp;mapping configuration&nbsp;choose&nbsp;<i id="cda5b900">Element</i>&nbsp;as the template's content node:</p></li></ul>   <p id="40cdad31">      <figure><img alt="gdf9" title="gdf9" src="/help/img/idea/2019.2/gdf9.png" id="2ebf9247" width="688" height="207"></figure>   </p>   <ul class="list _ul"><li class="list__item" id="845f2f5e"><p>create the 'button' XML element with a 'text' attribute</p></li><li class="list__item" id="29f6a080"><p>attach a property macro to the attribute value</p></li><li class="list__item" id="a9971f45"><p>enter the code in the macro's&nbsp;<b id="c0957a0f">value</b>&nbsp;function so that the value of the&nbsp;<i id="86156de9">text</i>&nbsp;property gets propagated into the XML button:</p></li></ul>   <p id="fe89f9b4">      <figure><img alt="gdf10" title="gdf10" src="/help/img/idea/2019.2/gdf10.png" id="38b95241" width="707" height="274"></figure>   </p>   <p id="bed31876">That's it. Our high-level button is being reduced into a 'button' XML element with a 'text' attribute.&nbsp;The XML element will presumably be further transformed down to Java by somebody else.</p>   <ul class="list _ul"><li class="list__item" id="c9610b06"><p>add a similar reduction rule applicable to the&nbsp;<i id="3aa8d9fc">Label</i>&nbsp;concept</p></li></ul>   <h2 id="firsttest(failure)">First Test (Failure)</h2>   <p id="f161dccb">Re-build the generator and generate the 'test6' model.</p>   <p id="02604d2f">There will be a bunch of error and warning messages in the MPS messages view.<br>Click on the 'was input node' error message. MPS will show you the node to, which the generator was trying to apply the rule that failed:</p>   <p id="79c84019">      <figure><img alt="demo6 errorMessages" title="demo6 errorMessages" src="/help/img/idea/2019.2/demo6-errorMessages.png" id="14148989" width="974" height="496"></figure>   </p>   <p id="645a110b">This is a reduction rule in the demoLang5 generator (we are generating the 'test6' model with two generators: demoLang5 and demoLang6, remember?) and it has failed to find a static method declaration through the mapping label&nbsp;<i id="6de83847">method</i>.</p>   <p id="4e728b1a">The&nbsp;<i id="29ab903c">method</i>&nbsp;label is being assigned the generated static methods inside the&nbsp;<i id="6a862ebf">insert_Button</i>&nbsp;and&nbsp;<i id="9e9c179f">insert_Label</i>&nbsp;templates,&nbsp;so you may wonder what went wrong. Why couldn't we find the methods created inside the&nbsp;<i id="c125b2d7">DempApp</i>&nbsp;class and stored in the mapping label?</p>   <p id="000219fe">To answer that question let's take a closer look at the generation process as a whole.</p>   <hr id="d7d96fb1">   <p id="c9f334cd">As the first step, the generator creates a&nbsp;<b id="1854d579">transient model</b>, which will serve as an&nbsp;<b id="a2180d46">output model</b>&nbsp;for the current generation phase. This model name is 'test6@0'.</p>   <aside class="tip sideblock" data-title="" rel="c9f334cd" id="3c6198b2">      <p id="95466f12">You can actually inspect the transient models yourself, if you enable 'Save transient models' through the button in the bottom right corner of the MPS frame. The transient models will show-up in the <i id="66e3c0e8">Project View</i>&nbsp;panel.</p>   </aside>   <p id="4cd3d6a2">Then generator applies our&nbsp;<b id="d9eb6a2e">conditional root rule</b>&nbsp;and creates the 'DemoApp' class&nbsp;in output model.</p>   <p id="ccfe6221">Then, at some point, the&nbsp;<i id="e0ce7283">insert_Panel</i>&nbsp;template is invoked and its&nbsp;<i id="93bc5473">LOOP</i>-macro is executed (we can see the panel factory method containing the panel initialization code that we are familiar with from the&nbsp;<i id="b33eaf35">insert_Panel</i>&nbsp;template). The LOOP-macro creates a statement 'component.add()' for each child of 'panel' element and reduces the child to generate an actual argument to the 'component.add()' method call.</p>   <p id="1ea959dc">Our 'panel' element contains three children - a button, a label and a text, which has been turned into a label by a pre-processing generation script. Both the button and the first label are high-level abstractions introduced by&nbsp;<i id="6ff6f8fa">demoLang6</i>&nbsp;and their reduction yields corresponding XML&nbsp;<i id="16041d11">Elements</i>. (We can see it clearly in the first screenshot, where the XML element representing a button is passed as an actual argument to the call to the 'component.add()' method. This is reported as a warning by the generator earlier up in the trace output in yellow color).</p>   <p id="a24f80de">This ends the generation of 'test6@1_1' and the generator now creates a new transient model, named 'test6@1_2'. This model becomes a new&nbsp;<b id="bf372c28">output model</b>&nbsp;and the former&nbsp;<b id="354de65f">output model</b>&nbsp;becomes a new&nbsp;<b id="5ea18987">input model</b>.</p>   <p id="ce8e2f25">The generator starts to generate a new model 'test6@2_2' pretending that there was nothing before. The generator has no memory about previous activities with only one exception -&nbsp;<b id="4bdb991e">conditional root rules</b>&nbsp;are never applied twice. Thus, this time, the output 'DemoApp' class is created by copying of 'DemoApp' class from the input model, not by applying a&nbsp;<b id="62049bb8">conditional root rule</b>.</p>   <p id="c778e861">At this stage, the generator attempts to reduce further the XML&nbsp;<i id="335ac45c">Elements</i>&nbsp;that represent the button and the label. The only rule available is the&nbsp;<i id="8ffa90ba">reduce_Element</i>&nbsp;reduction rule from&nbsp;<i id="bf789c56">demoLang5</i>. It will attempt to replace the XML&nbsp;<i id="88bd608f">Elements</i>&nbsp;with references to static factory method declarations, however, since none have been created, none can be found in the&nbsp;<i id="6388a6a7">method</i>&nbsp;mapping label. The method definitions were not created simply because the XML&nbsp;<i id="64044da2">Elements</i>&nbsp;were still represented as the&nbsp;<i id="7640b1e2">Button</i>&nbsp;and&nbsp;<i id="060360e1">Label</i>&nbsp;<i id="d0c05706">demoLang6</i>&nbsp;concepts at the time when the&nbsp;<i id="c71bdb3d">LOOP</i>&nbsp;macro inside&nbsp;<i id="314519b4">DempApp</i>&nbsp;was run.</p>   <p id="a740ca81">So this is a timing issue between the&nbsp;<i id="de50a7fa">demoLang5</i>&nbsp;and&nbsp;<i id="31c1a9d8">demoLang6</i>&nbsp;generators. The latter should be made run first.</p>   <hr id="831f9db1">   <p id="346c736d">Now that we understand what is happening, the next question is how to fix it.</p>   <p id="c0ee44c2">We are relying on the&nbsp;<i id="c45b72b8">demoLang5</i>&nbsp;generator and we know that the&nbsp;<i id="42c3cff3">demoLang5</i>&nbsp;generator works well providing that the input model is a 'valid XML' (we have tested it in Demo 5).<br>In Demo 6 our input model is not exactly a 'valid XML'. Moreover, we witnessed that the transient model 'test6@1_1' is not a valid model at all - a method call can't accept an XML element as argument (you can even find a warning message&nbsp;<i id="baf4259b">"child 'Expression' is expected for role 'actualArgument' but was 'Element'"</i>&nbsp;in the MPS message view).</p>   <p id="e66c46be">Now we could probably return to the&nbsp;<i id="a63b125f">demoLang5</i>&nbsp;generator and make some 'improvements' to allow it to handle 'invalid' input models.<br>Fortunately, there is a better option - we can divide the generation process in two steps so that the original input model gets transformed into a 'valid XML' model first, and then this 'valid XML' model will be transformed to Java by&nbsp;<i id="cca8bca1">demoLang5</i>&nbsp;generator in a second step.</p>      <h2 id="dividinggenerationprocessintosteps">Dividing Generation Process into Steps</h2>   <p id="d4e2e0e6">We will certainly get 'valid XML' model from the 'test6' input model if we reduce&nbsp;<i id="cde4249f">button</i>&nbsp;and&nbsp;<i id="d4e47851">label</i>&nbsp;(in the 'Panel' document) into XML&nbsp;<i id="9705f84e">Elements</i>.&nbsp;This transformation must happen before&nbsp;<i id="b2b57231">demoLang5</i>&nbsp;starts transforming XML&nbsp;<i id="edec7863">Elements</i>&nbsp;into Java.&nbsp;In other words, the reduction rules specified in the&nbsp;<i id="5e27e13b">demoLang6</i>&nbsp;generator must be applied before any rules in the&nbsp;<i id="cbaed1a7">demoLang5</i>&nbsp;generator.</p>   <p id="d5563045">Let's specify this constraint:</p>   <ul class="list _ul"><li class="list__item" id="d2b8697f"><p>go to the generator in&nbsp;<i id="64ad3db6">generator_demo.demoLang6</i>&nbsp;and open the generator properties dialog</p></li><li class="list__item" id="7cf6aebe"><p>add an&nbsp;<b id="f587be18">extension</b>&nbsp;dependency on the&nbsp;<i id="5ffff7ec">demoLang5</i>&nbsp;generator<br>         <figure><img alt="gdf14" title="gdf14" src="/help/img/idea/2019.2/gdf14.png" id="2458ecbe" width="615" height="407"></figure>      </p></li></ul>   <ul class="list _ul"><li class="list__item" id="c9fd0dbd"><p>in&nbsp;<b id="e18b92e9">Generators priorities</b>&nbsp;tab add a desired priority rule</p></li></ul>   <p id="8df89e1d">      <figure><img alt="Demo6 GeneratorPriorities2" title="Demo6 GeneratorPriorities2" src="/help/img/idea/2019.2/Demo6_GeneratorPriorities2.png" id="cb4eaf03" width="872" height="486"></figure>   </p>   <p id="0f543a99">This will ensure the&nbsp;<i id="06dec6ed">demoLang6</i>&nbsp;generator runs before the&nbsp;<i id="b4596b1a">demoLang5</i>&nbsp;generator.</p>   <h2 id="secondtest">Second Test</h2>   <p id="7a23f7ce">Re-build the language and preview generated text for the 'test6' model. You should now run into no issues during generation and the generated code will correctly include the new button and label.</p>   <p id="9585208e">      <figure><img alt="gdf16" title="gdf16" src="/help/img/idea/2019.2/gdf16.png" id="10984c76" width="346" height="407"></figure>   </p>      <h2 id="savingtransientmodels">Saving Transient Models</h2>   <p id="363be46b">Our&nbsp;<i id="9ce4b4ba">demoLang5</i>&nbsp;and&nbsp;<i id="6a774a94">demoLang6</i>&nbsp;generators are working together well, because we have divided the generation process into two distinct steps.<br>In the first step the&nbsp;<i id="66930e27">demoLang6</i>&nbsp;generator reduces our high-level concepts (button and label) into corresponding XML elements and produces a 'valid XML' model as output.<br>In the second step the&nbsp;<i id="ede452d4">demoLang5</i>&nbsp;generator generates Java from that 'valid XML' model.</p>   <p id="c3077956">Thus there should be at least one transient model between step 1 and step 2.<br>Let's take a look at what models have actually been created in the course of generation:</p>   <ul class="list _ul"><li class="list__item" id="296dfc52"><p>in&nbsp;<i id="ba86d8c9">Project Settings</i>&nbsp;enable&nbsp;the&nbsp;<b id="506b7c5e">Save transient models on generation</b>&nbsp;option:</p></li></ul>   <p id="3ece03fd">      <figure><img alt="Screen Shot 2017 07 24 at 11 08 30 PM" title="Screen Shot 2017 07 24 at 11 08 30 PM" src="/help/img/idea/2019.2/Screen-Shot-2017-07-24-at-11-08-30-PM.png" id="8d8b4250" width="633" height="212"></figure>   </p>   <ul class="list _ul"><li class="list__item" id="0ff785eb"><p>generate the 'test6' model</p></li><li class="list__item" id="06dcaac8"><p>in the project tree find and expand the node named 'transient models' (this node is at the bottom)<br>There are (surprisingly) five transient models.<br>We can browse the transient models and we will find sometimes subtle and sometimes dramatic differences between them. This will give us a clue about what kind of transformation has taken place on each step.</p></li></ul>   <p id="2e3f4bfc">For instance, open the 'Panel' node in model 'test@1_0' (this model has been generated in very first step).</p>   <p id="3ecccb63">      <figure><img alt="gdf18" title="gdf18" src="/help/img/idea/2019.2/gdf18.png" id="02f61563" width="748" height="313"></figure>   </p>   <p id="e0b267d2">We can see that high-level&nbsp;<i id="546707ae">button</i>&nbsp;and&nbsp;<i id="39f25717">label</i>&nbsp;concepts have been replaced with their XML counterparts, but the text 'Hello everybody!' is still there.</p>   <p id="9e87f631">In the next model 'test6@2_0' the text 'Hello everybody!' has been replaced with a 'label' element (as a result of running the pre-processing script 'fix_text' in the&nbsp;<i id="40725b5f">demoLang5</i>&nbsp;generator).</p>   <p id="aa379e43">Model 'test6@2_1' contains the generated&nbsp;<i id="7b3cd9c0">DemoApp</i>&nbsp;class.</p>   <p id="9f290023">And model 'test6@2_3' contains the same class, but the string "MPS!" is replaced with "JetBrains MPS!" (as a result of the post-processing script 'refine_text' in the&nbsp;<i id="43a8fed5">demoLang5</i>&nbsp;generator).</p>   <h2 id="rootnodescopyingandreductionrules">Root Nodes Copying and Reduction Rules</h2>   <p id="007ad0a5">As we can see, the model 'test6@1_0' is identical to the original input model 'test6', except for high-level button and label concepts that have been reduced to XML elements.<br>This is what we wanted, but it is probably still not clear, how roots in 'test6@1_0' have been created (we don't have any 'root rules' that would create a&nbsp;<i id="3c3f32a0">Document</i>) and why our reduction rules have been applied.<br>From our previous experience with reduction rules we remember that we had to create a&nbsp;<i id="bf6b9eb8">COPY_SRC&nbsp;_macro for reduction to take place. But in the&nbsp;_demoLang6</i>&nbsp;generator we don't have any _COPY_SRC&nbsp;_macros, do we?</p>   <aside class="tip sideblock" data-title="" rel="007ad0a5" id="4236cbfe">      <p id="142a2ee9">Whenever the generator meets an input root node, for which none of <b id="024c6a76">root mapping rules</b> or <b id="d57947ca">abandon root rules</b> is applicable, the generator creates a deep copy of that root in the output model.<br>While copying the node, the generator is always trying to find a&nbsp;<b id="89135353">reduction rule</b>&nbsp;applicable to the currently copied node.<br>If a suitable reduction rule is found, it is applied to the node. Otherwise, the generator creates an output node (instantiates the same concept), duplicates all properties and references of the input node (local references are re-resolved) and repeats the same copying procedure for all the child nodes recursively.</p>   </aside>   <p id="2665b94a">This way the input&nbsp;<i id="b8d1c43b">Documents</i>&nbsp;(Button, Label and Panel) from 'test6' have been copied to model 'test6@1_0' and reduction has been applied to the&nbsp;<i id="53c3455e">button</i>&nbsp;and&nbsp;<i id="02767a7f">label</i>&nbsp;concepts that were inside the 'Panel'&nbsp;<i id="bc7e2e00">Document</i>.</p>   <p id="aadb77cc">Returning to the _COPY_SRC&nbsp;_macro - it doesn't 'invoke' a reduction (as it might seem). Instead it merely applies the same copying procedure to the&nbsp;<b id="462ef385">mapped node</b>&nbsp;and, if any reduction rules happen to be applicable, then the transformation occurs.</p>      <h2 id="usinggenerationtracertool">Using Generation Tracer Tool</h2>   <p id="80df344c">We already know&nbsp;<a href="#savingtransientmodels">how to</a>&nbsp;save and browse transient models. Actually, with the option to&nbsp;<b id="1f1fb435">Save transient models on generation</b>&nbsp;activated, MPS not only saves transient models, but also collects a great deal of data regarding the process of transformation.<br>This data can be viewed using the&nbsp;<b id="1b7011e4">Generation Tracer Tool</b>.</p>   <p id="c54ca5a4">For instance, open the 'Panel'&nbsp;<i id="d2a0e950">Document</i>&nbsp;in the transient model 'test6@1_0', select 'label' and choose&nbsp;<i id="69904508">Show Generation Traceback</i>&nbsp;in the popup menu.</p>   <p id="98ee426f">      <figure><img alt="gdf19" title="gdf19" src="/help/img/idea/2019.2/gdf19.png" id="9b001a00" width="1019" height="657"></figure>   </p>   <p id="37a58565">The Generation Tracer View will be opened.</p>   <p id="c7af99fa">      <figure><img alt="gdf22" title="gdf22" src="/help/img/idea/2019.2/gdf22.png" id="78264460" width="917" height="540"></figure>   </p>   <p id="cfffb05f">In the root of this tree there is the 'label' node, for which we have requested the traceback info (the blue arrow denotes an&nbsp;<b id="6d0f0bd8">output node</b>) and the rest of the tree shows the sequence of events, in reversed order, that led to this output.</p>   <p id="72366700">Looking at this tree and clicking on its nodes (in order to open them in the editor) we can reproduce the process of transformation to a great level of detail.</p>   <p id="0891883d">For instance, we can see that the output 'label' is created by the template in the&nbsp;<i id="9f07778d">reduce Label</i>&nbsp;rule.</p>   <p id="b6ecf87a">      <figure><img alt="gdf20" title="gdf20" src="/help/img/idea/2019.2/gdf20.png" id="9bd5391c" width="968" height="532"></figure>   </p>   <p id="ef19d3b2">... and the&nbsp;<i id="8e7315c1">reduce Label</i>&nbsp;rule has been applied to the&nbsp;<b id="19222b96">input node</b>&nbsp;'Label' while the 'Panel'&nbsp;<i id="5accdb72">Document</i>&nbsp;(the&nbsp;root input node) was being copied.</p>   <p id="c354db47">      <figure><img alt="gdf21" title="gdf21" src="/help/img/idea/2019.2/gdf21.png" id="1de3aa65" width="965" height="493"></figure>   </p><div class="last-modified" data-skip-index="skip">Last modified: 30 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="generator-user-guide-demo5.html">Generator User Guide Demo5</a><a class="navigation-links__next" href="generator-user-guide-demo7.html">Generator User Guide Demo7</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>