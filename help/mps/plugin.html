<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Plugin - Help | MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Plugin.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Default</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_jbuilder">JBuilder</option><option data-group="primary" value="primary_mac_os_x">Mac OS X</option><option data-group="primary" value="primary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default">Default</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_jbuilder">JBuilder</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Plugin.html" id="plugin.xml">Plugin</h1>   <p id="70094375">      <ul data-skip-index="skip"><li class="list__item"><a href="#plugininstantiation">Plugin instantiation</a></li><li class="list__item"><a href="#actionsandactiongroups">Actions and action groups</a></li><li class="list__item"><a href="#actionstructure">Action structure</a></li><li class="list__item"><a href="#actionproperties">Action properties</a></li><li class="list__item"><a href="#constructionparameters">Construction parameters</a></li><li class="list__item"><a href="#enable/disableactioncontrol">Enable/disable action control</a></li><li class="list__item"><a href="#groupstructure">Group structure</a></li><li class="list__item"><a href="#presentation">Presentation</a></li><li class="list__item"><a href="#when&#34;ispopup&#34;istrue:">When "is popup" is true:</a></li><li class="list__item"><a href="#contents">Contents</a></li><li class="list__item"><a href="#modificationsandlabels">Modifications and labels</a></li><li class="list__item"><a href="#actiongroup<...&gt;expression">actionGroup &lt;...&gt; expression</a></li><li class="list__item"><a href="#bootstrapgroups">Bootstrap groups</a></li><li class="list__item"><a href="#touchbarsupportonmacos">Touch Bar Support on MacOS</a></li><li class="list__item"><a href="#displayingprogressindicators">Displaying progress indicators</a></li><li class="list__item"><a href="#keymapchanges">KeyMap Changes</a></li><li class="list__item"><a href="#nondumbawareactions">NonDumbAwareActions</a></li><li class="list__item"><a href="#editortabs">Editor Tabs</a></li><li class="list__item"><a href="#editortabstructure">Editor Tab Structure</a></li><li class="list__item"><a href="#tools">Tools</a></li><li class="list__item"><a href="#toolstructure">Tool structure</a></li><li class="list__item"><a href="#tooloperation">Tool operation</a></li><li class="list__item"><a href="#tabbedtools">Tabbed Tools</a></li><li class="list__item"><a href="#toolstructure">Tool structure</a></li><li class="list__item"><a href="#preferencescomponents">Preferences components</a></li><li class="list__item"><a href="#preferencescomponentstructure">Preferences component structure</a></li><li class="list__item"><a href="#preferencespagestructure">Preferences page structure</a></li><li class="list__item"><a href="#preferencecomponentexpression">PreferenceComponent expression</a></li><li class="list__item"><a href="#custompluginparts(projectplugin,applicationplugin)">Custom plugin parts (ProjectPlugin, ApplicationPlugin)</a></li></ul>   </p>   <p id="f60730ea">Plugin is a way to integrate your code with the MPS IDE functionality.<br> The <i id="7271185c">jetbrains.mps.lang.plugin</i>&nbsp;and <i id="38415621">jetbrains.mps.lang.plugin.standalone</i>&nbsp;languages give you&nbsp;a number of root concepts that can be used in your plugin. This chapter describes all of them.</p>      <h2 id="plugininstantiation">Plugin instantiation</h2>   <p id="cbd2fb75">While developing a plugin, you have a solution holding the plugin and want the plugin classes to be automatically reloadable so as not to have to restart MPS after each change to see its effect. To set the development phase correctly, do the following:</p>   <ol class="list _decimal"><li class="list__item" id="390f9f1d"><p>Create a new solution for your plugin</p></li><li class="list__item" id="16ccf54d"><p>Create a model in this solution named <i id="aac46211">&lt;solution_name&gt;.plugin</i>      </p></li><li class="list__item" id="7b38f71f"><p>Import <i id="15c830af">j.m.lang.plugin</i> and <i id="77b6f6c5">j.m.lang.plugin.standalone</i> languages into the solution and the model</p></li><li class="list__item" id="f3df9582"><p>Create a root <i id="e38790e4">StandalonePluginDescriptor</i>&nbsp;in the model (it comes from the <i id="a514885c">&nbsp;j.m.lang.plugin.standalone</i> language)</p></li><li class="list__item" id="6d7c4165"><p>Set the solution's <i id="0eee1dd9">Solution Kind</i>&nbsp;to <i id="2a057a63">Other</i>         <br>          <figure><a class="lightbox" href="/help/img/idea/2019.2/Plug2.png"><img alt="Plug2" title="Plug2" src="/help/img/idea/2019.2/Plug2.png" id="9b257f99" width="450" height="313"></a></figure>         <br> You can now edit your plugin model and see the changes applied to the current MPS instance just after generation.&nbsp;You can also distribute the solution and have the plugin successfully working for the users.</p></li></ol>      <h2 id="actionsandactiongroups">Actions and action groups</h2>   <p id="779fcfd5">One can add custom actions to any menu in MPS by using <b id="c292ed28">action</b> and <b id="71f01365">action group</b> entities.</p>   <p id="3943b422">An&nbsp;<b id="43bb2957">action</b> describes one concrete action. <b id="c8e2dd73">Action groups</b> are named lists of actions intended for structuring of actions - adding them to other groups and MPS groups (which represent menus themselves) and combining them into popup menus. You can also create groups with dynamically changing contents.</p>   <p id="1af8eca1">How to add new actions to existing groups?</p>   <p id="204a2a45">In order to add new actions to existing groups, the following should be done:</p>   <ol class="list _decimal"><li class="list__item" id="ed76693c"><p>actions should be described</p></li><li class="list__item" id="381fd9b5"><p>described actions should be composed into groups</p></li><li class="list__item" id="86c4a242"><p>these groups should be added to existing groups (e.g. to predefined MPS groups to add new actions to MPS menus).</p></li></ol>   <p id="1904006d">Predefined MPS groups are stored in the <i id="a6767e38">jetbrains.mps.ide.actions</i> model, which is an accessory model to <i id="14cbd914">jetbrains.mps.lang.plugin</i>&nbsp;language, so you don't need to import it explicitly into your model.&nbsp;</p>   <h4 id="actionstructure">Action structure</h4>   <h4 id="actionproperties">Action properties</h4>   <p id="6b22c779">      <b id="b8e945cd">Name</b> - The name of an action. You can give any name you want, the only obvious constraint is that the names must be unique in the scope of the model.</p>   <p id="03d16f70">      <b id="781784e0">Mnemonic -</b> &nbsp;if mnemonic is specified, the action will be available via the <i id="bb04a809">alt+mnemonic</i> shortcut when any group that contains this action is displayed. Note that the mnemonic (if specified) must be one of the chars in action's caption. Mnemonic is displayed as an underlined symbol in the action's <b id="96c688fb">caption</b>.</p>   <p id="6dfe628e">      <b id="5bf77261">Execute outside command -</b> all operations with MPS models are executed within <i id="5cccba10">commands</i>. A <i id="81fe56c3">command</i> is an item in the undo list (you don't control it manually, MPS does it for you), so the user can undo changes brought into the model by action's execution. Also, all the code executed in a command, has read-write access to the model. The catch is that if you show visual dialogs to the user from inside of a command, it can cause a deadlock by blocking while holding the read/write locks. It is thus recommended to have the e<i id="ed9b44c4">xecute outside command</i>&nbsp;option set to false, only&nbsp;if you are not using UI in your action.&nbsp;Otherwise it should be set to true and proper read/write access locking should be performed manually with the&nbsp;<b id="42a1c1fb">read action</b> and <b id="18f8e002">command</b> statements within the action.</p>   <p id="9d2d51c5">      <figure><img alt="Plug1" title="Plug1" src="/help/img/idea/2019.2/Plug1.png" id="1ffff6c1" width="900" height="227"></figure>   </p>   <p id="7c80087f">      <b id="f583b7cb">Also available in</b>&nbsp;- currently, this can only be set to "everywhere", which means the action will not only be available in the context, where you can invoke it through the completion menu, but also in any other context. E.g. if some action is added to the editor context menu group, but the author wants it to be available when the focus is in the logical view, or just when all the editors are closed, "also available in" should be set to "everywhere".</p>   <p id="232ea500">      <b id="cffa5eb9">Caption -</b> the string representing the action in menus</p>   <p id="abaf9743">      <b id="2706bf8e">Description -</b> this string (if specified) will be displayed in the status bar when this action is active (selected in any menu)</p>   <p id="f56d0fce">      <b id="38b1e44f">Icon -</b> this icon will be displayed near the action in all menus. You can select the icon file by pressing the "..." button. Note that the icon must be placed <b id="e907566a">near your language</b> (because it's stored not as an image, but as a path relative to the language's root)</p>   <h4 id="constructionparameters">Construction parameters</h4>   <p id="09734bf5">Each action can be parameterized at construction time using <b id="7530f074">construction parameters</b>. This can be any data determining action's behavior. Thus, a single action that uses construction parameters can represent multiple different behaviors. To manage actions and handle keymaps MPS needs a unique identifier for each concrete behavior represented by an action. So, the&nbsp;<b id="72a1655c">toString</b> function was introduced for each construction parameter (can be seen in the inspector). For primitive types there is no need to specify this function explicitly - MPS can do it automatically. For more complex parameters, you need to write this function explicitly so that for each concrete behavior of an action there is a different set of values returned from the toString() functions.</p>   <h4 id="enable/disableactioncontrol">Enable/disable action control</h4>   <p id="e71a2586">      <b id="68828051">Is always visible flag -</b> if you want your action to be visible even in the disabled state (when the action is not applicable in the current context), set this to true, otherwise to false.</p>   <p id="74547fc9">      <b id="2ea6fa36">Context parameters -</b> specifies which items must be present in the current context for the action to be able to execute. They are extracted from the context before any action's method is executed. Context parameters have conditions associated with them -&nbsp;<b id="6efdee67">required</b>&nbsp;and&nbsp;<b id="3459412d">custom</b>&nbsp;are the two most frequently used ones. If some <b id="d1d96dd9">required</b> parameters were not extracted, the action state is set to <i id="90ea8741">disabled</i> and the&nbsp;<b id="bbd27067">isApplicable/update/execute</b> methods are not executed. If all required action parameters were extracted, you can use their values in all the action methods. <b id="671d99b8">Custom</b>&nbsp;context parameters give you the option to decide whether the context parameter is mandatory on case-by-case basis using the supplied function.</p>   <p id="0744b599">There are 2 types of action parameters - <b id="8ae15946">simple</b> and <b id="7828e148">complex</b> action parameters.</p>   <ul class="list _ul"><li class="list__item" id="0d337664"><p>         <b id="bdb3617a">Simple</b> action parameters (represented by <i id="c67c22c9">ActionDataParameterDeclaration</i>) allow to simply extract all available data from the current data context. The data is provided "by key", so you should specify the <i id="af2f55d7">name</i> and the <i id="a504513e">key</i> in the declaration. The type of the parameter will be set automatically.</p></li><li class="list__item" id="10273304">         <b id="74c60032">Complex</b> action parameters (represented by&nbsp;<i id="120c01c0">ActionParameterDeclaration</i>)&nbsp;were introduced to perform some frequently used checks and typecasts. Now there are 3 types available for the context parameter of this type:<ul class="list _ul"><li class="list__item" id="9d1b9736"><p>               <b id="fa61e82d">node&lt;concept&gt;</b>               <i id="93e337db">-</i> currently selected node, which is an instance of a specified concept. Action won't be enabled, if the selected node isn't an instance of this concept.</p></li><li class="list__item" id="321f7c3a"><p>               <b id="2984f9f3">nlist&lt;concept&gt;</b>               <i id="9667d33e">-</i> currently selected nodes. It is checked that all nodes are instances of the&nbsp;<b id="a3832264">concept</b> (if specified). As with <b id="90bb2b6e">node&lt;concept&gt;</b>, the action won't be enabled if the check fails.</p></li><li class="list__item" id="f68a764d"><p>               <b id="404b59bf">model</b>               <i id="7c9c2f6a">-</i>&nbsp;the current model holding the selected node</p></li></ul>      </li></ul>   <aside class="tip sideblock" data-title="" rel="443e3c6d" id="aee66742">      <p id="afee8680">The available <i id="15b2bdd8">keys</i> that the user can type into the <b id="bfbe2d74">context </b>         <b id="4855303d">parameters</b> declaration are obtained automatically from all imported models. MPS searches the imported models for subclasses of the <i id="9a3e8719">CommonDataKeys</i> (<i id="29a9f7cf">com.intellij.openapi.actionSystem</i>) class. Typical such subclasses are:</p>      <ul class="list _ul"><li class="list__item" id="275c8fe8">            <i id="a35cdef6"></i>         </li><li class="list__item" id="f6c45216"><p>            <i id="e2b4d838">PlatformDataKeys</i> (<i id="e1276107">com.intellij.openapi.actionSystem</i>)</p></li><li class="list__item" id="dd6f668f"><p>            <i id="58d1007c">MPSCommonDataKeys</i> (<i id="2864a0d2">jetbrains.mps.ide.actions</i>)</p></li><li class="list__item" id="462a9dde"><p>            <i id="44e64566">MPSEditorDataKeys</i> (<i id="1a2fcd85">jetbrains.mps.ide.editor</i>)</p></li><li class="list__item" id="f8b1a9f0"><p>            <i id="f0080f62">MPSDataKeys</i> (jetbrains.mps.workbench)</p></li></ul>      <p id="b2956ae8">Be sure to import these models (<i id="82a176b5">Control/Cmd + M</i>) in order to see them in the completion menu for <b id="770b9b0e">context parameters</b>.</p>   </aside>   <p id="970a8eb8">&nbsp;</p>   <p id="4c5df45c">      <b id="7ffe057e">Is Applicable / update</b> - In cooperation with the context parameters, this method controls the&nbsp;<i id="e5de1d15">enabled/disabled</i> state of the action. You can pick either of the two options:</p>   <ul class="list _ul"><li class="list__item" id="1ee1a770"><p>The <b id="7fc139c8">isApplicable</b> method returns the new state of an action</p></li><li class="list__item" id="6c552939"><p>The&nbsp;<b id="e6ffdc0c">update</b> method is designed to update the state manually. You can also update any of your action's properties (caption, icon etc.) by accessing action's presentation via <i id="25d09253">event.getPresentation()</i>.&nbsp;Call the the&nbsp;<i id="d9b113d0">setEnabledState()</i>&nbsp;method on an action to enable or disable it manually.</p></li></ul>   <p id="9ca37c03">These methods are executed only if all&nbsp;<b id="f060a265">required</b>&nbsp;context parameters have been successfully extracted from the context.</p>   <p id="7185453c">Note: The <i id="f4701532">this</i>&nbsp;keyword refers to the current action, use action&lt;...&gt; to get hold of any visible action from your code.</p>   <aside class="tip sideblock" data-title="" rel="7185453c" id="b371334e">      <p id="8ab9df62">Do not use the&nbsp;<i id="f49d2b33">isApplicable()</i>&nbsp;method if you want to modify the presentation manually. Although no errors would be reported from within&nbsp;<i id="384895bf">isApplicable()</i>, it is not guaranteed to work in all cases properly. The <i id="86dc4bad">update()</i> method is a more suitable place for complex presentation manipulations.</p>   </aside>   <p id="bba7f8df">&nbsp;</p>   <p id="171bb722">      <b id="9c104ac5">Execute</b> - this method is executed when the action is performed. It is guaranteed that it is executed only if the action's <b id="ed1cad5e">update</b> method for the same event left the action in active state (or <b id="0a0c123b">isApplicable</b> returned <b id="ab5b1e5d">true</b>) and all the required context parameters are present in the current context and were filled in.</p>   <p id="2922993b">      <b id="28931b77">Methods</b> - in this section you can declare utility methods.</p>   <h4 id="groupstructure">Group structure</h4>   <p id="67453ec5">Group describes a set of actions and provides the information about how to modify other groups with current group.</p>   <h4 id="presentation">Presentation</h4>   <p id="7b94592d">      <b id="01286152">Name -</b> The name of the group. You can give any name you want, the only obvious constraint is that the names must be unique in the scope of the model.</p>   <p id="a5761479">      <b id="4803ab5f">is popup -</b> if this is true, the group represents a popup menu, otherwise it represents a list of actions.</p>   <h4 id="when&#34;ispopup&#34;istrue:">When "is popup" is true:</h4>   <ul class="list _ul"><li class="list__item" id="683809e4"><p>         <b id="4936d415">Caption -</b> string that will be displayed as the name of the popup menu</p></li><li class="list__item" id="6ef2f5f9"><p>         <b id="fc7f6d8c">Mnemonic -</b> if mnemonic is specified, the popup menu will be available via the <i id="ad2b2653">alt+mnemonic</i> shortcut when any group that contains it is displayed. Note that the mnemonic (if specified) must be one of the chars in <b id="a757ccb3">caption</b>. Mnemonic is displayed as an underlined symbol in the popup menu caption.</p></li><li class="list__item" id="933246d0"><p>         <b id="25ac31b6">Is invisible when disabled -</b> if set to true, the group will not be shown in case it has no enabled actions or is disabled manually in the&nbsp;<i id="26a998e7">update()</i>&nbsp;method. Call the <i id="076f68e3">enable()/disable()</i>&nbsp;methods on an action group to enable or disable it manually.</p></li></ul>   <h4 id="contents">Contents</h4>   <p id="cbadab3e">There are 3 possibilities to describe group contents:</p>   <p id="5caa49a9">      <b id="a0129f5b">Element list -</b> this is just a static list of actions, groups and labels (see modifications). The available elements are:</p>   <ul class="list _ul"><li class="list__item" id="26a13139"><p>         <b id="a344b8c6">-&gt;name</b> - an anchors. Anchors are used for modifying one group with another. See <b id="d8472826">Add statement</b> section for details.</p></li><li class="list__item" id="83316f29"><p>         <b id="3499a05c">&lt;---&gt;</b> - separator</p></li><li class="list__item" id="e3beb63f"><p>         <b id="6c6f1468">ActionName[parameters]</b> - an actions.</p></li></ul>   <p id="5322888d">      <b id="8bfe30f1">Build -</b> this alternative should be used in groups, the contents of which is static, but depends on some initial conditions - the group is built once and is not updated ever after. Use the&nbsp;<b id="6747c18e">add</b> statement to add elements inside build block.</p>   <p id="27d3a66d">      <b id="1b923d87">Update -</b> this goes for dynamically changing groups. Group is updated every time right before it is rendered.</p>   <aside class="tip sideblock" data-title="" rel="27d3a66d" id="5f7140ed">      <p id="6a0902b2">In the update/build blocks use the&nbsp;<b id="493795b3">add</b> statement to add group members.</p>   </aside>   <p id="de531b7b">&nbsp;</p>   <h4 id="modificationsandlabels">Modifications and labels</h4>   <p id="f13a7998">      <b id="d414e719">Add to &lt;group&gt; at position &lt;position&gt; -</b> this statement adds the current group to a <i id="aadb1da4">&lt;group&gt;</i> at the given position. Every group has a <i id="804c7880">&lt;default&gt;</i> position, which tells to add the current group to the end of the target group. Some groups can provide additional positions by adding so-called <b id="1a420d4c">anchors</b> into themselves. Adding anchors is described in the&nbsp;<i id="d8fb6606">contents</i> section. The anchor itself is invisible and represents a position, in which a group can be inserted.</p>   <aside class="tip sideblock" data-title="" rel="f13a7998" id="694d27f9">      <ul class="list _ul"><li class="list__item" id="330d745d"><p>You shouldn't care about the group creation order and modifications order - this statement is fully declarative.</p></li><li class="list__item" id="a3e167ea"><p>If A is added into B, B into C, C will contain A</p></li></ul>   </aside>   <h4 id="actiongroup<...&gt;expression">actionGroup <...> expression</h4>   <p id="830a2275">There is a specific expression available in the <i id="bffc5b7c">jetbrains.mps.lang.plugin</i>&nbsp;language&nbsp;to access any registered group - <b id="54315e0e">actionGroup&lt;</b>      <b id="d2de8739">         <i id="fe0e7fd9">group</i>      </b>      <b id="afe85797">&gt;</b> expression.&nbsp;</p>      <h4 id="bootstrapgroups">Bootstrap groups</h4>   <p id="6b4eef82">Bootstrap groups are a way to work with action groups that have been defined outside of MPS (e.g. groups contributed by IDEA or some IDEA plugin).<br> In this case, a bootstrap group is defined in MPS and its internal ID is set to the ID of the external group. After having this done, you can work with the bootstrap group just like with a normal one - insert it into your groups and vice versa.<br> A regular user rarely needs to use bootstrap groups.</p>   <aside class="tip sideblock" data-title="" rel="6b4eef82" id="a7db225b">      <p id="7d0b55a8">A quick and simple tutorial by Federico Tomassetti on how to create action and show it in a context menu is available here:&nbsp;<br>          <a href="http://www.federico-tomassetti.it/tutorial-how-to-add-an-action-to-the-jetbrains-metaprogramming-system/" data-external="true" target="_blank" rel="noopener noreferrer">http://www.federico-tomassetti.it/tutorial-how-to-add-an-action-to-the-jetbrains-metaprogramming-system/</a>      </p>      <p id="2c6d5c74">Please bear in mind that this tutorial uses an older version of MPS and the actual workings in MPS have changed since then, Especially we now recommend to use <b id="19868f4b">plugin solutions</b> instead of the <b id="bfaa615c">plugin aspect</b> of a language to hold your actions. The tutorial may still give you some guidelines and useful insight.</p>   </aside>   <h3 id="touchbarsupportonmacos">Touch Bar Support on MacOS</h3>   <p id="72141d97">Custom user&nbsp;<b id="67f856c1">actions</b>&nbsp;and&nbsp;<b id="0f4c4956">action groups</b>&nbsp;can be added to the&nbsp;<i id="a7c7650d">Touch Bar</i>&nbsp;by adding to one of predefined&nbsp;<b id="bc5790c9">InterfaceGroups</b>:&nbsp;</p>   <ul class="list _ul"><li class="list__item" id="b7b44fe5"><p>IDEATouchBarDefault</p></li><li class="list__item" id="c0f125a9"><p>IDEATouchBarDefault_alt</p></li><li class="list__item" id="4816b058"><p>IDEATouchBarDefault_cmd</p></li><li class="list__item" id="4834fe26"><p>IDEATouchBarDefault_cmd_alt</p></li><li class="list__item" id="9b8e80aa"><p>IDEATouchBarDefault_shift</p></li><li class="list__item" id="fb38095b"><p>IDEATouchBarDebug</p></li></ul>   <h3 id="displayingprogressindicators">Displaying progress indicators</h3>   <p id="f17f4c70">Long-lasting actions should indicate their activity and progress to the user. Check out the <a href="progress-indicators.html">Progress indicators</a> page for details on how to use progress bars, how to allow for cancellation and how to enable actions for running in the background.</p>   <h2 id="keymapchanges">KeyMap Changes</h2>   <p id="8368c56d">The&nbsp;<i id="e8a830a7">KeymapChangesDeclaration</i>&nbsp;concept allows the plugin to assign key shortcuts to individual actions and group them into&nbsp;shortcuts schemes.</p>   <p id="cd5947e8">Any action can have a number of keyboard shortcuts. This can be specified using the <i id="a44af079">KeyMapChanges</i> concept. For a parameterized action, which has a number of "instances" (one instance per parameter value), a function can be specified, which returns different shortcut for a different parameter value.<br> In MPS, there are some "default keymaps", which you can see in <i id="1668680a">Settings-&gt;Keymaps</i>. The <b id="3443b775">for&nbsp;keymap</b>&nbsp;section allows you to specify a keycap that the <i id="24398f09">KeyMapChanges</i>&nbsp;definition is contributing to. E.g. one can set different shortcuts for the same action in the MacOS and the Windows keymaps.</p>   <aside class="tip sideblock" data-title="" rel="cd5947e8" id="af322d28">      <p id="40b227d4">If you add a keyboard shortcut to the <b id="e47ab1e2">Default</b> keymap, all keymaps are altered with this shortcut.</p>   </aside>   <aside class="tip sideblock" data-title="" rel="plugin.xml" id="64e88b8a">      <p id="7beff6a5">Note that by default <i id="8c0b4eb6">ctrl</i> is changed to <i id="45856ea7">cmd</i> in <b id="b02d297a">MacOs keymap</b>. If you want your action to have a <i id="aef687d0">ctrl + something</i> shortcut on MacOs, you should re-define this shortcut for the <b id="4c8264db">MacOs&nbsp;keymap</b>.</p>   </aside>   <p id="bbe8897b">All the actions added by plugins are visible in&nbsp;<b id="c908c8a6">Settings-&gt;Keymap</b>&nbsp;and&nbsp;<b id="41a368f1">Settings-&gt;Menus and Toolbars</b>. This means that any user can customize the shortcuts used for all MPS actions.</p>   <p id="4004fe04">      <figure><img alt="Plug4" title="Plug4" src="/help/img/idea/2019.2/Plug4.png" id="f6965fd4" width="900" height="413"></figure>   </p>   <p id="3a642ad0">A KeyMap Change should be given a name unique within the model, it must specify the <b id="35837913">Keymap</b>&nbsp;that is being altered (or <i id="9b56e4fd">Default</i>&nbsp;to change all keymaps)&nbsp;and then assign a keystroke to actions that should have one. The keystroke can either be <i id="10eabe76">SimpleShortcutChange</i>&nbsp;with a directly specified keystroke or <i id="5e233c52">ParametrizedShortcutChange</i>, which gives you the ability to handle parametrized actions.</p>      <h2 id="nondumbawareactions">NonDumbAwareActions</h2>   <p id="15fdd912">If your action uses platform indices (which is very rare), add it to <i id="17f0a531">NonDumbAwareActions</i>. Those actions will be automatically disabled while the indices are being build.</p>   <h2 id="editortabs">Editor Tabs</h2>   <p id="a34a2926">If you look at any concept declaration you will certainly notice the tabs at the bottom of the editor. You are able to add the same functionality to the concepts from your language.</p>   <p id="afab97f5">What is the meaning of these tabs? The answer is pretty simple - they contain the editors for some <i id="13844053">aspects</i> of the "base" node. Each tab can be either single-tabbed (which means that only one node is displayed in it, e.g. <b id="ef1d43a5">editor</b> tab) or multi-tabbed (if multiple nodes can be created for this aspect of the base node, see the&nbsp;<b id="7934130c">Typesystem</b> tab, for example).</p>   <p id="42a785e7">How the editor for a node is created? When you open some node, call it N, MPS tries to find the "base" node for N. If there isn't any base node, MPS just opens the editor for the selected node. If the node is found (call it B), MPS opens some tabs for it, containing editors for some subordinate nodes. Then it selects the tab for N and sets the top icon and caption corresponding to B.</p>   <p id="98ad5ccf">When you create <b id="a04df471">tabbed editors,</b> you actually provide rules for:</p>   <ul class="list _ul"><li class="list__item" id="d3fd864e"><p>finding the base node</p></li><li class="list__item" id="7d8af303"><p>finding subordinate nodes</p></li><li class="list__item" id="2e1d0b93"><p>optionally an algorithms of subordinate nodes creation</p></li></ul>   <p id="46a57a0e">The tabs that match the requested base concept are displayed and organized depending on their relative order rules specified in their respective <b id="5d7755a4">order constraints</b>&nbsp;sections.</p>   <h4 id="editortabstructure">Editor Tab Structure</h4>   <p id="0345bc13">      <b id="064e53a0">Name -</b> The name of the rule. You can give any name you want, the only obvious constraint is that the names must be unique in the scope of the model.</p>   <p id="1c744bca">      <b id="f5855fe5">Icon</b>&nbsp;-&nbsp;this icon will be displayed in the header of the tab. You can select the icon file by pressing the "..." button. Note that the icon must be placed&nbsp;<b id="75fe500a">near your language</b>&nbsp;(because it's stored not as an image, but as a path relative to the language's root)</p>   <p id="a6b6342a">      <b id="b4e552e2">Shortcut char</b>&nbsp;- a char to quickly navigate to the tab using the keyboard</p>   <p id="b49fb54e">      <b id="2fae758a">Order constraints</b>&nbsp;- an instance of the <i id="9fef0885">Order</i>&nbsp;concept. <i id="0ca7afcb">Orders</i>&nbsp;specify an order, in which the current tab should be displayed relative to the other tabs. You can either refer to an external order or specify one in-place.</p>   <p id="b2eeeafd">      <b id="56ef7a2b">Base node concept -</b>&nbsp;the concept of the <b id="0dff19b1">base</b> node for this as well as all the related tabs.</p>   <p id="6bea4635">      <b id="f7595152">Base Node</b>&nbsp;- this is a rule for searching for the <b id="587e9863">base</b>&nbsp;node given a known node. It should return null, if the <b id="751dd7a3">base</b> node is not found or this <i id="7782f456">TabbedEditor</i> can't be applied.</p>   <p id="8d58daa1">      <b id="0d988bf8">Is applicable</b>&nbsp;- indicates whether the tab can be used for the given <b id="7f6667b0">base</b> node</p>   <p id="0ac3b2f2">      <b id="edc940f8">command</b>&nbsp;- indicated whether the node creation should be performed as a command, i.e. whether it should be undoable and uses no additional UI interaction with the user.</p>   <p id="a36dcf04">      <b id="15e67973">getNode/getNodes -</b>&nbsp;should return the node or a list of nodes to edit in this tab</p>   <p id="0225c1f7">      <b id="0b2e7493">getConcepts</b>&nbsp;- return the concepts of nodes that this tab can be used for to edit</p>   <p id="e423f317">      <b id="6bb0a89c">Create -</b>&nbsp;if specified, this will be executed when user asks to create a new node from this tab. It is given a requested concept and the <b id="2858cd1f">base</b>&nbsp;node as parameters.</p>      <h2 id="tools">Tools</h2>   <p id="8d2addb5">Tool is an instrument that has a graphical presentation and aimed to perform some specific tasks. For example, Usages View, Todo Viewer, Model and Module repository Viewers are all tools. MPS has rich UI support for tools - you can move it by drag-and-drop from one edge of the window to another, hide, show and perform many other actions.</p>   <p id="aa5813b8">Tools are created "per project". They are initialized/disposed on class reloading (after language generation, on "reload all" action etc.)</p>   <h4 id="toolstructure">Tool structure</h4>   <p id="075fa29e">      <b id="d89fcd8e">Name</b> - The name of the tool. You can give any name you want, the only obvious constraint is that the names must be unique in the scope of the model.</p>   <p id="bb6e7e8b">      <b id="22000467">Caption -</b> this string will be displayed in tool's header and on the tool's button in tools pane</p>   <p id="6851ed8b">      <b id="3800494f">Number -</b> if specified, <i id="3b871e9f">alt+number</i> becomes a shortcut for showing this tool (if it s available)</p>   <p id="2c3cd32c">      <b id="ecd88eef">Icon -</b> the icon to be displayed on the tool's button. You can select the icon file by pressing "..." button. Note that the icon must&nbsp;be placed near your language (because it's stored not as an image, but as a path relative to the language's root)</p>   <p id="f7c38775">      <b id="afed98b5">Position</b>&nbsp;- on of <i id="5d70d112">top/bottom/left/right</i> to add the tool to the desired MPS tool bar</p>   <p id="741a24f7">      <b id="ec3f768b">Init -</b> initialize the tool instance here</p>   <p id="fc6ef784">      <b id="d598b466">Dispose -</b> dispose all the tool resources here</p>   <p id="6f0276ac">      <b id="3af32d30">getComponent -</b> should return a Swing component (instance of a class which extends JComponent) to display inside the tool's window. If you are planning to create tabs in your tool and you are familiar with the tools framework in IDEA, it's better to use IDEA's support for tabs. Using this framework greatly improves tabs functionality and UI.</p>   <p id="fb0ae078">      <b id="f966a98e">Fields and methods -</b> regular fields and methods, you can use them in your tool and in the external code.</p>   <h4 id="tooloperation">Tool operation</h4>   <p id="f3941d4f">We added the operation (<i id="64b5fff4">GetToolInProjectOperation</i> concept) to simply access a tool in some project. Use it as <i id="dfbb2294">project.tool&lt;toolName&gt;</i>, where <i id="4b4bd545">project</i> is an IDEA Project. Do not forget to import the&nbsp;<i id="b211311e">jetbrains.mps.lang.plugin.standalone</i>&nbsp;language to be able to use it.</p>   <aside class="note " data-title="" rel="f3941d4f" id="fee41fa6">      <p id="3605f680">This operation can't currently be used in the <i id="2ab08c47">dispose()</i> method</p>   </aside>      <h2 id="tabbedtools">Tabbed Tools</h2>   <p id="37823717">It's same as tool window, but additionally can contain multiple tabs</p>   <h4 id="toolstructure">Tool structure</h4>   <p id="9dc4cacc">      <b id="0116be4d">Name</b>&nbsp;- The name of the tool. You can give any name you want, the only obvious constraint is that the names must be unique in the scope of the model.</p>   <p id="064fd77e">      <b id="d2cebb4e">Caption -</b>&nbsp;this string will be displayed in tool's header and on the tool's button in tools pane</p>   <p id="55070b42">      <b id="8e4c9aec">Number -</b>&nbsp;if specified,&nbsp;<i id="15dbbc3e">alt+number</i>&nbsp;becomes a shortcut for showing this tool (if it s available)</p>   <p id="953699ee">      <b id="74c9d64f">Icon -</b>&nbsp;the icon to be displayed on the tool's button. You can select the icon file by pressing "..." button. Note that the icon must&nbsp;be placed near your language (because it's stored not as an image, but as a path relative to the language's root)</p>   <p id="2c5aa774">      <b id="c6f39d3d">Position</b>&nbsp;- on of&nbsp;<i id="fa939f88">top/bottom/left/right</i>&nbsp;to add the tool to the desired MPS tool bar</p>   <p id="1f9f4e4b">      <b id="9a56f150">Init -</b>&nbsp;initialize the tool instance here</p>   <p id="2c2dc7a1">      <b id="8d28f8a3">Dispose -</b>&nbsp;dispose all the tool resources here</p>   <p id="3e18898d">      <b id="35d7cda6">Fields and methods -</b>&nbsp;regular fields and methods, you can use them in your tool and in the external code.</p>   <h2 id="preferencescomponents">Preferences components</h2>   <p id="23cec57b">Sometimes you may want to be able to edit and save some settings (e.g. your tools' settings) between MPS startups. We have introduced <b id="8cd5d8dc">preferences components</b> for these purposes.</p>   <p id="b3e9c2d2">Each preferences component includes a number of preferences pages and a number of persistent fields.Preferences page is a dialog for editing user preferences. They are accessible through <b id="61007595">File-&gt;Settings</b>.</p>   <p id="dbe8f444">Persistent fields are saved to the <i id="8353febc">.iws</i> files when the project is closed and restored from them on project open. The saving process uses reflection, so you don't need to care about serialization/deserialization in most cases.</p>   <aside class="tip sideblock" data-title="" rel="dbe8f444" id="61221358">      <p id="facc0a4a">Only primitive types and non-abstract classes can be used as types of persistent fields. If you want to store some complex data, create a persistent field of type <i id="cb326331">org.jdom.Element</i> (do not forget to import the model <i id="bf73fdfb">org.jdom</i>), annotate it with <i id="aaafa229">com.intellij.util.xmlb.annotations.Tag</i> and serialize/deserialize your data manually after read / before write</p>   </aside>   <h4 id="preferencescomponentstructure">Preferences component structure</h4>   <p id="0733bdcc">      <b id="ae51baef">name -</b> component name. You can give any name you want, the only obvious constraint is that the names must be unique in the scope of the model.</p>   <p id="614ef07e">      <b id="1693e07a">fields</b> - these are the persistent fields. They are initialized before <b id="cdb43013">after read</b> and pages creation, so their values will be correct in every moment they can be accessed. They can have default values specified, as well.</p>   <p id="912b47de">      <b id="992b9588">after read</b>       <b id="9240c7ed">/</b>       <b id="53366b6d">before write -</b> these blocks are used for custom serialization purposes and for applying/collecting preferences, which have no corresponding preferences pages (e.g. tool dimensions)</p>   <p id="cb240db8">      <b id="2d746ad4">pages</b> - preferences pages</p>   <h4 id="preferencespagestructure">Preferences page structure</h4>   <p id="5f3364b6">      <b id="1eeed6cd">name -</b> the string to be used as a caption in <i id="d7d02600">Settings</i> page. The name must be unique within a model.</p>   <p id="ce2409da">      <b id="df2379f6">component</b> - a UI component to edit preferences.</p>   <aside class="tip sideblock" data-title="" rel="ce2409da" id="9fd2a92e">      <p id="57ec19c2">The <i id="66d7aa4a">uiLanguage</i> components can be used here</p>   </aside>   <p id="d45143ab">      <b id="3f943fc7">icon</b> - the icon to show in <i id="74d43218">Settings</i> window. The size of the icon can be up to 32x32</p>   <p id="75605410">      <b id="29132df1">reset</b> - reset the preferences values in the UI component when this method is called.</p>   <p id="50fbf385">      <b id="d23add96">commit</b> - in this method preferences should be collected from the UI component and commited to wherever they are used.</p>   <p id="1e442dc6">      <b id="d0d72fa3">isModified -</b> if this method returns false, <b id="7bdb1b10">commit</b> won't be executed. This is typically useful for preferences pages with long-running commit method.</p>   <h4 id="preferencecomponentexpression">PreferenceComponent expression</h4>   <p id="5a6db007">We added an expression to simply access a <i id="a18e8801">PreferenceComponent</i> in some project. You can access it as <i id="5a1cbbf7">project.preferenceComponent&lt;componentName&gt;</i>, where <i id="1332533c">project</i> is an IDEA Project. Do not forget to import the <i id="2cc35221">jetbrains.mps.lang.plugin.standalone</i>&nbsp;language&nbsp;to use it.</p>   <aside class="note " data-title="" rel="5a6db007" id="64d7ca6b"><p>This operation can't currently be used in the <i id="b628dbcc">dispose()</i> method</p></aside>      <h2 id="custompluginparts(projectplugin,applicationplugin)">Custom plugin parts (ProjectPlugin, ApplicationPlugin)</h2>   <p id="661c2760">Custom plugin parts are custom actions performed on plugin initializing/disposing. They behave exactly like plugins. You can create as many custom plugins for your language as you want. There are two types of custom plugins - project and application custom plugins. The project custom plugin is instantiated once per project, while the application custom plugin is instantiated once per application and therefore it doesn't have a project parameter.</p><div class="last-modified" data-skip-index="skip">Last modified: 30 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="module-dependencies-tool.html">Module Dependencies Tool</a><a class="navigation-links__next" href="progress-indicators.html">Progress indicators</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>