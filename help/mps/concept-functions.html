<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Concept Functions - Help | MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Concept+Functions.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Default</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_jbuilder">JBuilder</option><option data-group="primary" value="primary_mac_os_x">Mac OS X</option><option data-group="primary" value="primary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default">Default</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_jbuilder">JBuilder</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Concept+Functions.html" id="concept-functions.xml">Concept Functions</h1>   <p id="2b753c6d">      <i id="1b1137c6">Concept functions</i> allow language designers to leave hooks for their language users, through which the users can provide code to leverage in the generated code. For example, most of the languages that MPS offers for language design, such as <b id="61aff05f">Editor</b>,&nbsp;<b id="17a5fb7c">Constraints</b> or&nbsp;<b id="476e465d">Intentions</b>, leverage&nbsp;<i id="6fcef6c9">Concept functions</i>:</p>   <p id="a0a30ddc">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf1.png"><img alt="cf1" title="cf1" src="/help/img/idea/2019.2/cf1.png" id="c67e2523" width="500" height="470"></a></figure>   </p>   <p id="f8a36d16">You can also discover their usages down in the&nbsp;<b id="406d5916">Inspector</b> window:</p>   <p id="63d9c7b9">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf2.png"><img alt="cf2" title="cf2" src="/help/img/idea/2019.2/cf2.png" id="996f34d8" width="500" height="470"></a></figure>   </p>   <p id="41ab25dd">      <i id="4394420c">Concept functions</i> are defined in&nbsp;<i id="82a7d4e9">jetbrains.mps.baselanguage</i> and they contain&nbsp;<i id="bab47e01">BaseLanguage</i> code, which upon generation becomes part of the generated Java code. This option can give your DSLs enormous flexibility.</p>   <h2 id="example">Example</h2>   <p id="f15dd4e1">We'll use the Robot Kaja sample project to experiment with <i id="494d99c4">Concept functions</i>. The goal is to allow the&nbsp;<i id="00c2f31d">Script</i> authors to provide a function that will customize the&nbsp;<b id="32641bc1">Trace</b> messages, which are reported to the user through the&nbsp;<i id="da27a936">trace</i> command:</p>   <p id="7c08f8bb">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf3.png"><img alt="cf3" title="cf3" src="/help/img/idea/2019.2/cf3.png" id="b55064ea" width="300" height="574"></a></figure>      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf4.png"><img alt="cf4" title="cf4" src="/help/img/idea/2019.2/cf4.png" id="f89da847" width="300" height="770"></a></figure>   </p>   <p id="6b8ee088">The user will be able to customize the trace messages through a function that receives the original message as a parameter and returns a string that should be displayed instead:</p>   <p id="c1bad14d">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf5.png"><img alt="cf5" title="cf5" src="/help/img/idea/2019.2/cf5.png" id="6e538160" width="300" height="876"></a></figure>      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf6.png"><img alt="cf6" title="cf6" src="/help/img/idea/2019.2/cf6.png" id="172af32f" width="300" height="786"></a></figure>   </p>   <h3 id="definetheconceptfunctionconcept">Define the concept function concept</h3>   <p id="9f2043cd">First, a sub-concept of&nbsp;<i id="080a48d9">ConceptFunction</i> must be created:</p>   <p id="44d73881">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf7.png"><img alt="cf7" title="cf7" src="/help/img/idea/2019.2/cf7.png" id="db249f00" width="500" height="554"></a></figure>   </p>   <p id="145149c0">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf8.png"><img alt="cf8" title="cf8" src="/help/img/idea/2019.2/cf8.png" id="7f354a07" width="500" height="1030"></a></figure>   </p>   <p id="b49a1242">The&nbsp;<b id="1867e8e8">behavior</b> aspect overrides a few methods inherited from&nbsp;<i id="2e632657">ConceptFunction</i>:</p>   <ul class="list _ul"><li class="list__item" id="0d448393"><p>         <i id="ea5462f0">getExpectedReturnType()</i> - declares what type should be returned from the function</p></li><li class="list__item" id="0b1b2c00"><p>         <i id="6e8a7871">getParameterConcepts()</i> - lists the concepts that will represent parameters to this function</p></li><li class="list__item" id="b20c011f"><p>         <i id="9b1af77a">showName()</i> - indicates, whether the name of the function should be displayed in the editor alongside the parameter list and the return type</p></li><li class="list__item" id="fbdcacce"><p>         <i id="65e28103">getName()</i> - the name of the function to display in the editor. As it defaults to the concept alias, you will usually only want to override this if needing a dynamic name</p></li></ul>   <p id="c123ca17">Since&nbsp;<i id="80b5d8f2">MyFunction</i> requires an argument to hold the original trace message value, we also need to create a concept to represent that parameter, which extends the <i id="5188bdc4">ConceptFunctionParameter</i> concept and specifies its type through an overriden <i id="5ace6321">getType()</i>&nbsp;behavior method:</p>   <p id="252de227">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf9.png"><img alt="cf9" title="cf9" src="/help/img/idea/2019.2/cf9.png" id="60b6f606" width="500" height="552"></a></figure>   </p>   <p id="8fcc0670">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf10.png"><img alt="cf10" title="cf10" src="/help/img/idea/2019.2/cf10.png" id="08f4adb4" width="300" height="448"></a></figure>   </p>   <h3 id="addmyfunctiontoscript">Add MyFunction to Script</h3>   <p id="2820d0f9">Once defined, the&nbsp;<i id="1caaaa82">MyFunction</i> concept can be added to&nbsp;<i id="2faa3b4a">Script</i>:</p>   <p id="e5db9a30">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf11.png"><img alt="cf11" title="cf11" src="/help/img/idea/2019.2/cf11.png" id="4d738942" width="300" height="644"></a></figure>   </p>   <p id="f2cab6e5">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf12.png"><img alt="cf12" title="cf12" src="/help/img/idea/2019.2/cf12.png" id="f3c1edb6" width="300" height="878"></a></figure>   </p>   <p id="7eb207fb">This will allow us to edit the function in the&nbsp;<i id="00a2955e">Script</i> editor:</p>   <p id="bd30ebfa">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf16.png"><img alt="cf16" title="cf16" src="/help/img/idea/2019.2/cf16.png" id="1342d06c" width="300" height="786"></a></figure>   </p>   <p id="4091d2e1">When you hit enter, the editor will display the signature of the concept function and you will be able to edit its body:</p>   <p id="92079add">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf17.png"><img alt="cf17" title="cf17" src="/help/img/idea/2019.2/cf17.png" id="7ec47a1c" width="300" height="1218"></a></figure>   </p>   <p id="05ffc596">Notice that the&nbsp;<b id="8831f912">Inspector</b> shows the description messages for the function as well as its parameters, when you place the cursor on the concept function signature.</p>   <h3 id="generatoradjustment">Generator adjustment</h3>   <p id="cd0a3487">The last step that remains is to alter the generator so that the trace message customization can happen. We first need to modify the&nbsp;<i id="d16c4d5b">KajaFrame</i> class, which is a super-class for all the classes that get generated from Robot Kaja&nbsp;<i id="6ae13f2e">Scripts</i>:</p>   <p id="278ce97b">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf15.png"><img alt="cf15" title="cf15" src="/help/img/idea/2019.2/cf15.png" id="45b57f9f" width="500" height="454"></a></figure>   </p>   <p id="27a62940">The&nbsp;<i id="b9944e17">trace()</i> method needs to call the new&nbsp;<i id="15af790a">customizeMessage()</i> method in order to have the original trace message customized. The default implementation of&nbsp;<i id="5f196eaf">customizeMessage()</i> method returns the message without any alteration.</p>   <p id="6e6c492f">The generator template that defines how a class generated for a&nbsp;<i id="580baee2">Script</i> should look like, now has to generate a extra method that will override the&nbsp;<i id="0cdd962f">customizeMessage()</i> method in&nbsp;<i id="9441a46d">KajaFrame</i>:</p>   <p id="4acb922f">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf13.png"><img alt="cf13" title="cf13" src="/help/img/idea/2019.2/cf13.png" id="47afc7ff" width="300" height="1358"></a></figure>   </p>   <p id="cb495aef">The overriding method only gets generated when the concept function exists in the&nbsp;<i id="03c9c23d">Script</i>. The generator uses the body of&nbsp;<i id="9d361a67">myFunction</i> as a body of the generated&nbsp;customizeMessage() method.</p>   <p id="7ed16334">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf14.png"><img alt="cf14" title="cf14" src="/help/img/idea/2019.2/cf14.png" id="1abd45f1" width="300" height="780"></a></figure>   </p>   <p id="665a0fe6">Now the concept function for customizing trace messages should be fully functional:</p>   <p id="6fa1da2d">      <figure><a class="lightbox" href="/help/img/idea/2019.2/cf5.png"><img alt="cf5" title="cf5" src="/help/img/idea/2019.2/cf5.png" id="48b5bda6" width="500" height="876"></a></figure>   </p>   <p id="c09d4925">&nbsp;</p>   <p id="c581a66c">&nbsp;</p><div class="last-modified" data-skip-index="skip">Last modified: 30 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="icon-description.html">Icon description</a><a class="navigation-links__next" href="generic-placeholders-and-generic-comments.html">Generic placeholders and generic comments</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>