<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>编辑器食谱-帮助| MPS</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Editor+cookbook.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索MPS帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected>默认</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_mac_os_x" data-group="primary">Eclipse（Mac OS X）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_mac_os_x" data-group="primary">Mac OS X</option><option value="primary_mac_os_x_10.5_" data-group="primary">Mac OS X 10.5以上</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="secondary_default" data-group="secondary">默认</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_jbuilder" data-group="secondary">JBuilder的</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">Mac OS X 10.5以上</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="editor-cookbook.xml" data-toc="Editor+cookbook.html">编辑食谱</h1>   <p id="c112110f">本文档面向高级语言设计师，应为您提供与MPS编辑器有关的最常见问题的答案。您可能还想阅读<a href="editor.html">编辑器文档</a> ，其中包含有关该主题的详尽信息。</p>   <aside class="tip sideblock" rel="c112110f" id="b5b354f3" data-title="">      <p id="925b51b4">MPS附带的<b id="b99f8016">RobotKaja</b>示例项目可以为您提供一个很好的示例，说明如何构建流畅的类似于文本的投影编辑器。</p>      <p id="85c2163f">您可能还想查看几个屏幕录像，这些录像着重于定义流畅的编辑器：</p>      <ul class="list _ul"><li class="list__item" id="3e8f53f5">            <a href="http://www.youtube.com/watch?v=CFgzzARhJWg" rel="noopener noreferrer" data-external="true" target="_blank">平滑编辑体验</a>         </li><li class="list__item" id="1833f24d">            <a href="http://www.youtube.com/watch?v=SU70DxnNYu0" rel="noopener noreferrer" data-external="true" target="_blank">编辑器中的可选可见性</a>         </li><li class="list__item" id="94bed956">            <a href="http://www.youtube.com/watch?v=xC7aQkFVxy0" rel="noopener noreferrer" data-external="true" target="_blank">使用编辑器组件</a>         </li></ul>      <p id="087e907a"> </p>   </aside>   <p id="ad6853b0">      </p><ul data-skip-index="skip"><li class="list__item"><a href="#howtocreateaneditordefinition">如何创建编辑器定义</a></li><li class="list__item"><a href="#cellsmappedtoproperties,nodesorreferences">单元格映射到属性，节点或引用</a></li><li class="list__item"><a href="#layout">布局</a></li><li class="list__item"><a href="#howtoproperlyindentablockofcode">如何正确缩进一段代码</a></li><li class="list__item"><a href="#enhancingtheeditordefinition">增强编辑器定义</a></li><li class="list__item"><a href="#alias">别名</a></li><li class="list__item"><a href="#uniqueconstraint">唯一约束</a></li><li class="list__item"><a href="#anindentedverticalcollection">缩进的垂直集合</a></li><li class="list__item"><a href="#optionalvisibility">可选的可见性</a></li><li class="list__item"><a href="#definingandreusingstyles">定义和重用样式</a></li><li class="list__item"><a href="#reusingthebaselanguagestyles">重用BaseLanguage样式</a></li><li class="list__item"><a href="#makingproperkeywords">制作适当的关键字</a></li><li class="list__item"><a href="#adjustabstractsyntaxforeasyediting">调整抽象语法以便于编辑</a></li><li class="list__item"><a href="#specify,whichconceptshouldbethedefaultforlists">指定，哪个概念应该是列表的默认值</a></li><li class="list__item"><a href="#makeemptylineshelpfultofurtherediting">使空行有助于进一步编辑</a></li><li class="list__item"><a href="#hidingconceptsfromthecompletionmenu">从完成菜单中隐藏概念</a></li><li class="list__item"><a href="#easynodereplacement">轻松更换节点</a></li><li class="list__item"><a href="#verticalspaceseparators">垂直分隔符</a></li><li class="list__item"><a href="#handlingemptyvaluesinconstants">处理常量中的空值</a></li><li class="list__item"><a href="#horizontallistseparator">水平列表分隔符</a></li><li class="list__item"><a href="#matchingbracesandparentheses">括号和括号匹配</a></li><li class="list__item"><a href="#emptyblocksshouldlookempty">空块应该看起来是空的</a></li><li class="list__item"><a href="#makeemptyconstantseditable">使空常量可编辑</a></li><li class="list__item"><a href="#commoneditorpatterns">常见的编辑器模式</a></li><li class="list__item"><a href="#prependingflagkeywords">前置标志关键字</a></li><li class="list__item"><a href="#appendingparametrizedkeywords">附加参数化关键字</a></li><li class="list__item"><a href="#nodesubstitutionactions">节点替换动作</a></li><li class="list__item"><a href="#substitutionforcustomstringvalues">自定义字符串值的替代</a></li><li class="list__item"><a href="#includingparentstransformactions">包括父母转变行动</a></li><li class="list__item"><a href="#conceptualquestions">概念问题</a></li><li class="list__item"><a href="#extendinganexistingeditor">扩展现有的编辑器</a></li><li class="list__item"><a href="#designaneditorforextension">设计扩展编辑器</a></li><li class="list__item"><a href="#howtoaddarefactoringtothemenu">如何向菜单添加重构</a></li><li class="list__item"><a href="#howtodefinemultipleeditorsforthesameconcept">如何为同一概念定义多个编辑器</a></li><li class="list__item"><a href="#asamplefirst">首先样品</a></li><li class="list__item"><a href="#hints">提示</a></li><li class="list__item"><a href="#editorhintsforeditorcomponents">编辑器组件的编辑器提示</a></li><li class="list__item"><a href="#pushinghintsfromtheide">从IDE推送提示</a></li><li class="list__item"><a href="#howtomanipulateandapplyeditorhintsprogrammatically">如何以编程方式操纵和应用编辑器提示</a></li></ul>   <p></p>   <h2 id="howtocreateaneditordefinition">如何创建编辑器定义</h2>   <p id="4bb5e9c3">MPS为语言设计师提供给设计人员的DSL是围绕单元的概念构建的。语言设计者将编辑器单元组合在一起，并以反映所需最终符号布局的方式将其放置在屏幕上。</p>   <p id="55359010">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-17-45-11.png"><img alt="尼克·奥布拉佐夫斯基2018 10 17 v 17 45 11" title="尼克·奥布拉佐夫斯基2018 10 17 v 17 45 11" src="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-17-45-11.png" id="1f5517ec" width="500" height="1210"></a></figure>   <p></p>   <p id="3565fb43">屏幕底部的检查器窗口可以通过按屏幕右下角的“ <b id="7362a54a">检查器”</b>工具按钮或使用<i id="aafce10f">Alt / Cmd + 2</i>键盘快捷键进行滑动，以显示该单元格的其他样式和布局属性在上面的编辑器中选择。</p>   <p id="b8235ff2">空的编辑器定义显示单个单元格的红色占位符</p>   <p id="1f2ee195">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-55-02.png"><img alt="Sni mek obrazovky 2018 10 17 v 14 55 02" title="Sni mek obrazovky 2018 10 17 v 14 55 02" src="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-55-02.png" id="6884d386" width="300" height="416"></a></figure>   <p></p>   <p id="30b46896">按下<i id="153256dc">Control + Space</i>将提供可以插入的各种类型的编辑器单元。例如， <b id="1051e0ad">常量</b>单元格将显示给定的不可修改的文本标签。</p>   <p id="e1cd55b4">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-59-55.png"><img alt="尼克·奥布拉佐夫斯基（Sni mek obrazovky）2018 10 17 v 14 59 55" title="尼克·奥布拉佐夫斯基（Sni mek obrazovky）2018 10 17 v 14 59 55" src="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-59-55.png" id="5b239179" width="300" height="302"></a></figure>   <p></p>   <p id="f389fe3f">在编辑器定义中，一个空的常量文本如下所示：</p>   <p id="0d904bbc">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/s0.png"><img alt="s0" title="s0" src="/help/img/idea/2019.2/s0.png" id="cac10495" width="300" height="300"></a></figure>   <p></p>   <p id="af69690d">当最终用户使用该编辑器时，编辑器将显示一个空白空间来代替空白常量单元格。</p>   <p id="b531c35b">您可以键入希望常量单元格在运行时显示给用户的任意文本：</p>   <p id="188f64b1">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-15-00-16.png"><img alt="Sni meb obrazovky 2018年10月17日v 15 00 16" title="Sni meb obrazovky 2018年10月17日v 15 00 16" src="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-15-00-16.png" id="ed29f27d" width="300" height="304"></a></figure>   <p></p>   <h3 id="cellsmappedtoproperties,nodesorreferences">单元格映射到属性，节点或引用</h3>   <p id="cecb056b">完成菜单还提供一些单元格，这些单元格将显示节点的属性，子级或引用目标的值。这些单元格通常还允许用户修改显示的值。</p>   <p id="a30b4c61">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-55-16.png"><img alt="尼克·奥布拉佐夫斯基2018 10 17 v 14 55 16" title="尼克·奥布拉佐夫斯基2018 10 17 v 14 55 16" src="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-55-16.png" id="32f8e513" width="300" height="436"></a></figure>   <p></p>   <p id="eb26bdf3">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-55-50.png"><img alt="尼克·奥布拉佐夫斯基2018 10 17 v 14 55 50" title="尼克·奥布拉佐夫斯基2018 10 17 v 14 55 50" src="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-55-50.png" id="8c054901" width="300" height="298"></a></figure>   <p></p>   <h3 id="layout">布局</h3>   <p id="05cd4959">由单个单元格组成的编辑器不是很有用。为了在编辑器定义中合并多个单元<b id="f584969d">格，</b>必须使用<b id="f584969d">集合布局单元格</b> 。MPS提供了三种类型- <b id="385be993">垂直</b> ， <b id="8d82d7dd">水平</b>和<b id="5d07dd6b">缩进</b>集合布局单元。</p>   <p id="bfb1a3fe">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-56-12.png"><img alt="尼克·奥布拉佐夫斯基（Sni mek obrazovky）2018 10 17 v 14 56 12" title="尼克·奥布拉佐夫斯基（Sni mek obrazovky）2018 10 17 v 14 56 12" src="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-56-12.png" id="27780583" width="300" height="410"></a></figure>   <p></p>   <p id="48434000">集合布局单元格将负责放置其包装的单元格：</p>   <p id="5f30aeff">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-56-26.png"><img alt="尼克·奥布拉佐夫斯基（Sni mek obrazovky）2018 10 17 v 14 56 26" title="尼克·奥布拉佐夫斯基（Sni mek obrazovky）2018 10 17 v 14 56 26" src="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-56-26.png" id="8bb55559" width="300" height="404"></a></figure>      <figure><a class="lightbox" href="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-56-51.png"><img alt="尼克·奥布拉佐夫斯基2018 10 17 v 14 56 51" title="尼克·奥布拉佐夫斯基2018 10 17 v 14 56 51" src="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-56-51.png" id="972cc409" width="300" height="406"></a></figure>   <p></p>   <p id="91a098b8">点击<i id="64ef558d">Enter</i>插入和附加单元格：</p>   <p id="dd48ef30">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-57-01.png"><img alt="尼克·奥布拉佐夫斯基（Sni mek obrazovky）2018 10 17 v 14 57 01" title="尼克·奥布拉佐夫斯基（Sni mek obrazovky）2018 10 17 v 14 57 01" src="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-57-01.png" id="f7e15815" width="300" height="402"></a></figure>      <figure><a class="lightbox" href="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-57-15.png"><img alt="尼克·奥布拉佐夫斯基2018 10 17 v 14 57 15" title="尼克·奥布拉佐夫斯基2018 10 17 v 14 57 15" src="/help/img/idea/2019.2/Sni-mek-obrazovky-2018-10-17-v-14-57-15.png" id="1b43de22" width="300" height="432"></a></figure>   <p></p>   <p id="666fd8e5">这样，您可以根据需要插入任意数量的单元格。可以将<b id="7c9594ec">集合布局单元</b>嵌套在其他<b id="41ad0bb3">集合布局单元</b>中。</p>   <p id="77e1ff7d"><b id="73e36185">缩进</b>布局使设计人员可以控制换行位置。在检查器中为单元格设置<i id="9fd0aa06">indent-layout-new-line</i>属性会使单元格最后一行。</p>   <p id="a46e3a35">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/s1.png"><img alt="s1" title="s1" src="/help/img/idea/2019.2/s1.png" id="582d78af" width="300" height="918"></a></figure>   <p></p>   <p id="bc3d4029">下面的单元格将放在下面的行中：</p>   <p id="770b1043">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/s2.png"><img alt="s2" title="s2" src="/help/img/idea/2019.2/s2.png" id="c5d2633d" width="300" height="718"></a></figure>   <p></p>   <p id="7ae45947">同样，设置<i id="429fa679">indent-layout-indent</i>属性将使单元缩进：</p>   <p id="17ab202f">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/s3.png"><img alt="s3" title="s3" src="/help/img/idea/2019.2/s3.png" id="e5a7fd1e" width="300" height="754"></a></figure>   <p></p>   <h3 id="howtoproperlyindentablockofcode">如何正确缩进一段代码</h3>   <p id="99d1bbab">嵌套的代码块通常使用垂直组织的语句的缩进集合表示。在MPS中，如果您希望使体验尽可能地像文本一样，则几乎只能将<i id="4226a58f">缩进版式</i>用于此类集合。<i id="79a7166e">垂直</i>和<i id="d8d43353">水平</i>布局仅应用于位置布局或更多类似图形的布局。</p>   <p id="786f8dba">因此，对于正确缩进的代码块，您需要创建一个<i id="52126fbc">缩进集合</i> （ <i id="2439e471">[</i> <i id="52126fbc">-...-</i> <i id="2439e471">]</i> ）并设置：</p>   <ul class="list _ul"><li class="list__item" id="fd4287e0"><p>         <i id="d2761ec5">indent-layout-new-line-children，</i>以便将每个收集元素（子级）放在新行上</p></li><li class="list__item" id="59af7318"><p>         <i id="98f04e79">indent-layout-indent</i>使整个集合缩进</p></li><li class="list__item" id="9fe372ab"><p>         <i id="ca14f058">indent-layout-new-line</i>在集合后面放置一个<i id="a6171a74">新行标记</i> ，以便下一个节点被放置在集合下面的新行上</p></li><li class="list__item" id="9b0ee22e"><p>         <i id="c95207e4">indent-layout-on-new-line</i>可选地，您可能需要此标志来将整个集合放在新行上，而不是仅将其附加到上一个单元格上</p></li></ul>   <p id="10d5a1cd">      </p><figure><img alt="编辑器15" title="编辑器15" src="/help/img/idea/2019.2/Editor15.png" id="90a4f59e" width="542" height="312"></figure>   <p></p>   <h2 id="enhancingtheeditordefinition">增强编辑器定义</h2>   <h3 id="alias">别名</h3>   <p id="adbb599d">可以为概念定义一个<i id="8ad29ef0">别名</i> ，该<i id="8ad29ef0">别名</i>将在代码完成弹出菜单中表示它们，并使用户可以通过键入别名来插入这些概念的实例。然后， <b id="2aeed044">编辑器</b>可以使用<i id="058e7991">AliasEditorComponent</i>编辑器组件来<i id="058e7991">引用</i>别名的文本。当多个具体概念从抽象父级继承编辑器并且别名用于在视觉上区分多个概念时，这特别有用。</p>   <p id="282ac2c0">      </p><figure><img alt="编辑器101" title="编辑器101" src="/help/img/idea/2019.2/Editor101.png" id="faef06fe" width="494" height="151"></figure>   <p></p>   <p id="ce2bb45a">      </p><figure><img alt="编辑器102" title="编辑器102" src="/help/img/idea/2019.2/Editor102.png" id="8022d12b" width="494" height="152"></figure>   <p></p>   <p id="4fa960de">      </p><figure><img alt="编辑器103" title="编辑器103" src="/help/img/idea/2019.2/Editor103.png" id="b8013d77" width="656" height="133"></figure>   <p></p>   <p id="7716afad">然后，您可以通过<i id="6616c0dd">conceptAlias</i>属性引用别名值：</p>   <p id="f15d05fa">      </p><figure><img alt="编辑器104" title="编辑器104" src="/help/img/idea/2019.2/Editor104.png" id="d81568b5" width="573" height="86"></figure>   <p></p>   <h3 id="uniqueconstraint">唯一约束</h3>   <p id="3e4d4e84">通常，约束允许您限制属性的角色和值中允许的节点，并向用户报告违规情况。</p>   <p id="387b6939">      </p><figure><img alt="编辑器41" title="编辑器41" src="/help/img/idea/2019.2/Editor41.png" id="2482d739" width="211" height="122"></figure>       <figure><img alt="编辑器43" title="编辑器43" src="/help/img/idea/2019.2/Editor43.png" id="c81f0cb3" width="168" height="92"></figure>   <p></p>   <p id="db0fd1fb">通常，您想应用约束来限制代码中的允许值。例如，方法定义的名称应该唯一，每个库只能导入一次，等等。MPS提供了两种选择：</p>   <ol class="list _decimal"><li class="list__item" id="9687bcfb"><p>使用<i id="5288f322">约束</i> -这些<i id="5288f322">约束</i>为您的语言的抽象语法（结构）定义了严格的有效性规则。如果您要禁止将某些节点或属性纳入AST，请使用它们。</p></li><li class="list__item" id="a9211669"><p>使用<i id="5345dee7">NonTypesystemRules-</i>这些提供附加级别的模型验证。仍然允许您在编辑器中输入不正确的值，但是您会收到一条错误消息和红色下划线，通知您有关规则违例的信息。与<i id="3e5fa5f8">约束</i>不同，您还可以指定带有其他详细信息的自定义错误消息，以为开发人员提供有用的提示。</p></li></ol>   <p id="9c119467">      <i id="d1468485">约束条件</i>      <br>       </p><figure><img alt="编辑器42" title="编辑器42" src="/help/img/idea/2019.2/Editor42.png" id="5dda73a8" width="726" height="157"></figure>      <br>       <i id="36178082">NonTypesystemRules</i>      <br>       <figure><img alt="编辑器44" title="编辑器44" src="/help/img/idea/2019.2/Editor44.png" id="606f0ee0" width="769" height="282"></figure>   <p></p>   <h3 id="anindentedverticalcollection">缩进的垂直集合</h3>   <p id="b6803afb">在适用的情况下，缩进布局是首选，而不是垂直/水平布局。要创建缩进的垂直集合，可以创建<i id="b4a6dcc2">包装缩进集合</i> （标记为[--]）并设置</p>   <ol class="list _decimal"><li class="list__item" id="5689dddf"><p>indent-layout-indent：true</p></li><li class="list__item" id="8bacb922"><p>可选：false。 （false表示在扩展代码选择时该集合将是透明的）。</p></li></ol>   <p id="b4dfaa03">然后，在子级集合上使用indent-layout-new-line-children：true。</p>   <h3 id="optionalvisibility">可选的可见性</h3>   <p id="c8df4724"><i id="4e75e966">如果</i>设置了属性，则仅在特定条件下才可见的元素应<i id="4e75e966">显示</i> ：</p>   <p id="edffbad3">      </p><figure><img alt="编辑器16" title="编辑器16" src="/help/img/idea/2019.2/Editor16.png" id="1591e370" width="518" height="436"></figure>   <p></p>   <h3 id="definingandreusingstyles">定义和重用样式</h3>   <p id="078b0306">每个单元格都可以在<i id="170fec8d">Inspector中</i>定义其视觉样式。除了分别定义样式属性外，还可以预定义样式，然后由多种语言重用。</p>   <p id="8ebad790">      </p><figure><img alt="编辑器37" title="编辑器37" src="/help/img/idea/2019.2/Editor37.png" id="1bb73fc1" width="366" height="149"></figure>       <figure><img alt="编辑器38" title="编辑器38" src="/help/img/idea/2019.2/Editor38.png" id="35558faa" width="369" height="117"></figure>      <br>您可以定义自己的样式并使它们成为编辑器模块的一部分，以便可以在您的编辑器以及导入您的编辑器模块的所有编辑器中使用它们。<p></p>   <p id="9bc6b295">      </p><figure><img alt="编辑器39" title="编辑器39" src="/help/img/idea/2019.2/Editor39.png" id="8eaaac07" width="395" height="222"></figure>   <p></p>   <h3 id="reusingthebaselanguagestyles">重用BaseLanguage样式</h3>   <p id="4646e6f3">BaseLanguage带有丰富的预定义样式集合。为了能够使用另一种语言定义的样式，您需要做的就是将语言导入到<b id="386e19b2">您的语言</b>的<b id="386e19b2">编辑器中</b> 。</p>   <p id="6822a834">      </p><figure><img alt="编辑器40" title="编辑器40" src="/help/img/idea/2019.2/Editor40.png" id="b227e102" width="500" height="599"></figure>   <p></p>   <h3 id="makingproperkeywords">制作适当的关键字</h3>   <p id="219fe91b">关键字应应用<i id="a3823870">关键字</i>样式，以便在文本中突出显示。同样，使关键字<i id="d4a89a5d">可编辑</i>将确保用户可以在关键字的内部或旁边自由键入并应用转换。如果将<i id="05595416">editable</i>设置为<i id="ffe8a30f">false，则</i> MPS会干扰用户的输入并忽略与任何适用的转换都不匹配的字符。</p>   <p id="38e436fe">      </p><figure><img alt="编辑器18" title="编辑器18" src="/help/img/idea/2019.2/Editor18.png" id="e418a3bd" width="770" height="291"></figure>   <p></p>   <h3 id="adjustabstractsyntaxforeasyediting">调整抽象语法以便于编辑</h3>   <p id="3b56a274">使所有概念都从同一（抽象）概念衍生而来，使您可以在容器内以任何顺序混合和匹配这些概念的实例，从而为用户提供非常类似于文本的体验。此外，如果您包括空行和（行）注释的概念，则将使您的用户可以自由地将注释和空行放置在他们认为合适的任何位置。</p>   <p id="cac3ad95">      </p><figure><img alt="编辑器2" title="编辑器2" src="/help/img/idea/2019.2/Editor2.png" id="fe6ea0de" width="864" height="436"></figure>   <p></p>   <p id="9c830a64">在我们的示例中， <i id="248912ed">SStructureContainer</i>不强加任何应放置成员的顺序。所有允许的元素都从<i id="c2a609a4">SStructurePart继承</i> ，所有允许的子元素也都从<i id="c2a609a4">SStructurePart继承</i> 。</p>   <h3 id="specify,whichconceptshouldbethedefaultforlists">指定，哪个概念应该是列表的默认值</h3>   <p id="29d10611">当您在文本编辑器中<i id="f3cb0715">按Enter键</i>时，您会得到一个新行。同样，当用户按下<i id="bcabef69">Enter键</i>时，您可能希望将<i id="018fc301">空行概念</i>或其他合理的默认语言概念添加到当前光标位置的列表中。</p>   <p id="6857b6e6">下面的第二张图片中的行为应优于第一张图片中的行为：</p>   <p id="f429b631">      </p><figure><img alt="编辑器5" title="编辑器5" src="/help/img/idea/2019.2/Editor5.png" id="9c4ffc86" width="634" height="119"></figure>   <p></p>   <p id="384bf996">      </p><figure><img alt="编辑器6" title="编辑器6" src="/help/img/idea/2019.2/Editor6.png" id="ec25c696" width="546" height="99"></figure>   <p></p>   <p id="25013184">红色占位符由位置中缺少节点或<b id="c9774830">抽象概念</b>的实例引起。由于不应实例化抽象概念，因此编辑器始终以红色显示它们。</p>   <p id="67c75c10">当用户在集合单元上单击Enter时，将创建一个新节点并将其插入到集合中。新创建和插入的节点的概念与集合的声明概念相同。如果该概念是<b id="524ad814">抽象的</b> ，则新创建并插入的节点将是该抽象概念的实例，并因此呈现为红色。</p>   <p id="0920df50">有三种方法可以防止这种情况：</p>   <ol class="list _decimal"><li class="list__item" id="9a16723a"><p>使用非抽象概念来声明子集合的概念。<i id="2ffcc0d5">BaseLanguage</i>将这种方法用于<i id="414c2227">Statement</i> ，这是所有语句的通用超级概念，并且不是抽象的以表示空行。</p></li><li class="list__item" id="3cc8d5a7"><p>在抽象概念的<i id="caa05ee8">约束</i>中指定<b id="b5219d29">默认的具体</b>概念。每当抽象实例被实例化时，它将使用指定的具体概念。然后，将这种具体概念用作空行的概念。</p></li><li class="list__item" id="3ad1a125"><p>在所有集合上使用<b id="d97a8dbf">元素工厂</b> ，在其中应使用与抽象概念不同的<b id="d97a8dbf">元素</b>来创建新插入的节点（如下所述）。</p></li></ol>   <p id="135e39cd">指定默认概念就像设置集合编辑器的<i id="036e5f5e">element factory</i>属性一样容易：</p>   <p id="7edfe29e">      </p><figure><img alt="编辑器3" title="编辑器3" src="/help/img/idea/2019.2/Editor3.png" id="dcd3f27a" width="507" height="685"></figure>   <p></p>   <h3 id="makeemptylineshelpfultofurtherediting">使空行有助于进一步编辑</h3>   <p id="e15ad46a"><i id="41518f9a">按下Enter键</i>后，使空行显示为默认值是模仿文本编辑器行为的重要的第一步。使您更加接近的下一步是使空行对用户输入做出合理反应，并提供方便的代码完成功能。</p>   <p id="66eabb18">      </p><figure><img alt="编辑器25" title="编辑器25" src="/help/img/idea/2019.2/Editor25.png" id="deb9346e" width="461" height="450"></figure>      <br>您应该使空行类似于上面的空行-添加一个空的<i id="71b8fda5">常数</i>单元格，使其<i id="c0cbb887">可编辑，</i>并指定所有项目的<b id="ab5b4141">超类型</b>以填充<i id="f1db036b">代码完成</i>菜单。如果您遵循了先前的建议，并且拥有了所有概念（可以接上空行的位置），并且该概念起源于一个共同的祖先，那么您将从中受益。指定该祖先作为可能替换空行的概念。<p></p>   <h3 id="hidingconceptsfromthecompletionmenu">从完成菜单中隐藏概念</h3>   <p id="3be08d32">可以使用<a href="transformation-menu-language.html">转换菜单语言</a>自定义完成菜单。默认情况下，它显示可以在当前位置替换的所有非抽象概念。一些概念，例如空行或注释，您可能希望明确地从完成菜单中排除。为此，您需要在语言的编辑器方面为相关概念或其超级概念定义一个<i id="ce8e5c1f">默认替代菜单</i> ，并将其留空。只要考虑将您的概念替换，MPS就会使用该菜单用项目填充完成菜单。将菜单留空会导致您的概念永远不会插入到完成菜单中。</p>   <h3 id="easynodereplacement">轻松更换节点</h3>   <p id="47294b09">同样，您通常会希望开发人员仅通过键入新元素的名称就可以将一个节点替换为另一个节点：</p>   <p id="8e7c7351">      </p><figure><img alt="编辑器26" title="编辑器26" src="/help/img/idea/2019.2/Editor26.png" id="b09bb24a" width="519" height="212"></figure>      <br>就像用空行一样，要使它起作用，您将替换概念设置为所有适用候选概念的共同祖先。这些将出现在代码完成菜单中。<p></p>   <p id="5b6c5bc8">      </p><figure><img alt="编辑器27" title="编辑器27" src="/help/img/idea/2019.2/Editor27.png" id="a4214e7e" width="456" height="392"></figure>   <p></p>   <h3 id="verticalspaceseparators">垂直分隔符</h3>   <p id="148c694d">为了创建一些垂直空间以分隔元素，使用<i id="459bc8f6">常数</i>单元非常方便。给他们空的内容，将<i id="e09151db">noAttraction</i>设置为焦点使其透明，并使用<i id="c908ef39">indent-layout-new-line</i>将其放在单独<i id="c908ef39">的行上</i> 。</p>   <p id="64f2cdb8">      </p><figure><img alt="编辑器4" title="编辑器4" src="/help/img/idea/2019.2/Editor4.png" id="7ac37505" width="436" height="475"></figure>   <p></p>   <h3 id="handlingemptyvaluesinconstants">处理常量中的空值</h3>   <p id="b9d35acd">属性的值可以保存值，也可以为空。MPS为您提供三个旋钮来调整编辑器，以对空值做出正确反应。根据<i id="596f96ae">allow-empty</i> ， <i id="f1042dc2">text *</i>和<i id="47854dbd">empty text *</i>标志的值，当属性为空时，编辑器单元可能会或可能不会变为红色或显示自定义消息。</p>   <div class="table-wrapper"><table class=" wide" width="100%" id="d09410f7"><thead><tr id="477edac0" class="ijRowHead"><th id="e3e926f8">            <p id="c259728e">不允许为空值。<br>单元格以红色显示以指示错误。</p>         </th><th id="90b55d7f">            <p id="cb9e05f0">               </p><figure><img alt="编辑器19a" title="编辑器19a" src="/help/img/idea/2019.2/Editor19a.png" id="6fcfe16a" width="335" height="57"></figure>            <p></p>         </th><th id="a356673d">            <p id="fcdf7130">               </p><figure><img alt="编辑器19b" title="编辑器19b" src="/help/img/idea/2019.2/Editor19b.png" id="5ac97bf3" width="202" height="107"></figure>            <p></p>         </th></tr></thead><tbody><tr id="99ba060c" class="ijRowOdd"><td id="3b73dd6b">            <p id="4d8bbd00">不允许为空值。<br>自定义消息已提供给空单元格。</p>         </td><td id="d5129317">            <p id="088d1698">               </p><figure><img alt="编辑器24a" title="编辑器24a" src="/help/img/idea/2019.2/Editor24a.png" id="811fe6a7" width="428" height="45"></figure>            <p></p>         </td><td id="a01a7f92">            <p id="bd6c1d63">               </p><figure><img alt="编辑器24b" title="编辑器24b" src="/help/img/idea/2019.2/Editor24b.png" id="766ce32a" width="311" height="100"></figure>            <p></p>         </td></tr><tr id="1d04b534" class="ijRowEven"><td id="63e35531">            <p id="38169ec3">允许为空值。<br>空单元格将以灰色显示默认消息。</p>         </td><td id="07293cb3">            <p id="3d1e07df">               </p><figure><img alt="编辑器20a" title="编辑器20a" src="/help/img/idea/2019.2/Editor20a.png" id="c941ee99" width="362" height="41"></figure>            <p></p>         </td><td id="6a03a7f5">            <p id="975cbd0a">               </p><figure><img alt="编辑器20b" title="编辑器20b" src="/help/img/idea/2019.2/Editor20b.png" id="286c4e9b" width="190" height="103"></figure>            <p></p>         </td></tr><tr id="9c44945f" class="ijRowOdd"><td id="f1bf78ac">            <p id="e01a2224">允许为空值。<br>自定义消息已提供给空单元格。</p>         </td><td id="561c543d">            <p id="cdf087a8">               </p><figure><img alt="编辑器21a" title="编辑器21a" src="/help/img/idea/2019.2/Editor21a.png" id="cf9f989d" width="430" height="45"></figure>            <p></p>         </td><td id="824e9cd8">            <p id="fabdc2af">               </p><figure><img alt="编辑器21b" title="编辑器21b" src="/help/img/idea/2019.2/Editor21b.png" id="c5c6f4c2" width="294" height="100"></figure>            <p></p>         </td></tr><tr id="b6437644" class="ijRowEven"><td id="67b92da0">            <p id="0f9c1df0">允许为空值。<br>空单元格是透明的。</p>         </td><td id="a083b273">            <p id="c14ac735">               </p><figure><img alt="编辑器22a" title="编辑器22a" src="/help/img/idea/2019.2/Editor22a.png" id="623ceef7" width="265" height="40"></figure>            <p></p>         </td><td id="30471c6e">            <p id="ea160089">               </p><figure><img alt="编辑器22b" title="编辑器22b" src="/help/img/idea/2019.2/Editor22b.png" id="ee571fc9" width="185" height="98"></figure>            <p></p>         </td></tr><tr id="880ec8fb" class="ijRowOdd"><td id="49aea554">            <p id="fba0b805">不允许为空值。<br>空值没有默认文本，并标记为红色。</p>         </td><td id="7ab659ab">            <p id="84653c34">               </p><figure><img alt="编辑器23a" title="编辑器23a" src="/help/img/idea/2019.2/Editor23a.png" id="370cf32a" width="260" height="41"></figure>            <p></p>         </td><td id="c401a055">            <p id="6fa131ea">               </p><figure><img alt="编辑器23b" title="编辑器23b" src="/help/img/idea/2019.2/Editor23b.png" id="4903244a" width="173" height="94"></figure>            <p></p>         </td></tr></tbody></table></div>   <h3 id="horizontallistseparator">水平列表分隔符</h3>   <p id="425f840c">收集单元格上的<i id="c8249e0e">spacer</i>属性允许您选择一个字符</p>   <ol class="list _decimal"><li class="list__item" id="3d1311c1"><p>列表中视觉上分开的元素</p></li><li class="list__item" id="c76e6d22"><p>允许用户在列表中追加或插入新元素</p></li></ol>   <p id="cf27956b">      </p><figure><img alt="编辑器7" title="编辑器7" src="/help/img/idea/2019.2/Editor7.png" id="2f1582ad" width="386" height="292"></figure>       <figure><img alt="编辑器8" title="编辑器8" src="/help/img/idea/2019.2/Editor8.png" id="cf489021" width="690" height="228"></figure>   <p></p>   <p id="a4923522">尽管分隔符可以是任何字符串值，但将它们保持为一个字符长度更为方便。</p>   <h3 id="matchingbracesandparentheses">括号和括号匹配</h3>   <p id="03572669">使用<i id="80272d72">matching-label</i>属性将括号和括号配对。这使用户能够快速可视化包装的代码块及其边界：</p>   <p id="4919becc">      </p><figure><img alt="编辑器9" title="编辑器9" src="/help/img/idea/2019.2/Editor9.png" id="3868c158" width="456" height="113"></figure>       <figure><img alt="编辑器10" title="编辑器10" src="/help/img/idea/2019.2/Editor10.png" id="682c43a4" width="362" height="281"></figure>   <p></p>   <p id="a358b1fb">从MPS 3.4开始，您还可以在集合单元上使用<i id="19a80c65">show-boundaries-in</i>样式来指定如何显示其边界。样式具有两个值， <i id="681dded5">装订线</i>和<i id="a3890ecb">装订线编辑器</i> 。如果将集合的样式设置为<i id="587f25e3">gutter-and-editor</i> ，则选中一个单元格时，该集合的第一个和最后一个单元格将在编辑器中突出显示，并在左侧的编辑器中显示括号。将样式设置为<i id="45dd699a">装订线</i>只会显示方括号，如果要显示特定集合的开始和结束位置，但集合中没有明确定义的最后一个单元格，则可能很有用。</p>   <p id="4be45344">例：</p>   <p id="c750af38">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/image2016-7-26-11-7-5.png"><img alt="image2016 7 26 11 7 5" title="image2016 7 26 11 7 5" src="/help/img/idea/2019.2/image2016-7-26-11-7-5.png" id="b60b6a18" width="376" height="752"></a></figure>   <p></p>   <p id="398d802a">结果：</p>   <p id="da7812d0">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/image2016-7-26-11-9-21.png"><img alt="image2016 7 26 11 9 21" title="image2016 7 26 11 9 21" src="/help/img/idea/2019.2/image2016-7-26-11-9-21.png" id="79786ccf" width="245" height="284"></a></figure>   <p></p>   <h3 id="emptyblocksshouldlookempty">空块应该看起来是空的</h3>   <p id="69c72e01">默认情况下，空块始终占据垂直房地产的一行。它还包含一个默认的空单元格，它为开发人员提供了一个提示，提示她可以向其中添加元素。</p>   <p id="1779b084">      </p><figure><img alt="编辑器14" title="编辑器14" src="/help/img/idea/2019.2/Editor14.png" id="cce6bc1c" width="410" height="56"></figure>      <br>您可以通过将<i id="62f88265">空单元格</i>值设置为空<i id="06c56aa4">常量</i>单元格来隐藏<i id="3f7b73da"><< ... >></i>字符，这使您看起来像文本一样：<p></p>   <p id="5a3ef962">      </p><figure><img alt="编辑器11" title="编辑器11" src="/help/img/idea/2019.2/Editor11.png" id="0981a603" width="420" height="54"></figure>   <p></p>   <p id="809a19cf">另一种技巧将完全隐藏空行：</p>   <p id="159f109e">      </p><figure><img alt="编辑器12" title="编辑器12" src="/help/img/idea/2019.2/Editor12.png" id="34ba8caf" width="418" height="36" class="inline-icon-418"></figure>   <p></p>   <p id="893deb73">您需要做的是有条件地更改开括号的<i id="64cbd844">缩进版式新行</i>和<i id="65b75736">标点符号正确的</i>属性，以在括号之后添加/删除新行，并在括号之后将插入符位置的控制权分配给接下来的单元格。由于<i id="43364ced">成员</i>集合的<i id="5c7c2216">空常量单元格</i>紧随其后并且是可编辑的，因此它将在大括号之后的位置接收所有键盘输入。这将使开发人员无需先开始新的空行即可键入内容。</p>   <p id="36197631">      </p><figure><img alt="编辑器fix3" title="编辑器fix3" src="/help/img/idea/2019.2/Editor-fix3.png" id="3d2110ea" width="640" height="365"></figure>   <p></p>   <h3 id="makeemptyconstantseditable">使空常量可编辑</h3>   <p id="b57bb6a6">建议为具有<i id="8902ad55">可编辑</i>属性设置为<i id="bd6ea8de">true的</i>空常量值的集合表示空单元格。这样，用户无需先创建新的集合元素（通过<i id="0da0f43b">Enter</i>或<i id="3894a2d3">分隔符</i> ）就可以开始键入。</p>   <p id="4ac24547">      </p><figure><img alt="编辑器17" title="编辑器17" src="/help/img/idea/2019.2/Editor17.png" id="9d5f9326" width="365" height="128"></figure>   <p></p>   <h2 id="commoneditorpatterns">常见的编辑器模式</h2>   <h3 id="prependingflagkeywords">前置标志关键字</h3>   <p id="fdf3c019">在实际概念之前的标记关键字，例如Java中的<i id="cc350e72">final</i> ， <i id="42b5b938">abstract</i>或<i id="86740642">public</i> ，在编程语言中非常常见。</p>私有抽象类MyCalculator {...}<p id="45a5cdb1">开发人员对如何在代码中添加，修改或删除这些方法抱有某些期望，投影编辑器应遵循一些规则以实现令人愉悦的直观性和便利性。</p>   <ul class="list _ul"><li class="list__item" id="e4deb98d"><p>在主要概念名称左侧的任意位置键入关键字的一部分，应插入关键字</p></li><li class="list__item" id="fde45612"><p>定位在关键字上时按<i id="b152c407">Delete</i>键应将其删除</p></li><li class="list__item" id="fc5a830d"><p>仅当关联的标志为<i id="076c8985">true</i>时，关键字才可见-例如，仅对Java中的<i id="d59d7119">最终</i>类显示<i id="ec504f6c">final</i>关键字</p></li></ul>   <p id="5caf6066">请注意，关键字是可选的， <i id="b1c2ece7">如果</i>有查询条件的基本抽象模型<i id="b1c2ece7">展示</i> 。</p>   <p id="83db4fa0">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Flags1.png"><img alt="标志1" title="标志1" src="/help/img/idea/2019.2/Flags1.png" id="fcd339c0" width="500" height="854"></a></figure>   <p></p>   <p id="b78e3d86"><i id="82b362a0">动作图</i>属性引用一个动作图，该动作图指定在调用<i id="3ae905d4">DELETE</i>动作（也许通过按<i id="0283048a">Delete</i>键）时，应更新底层抽象模型，这又会使flag关键字从屏幕上消失。</p>   <p id="3053152b">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Flags2.png"><img alt="标志2" title="标志2" src="/help/img/idea/2019.2/Flags2.png" id="9d57a7fb" width="500" height="694"></a></figure>   <p></p>   <p id="2b44a7b9">注意， <i id="ff4fed43">aproveDelete</i>调用使用户有机会撤销其删除标志的决定，还可以撤消删除标志后如何定位光标。</p>   <p id="94b4c28d">为了允许开发人员仅通过键入关键字来添加关键字，我们需要定义一个<i id="de6ad812">左变换动作</i> ，在我们的示例中，将其应用于非final元素时，将使该元素在键入“ final”或任何唯一前缀后成为final它的。<i id="6e2c6ffb">转换菜单语言</i>为我们提供了<b id="e8806fe8">转换菜单</b> ，我们可以在这里使用：</p>   <p id="74905668">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Flags3.png"><img alt="标志3" title="标志3" src="/help/img/idea/2019.2/Flags3.png" id="bb588875" width="500" height="1512"></a></figure>   <p></p>   <p id="102eb6fb">然后，可以将<i id="cf31ab33">命名转换菜单</i>附加到标记单元之前或之后的编辑器单元：</p>   <p id="f6691505">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Flags4.png"><img alt="标志4" title="标志4" src="/help/img/idea/2019.2/Flags4.png" id="178eece4" width="500" height="688"></a></figure>   <p></p>   <h3 id="appendingparametrizedkeywords">附加参数化关键字</h3>   <p id="6ea2d9d7">在MPS中，与Java <i id="6789427d">工具</i>类似的支持关键字也非常简单。</p>   <p id="83d746a0">      </p><figure><img alt="编辑器30" title="编辑器30" src="/help/img/idea/2019.2/Editor30.png" id="fa9263bd" width="520" height="133"></figure>      <br>首先，整个<i id="f741dc05">工具A，BC</i>部分必须可选可见。<p></p>   <p id="1af2cd81">      </p><figure><img alt="编辑器36" title="编辑器36" src="/help/img/idea/2019.2/Editor36.png" id="99782eec" width="993" height="395"></figure>      <br>仅当已实现接口的列表为非空时，才会显示包括<i id="58ad3b1d">Implements</i>关键字的集合。<p></p>   <p id="f92859ff">其次，当在类名之后或对<i id="4778c548">扩展</i>类的引用之后键入<i id="5cce650b">工具</i>或其一部分时，我们需要进行正确的转换以将新的子代添加到<i id="8a62992f">工具</i>集合中。同样，当在代码块的左括号之前键入<i id="1d3d1fc2">工具</i>时，需要左变换来添加新的子代。同样， <i id="0577027d">转换菜单语言</i>将使我们创建命名的转换菜单并将其附加到单元格。</p>   <h3 id="nodesubstitutionactions">节点替换动作</h3>   <p id="e563a21d">      <i id="fd339a03">节点替换操作</i>指定如何将某些节点替换为其他节点。例如，您可能想要将逻辑<b id="1c987f3a">和</b>更改为<b id="c43ae378">or</b> ，反之亦然，但保留子节点中指定的布尔条件：</p>   <p id="43ca697c">      </p><figure><img alt="编辑器105" title="编辑器105" src="/help/img/idea/2019.2/Editor105.png" id="6a74524f" width="492" height="90"></figure>      <br>让我们使用来自<i id="82ba5e8f">转换菜单语言的</i> <b id="5115565c">默认替代菜单</b> ：<p></p>   <p id="e0e85149">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Subst1.png"><img alt="替代1" title="替代1" src="/help/img/idea/2019.2/Subst1.png" id="d1f25e17" width="500" height="900"></a></figure>   <p></p>   <p id="d46896b2">      <br>由于<i id="229b7755">And</i>和<i id="25f47c10">Or</i>概念都继承自<i id="a6971158">LogicalOperator</i> ，因此我们可以在操作中引用<i id="0e26a662">LogicalOperator</i> 。本质上，上述操作允许将任何<i id="89747dad">LogicalOperator</i>替换为<i id="89747dad">LogicalOperator</i>的任何<b id="227b0d79">非抽象</b>子<i id="fb7baeca">概念</i> 。实例化了替换概念，并从要替换的节点的子代中填充了其<i id="8b0d8911">左</i>子代和<i id="aefdc1a7">右</i>子代。</p>   <h3 id="substitutionforcustomstringvalues">自定义字符串值的替代</h3>   <p id="b5aa38e7">替换规则也可以用于将纯字符串转换为所需概念的节点。例如，想象一下一种以变量名开头的变量声明，例如在Python中：</p>   <div class="code-block"><code class="code-block__wrapper">myVariable = 10;</code></div>   <p id="dae45fbb">要输入此类变量声明，您始终可以从完成菜单中选择变量概念（通过其别名），然后填写名称：</p>   <p id="4fbf9f26">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/var1.png"><img alt="var1" title="var1" src="/help/img/idea/2019.2/var1.png" id="0e00d56f" width="500" height="264"></a></figure>   <p></p>   <p id="cb77387f">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/var2.png"><img alt="var2" title="var2" src="/help/img/idea/2019.2/var2.png" id="a04791ce" width="300" height="232"></a></figure>   <p></p>   <p id="d04dec75">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/var3.png"><img alt="var3" title="var3" src="/help/img/idea/2019.2/var3.png" id="bb27a0d0" width="300" height="228"></a></figure>   <p></p>   <p id="12f89006">但是，您可以在替换菜单中添加一个简单的替换操作，该操作使用户能够简单地在空行上键入所需的变量名称，并自动为您创建该变量：</p>   <p id="2b515d8e">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/var5.png"><img alt="var5" title="var5" src="/help/img/idea/2019.2/var5.png" id="417d2316" width="300" height="228"></a></figure>   <p></p>   <p id="1ab11b05">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/var6.png"><img alt="var6" title="var6" src="/help/img/idea/2019.2/var6.png" id="931917d2" width="300" height="222"></a></figure>   <p></p>   <p id="25d1b643">菜单可能看起来像这样：</p>   <p id="b380e708">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/var7.png"><img alt="var7" title="var7" src="/help/img/idea/2019.2/var7.png" id="2b43c657" width="500" height="736"></a></figure>   <p></p>   <ol class="list _decimal"><li class="list__item" id="edb488ef"><p>只要输入了非空模式并且与该位置中适用的任何已知子概念的别名都不匹配，就可以替换它</p></li><li class="list__item" id="45e72a03"><p>运行操作并将模式复制到变量名称时，将创建一个新节点</p></li><li class="list__item" id="850dfccc"><p>“选择处理程序”可确保在创建变量后，光标停留在“名称”单元格内，以便用户即使在已创建变量之后也可以继续键入名称（在没有其他选项的情况下立即创建该名称）完成菜单（“选择处理程序”返回null，因为当返回非空节点时，MPS会将光标本身设置在返回的节点上，而忽略“ select”命令）</p></li></ol>   <p id="fddd5381">您还可以尝试检查“ strictly”标志，以进一步自定义行为：</p>   <p id="1e5bf83c">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/var4.png"><img alt="var4" title="var4" src="/help/img/idea/2019.2/var4.png" id="a768c65f" width="500" height="368"></a></figure>   <p></p>   <p id="07e291ce">这是菜单：</p>   <p id="0561ef2e">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/var8.png"><img alt="var8" title="var8" src="/help/img/idea/2019.2/var8.png" id="e47b6b13" width="500" height="990"></a></figure>   <p></p>   <p id="788c12e2">变化：</p>   <ol class="list _decimal"><li class="list__item" id="0b91b597"><p>该<b id="16a0e698">描述</b>提供了定制的描述消息，以显示在完成菜单中的“变量”别名旁边</p></li><li class="list__item" id="0a581716"><p>该<b id="0789860e">模式</b>可确保将到目前为止键入的文本建议为要创建的变量的名称（当可见代码完成菜单时）</p></li><li class="list__item" id="72583789"><p>在<b id="f6049757">可替代</b>的处理程序做出反应，以<i id="39282c87">严格</i>的参数的值，所以只要有这动作也可在菜单，但仅限于非严格匹配等子概念。</p></li></ol>   <p id="4e90d498"> </p>   <aside class="tip sideblock" rel="4e90d498" id="7a0b5fbc" data-title="">      <p id="4d5b013f">当MPS正在检测您的操作是否与到目前为止输入的文本完全匹配时，“严格”参数将设置为“ true”。这使动作能够区分两种情况：</p>      <ol class="list _decimal"><li class="list__item" id="70f14f97"><p>“模式”是操作所做出反应的前缀，因此它希望保留在菜单中</p></li><li class="list__item" id="398adc29"><p>“模式”与操作的反应完全匹配，因此，如果完成菜单中没有其他选项，则应立即触发操作</p></li></ol>      <p id="39c9c7b4">如果您的操作是完成菜单中的唯一项目，并且您的操作的“可以替代”功能（以“ strictly == true”调用）返回true，则执行该操作。通过始终为“ strictly == true”返回“ false”，可以确保操作从不严格（完全）匹配模式，因此仅当用户显式触发操作（Control + Space，Enter）时才创建变量。在那种情况下，“选择处理程序”可以让光标移动到初始化程序，因为无论如何用户已经完成了变量名称的输入。</p>   </aside>   <h3 id="includingparentstransformactions">包括父母转变行动</h3>   <p id="e05be3a1">您的节点可以选择包括适用于不同节点（例如父级）的变换动作。例如，如果我们允许将<b id="b58fa9e4">逻辑和</b>和<b id="dfa231f0">或或</b>附加到逻辑表达式，则当逻辑表达式更复杂且例如其编辑器的最后一个单元属于一个子节点时，我们仍然可能会遇到问题。</p>   <p id="3aee45ca">      </p><figure><img alt="编辑器110" title="编辑器110" src="/help/img/idea/2019.2/Editor110.png" id="f427c43c" width="505" height="115"></figure>      <br>在我们的示例中， <i id="d41eeb59">向南行驶</i>是一个逻辑表达式，但是， <i id="e5ec777c">向南行驶</i>本身是一个逻辑表达式的子代，其概念为<i id="7b741ed5">Direction</i> 。因此，接受<b id="7947a900">和</b> / <b id="61bf42c8">或</b>附加到逻辑表达式的原始权限转换操作在这里将无法工作。我们必须将原始的右变换（适用于<i id="0025dc98">Heading</i> ）动作包括到专门用于<i id="a722fe1b">Direction</i>的新的右变换动作中。<p></p>   <p id="706dedb4">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Inherit1.png"><img alt="继承1" title="继承1" src="/help/img/idea/2019.2/Inherit1.png" id="a607cadc" width="500" height="426"></a></figure>   <p></p>   <h2 id="conceptualquestions">概念问题</h2>   <h3 id="extendinganexistingeditor">扩展现有的编辑器</h3>   <p id="a232596d">MPS编辑器将可视单元格分配给模型中的节点，因此将重新分配核心响应值并接受用户输入的责任委托给节点的概念。无论定义概念所用的语言如何，该机制都将起作用。因此，例如，无论是Java程序的一部分还是电路仿真模型的一部分，诸如数学公式之类的嵌入式语言都将正确呈现自己。</p>   <p id="d3831824">默认情况下，除非有特定的编辑器，否则新的子概念将重新使用其父概念的编辑器。另一方面，扩展语言可以为继承的概念提供自己的编辑器，从而覆盖从继承的编辑器派生的具体语法。</p>   <h3 id="designaneditorforextension">设计扩展编辑器</h3>   <p id="dbb0acfd">一个好的策略是使用<i id="33a7c250">编辑器组件</i>对<i id="33a7c250">编辑器</i>进行模块化。这将允许语言扩展覆盖组件，而不必重新定义编辑器本身。</p>   <p id="3ac0712f">在编辑器中对属性（例如<i id="48c12179">conceptAlias）</i>的引用应优先于硬编码的文字，因为该引用将允许编辑器适应子概念而无需覆盖编辑器。</p>   <p id="7b04e1fb">在指定行为和意图的适用规则时，请记住，某些子概念可能需要从其父项的这些行为中退出。在这种情况下，建议使这些操作在其适用性规则中检查行为方法。</p>   <h3 id="howtoaddarefactoringtothemenu">如何向菜单添加重构</h3>   <p id="a1cee87b">使用<i id="c2204a4f">InlineField</i>或<i id="169b60ad">IntroduceVariable</i>作为很好的例子。通常，您需要从<i id="14205428">jetbrains.mps.lang.plugin</i>语言定义一个<i id="0a493a62">Action</i> ，该<i id="14205428">Action</i>指定其适用性，收集上下文信息和用户输入，初始化实际的重构过程并调用它。重构功能通常被提取到<i id="7f362038">BaseLanguage</i>类中，并可能被多个操作重用。</p>   <h2 id="howtodefinemultipleeditorsforthesameconcept">如何为同一概念定义多个编辑器</h2>   <h3 id="asamplefirst">首先样品</h3>   <p id="fdbffa85">与MPS捆绑在一起的<b id="e79dd91b">MultipleProjections</b>示例项目提供了良好的入门指南，以了解如何为每个概念定义多个编辑器以及如何在它们之间进行切换。</p>   <p id="43437f1d">      </p><figure><img alt="mp1" title="mp1" src="/help/img/idea/2019.2/mp1.png" id="42bc08f9" width="656" height="610"></figure>      <br>示例语言允许您定义由一个或多个状态机组成的工作流。状态机可以结构形式或表形式表示。程序员只需在相应状态机定义的开头键入<i id="d162d932">结构</i>或<i id="b4db3e99">表格即可</i>在用于每个状态机的符号之间切换：<p></p>   <p id="b115d145">      </p><figure><img alt="mp2" title="mp2" src="/help/img/idea/2019.2/mp2.png" id="fb37f8ab" width="1098" height="395"></figure>      <br>该示例包含三种语言和一个沙箱项目。<p></p>   <p id="8329d175">      </p><figure><img alt="mp3" title="mp3" src="/help/img/idea/2019.2/mp3.png" id="db56095b" width="545" height="666"></figure>      <br><i id="56f37b67">requestTracking</i>语言提供了用于包装状态机的概念和根概念，并使用它们来定义简单的工作流。这可以作为需要嵌入状态机语言并允许该嵌入式语言使用其他表示法的语言的示例。<p></p>   <p id="e9d22eb9"><i id="becd77b8">stateMachine</i>语言定义了状态机语言以及默认编辑器的基本概念。它根本没有特定于多个投影的伪影。为了说明MPS中语言扩展的功能，在<i id="8566b6b5">stateMachine.tabular中</i>定义了一些概念的替代编辑器投影，该投影扩展了<i id="7c3914c8">stateMachine</i> 。</p>   <p id="7783f012">      </p><figure><img alt="mp5" title="mp5" src="/help/img/idea/2019.2/mp5.png" id="065567cf" width="525" height="243"></figure>       <figure><img alt="mp4" title="mp4" src="/help/img/idea/2019.2/mp4.png" id="3f8a1920" width="475" height="205"></figure>   <p></p>   <p id="9cbbc16d">虽然<i id="d0f21cdd">stateMachine中</i>指定的默认编辑器使用<i id="d0f21cdd">左上角</i>的<i id="a2fbf2b5">默认</i>值指示默认<i id="a2fbf2b5">设置</i> ，而<i id="166b412d">stateMachine.tabular中</i>的编辑器<i id="166b412d">则</i>指定<i id="65fdb25a">表格</i> <b id="a5114556">提示</b> 。也可以为单个编辑器指定多个提示：</p>   <p id="36e4282a">      </p><figure><img alt="mp6" title="mp6" src="/help/img/idea/2019.2/mp6.png" id="69cbf48f" width="572" height="144"></figure>   <p></p>   <h3 id="hints">提示</h3>   <p id="4563e5c9">选择正确投影的关键要素是<i id="9be85cc7">提示</i> 。编辑者指定，哪些提示将触发它们显示在屏幕上。使用新的<i id="26bb027b">ConceptEditorContextHints</i>概念<b id="3736d7e1">定义</b>提示。</p>   <p id="3ca87bb0">      </p><figure><img alt="mp7" title="mp7" src="/help/img/idea/2019.2/mp7.png" id="e128bb32" width="575" height="178"></figure>   <p></p>   <p id="615e0b71">此概念使您可以为以特定语言或语言扩展识别的每个提示定义<i id="3dd16147">ID</i>和简短描述。因此，在我们的示例项目中， <i id="f5697bab">stateMachine</i>和<i id="0fde0285">stateMachine.tabular</i>都定义了自己的提示集。</p>   <p id="a45632c0">      </p><figure><img alt="mp8" title="mp8" src="/help/img/idea/2019.2/mp8.png" id="ecd73717" width="1128" height="302"></figure>   <p></p>   <p id="fe2101de">还请注意<b id="abb73570">可以用作默认提示</b>标志，可以在检查器中设置该标志。设置为true时，提示可以从IDE推送到编辑器。请参阅“从IDE推送提示”部分中的以下详细信息。</p>   <p id="bf463843">通过定义提示，语言可以为用户提供通过在上下文中<b id="a235cc5a">添加/删除提示</b>来在符号之间切换的功能。示例<i id="84484643">requestTracking</i>语言通过向用户<i id="1243a82c">展示</i>枚举类型的<i id="1243a82c">presentation</i>属性来实现。该属性影响向下传递到<i id="b0ecc83a">状态机</i>编辑器中的提示的集合，如检查器窗口中所指定：</p>   <p id="5c16492e">      </p><figure><img alt="mp9" title="mp9" src="/help/img/idea/2019.2/mp9.png" id="ec643c92" width="1484" height="519"></figure>   <p></p>   <h3 id="editorhintsforeditorcomponents">编辑器组件的编辑器提示</h3>   <p id="eeff9a62">不仅编辑者可以指定提示。<b id="75a7c1fe">覆盖</b>其他编辑器组件的编辑器组件具有相同的功能。</p>   <p id="e8fbab4e">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/HintsInComponents1.png"><img alt="提示InComponents1" title="提示InComponents1" src="/help/img/idea/2019.2/HintsInComponents1.png" id="1ced7de4" width="900" height="504"></a></figure>   <p></p>   <h3 id="pushinghintsfromtheide">从IDE推送提示</h3>   <p id="44e35914">启用了“可以用作默认提示”标志的提示，可以由IDE作为新的默认值推送到编辑器。这使开发人员可以在其IDE中自定义用于不同语言的默认投影。</p>   <p id="2522ff53">自定义投影的一种方法是使用“ <b id="42869c2e">推式编辑器”提示</b> <b id="b2a8e071"><i id="d9fabc3c"> </i></b>在编辑器上下文菜单中单击“操作”，然后选择要作为默认值推送到活动编辑器框架的提示：</p>   <p id="d0f69268">      </p><figure><img alt="mp10" title="mp10" src="/help/img/idea/2019.2/mp10.png" id="24c8c7e8" width="300" height="341"></figure>       <figure><img alt="mp11" title="mp11" src="/help/img/idea/2019.2/mp11.png" id="3473de63" width="358" height="385"></figure>      <br>活动编辑器将使用与所选提示匹配的投影。<p></p>   <p id="69e02f2a">第二个选项是使IDE通过相应的<i id="bb28c867">“设置”</i>面板推送一些提示。然后，这些选择将作为默认首选项应用于所有编辑器窗口。</p>   <p id="e1e3a961">      </p><figure><img alt="mp12" title="mp12" src="/help/img/idea/2019.2/mp12.png" id="870c4678" width="734" height="248"></figure>      <br>您可以考虑将在表示法之间切换的能力与拆分编辑器框架结合在一起。这样，您就可以在同一代码的旁边放置多个不同的投影。您对其中一项所做的更改将立即反映在另一项中：<p></p>   <p id="298a9601">      </p><figure><img alt="mp13" title="mp13" src="/help/img/idea/2019.2/mp13.png" id="d9dfeb77" width="1138" height="639"></figure>   <p></p>   <p id="f0795fb7">右侧面板将<i id="35ebda2e">表式</i>符号推送为默认<i id="35ebda2e">格式</i> ，而左侧面板则没有。两个投影都可视化相同的代码。</p>   <aside class="tip sideblock" rel="f0795fb7" id="228d2f79" data-title="">      <p id="55527c82">您可能希望观看<a href="http://www.youtube.com/watch?v=j1iPF2JjzuU" rel="noopener noreferrer" data-external="true" target="_blank">简短的屏幕录像，以</a>演示实际的示例。</p>   </aside>   <h2 id="howtomanipulateandapplyeditorhintsprogrammatically">如何以编程方式操纵和应用编辑器提示</h2>   <p id="035d0e61">如果要创建自己的UI元素来调整编辑器提示，则需要编写代码来操纵应用于编辑器单元的编辑器提示。<i id="747c0577">EditorContext</i>是用于处理提示的入口点。您需要获取<i id="c41627a2">jetbrains.mps.openapi.editor.update。更新程序</i>接口实现，很可能使用<i id="63fb21dd">EditorComponent.getUpdater（）</i>方法。<i id="b62131d1">Updater</i>界面提供了几种处理提示的方法：</p>   <ul class="list _ul"><li class="list__item" id="38c8933b"><p>         <i id="9cd6cf58">setInitialEditorHints（）</i> -设置编辑器将从编辑器组件层次结构的顶部开始应用到所有组件的提示，除非它们从上下文中显式删除了这些提示，如果提示实际上因此而改变，则返回true操作</p></li><li class="list__item" id="4128a189"><p>         <i id="15275928">getInitialEditorHints（）</i> -获取编辑器应用于所有单元格的提示，可能返回null</p></li><li class="list__item" id="2f1c7182"><p>         <i id="2929db97">addExplicitEditorHintsForNode（）</i> -添加提示以应用于特定节点的编辑器及其嵌入的编辑器</p></li><li class="list__item" id="bd2722c1"><p>         <i id="69991153">removeExplicitEditorHintsForNode-</i>从显式应用于节点的编辑器及其嵌入的编辑器的提示列表中删除指定的提示</p></li><li class="list__item" id="1ade9e9f"><p>         <i id="39e56dd0">getExplicitEditorHintsForNode-</i>获取明确应用于节点的编辑器及其嵌入的编辑器的提示的列表提示，可能返回null</p></li><li class="list__item" id="5839df17"><p>         <i id="b1e90c5f">clearExplicitHints-</i>清除所有编辑器的所有明确指定的提示</p></li></ul>   <p id="e623ae78">为了获得所有应用于特定单元格的提示，包括任何父单元格添加的提示，必须检索<i id="e4a1eb35">CellContext</i> ，最有可能是：<br>   <i id="d46e0abe">editorContext.getEditorComponent（）。getUpdater（）。getCurrentUpdateSession（）。getCellFactory（）。getCellContext（）。getHints（）</i>   </p>   <p id="87fb2036">同样，在更改提示后，需要重新构建编辑器以反映更改。这可以通过<i id="08ff9c78">Updater.update（）</i>方法完成。</p>   <aside class="tip sideblock" rel="87fb2036" id="5a7f3a7b" data-title="">      <p id="413d6704"><b id="9ee03655">multipleProjections</b>示例项目包含三个示例意图，这些意图通过编程方式操纵应用于编辑器的编辑器提示。请查看样本以获取更多详细信息。</p>   </aside><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月30日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="generator-cookbook.html">生成器食谱</a> <a class="navigation-links__next" href="dive-into-plugins-the-plantmps-plugin.html">深入了解插件：PlantMPS插件</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>