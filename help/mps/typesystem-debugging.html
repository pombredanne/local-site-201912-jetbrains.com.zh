<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>类型系统调试-帮助|帮助MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Typesystem+Debugging.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索MPS帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected>默认</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_mac_os_x" data-group="primary">Eclipse（Mac OS X）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_mac_os_x" data-group="primary">Mac OS X</option><option value="primary_mac_os_x_10.5_" data-group="primary">Mac OS X 10.5以上</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="secondary_default" data-group="secondary">默认</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_jbuilder" data-group="secondary">JBuilder的</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">Mac OS X 10.5以上</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="typesystem-debugging.xml" data-toc="Typesystem+Debugging.html">类型系统调试</h1>   <p id="54e3efce">为了调试类型系统，MPS提供了<b id="db8d1dbf">类型系统跟踪</b> -一种集成的可视化工具，可让您深入了解类型系统引擎内部发生的评估过程。</p>   <h2 id="tryitoutforyourself">自己试试吧</h2>   <p id="ad593261">我们准备了一种专用的示例语言，供您轻松尝试类型系统。打开与MPS捆绑在一起的<b id="15e02a40">Expressions</b>示例项目，该示例项目应该在用户主文件夹中的示例项目中可用。</p>   <p id="9cd2ea40">      </p><figure><img alt="tt11" title="tt11" src="/help/img/idea/2019.2/tt11.png" id="e8aab6c6" width="797" height="559"></figure>   <p></p>   <h4 id="thesamplelanguage">示例语言</h4>   <p id="fbf6a83a">实验的语言是一种简化的表达语言，具有几种类型，四种算术运算符（+，-，*，/），赋值（：=），两种类型的变量声明和变量引用。该编辑器非常基础，几乎没有自定义功能，因此编辑表达式可能会很困难。但是，我们希望您检查现有样本并调试其类型，而不是编写新代码，因此，缺少流畅的编辑应该不是问题。</p>   <p id="185b2df4">      </p><figure><img alt="TT1" title="TT1" src="/help/img/idea/2019.2/TT1.png" id="dd39d5c6" width="871" height="567"></figure>      <br>由于使用<i id="18fbfb1c">SimpleMathWrapper</i>概念，该语言可以嵌入Java中，但是该语言与<i id="336e75bc">BaseLanguage</i>之间不可能进行交互。<p></p>   <p id="287e8623">表达式语言支持六种类型，通过将子类型化的规则分为两个分支：</p>   <ol class="list _decimal"><li class="list__item" id="04cb0e4a"><p>元素->数字->浮点数->长整数->整数</p></li><li class="list__item" id="e1fa9bd1"><p>元素->布尔</p></li></ol>   <h2 id="inspectingthetypes">检查类型</h2>   <p id="c987c36b">如果打开<i id="a680fa39">Simple</i>示例类，则可以将光标定位到表达式的任何部分或选择一个有效的表达式块。按下<i id="0edb5d73">Control / Cmd + Shift + T后</i> ，您将在弹出对话框中看到所选节点的类型。</p>   <p id="e3f72108">      </p><figure><img alt="TT2" title="TT2" src="/help/img/idea/2019.2/TT2.png" id="93f5b297" width="455" height="346"></figure>       <figure><img alt="TT3" title="TT3" src="/help/img/idea/2019.2/TT3.png" id="3a66f54d" width="456" height="344"></figure>      <br><i id="a03a93ef">Main</i>示例类将为您提供一个更复杂的示例，展示<b id="3df0a764">Type-inference</b>如何将合适的类型正确传播到变量：<p></p>   <p id="08cb51c2">      </p><figure><img alt="tt4" title="tt4" src="/help/img/idea/2019.2/tt4.png" id="fdcd43ab" width="613" height="399"></figure>      <br>只需自己检查计算出的类型。<p></p>   <h2 id="typeerrors">类型错误</h2>   <p id="71055f83"><i id="8c13944f">TypeError</i>示例类显示了一个简单的类型错误示例。只需取消注释代码（ <i id="c3244d75">Control / Cmd + /</i> ）并检查报告的错误：</p>   <p id="2215d13f">      </p><figure><img alt="tt9" title="tt9" src="/help/img/idea/2019.2/tt9.png" id="2d6859a9" width="363" height="70"></figure>   <p></p>   <p id="c72deefa">由于此变量声明将其类型显式声明为<i id="9553a34d">Int</i> ，而初始化程序的类型为<i id="58fe88b9">Float</i> ，因此类型系统报告错误。您可以检查底部的状态栏，也可以将鼠标悬停在不正确的代码上。</p>   <h2 id="type-systemtrace">类型系统跟踪</h2>   <p id="beb5a109">当您按<i id="706ae806">Control / Cmd + Shift + X</i>或在弹出菜单中导航时，将在右侧显示<i id="bca5b81e">Typesystem Trace</i>面板。</p>   <p id="c00e5019">      </p><figure><img alt="TT6" title="TT6" src="/help/img/idea/2019.2/TT6.png" id="5d29fcff" width="1111" height="634"></figure>      <br><i id="b964aad1">跟踪</i>在<i id="4d235947">面板2中</i>显示了类型系统引擎执行的所有步骤（即，类型系统规则）。这些步骤按执行顺序从上到下排序。<i id="1bf2ffcc">选中“按钮1”后</i> ，“ <i id="eec8ef3a">面板2”会</i>突出显示直接或间接影响在编辑器中选择的节点类型的步骤（ <i id="1e11a0a9">面板1</i> ）。<i id="168ca3e1">面板3</i>详细介绍了在<i id="99366507">面板2中</i>选择的步骤-它描述了在该步骤中对类型系统引擎的状态进行了哪些更改。发动机工作存储器的实际状态显示在<i id="6d42a214">面板4中</i> 。<p></p>   <h2 id="step-by-stepdebugging">分步调试</h2>   <p id="62010337"><i id="e9208c39">简单</i>示例类可能是最容易尝试的一种。按照语言中指定的类型系统规则，可以通过六个步骤来解析类型。您可能想通过按<i id="3eea637c">F4 _或使用_Control / Cmd + N</i> “转到根节点”命令来快速参考这些规则。<i id="0a4d7369">F3</i>将您导航到受当前规则影响的节点。</p>   <p id="a4907951">      </p><figure><img alt="tt7" title="tt7" src="/help/img/idea/2019.2/tt7.png" id="fefdaab6" width="631" height="259"></figure>   <p></p>   <ol class="list _decimal"><li class="list__item" id="d8b38106"><p>变量声明的类型必须是初始化程序类型的超类型。将<i id="16fbac33">aValue</i>变量分配给<i id="29821121">a</i>类型系统变量，将初始值设定项表达式分配给<i id="ee907238">b</i>类型系统变量，然后将<i id="e0de1467">a> = b</i> （b子类型或与a相等的类型）添加到工作内存中。</p></li><li class="list__item" id="1978f180"><p>遵循算术表达式的类型系统规则， <i id="ba47abf9">b</i>必须是<i id="fa645d05">Number</i>的子类型，将<i id="6f66c721">10</i>分配给<i id="805c8a01">c</i>变量，将<i id="4729654c">1.3F</i>分配给<i id="2c4e532a">d</i>变量，并添加一个<i id="1c21873c">when-concrete</i>处理程序以等待<i id="5c93ec15">c</i>到被计算。</p></li><li class="list__item" id="d4443b10"><p>遵循float常数<i id="628c0ac3">d</i>的规则求解为<i id="ad4cab0d">Float</i> 。</p></li><li class="list__item" id="1186b9d1"><p>遵循整数常量的规则<i id="6e3d8c90">c</i>被求解为<i id="6a4b70c5">Int</i> 。这将触发<i id="db19bbfd">时，具体</i>处理器登记在第2步，注册另一个<i id="fad25a88">当混凝土</i>处理程序等<i id="3a6de1be">d。</i>由于<i id="7e301ab8">d</i>已被解析为<i id="d2aad341">Float</i> ，因此处理程序触发并将<i id="355d38a9">b</i> （整个算术表达式）解析为<i id="2d70ebee">Float</i> 。这也解决了<i id="ac5c03ac">b <= Number</i>的早期方程（步骤2）。</p></li><li class="list__item" id="d333bb54"><p>现在<i id="1b5e995b">，</i>可以将a解析为<i id="4575aefc">Float</i> ，这也可以求解<i id="8b836ef2">a> = b</i>的步骤1方程。</p></li><li class="list__item" id="becd5ee9"><p>如果通过按工具栏中的按钮启用<i id="0a26ec10">类型扩展</i> ，则最后一步是将所有节点最终扩展为具体类型。</p></li></ol>   <p id="86d7c17f">      </p><figure><img alt="tt8" title="tt8" src="/help/img/idea/2019.2/tt8.png" id="6b73b085" width="632" height="635"></figure>   <p></p><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月30日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="using-typesystem.html">using_typesystem</a> <a class="navigation-links__next" href="mps-intentions.html">意图</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>