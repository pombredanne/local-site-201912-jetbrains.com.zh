<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Typesystem Debugging - Help | MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Typesystem+Debugging.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Default</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_jbuilder">JBuilder</option><option data-group="primary" value="primary_mac_os_x">Mac OS X</option><option data-group="primary" value="primary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default">Default</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_jbuilder">JBuilder</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Typesystem+Debugging.html" id="typesystem-debugging.xml">Typesystem Debugging</h1>   <p id="54e3efce">For debugging typesystem MPS provides <b id="db8d1dbf">Typesystem Trace</b>&nbsp;- an integrated visual tool that gives you insight into the evaluation process that happens inside the typesystem engine.</p>   <h2 id="tryitoutforyourself">Try it out for yourself</h2>   <p id="ad593261">We prepared a dedicated sample language for you to easily experiment with the typesystem. Open the <b id="15e02a40">Expressions</b>&nbsp;sample project that comes bundled with MPS and should be available among the sample projects in the user home folder.</p>   <p id="9cd2ea40">      <figure><img alt="tt11" title="tt11" src="/help/img/idea/2019.2/tt11.png" id="e8aab6c6" width="797" height="559"></figure>   </p>   <h4 id="thesamplelanguage">The sample language</h4>   <p id="fbf6a83a">The language to experiment with is a simplified expression language with several types, four arithmetic operations (+, -, *, /), assignment (:=), two types of variable declarations and a variable reference. The editor is very basic with almost no customization, so editing the expressions will perhaps be quite rough. Nevertheless, we expect you to inspect the existing samples and debug their types more than writing new code, so the lack of smooth editing should not be an issue.</p>   <p id="185b2df4">      <figure><img alt="TT1" title="TT1" src="/help/img/idea/2019.2/TT1.png" id="dd39d5c6" width="871" height="567"></figure>      <br> The language can be embedded into Java thanks to the <i id="18fbfb1c">SimpleMathWrapper</i>&nbsp;concept, but no interaction between the language and <i id="336e75bc">BaseLanguage</i>&nbsp;is possible.</p>   <p id="287e8623">The expression language supports six types, organized by subtyping rules into two branches:</p>   <ol class="list _decimal"><li class="list__item" id="04cb0e4a"><p>Element -&gt; Number -&gt; Float -&gt; Long -&gt; Int</p></li><li class="list__item" id="e1fa9bd1"><p>Element -&gt; Bool</p></li></ol>   <h2 id="inspectingthetypes">Inspecting the types</h2>   <p id="c987c36b">If you open the <i id="a680fa39">Simple</i>&nbsp;example class, you can position the cursor to any part of the expression or select a valid expression block. As soon as you hit <i id="0edb5d73">Control/Cmd +Shift + T</i>, you'll see the type of the selected node in a pop-up dialog.</p>   <p id="e3f72108">      <figure><img alt="TT2" title="TT2" src="/help/img/idea/2019.2/TT2.png" id="93f5b297" width="455" height="346"></figure>       <figure><img alt="TT3" title="TT3" src="/help/img/idea/2019.2/TT3.png" id="3a66f54d" width="456" height="344"></figure>      <br> The <i id="a03a93ef">Main</i>&nbsp;sample class will give you a more involved example showing how&nbsp;<b id="3df0a764">Type-inference</b>&nbsp;correctly propagates the suitable type to variables:</p>   <p id="08cb51c2">      <figure><img alt="tt4" title="tt4" src="/help/img/idea/2019.2/tt4.png" id="fdcd43ab" width="613" height="399"></figure>      <br> Just check the calculated types for yourself.</p>   <h2 id="typeerrors">Type errors</h2>   <p id="71055f83">The <i id="8c13944f">TypeError</i>&nbsp;sample class shows a simple example of a type error. Just uncomment the code (<i id="c3244d75">Control/Cmd + /</i>) and check the reported error:</p>   <p id="2215d13f">      <figure><img alt="tt9" title="tt9" src="/help/img/idea/2019.2/tt9.png" id="2d6859a9" width="363" height="70"></figure>   </p>   <p id="c72deefa">Since this variable declaration declares its type explicitly to be an <i id="9553a34d">Int</i>, while the initializer is of type <i id="58fe88b9">Float</i>, the type-system reports an error. You may check the status bar at the bottom or hover your mouse over the incorrect piece of code.</p>   <h2 id="type-systemtrace">Type-system Trace</h2>   <p id="beb5a109">When you hit <i id="706ae806">Control/Cmd + Shift + X</i>&nbsp;or navigate through the pop-up menu, you get the <i id="bca5b81e">Typesystem Trace</i>&nbsp;panel displayed on the right hand-side.</p>   <p id="c00e5019">      <figure><img alt="TT6" title="TT6" src="/help/img/idea/2019.2/TT6.png" id="5d29fcff" width="1111" height="634"></figure>      <br> The <i id="b964aad1">Trace</i> shows in <i id="4d235947">Panel 2</i> all steps (i.e. type system rules) that the type-system engine executed. The steps are ordered top-to-bottom in the order in which they were performed.&nbsp;When you have <i id="1bf2ffcc">Button 1&nbsp;_selected</i>, the_ <i id="eec8ef3a">Panel 2</i>&nbsp;highlights the steps that directly or indirectly influence the type of the node selected in the editor (<i id="1e11a0a9">Panel 1</i>). <i id="168ca3e1">Panel 3</i>&nbsp;details the step selected in <i id="99366507">Panel 2</i>&nbsp;- it describes what changes have been made to the type-system engine's state in the step. The actual state of the engine's working memory is displayed in <i id="6d42a214">Panel 4</i>.</p>   <h2 id="step-by-stepdebugging">Step-by-step debugging</h2>   <p id="62010337">The <i id="e9208c39">Simple</i>&nbsp;sample class is probably the easiest one to start experimenting with. The types get resolved in six steps, following the typesystem rules specified in the language. You may want to refer to these rules quickly by pressing <i id="3eea637c">F4&nbsp;_or using the _Control/Cmd + N</i>&nbsp;"Go to Root Node" command. <i id="0a4d7369">F3</i>&nbsp;will navigate you to the node, which is being affected by the current rule.</p>   <p id="a4907951">      <figure><img alt="tt7" title="tt7" src="/help/img/idea/2019.2/tt7.png" id="fefdaab6" width="631" height="259"></figure>   </p>   <ol class="list _decimal"><li class="list__item" id="d8b38106"><p>The type of a variable declaration has to be a super-type of the type of the initializer. The <i id="16fbac33">aValue</i>&nbsp;variable is assigned the <i id="29821121">a</i>&nbsp;type-system variable, the initializer expression is assigned the <i id="ee907238">b</i>&nbsp;type-system variable and <i id="e0de1467">a&gt;=b</i>&nbsp;(b sub-type or equal type to a) is added into the working memory.</p></li><li class="list__item" id="1978f180"><p>Following the type-system rule for Arithmetic Expressions, <i id="ba47abf9">b</i>&nbsp;has to be a sub-type of <i id="fa645d05">Number</i>, the value <i id="6f66c721">10</i>&nbsp;is assigned the <i id="805c8a01">c</i>&nbsp;variable, <i id="4729654c">1.3F</i>&nbsp;is assigned the <i id="2c4e532a">d</i>&nbsp;variable and a <i id="1c21873c">when-concrete</i>&nbsp;handler is added to wait for <i id="5c93ec15">c</i>&nbsp;to be calculated.</p></li><li class="list__item" id="d4443b10"><p>Following the rules for float constants <i id="628c0ac3">d</i>&nbsp;is solved as <i id="ad4cab0d">Float</i>.</p></li><li class="list__item" id="1186b9d1"><p>Following the rules for integer constants <i id="6e3d8c90">c</i>&nbsp;is solved as <i id="6a4b70c5">Int</i>. This triggers the <i id="db19bbfd">when-concrete</i>&nbsp;handler registered in step 2 and registered another <i id="fad25a88">when-concrete</i>&nbsp;handler to wait for&nbsp;<i id="3a6de1be">d</i>. Since <i id="7e301ab8">d</i>&nbsp;has already been resolved to <i id="d2aad341">Float</i>, the handler triggered and resolves&nbsp;<i id="355d38a9">b</i> (the whole arithmetic expression) as <i id="2d70ebee">Float</i>. This also solves the earlier equation (step 2) that <i id="ac5c03ac">b&lt;=Number</i>.</p></li><li class="list__item" id="d333bb54"><p>Now <i id="1b5e995b">a</i>&nbsp;can be resolved as <i id="4575aefc">Float</i>, which also solves the step 1 equation that <i id="8b836ef2">a&gt;=b</i>.</p></li><li class="list__item" id="becd5ee9"><p>If you enable <i id="0a26ec10">type expansions</i>&nbsp;by pressing the button in the tool-bar, you'll get the final expansions of all nodes to concrete types as the last step.</p></li></ol>   <p id="86d7c17f">      <figure><img alt="tt8" title="tt8" src="/help/img/idea/2019.2/tt8.png" id="6b73b085" width="632" height="635"></figure>   </p><div class="last-modified" data-skip-index="skip">Last modified: 30 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="using-typesystem.html">Using_typesystem</a><a class="navigation-links__next" href="mps-intentions.html">Intentions</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>