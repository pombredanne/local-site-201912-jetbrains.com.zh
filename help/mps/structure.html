<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>结构-帮助| MPS</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Structure.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索MPS帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected>默认</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_mac_os_x" data-group="primary">Eclipse（Mac OS X）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_mac_os_x" data-group="primary">Mac OS X</option><option value="primary_mac_os_x_10.5_" data-group="primary">Mac OS X 10.5以上</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="secondary_default" data-group="secondary">默认</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_jbuilder" data-group="secondary">JBuilder的</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">Mac OS X 10.5以上</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="structure.xml" data-toc="Structure.html">结构体</h1>   <p id="2780d581">由于MPS使您无需为目标语言定义语法，因此显然您需要其他方法来指定语言的结构。这是<i id="73a3b207">结构语言</i>派上用场的地方。它为您提供了定义语言结构的所有方法。如前所述，在MPS中进行编码时，您是在直接直接构建AST，因此语言结构需要指定用于构建AST的元素（砖）。</p>   <p id="24cd5a62">这些积木称为<i id="c891194e">概念</i> ， <i id="5d695e0a">结构语言</i>公开<i id="cb65263e">概念</i>和<i id="e0c70dfc">概念接口</i>及其成员： <i id="f1756a65">属性</i> ， <i id="8ca8605c">引用</i>和<i id="ece3d756">子代</i> 。</p>   <p id="8287d127">      </p><figure><img alt="concept1" title="concept1" src="/help/img/idea/2019.2/concept1.png" id="a3fe8df6" width="564" height="389"></figure>   <p></p>      <h2 id="conceptsandconceptinterfaces">概念和概念接口</h2>   <p id="ff5edbe4">现在让我们更详细地看一下。<i id="13dea2f8">概念</i>定义概念实例的结构，将来的AST的节点表示使用您的语言编写的代码。<i id="3863abe0">概念</i>说明节点可能包含哪些属性，可以引用哪些节点以及允许哪些子节点（有关节点的更多信息，请参见“ <a href="basic-notions.html">基本概念”</a>部分）。</p>   <p id="c08afb6a">除<i id="6fa78900">概念外</i> ，还有<i id="e29bc37f">概念接口</i> 。<i id="9c37ab97">概念接口</i>代表独立的特征，可以由许多不同的概念继承和实现。通常，您可以使用它们将正交概念整合到单个概念中。例如，如果您的<i id="c924765f">Concept</i>实例具有一个可以用来标识它的名称，则可以在<i id="79791c9c">Concept中</i>实现INamedConcept接口，您将获得<i id="5eb3d1ad">name</i>属性以及添加到<i id="aad2c76e">Concept中的</i>关联行为和约束。</p>      <h3 id="conceptsinheritance">概念继承</h3>   <p id="d4ef8c67">就像在OO编程中一样，一个<i id="7c1869cc">Concept</i>可以扩展另一个<i id="44456bfb">Concept</i> ，并实现许多<i id="aece1951">Concept接口</i> 。<i id="b2231488">概念接口</i>可以扩展多个其他<i id="eacef28e">概念接口</i> 。该系统类似于Java类，在Java类中，一个类只能具有一个超类，但可以实现许多接口，并且接口可以扩展许多其他接口。</p>   <p id="b8df8ed5">如果一个概念扩展了另一个概念或实现了一个概念接口，则该概念将可继承地继承所有成员（即，如果A具有成员<i id="8588f34e">m</i> ，A由B扩展，并且B由C扩展，则C也具有成员<i id="7092a384">m</i> ）</p>      <h4 id="conceptinterfaceswithspecialmeaning">具有特殊含义的概念界面</h4>   <p id="0730f54a">MPS中有多个概念接口，当通过您的概念实现时，它们具有特殊的含义或行为。以下是最有用的列表：</p>   <div class="table-wrapper"><table width="100%" id="8ac122ee"><thead><tr id="6a0190ef" class="ijRowHead"><th id="6f8a32fc">            <p id="fdf25faa">概念界面</p>         </th><th id="19397034">            <p id="9ee1a849">含义</p>         </th></tr></thead><tbody><tr id="b2e43f97" class="ijRowOdd"><td id="3e85970e">            <p id="bb087b76">可识别的</p>         </td><td id="917cb765">            <p id="bb30990f">如果可以弃用您的概念实例，则使用此方法。它的<i id="a3c7d917">isDeprecated</i>行为方法指示是否不推荐使用该节点。如果目标的<i id="3b077395">isDeprecated</i>返回true，则编辑器为参考单元格设置删除线样式。</p>         </td></tr><tr id="bad688b9" class="ijRowEven"><td id="e948d343">            <p id="94e0792e">INamedConcept</p>         </td><td id="d169ed68">            <p id="451b4aae">如果您的概念实例具有可识别的名称，则使用此选项。此名称出现在代码完成列表中。</p>         </td></tr><tr id="7d28d1af" class="ijRowOdd"><td id="03cc8f21">            <p id="39d4a340">类型</p>         </td><td id="fe3b6dff">            <p id="83ceaed9">用于标记代表类型的所有概念</p>         </td></tr><tr id="c9ed0bf3" class="ijRowEven"><td id="6faf6a2e">            <p id="dedee025">包装器</p>         </td><td id="983e472b">            <p id="1cc058eb">删除其直接父节点是IWrapper实例的节点也将删除父节点。</p>         </td></tr></tbody></table></div>      <h2 id="conceptmembers">概念成员</h2>      <h3 id="properties">性质</h3>   <p id="6b5e9a29">      <i id="6aa09799">属性</i>是存储在概念实例内部的值。每个属性必须具有一个类型，对于属性，该类型仅限于： <i id="167a427e">基本类型</i> ，例如布尔值，字符串和整数； <i id="183706c6">枚举</i> ，可以具有预定义集中的值；和<i id="e9870e62">受约束的数据类型</i> （由正则表达式约束的字符串）。您可以在概念的<b id="b301cc2d"><a href="constraints.html">约束</a></b>中为属性定义获取器和设置器。</p>      <h3 id="references">参考文献</h3>   <p id="648716bd">保持标量值不会太远。为了提高我们语言的表达力，允许节点存储对其他节点的<i id="054b25a7">引用</i> 。每个引用都有一个<i id="152aab7d">名称</i> ， <i id="600a2342">类型</i>和<i id="71f11b7c">基数</i> 。类型限制参考目标的允许类型。基数定义一个节点可以拥有多少这种引用。引用只能具有两种基数：1：0..1和1：1。</p>   <p id="a90e5952">对于参考文献，没有直接的方法可以沿相反的方向进行遍历。的<code class="code">jetbrains.mps.lang.findUsages</code>语言和<code class="code">execute finder</code>应该用于那个。（这些在生成过程中不能可靠地工作）。</p>      <h4 id="smartreferences">智能参考</h4>   <p id="2e22a5c6">包含1：1基数的单个引用且未定义<i id="c9b32f71">别名</i>的节点称为<i id="1de901a0">智能引用</i> 。这些是一些特殊的参考。如果语言作者没有为他们指定别名，他们将尽力对语言用户隐藏并尽可能透明。MPS将该节点视为实际的引用本身，从而简化了代码编辑和代码完成。例如，每当需要完成菜单时，都会创建默认的完成项目：对于每个可能的参考目标，将创建一个菜单项，其中匹配的文本等于目标节点的表示形式。</p>   <p id="1f3e7ac4">为了使引用在不满足上述自动被视为智能的标准的情况下变得智能，必须使用<i id="e671fe22">@smart reference</i>属性对概念声明进行注释：典型的用例是自定义表示形式的概念参考文献或保留其他参考文献。</p>   <p id="7cd58201">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/SmartRef1.png"><img alt="SmartRef1" title="SmartRef1" src="/help/img/idea/2019.2/SmartRef1.png" id="7bdd507d" width="500" height="820"></a></figure>   <p></p>      <h3 id="children">小孩儿</h3>   <p id="7cbd5d2c">要将节点组合成树，我们需要允许子节点与它们挂钩。每个子声明都有一个目标概念，其作用和基数。目标概念指定了孩子的类型。角色指定此子组的名称。最后，基数指定单个节点中可以包含该组中的多少个子级。允许的基数类型有4种：1：1、1：0..1、1：0..n和1：1..n。</p>   <p id="4730943b">以编程方式， <i id="d2654ad0">node.children</i>检索属于当前节点的所有子节点。<i id="df0bb05f">node.children</i>的反向是<i id="493dc336">node.parent</i>或<i id="2ed64534">node.ancestor（s）</i> 。</p>      <h3 id="specializedreferencesandchildren">专门的参考资料和儿童</h3>   <p id="e1b8d5d4">有时，当一个概念扩展到另一个概念时，我们不仅希望继承其所有成员，而且还想覆盖其某些特征。这对于<i id="52dde7d3">孩子和参考专业</i>是可能的。当您对子项或参考项进行专门化时，可以缩小其目标类型。例如，如果您具有扩展了B的概念A，并且在概念C中具有目标类型B的引用r，则可以缩小C的子概念中引用r的类型。对于Concept的子代来说，它的工作方式相同。</p>   <h3 id="alias">别名</h3>   <p id="3124e115">别名，从代码中称为<i id="1194bcea">conceptAlias</i> ，可以选择指定一个字符串，该字符串将被MPS识别为<i id="8c3d0ea1">Concept</i>的表示形式。每当用户键入<i id="f378c163">别名</i>或<i id="f378c163">别名</i>的一部分时， <i id="4fbab5b3">别名</i>将出现在完成框中，并且MPS将实例化<i id="e1deb9f2">Concept</i> 。</p>      <h2 id="constraineddatatypes">约束数据类型</h2>   <p id="5024b5c1">      <i id="31189ac4">约束数据类型</i>允许您定义受正则表达式约束的基于字符串的类型。然后，MPS将确保所有具有此受约束数据类型的属性值都具有与约束匹配的值。</p>   <p id="99c466b8">      </p><figure><img alt="CustomDataType" title="CustomDataType" src="/help/img/idea/2019.2/CustomDataType.png" id="ccb6d2b1" width="419" height="65"></figure>   <p></p>      <h2 id="enumerationds">枚举</h2>   <p id="ee56e854">枚举使您可以定义保存预定义集中的值的属性。</p>   <p id="37ac3967">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/enumt1.png"><img alt="枚举1" title="枚举1" src="/help/img/idea/2019.2/enumt1.png" id="f341a4f0" width="500" height="540"></a></figure>      <br>每个枚举成员都有一个<i id="8a363d2d">名称</i>和一个可选的<i id="3bdde02b">表示形式</i> 。<p></p>   <ul class="list _ul"><li class="list__item" id="1ca63207"><p><b id="dd82d2eb">名称</b> （左列）-此字符串值用于以编程方式引用此成员。</p></li><li class="list__item" id="b118456f"><p><b id="704a91d5">表示形式</b> （右列）-此字符串值用于表示用户模型（完成菜单，编辑器）中的枚举成员。如果未明确定义任何表示，则使用该名称。</p></li></ul>      <p id="bfb26023">除了一组成员之外，每个枚举还可以选择定义默认成员。您可以将默认成员视为存在于所有未明确设置其他值的属性中的隐式值。</p>   <h3 id="programmaticaccess">程序访问</h3>   <p id="1d7c7d3f">访问枚举及其成员编程，使用<i id="5fc5b6ea">枚举操作</i> ，并在<i id="fa3f0878">jetbrains.mps.lang.smodel</i>语言定义的<i id="27420561">enummember</i>类型。</p>   <p id="8bfb0312">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/enumt2.png"><img alt="枚举2" title="枚举2" src="/help/img/idea/2019.2/enumt2.png" id="6ac6af98" width="500" height="366"></a></figure>   <p></p>   <p id="cc12767b">可以查询枚举成员的姓名和演示。可以使用<b id="63937619">is</b>操作完成对照枚举数据类型值检查属性值。</p>   <p id="3d7031c1">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/enumt3.png"><img alt="枚举3" title="枚举3" src="/help/img/idea/2019.2/enumt3.png" id="17379ab3" width="500" height="154"></a></figure>   <p></p>   <p id="9f8d3fb3"><i id="f8baba2d">从名称</i> ， <i id="f3a8bed5">演示</i>和<i id="4e2a5d5d">成员</i>操作方便的枚举使您可以访问成员。</p>   <p id="22cbe6ce">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/enumt4.png"><img alt="枚举4" title="枚举4" src="/help/img/idea/2019.2/enumt4.png" id="c7990efc" width="900" height="192"></a></figure>   <p></p>   <p id="a6a6b115"><i id="21cec55c">枚举开关</i>语句提供了一种方便的控制结构-给定枚举成员，使用枚举开关语句可以轻松切换到特定成员实例：</p>   <p id="05d41c9e">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/enumt5.png"><img alt="枚举5" title="枚举5" src="/help/img/idea/2019.2/enumt5.png" id="b85e4463" width="600" height="276"></a></figure>   <p></p>   <p id="f7c782e8">或<i id="11932d8c">枚举开关</i>表达式：</p>   <p id="2a86b157">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/enumt6.png"><img alt="枚举6" title="枚举6" src="/help/img/idea/2019.2/enumt6.png" id="aa9cf7b2" width="500" height="262"></a></figure>   <p></p>   <p id="4e0023df">如果省略了一些枚举成员，并且未指定<i id="37ed2389">其他</i>分支，则将引发警告，报告非详尽的开关。同样，当单个值在开关中出现多次时，会引发错误。</p>   <p id="87cf4104">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/enumt7.png"><img alt="枚举7" title="枚举7" src="/help/img/idea/2019.2/enumt7.png" id="464b82f5" width="600" height="230"></a></figure>   <p></p>   <h2 id="enumerationdatatypes">枚举数据类型（不建议使用，改为使用枚举）</h2>   <aside class="tip sideblock" rel="enumerationdatatypes" id="2954bf02" data-title=""><p id="fdfc4c26">请查看<a href="https://confluence.jetbrains.com/display/MPS/Migration+of+stucture%27s+enumeration+declarations" rel="noopener noreferrer" data-external="true" target="_blank">有关迁移枚举的文档，</a>以正确迁移旧枚举的重要用法。</p></aside>   <p id="c40144e6">枚举数据类型使您可以使用保留预定义集中的值的属性。</p>   <p id="841d7937">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Enum1.png"><img alt="枚举1" title="枚举1" src="/help/img/idea/2019.2/Enum1.png" id="aecefdc0" width="700" height="586"></a></figure>      <br>每个枚举数据类型成员都有一个<i id="f61c5d19">值</i>和一个<i id="8f336163">presentation</i> 。可选地，可以明确指定<i id="48ab67fe">标识符</i> 。<p></p>   <h3 id="presentationvs.valuevs.identifier">演示文稿，价值与标识符</h3>   <ul class="list _ul"><li class="list__item" id="de5d4459"><p>         <b id="5e5a1e69">Presentation-</b>此字符串值将用于表示UI中的枚举成员（完成菜单，编辑器）</p></li><li class="list__item" id="f480c0db"><p>         <b id="bf19e4e8">值</b> -该值的类型由<b id="ea848e61">成员类型</b>属性设置，将表示代码中的枚举成员</p></li><li class="list__item" id="3b0111f5"><p>         <b id="aa25dca6">标识符</b> -此可选值将用作生成的Java枚举的名称。该值通常是从表示形式或值中得出的，因为它对于语言用户是透明的，并且对语言没有任何意义。仅在id派生过程无法生成唯一的有效标识符时才需要指定它。</p></li><li class="list__item" id="432aed36"><p>         <b id="d35f62c7">名称</b> -从代码访问枚举数据类型的成员时， <b id="80e33658">名称</b>指的是<b id="8fb99dc8">presentation</b> ， <b id="94d06935">value</b>或<b id="3b5e6883">identifier</b> ，具体取决于哪个选项<b id="67c9352b">成员标识符</b>处于活动状态</p></li></ul>   <h3 id="derivingidentifiersautomaticaly">自动导出标识符</h3>   <p id="0424a354">从表示形式或值派生标识符时，MPS会尽最大努力消除Java标识符中不允许的字符。如果多个枚举数据类型成员的派生标识符最终相同，则将报告错误。在这种情况下，应指定显式标识符。</p>   <h3 id="programmaticaccess">程序访问</h3>   <p id="81b2718f">要以编程方式访问枚举数据类型及其成员，请使用<i id="31a2a16e">jetbrains.mps.lang.smodel</i>语言中定义的<i id="c019fed0">枚举操作</i> 。</p>   <p id="00095519">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Enum32.png"><img alt="枚举32" title="枚举32" src="/help/img/idea/2019.2/Enum32.png" id="bd1aa1cc" width="900" height="718"></a></figure>   <p></p>   <aside class="tip sideblock" rel="00095519" id="b56c8260" data-title="">      <p id="7284825a">请注意，上面的<b id="29080268">memberForName</b>和<b id="e9adce41">february.name</b>中的<b id="34c09f3b">名称</b>表示实际的<i id="f1c5bf74">成员标识符</i> ，无论是将其设置为<b id="1dba4134">自定义</b> ， <b id="b858c72a">从表示形式</b> <b id="6b144bdc">派生</b>还是<b id="6b144bdc">从内部值派生</b> 。</p>   </aside>   <p id="025ed9f4">可以使用<b id="6493e23c">is</b>操作完成对照枚举数据类型值检查属性值。要打印出属性值的<b id="7b22bbed">表示形式</b> ，您需要首先获取相应的枚举成员：</p>   <p id="99a44588">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Enum33.png"><img alt="枚举33" title="枚举33" src="/help/img/idea/2019.2/Enum33.png" id="53370cc3" width="900" height="190"></a></figure>   <p></p>   <h2 id="attributes">属性</h2>   <p id="b5250389">属性（有时称为注释）使语言设计人员可以表达正交的语言构造并将其应用于<b id="45a8127e">现有</b>语言，而无需进行修改。例如，生成器模板允许将特殊的生成器标记（例如<i id="b734c3cf">LOOP</i> ， <i id="b908ff4a">-> $</i>和<i id="21ec09f9">$ []）</i>嵌入到目标语言中：</p>   <p id="1ff6a97c">      </p><figure><img alt="发电机1" title="发电机1" src="/help/img/idea/2019.2/Generator1.png" id="c4f4d8a0" width="784" height="294"></figure>      <br>目标语言（此处为我们的示例中的BaseLanguage）不需要了解有关MPS生成器的任何信息，但是可以将生成器宏添加到抽象模型（AST）中并在编辑器中进行编辑。类似地，反引号和模式可以归因于BaseLanguage概念。<p></p>   <p id="a13550c9">MPS提供三种类型的属性：</p>   <ul class="list _ul"><li class="list__item" id="256eeb89"><p>         <i id="16da8b15">LinkAttribute-</i>注释引用</p></li><li class="list__item" id="3b55c28e"><p>         <i id="64994bf8">NodeAttribute-</i>注释单个节点</p></li><li class="list__item" id="d0b9404f"><p>         <i id="f6fbb9e1">PropertyAttribute-</i>注释属性</p></li></ul>   <p id="07e5556f">通过扩展这些内容，您可以向现有语言中介绍自己的附加内容。有关使用中的属性的良好示例，请查看“ <a href="description-comments.html">描述注释”食谱</a>以及“ <a href="requirement-tracking-language.html">需求”跟踪语言食谱</a> 。</p><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月30日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="language-definition.html">语言定义</a> <a class="navigation-links__next" href="editor.html">编辑器</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>