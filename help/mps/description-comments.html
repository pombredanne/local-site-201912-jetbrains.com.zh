<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Description comments - Help | MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Description+comments.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Default</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_jbuilder">JBuilder</option><option data-group="primary" value="primary_mac_os_x">Mac OS X</option><option data-group="primary" value="primary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default">Default</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_jbuilder">JBuilder</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Description+comments.html" id="description-comments.xml">Description comments</h1>   <p id="cd18cb28">We are going to learn how to leverage the capability of adding attributes to nodes. This feature is fully described in the <b id="0605e35f">Attributes</b> section of the <a href="structure.html">Structure</a> chapter. In this cookbook we'll create a simple addition to the <b id="b49a3a8b">Calculator</b> tutorial language that will allow the input and output fields of the calculator definitions to have descriptive comments attached to them. These descriptive comments will be propagated into the generated Java code in the form of "popup tooltips" attached to the Swing text fields corresponding to the input and output fields.</p>   <aside class="tip sideblock" data-title="" rel="cd18cb28" id="2d4dc8ec">      <p id="73fda966">Since MPS 2018.2 documentation comments can be seamlessly inserted into code in any language without explicit support in the language itself. The feature is described in <a href="generic-placeholders-and-generic-comments.html">Generic placeholders and generic comments</a>. Adding support for comments into languages is no longer necessary, unless you want to greatly customize the way comments are used. Nevertheless, this cookbook focuses on attributes and is still highly relevant.</p>   </aside>   <h2 id="thecalculatorlanguage">The Calculator language</h2>   <p id="54bbc6d2">We chose the <a href="https://www.jetbrains.com/help/mps/2019.1/mps-calculator-language-tutorial.html" data-external="true" target="_blank" rel="noopener noreferrer">Calculator tutorial</a> language as a testbed for our experiments. You can find the <i id="15f983a1">calculator-tutorial</i> project included in the set of sample projects that comes with the MPS distribution. I recommend you skimmed through the tutorial to familiarize yourself with the language before we continue.</p>   <h2 id="changestothefields">Changes to the fields</h2>   <p id="3c87b8c3">Let's start building the machinery for adding descriptive comments to input and output fields. Our approach will be based on annotations that when added to nodes will have impact on their visual appearance as well as on the generated code. There are several vital components that will enable our desired functionality:</p>   <ul class="list _ul"><li class="list__item" id="a03f517a"><p>A marker interface that indicates, which nodes can hold the description comments</p></li><li class="list__item" id="072cdaf5"><p>The annotation itself to indicate whether a node holds the description comment and what the description is</p></li><li class="list__item" id="17784725"><p>An action providing a keyboard shortcut to quickly add and remove the description comment to/from a node under caret</p></li><li class="list__item" id="e31bd6e3"><p>Updating the code generation process in order to generate the visual "tooltips" for the described components</p></li></ul>   <p id="0f845e7f">We start with a new interface to mark all commentable nodes:</p>   <p id="b1bd4e1c">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC1.png"><img alt="Marking the nodes" title="Marking the nodes" src="/help/img/idea/2019.2/DC1.png" id="ca45a76e" width="700" height="1036"></a></figure>   </p>   <p id="a9c07eed">&nbsp;</p>   <p id="f9baf7a0">Now both <i id="908d5b11">InputField</i> and <i id="02523fc1">OutputField</i> concepts have to implement the new <i id="eb34f1e6">ICanHaveDescription</i> interface.</p>   <p id="e157eb98">&nbsp;</p>   <p id="81d1120d">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC3.png"><img alt="Implementing the ICanHaveDescription interface" title="Implementing the ICanHaveDescription interface" src="/help/img/idea/2019.2/DC3.png" id="fc853607" width="700" height="1054"></a></figure>   </p>   <h2 id="thedescriptionannotationconcept">The DescriptionAnnotation concept</h2>   <p id="48773dfd">We are still missing the core pice of our puzzle - the actual annotation that will be attributed to input and output fields to specify the description comment. Let's create it now:</p>   <p id="4297a1aa">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC4.png"><img alt="Creating the description" title="Creating the description" src="/help/img/idea/2019.2/DC4.png" id="5f09edd7" width="700" height="1006"></a></figure>   </p>   <p id="520fb15d">      <br> Once you make the concept extend <i id="dab4e0d7">NodeAttribute</i>, MPS will hint you to provide further information detailing the attribution. Invoking a quick-fix through <i id="3adde97d">Alt + Enter</i> will add the necessary information for you to customize:</p>   <p id="200c2504">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC5.png"><img alt="Invoking a quick-fix" title="Invoking a quick-fix" src="/help/img/idea/2019.2/DC5.png" id="ced3a9b1" width="600" height="580"></a></figure>   </p>   <p id="98d6ccde">      <br> You need to specify additional qualities of the new annotation by setting values for <i id="617beb79">role</i> as well as <i id="3c9aeb4c">attributed concepts</i>. We set the <i id="840f9f3d">role</i> for the annotation as <i id="7730cad6">descriptionComment</i>. This is the name to use in queries in order to find out, whether a node has been annotated with <i id="633fc0a4">DescriptionAnnotation</i> or not. We also indicate that the annotation can only be <i id="b8d2609d">attributed</i> to nodes implementing <i id="65b21482">ICanHaveDescription</i>, which in our case is <i id="43ae0fc4">InputField</i> and <i id="59edf259">OutputField</i>.</p>   <p id="00f18f7c">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC6.png"><img alt="Specifying additional qualities" title="Specifying additional qualities" src="/help/img/idea/2019.2/DC6.png" id="2cd1d8a7" width="600" height="1148"></a></figure>   </p>   <p id="6a2f7317">The&nbsp;<i id="581b7c98">DescriptionAnnotation</i> also has to store the actual text of the description - we'll use a&nbsp;<i id="163e67e7">string</i> property&nbsp;<i id="fec345e1">descriptionText</i> for this:</p>   <p id="9ea1ff48">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC7.png"><img alt="Adding the description text" title="Adding the description text" src="/help/img/idea/2019.2/DC7.png" id="2403f366" width="600" height="1146"></a></figure>   </p>   <p id="34f26916">&nbsp;</p>   <p id="6f2807c8">The editor of <i id="c5be3fc7">DescriptionAnnotation</i> is the key element in defining the visual behavior of nodes with description comments attached to them. We prepend the annotated node with a <i id="a85e8b2e">"described"</i> constant and append the actual description text wrapped in parentheses. The&nbsp;<i id="56dccab4">attributed node</i> cell represents the editor of the actual node - the node that the attribute is attached to.</p>   <p id="fd9f7376">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC8.png"><img alt="Attaching to a node" title="Attaching to a node" src="/help/img/idea/2019.2/DC8.png" id="cd8085b9" width="600" height="494"></a></figure>   </p>   <h2 id="furthereditorenhancements">Further editor enhancements</h2>   <p id="b6fbdc76">To toggle the description comment of a node on and off, we will create new <i id="816317a0">KeyMap</i>.</p>   <p id="f77285fd">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC20.png"><img alt="Creating a new key map" title="Creating a new key map" src="/help/img/idea/2019.2/DC20.png" id="ac9fbf1c" width="600" height="1068"></a></figure>   </p>   <p id="51f3bd82">&nbsp;</p>   <p id="a9bb9629">To edit the code we will use concepts from <i id="1a997a51">BaseLanguage</i> and <i id="dfb4e22a">smodel</i>, which should be available by default. If not, import them through <i id="6c427434">Control/Cmd + L.</i> We will also need the <i id="483e6285">actions</i> language in order to create initialized nodes easily. This one will most likely need to be imported explicitly (<i id="f4318d90">Control + L</i>).</p>   <p id="ffbb106b">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC10.png"><img alt="Adding an import statement" title="Adding an import statement" src="/help/img/idea/2019.2/DC10.png" id="6d5af164" width="400" height="594"></a></figure>   </p>   <p id="f8f072b4">Now we can complete the action:</p>   <p id="6cc7feb0">      <br>      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC13.png"><img alt="Completing the action" title="Completing the action" src="/help/img/idea/2019.2/DC13.png" id="73a4a35d" width="600" height="1232"></a></figure>   </p>   <p id="e7e70079">Whenever <i id="79bfc5cf">Control + Alt + Shift + D</i>&nbsp;is pressed on a node implementing <i id="e642fd9a">ICanHaveDescription</i>, the action will add or remove the <i id="88826cbd">DescriptionAnnotation</i> to/from the node.</p>   <p id="675eac8d">The <i id="4452ed44">KeyMap</i>&nbsp;now needs to be added to all fields that should react to <i id="94c2356a">Control + Alt + Shift + D</i>. This is to <i id="cbe0a90c">InputField</i> and <i id="f77bf977">OutputField</i> in our case. The editor cells that should react to the&nbsp;<i id="14aa61ba">Control + Alt + Shift + D</i> key combination must have the key map specified in the&nbsp;<i id="2caeff3a">keycap</i> property.</p>   <p id="0b0b4184">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC12.png"><img alt="Adding the key map to all fields" title="Adding the key map to all fields" src="/help/img/idea/2019.2/DC12.png" id="2c1b7871" width="400" height="1358"></a></figure>   </p>   <h2 id="howarewedoingsofar?">How are we doing so far?</h2>   <p id="853c831b">After compilation you are able to use <i id="a58727da">Control + Alt + Shift + D</i>&nbsp;both on input fields and output fields to toggle the description comment:</p>   <p id="0bfae18a">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC14.png"><img alt="Toggling the description comment" title="Toggling the description comment" src="/help/img/idea/2019.2/DC14.png" id="4eb041ea" width="500" height="418"></a></figure>      <br>      <br>   </p>   <h2 id="updatingthegenerator">Updating the generator</h2>   <p id="1bfce26a">The <i id="a77bdf7d">DescriptionAnnotation</i> is currently lost during the generation process. Instead, we would like to generate the Swing "tooltips" for the text fields that represent the commented input and output fields.<br>      <figure><img alt="Updating the generator" title="Updating the generator" src="/help/img/idea/2019.2/DC21.png" id="cd5062cf" width="340" height="148"></figure>   </p>   <p id="1b725e94">When generating code we currently take all input or output fields in the calculator and generate JTextFields for them. In the constructor we also generate initialization code for each generated JTextField - this is the place, where we can attach a Swing "tooltip" the JTextFields that represent an input or output fields with description comments.</p>   <p id="a8cacd4e">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC15.png"><img alt="Creating JTextFields" title="Creating JTextFields" src="/help/img/idea/2019.2/DC15.png" id="42f1e86b" width="700" height="1324"></a></figure>   </p>   <p id="4ab82ab0">The&nbsp;<i id="72784e69">$IF$</i> node macro will ensure that a "tooltip" is only generated for nodes with the&nbsp;<i id="cd15b8da">DescriptionComment</i> annotation attached.</p>   <p id="3cf5e192">&nbsp;</p>   <p id="0c46dacd">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC16.png"><img alt="Adding a macro" title="Adding a macro" src="/help/img/idea/2019.2/DC16.png" id="9055f3bc" width="700" height="1140"></a></figure>   </p>   <p id="a4bc9ade">The&nbsp;<b id="e7da2197">property macro</b> of the text of the "tooltip" will set the&nbsp;<i id="2ee0a621">descriptionText</i> of the&nbsp;<i id="ba007e10">DescriptionAnnotation</i> attached to the current node:</p>   <p id="f4b0843c">&nbsp;</p>   <p id="d6a971fc">      <figure><a class="lightbox" href="/help/img/idea/2019.2/DC17.png"><img alt="Property macro" title="Property macro" src="/help/img/idea/2019.2/DC17.png" id="daaa12fb" width="700" height="860"></a></figure>   </p>   <p id="0581efa9">After rebuilding the language and the sandbox solution, the generated Calculator form will have "tooltips" attached to the fields that have been marked with the&nbsp;<i id="1357cb76">DescriptionAnnotation</i>:</p>   <p id="71092afc">      <figure><img alt="Resulting tooltip" title="Resulting tooltip" src="/help/img/idea/2019.2/DC21.png" id="2452ada4" width="288" height="148"></figure>   </p>   <h2 id="summary">Summary</h2>   <aside class="tip sideblock" data-title="" rel="summary" id="f860a5e9">      <p id="d2aff5d7">You may now consider checking out the <a href="requirement-tracking-language.html">Requirement tracking language cookbook</a>, which provides a commented tour round the Requirement tracking sample project showing another practical use of node attributes together with multiple projections and scoping.</p>   </aside>   <p id="7d8cf15f">&nbsp;</p>   <p id="f9d90ba0">We can finish our tour here. Both input fields and output fields can be described with <i id="3b7f1d9f">DescriptionAnnotation</i> and the generated code contains a "tooltip" for each such description.</p><div class="last-modified" data-skip-index="skip">Last modified: 30 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="scopes.html">Scopes</a><a class="navigation-links__next" href="requirement-tracking-language.html">Requirement tracking language</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>