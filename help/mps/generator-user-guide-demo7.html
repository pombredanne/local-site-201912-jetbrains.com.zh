<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Generator User Guide Demo7 - Help | MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Generator+User+Guide+Demo7.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Default</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_jbuilder">JBuilder</option><option data-group="primary" value="primary_mac_os_x">Mac OS X</option><option data-group="primary" value="primary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default">Default</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_jbuilder">JBuilder</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Generator+User+Guide+Demo7.html" id="generator-user-guide-demo7.xml">Generator User Guide Demo7</h1>   <h2 id="generatoruserguidedemo7">Generator User Guide Demo 7</h2>   <p id="46828e0c">In this final demo we will go back to Demo 3 and implement the desired capabilities in a slightly different way, so that we explore another area of the MPS generator - the weaving rules and root mapping rules.</p>   <p id="a3e70701">In Demo 2, which we will build on here, we were generating java statements like:</p>   <div class="code-block" data-lang="none">container.add(new JButton());</div>   <p id="d5b977bc">to create a Swing component and add it to the application's content pane.</p>   <p id="e3af14bc">In Demo 7, just like in Demo 3, we are going to add support for component properties, which will require a generation of more complex initialization code - not just a constructor invocation.&nbsp;Moreover, the generated property initialization code is going to be different for different types of components.<br>Therefore we will choose a generation strategy that is capable of handling such requirements - instead of making use of a <i id="00d7265f">SWITCH</i>&nbsp;macro we will use <b id="87e1f143">Weaving Rules</b>, which will 'inject' component's initialization code into the <i id="76cff307">DemoApp</i> class.</p>   <h2 id="newlanguage">New Language</h2>   <p id="9df53d61">Again, we need to setup a new language and copy some of the Demo 2 generator artifacts to it.</p>   <ul class="list _ul"><li class="list__item" id="229c5324"><p>create a new language: 'generator_demo.demoLang7'</p></li><li class="list__item" id="d0c7b780"><p>in the language properties dialog add&nbsp;<b id="82e42845">extended dependencies</b>&nbsp;on 'jetbrains.mps.sampleXML' as well as on 'jetbrains.mps.baseLanguage'</p></li><li class="list__item" id="1a507613"><p>create a new generator for this language, if it does not exist (see <a href="generator-user-guide-demo1.html">Demo 1</a> for details)</p></li><li class="list__item" id="23297aae"><p>delete the (empty) mapping configuration 'main' from the <i id="1349e2b2">demoLang7</i> generator (as in Demo 2, we will copy all needed parts from the <i id="1c3da35f">demoLang2</i> generator to the <i id="ef25b761">demoLang7</i>&nbsp;generator)</p></li><li class="list__item" id="15495437">         <p id="bac825b3">copy-paste the mapping configuration 'main' from the&nbsp;<i id="0a05c256">demoLang2</i> generator to the&nbsp;<i id="69cf342e">demoLang7</i>&nbsp;generator</p>         <aside class="note " data-title="" rel="bac825b3" id="5ff0608e">            <p id="7e452e6d">See <a href="generator-user-guide-demo2.html#new_language">Demo 2</a> for details.</p>         </aside>      </li><li class="list__item" id="c581e8f2"><p>copy-paste the 'DemoApp' template&nbsp;from the <i id="3b511ab4">demoLang2</i> generator to the&nbsp;<i id="e5292763">demoLang7</i>&nbsp;generator</p></li></ul>   <h2 id="enhancethelanguage">Enhance the language</h2>   <p id="6b8609e7">This time, instead of having all input XML <i id="03801425">Elements</i>&nbsp;represented as standalone roots in the input model,&nbsp;we're going to wrap them&nbsp;into a single root concept, called <i id="ba7e89f0">XMLDocument</i>. The <i id="330d211c">demoLang7</i>&nbsp;language will introduce this new concept as well as its editor:</p>   <p id="eefdf744">      <figure><img alt="gdg14" title="gdg14" src="/help/img/idea/2019.2/gdg14.png" id="9b1c81ac" width="873" height="379"></figure>      <br>The concept may hold a collection of XML <i id="ff7ebe9e">Elements</i>&nbsp;and it will present them on the screen as a vertical collection.</p>   <p id="4f71d094">      <figure><img alt="Screen Shot 2017 07 26 at 1 26 17 AM" title="Screen Shot 2017 07 26 at 1 26 17 AM" src="/help/img/idea/2019.2/Screen-Shot-2017-07-26-at-1-26-17-AM.png" id="cb69c48f" width="798" height="348"></figure>   </p>   <h2 id="addcontent(container)">addContent(container)</h2>   <ul class="list _ul"><li class="list__item" id="c0daeb4f"><p>open the <i id="6a98955d">DemoApp</i>&nbsp;template</p></li><li class="list__item" id="924b6710"><p>add a static void method 'addContent(Container)'</p></li><li class="list__item" id="e76a88b7">         <p id="be1ce3bf">in the 'main()' method find the statement:</p>         <div class="code-block" data-lang="none">$LOOP$[container.add($SWITCH$[null]);</div>      </li><li class="list__item" id="014e2939">         <p id="0ab712e9">replace the statement above with statement below:</p>         <div class="code-block" data-lang="none">addContent(container);</div>      </li></ul>   <p id="3d3e6f1d">      <figure><img alt="gdc1" title="gdc1" src="/help/img/idea/2019.2/gdc1.png" id="a0934c38" width="842" height="387"></figure>   </p>   <h2 id="newtestmodel">New Test Model</h2>   <p id="fcd49e32">Before going on with the generator let's create a new input test model:</p>   <ul class="list _ul"><li class="list__item" id="3849494c"><p>go to the 'test_models' solution</p></li><li class="list__item" id="6e3e15f3"><p>create a new model 'test7'</p></li><li class="list__item" id="aa27dd0f"><p>int the <b id="40ae9d45">Used Languages</b>&nbsp;tab add 'jetbrains.mps.sampleXML' and 'jetbrains.mps.samples.generator_demo.demoLang7'</p></li><li class="list__item" id="cf9662fd"><p>add a new <i id="f38c59e7">XMLDocument</i>&nbsp;root node and type the code:</p></li></ul>   <p id="17a90ddf">      <figure><img alt="gdg15" title="gdg15" src="/help/img/idea/2019.2/gdg15.png" id="95403215" width="810" height="187"></figure>   </p>   <p id="2393ace1">Now, let's define the semantics for these documents.</p>   <h2 id="rootmappingrules">Root mapping rules</h2>   <p id="f1f1bc53">We used to utilize&nbsp;<i id="c2be635b">conditional root rules</i>&nbsp;for instantiating the&nbsp;<i id="3eef69f4">DemoApp</i>&nbsp;class template in the previous demos. In Demo 7 we'll use a different mechanism -&nbsp;<i id="327990b4">root mapping rules</i>. In the 'main' mapping configuration delete the entry in the&nbsp;<b id="95864cff">conditional root rules</b>&nbsp;section as well as the one in the <b id="8637b0ed">abandon roots</b>&nbsp;section&nbsp;and instead add a&nbsp;<i id="4d63d73f">root mapping rule</i>: <br>       <figure><img alt="gdg16" title="gdg16" src="/help/img/idea/2019.2/gdg16.png" id="45ea9d1a" width="851" height="220"></figure>   </p>   <p id="df023038">This rule will replace an&nbsp;<i id="8a66d0bc">XMLDocument</i>&nbsp;with our desired&nbsp;<i id="239081af">DemoApp</i>&nbsp;class template.</p>   <h2 id="weavingrules">Weaving Rules</h2>   <p id="5ef8b168">Weaving rules are a vehicle that can add extra nodes into the output model. In our case we'll utilize them to insert code for adding swing components to their containers.</p>   <ul class="list _ul"><li class="list__item" id="8268095a"><p>return to the <i id="ebff25b2">demoLang7</i>&nbsp;generator and open the mapping configuration 'main' in the editor</p></li><li class="list__item" id="2cde35df"><p>create a new Weaving Rule (press <i id="05b45d7d">Insert</i>&nbsp;or _Enter&nbsp;_while cursor is in the <b id="3adfed85">weaving rules</b> section)</p></li><li class="list__item" id="dfc76ae5"><p>choose the rule applicable concept - 'Element'</p></li><li class="list__item" id="8026778c"><p>enter the rule condition as shown below:</p></li></ul>   <p id="4fa5229d">      <figure><img alt="gdg9" title="gdg9" src="/help/img/idea/2019.2/gdg9.png" id="dda95b2b" width="683" height="198"></figure>   </p>   <h2 id="weavingcontext">Weaving Context</h2>   <p id="34133f4e">Weaving Rules inject additional generated code into other generated code.&nbsp;The Weaving Context is the exact place to which the Weaving Rule will inject the code. (the injected nodes will be the children of the <i id="960d709f">context</i> node).</p>   <p id="d9eb6eff">In our case, we will inject the component's set-up code into our <i id="d23df9dd">DemoApp</i>&nbsp;class.&nbsp;Thus, we have to find the generated <i id="0eba7e1e">DemoApp</i> class in the output model and pass this class to our weaving rule as its weaving context.</p>   <h2 id="mappinglabel">Mapping Label</h2>   <p id="30a3f98d">We will use a&nbsp;<b id="19c0d7da">mapping label</b> to find the generated 'DemoApp' node in the output model. As already discussed in Demo 3, they serve as registries for generated nodes so they could be retrieved later by other parts of the generator. This loosens the coupling between independent generator parts.</p>   <h4 id="declaringmappinglabel">Declaring Mapping Label</h4>   <p id="e04b377b">Before a mapping label can be used it must be declared in the mapping configuration:</p>   <ul class="list _ul"><li class="list__item" id="83fd63d2"><p>go to the <b id="32bff88a">mapping labels</b> section of the <i id="d0a571f7">main</i>&nbsp;mapping configuration</p></li><li class="list__item" id="ac5a1d88"><p>add a new mapping label (press <i id="8557ddb4">Insert</i>&nbsp;or <i id="acaa9742">Enter</i>)</p></li><li class="list__item" id="380fc978"><p>give it a name: 'main_class'</p></li><li class="list__item" id="6b396ba7"><p>select 'ClassConcept' as the label's output concept, since we're going to store <i id="466894a4">ClassConcepts</i>&nbsp;in the mapping label</p></li></ul>   <p id="a4e84f5d">      <figure><img alt="gdg18" title="gdg18" src="/help/img/idea/2019.2/gdg18.png" id="d96c0ad2" width="500" height="150"></figure>   </p>   <aside class="tip sideblock" data-title="" rel="a4e84f5d" id="7aecc12f">      <p id="e116e26e">In our case, we are going to attach the mapping label to a rule, which generates the 'Demo App' class (a Root mapping rule).<br>That's why we have chosen 'ClassConcept' as the label's output concept.<br>The expression (we will use it soon):</p>      <div class="code-block" data-lang="none">genContext.get output "main_class"</div>      <p id="6ec1c0f6">will then have type: 'node&lt;ClassConcept&gt;'.<br>The fact that the 'get output' expression has a type, provides no benefits for us in this particular case, but in general, it is a very helpful feature.</p>   </aside>   <h4 id="attachingthelabeltoarule">Attaching the Label to a Rule</h4>   <p id="c088102b">Attach the mapping label 'main_class' to the <i id="9841e790">Root mapping rule</i> using the rule's inspector:</p>   <p id="aa7999ef">      <figure><img alt="gdg17" title="gdg17" src="/help/img/idea/2019.2/gdg17.png" id="ba41d935" width="607" height="256"></figure>   </p>   <h4 id="usingthemappinglabelforfindingthedesiredoutputnode">Using the Mapping Label for Finding the desired output node</h4>   <p id="a77932f8">Now, return to Weaving Rule and enter the following code into the <b id="9144e753">context</b> function:</p>   <p id="d4c08551">      <figure><img alt="gdg19" title="gdg19" src="/help/img/idea/2019.2/gdg19.png" id="484f396a" width="978" height="187"></figure>      <br>This will now correctly resolve the <i id="c4bf36b5">DemoApp</i>&nbsp;class corresponding to the processed <i id="d2c822d6">XMLDocument</i> and pass it into the weaving rule, so that it can add new methods to it. Notice the use of the <i id="20fa0a66">jetbrains.mps.smodel</i> query <i id="40d9f034">node.ancestor</i>, which retrieves the closest node's ancestor of the specified concept in the AST.</p>   <h2 id="externaltemplate">External Template</h2>   <p id="da7fcf76">Now let's create a template for this weaving rule, which will be used to generate the code to add to the <i id="b41fe548">DempApp</i>&nbsp;class:</p>   <ul class="list _ul"><li class="list__item" id="84a8f3b3"><p>type 'weave_Button' in the red 'choose consequence' cell</p></li><li class="list__item" id="674e5556"><p>press <i id="6ffd6a2a">Alt-Enter</i> and choose 'New Template' (apply intention)</p></li><li class="list__item" id="2d33cc68"><p>open the template in the editor (use <i id="116425cf">Ctrl-&lt;left-click&gt;</i> or <i id="d9cda8d1">Ctrl+B</i> on reference cell)</p></li></ul>   <p id="c4379ee0">The template should already have a Class set as the template's content node, because that is the type of elements stored in the <i id="0cdff0ce">main_class</i>&nbsp;mapping label.&nbsp;If not - choose 'ClassConcept' as the template's content node.</p>   <ul class="list _ul"><li class="list__item" id="211889dd">         <p id="f6f2be3d">give the class a name</p>         <aside class="tip sideblock" data-title="" rel="f6f2be3d" id="d4ca8e99">            <p id="8b576dcb">You don't really have to give the class a name. This class is not going to be generated.<br>This class will serve as a context or a place, into which we can put the newly generated code<br>We will mark this 'real code' with the&nbsp;<b id="76e5ae65">template fragment</b> tags.</p>         </aside>      </li></ul>   <ul class="list _ul"><li class="list__item" id="c165c811"><p>add a static method 'createComponent()'</p></li><li class="list__item" id="61fc1233"><p>create a&nbsp;<b id="a09f8317">template fragment</b>: select the whole method declaration and press <i id="3e7f0e73">Ctrl+Shift+F</i>:</p></li></ul>   <p id="67ba99e3">      <figure><img alt="gdg6" title="gdg6" src="/help/img/idea/2019.2/gdg6.png" id="57af03a6" width="600" height="257"></figure>   </p>   <aside class="tip sideblock" data-title="" rel="67ba99e3" id="41e6cf0e">      <p id="b23f7427">Code tagged as <b id="c9c2412b">template fragment</b> (a method declaration in this case) is inserted into the weaving context node (<i id="a3547a43">DemoApp</i> class) during the generation process.</p>   </aside>      <h2 id="if-macro">IF-macro</h2>   <p id="2da56341">The following steps are very similar to what we've done in Demo 3, since we're effectively generating the same code just using a different technique - weaving rules instead of reduction rules.</p>   <p id="9464e8aa">Inside the 'createComponent()' method we are going to create and initialize a JButton component.<br>Optionally, if the input Element has an attribute 'text', then we will generate a statement:</p>   <div class="code-block" data-lang="none">component.setText( _text_ )</div>   <p id="4988657a">where the <i id="0086660e">text</i> is the string specified in the 'text' attribute in input Element.</p>   <ul class="list _ul"><li class="list__item" id="191209b5"><p>enter the following code in the body of the 'createComponent()' method</p></li><li class="list__item" id="1086733d"><p>create an IF-macro around the 'component.setText("text");' statement (select the whole  statement, press <i id="487bd448">Ctrl-Shift+M</i>)</p></li><li class="list__item" id="4cebbb04"><p>enter the code for the&nbsp;<b id="1789b26f">condition</b> function of the IF-macro, which will check the presence of the 'text' attribute</p></li></ul>   <p id="51f86500">      <figure><img alt="gdg7" title="gdg7" src="/help/img/idea/2019.2/gdg7.png" id="0608dc02" width="872" height="374"></figure>      <br>    </p>   <ul class="list _ul"><li class="list__item" id="627e32ca"><p>create a property-macro inside the string literal "text"</p></li><li class="list__item" id="80e7a7ed"><p>in the&nbsp;<b id="211aaa3c">value</b> function of the property-macro enter code that returns the value of the 'text' attribute of the input <i id="33310b67">Element</i>      </p></li></ul>   <p id="950a5087">      <figure><img alt="gdg8" title="gdg8" src="/help/img/idea/2019.2/gdg8.png" id="53ead038" width="783" height="280"></figure>   </p>   <h2 id="completethegenerator">Complete the Generator</h2>   <p id="73239cd7">To complete this step we have to create another Weaving Rule, which would be applicable to the 'label' Element.</p>   <ul class="list _ul"><li class="list__item" id="80145831"><p>open the 'main'&nbsp;mapping configuration ineditor</p></li><li class="list__item" id="b9a2cdff"><p>select the weaving rule, which we have just created for 'button' (select the whole node: put cursorinside the rule, use <i id="6a853c83">Ctrl+W</i> to expand selection)</p></li><li class="list__item" id="c14d31d1"><p>press <i id="e5b71f4f">Ctrl+D</i> (duplicate) to create an identical rule right next to the original one</p></li><li class="list__item" id="4d388d12">         <p id="dca44e2b">in the&nbsp;<b id="b37edae2">condition</b> function, in the statement</p>         <div class="code-block" data-lang="none">node.name.equals("button");</div>         <p id="8cff4957">replace "button" with "label"</p>      </li><li class="list__item" id="8bc6289e"><p>in theprojecttree select the template node 'weave_Button'</p></li><li class="list__item" id="5cac2dc0"><p>duplicate this template node using the&nbsp;<i id="00ff2ddb">Clone Root</i> command in the popup menu</p></li><li class="list__item" id="d562749a"><p>in the editor rename this new template to 'weave_Label'</p></li><li class="list__item" id="5e874b45">         <p id="ce5cec61">in the template code replace the statement</p>         <div class="code-block" data-lang="none">JButton component = new JButton();</div>      </li><li class="list__item" id="cd3bedd8">         <p id="061687aa">with</p>         <div class="code-block" data-lang="none">JLabel component = new JLabel();</div>         <p id="4c075ad7">            <br>            <figure><img alt="gdg12" title="gdg12" src="/help/img/idea/2019.2/gdg12.png" id="33fbf0b6" width="578" height="268"></figure>         </p>      </li><li class="list__item" id="9f443a0a">         <p id="9d4abe15">re-auto-complete 'setText' in the statement if the method call is not resolved automatically</p>         <div class="code-block" data-lang="none">$IF$[component.setText("$[text]");]</div>      </li><li class="list__item" id="18e3eb9c">         <p id="73d08e1e">attach the 'weave_Label' template&nbsp;to the second weaving rule in the 'main' mapping configuration<br>            <br>            <figure><img alt="gdg11" title="gdg11" src="/help/img/idea/2019.2/gdg11.png" id="04253c5f" width="674" height="365"></figure>         </p>      </li><li class="list__item" id="2ee1c62d"><p>re-generate generator model</p></li></ul>   <h2 id="firsttest(error)">First Test (Error)</h2>   <p id="54905e47">Try to rebuild the language and generate files from model 'test7'.<br>Generation should run with no problems but compilation will fail with an error:</p>   <div class="code-block" data-lang="none">generator_demo\test7\DemoApp.java : Duplicate method createComponent() in type DemoApp (line: 37)
</div>   <p id="e1b8b46b">Click on the error message to view the error in generated code:</p>   <div class="code-block" data-lang="none">public static Component createComponent() {  // &lt;-- error
    JButton component = new JButton();
    component.setText("Hello");
    return component;
  }

public static Component createComponent() {  // &lt;-- error
    JLabel component = new JLabel();
    component.setText("world!");
    return component;
  }
</div>   <p id="2807aa57">The problem is that our weaving rules are always injecting method declaration with the same name: 'createComponent()'</p>      <h2 id="generatinguniquenames">Generating Unique Names</h2>   <p id="ba37eb1a">To make the names of each generated 'createComponent()' method unique we will create another property-macro:</p>   <ul class="list _ul"><li class="list__item" id="d72a9866"><p>open the 'weave_Button' template in editor</p></li><li class="list__item" id="b61d6213"><p>add a property-macro to the name of 'createComponent()' method</p></li><li class="list__item" id="915e55f1"><p>enter the code in its <b id="eb156b5d">value</b> function as shown</p></li></ul>   <p id="b060a133">      <figure><img alt="gdg22" title="gdg22" src="/help/img/idea/2019.2/gdg22.png" id="ad58c508" width="784" height="294"></figure>   </p>   <p id="51d929bd">The <b id="1de45627">         <i id="ccc9a9e2">templateValue</i>      </b> is going to be "createComponent" (i.e. the method's name as written in the template).</p>   <ul class="list _ul"><li class="list__item" id="b8bf29ad"><p>make similar changes in the 'weave_Label' template</p></li><li class="list__item" id="1de89f46"><p>re-generate generator model</p></li></ul>   <h2 id="secondtest">Second Test</h2>   <p id="0659c944">Generate files form the 'test7' model - this time we should get no error.</p>   <p id="87755cbe">Preview the generated text for 'test7':</p>   <div class="code-block" data-lang="none">public class DemoApp {

public static void main(String[] args) {
  JFrame frame = new JFrame("Demo");
  frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
  Container container = frame.getContentPane();
  container.setLayout(new FlowLayout());
  addContent(container);
  frame.pack();
  frame.setLocationRelativeTo(null);
  frame.setVisible(true);
}

public static void addContent(Container container) {
}

public static Component createComponent0() {
  JButton component = new JButton();
  component.setText("Hello");
  return component;
}

public static Component createComponent1() {
  JLabel component = new JLabel();
  component.setText("world!");
  return component;
}
}
</div>   <p id="b56b7379">The code has no compilation problems, but it is still not working, because the body of the 'addContent()' method is empty. We're not calling the creational methods that we've just weaved in. Let's fix that by&nbsp;weaving the following code:</p>   <div class="code-block" data-lang="none">container.add( createComponent0() );
container.add( createComponent1() );
</div>   <p id="11a67894">into the body of the 'addContent()' method.</p>   <h2 id="secondtemplatefragment">Second Template Fragment</h2>   <p id="8117d6db">To generate a method call of the 'createComponent()' method, we will add another weaving rule and a template. The calls to all the generated 'createComponent()' methods must be weaved into the 'addContent()' method of the main generated class, thus we first have to store the 'addContent()' method in a&nbsp;<b id="49ad5cad">mapping label</b>&nbsp;in order to refer to it from weaving rules.</p>   <p id="a38c7a5a">      <figure><a class="lightbox" href="/help/img/idea/2019.2/g7f1.png"><img alt="g7f1" title="g7f1" src="/help/img/idea/2019.2/g7f1.png" id="404545d6" width="700" height="532"></a></figure>   </p>   <p id="73144813">We can use the&nbsp;<b id="cdb0dcac">LABEL</b> node macro to store the generated method in the&nbsp;<b id="ef4c9b7b">mapping label</b>:</p>   <p id="6af91eca">      <figure><a class="lightbox" href="/help/img/idea/2019.2/g7f3.png"><img alt="g7f3" title="g7f3" src="/help/img/idea/2019.2/g7f3.png" id="c19df6af" width="900" height="712"></a></figure>   </p>   <p id="bcfa9f03">Now a new&nbsp;<b id="e06f0de8">weaving rule</b> needs to be added to the&nbsp;<i id="f8e46438">weaving rules</i> section of the&nbsp;<i id="127a5640">main</i>      <b id="672965b5"></b>mapping configuration that will insert the calls to the individual 'createComponent()' methods into the 'addContent()' method:</p>   <p id="56c32e06">      <figure><a class="lightbox" href="/help/img/idea/2019.2/g7f4.png"><img alt="g7f4" title="g7f4" src="/help/img/idea/2019.2/g7f4.png" id="d55ce483" width="900" height="290"></a></figure>   </p>   <p id="d2012ad5">Notice that the <b id="96e3e06f">context</b> retrieves the 'addContent()' method from the&nbsp;<b id="3605cb22">mapping label</b> and returns the method's&nbsp;<i id="2f75fbb6">body</i>&nbsp;as the node that will have the template fragments weaved in.</p>   <p id="1caf83e9">The&nbsp;<i id="b30ec2c3">weave_ElementInitialization</i> template will insert the call to the individual 'createComponent()' methods into its context node (a method body, i.e. a <i id="987e765d">StatementList</i>):</p>   <p id="c5502035">      <figure><a class="lightbox" href="/help/img/idea/2019.2/g7f5.png"><img alt="g7f5" title="g7f5" src="/help/img/idea/2019.2/g7f5.png" id="829567b2" width="500" height="608"></a></figure>   </p>   <aside class="warning " data-title="" rel="c5502035" id="11cc457f">      <p id="60ccf370">Be sure you tagged the whole statement as a template fragment, including the trailing semicolon.</p>   </aside>   <p id="a12a149a">&nbsp;</p>   <p id="f7e228b8">Add a parameter 'Container container' to the method declaration (&nbsp;This parameter must have the&nbsp;same name&nbsp;as parameter in the actual 'addContent()' method in the 'DemoApp' template).</p>   <p id="7a56ab36">&nbsp;</p>   <aside class="tip sideblock" data-title="" rel="7a56ab36" id="c21f3640">      <p id="0eaa5ebe">If you decide to name the <i id="ffc99e42">Container</i> parameter differently, so that there's no longer a name match between the 'container' in the template fragment and the container parameter in the generated 'DemoApp.addContent()' method, you will need to resolve the actual parameter of 'DemoApp.addContent()' with a reference macro:</p>      <p id="3f9a1603">         <figure><a class="lightbox" href="/help/img/idea/2019.2/g7f8.png"><img alt="g7f8" title="g7f8" src="/help/img/idea/2019.2/g7f8.png" id="189d1041" width="900" height="994"></a></figure>      </p>   </aside>   <p id="09feb444">The actual 'createComponent()' method must be obtained from somewhere - a&nbsp;<b id="c16103ca">mapping label</b> would work well, so we need to first create a new&nbsp;<b id="f263b90a">mapping label</b> to hold these methods and insert the methods into the&nbsp;<b id="98ca7c64">mapping label</b>:</p>   <p id="30002803">      <figure><a class="lightbox" href="/help/img/idea/2019.2/g7f6.png"><img alt="g7f6" title="g7f6" src="/help/img/idea/2019.2/g7f6.png" id="cc2a45bb" width="700" height="464"></a></figure>   </p>   <p id="35c477b9">The&nbsp;<b id="2fae9798">LABEL</b> node macro will help us have the 'createComponent()' methods stored in the&nbsp;<i id="111604b4">createComponentMethods</i>&nbsp;<b id="9cfd97da">mapping label</b>&nbsp;for both <b id="ba470112">Buttons</b> and <b id="2b892146">Labels</b> in their respective weaving rules/templates:</p>   <p id="df8d1a17">      <figure><a class="lightbox" href="/help/img/idea/2019.2/g7f2.png"><img alt="g7f2" title="g7f2" src="/help/img/idea/2019.2/g7f2.png" id="a6c494ca" width="900" height="590"></a></figure>   </p>   <p id="754c0497">This should be done for both&nbsp;<b id="7d6b33c4">weave_Button</b> and&nbsp;<b id="209a659c">weave_Label</b>.</p>   <p id="6c5af87d">Now we can return to the&nbsp;<i id="4309d9c4">weave_ElementInitialization</i> template and specify a reference macro on the call to 'createComponent()' to obtain the appropriate 'createComponent()' method from the&nbsp;<i id="9008105b">createComponentMethods</i>&nbsp;<b id="b6ee0ac3">mapping label</b>:</p>   <p id="ad818513">      <figure><a class="lightbox" href="/help/img/idea/2019.2/g7f7.png"><img alt="g7f7" title="g7f7" src="/help/img/idea/2019.2/g7f7.png" id="f095e319" width="700" height="994"></a></figure>   </p>   <h2 id="thirdtest">Third Test</h2>   <p id="03144425">Now you can make the generator model a generate files from the 'test7' model in the 'test_models' solution.</p>   <p id="07d591e4">      <figure><img alt="gdg21" title="gdg21" src="/help/img/idea/2019.2/gdg21.png" id="7b3ea330" width="462" height="613"></figure>   </p>   <p id="baf2f661">Now you get correct and complete code for our simple application.&nbsp;</p><div class="last-modified" data-skip-index="skip">Last modified: 30 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="generator-user-guide-demo6.html">Generator User Guide Demo6</a><a class="navigation-links__next" href="textgen.html">TextGen</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>