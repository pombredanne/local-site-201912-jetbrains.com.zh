<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Diagramming Editor - Help | MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Diagramming+Editor.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search MPS Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default" selected>Default</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_jbuilder">JBuilder</option><option data-group="primary" value="primary_mac_os_x">Mac OS X</option><option data-group="primary" value="primary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default">Default</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_mac_os_x">Eclipse (Mac OS X)</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_jbuilder">JBuilder</option><option data-group="secondary" value="secondary_mac_os_x">Mac OS X</option><option data-group="secondary" value="secondary_mac_os_x_10.5_">Mac OS X 10.5+</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Diagramming+Editor.html" id="diagramming-editor.xml">Diagramming Editor</h1>   <p id="17d42eb2">The diagramming support in MPS allows the language designers to provide graphical editors to their concepts. The diagrams typically consist of <b id="91c194e3">blocks</b>, represented by boxes, and <b id="92c0269c">connectors</b>, represented by lines connecting the boxes. Both blocks and connectors are visualization of nodes from the underlying model.&nbsp;</p>   <p id="47292e71">      <figure><img alt="Diagramm" title="Diagramm" src="/help/img/idea/2019.2/di403.png" id="4c14621b" width="557" height="409"></figure>   </p>   <p id="f01d54df">      <b id="4508fe72">Ports</b>&nbsp;(optional) are predefined places on the shapes of the <b id="758cf5bf">blocks</b>, to which <b id="79b4dc05">connectors</b> may be attached to. MPS allows for two types of ports - input and output ones.</p>   <p id="0a062ff2">Optionally, a palette of available <b id="01be83ce">blocks</b> may be displayed on the side of the diagram, so the user could quickly pick the type of the box they need to add to the diagram.</p>   <h3 id="addingelements">Adding elements</h3>   <p id="29a2fb09">Blocks get added by double-clicking in a free area of the editor. The type of the block is chosen either by activating the particular block type in the palette or by choosing from a popup completion menu that shows up after clicking in the free area.</p>   <p id="786138f1">Connectors get created by dragging from an output port of a block to an input port of another or the same block.</p>   <h3 id="samples">Samples</h3>   <p id="783d15fb">MPS comes with bundled samples of diagramming editors. You can try the <i id="d2f1add4">componentDependencies</i>&nbsp;or the <i id="625468b8">mindMaps</i>&nbsp;sample projects for initial familiarization with how diagrams can be created.</p>   <aside class="tip sideblock" data-title="" rel="783d15fb" id="650bcabd">      <p id="12a677ce">This document uses the <i id="a053bfec">componentDependencies</i> sample for most of the code examples. The sample defines a simple language for expressing dependencies among components in a system (a component set). Use the "Push Editor Hints" option in the popup menu to activate the diagramming editor.</p>      <p id="df0e7262">         <figure><a class="lightbox" href="/help/img/idea/2019.2/Push1.png"><img alt="Pucj Editor Hints" title="Pucj Editor Hints" src="/help/img/idea/2019.2/Push1.png" id="3619a014" width="300" height="922"></a></figure>         <figure><a class="lightbox" href="/help/img/idea/2019.2/Push2.png"><img alt="Selecting Diagram View" title="Selecting Diagram View" src="/help/img/idea/2019.2/Push2.png" id="cf1dac5c" width="300" height="436"></a></figure>      </p>   </aside>   <h2 id="dependencies">Dependencies</h2>   <p id="50b62baa">In order to be able to define diagramming editors in your language, the language has to have the required dependencies and used languages properly set:</p>   <p id="50baab01">      <figure><img alt="Used languages and developer kits" title="Used languages and developer kits" src="/help/img/idea/2019.2/di4.png" id="63a00f7d" width="548" height="346"></figure>      <br>       <figure><img alt="Dependencies" title="Dependencies" src="/help/img/idea/2019.2/di5.png" id="40ab682a" width="548" height="344"></figure>   </p>   <ul class="list _ul"><li class="list__item" id="4b6f1669"><p>         <i id="8660e108">jetbrains.mps.lang.editor.diagram</i>&nbsp;- the language for defining diagrams</p></li><li class="list__item" id="e314e07d"><p>         <i id="e830d98f">jetbrains.mps.lang.editor.figures</i>&nbsp;(optional) - a language for defining custom visual elements (blocks and connectors)</p></li><li class="list__item" id="046623c5"><p>         <i id="d933e4ec">jetbrains.jetpad</i>&nbsp;and&nbsp;<i id="18a563cf">jetbrains.mps.lang.editor.diagram.runtime</i>&nbsp;- runtime libraries that handle the diagram rendering and behavior</p></li></ul>   <h2 id="diagramdefinition">Diagram definition</h2>   <p id="c8774f93">Let's start from the concept that should be the root of the diagram. The diagramming editor for that node will contain the <i id="f928fc39">diagram</i>&nbsp;editor cell:</p>   <p id="46d4cf49">      <figure><img alt="Editor cell" title="Editor cell" src="/help/img/idea/2019.2/di6.png" id="6baf033e" width="731" height="569"></figure>   </p>   <aside class="tip sideblock" data-title="" rel="46d4cf49" id="8ca9ec9b">      <p id="7bb64405">Note that the <b id="adadf043">diagram</b>&nbsp;editor cell does not have to be the root of the editor definition. Just like any other editor cell it can be composed with other editor cells into a larger editor definition.</p>   </aside>   <p id="854857c8">The <i id="5de247bf">diagram</i>&nbsp;cell needs its <i id="23c2786b">content</i>&nbsp;parameter to hold all the nodes that should become part of the diagram. In our case we pass in all the components (will be rendered as blocks) and their dependencies (will be rendered as connectors). The way these nodes are rendered is defined by their respective editor definitions, as explained later.</p>   <p id="35c4d7eb">Down in the <i id="266dd7b0">Inspector</i>&nbsp;<b id="49bc31fc">element creation</b>&nbsp;handlers can be defined. These get invoked whenever a new visual block is to be created in the diagram. Each handler has several properties to set:</p>   <ul class="list _ul"><li class="list__item" id="8922ba0a"><p>         <i id="f8de9c34">name</i>&nbsp;- an arbitrary name to represent the option of creating a new element in the completion menu and in the palette</p></li><li class="list__item" id="1050f925"><p>         <i id="9c0b3497">container</i>&nbsp;- a collection of nodes that the newly created node should be added to</p></li><li class="list__item" id="a32a86de"><p>         <i id="c7d82128">concept</i>&nbsp;- the concept of the node that gets created through the handler, defaults to the type of the nodes in the <i id="7f2a8883">container</i>, but allows sub-types to be specified instead</p></li><li class="list__item" id="8a43d9c4"><p>         <i id="276239d8">on create</i>&nbsp;- a handler that can manipulate the node before it gets added to the model and rendered in the diagram. Typically the name is set to some meaningful value and the position of the block on the screen is saved into the model.</p></li></ul>   <p id="006b5ef8">There can be multiple <b id="70b55ae0">element creation</b>&nbsp;handlers defined.</p>   <p id="28855d03">Similarly, <b id="fdb0a8c0">connector creation</b>&nbsp;handlers can be defined for the diagram cell to handle connector creation. On top of the attributes already described for <b id="39ed37c0">element creation</b>&nbsp;handlers, <b id="7a4c6386">connector creation</b>&nbsp;handlers have these specific attributes:</p>   <ul class="list _ul"><li class="list__item" id="bd1a9b20"><p>         <i id="47c45780">can create</i>&nbsp;- a concept function returning a boolean value and indicating whether a connector with the specified properties can be legally constructed and added to the diagram.</p></li><li class="list__item" id="147e658d"><p>         <i id="d2a64d32">on create</i>&nbsp;- a concept function that handles creation of a now connector.</p></li><li class="list__item" id="7b34cdf1"><p>the <i id="b181ae78">from</i>&nbsp;and <i id="00029b8b">to</i>&nbsp;parameters to these functions specify the source and target nodes (represented by a <b id="43d45597">Block</b> or a <b id="eb8a8115">Port</b>) for the new connection.</p></li><li class="list__item" id="b815a431"><p>the <i id="99d49d9b">fromId</i>&nbsp;and <i id="00200d85">toId</i>&nbsp;parameters to these functions&nbsp;specify the ids of the source and target nodes (represented by a&nbsp;<b id="f308c5dd">Block</b>&nbsp;or a&nbsp;<b id="10fc463c">Port</b>) for the new connection.</p></li></ul>   <p id="60075608">Elements get created when the user double-clicks in the editor. If multiple element types are available, a completion popup menu shows up.</p>   <p id="95964ce7">      <b id="517c36f4">Connectors</b> get created when the user drags from the <b id="149c0e69">source block</b> or its <b id="daf1c7b6">output port</b> to a <b id="e3e90133">target block</b> or its <b id="1459228d">input port</b>.</p>   <h3 id="palette">Palette</h3>   <p id="933af3e7">      <figure><img alt="Pallete" title="Pallete" src="/help/img/idea/2019.2/di400.png" id="5f419c01" width="551" height="237"></figure>   </p>   <p id="12a30551">The optional palette will allow developers to pick a type of blocks and links to create whenever double-clicking or dragging in the diagram. The palette is defined for diagram editor cells and apart from specifying the <b id="7bc987d8">creation</b>&nbsp;components&nbsp;allows for visual grouping and separating of the palette items..</p>   <h3 id="blocks">Blocks</h3>   <p id="9d77d7a7">The concepts for the nodes that want to participate in diagramming as <b id="2a196cf9">blocks</b> need to provide properties that will preserve useful diagramming qualities, such as <b id="cfbc3f19">x/y coordinates</b>, <b id="251fadcf">size</b>, <b id="2ff3075c">color</b>, <b id="46a5f2b4">title</b>, and so on.</p>   <p id="31415e8e">      <figure><img alt="Diagram properties" title="Diagram properties" src="/help/img/idea/2019.2/di7.png" id="54703b47" width="371" height="277"></figure>      <br> Additionally, the nodes should provide input and output ports, which connectors can visually&nbsp;connect to.</p>   <p id="9247b388">The editor will then use the <i id="d5429621">diagram node</i>&nbsp;cell:</p>   <p id="78a51f40">      <figure><img alt="Diagram node cell" title="Diagram node cell" src="/help/img/idea/2019.2/di9.png" id="1c7fbb01" width="570" height="156"></figure>      <br> The <b id="64f496b8">diagram node</b>&nbsp;cell requires a <b id="6b81136a">figure</b> to be specified. This is a reference to a <i id="7ebb1125">figure</i>&nbsp;class that defines the visual layout of the block using the&nbsp;<i id="e312185a">jetpad</i>&nbsp;framework. MPS comes with a set of pre-defined graphical shapes in the <i id="c345b0f1">jetbrains.mps.lang.editor.figures.library</i>&nbsp;solution, which you can import and use.      Each figure may expose several <b id="9f6ff335">property fields</b>&nbsp;that hold visual characteristics of the figure.&nbsp;All the figure parameters should be specified in the editor definition, most likely by mapping them to the node's properties defined in the concept:</p>   <p id="bb4bdf7e">      <figure><img alt="Diagram editor for the concept" title="Diagram editor for the concept" src="/help/img/idea/2019.2/di8.png" id="a1176a73" width="856" height="118"></figure>   </p>   <p id="52fecb40">The values for parameters may ether be references to the node's properties, or&nbsp;<i id="ca8a2d77">BaseLanguage</i>&nbsp;expressions prepended with the&nbsp;<b id="52165d6e">#</b>&nbsp;character. You can use&nbsp;<i id="3f2dce79">this</i>&nbsp;to refer to the edited node from within the expression.</p>   <p id="6affa46a">If the node defines input and output ports, they should also be specified as parameters here so that they get displayed in the diagram. Again, to specify ports you can either refer to the node's properties or use a <i id="56cd56a0">BaseLanguage</i>&nbsp;expression prepended with the <b id="3fe124b9">#</b>&nbsp;character.</p>   <aside class="tip sideblock" data-title="" rel="6affa46a" id="287cc763">      <p id="44e87870">As all editor cells, diagramming cells can have&nbsp;<b id="f547549c">Action Maps</b>&nbsp;associated with them. This way you can enable the&nbsp;<b id="33cfc552">Delete</b>&nbsp;key to delete a block or a connector.</p>   </aside>   <h3 id="customfigures">Custom figures</h3>   <p id="88f79848">Alternatively you can define your own figures. These are <i id="46cca1f9">BaseLanguage</i>&nbsp;classes implementing the&nbsp;<i id="00c4dafc">jetbrains.jetpad.projectional.view.View</i>&nbsp;interface (or its descendants) and annotated with the <i id="a0c5415b">@Figure</i>&nbsp;annotation. Use the <i id="c85ace5f">@FigureParameter</i>&nbsp;annotation to demarcate property fields, such as&nbsp;<i id="ed6bf7d3">width</i>,&nbsp;<i id="6ee4ed8d">height</i>, and so on.</p>   <p id="4010d74f">      <figure><img alt="myCell" title="myCell" src="/help/img/idea/2019.2/di10.png" id="83438803" width="774" height="447"></figure>   </p>   <p id="ccfe27f5">The <i id="80323731">MovableContentView</i>&nbsp;interface provides additional parameters to the figure class:</p>   <p id="0fbd6f89">      <figure><img alt="MovableContentView" title="MovableContentView" src="/help/img/idea/2019.2/di11.png" id="d3fd542e" width="804" height="106"></figure>   </p>   <p id="a4df63e1">By studying <i id="c6e4970f">jetbrains.mps.lang.editor.figures.library</i>&nbsp;you may get a better understanding of the&nbsp;<i id="c8fe50e3">jetpad</i>&nbsp;library and its inner workings.</p>   <h3 id="connectors">Connectors</h3>   <p id="d65ebd2c">The nodes that will be represented by connectors do not need to preserve any diagramming properties. As of version 3.1 connectors cannot be visually customized and will be always rendered as a      solid black line. This will most likely change in one of the following versions of MPS.</p>   <p id="25e6ba34">      <figure><img alt="Connectors" title="Connectors" src="/help/img/idea/2019.2/di12.png" id="2a6cf41e" width="376" height="239"></figure>   </p>   <p id="cc286ff5">The editor for the node needs to contain a <b id="a2c07978">diagram connector</b>&nbsp;cell:</p>   <p id="d4d9ca79">      <figure><img alt="Diagram connector cell" title="Diagram connector cell" src="/help/img/idea/2019.2/di13.png" id="c8af82ce" width="554" height="151"></figure>   </p>   <p id="56318f13">The cell requires a source and a target for the connector. These can either be <b id="acb801af">ports</b>:</p>   <p id="1fddda67">      <figure><img alt="Connector settings" title="Connector settings" src="/help/img/idea/2019.2/di14.png" id="8ca91b1c" width="953" height="104"></figure>   </p>   <p id="918c1c39">or <b id="6f777551">nodes</b> themselves:</p>   <p id="0305e1c8">      <figure><img alt="Connector settings" title="Connector settings" src="/help/img/idea/2019.2/di15.png" id="7c50dd2d" width="807" height="101"></figure>   </p>   <p id="616a33b7">The values may again be direct references to node's properties or <i id="30d93244">BaseLanguage</i>&nbsp;expressions prepended with the <b id="5b7ed900">#</b>&nbsp;character.</p>   <h3 id="renderingports">Rendering ports</h3>   <p id="616c4884">Input and output ports should use the <i id="06acc3b6">input port</i>&nbsp;and <i id="8bb8afa1">output port</i>&nbsp;editor cells, respectively. The rendering of ports cannot be customized in MPS 3.1, but will be most likely enabled in later versions.</p>   <aside class="tip sideblock" data-title="" rel="616c4884" id="f67617f6">      <p id="4969a5bc">Use the <b id="f5058773">T</b> key to rotate the ports of a selected block by 90 degrees. This way you can easily switch between the left-to-right and top-to-bottom port positions.</p>   </aside>   <h3 id="usingimplicitports">Using implicit ports</h3>   <p id="9fa5d40c">In some situations you will not be able to represent ports directly in the model. You'll only want to use blocks and connectors, but ports will have to be somehow derived from the model. This case can easily be supported:</p>   <ol class="list _decimal"><li class="list__item" id="3b665fd6"><p>Decide on the representation of ports. Each port will be represented by a unique identifier, such as number or a string</p></li><li class="list__item" id="bcd1aab6"><p>Have the concept for the blocks define behavior methods that return collections of identifiers - separately for input and output ports<br>          <figure><img alt="Defining behavior" title="Defining behavior" src="/help/img/idea/2019.2/di1.png" id="96a8100a" width="371" height="256"></figure>      </p></li><li class="list__item" id="aa634b78"><p>Use the methods to provide the <b id="9832b8c7">inputPorts</b>&nbsp;and <b id="3bc3a892">outputPorts</b>&nbsp;parameters to the <b id="4da676de">DiagramNode</b>&nbsp;editor cell<br>          <figure><img alt="methods of the DiagramNode" title="methods of the DiagramNode" src="/help/img/idea/2019.2/di2.png" id="cb84e874" width="870" height="78"></figure>      </p></li><li class="list__item" id="75e7974d"><p>In the connector editor cell refer to the block's node as <b id="64b85b8f">source</b> and <b id="d909e6a8">target</b>. Append the requested id after the <b id="59a2ca40">#</b>&nbsp;symbol<br>          <figure><img alt="connector reference" title="connector reference" src="/help/img/idea/2019.2/di3.png" id="d32ecf56" width="580" height="102"></figure>      </p></li></ol><div class="last-modified" data-skip-index="skip">Last modified: 30 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="extending-the-transformation-menu-language.html">Extending the Transformation Menu Language</a><a class="navigation-links__next" href="editor-language-generation-api.html">Editor language generation API</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>