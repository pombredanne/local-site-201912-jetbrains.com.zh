<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>图表编辑器-帮助| MPS</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Diagramming+Editor.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索MPS帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected>默认</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_mac_os_x" data-group="primary">Eclipse（Mac OS X）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_mac_os_x" data-group="primary">Mac OS X</option><option value="primary_mac_os_x_10.5_" data-group="primary">Mac OS X 10.5以上</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="secondary_default" data-group="secondary">默认</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_jbuilder" data-group="secondary">JBuilder的</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">Mac OS X 10.5以上</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="diagramming-editor.xml" data-toc="Diagramming+Editor.html">图表编辑器</h1>   <p id="17d42eb2">MPS中的图表支持使语言设计人员可以为其概念提供图形编辑器。该图通常由<b id="91c194e3">块</b> ，由箱，和<b id="92c0269c">连接器</b>来表示，通过连接框的线表示。块和连接器均是来自基础模型的节点的可视化。</p>   <p id="47292e71">      </p><figure><img alt="图表" title="图表" src="/help/img/idea/2019.2/di403.png" id="4c14621b" width="557" height="409"></figure>   <p></p>   <p id="f01d54df">      <b id="4508fe72">端口</b> （可选）是<b id="758cf5bf">模块</b>形状上的预定义位置，可以将连接<b id="79b4dc05">器</b>连接到这些位置。MPS允许两种类型的端口-输入和输出端口。</p>   <p id="0a062ff2">可选地，可用<b id="01be83ce">块</b>的调色板可以显示在图的侧面，因此用户可以快速选择需要添加到图的框的类型。</p>   <h3 id="addingelements">添加元素</h3>   <p id="29a2fb09">通过双击编辑器的自由区域来添加块。可以通过激活调色板中的特定块类型来选择块的类型，也可以通过在自由区域中单击后显示的弹出完成菜单中进行选择。</p>   <p id="786138f1">通过从一个块的输出端口拖动到另一个或同一块的输入端口来创建连接器。</p>   <h3 id="samples">样品</h3>   <p id="783d15fb">MPS附带有图表编辑器的捆绑样本。您可以尝试<i id="d2f1add4">componentDependencies</i>或<i id="625468b8">mindMaps</i>示例项目，以初步了解如何创建图。</p>   <aside class="tip sideblock" rel="783d15fb" id="650bcabd" data-title="">      <p id="12a677ce">本文档对大多数代码示例都使用<i id="a053bfec">componentDependencies</i>示例。该示例定义了一种简单的语言，用于表达系统（组件集）中组件之间的依赖性。使用弹出菜单中的“推送编辑器提示”选项来激活图表编辑器。</p>      <p id="df0e7262">         </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Push1.png"><img alt="Pucj编辑器提示" title="Pucj编辑器提示" src="/help/img/idea/2019.2/Push1.png" id="3619a014" width="300" height="922"></a></figure>         <figure><a class="lightbox" href="/help/img/idea/2019.2/Push2.png"><img alt="选择图视图" title="选择图视图" src="/help/img/idea/2019.2/Push2.png" id="cf1dac5c" width="300" height="436"></a></figure>      <p></p>   </aside>   <h2 id="dependencies">依存关系</h2>   <p id="50b62baa">为了能够用您的语言定义图表编辑器，该语言必须具有所需的依赖项和正确设置的使用的语言：</p>   <p id="50baab01">      </p><figure><img alt="使用的语言和开发人员套件" title="使用的语言和开发人员套件" src="/help/img/idea/2019.2/di4.png" id="63a00f7d" width="548" height="346"></figure>      <br>       <figure><img alt="依存关系" title="依存关系" src="/help/img/idea/2019.2/di5.png" id="40ab682a" width="548" height="344"></figure>   <p></p>   <ul class="list _ul"><li class="list__item" id="4b6f1669"><p>         <i id="8660e108">jetbrains.mps.lang.editor.diagram-</i>用于定义图的语言</p></li><li class="list__item" id="e314e07d"><p>         <i id="e830d98f">jetbrains.mps.lang.editor.figures</i> （可选）-用于定义自定义视觉元素（块和连接器）的语言</p></li><li class="list__item" id="046623c5"><p>         <i id="d933e4ec">jetbrains.jetpad</i>和<i id="18a563cf">jetbrains.mps.lang.editor.diagram.runtime-</i>处理图呈现和行为的运行时库</p></li></ul>   <h2 id="diagramdefinition">图表定义</h2>   <p id="c8774f93">让我们从应该成为图表根源的概念开始。该节点的图表编辑器将包含<i id="f928fc39">图表</i>编辑器单元：</p>   <p id="46d4cf49">      </p><figure><img alt="编辑器单元" title="编辑器单元" src="/help/img/idea/2019.2/di6.png" id="6baf033e" width="731" height="569"></figure>   <p></p>   <aside class="tip sideblock" rel="46d4cf49" id="8ca9ec9b" data-title="">      <p id="7bb64405">注意， <b id="adadf043">图</b>编辑器单元不必是编辑器定义的根。就像任何其他编辑器单元一样，它可以与其他编辑器单元一起组成更大的编辑器定义。</p>   </aside>   <p id="854857c8"><i id="5de247bf">图</i>单元需要其<i id="23c2786b">content</i>参数来容纳应成为图一部分的所有节点。在我们的例子中，我们传入所有组件（将呈现为块）及其依赖项（将呈现为连接器）。这些节点的呈现方式由它们各自的编辑器定义定义，如后面所述。</p>   <p id="35c4d7eb">在<i id="266dd7b0">Inspector</i> <b id="49bc31fc">元素</b>中，可以定义<b id="49bc31fc">创建</b>处理程序。每当在图中创建新的可视块时，就会调用它们。每个处理程序都有几个要设置的属性：</p>   <ul class="list _ul"><li class="list__item" id="8922ba0a"><p>         <i id="f8de9c34">名称</i> -代表完成菜单，并在调色板中创建一个新的元素的选择的任意名称</p></li><li class="list__item" id="1050f925"><p>         <i id="9c0b3497">容器</i> -应该将新创建的节点添加到的节点的集合</p></li><li class="list__item" id="a32a86de"><p>         <i id="c7d82128">概念</i> -即得到通过该处理程序中创建的节点的概念，默认为在<i id="7f2a8883">容器</i>中的节点的类型，但是允许的子类型来代替指定</p></li><li class="list__item" id="8a43d9c4"><p>         <i id="276239d8">创建时</i> -处理程序，可以在将节点添加到模型并在图中呈现之前对其进行操作。通常，将名称设置为一些有意义的值，并将块在屏幕上的位置保存到模型中。</p></li></ul>   <p id="006b5ef8">可以定义多个<b id="70b55ae0">元素创建</b>处理程序。</p>   <p id="28855d03">同样，可以为图单元定义<b id="fdb0a8c0">连接器创建</b>处理程序，以处理连接器创建。除了已经为<b id="39ed37c0">元素创建</b>处理程序描述的属性之外， <b id="7a4c6386">连接器创建</b>处理程序还具有以下特定属性：</p>   <ul class="list _ul"><li class="list__item" id="bd1a9b20"><p>         <i id="47c45780">可以创建</i> -一个返回布尔值并指示是否可以合法构造具有指定属性的连接器并将其添加到图中的概念函数。</p></li><li class="list__item" id="147e658d"><p>         <i id="d2a64d32">创建时</i> -用于处理now连接器的概念功能。</p></li><li class="list__item" id="7b34cdf1"><p>这些函数的<i id="b181ae78">from</i>和<i id="00029b8b">to</i>参数指定新连接的源节点和目标节点（由<b id="43d45597">Block</b>或<b id="eb8a8115">Port表示</b> ）。</p></li><li class="list__item" id="b815a431"><p>这些函数的<i id="99d49d9b">fromId</i>和<i id="00200d85">toId</i>参数指定新连接的源节点和目标节点的ID（由<b id="f308c5dd">Block</b>或<b id="10fc463c">Port表示</b> ）。</p></li></ul>   <p id="60075608">当用户在编辑器中双击时，将创建元素。如果有多种元素类型可用，则会显示完成弹出菜单。</p>   <p id="95964ce7">      当用户从<b id="149c0e69">源块</b>或其<b id="daf1c7b6">输出端口</b>拖动到<b id="e3e90133">目标块</b>或其<b id="1459228d">输入端口</b>时，将创建<b id="517c36f4">连接器</b> 。</p>   <h3 id="palette">调色板</h3>   <p id="933af3e7">      </p><figure><img alt="托盘" title="托盘" src="/help/img/idea/2019.2/di400.png" id="5f419c01" width="551" height="237"></figure>   <p></p>   <p id="12a30551">可选的调色板将允许开发人员在双击或拖动该图时选择一种类型的块和链接来创建。调色板是为图编辑器单元定义的，除了指定<b id="7bc987d8">创建</b>组件之外，还可以对调色板项进行可视化分组和分离。</p>   <h3 id="blocks">积木</h3>   <p id="9d77d7a7">想要作为<b id="2a196cf9">块</b>参与图表的节点的概念需要提供将保留有用的图表质量的属性，例如<b id="cfbc3f19">x / y坐标</b> ， <b id="251fadcf">大小</b> ， <b id="2ff3075c">颜色</b> ， <b id="46a5f2b4">标题</b>等。</p>   <p id="31415e8e">      </p><figure><img alt="图表属性" title="图表属性" src="/help/img/idea/2019.2/di7.png" id="54703b47" width="371" height="277"></figure>      <br>此外，节点应提供输入和输出端口，连接器可以直观地连接到这些端口。<p></p>   <p id="9247b388">然后，编辑器将使用<i id="d5429621">图节点</i>单元格：</p>   <p id="78a51f40">      </p><figure><img alt="图节点单元" title="图节点单元" src="/help/img/idea/2019.2/di9.png" id="1c7fbb01" width="570" height="156"></figure>      <br><b id="64f496b8">图节点</b>单元需要指定一个<b id="6b81136a">图</b> 。这是对<i id="7ebb1125">图形</i>类的引用，该类使用<i id="e312185a">jetpad</i>框架定义了块的视觉布局。MPS在<i id="c345b0f1">jetbrains.mps.lang.editor.figures.library</i>解决方案中附带了一组预定义的图形形状，您可以导入和使用它们。每个图可能会暴露几个具有图的视觉特征的<b id="9f6ff335">属性字段</b> 。所有图形参数都应在编辑器定义中指定，最有可能的方式是将它们映射到概念中定义的节点属性：<p></p>   <p id="bb4bdf7e">      </p><figure><img alt="概念图编辑器" title="概念图编辑器" src="/help/img/idea/2019.2/di8.png" id="a1176a73" width="856" height="118"></figure>   <p></p>   <p id="52fecb40">参数的值可以是对节点属性的引用，也可以是前缀<b id="52165d6e">＃</b>字符的<i id="ca8a2d77">BaseLanguage</i>表达式。您可以使用<i id="3f2dce79">它</i>来引用表达式中的已编辑节点。</p>   <p id="6affa46a">如果节点定义了输入和输出端口，则在此处也应将它们指定为参数，以便它们在图中显示。同样，要指定端口，您可以引用节点的属性，也可以使用以<b id="3fe124b9">＃</b>字符<i id="56cd56a0">开头的BaseLanguage</i>表达式。</p>   <aside class="tip sideblock" rel="6affa46a" id="287cc763" data-title="">      <p id="44e87870">作为所有编辑器单元，图表单元可以具有与之关联的<b id="f547549c">操作图</b> 。这样，您可以启用<b id="33cfc552">Delete</b>键以删除块或连接器。</p>   </aside>   <h3 id="customfigures">自定义数字</h3>   <p id="88f79848">另外，您可以定义自己的数字。这些是实现<i id="00c4dafc">jetbrains.jetpad.projectional.view的 <i id="46cca1f9">BaseLanguage</i>类<i id="00c4dafc">。视图</i>界面（或其后代）并使用<i id="a0c5415b">@Figure</i>注释进行注释。使用<i id="c85ace5f">@FigureParameter</i>批注来划分属性字段，例如<i id="ed6bf7d3">width</i> ， <i id="6ee4ed8d">height</i>等等。</i></p><i id="00c4dafc">   <p id="4010d74f">      </p><figure><img alt="myCell" title="myCell" src="/help/img/idea/2019.2/di10.png" id="83438803" width="774" height="447"></figure>   <p></p>   <p id="ccfe27f5"><i id="80323731">MovableContentView</i>界面为图形类提供了其他参数：</p>   <p id="0fbd6f89">      </p><figure><img alt="MovableContentView" title="MovableContentView" src="/help/img/idea/2019.2/di11.png" id="d3fd542e" width="804" height="106"></figure>   <p></p>   <p id="a4df63e1">通过研究<i id="c6e4970f">jetbrains.mps.lang.editor.figures.library，</i>您可以更好地了解<i id="c8fe50e3">jetpad</i>库及其内部工作原理。</p>   <h3 id="connectors">连接器</h3>   <p id="d65ebd2c">连接器将代表的节点不需要保留任何图表属性。从3.1版开始，连接器无法从视觉上进行自定义，并且始终显示为实心黑线。在以下版本的MPS之一中，这很可能会发生变化。</p>   <p id="25e6ba34">      </p><figure><img alt="连接器" title="连接器" src="/help/img/idea/2019.2/di12.png" id="2a6cf41e" width="376" height="239"></figure>   <p></p>   <p id="cc286ff5">节点的编辑器需要包含一个<b id="a2c07978">图连接器</b>单元：</p>   <p id="d4d9ca79">      </p><figure><img alt="图连接器单元" title="图连接器单元" src="/help/img/idea/2019.2/di13.png" id="c8af82ce" width="554" height="151"></figure>   <p></p>   <p id="56318f13">单元需要连接器的源和目标。这些<b id="acb801af">端口</b>可以是：</p>   <p id="1fddda67">      </p><figure><img alt="连接器设定" title="连接器设定" src="/help/img/idea/2019.2/di14.png" id="8ca91b1c" width="953" height="104"></figure>   <p></p>   <p id="918c1c39">或<b id="6f777551">节点</b>本身：</p>   <p id="0305e1c8">      </p><figure><img alt="连接器设定" title="连接器设定" src="/help/img/idea/2019.2/di15.png" id="7c50dd2d" width="807" height="101"></figure>   <p></p>   <p id="616a33b7">这些值可以再次直接引用节点的属性或以<b id="5b7ed900">＃</b>字符<i id="30d93244">开头的BaseLanguage</i>表达式。</p>   <h3 id="renderingports">渲染端口</h3>   <p id="616c4884">输入和输出端口应分别使用<i id="06acc3b6">输入端口</i>和<i id="8bb8afa1">输出端口</i>编辑器单元。无法在MPS 3.1中自定义端口的呈现，但很可能会在更高版本中启用。</p>   <aside class="tip sideblock" rel="616c4884" id="f67617f6" data-title="">      <p id="4969a5bc">使用<b id="f5058773">T</b>键将所选块的端口旋转90度。这样，您可以轻松地在从左到右和从上到下的端口位置之间切换。</p>   </aside>   <h3 id="usingimplicitports">使用隐式端口</h3>   <p id="9fa5d40c">在某些情况下，您将无法直接在模型中表示端口。您只想使用块和连接器，但是端口必须以某种方式从模型中派生。这种情况很容易得到支持：</p>   <ol class="list _decimal"><li class="list__item" id="3b665fd6"><p>确定端口的表示形式。每个端口将由唯一的标识符表示，例如数字或字符串</p></li><li class="list__item" id="bcd1aab6"><p>让块的概念定义返回标识符集合的行为方法-分别针对输入和输出端口<br>          </p><figure><img alt="定义行为" title="定义行为" src="/help/img/idea/2019.2/di1.png" id="96a8100a" width="371" height="256"></figure>      <p></p></li><li class="list__item" id="aa634b78"><p>使用这些方法将输入<b id="9832b8c7">端口</b>和<b id="3bc3a892">输出</b> <b id="9832b8c7">端口</b>参数提供给<b id="4da676de">DiagramNode</b>编辑器单元<br>          </p><figure><img alt="DiagramNode的方法" title="DiagramNode的方法" src="/help/img/idea/2019.2/di2.png" id="cb84e874" width="870" height="78"></figure>      <p></p></li><li class="list__item" id="75e7974d"><p>在连接器编辑器单元中，将块的节点称为<b id="64b85b8f">source</b>和<b id="d909e6a8">target</b> 。在<b id="59a2ca40">＃</b>符号后附加请求的ID<br>          </p><figure><img alt="连接器参考" title="连接器参考" src="/help/img/idea/2019.2/di3.png" id="d32ecf56" width="580" height="102"></figure>      <p></p></li></ol><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月30日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="extending-the-transformation-menu-language.html">扩展转换菜单语言</a> <a class="navigation-links__next" href="editor-language-generation-api.html">编辑器语言生成API</a></div></i></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>