<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>约束-帮助| MPS</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Constraints.html"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索MPS帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>MPS 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default" data-group="primary" selected>默认</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_mac_os_x" data-group="primary">Eclipse（Mac OS X）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_jbuilder" data-group="primary">JBuilder的</option><option value="primary_mac_os_x" data-group="primary">Mac OS X</option><option value="primary_mac_os_x_10.5_" data-group="primary">Mac OS X 10.5以上</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="secondary_default" data-group="secondary">默认</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_mac_os_x" data-group="secondary">Eclipse（Mac OS X）</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_jbuilder" data-group="secondary">JBuilder的</option><option value="secondary_mac_os_x" data-group="secondary">Mac OS X</option><option value="secondary_mac_os_x_10.5_" data-group="secondary">Mac OS X 10.5以上</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="constraints.xml" data-toc="Constraints.html">约束条件</h1>   <p id="82133311"><i id="39914592">结构语言</i>有时可能不足以表达对语言结构的高级约束。<i id="bb291375">约束</i>方面为您提供了一种定义此类附加约束的方法。</p>      <h2 id="defaultconcreteconcept">默认具体概念</h2>   <p id="272f0da5">对于抽象概念，可以使用“ <i id="60f7f8db">约束”</i>方面来指示，当需要创建抽象概念的节点时，应该改用哪个概念。</p>   <p id="4bd05a82">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/image2018-9-12-15-43-19.png"><img alt="image2018 9 12 15 43 19" title="image2018 9 12 15 43 19" src="/help/img/idea/2019.2/image2018-9-12-15-43-19.png" id="2767f85e" width="500" height="612"></a></figure>   <p></p>   <p id="b19f7060">例如，如果一个<i id="59d4ff52">子集合</i>应该保存<i id="911cb457">AbstractCommands</i> ，并且用户<i id="59d4ff52">按下</i> Enter键以将一个新的子项插入该集合， <i id="59d4ff52">则将</i>创建并插入<i id="59d4ff52">EmptyLine</i>概念的节点。</p>   <p id="cd4b4a81">同样。 smodel命令创建新节点并接受<i id="2851f2c4"><default></default></i>参数将正确创建具体概念而不是抽象概念的节点。</p>   <p id="09d10490">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/image2018-9-12-15-50-5.png"><img alt="image2018 9 12 15 50 5" title="image2018 9 12 15 50 5" src="/help/img/idea/2019.2/image2018-9-12-15-50-5.png" id="49af2113" width="500" height="102"></a></figure>   <p></p>   <h2 id="canbechild/parent/ancestor/root">可以是孩子/父母/祖先/根</h2>   <p id="15c33825">这些是定义概念约束时要旋转的第一个旋钮。他们确定是否可以将此概念的实例挂钩为其他节点的子节点（父代，祖先）或模型中的根节点。您将它们指定为<i id="afefa637">返回布尔值的</i>闭包，在评估AST中某个节点的允许位置时，MPS每次都会调用它们。</p>   <p id="1ca1fa3e">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/Constraintsx1.png"><img alt="约束x1" title="约束x1" src="/help/img/idea/2019.2/Constraintsx1.png" id="d3b5f32f" width="500" height="846"></a></figure>   <p></p>   <h4 id="languagestoimport">导入语言</h4>   <p id="5e87a4f2">为了能够定义约束，您很可能需要在<i id="29c8f6ca">constraints</i>方面至少导入两种语言<i id="83c86aa5">-jmbaselanguage</i>和<i id="d30253b6">jmlang.smodel</i>语言。</p>   <h4 id="canbechild">可以是孩子</h4>   <p id="77948c48">如果不允许将该概念的实例作为特定节点的子代，则返回false。</p>   <div class="table-wrapper"><table width="100%" id="265ceeb3"><thead><tr id="b983f332" class="ijRowHead"><th id="977ed109">            <p id="b4ee7b5b">参数</p>         </th><th id="48073ee7">            <p id="f6d746a7">描述</p>         </th></tr></thead><tbody><tr id="30660a67" class="ijRowOdd"><td id="5ab7d27e">            <p id="28ce9a62">operationContext</p>         </td><td id="d68e797a">            <p id="18344e70">IOperationContext</p>         </td></tr><tr id="04dc0616" class="ijRowEven"><td id="a6acc30d"><p>节点</p></td><td id="a37ee436"><p>我们正在检查的子节点（此概念的实例）</p></td></tr><tr id="c4745198" class="ijRowOdd"><td id="ee8b004b">            <p id="35fd05dd">parentNode</p>         </td><td id="0df6f915">            <p id="89648658">我们正在检查的父节点</p>         </td></tr><tr id="23ff45c9" class="ijRowEven"><td id="bc84fb6c">            <p id="d2d73581">childConcept</p>         </td><td id="95ed0424">            <p id="b25c0160">子节点的概念（可以是此概念的子概念）</p>         </td></tr><tr id="54ec436d" class="ijRowOdd"><td id="6598d585">            <p id="1092b1d1">链接</p>         </td><td id="bb3b8949">            <p id="f3de1c47">子节点的LinkDeclaration（可以从那里获取子角色）</p>         </td></tr></tbody></table></div>   <h4 id="canbeparent">可以是父母</h4>   <p id="009b5240">如果不允许概念的实例作为特定概念节点（在给定角色中）的父级，则返回false。</p>   <div class="table-wrapper"><table width="100%" id="71ac96a9"><thead><tr id="f0fb14f4" class="ijRowHead"><th id="1a4bfe14">            <p id="fbafc12d">参数</p>         </th><th id="62732d7f">            <p id="5ba73fd3">描述</p>         </th></tr></thead><tbody><tr id="e0bf55d2" class="ijRowOdd"><td id="28498599">            <p id="19739700">operationContext</p>         </td><td id="f6287ad6">            <p id="ab3c662c">IOperationContext</p>         </td></tr><tr id="b89eb1e9" class="ijRowEven"><td id="86b6b217">            <p id="980a3db2">childNode</p>         </td><td id="e8c7c2d1">            <p id="8b0cdae5">我们正在检查的子节点</p>         </td></tr><tr id="45ecffba" class="ijRowOdd"><td id="2c8eb8a3">            <p id="3d571de5">节点</p>         </td><td id="f9cd89f2">            <p id="b5b70315">我们正在检查的父节点（此概念的实例）</p>         </td></tr><tr id="862ec1ec" class="ijRowEven"><td id="a3571a47">            <p id="6a582dd2">childConcept</p>         </td><td id="7800d2d5">            <p id="8aa0f3b1">我们正在检查的子节点的概念</p>         </td></tr><tr id="c89c534d" class="ijRowOdd"><td id="fc4c83e3">            <p id="295edd69">链接</p>         </td><td id="98708438">            <p id="e4ec6253">子节点的LinkDeclaration</p>         </td></tr></tbody></table></div>   <h4 id="canbeancestor">可以是祖先</h4>   <p id="793b7704">如果不允许将该概念的实例作为特定节点的祖先，则返回false。</p>   <div class="table-wrapper"><table width="100%" id="bfc5ecc5"><thead><tr id="890e893c" class="ijRowHead"><th id="073800da">            <p id="d282a072">参数</p>         </th><th id="e1a82e43">            <p id="9d85feec">描述</p>         </th></tr></thead><tbody><tr id="d1101e31" class="ijRowOdd"><td id="c4cebd32">            <p id="0cc245f7">operationContext</p>         </td><td id="129a06e6">            <p id="13c5e801">IOperationContext</p>         </td></tr><tr id="85175bf9" class="ijRowEven"><td id="722a3067">            <p id="1b1f34ca">childNode</p>         </td><td id="ebe7c5ad">            <p id="8944baf1">我们正在检查的子节点</p>         </td></tr><tr id="4040808a" class="ijRowOdd"><td id="f414c7ff">            <p id="7d6ac22a">节点</p>         </td><td id="effdb278">            <p id="6d3b6557">我们正在检查的祖先节点（此概念的实例）</p>         </td></tr><tr id="4e861a7b" class="ijRowEven"><td id="e17997ef">            <p id="7da4e659">childConcept</p>         </td><td id="f3c96e61">            <p id="487ca883">后代节点的概念</p>         </td></tr></tbody></table></div>   <h4 id="canberoot">可以是根</h4>   <p id="112c08e7">此约束仅适用于可植根的概念（在概念结构描述中<b id="bf7c8429">实例可以是root的情况</b>是正确的）。如果concept的实例不能为给定模型的根，则返回false。</p>   <div class="table-wrapper"><table width="100%" id="cf599a77"><thead><tr id="079ea1f1" class="ijRowHead"><th id="80060631">            <p id="35d5bbe9">参数</p>         </th><th id="b4971cb3">            <p id="5fe185e3">描述</p>         </th></tr></thead><tbody><tr id="d4c18700" class="ijRowOdd"><td id="380a366e">            <p id="ee29d2ec">operationContext</p>         </td><td id="e0e1731d">            <p id="ac77afd1">IOperationContext</p>         </td></tr><tr id="e1e82d62" class="ijRowEven"><td id="1f46e3c1">            <p id="2fd29864">模型</p>         </td><td id="e11db758">            <p id="b806f598">根模型</p>         </td></tr></tbody></table></div>      <h2 id="propertyconstraints">属性约束</h2>   <p id="7af75e1e">从技术上讲， <i id="82594fd0">“纯”</i>概念属性不是其原始含义的属性，而只是公共领域。属性约束使您可以使它们成为真实属性。使用这些约束，可以自定义概念属性的行为。每个属性约束都应用于单个指定的属性。</p>   <p id="81c40f27">      <b id="40df8b7e">property-</b>应用于此约束的属性。</p>   <p id="e490b894">      <b id="06b8394a">get-</b>每次访问属性时，都会执行此方法以获取属性值。</p>   <div class="table-wrapper"><table width="100%" id="0c6d4966"><thead><tr id="435ad5d5" class="ijRowHead"><th id="54fde144">            <p id="7ea01f58">参数</p>         </th><th id="c13aa77f">            <p id="c19a9a44">描述</p>         </th></tr></thead><tbody><tr id="1006a9cd" class="ijRowOdd"><td id="02048ec0">            <p id="7c7bb3c0">节点</p>         </td><td id="4444754c">            <p id="7a08bd8d">从中获取属性的节点</p>         </td></tr></tbody></table></div>   <p id="6cdb329c">      <b id="7fd8b95f">集</b> -此方法执行到每个写集合属性值。该属性值保证有效。</p>   <div class="table-wrapper"><table width="100%" id="bbde4f10"><thead><tr id="b3dd7eec" class="ijRowHead"><th id="1d1e30dc">            <p id="46dbf30c">参数</p>         </th><th id="cf6e69f6">            <p id="54ee41cc">描述</p>         </th></tr></thead><tbody><tr id="0e6c448a" class="ijRowOdd"><td id="6c3721fb">            <p id="ee664045">节点</p>         </td><td id="9442ce07">            <p id="d5e9c51b">设置属性的节点</p>         </td></tr><tr id="3a02d2e1" class="ijRowEven"><td id="54cf2c35">            <p id="a23f9a97">适当的价值</p>         </td><td id="3b706a95">            <p id="32159a19">新财产价值</p>         </td></tr></tbody></table></div>   <p id="f3bf0555">      <b id="64f8e586">有效</b> -此方法应确定该属性的值是否有效。每次在更改值之前都会执行此方法，如果返回false，则不会执行set（）方法。</p>   <div class="table-wrapper"><table width="100%" id="00c84a9c"><thead><tr id="c5da22c3" class="ijRowHead"><th id="e7ff817f">            <p id="7cc370d7">参数</p>         </th><th id="03223047">            <p id="b2fbe970">描述</p>         </th></tr></thead><tbody><tr id="ef05a0f9" class="ijRowOdd"><td id="7ca8f9a8">            <p id="2f9bad00">节点</p>         </td><td id="a5a64b01">            <p id="3f04a0ab">检查属性的节点</p>         </td></tr><tr id="2cf23f17" class="ijRowEven"><td id="0eb7a3e2">            <p id="61f95a42">适当的价值</p>         </td><td id="9d722a7c">            <p id="3a01788b">要检查的值</p>         </td></tr></tbody></table></div>      <h3 id="example-customizingthedescriptioninthecompletionmenu">示例-在完成菜单中自定义描述</h3>   <p id="649f02f3">完成菜单列出了可用的节点以及一些其他描述性信息：</p>   <p id="50d1948e">      </p><figure><a class="lightbox" href="/help/img/idea/2019.2/sd1.png"><img alt="sd1" title="sd1" src="/help/img/idea/2019.2/sd1.png" id="0ef5e2f8" width="500" height="690"></a></figure>   <p></p>   <p id="671bedc6">为了自定义附加信息并提供关于完成菜单中列出的各个选项的更多详细信息，可以覆盖目标概念的<i id="77ccc83f">shortDescription</i>属性的getter：</p>   <p id="f8fc79c6"> </p>         <figure><img alt="sd2" title="sd2" src="/help/img/idea/2019.2/sd2.png" id="e90df98e" width="300" height="185"></figure>            <figure><a class="lightbox" href="/help/img/idea/2019.2/sd3.png"><img alt="sd3" title="sd3" src="/help/img/idea/2019.2/sd3.png" id="45121a94" width="500" height="686"></a></figure>      <h2 id="referentconstraints">参照约束</h2>   <p id="0fef0d6f">这种类型的约束有助于向概念的链接添加行为，并使它们看起来更像属性。</p>   <p id="5ae842a9">      <b id="e80705e2">参照集处理程序</b> -如果指定，则在此链接的每个集合上执行此方法。</p>   <div class="table-wrapper"><table width="100%" id="1d524fbf"><thead><tr id="b42cd773" class="ijRowHead"><th id="b373fb0f">            <p id="5e0c880a">参数</p>         </th><th id="2f57fa7d">            <p id="58bac5cf">描述</p>         </th></tr></thead><tbody><tr id="28a8ab2f" class="ijRowOdd"><td id="c2c15d45">            <p id="646e129b">referenceNode</p>         </td><td id="b75ea205">            <p id="107ebd01">包含链接的节点。</p>         </td></tr><tr id="856125bb" class="ijRowEven"><td id="e322bd2b">            <p id="ec23693e">oldReferentNode</p>         </td><td id="c5d596e8">            <p id="7ce2a7e4">参考的旧值。</p>         </td></tr><tr id="76823b6f" class="ijRowOdd"><td id="d9875eed">            <p id="b2588f37">newReferentNode</p>         </td><td id="dadf285d">            <p id="976a8ec2">参考的新值。</p>         </td></tr></tbody></table></div>   <p id="c545ef7c">      <br>       <b id="2c989d0b">作用域</b> -定义此链接可以指向的节点集。该方法返回一个<i id="522a8bc8">Scope</i>实例。请参阅<a href="scopes.html">作用域文档</a>以获取有关范围的更多信息。有两种类型的作用域引用约束：</p>   <ul class="list _ul"><li class="list__item" id="723a0b74"><p>遗传</p></li><li class="list__item" id="ebe0ffa0"><p>参考</p></li></ul>   <p id="e20072f1">虽然<b id="281bf101">继承的</b>作用域仅声明了目标概念，但是<b id="e70622a9">引用</b>作用域提供了一个从参数动态计算作用域的函数。</p>   <div class="table-wrapper"><table width="100%" id="6e9089a6"><thead><tr id="4ff7d394" class="ijRowHead"><th id="f4fdb5d8">            <p id="83c90a73">参数</p>         </th><th id="a6e553a9">            <p id="21d9b310">描述</p>         </th></tr></thead><tbody><tr id="ce0779b7" class="ijRowOdd"><td id="1f6e8666">            <p id="d7e54364">referenceNode</p>         </td><td id="d7279a75">            <p id="c80ef15c">包含实际链接的节点。当为具有智能引用的概念创建新节点时，它可以为null。在这种情况下，智能引用用于确定在enclosingNode上下文中创建哪种类型的节点，因此将使用空referenceNode调用搜索范围方法。</p>         </td></tr><tr id="dd0bee24" class="ijRowEven"><td id="e198291e">            <p id="e1b4056e">contextNode</p>         </td><td id="ddcf9be0">            <p id="709d711a">具有引用的节点或最近的非空上下文节点</p>         </td></tr><tr id="bd4cbed4" class="ijRowOdd"><td id="8f69980d">            <p id="d1eb257e">containmentLink</p>         </td><td id="363ac3f4">            <p id="f82237c3">SContainmentLink描述contextNode及其正在创建的不存在的子级之间的父子关系（如果存在referenceNode则此参数没有意义）</p>         </td></tr><tr id="14b200b9" class="ijRowEven"><td id="2d974863">            <p id="ba06ab80">linkTarget</p>         </td><td id="bc55542c">            <p id="b97ee730">该链接可以引用的概念。通常，它是引用的概念，因此它是静态已知的。如果我们专门在子概念中引用，并且没有为专门引用定义搜索范围，则可以使用linkTarget参数来确定需要哪种引用专门。</p>         </td></tr><tr id="2f3aea00" class="ijRowOdd"><td id="7130fc3d">            <p id="9a49f497">位置</p>         </td><td id="8fd44175">            <p id="9fb81f22">contextRole中的目标索引</p>         </td></tr></tbody></table></div>   <p id="e08c0d96">如果未为参考设置范围，则使用参考概念的默认范围。如果也未设置默认范围，则使用“全局”范围：所有导入模型中的参照概念的所有实例。</p>   <p id="3aced4f6">      <br>       <b id="e7942f94">表示（不推荐使用-编辑器方面现在指定了引用的表示形式，请参阅<a href="editor.html">Editor</a> ）</b> -在这里，您可以指定引用在编辑器和完成列表中的外观。有时，根据上下文不同地显示引用很方便。例如，在Java中，如果用相同名称的局部变量声明遮蔽了对实例字段<i id="7fc1d494">f的</i>所有引用，则应将其显示为<i id="9e332c86">this.f。</i>默认情况下，如果未设置任何表示，则引用节点的名称将用作其表示（假设它是INamedConcept）。</p>   <div class="table-wrapper"><table width="100%" id="ea4e919f"><thead><tr id="a2f02b20" class="ijRowHead"><th id="fa16afb1">            <p id="6faaee84">参数</p>         </th><th id="fdcb4630">            <p id="58d3b704">描述</p>         </th></tr></thead><tbody><tr id="c0f44dc0" class="ijRowOdd"><td id="2977eead"><p>模型</p></td><td id="86d9b130"><p>包含参考的节点模型</p></td></tr><tr id="b06ddc37" class="ijRowEven"><td id="3da8c2a6">            <p id="8aa0c858">parameterNode</p>         </td><td id="26b94edf">            <p id="381c749e">要显示的节点（referenceNode具有对linkTarget类型的parameterNode的引用）</p>         </td></tr><tr id="a36d0b61" class="ijRowOdd"><td id="c8137735"><p>位置</p></td><td id="2a8be51d"><p>contextRole中的目标索引</p></td></tr><tr id="8c0002bd" class="ijRowEven"><td id="c6d68adc"><p>存在</p></td><td id="0807079c"><p>创建引用时为false</p></td></tr><tr id="c4644217" class="ijRowOdd"><td id="5f657cbf">            <p id="12535241">可见</p>         </td><td id="b4be5620">            <p id="1ef818a2">true-现有节点的表示，false-新节点（在完成菜单中选择后创建）</p>         </td></tr><tr id="9453960f" class="ijRowEven"><td id="69dc0249">            <p id="3cfe0369">smartReference</p>         </td><td id="be8ae215">            <p id="b5060f6b">true-智能引用中显示了节点</p>         </td></tr><tr id="a404691e" class="ijRowOdd"><td id="fd284d03">            <p id="6462046d">inEditor</p>         </td><td id="2a1de30b">            <p id="e6943085">true-编辑器演示，false-完成菜单</p>         </td></tr><tr id="52171ae3" class="ijRowEven"><td id="ba999a6c"><p>contextNode</p></td><td id="39b38df7"><p>具有引用的节点，或者最接近的非空上下文节点</p></td></tr><tr id="25691e43" class="ijRowOdd"><td id="73dc1ef9"><p>contextRole</p></td><td id="0dae8845"><p>contextNode中的目标角色</p></td></tr><tr id="2fa4046e" class="ijRowEven"><td id="ea4d39b9"><p>referenceNode<br>封闭节点<br>linkTarget<br>包含链接</p></td><td id="a4ef3790"><p>不推荐使用</p></td></tr></tbody></table></div>      <h2 id="defaultscope">默认范围</h2>   <p id="0928382d">假设我们有一个指向概念C实例的链接，并且在引用约束中没有为此链接定义范围。编辑此链接时，默认情况下将显示所有导入的模型中概念C的所有实例。如果要限制到概念C的所有链接的可见实例集，则可以设置概念的<b id="d4c7db2b">默认范围</b> 。与参照约束一样，您可以设置<b id="30e1df48">搜索范围</b> ， <b id="626a669e">验证器</b>和<b id="1a7a398f">表示</b>方法。所有参数都相同。</p>   <p id="e0364be7">请参阅<a href="scopes.html">作用域文档</a>以获取有关范围的更多信息。</p><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月30日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="editor-language-generation-api.html">编辑器语言生成API</a> <a class="navigation-links__next" href="behavior.html">行为</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>