<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta name="description" content="
        dotCover how to, dotCover tutorials, .NET ASP web application coverage, console tools cover web app,
        unit integration tests web application coverage, IIS and IIS Express coverage
    " data-skip-index="skip"><title>使用Console Runner分析Web应用程序的覆盖范围-帮助|帮助dotCover</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Remotely_Cover_a_Web_Application" data-disqus-id="Remotely_Cover_a_Web_Application_dcv"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索dotCover帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>dotCover 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="rs" data-group="secondary">ReSharper 2.x / IntelliJ IDEA</option><option value="vs" data-group="primary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Remotely_Cover_a_Web_Application.xml" data-toc="Remotely_Cover_a_Web_Application">使用Console Runner分析Web应用程序的覆盖范围</h1>            <p id="5501906d">如果要自动覆盖Web应用程序（例如出于持续集成的目的），则必须使用<a href="Running_Coverage_Analysis_from_the_Command_LIne.html#setting-up-console-runner">dotCover控制台运行程序</a> 。</p>    <p id="6357566b">与<a href="Profiling_Guidelines__IIS.html">手动覆盖</a>不同，在<a href="Profiling_Guidelines__IIS.html">手动覆盖中</a> ，您只需单击“ <span class="control">获取快照”</span>按钮即可获取覆盖快照，而控制台运行程序仅在配置文件过程正确完成其工作后才能获取快照。因此，要获取快照，您应该在系统中正确停止IIS或运行控制台运行程序的第二个实例，然后将“获取快照并终止进程”命令显式发送到第一个正在运行的实例。第二个实例如何知道第一个实例？这非常简单：运行第一个实例时，您可以使用<code class="code">/Instance=<ID></code>论点。然后，您可以使用此ID将命令发送到实例。</p>    <p id="1c86fbe1">根据确切的覆盖方案以及使用IIS还是IIS Express托管应用程序，覆盖过程的执行方式有所不同。共有三种主要方案：</p><ol class="list _decimal"><li class="list__item" id="81c758b6"><p>获取Web应用程序的覆盖范围（ <a href="#to-get-coverage-of-a-web-application">IIS Express</a> / <a href="#to-get-coverage-of-a-web-application-iis">IIS</a> ）。</p></li><li class="list__item" id="f82fabdb"><p>                <a href="#to-get-coverage-of-tests-when-the-application-and-tests-are-run-separately">覆盖测试和（可选）Web应用程序。应用程序和测试分别启动</a> 。</p></li><li class="list__item" id="263c5bc5"><p>                <a href="#to-get-coverage-of-tests-when-the-application-is-started-from-tests">获取测试范围。该应用程序通过测试启动</a> 。</p></li></ol>    <p></p>        <section class="procedure-steps"><h3 id="to-get-coverage-of-a-web-application">覆盖Web应用程序（IIS Express）</h3><ol class="list _decimal"><li class="list__item" id="dfbbe17d"><p>使用dotCover控制台运行程序，启动IIS Express和您的应用程序。例如：</p><div class="code-block" data-lang="none"><code class="code-block__wrapper">dotCover.exe cover /TargetExecutable="C:\Program Files (x86)\IIS Express\iisexpress.exe" /TargetArguments=/site:MyWebApp /systray:false /Output=coverageReport.xml /ReportType=XML /Instance=1</code></div>这里<code class="code">Instance</code>是当前dotCover.exe实例的ID。您将使用此ID向该控制台运行程序发送命令。<br>的<code class="code">/systray:false</code>如果您并行启动多个IIS Express实例，则该参数有意义。<p></p></li><li class="list__item" id="82abca67"><p>在涵盖的应用程序中，经历所需的场景或执行执行此操作的测试。</p></li><li class="list__item" id="b0945015"><p>运行第二个控制台运行器实例，该实例将“获取快照并终止进程”命令发送到第一个正在运行的实例：</p><div class="code-block" data-lang="none"><code class="code-block__wrapper">dotCover.exe send /Command=GetSnapshotAndKillChildren /Instance=1</code></div>这里<code class="code">Instance</code>是您在步骤1中指定的第一个dotCover.exe实例的ID。<p></p></li><li class="list__item" id="bf972b84"><p>发送命令后，IIS Express和dotCover.exe实例将停止并保存coverage快照。</p></li></ol></section>        <section class="procedure-steps"><h3 id="to-get-coverage-of-a-web-application-iis">覆盖Web应用程序（IIS）</h3><ol class="list _decimal"><li class="list__item" id="4c1b4935"><p>确保您在服务器上具有管理特权。</p></li><li class="list__item" id="8f559bef"><p>使用dotCover控制台运行程序，开始IIS服务的覆盖范围。例如：</p><div class="code-block" data-lang="none"><code class="code-block__wrapper">dotCover.exe cover-iis /Output=coverageReport.xml /ReportType=XML /Instance=1</code></div>这里<code class="code">Instance</code>是当前dotCover.exe实例的ID。您将使用此ID向该控制台运行程序发送命令。<p></p></li><li class="list__item" id="4d5d5cfa"><p>在涵盖的应用程序中，经历所需的场景或执行执行此操作的测试。</p></li><li class="list__item" id="a6f91620"><p>运行第二个控制台运行器实例，该实例将“获取快照并终止进程”命令发送到第一个正在运行的实例：</p><div class="code-block" data-lang="none"><code class="code-block__wrapper">dotCover.exe send /Command=GetSnapshotAndKillChildren /Instance=1</code></div>这里<code class="code">Instance</code>是您在步骤2中指定的第一个dotCover.exe实例的ID。<p></p></li><li class="list__item" id="96df9cf6"><p>发送命令后，将停止IIS服务和dotCover.exe实例，并保存coverage快照。</p></li></ol></section>        <section class="procedure-steps"><h3 id="to-get-coverage-of-tests-when-the-application-and-tests-are-run-separately">如果应用程序和测试分别运行，则覆盖测试</h3><ol class="list _decimal"><li class="list__item" id="dba71362"><p>确保您在服务器上具有管理特权。</p></li><li class="list__item" id="dc0cf059"><p>确认应用程序<span class="emphasis">尚未</span>在IIS Express或IIS应用程序池的一个实例上运行。</p></li><li class="list__item" id="2e1018df"><p>运行该应用程序（如果您还想了解该应用程序，请跳过此步骤）。</p></li><li class="list__item" id="945a2d0c"><p>使用dotCover控制台运行程序，开始覆盖后续的.NET进程。例如：</p><div class="code-block" data-lang="none"><code class="code-block__wrapper">dotCover.exe cover-everything /Output=coverageReport.xml /ReportType=XML /Instance=1</code></div>这里<code class="code">Instance</code>是当前dotCover.exe实例的ID。您将使用此ID向该控制台运行程序发送命令。<br>请注意， <code class="code">cover-everything</code>模式，控制台运行程序将获取其后运行的<span class="emphasis">所有</span>托管进程的覆盖率数据。<p></p></li><li class="list__item" id="5fc8b5c5"><p>[仅当您跳过步骤3时]运行该应用程序。</p></li><li class="list__item" id="81a01ee3"><p>运行测试。</p></li><li class="list__item" id="a6ae07d7"><p>运行第二个控制台运行器实例，该实例将“获取快照并终止进程”命令发送到第一个正在运行的实例：</p><div class="code-block" data-lang="none"><code class="code-block__wrapper">dotCover.exe send /Command=GetSnapshotAndKillChildren /Instance=1</code></div>这里<code class="code">Instance</code>是您在步骤4中指定的第一个dotCover.exe实例的ID。<p></p></li><li class="list__item" id="0edb9a78"><p>发送命令后，IIS Express和dotCover.exe实例将停止并保存coverage快照。请注意，如果应用程序是在步骤5中而不是在步骤3中运行的，则控制台运行程序将获得两个快照（一个快照用于应用程序，一个快照用于测试）并将它们合并为一个快照。</p></li></ol></section>        <section class="procedure-steps"><h3 id="to-get-coverage-of-tests-when-the-application-is-started-from-tests">如果应用程序由测试运行，则覆盖测试</h3><ol class="list _decimal"><li class="list__item" id="6c2a6fe6"><p>使用dotCover控制台运行程序，在覆盖范围内启动测试。例如，如果使用NUnit：</p><div class="code-block" data-lang="none"><code class="code-block__wrapper">dotcover.exe cover /TargetExecutable="C:\Program Files\NUnit 2.6\bin\nunit-console.exe" /TargetArguments=C:\MyWebApp\bin\Debug\AppTests.dll /Output=coverageReport.xml /ReportType=XML /Instance=1</code></div>这里<code class="code">Instance</code>是当前dotCover.exe实例的ID。您将使用此ID向该控制台运行程序发送命令。<p></p></li><li class="list__item" id="41e9d003"><p>测试程序集安装程序必须在IIS Express / IIS应用程序池中启动应用程序。</p></li><li class="list__item" id="8b78cdfe"><p>测试程序集拆解必须运行以下命令：</p><div class="code-block" data-lang="none"><code class="code-block__wrapper">dotCover.exe send /Command=GetSnapshotAndKillChildren /Instance=1</code></div>这里<code class="code">Instance</code>是您在步骤1中指定的第一个dotCover.exe实例的ID。<p></p></li><li class="list__item" id="bd24d040"><p>发送命令后，将停止IIS Express / IIS应用程序池，dotCover.exe实例以及执行测试的进程，并保存coverage快照。</p></li></ol></section><div class="last-modified" data-skip-index="skip">上次修改时间：2019年9月30日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Coverage_Results_Filters.html">覆盖率结果筛选器</a> <a class="navigation-links__next" href="dotCover__Server_Test_Coverage.html">分析服务器上的覆盖率</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>