<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"></meta><meta name="robots" content="noindex"></meta><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>V8 CPU and Memory Profiling - Help | RubyMine</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="V8_CPU_and_Memory_Profiling" data-breadcrumbs="Framework-specific guidelines/Developing_Node_JS_Applications.xml|Node.js/V8_CPU_and_Memory_Profiling.xml|V8 CPU and Memory Profiling" data-main-title="V8 CPU and Memory Profiling"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search RubyMine Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>RubyMine 2019.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default_for_windows" selected>Default for Windows</option><option data-group="primary" value="primary_default_for_macos">Default for macOS</option><option data-group="primary" value="primary_intellij_idea_classic_macos">IntelliJ IDEA Classic (macOS)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_macos">Eclipse (macOS)</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_sublime_text">Sublime Text</option><option data-group="primary" value="primary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="primary" value="primary_textmate">TextMate</option><option data-group="secondary" value="secondary_default_for_windows">Default for Windows</option><option data-group="secondary" value="secondary_default_for_macos">Default for macOS</option><option data-group="secondary" value="secondary_intellij_idea_classic">IntelliJ IDEA Classic</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_macos">Eclipse (macOS)</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_sublime_text">Sublime Text</option><option data-group="secondary" value="secondary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="secondary" value="secondary_textmate">TextMate</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 data-toc="V8_CPU_and_Memory_Profiling" id="V8_CPU_and_Memory_Profiling.xml">V8 CPU and Memory Profiling</h1>            <p id="ws_v8_profiling_intro">        With RubyMine, you can capture and analyze CPU profiles and heap snapshots        for your <span class="emphasis">Node.js</span> applications using <a href="https://v8.dev/docs/profile" data-external="true" target="_blank" rel="noopener noreferrer">V8’s sample-based profiler</a>.    </p>    <p id="ce0c2971">        You can also open and explore profiles and snapshots captured in Google Chrome DevTools for your client-side        code.    </p>    <div class="chapter"><h2 id="node_profiling_before_you_start" data-toc="V8_CPU_and_Memory_Profiling#node_profiling_before_you_start">Before you start</h2>        <section class="procedure-steps"><ul class="list "><li class="list__item" id="677303c8"><p>                <a name="ws_install_repo_plugin"></a>                                Install and enable the NodeJS repository plugin on the        <a href="plugins-settings.html">Plugins page</a>  as described in <a href="managing-plugins.html">Managing plugins</a>.                                                                                                                                </p></li></ul></section>    </div>    <div class="chapter"><h2 id="ws_node_cpu_profiling" data-toc="V8_CPU_and_Memory_Profiling#ws_node_cpu_profiling">CPU profiling</h2>        <p id="1a25cd5d">            CPU profiling helps you get a better understanding            of which parts of your code take up the most CPU time,            and how your code is executed and optimized by the V8 JavaScript engine.        </p>        <p id="9be1c640">            Node.js CPU profiling in RubyMine is based on the V8  built-in CPU profiler,            which provides information about the execution of your code and the behavior of the JavaScript engine itself            including garbage collection cycles, compilation and re-compilation, and code optimization.        </p>        <p id="488ad203">            The profiler takes snapshots  at certain intervals that are called ticks.            Measurements are made not only for the work of your code, but also for the activities performed by the engine itself, such as compilation,            calls of system libraries, optimization, and garbage collection.        </p>        <section class="procedure-steps"><h3 id="ws_node_configuring_cpu_profiling">Enable CPU profiling</h3><p id="9f1a839f">                    To invoke V8 CPU profiling on application start, you need to specify additional settings                    in the <span class="control">Node.js</span> run configuration.                </p><ol class="list _decimal"><li class="list__item" id="9db9136b"><p>                    <a name="start_creating_run_config_short_1"></a>        From the main menu, select <span data-skip-index="skip" class="menupath">Run | Edit Configuration</span>.                            <a name="start_creating_run_config_short_2"></a>                        Click <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.add@2x.png" width="16" alt="the Add button"> on the toolbar  and select <span class="control">Node.js</span> from the list.                    </p></li><li class="list__item" id="dc86c556"><p>                    From the list, select the <span class="emphasis">Node.js</span> run configuration to activate CPU Profiling                    in or                    create a new configuration                    as described in <a href="running-and-debugging-node-js.html">Running and Debugging Node.js</a>.                </p></li><li class="list__item" id="774232bb">                    <p id="d77cd365">                    Switch to the <span class="control">V8 Profiling</span> tab and select the <span class="control">Record CPU profiling info</span> checkbox.                        In the <span class="control">Log folder</span> field, specify the path to the folder where the recorded logs will be stored, log files are named                        <code class="code">isolate-&lt;session number&gt;</code>.                    </p>                                        <figure><img alt="V8 profiler tab" title="V8 profiler tab" src="/help/img/idea/2019.3/ws_v8_profiler_tab_light.png" id="21018f9d" class=" _border-line" width="600" height="461"></figure>                </li></ol></section>        <section class="procedure-steps"><h3 id="ws_node_collecting_cpu_profiling_data">Collect CPU profiling information</h3><ol class="list _decimal"><li class="list__item" id="2a2f7520">                    <p id="6e50df43">                    Select the run configuration from the list on the main toolbar and click <img class="inline-icon-13" src="/help/img/idea/2019.3/icons.toolwindows.toolWindowRun@2x.png" width="13" alt="the Run button">                    or select <span data-skip-index="skip" class="menupath">Run | Run &lt;configuration name&gt;</span> from the main menu.                    </p>                </li><li class="list__item" id="e9dc27a7">                    <p id="848c4900">                    When the scenario that you need to profile is executed, stop the process by clicking                     <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.suspend@2x.png" width="16" alt="the Stop button"> on the toolbar.                    </p>                </li></ol></section>        <div class="chapter"><h3 id="ws_node_analyzing_cpu_profiling_data">Analyzing CPU profiling logs</h3>            <p id="251339bb">                When you stop your application, RubyMine automatically opens the                <span class="control">V8 Profiling</span> tool window and shows the collected profiling data in it.                <a name="v8ProfilingOpenSeveralTabs"></a>        If the window is already open and shows the collected data for another session, RubyMine opens a new tab.                    Tabs that were opened automatically are named after the run configurations                that control execution of the applications and  collecting the profiling data.            </p>            <p id="1bbacb1b">                To open and analyze some previously saved profiling data, go to <span data-skip-index="skip" class="menupath">Tools | V8 Profiling - Analyze V8 Profiling Log</span>                and select the relevant V8 log file <code class="code">isolate-&lt;session number&gt;</code>. RubyMine creates a separate tab with the name of the selected log file.            </p>                    <p id="8fa5abc6">                        Based on the collected profiling data, RubyMine builds three call trees and displays each of them in a separate pane.                        With these call trees you can analyze the application execution from two different points of view: on the one hand,                        which calls were time consuming ("heavy"), and on the other hand, "who called whom".                    </p>            <div class="chapter"><h4 id="ws_v8_spu_profiling_call_trees_metrics">Understanding the metrics in the call trees</h4>            <p id="a152e183">                The call trees use the <span class="emphasis">Total</span> and <span class="emphasis">Self</span> metrics that present the number of ticks in a function or its ratio to the total execution time:            </p>            <ul class="list _bullet"><li class="list__item" id="64256ff6"><p>                    <span class="emphasis">Total</span> shows how much time was spent inside a function and the functions it called.                </p></li><li class="list__item" id="e9f2912e"><p>                    <span class="emphasis">Self</span> shows how much time was spent only inside a function itself without  taking into account its child nodes.                </p></li></ul>                <p id="81fa30a3">                    The <span class="emphasis">Of Parent</span> metric shows the ratio of the pure execution time of a function to the execution                    time of the function that called it (<span class="emphasis">Parent</span>).                </p>            </div>            <div class="chapter"><h4 id="ws_v8_spu_profiling_call_trees_optimization">V8 optimiser</h4>            <p id="ws_v8_cpu_profiling_optimization">                In some cases, V8 can optimize your code, see <a href="http://floitsch.blogspot.de/2012/03/optimizing-for-v8-introduction.html" data-external="true" target="_blank" rel="noopener noreferrer">Optimizing for V8</a> for details:            </p>            <ul class="list _bullet"><li class="list__item" id="a41d7b28"><p>                    An asterisk <code class="code">*</code> before the name of a function indicates that the function has been optimized.                </p></li><li class="list__item" id="5e0d9a49">                    <p id="96d3437d">                        A tilde <code class="code">~</code> indicates that the function possibly requires optimization but has not been optimized for some reasons.                        The engine may postpone optimization or skip it if the code is short-running, however                        a tilde points at the place where the code can be rewritten to achieve better performance.                    </p>                </li></ul>            </div>            <div class="chapter"><h4 id="ws_v8_spu_profiling_call_trees_top_calls">Top Calls tree</h4>                    <p id="45cd109a">                        The <span class="control">Top Calls</span> pane lists the performed activities in the descending order sorted by the <span class="emphasis">Self</span> metrics.                        For each activity, its <span class="emphasis">Total</span>, <span class="emphasis">Total%</span>, and <span class="emphasis">Self%</span> metrics are shown.                        <a name="V8ProfilingFunctionCallLineColumn"></a>        For each function call, RubyMine displays the name of the file, the line, and the  column where the function is defined.                        </p>                                    <figure><img alt="V8 CPU profiling: Top Calls tree" title="V8 CPU profiling: Top Calls tree" src="/help/img/idea/2019.3/v8ProfilerCPUTopCalls_light.png" id="9c05a073" class=" _border-line" width="600" height="878"></figure>                    <p id="d272d509">                        The diagram in the <span class="control">Overview</span> pane shows distribution of <span class="emphasis">Self</span> time for calls                        with the <span class="emphasis">Self%</span> metrics above 1%.                    </p>                </div>                <div class="chapter"><h4 id="ws_v8_spu_profiling_call_trees_bottom_up">Bottom-up tree</h4>                                        <p id="ws_v8_cpu_profiling_call_trees_bottom_up_intro">                        The <span class="control">Bottom-up</span> pane also lists the performed activities sorted in the descending order by the <span class="emphasis">Self</span> metrics. Unlike the <span class="control">Top Calls</span> pane,                        the <span class="control">Bottom-up</span> pane shows only the activities with the <span class="emphasis">Total%</span> metrics above 2 and the functions that called them.                    </p><aside data-type="tip" class="prompt" data-title="" rel="ws_v8_cpu_profiling_call_trees_bottom_up_intro" id="99ac89a3">                        <p id="4809629c">                            The <span class="control">Bottom-up</span> tree is helpful if you encounter                            a <span class="emphasis">heavy</span> function and want to find out where it was called from.                        </p>                    </aside>                    <ul class="list _bullet"><li class="list__item" id="35ffc0f8"><p>                            For each activity, its execution time in <span class="emphasis">ticks</span> and the <span class="emphasis">Of Parent</span> metrics are shown.                        </p></li><li class="list__item" id="a35135ff"><p>                            <a name="V8ProfilingFunctionCallLineColumn"></a>        For each function call, RubyMine displays the name of the file, the line, and the  column where the function is defined.                            </p></li></ul>                                        <figure><img alt="V8 CPU profiling: Bottom-up tree" title="V8 CPU profiling: Bottom-up tree" src="/help/img/idea/2019.3/v8ProfilerCPUBottomUp_light.png" id="ee2582d0" class=" _border-line" width="600" height="630"></figure>                </div>                <div class="chapter"><h4 id="ws_v8_spu_profiling_call_trees_top_down">Top-down tree</h4>                    <p id="e334bd05">                        The <span class="control">Top-down</span> pane shows the entire call hierarchy with the functions that are execution entry points shown at the top.                        For each activity, its <span class="emphasis">Total</span>, <span class="emphasis">Total%</span>, <span class="emphasis">Self</span>, and <span class="emphasis">Self%</span> metrics are shown.                        <a name="V8ProfilingFunctionCallLineColumn"></a>        For each function call, RubyMine displays the name of the file, the line, and the  column where the function is defined.                        </p>                    <figure><img alt="V8 profiling: Top-down tree" title="V8 profiling: Top-down tree" src="/help/img/idea/2019.3/v8ProfilerCPUTopDown_light.png" id="71dae1e0" class=" _border-line" width="600" height="818"></figure>                                    </div>            <section class="procedure-steps"><h3 id="53f2dd3a">Navigate through the call trees</h3><ul class="list "><li class="list__item" id="4e94a272">                    <p id="723df123">                    To navigate to the source code of a function, select this function and                    press <kbd data-primary_default_for_windows="F4" data-primary_default_for_macos="⌘+Down" data-primary_intellij_idea_classic_macos="F4" data-primary_emacs="F4" data-primary_visual_studio="F4" data-primary_default_for_xwin="F4" data-primary_default_for_gnome="F4" data-primary_default_for_kde="F4" data-primary_eclipse="F12" data-primary_eclipse_macos="F3" data-primary_netbeans="F4" data-primary_sublime_text="F4" data-primary_sublime_text_macos="N/A" data-primary_textmate="F4" data-secondary_default_for_windows="F4" data-secondary_default_for_macos="⌘↓" data-secondary_intellij_idea_classic="F4" data-secondary_emacs="F4" data-secondary_visual_studio="F4" data-secondary_default_for_xwin="F4" data-secondary_default_for_gnome="F4" data-secondary_default_for_kde="F4" data-secondary_eclipse="F12" data-secondary_eclipse_macos="F3" data-secondary_netbeans="F4" data-secondary_sublime_text="F4" data-secondary_sublime_text_macos="N/A" data-secondary_textmate="F4">F4</kbd>                    or <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.edit@2x.png" width="16" alt="the Edit button">                    on the toolbar  or select <span class="control">Jump to source</span> from the context menu.                    </p>                </li><li class="list__item" id="21ed1b6f">                    <p id="b1825171">                        To switch to another pane and examine a call from another perspective,                        select the call and click                         <img class="inline-icon-16" src="/help/img/idea/2019.3/NodeJS.com.jetbrains.nodejs.icons.Navigate_inMainTree@2x.png" width="16" alt="the Navigate to button">                        on the toolbar or select <span class="control">Navigate To</span> from the context menu of the call, and then select the destination.                        RubyMine switches to the selected pane and moves the focus to the call.                    </p>                </li></ul></section>                <section class="procedure-steps"><h3 id="67fe92e4">Expand or collapse nodes</h3><p id="2fc3c54c">                        When RubyMine opens a tab for a profiling session, by default it expands the nodes with heaviest calls. While exploring the trees, you may like to fold some of these nodes or expand other ones.                    </p><ul class="list "><li class="list__item" id="5ac33286">                        <p id="ecdc49c7">                        To expand or collapse a node, select <span class="control">Expand Node</span> or <span class="control">Collapse Node</span> from its context menu.                        </p>                    </li><li class="list__item" id="071fe9c8">                        <p id="eeea16fa">                        To collapse all the nodes in the active pane, click                        <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.collapseall@2x.png" width="16" alt="the Collapse All button"> on the toolbar.                        </p>                    </li><li class="list__item" id="3c7d305d">                        <p id="c2e9fb9b">                            To restore the original tree presentation, click                            <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.expandall@2x.png" width="16" alt="the Expand Heavy Traces button">.                        </p>                    </li></ul></section>                <section class="procedure-steps"><h3 id="06626347">Filter out light calls</h3><p id="80e73245">                        Do this to see only the calls that actually cause performance problems.                    </p><ul class="list "><li class="list__item" id="d6fad9dd">                        <p id="49a0c304">                        Click <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.filter@2x.png" width="16" alt="the Filter button">                        on the toolbar, then,                            using the slider, specify the minimum <span class="emphasis">Total%</span> or <span class="emphasis">Parent%</span> value for a call to be displayed, and click <span class="control">Done</span>.                        </p>                    </li></ul></section>                <section class="procedure-steps"><h3 id="3a82b822">Save and compare profiling data</h3><ul class="list "><li class="list__item" id="e0c91876">                        <p id="e551518f">                            To save a line with a function and its metrics, select <span class="control">Copy</span> from the context menu of the function.                            This may be helpful if you want to compare the measurements for a function from two sessions, for example, after you make some improvements to the code.                        </p>                    </li><li class="list__item" id="2e58afb1">                        <p id="e72fe279">                            To save only the function name and the name of the file where it is                            defined,                            select <span class="control">Copy Call</span> from the context menu of the function.                        </p>                    </li><li class="list__item" id="8c4e08b3"><p>                        To compare an item with the contents of the Clipboard, select <span class="control">Compare With Clipboard</span> from the context menu of the item.                        RubyMine opens the <span class="emphasis">Difference Viewer</span>.                    </p></li><li class="list__item" id="1c759409"><p>                        To compare the current log with another isolate, click <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.diff@2x.png" width="16" alt="the Compare with button"> on the toolbar.                        In the dialog that opens, select the isolate to compare the current one with. To narrow down the search,                        specify whether the target isolate was taken before or after the current one.                    </p></li></ul></section>                    <section class="procedure-steps"><h3 id="22c85aff">Export call trees</h3><ul class="list "><li class="list__item" id="693d63d4">                            <p id="a7976a57">                                To save the call tree in the current pane to a text file, click                                <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.toolbarDecorator.export@2x.png" width="16" alt="the Export button">                                on the toolbar and specify the target file in the dialog that opens.                            </p>                        </li></ul></section>            <div class="chapter"><h4 id="ws_node_profiling_analyzing_flame_chart">Analyzing the Flame Chart</h4>                <p id="d1eeb234">                    Use the multicolor <span class="control">Flame Chart</span> to find where the application paused and explore the calls that provoked these pauses.                </p>                                <figure><img alt="Flame Chart" title="Flame Chart" src="/help/img/idea/2019.3/ws_v8_profiler_flame_chart_light.png" id="8877bc64" class=" _border-line" width="600" height="736"></figure>                <p id="914d13d1">                    The chart consists of four areas:                </p>                <ul class="list _ul"><li class="list__item" id="1c80fee7"><p>                        The upper area shows a timeline with two sliders to limit the beginning and the end of a fragment to investigate.                    </p></li><li class="list__item" id="36e58b17"><p>                        The bottom area shows a stack of calls in the form of a multicolor chart. When called for the first time, each function is assigned a random color,                        whereupon every call of this function within the current session is shown in this color.                    </p></li><li class="list__item" id="765eb065"><p>                        The middle area shows a summary of  calls from the <span class="emphasis">Garbage Collector</span>, the engine, the external calls,                        and the execution itself. The colors reserved for these activities are listed on top of the area.                    </p></li><li class="list__item" id="3bc3792f"><p>                        The right-hand pane lists the calls within a selected fragment, for each call the list shows its duration, the name of the called function,                        and file where the function is defined.                    </p></li></ul>                <p id="c50aab03">                    The bottom and the right-hand areas are synchronized: as you drag the slider in the bottom area through the timeline,                    the focus in the right-hand pane moves to the call that was performed at each moment.                </p>                <p id="45f25484">                    Moreover, if you click a call in the bottom area, the slider moves to it automatically                    and the focus in the right-hand pane switches to the corresponding function, if necessary the list scrolls automatically.                    And vice versa, if you click an item in the list, RubyMine selects the corresponding call in the bottom area                    and drags the slider to it automatically:                </p>                <section class="procedure-steps"><h3 id="181ab043">Select fragments in the Timeline</h3><ul class="list "><li class="list__item" id="dddab7fd">                        <p id="89d60b08">                        To explore  the processes within a certain period of time, you need to select the corresponding fragment in the timeline.                        To do that, drag the sliders or click the <span class="emphasis">window</span> between two sliders and drag it to the required fragment.                        </p>                        <p id="0039e9fd">                            In either case, the multicolor chart below shows the stack of calls within the selected fragment.                        </p>                    </li><li class="list__item" id="95dbe76a"><p>                        To enlarge the chart, click the selected fragment and then click <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.zoomIn@2x.png" width="16" alt="the Zoom button">                        on the toolbar. RubyMine opens a new tab and shows the selected fragment enlarged to fit the tab width so you can examine the fragment with more details.                    </p></li></ul></section>                    <section class="procedure-steps"><h3 id="9332881e">Navigate through the Flame Chart</h3><p id="9186af08">                            From the calls in the right-hand area, you can jump to the source code of called functions, to the other panes of the tool window, and to the areas in the flame chart with specific metrics.                        </p><ul class="list "><li class="list__item" id="a5a1108e">                            <p id="38191cc1">                            To jump to the source code of a called function, select <span class="control">Jump to Source</span> from the context menu of the call.                            </p>                        </li><li class="list__item" id="1c5a4c58">                            <p id="a19358e7">                                To have the flame chart zoomed at the fragments with specific metrics of a call,                                select the call and click                                 <img class="inline-icon-16" src="/help/img/idea/2019.3/NodeJS.com.jetbrains.nodejs.icons.Navigate_inMainTree@2x.png" width="16" alt="the Navigate to button">                                or select <span class="control">Navigate To</span> from the context menu of the call,                                and then select the metrics.                            </p>                        </li><li class="list__item" id="62b701a3">                            <p id="489cbd6c">                                You can also navigate to the stack trace of a call to view and analyze exceptions. To do that, select <span class="control">Show As Stack Trace</span> from the context menu of the call.                                RubyMine opens the stack trace in a separate tab,                                to return to the <span class="control">Flame Chart</span> pane, click the <span class="control">V8 CPU Profiling</span>  tool window button in the bottom.                            </p>                        </li></ul></section>            </div>        </div>    </div>    <div class="chapter"><h2 id="ws_node_memory_profiling" data-toc="V8_CPU_and_Memory_Profiling#ws_node_memory_profiling">Memory profiling</h2>        <p id="5979ec86">            Memory profiling lets you detect memory leaks and dynamic memory problems and locate the fragments of code that caused them.        </p>        <section class="procedure-steps"><h3 id="ws_node_configuring_memory_profiling">Enable memory profiling</h3><p id="1c554f9c">                To invoke taking memory snapshots on application start, you need to specify additional settings                in the <span class="control">Node.js</span> run configuration.            </p><ol class="list _decimal"><li class="list__item" id="3e24fa36"><p>                    <a name="start_creating_run_config_short_1"></a>        From the main menu, select <span data-skip-index="skip" class="menupath">Run | Edit Configuration</span>.                            <a name="start_creating_run_config_short_2"></a>                        Click <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.add@2x.png" width="16" alt="the Add button"> on the toolbar  and select <span class="control">Node.js</span> from the list.                    </p></li><li class="list__item" id="98f659b0"><p>                    From the list, choose the <span class="emphasis">Node.js</span> run configuration to activate CPU Profiling                    in or                    create a new configuration                    as described in <a href="running-and-debugging-node-js.html">Running and Debugging Node.js</a>.                </p></li><li class="list__item" id="d82f6b7f">                    <p id="b7cc9b01">                        Switch to the <span class="control">V8 Profiling</span> tab and select the <span class="control">Allow taking heap snapshots</span> checkbox.                    </p>                </li></ol></section>            <section class="procedure-steps"><h3 id="ws_node_collecting_memory_profiling_data">Collect memory profiling information</h3><ol class="list _decimal"><li class="list__item" id="4901d195">                    <p id="518dc533">                        Select the run configuration from the list on the main toolbar and click <img class="inline-icon-13" src="/help/img/idea/2019.3/icons.toolwindows.toolWindowRun@2x.png" width="13" alt="the Run button">                        or select <span data-skip-index="skip" class="menupath">Run | Run &lt;configuration name&gt;</span> from the main menu.                    </p>                </li><li class="list__item" id="e7dcf93f">                    <p id="54038dc9">                    At any time during the application execution, click                        <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.startMemoryProfile@2x.png" width="16" alt="the Take Heap Snapshot button">                        on the toolbar of the <span class="control">Run</span> tool window.                    </p>                </li><li class="list__item" id="b34102d1">                    <p id="a1cdc5fe">                    In the dialog that opens, specify the name for the snapshot and the path to the folder where it will be stored.                    To start analyzing the snapshot immediately, select the <span class="control">Open snapshot</span> checkbox.                    </p>                </li></ol></section>        <div class="chapter"><h3 id="ws_node_analyzing_memory_profiling_data">Analyzing memory snapshots</h3>            <p id="9b0878c9">                When you take a snapshot and choose to analyze it, RubyMine opens the <span class="control">V8 Heap</span> tool window                with the  collected data.                <a name="v8ProfilingOpenSeveralTabs"></a>        If the window is already open and shows the collected data for another session, RubyMine opens a new tab.                </p>            <p id="9b9071d7">                To open and analyze some previously saved memory profiling data, go to <span data-skip-index="skip" class="menupath">Tools | V8 Profiling - Analyze V8 Heap Snapshot</span>                and select the relevant <span class="filepath">.heapsnapshot</span> file. RubyMine creates a separate tab with the                name of the selected file.            </p>            <p id="ef61819a">                The tool window has three tabs that present the collected information from different points of views.            </p>                <ul class="list _bullet"><li class="list__item" id="60f7919f">                        <p id="9f65d78d">                            The <span class="control">Containment</span> tab shows the objects in your application grouped under several top-level entries: <span class="emphasis">DOMWindow objects</span>,                            <span class="emphasis">Native browser objects</span>, and  <span class="emphasis">GC Roots</span>, which are roots the <span class="emphasis">Garbage Collector</span> actually uses.                            See <a href="https://developer.chrome.com/devtools/docs/javascript-memory-profiling#containment-view" data-external="true" target="_blank" rel="noopener noreferrer">Containment View</a> for details.                        </p>                        <p id="e29ccdbc">                            For each object, the tab shows its <span class="emphasis">distance from the GC root</span>, that is the shortest simple path of nodes between the object and the GC root,                            the <a href="https://developer.chrome.com/devtools/docs/javascript-memory-profiling#shallow-size" data-external="true" target="_blank" rel="noopener noreferrer">shallow size</a>  of the object,                            and the <a href="https://developer.chrome.com/devtools/docs/javascript-memory-profiling#retained-size" data-external="true" target="_blank" rel="noopener noreferrer">retained size</a> of the object.                            Besides the absolute values of the object's size, RubyMine shows the percentage of memory the object occupies.                        </p>                    </li><li class="list__item" id="0aa3a2fc">                        <p id="f62beb7e">                            The <span class="control">Biggest Objects</span> tab shows the most memory-consuming objects                            sorted by their <a href="https://developer.chrome.com/devtools/docs/javascript-memory-profiling#retained-size" data-external="true" target="_blank" rel="noopener noreferrer">retained sizes</a>.                            In this tab, you can spot memory leaks provoked by accumulating data in some global object.                        </p>                    </li><li class="list__item" id="2afdfa60">                        <p id="6196e339">                            The <span class="control">Summary</span> tab shows the objects in your application grouped by their types.                            The tab shows the number of objects of each type, their size, and the percentage of memory that they occupy.                            This information may be a clue to the memory state.                        </p>                    </li></ul>            <p id="9f9d5532">                Each tab has a <span class="control">Details</span> pane, which shows the path to the currently selected object from GC roots                and the list of object’s <span class="emphasis">retainers</span>, that is, the objects that keep links to the selected object.                Every heap snapshot has many “back” references and loops, so there are always many retainers for each object.            </p>                <section class="procedure-steps"><h3 id="750a3bcc">Mark objects with text labels</h3><p id="bdc484e6">                        Labels help you differentiate objects and move from one to another without losing the context.                    </p><ul class="list "><li class="list__item" id="dc9f1b97">                        <p id="d3f5f946">                            To set a label to an object, select the object and click                            <img class="inline-icon-16" src="/help/img/idea/2019.3/platform-impl.com.intellij.ide.ui.laf.icons.graphite.checkmark@2x.png" width="16" alt="the Mark button">                            on the toolbar or select <span class="control">Mark</span> from the context menu. Then specify the text label in the dialog that opens.                        </p>                    </li></ul></section>                <section class="procedure-steps"><h3 id="aeb01d1a">Navigate through snapshots</h3><ul class="list "><li class="list__item" id="52c5681d">                        <p id="c43b83b0">                            To navigate to the function or variable that corresponds to an object, select this object and click                            <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.edit@2x.png" width="16" alt="the Editr button"> on the toolbar                            or select <span class="control">Edit Source</span> from the context menu. If the button and the menu option are disabled, this means that RubyMine has not found any functions                            or variables that correspond to the selected object.                        </p>                        <p id="1bc42f4a">                            If several functions or variables are found, RubyMine shows them in a suggestion list.                        </p>                    </li><li class="list__item" id="d18faa4f">                        <p id="5865f186">                            To help you investigate objects from the containment point of view and concentrate on the links between objects,                            RubyMine lets you jump from an object in the <span class="control">Biggest Objects</span> or <span class="control">Summary</span> tab or in the <span class="control">Occurrences</span> view                            to the same object in the <span class="control">Containment</span> tab.                        </p>                        <p id="192b1ae9">                            To do that, select the object                            and click                             <img class="inline-icon-16" src="/help/img/idea/2019.3/NodeJS.com.jetbrains.nodejs.icons.Navigate_inMainTree@2x.png" width="16" alt="the Navigate to button"> on the toolbar                            or select <span class="control">Navigate in Main Tree</span> from the context menu.                        </p>                    </li></ul></section>                <section class="procedure-steps"><h3 id="1d53d4ef">Search through snapshots</h3><ol class="list _decimal"><li class="list__item" id="657f1f0a"><p>                        In the <span class="control">Containment</span> tab, click <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.find@2x.png" width="16" alt="the Find button"> on the toolbar.                    </p></li><li class="list__item" id="330fa517">                        <p id="416705b6">                            In the <span class="control">V8 Heap Search</span> dialog that opens, specify the search pattern and the scope to search in. The available scopes are:                        </p>                        <ul class="list _bullet"><li class="list__item" id="44945128"><p>                                <span class="control">Everywhere:</span> select this checkbox to search in all the scopes.                                When this checkbox is selected, all the other search types are disabled.                            </p></li><li class="list__item" id="0395330e">                                <p id="6710242f">                                    <span class="control">Link Names:</span> select this checkbox to search among the object names that <span class="emphasis">V8</span> creates                                    when calling the <span class="emphasis">C++ runtime</span>.                                </p>                                <p id="a1d86f1d">                                    In the                                    <span class="control">V8 Heap</span> tool window,                                    link names are marked with the <code class="code">%</code> character <code class="code">%&lt;link name&gt;</code>.                                </p>                            </li><li class="list__item" id="13289c3b"><p>                                <span class="control">Class Names:</span> select this checkbox to search among functions-constructors.                            </p></li><li class="list__item" id="72588b74"><p>                                <span class="control">Text Strings:</span> select this checkbox to perform a textual search in the contents of the objects.                            </p></li><li class="list__item" id="b68e164a">                                <p id="5f5cdec8">                                    <span class="control">Snapshot Object IDs:</span> select this checkbox to search among the unique identifiers of objects.                                    <span class="emphasis">V8</span> assigns such a unique identifier in the format to each object when the object is created and                                    preserves it until the object is destroyed. This means that you can find and compare the same objects in several snapshots taken                                    within the same session.                                </p>                                <p id="53e3b752">                                    In the                                    <span class="control">V8 Heap</span> tool window,                                    object IDs are marked with the <code class="code">@</code> character <code class="code">@&lt;object id&gt;</code>.                                </p>                            </li><li class="list__item" id="02b66e4d"><p>                                <span class="control">Marks:</span> select this checkbox to search among the labels you set to objects manually                                by clicking <img class="inline-icon-16" src="/help/img/idea/2019.3/platform-impl.com.intellij.ide.ui.laf.icons.graphite.checkmark@2x.png" width="16" alt="the Mark button"> on the toolbar of the <span class="control">Containment</span> tab.                            </p></li></ul>                    </li></ol><p id="de3780c1">                        The search results are displayed in the <span class="control">Details</span> pane, in a separate <span class="control">Occurrences of '&lt;search pattern&gt;'</span> view.                        To have the search results shown grouped by the search scopes you specified, press the <span class="control">Group by Type</span> toggle button on the toolbar.                    </p><p id="cec1e896">                        When you open the dialog next time, it will show the settings from the previous search.                    </p></section>        </div>    </div>    <div class="last-modified" data-skip-index="skip">Last modified: 28 November 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="unit-testing-node-js.html">Testing Node.js</a><a class="navigation-links__next" href="installing-and-removing-external-software-using-node-package-manager.html">npm and Yarn</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>