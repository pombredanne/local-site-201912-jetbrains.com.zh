<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"></meta><meta name="robots" content="noindex"></meta><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Profiling applications - Help | RubyMine</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Settings.RubyProfiler" data-breadcrumbs="Analyzing applications/CPU_Profiler.xml|Profiling applications" data-main-title="Profiling applications"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search RubyMine Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>RubyMine 2019.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default_for_windows" selected>Default for Windows</option><option data-group="primary" value="primary_default_for_macos">Default for macOS</option><option data-group="primary" value="primary_intellij_idea_classic_macos">IntelliJ IDEA Classic (macOS)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_macos">Eclipse (macOS)</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_sublime_text">Sublime Text</option><option data-group="primary" value="primary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="primary" value="primary_textmate">TextMate</option><option data-group="secondary" value="secondary_default_for_windows">Default for Windows</option><option data-group="secondary" value="secondary_default_for_macos">Default for macOS</option><option data-group="secondary" value="secondary_intellij_idea_classic">IntelliJ IDEA Classic</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_macos">Eclipse (macOS)</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_sublime_text">Sublime Text</option><option data-group="secondary" value="secondary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="secondary" value="secondary_textmate">TextMate</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 data-toc="Settings.RubyProfiler" id="CPU_Profiler.xml">Profiling applications</h1>                                                     <p id="2016316b">            RubyMine provides the ability to profile running Ruby/Rails processes using the <a href="https://rbspy.github.io/" data-external="true" target="_blank" rel="noopener noreferrer">rbspy</a> sampling profiler.            The profiler collects information about the execution of your application.            You can run Ruby/Rails applications with the attached profiler, or you can attach the profiler to the already running processes.            After you stop the profiling session, you can analyze how much time is spent on each method/block and determine performance issues.        </p>        <p id="bfe85c16">            In this topic, we’ll show you how to run/stop the profiling session and analyze results.        </p>        <div class="chapter"><h2 id="prerequisites" data-toc="Settings.RubyProfiler#prerequisites">Prerequisites</h2>            <p id="dc68980b">                Before starting a profiling session, install the <span class="emphasis">rbspy</span> profiler for your platform using this instruction:                <a href="https://rbspy.github.io/installing/" data-external="true" target="_blank" rel="noopener noreferrer">Installing rbspy</a>.                After that, you will be able to profile applications with local Ruby MRI interpreters from the 1.9.1 and later versions.                If your version is not supported, create an issue in the <span class="emphasis">rbspy</span> Github repository:                <a href="https://github.com/rbspy/rbspy/issues" data-external="true" target="_blank" rel="noopener noreferrer">https://github.com/rbspy/rbspy/issues</a>.            </p>        </div>        <div class="chapter"><h2 id="profiling_settings" data-toc="Settings.RubyProfiler#profiling_settings">Configure profiling settings</h2>            <p id="e0f2b72b">                Before running the profiling session, you can adjust the profiler settings.                Open the <span class="control">Settings/Preferences</span> dialog and go to                <span class="control">Build, Execution, Deployment | Ruby Profiler</span>.                Here you can specify the following options:            </p>            <ul class="list _ul"><li class="list__item" id="8b603f3c"><p>                    <span class="control">Name</span> - specify the profiler name.                </p></li><li class="list__item" id="83310f4d"><p>                    <span class="control">RbSpy executable</span> - specify the path to the <span class="emphasis">rbspy</span> executable.                </p></li><li class="list__item" id="0511021d"><p>                    <span class="control">Profile rate</span> - set how many samples per seconds are recorded.                </p></li><li class="list__item" id="9784b9f7"><p>                    <span class="control">Profile subprocesses</span> - specify whether to profile subprocesses for the profiled process.                </p></li></ul>            <p id="63a4ec63">                In this dialog, you can use the <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.add@2x.png" width="16" alt="Add New Configuration"> button                to add additional profiles with specific settings. The <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.remove@2x.png" width="16" alt="Delete">                button removes the selected profile.            </p>        </div>        <div class="chapter"><h2 id="run_profiling_session" data-toc="Settings.RubyProfiler#run_profiling_session">Run the profiling session</h2>            <p id="32efdab7">                RubyMine provides two main ways to run the profiling session:            </p>            <ul class="list _ul"><li class="list__item" id="2f05960f"><p>                    Running Ruby/Rails applications with the attached profiler                </p></li><li class="list__item" id="77614560"><p>                    Attaching the profiler to the already running processes                </p></li></ul>            <p id="e308ff40">                The procedures below show how to start a profiling session.            </p>            <section class="procedure-steps"><div class="collapse"><div class="collapse__title"><h3 id="run_profiler_ruby_script">Run the Ruby script with the profiler</h3></div><div class="collapse__content"><ul class="list "><li class="list__item" id="a6e20a56"><p>                    Right-click the script in the editor or Project view, and select <span class="control">Run '<span class="emphasis">script name</span>' with 'RbSpy profiler'</span>.                </p></li></ul></div></div></section>            <section class="procedure-steps"><div class="collapse"><div class="collapse__title"><h3 id="run_profiler_test">Run the test(s) with the profiler</h3></div><div class="collapse__content"><p id="2a30a17c">                    Do one of the following:                </p><ul class="list "><li class="list__item" id="e3790dae"><p>                    To profile a specific test, click the <img class="inline-icon-12" src="/help/img/idea/2019.3/icons.runConfigurations.testState.run@2x.png" width="12" alt="Run Test"> button                    next to this test and select <span class="control">Run '<span class="emphasis">test name</span>' with 'RbSpy profiler'</span>.                    <figure><img alt="Profile a test using a gutter" title="Profile a test using a gutter" src="/help/img/idea/2019.3/rm_profiler_run_test_editor.png" id="78f2d8d4" width="600" height="398"></figure>                </p></li><li class="list__item" id="beaf33b2"><p>                    To profile tests inside a specific file, right-click the script in the editor or Project view,                    and select <span class="control">Run '<span class="emphasis">test name</span>' with 'RbSpy profiler'</span>.                </p></li><li class="list__item" id="93957e62"><p>                    To profile tests inside a specific folder, right-click this folder in the Project view,                    and select <span class="control">Run with 'RbSpy profiler'</span>.                </p></li></ul></div></div></section>            <section class="procedure-steps"><div class="collapse"><div class="collapse__title"><h3 id="run_profiler_rails">Run the Ruby/Rails configuration with the profiler</h3></div><div class="collapse__content"><p id="621e4d7c">                    RubyMine allows you to run any Ruby/Rails-specific configuration with the profiler attached.                    For example, this might be the Ruby, Rails, Rake, or RSpec configuration.                    To run the required configuration with the profiler, perform the following steps:                </p><ol class="list _decimal"><li class="list__item" id="835fcf7c"><p>                    Select the required run configuration on the <a href="guided-tour-around-the-user-interface.html">main toolbar</a>.                </p></li><li class="list__item" id="9c0bdec0"><p>                    Click the <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.profile@2x.png" width="16" alt="Run with Profiler"> button next to the selected configuration and choose                    <span class="control">Run '<span class="emphasis">configuration name</span>' with 'RbSpy Profiler'</span>.                    <figure><img alt="Profile configuration" title="Profile configuration" src="/help/img/idea/2019.3/rm_profiler_run_configuration_toolbar.png" id="af976ba8" width="733" height="108"></figure>                </p></li></ol></div></div></section>            <section class="procedure-steps"><div class="collapse"><div class="collapse__title"><h3 id="attach_profiler">Attach the profiler to a running process</h3></div><div class="collapse__content"><p id="03df69a6">                    To attach the profiler to the Ruby/Rails process already running on your machine, do the following:                </p><ol class="list _decimal"><li class="list__item" id="ae60dfaf"><p>                    From the main menu, select <span class="control">Run | Attach Profiler to Process</span>.                </p></li><li class="list__item" id="47a8e1ad"><p>                    Select the required process from the popup and press <kbd data-primary_default_for_windows="Enter" data-primary_default_for_macos="Enter" data-primary_intellij_idea_classic_macos="Enter" data-primary_emacs="Enter" data-primary_visual_studio="Enter" data-primary_default_for_xwin="Enter" data-primary_default_for_gnome="Enter" data-primary_default_for_kde="Enter" data-primary_eclipse="Enter" data-primary_eclipse_macos="Enter" data-primary_netbeans="Enter" data-primary_sublime_text="Enter" data-primary_sublime_text_macos="Enter" data-primary_textmate="Enter" data-secondary_default_for_windows="⏎" data-secondary_default_for_macos="⏎" data-secondary_intellij_idea_classic="⏎" data-secondary_emacs="⏎" data-secondary_visual_studio="⏎" data-secondary_default_for_xwin="⏎" data-secondary_default_for_gnome="⏎" data-secondary_default_for_kde="⏎" data-secondary_eclipse="⏎" data-secondary_eclipse_macos="⏎" data-secondary_netbeans="⏎" data-secondary_sublime_text="⏎" data-secondary_sublime_text_macos="⏎" data-secondary_textmate="⏎">Enter</kbd>.                    <figure><img alt="Attach with RbSpy Profiler to" title="Attach with RbSpy Profiler to" src="/help/img/idea/2019.3/rm_profiler_attach_popup.png" id="e85f298c" width="396" height="210"></figure>                </p></li></ol></div></div></section>            <section class="procedure-steps"><div class="collapse"><div class="collapse__title"><h3 id="stop_profiler">Stop the profiling session</h3></div><div class="collapse__content"><p id="b6b58be3">                    The profiling session will be stopped automatically after stopping an application.                    To stop the profiling session manually, do the following:                </p><ol class="list _decimal"><li class="list__item" id="6f39a4d1"><p>                    Open the <span class="control">Profiler</span> tool window.                </p></li><li class="list__item" id="967d24c4"><p>                    Click the <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.suspend@2x.png" width="16" alt="Stop Profiler"> button.                </p></li></ol></div></div></section>            <p id="5728d8c5">                After the profiling session is finished, you can analyze profiling results.            </p>        </div>                                <div class="chapter"><h2 id="analyze_results" data-toc="Settings.RubyProfiler#analyze_results">Analyze profiling results</h2>            <p id="5a6e3841">                Profiling data for this script will be displayed on three tabs -                <span class="control">Flame Chart</span>, <span class="control">Call Tree</span>, and <span class="control">Method List</span>.                In the left-hand part, you can filter data by the specified thread.            </p>            <figure><img alt="Profiling results" title="Profiling results" src="/help/img/idea/2019.3/rm_profiler_results.png" id="5504f4e7" width="800" height="470"></figure>            <div class="chapter"><h3 id="flame_chart">Flame Chart</h3>                <p id="c6772d23">                    This tab shows you the state of the call stack at any moment of time.                    Each frame represents a method/block in the stack (a stack frame).                    On the Y-axis, there is a stack depth going from bottom up.                    The X-axis shows the stack sorted from the most time-consuming methods/blocks to the least consuming ones.                </p>                <figure><img alt="Flame chart" title="Flame chart" src="/help/img/idea/2019.3/rm_profiler_flame_chart.png" id="bfb6c846" width="600" height="360"></figure>                <aside data-type="tip" class="prompt" data-title="" rel="bfb6c846" id="c7764637"><p>                    Note that project and gem frames have different colors.                </p></aside>                <p id="8ebb9dab">                    When you read the flame chart, focus on the widest frames.                    You can start from the bottom and move up, following the code flow from parent to child frames.                </p>                <p id="37d90b05">                    To navigate within the flame chart, do the following:                </p>                <section class="procedure-steps"><ul class="list "><li class="list__item" id="ea4d7975"><p>                        To zoom in/out the chart, use <kbd data-bypass="true" class="keystroke"><span class="keystroke__value">Ctrl+mouse wheel</span></kbd> or                        <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.zoomIn@2x.png" width="16" alt="Zoom in">/<img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.zoomOut@2x.png" width="16" alt="Zoom out"> buttons on the toolbar.                        You can use the <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.actualZoom@2x.png" width="16" alt="Actual zoom"> button to reset to the initial chart width.                    </p></li><li class="list__item" id="09d4c0f8"><p>                        Use the mouse or arrow keys to scroll the chart.                    </p></li><li class="list__item" id="b1cacb23"><p>                        Navigate to a specific method by using a double-click.                        In this case, the chart shows the call stack starting with a parent method colored with grey.                    </p></li></ul></section>                <p id="2cd86f25">                    You can also analyze data in the flame chart in the following ways:                </p>                <section class="procedure-steps"><ul class="list "><li class="list__item" id="14286947"><p>                        Hover the mouse over any item to view the details.                    </p></li><li class="list__item" id="bd7e2e06"><p>                        Right-click the item and select <span class="control">Jump to Source</span> to open corresponding code in the editor.                    </p></li><li class="list__item" id="1d7be302"><p>                        Right-click the item and select <span class="control">Focus on method in Methods List</span>                        to the corresponding method in the <a href="#methods_list">Methods List</a> tab.                    </p></li></ul></section>            </div>            <div class="chapter"><h3 id="call_tree">Call Tree</h3>                <p id="dad49816">                    The <span class="control">Call Tree</span> tab shows the program call tree with the percentage of each method in the total profiling time.                </p>                <figure><img alt="Call tree" title="Call tree" src="/help/img/idea/2019.3/rm_profiler_call_tree.png" id="eb622d40" width="600" height="414"></figure>                <p id="6668afc4">                    To configure and filter the Call Tree view, use the                     <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.gearPlain@2x.png" width="16" alt="Tree Node View Settings"> and                    <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.filter@2x.png" width="16" alt="Call Tree Filter Settings"> buttons.                </p>            </div>            <div class="chapter"><h3 id="methods_list">Method List</h3>                <p id="b5469444">                    The <span class="control">Method List</span> tab shows the list of methods sorted by the number of samples.                </p>                <figure><img alt="Method list" title="Method list" src="/help/img/idea/2019.3/rm_profiler_method_list.png" id="da7945a3" width="600" height="506"></figure>                <p id="2e4e143e">                    For each method from the list, the profiler provides more information on the nested tabs.                    The <span class="control">Back Traces</span> tab shows where the selected method has been called.                    The <span class="control">Merged Callees</span> tab shows call traces that started from the selected method.                </p>            </div>        </div>                                        <div class="chapter"><h2 id="export_results" data-toc="Settings.RubyProfiler#export_results">Export profiling results</h2>            <p id="4c59b2da">                To export profiling results to a file, do the following:            </p>            <section class="procedure-steps"><ol class="list _decimal"><li class="list__item" id="f9177bde"><p>                    From the main menu, select <span class="control">View | Tool Windows | Profiler</span> to open the profiler tool window.                </p></li><li class="list__item" id="912dc62d"><p>                    In the left-hand toolbar, click <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.toolbarDecorator.export@2x.png" width="16" alt="Export Profiler Result">.                </p></li><li class="list__item" id="bfdf0b7d"><p>                    In the dialog that opens, name the file and specify a folder in which you want to save it. Click <span class="control">Save</span>.                </p></li></ol></section>        </div>                                <div class="chapter"><h2 id="import_results" data-toc="Settings.RubyProfiler#import_results">Import profiling results</h2>            To import profiling results from a file, select <span class="control">Run | Import Profiler Results | From File</span> from the main menu.            For example, this can be useful if you want to analyze profiling results recorded on the production server using <span class="emphasis">rbspy</span>.        </div>    <div class="last-modified" data-skip-index="skip">Last modified: 28 November 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="creating-custom-inspections.html">Create custom inspections</a><a class="navigation-links__next" href="analyzing-duplicates.html">Analyze duplicates</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>