<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>使用dotPeek作为符号服务器-帮助|帮助dotPeek</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Using_product_as_a_Symbol_Server" data-article-props="
                {
                
            " seeals=":[=" titl=":=" procedure=",=" link=":=" ur=":" generating_pdb_files.htm="," tex=":" generate="" pdb="" file="}=" exporting_assembly_to_project.htm="," export="" assembly="" to="" projec="}=" referenc=",=" reference__project_pdb_generation.htm="," project="" generation="" status="" windo="}=" ="" data-disqus-id="Using_product_as_a_Symbol_Server_dpk"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索dotPeek帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>dotPeek 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="rs" data-group="secondary">ReSharper 2.x / IntelliJ IDEA</option><option value="vs" data-group="primary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Using_product_as_a_Symbol_Server.xml" data-toc="Using_product_as_a_Symbol_Server">使用dotPeek作为符号服务器</h1>    <p id="symbol_server">dotPeek可以用作符号服务器，也就是说，它可以向调试器提供调试已编译程序集所需的信息。</p>    <p id="f253d0ef">与传统的符号服务器（例如<a href="http://support.microsoft.com/kb/311503" rel="noopener noreferrer" data-external="true" target="_blank">Microsoft Symbol Server）相比</a> ，dotPeek不存储任何符号文件，它为请求的程序集生成PDB和源文件，并将它们返回给调试器。</p>    <div class="chapter"><h2 id="running-dotpeek-symbol-server" data-toc="Using_product_as_a_Symbol_Server#running-dotpeek-symbol-server">运行dotPeek符号服务器</h2>        <section class="procedure-steps"><h3 id="c0cc289b">启动/停止dotPeek符号服务器</h3><ul class="list "><li class="list__item" id="3dac35ac"><p>单击<span class="control">启动/停止符号服务器</span> <img alt="启动/停止符号服务器" title="启动/停止符号服务器" src="/help/img/dotnet/2019.2/icon_start_symbol_server.png" id="0d80276b" width="16" height="16" class="inline-icon-16">在工具栏上。</p></li><li class="list__item" id="ca5ff249"><p>选择<span class="menupath" data-skip-index="skip">工具|</span>在主菜单中<span class="menupath" data-skip-index="skip">启动/停止Symbol Server</span> 。</p></li></ul></section>        <p id="2a751d71">在dotPeek符号服务器的第一次启动时，要求您选择要为其生成符号文件的程序集。请参阅下面的<a href="#configure">配置dotPeek符号服务器</a>以了解配置选项。</p>        <p id="ad16fd66">dotPeek符号服务器启动后，相应的图标就会出现在状态栏中。您可以将鼠标指针悬停在其上方以检查其地址和当前配置：</p>        <figure><img alt="状态栏中的dotPeek符号服务器图标" title="状态栏中的dotPeek符号服务器图标" src="/help/img/dotnet/2019.2/symbol_server_status.png" id="6a556b7e" width="483" height="163"></figure>        <p id="5e17752e">要使用dotPeek符号服务器，可以在调试器设置中指定其地址。在Microsoft Visual Studio中，配置如下：</p>        <section class="procedure-steps"><h3 id="65e25d40">设置Visual Studio以使用dotPeek Symbol Server</h3><ol class="list _decimal"><li class="list__item" id="6a3fc3fb"><p>在Visual Studio菜单中，选择“ <span class="menupath" data-skip-index="skip">工具” |“工具”。选项|调试|符号</span> 。</p></li><li class="list__item" id="a0c0c0e1"><p>单击<span class="control">添加新位置，</span>并为其指定以下地址： <span class="filepath">http：// localhost：33417 /</span> 。（端口号可在dotPeek选项的“ <span class="menupath" data-skip-index="skip">符号服务器”</span>页面上配置。</p><figure><img alt="在Visual Studio中调试符号选项" title="在Visual Studio中调试符号选项" src="/help/img/dotnet/2019.2/vs_symbol_options.png" id="633e75f5" width="530" height="276"></figure>            <p></p></li><li class="list__item" id="988a5244"><p>在Visual Studio选项中，转到“ <span class="control">调试” |</span> “ <span class="control">调试”。常规</span>页面，然后清除<span class="control">启用我的代码</span>复选框。</p></li></ol></section>        <aside class="prompt" rel="65e25d40" id="f4fe7dfb" data-type="tip" data-title="">            <p id="733db5d4">为了能够在已编译的代码中设置断点，请选择“ <span class="menupath" data-skip-index="skip">调试” |“调试”。新断点|</span>在Visual Studio菜单中的<span class="menupath" data-skip-index="skip">功能</span>上<span class="menupath" data-skip-index="skip">中断</span> 。有关更多信息，请参见<a href="https://msdn.microsoft.com/en-us/library/15d1wtaf%28v=vs.90%29.aspx" rel="noopener noreferrer" data-external="true" target="_blank">如何：设置功能断点</a> 。</p>        </aside>    </div>    <div class="chapter"><h2 id="configure" data-toc="Using_product_as_a_Symbol_Server#configure">配置dotPeek符号服务器</h2>        <p id="ad87ad13">dotPeek符号服务器允许您选择应为其生成符号文件的确切程序集。正确的配置可以防止您意外进入系统程序集或您不感兴趣的其他程序集。</p>        <section class="procedure-steps"><h3 id="504e7aad">配置dotPeek符号服务器</h3><a name="step_open_options_and_choose_page"></a><ol class="list _decimal"><li class="list__item" id="a2b7eaff"><p>            <a name="open_options_raw"></a>选择<span class="menupath" data-skip-index="skip">工具|</span>在主菜单中<span class="menupath" data-skip-index="skip">的选项</span> ，然后选择左侧<span class="menupath" data-skip-index="skip">符号服务器</span> 。</p></li><li class="list__item" id="359552ee">使用单选按钮，为选择<span class="control">生成符号文件（.pdb）</span>下的选项之一。 <a name="generate_symbols_options"></a>                    前四个选项的含义很明显。最后一个具有最大的灵活性-选择此选项后，您只能选择调试所需的程序集， <a href="Opening_Assembly_Files.html">然后在Assembly Explorer中打开它们</a> 。<aside class="prompt" rel="420869b0" id="213868fb" data-type="tip" data-title="">                        <p id="906382aa">必要时，您可以使用<a href="Managing_Assemblies.html">程序集列表</a>来加载所需的程序集。</p>                    </aside>                            </li><li class="list__item" id="34cf75bc"><p>（可选）您可以更改将用于dotPeek符号服务器的端口号。</p></li><li class="list__item" id="54cca98f"><p>单击<span class="control">确定</span> 。</p></li></ol></section>    </div>    <div class="chapter"><h2 id="possible-problems-and-solutions" data-toc="Using_product_as_a_Symbol_Server#possible-problems-and-solutions">可能的问题和解决方案</h2>        <p id="3cb18fab">如果dotPeek符号服务器<span class="keyword">出了点问题</span> ，您可以做的第一件事是打开“ <a href="Reference__Project_PDB_Generation.html">项目/ PDB生成状态”窗口</a> （在dotPeek的菜单中，单击“ <span class="menupath" data-skip-index="skip">Windows |项目/ PDB生成”</span> ）。在这里，您可以查看所有符号服务器任务以及“ <a href="Generating_PDB_Files.html">生成PDB”</a>和“ <a href="Exporting_Assembly_to_Project.html">生成项目”</a>命令的结果。如果调试器从dotPeek符号服务器请求了一些PDB但未生成，则在此窗口中将看到带有错误消息的相应条目：</p>        <ul class="list _ul"><li class="list__item" id="17e3839f"><p>大多数情况下，当找不到目标部件时会发生问题。要解决此问题，可以<a href="Opening_Assembly_Files.html">在Assembly Explorer中打开装配</a> 。如果您不知道程序集的位置，则可以在Visual Studio处于调试模式时学习该程序集-打开“ <span class="control">模块”</span>窗口（“ <span class="menupath" data-skip-index="skip">调试” |“ Windows” |“模块”</span> ）并检查“ <span class="control">路径”</span>列。</p></li><li class="list__item" id="efec4c26"><p>如果您在64位Windows上运行dotPeek，请检查您是否在运行64位版本的dotPeek（安装目录<span class="filepath">％localappdata％\ JetBrains \ Installations \ dotPeek [中</span>有两个可执行文件<span class="filepath">-dotPeek32.exe</span>和<span class="filepath">dotPeek64.exe</span> 。 <span class="filepath">N]</span> ）。</p></li></ul>        <p id="af2e3db1">如果所<span class="keyword">请求的程序集未出现</span>在“ <a href="Reference__Project_PDB_Generation.html">项目/ PDB生成状态”窗口中</a> ，则表示调试器已经找到相应的符号文件，并且未从dotPeek请求它。如果符号文件正确且源代码可用，那么一切都很好，可以在不使用dotPeek的情况下调试程序集。如果没有，请尝试以下操作：</p>        <ul class="list _ul"><li class="list__item" id="41c6f926"><p>删除或重命名出现问题的PDB文件。当Visual Studio处于调试模式时，您始终可以找到每个程序集的实际PDB文件位置（如果有）-打开“ <span class="control">模块”</span>窗口（“ <span class="menupath" data-skip-index="skip">调试” |“ Windows” |“模块”</span> ）并检查“ <span class="control">符号文件”</span>列。</p></li><li class="list__item" id="40939e0f"><p>如果从另一个符号服务器收到了PDB文件，则可以禁用该服务器，也可以在符号服务器列表中将dotPeek符号服务器上移（Visual Studio选项中的“ <span class="menupath" data-skip-index="skip">调试” |“符号” |“符号文件位置</span> ”）。</p></li></ul>        <a name="disable_optimization"></a>            <p id="880873e3">在调试<span class="keyword">优化的程序集时</span> ，某些调试器功能不可用，例如，即使符号文件正确，您也不会看到局部变量的值。因此，您可能要禁用优化。</p>            <ul class="list _ul"><li class="list__item" id="7d2052d7"><p>当Visual Studio处于调试模式时，检查程序集是否已优化-打开“ <span class="control">模块”</span>窗口（“ <span class="menupath" data-skip-index="skip">调试” |“ Windows” |“模块”</span> ），然后检查“优化”列。</p></li><li class="list__item" id="814a54f6"><p>选择Visual Studio选项（“ <span class="menupath" data-skip-index="skip">工具” |“选项” |“调试” |“常规”</span> ）中的“ <span class="control">禁止模块加载上的JIT优化”</span>复选框。</p></li><li class="list__item" id="1cb17614">                    <p id="f9806d5d">要禁用所有NGEN（准JIT前）映像（ <span class="filepath">* .ni.dll</span> ），可以设置环境变量<code class="code">COMPLUS_ZapDisable=1</code> 。查看这些文章以获取示例和更多信息：</p>                    <ul class="list _ul"><li class="list__item" id="a5c3105d">                            <a href="https://blogs.msdn.microsoft.com/sburke/2008/01/29/how-to-disable-optimizations-when-debugging-reference-source/" rel="noopener noreferrer" data-external="true" target="_blank">调试时如何禁用优化参考源</a>                        </li><li class="list__item" id="b6bfcb68">                            <a href="https://github.com/Microsoft/dotnet/blob/master/Documentation/testing-with-ryujit.md" rel="noopener noreferrer" data-external="true" target="_blank">.NET Framework-对RyuJIT进行故障排除</a>                        </li></ul>                </li></ul>            </div>    <div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月18日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Navigation_and_Search__CamelHumps.html">驼峰</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>