<html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta name="description" content="
        ASP.NET memory profiling, profile ASP web site, memory profiling of web application,
        memory profile IIS site, IIS server memory profiling
    " data-skip-index="skip"><meta charset="UTF-8"><title>IIS服务器上的Profile Web Application-帮助|帮助点内存</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Profile_ASP_Web_Site" data-disqus-id="Profile_ASP_Web_Site_dm"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索dotMemory帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>dotMemory 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="rs" data-group="secondary">ReSharper 2.x / IntelliJ IDEA</option><option value="vs" data-group="primary" selected>视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Profile_ASP_Web_Site.xml" data-toc="Profile_ASP_Web_Site">IIS服务器上的配置文件Web应用程序</h1>                <p id="c8c3d08c">通常，当Web应用程序已经在服务器上运行时，需要确定其性能问题。下表总结了对应用程序进行性能分析的所有可能选项：</p>    <div class="table-wrapper"><table class=" wide" width="100%" id="13884e40"><thead><tr id="acd33e4f" class="ijRowHead"><th id="5e1e4cf9"></th><th id="36e31486" width="30%"><p>优点</p></th><th id="89101026" width="30%"><p>不是缺点而是功能</p></th></tr></thead><tbody><tr id="9eef9188" class="ijRowOdd"><td id="c909d830">                <a href="#local-profiling">本地分析</a>            </td><td id="947e99c1">                <ul class="list _ul"><li class="list__item" id="7e2d73f1"><p>易于配置/使用：您可以通过dotMemory GUI进行配置</p></li></ul>            </td><td id="0df73d72">                <ul class="list _ul"><li class="list__item" id="eeaa090a"><p>必须在服务器上安装并运行dotMemory，由于安全限制，缺少GUI等原因，这可能是不可能的</p></li></ul>            </td></tr><tr id="f1a52c72" class="ijRowEven"><td id="23fd16fd">                <a href="#profiling-via-console-tools">通过控制台工具进行性能分析</a>            </td><td id="a488587d">                <ul class="list _ul"><li class="list__item" id="6432aeb9"><p>无需网络通讯</p></li><li class="list__item" id="f6c68beb"><p>能够创建许多预定义的分析配置并按需运行它们</p></li></ul>            </td><td id="dce8907c">                <ul class="list _ul"><li class="list__item" id="0349a6bc"><p>控制台工具必须复制到服务器上并在服务器上运行</p></li><li class="list__item" id="6f4dd801"><p>必须使用dotMemory将生成的快照从服务器手动复制到计算机上</p></li></ul>            </td></tr><tr id="6ee01235" class="ijRowOdd"><td id="ad30690d">                <a href="#memory-dumps">内存转储</a>            </td><td id="40e6fa20">                <ul class="list _ul"><li class="list__item" id="38958689"><p>什么都不应安装到服务器</p></li><li class="list__item" id="1e35b5aa"><p>没有配置开销</p></li></ul>            </td><td id="b187433b">                <ul class="list _ul"><li class="list__item" id="4feb5123"><p>内存转储包含的数据少于dotMemory快照</p></li></ul>            </td></tr></tbody></table></div>    <div class="chapter"><h2 id="local-profiling">本地分析</h2>        <figure><img alt="本地分析" title="本地分析" src="/help/img/dotnet/2019.2/how_to_app_server_local.png" id="c86e8474" width="291" height="355"></figure>        <p id="39718d62">通常，当您需要对直接在（开发人员）计算机或某些测试环境上托管的应用进行配置文件时，会使用本地配置文件，而这并没有施加任何安全/性能限制。</p>        <section class="procedure-steps"><h3 id="dt_local">本地配置IIS服务器上托管的Web应用程序</h3><ol class="list _decimal"><li class="list__item" id="51feab06"><p>在服务器上安装dotMemory。</p></li><li class="list__item" id="11a5e704"><p>                                <a href="Running_dotMemory.html">作为独立应用程序运行dotMemory</a> 。dotMemory <span class="control">主页</span>窗口将打开。</p></li><li class="list__item" id="b0ee74fb"><p>在右侧面板中，选择<span class="control">Local</span> 。</p></li><li class="list__item" id="0d37941a"><p>在中央面板的<span class="control">Profile Application中</span> ，选择<span class="control">IIS</span> 。</p></li><li class="list__item" id="e4c060de"><p>在右面板的“ <span class="control">应用程序选项”中</span> ，选择“ <span class="control">打开URL”</span>并指定配置文件应用程序的URL。如果您不这样做，则dotMemory将开始对其能够找到的第一个正在运行的应用程序池进行性能分析。</p></li><li class="list__item" id="770aa33b"><p>在右侧面板的<span class="control">Profiler Options中</span> ，指定分析类型。<br>有关探查器选项的更多详细信息，请参阅<a href="dotMemory_Profiler_Options.html">探查器选项</a>部分。</p></li><li class="list__item" id="87f001a5">                <aside class="note " rel="87f001a5" id="004cee15" data-title=""><p>*这将使您看到分配了特定对象的方法。</p></aside>如果您希望dotMemory在分析会话开始后立即开始收集堆栈跟踪分配数据*，请选择右侧面板中的<span class="control">立即开始收集分配数据</span>选项。</li><li class="list__item" id="f16a3585"><p>（可选）如果要使用API（而不是<span class="control">Controller</span>窗口）控制分析会话（拍摄快照，结束会话等），请选择<span class="control">通过API控制分析</span> 。有关如何使用API控制分析的更多详细信息，请参阅<a href="Profiling_Guidelines__Advanced_Profiling_Using_dotTrace_API.html">通过API控制分析会话</a> 。</p></li><li class="list__item" id="76c0b7af"><p>点击<span class="control">运行</span> 。请注意，执行此操作后，将重新启动IIS服务，并因此重新启动配置文件应用程序池。</p></li><li class="list__item" id="e4c8809b"><p>拍摄快照。有关如何控制性能分析会话的更多详细信息，请参阅控制性能<a href="Controlling_Profiling_Process.html">分析会话</a> （如果您手动控制性能分析）或<a href="Profiling_Guidelines__Advanced_Profiling_Using_dotTrace_API.html">通过API</a>控制性能<a href="Profiling_Guidelines__Advanced_Profiling_Using_dotTrace_API.html">分析会话</a> （如果您使用API控制性能分析）。</p></li><li class="list__item" id="3b3c2efc"><p>收集快照后，在“ <span class="control">控制器”</span>窗口上单击“ <span class="control">分离</span> ”，以将分析器与应用程序池分离。</p></li><li class="list__item" id="ec0ee819"><p>                    <a href="Analyzing_Results.html">分析收集的快照</a> 。</p></li></ol></section>    </div>        <div class="chapter"><h2 id="profiling-via-console-tools">通过控制台工具进行性能分析</h2>        <figure><img alt="使用控制台工具进行性能分析" title="使用控制台工具进行性能分析" src="/help/img/dotnet/2019.2/how_to_app_server_console.png" id="2bb2a61b" width="620" height="356"></figure>        <p id="00520dc9">如果需要自动进行性能分析，则控制台工具是最好的：例如，您应该不时地配置Web应用程序。另一种可能的情况是，当您无权访问服务器而其他人有权访问服务器时，则可以为他们提供配置工具和批处理文件。</p>        <p id="e9f4b23e">它是如何工作的？简而言之，您可以将控制台工具复制到服务器，然后在性能分析下运行该应用程序（应用程序池将重新启动），或者将该工具附加到正在运行的应用程序池<span class="filepath">w3wp.exe</span> 。然后，您可以通过向stdin发送特殊命令来获取快照。</p>                <section class="procedure-steps"><h3 id="3e8b528b">使用控制台工具在IIS服务器上分析Web应用程序</h3><ol class="list _decimal"><li class="list__item" id="986f5f66"><p>使用<span class="filepath">ConsoleProfiler.exe</span>工具下载<a href="/dotmemory/download/#section=command-line-profiler" rel="noopener noreferrer" data-external="true" target="_blank">zip存档</a> ，然后将其复制/解压缩到服务器。</p></li><li class="list__item" id="f7e991a0">                <p id="e51a0342">现在，您有两个选择来获取内存快照：</p>                <ul class="list _alpha-lower"><li class="list__item" id="c33e69c0"><p>将<span class="filepath">dotMemory.exe</span>附加到正在运行的应用程序池，并立即获取快照：</p><div class="code-block" data-lang="bash">dotMemory.exe获取快照1234 --save-to-dir = C：\ Snapshots</div>哪里<code class="code">1234</code>是相应的<span class="filepath">w3wp.exe</span>进程的进程ID<p></p></li><li class="list__item" id="c31626b6">                        <p id="60cc7fb3">在配置文件下运行应用程序池（如果该池已经在运行，它将重新启动）：</p><div class="code-block" data-lang="bash">dotMemory.exe start-iis --trigger-timer = 30s --open-url = localhost / myapp --use-browser = Chrome</div>哪里<code class="code">--open-url=localhost/myapp</code>是您的应用程序的URL。如果您选择运行应用程序池，则无法立即获取快照。相反，您应该：<p></p>                        <ul class="list _ul"><li class="list__item" id="c1abb17c"><p>按条件获取快照：例如，何时<code class="code">--trigger-timer=30s</code>指定后，每30秒拍摄一次快照</p></li><li class="list__item" id="4de55d50"><p>通过向stdin发送命令来获取快照： <code class="code">##dotMemory["get-snapshot"]</code>                            </p></li><li class="list__item" id="5cd028c3"><p>在进程退出时获取快照（例如，IIS管理器中的<span class="control">回收</span>应用程序池）</p></li></ul>                    </li></ul>                <p id="7c35e92c">有关如何使用dotMemory控制台事件探查器的更多详细信息，请参阅《 <a href="Working_with_dotMemory_Command-Line_Profiler.html">使用dotMemory命令行事件探查器》</a> 。</p>            </li><li class="list__item" id="161dbe70"><p>将生成的快照复制到安装了dotMemory的计算机上并<a href="Analyzing_Results.html">分析快照</a> 。</p></li></ol></section>    </div>    <div class="chapter"><h2 id="memory-dumps">内存转储</h2>        <figure><img alt="转储" title="转储" src="/help/img/dotnet/2019.2/how_to_app_server_dumps.png" id="a7cc181f" width="616" height="357"></figure>        <p id="632bad92">如果由于某种原因根本无法在服务器上复制和运行第三方工具，该怎么办？好吧，那最后的方法就是内存转储。可以使用许多工具来使用它，其中最受欢迎的两个是任务管理器（操作系统附带）和进程资源管理器。</p>        <section class="procedure-steps"><h3 id="0afdf79c">使用内存转储在IIS服务器上分析Web应用程序</h3><ol class="list _decimal"><li class="list__item" id="6512d963"><p>在服务器上，使用任务管理器或进程资源管理器工具进行内存转储。使用任务管理器创建32位应用程序转储时，请确保使用<span class="filepath">C：\ Windows \ SysWOW64 \ taskmgr.exe中</span>可以找到的32位版本的工具。</p><figure><img alt="转储" title="转储" src="/help/img/dotnet/2019.2/get_memory_dump.png" id="0e877f95" width="457" height="536"></figure>            <p></p></li><li class="list__item" id="ab383688"><p>将生成的快照复制到安装了dotMemory的计算机上，然后使用“ <span class="control">导入转储”</span>命令将其打开。</p></li><li class="list__item" id="630b43fc"><p>                <a href="Analyzing_Results.html">分析快照</a> 。</p></li></ol></section>        <figure id="7004b462" width="600" height="411"><img class="js-gif" src="/help/img/dotnet/2019.2/dumps.png" width="600" data-gif-src="/help/img/dotnet/2019.2/dumps.animated.gif" style="width:600px"></figure>    </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月8日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Profile_Web_Application_on_IIS_Express.html">IIS Express</a> <a class="navigation-links__next" href="Profile_.NET_Core_Application.html">Profile .NET Core应用</a> <a class="navigation-links__prev" href="Profile_Web_Application_on_IIS_Express.html">程序中的Profile Web应用</a> <a class="navigation-links__next" href="Profile_.NET_Core_Application.html">程序</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>