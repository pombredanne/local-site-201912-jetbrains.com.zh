<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta content="&#xA;        ASP.NET memory profiling, profile ASP web site, memory profiling of web application,&#xA;        memory profile IIS site, IIS server memory profiling&#xA;    " name="description" data-skip-index="skip"><meta charset="UTF-8"><title>Profile Web Application on IIS Server - Help | dotMemory</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Profile_ASP_Web_Site" data-disqus-id="Profile_ASP_Web_Site_dm"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search dotMemory Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>dotMemory 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="secondary" value="rs">ReSharper 2.x/IntelliJ IDEA</option><option data-group="primary" value="vs" selected>Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Profile_ASP_Web_Site" id="Profile_ASP_Web_Site.xml">Profile Web Application on IIS Server</h1>                <p id="c8c3d08c">        Typically, determining performance issues in a web application is required when it is already        running on a server. The table summarizes all possible options of profiling the application:    </p>    <div class="table-wrapper"><table class=" wide" width="100%" id="13884e40"><thead><tr id="acd33e4f" class="ijRowHead"><th id="5e1e4cf9"></th><th id="36e31486" width="30%"><p>Pros</p></th><th id="89101026" width="30%"><p>Not cons but features</p></th></tr></thead><tbody><tr id="9eef9188" class="ijRowOdd"><td id="c909d830">                <a href="#local-profiling">Local profiling</a>            </td><td id="947e99c1">                <ul class="list _ul"><li class="list__item" id="7e2d73f1"><p>Easy to configure/use: you profile via the dotMemory GUI</p></li></ul>            </td><td id="0df73d72">                <ul class="list _ul"><li class="list__item" id="eeaa090a"><p>                        dotMemory must be installed and run on the server, which may be impossible due to security                        restrictions, absence of GUI, etc                    </p></li></ul>            </td></tr><tr id="f1a52c72" class="ijRowEven"><td id="23fd16fd">                <a href="#profiling-via-console-tools">Profiling via console tools</a>            </td><td id="a488587d">                <ul class="list _ul"><li class="list__item" id="6432aeb9"><p>                        No network communication required                    </p></li><li class="list__item" id="f6c68beb"><p>                        Ability to create a number of predefined profiling configs and run them on demand                    </p></li></ul>            </td><td id="dce8907c">                <ul class="list _ul"><li class="list__item" id="0349a6bc"><p>                        The console tools must be copied to and run on the server                    </p></li><li class="list__item" id="6f4dd801"><p>                        Resulting snapshots must be manually copied from the server to the machine with                        dotMemory                    </p></li></ul>            </td></tr><tr id="6ee01235" class="ijRowOdd"><td id="ad30690d">                <a href="#memory-dumps">Memory dumps</a>            </td><td id="40e6fa20">                <ul class="list _ul"><li class="list__item" id="38958689"><p>Nothing should be installed to the server</p></li><li class="list__item" id="1e35b5aa"><p>No profiling overhead</p></li></ul>            </td><td id="b187433b">                <ul class="list _ul"><li class="list__item" id="4feb5123"><p>                        Memory dumps contain less data than dotMemory snapshots                    </p></li></ul>            </td></tr></tbody></table></div>    <div class="chapter"><h2 id="local-profiling">Local profiling</h2>        <figure><img alt="Local profiling" title="Local profiling" src="/help/img/dotnet/2019.2/how_to_app_server_local.png" id="c86e8474" width="291" height="355"></figure>        <p id="39718d62">            Typically, local profiling is used when you need to profile the app that is hosted right on your            (developer's) machine or on some testing environment, which doesn't impose any security/performance            restrictions.        </p>        <section class="procedure-steps"><h3 id="dt_local">To locally profile a web app hosted on an IIS server</h3><ol class="list _decimal"><li class="list__item" id="51feab06"><p>                Install dotMemory on the server.            </p></li><li class="list__item" id="11a5e704"><p>                                <a href="Running_dotMemory.html">Run dotMemory as a standalone                    application</a>.                The dotMemory <span class="control">Home</span> window will open.            </p></li><li class="list__item" id="b0ee74fb"><p>                In the right panel, select                                <span class="control">Local</span>.            </p></li><li class="list__item" id="0d37941a"><p>In the central panel, in <span class="control">Profile Application</span>, select                <span class="control">IIS</span>.            </p></li><li class="list__item" id="e4c060de"><p>In the right panel, in <span class="control">Application Options</span>, select                <span class="control">Open URL</span>                and specify the URL of the profiled application. If you do not do this, dotMemory will start profiling                of the first running application pool it'll be able to find.            </p></li><li class="list__item" id="770aa33b"><p>                In the right panel, in <span class="control">Profiler Options</span>, specify profiling type.                <br>                For more details on                profiler options, refer to the                                <a href="dotMemory_Profiler_Options.html">Profiler Options</a>                section.            </p></li><li class="list__item" id="87f001a5">                <aside class="note " data-title="" rel="87f001a5" id="004cee15"><p>* This will allow you to see the methods that have allocated particular objects.</p></aside>                If you want dotMemory to start collecting the stack trace allocation data* right after the profiling                session starts, select the <span class="control">Start collecting allocation data immediately</span> option                in the right panel.            </li><li class="list__item" id="f16a3585"><p>                Optionally, if you are going to control profiling session (take snapshots, end session, and so on) using                the API (rather than the <span class="control">Controller</span> window), select                <span class="control">Control profiling via API</span>. For more details on how to control profiling using the                API,                refer to the                <a href="Profiling_Guidelines__Advanced_Profiling_Using_dotTrace_API.html">Controlling Profiling Session Through API</a>                chapter.            </p></li><li class="list__item" id="76c0b7af"><p>                Click <span class="control">Run</span>. Note that after you do this, the IIS service and, as a consequence, the                profiled application pool will be restarted.            </p></li><li class="list__item" id="e4c8809b"><p>                    Take snapshots. For more details on how to control profiling session, refer to                                        <a href="Controlling_Profiling_Process.html">Controlling Profiling Session</a>                    (if you control profiling manually) or to                    <a href="Profiling_Guidelines__Advanced_Profiling_Using_dotTrace_API.html">Controlling Profiling Session Through API</a>                    (if you control profiling using the API).                </p></li><li class="list__item" id="3b3c2efc"><p>                    After you collect the snapshot(s), click <span class="control">Detach</span> on the                    <span class="control">Controller</span>                    window to detach the profiler from the application pool.                </p></li><li class="list__item" id="ec0ee819"><p>                    <a href="Analyzing_Results.html">Analyze the collected snapshots</a>.                </p></li></ol></section>    </div>        <div class="chapter"><h2 id="profiling-via-console-tools">Profiling via console tools</h2>        <figure><img alt="Profiling with console tool" title="Profiling with console tool" src="/help/img/dotnet/2019.2/how_to_app_server_console.png" id="2bb2a61b" width="620" height="356"></figure>        <p id="00520dc9">            Console tools are the best if you need to automate profiling: for example, you should profile your web app from            time to time. Another possible scenario is when you don't have access to the server but some other person            does, so you can provide them with profiling tools and a batch file.        </p>        <p id="e9f4b23e">            How does it work? In short, you copy console tools to the server and either run the app under profiling (the            app pool will be restarted) or attach the tool to the running application pool <span class="filepath">w3wp.exe</span>.                            Then you can get snapshots by sending special commands to stdin.                    </p>                <section class="procedure-steps"><h3 id="3e8b528b">To profile a web app on an IIS server using console tools</h3><ol class="list _decimal"><li class="list__item" id="986f5f66"><p>                Download the                <a href="https://www.jetbrains.com/dotmemory/download/#section=command-line-profiler" data-external="true" target="_blank" rel="noopener noreferrer">zip archive</a>                with the <span class="filepath">ConsoleProfiler.exe</span> tool and copy/unpack it to the server.            </p></li><li class="list__item" id="f7e991a0">                <p id="e51a0342">                    Now, you have two options for getting a memory snapshot:                </p>                <ul class="list _alpha-lower"><li class="list__item" id="c33e69c0"><p>                        Attach <span class="filepath">dotMemory.exe</span> to the running application pool and instantly get a snapshot:                        <div class="code-block" data-lang="bash">
dotMemory.exe get-snapshot 1234 --save-to-dir=C:\Snapshots
    </div>                        where <code class="code">1234</code> is the process ID of the corresponding <span class="filepath">w3wp.exe</span> process                    </p></li><li class="list__item" id="c31626b6">                        <p id="60cc7fb3">                            Run the application pool under profiling (if the pool is already running, it will be restarted):                            <div class="code-block" data-lang="bash">
        dotMemory.exe start-iis --trigger-timer=30s --open-url=localhost/myapp --use-browser=Chrome
    </div>                            where <code class="code">--open-url=localhost/myapp</code> is the URL of your application.                            In case you've chosen to run the app pool, you cannot instantly get a snapshot. Instead, you                            should:                        </p>                        <ul class="list _ul"><li class="list__item" id="c1abb17c"><p>                                get a snapshot by condition: for example, when                                <code class="code">--trigger-timer=30s</code>                                is specified, snapshots are taken each 30 s                            </p></li><li class="list__item" id="4de55d50"><p>                                get a snapshot by sending a command to stdin:                                <code class="code">##dotMemory["get-snapshot"]</code>                            </p></li><li class="list__item" id="5cd028c3"><p>                                get a snapshot on process exit (for example, <span class="control">Recycle</span> app pool in the IIS                                Manager)                            </p></li></ul>                    </li></ul>                <p id="7c35e92c">                    For more details on how to work with the dotMemory console profiler, refer to<a href="Working_with_dotMemory_Command-Line_Profiler.html">Using dotMemory Command-Line Profiler</a>.                </p>            </li><li class="list__item" id="161dbe70"><p>                Copy the resulting snapshot to the computer with installed dotMemory and                <a href="Analyzing_Results.html">analyze the snapshot</a>.            </p></li></ol></section>    </div>    <div class="chapter"><h2 id="memory-dumps">Memory dumps</h2>        <figure><img alt="Dumps" title="Dumps" src="/help/img/dotnet/2019.2/how_to_app_server_dumps.png" id="a7cc181f" width="616" height="357"></figure>        <p id="632bad92">            What if, for some reason, copying and running third-party tools on the server is not possible at all. Well,            then your last resort is memory dumps. It can be taken with a number of tools, with the two most popular            being Task Manager (comes with the operating system) and Process Explorer.        </p>        <section class="procedure-steps"><h3 id="0afdf79c">To profile a web app on an IIS server using memory dumps</h3><ol class="list _decimal"><li class="list__item" id="6512d963"><p>                On the server, take a memory dump using the Task Manager or Process Explorer tool.                When creating a dump of a 32-bit application with Task Manager, make sure you use a 32-bit version of                the tool that can be found in <span class="filepath">C:\Windows\SysWOW64\taskmgr.exe</span>.                <figure><img alt="Dumps" title="Dumps" src="/help/img/dotnet/2019.2/get_memory_dump.png" id="0e877f95" width="457" height="536"></figure>            </p></li><li class="list__item" id="ab383688"><p>                Copy the resulting snapshot to the computer with installed dotMemory and open                it using the <span class="control">Import Dump</span> command.            </p></li><li class="list__item" id="630b43fc"><p>                <a href="Analyzing_Results.html">Analyze the snapshot</a>.            </p></li></ol></section>        <figure id="7004b462" width="600" height="411"><img class="js-gif" src="/help/img/dotnet/2019.2/dumps.png" data-gif-src="/help/img/dotnet/2019.2/dumps.animated.gif" width="600" style="width:600px;"></figure>    </div><div class="last-modified" data-skip-index="skip">Last modified: 8 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Profile_Web_Application_on_IIS_Express.html">Profile Web Application in IIS Express</a><a class="navigation-links__next" href="Profile_.NET_Core_Application.html">Profile .NET Core Application</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>