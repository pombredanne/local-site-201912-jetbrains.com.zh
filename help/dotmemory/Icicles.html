<html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta charset="UTF-8"><title>调用树（冰柱图）-帮助点内存</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Icicles" data-disqus-id="Icicles_dm"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索dotMemory帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>dotMemory 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="rs" data-group="secondary">ReSharper 2.x / IntelliJ IDEA</option><option value="vs" data-group="primary" selected>视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Icicles.xml" data-toc="Icicles">通话树（冰柱图）</h1>        <p id="10b37e07">冰柱图是负责创建所选对象集的堆栈跟踪的图形表示。</p>    <p id="94a7cc34">与“ <span class="control">调用树”一样</span> ，从堆栈中的第一个调用开始，一直显示到直接创建对象集的调用，显示了调用。每个调用都显示为水平条，其长度取决于调用子树中分配的对象的大小。在基础子树中分配的内存越多，指示条越长。显然，在子树上，函数调用（栏）的大小只能减小，从而使子树看起来像冰柱。</p>    <p id="b770d36c">使用Icicle图表即可一目了然地获得堆栈跟踪的概述。无需深入研究堆栈跟踪，就可以快速确定子树中的哪个函数分配了大部分内存。</p>    <div class="chapter"><h2 id="example" data-toc="Icicles#example">例</h2>        <p id="269cc681">考虑下面的示例，以更好地了解冰柱图。</p>        <figure><img alt="冰柱图示例" title="冰柱图示例" src="/help/img/dotnet/2019.2/icicles_2.png" id="9819cf61" width="509" height="188"></figure>                <p id="27a0d798">如您所见，要分析“调用树”，您必须扩展堆栈中的所有子树，并解释“ <span class="control">字节</span>数”和“ <span class="control">子树</span>中的<span class="control">字节</span>数”列中的数字。相比之下，只需看一眼冰柱图就可以确定堆栈中的主内存生成器-“绿色冰柱”。单击您感兴趣的函数将显示相应的堆栈跟踪（在右侧）。<br>“ <span class="control">分配的函数”</span>值显示直接在所选函数中分配了多少内存。<br>“ <span class="control">在子树中分配的</span>值”显示<span class="control">子树</span>中所选功能和所有基础功能中分配的内存量。</p>        <figure><img alt="冰柱图" title="冰柱图" src="/help/img/dotnet/2019.2/icicles_3.png" id="8bc51bcc" width="723" height="161"></figure>    </div>    <div class="chapter"><h2 id="how-the-icicle-chart-is-painted" data-toc="Icicles#how-the-icicle-chart-is-painted">冰柱图的绘制方式</h2>        <p id="c4719896">以下是dotMemory如何在冰柱图表上绘制条形（函数）的规则：</p>        <ul class="list _ul"><li class="list__item" id="ed9bf46a"><p>                <i id="a8ee765a">分配的内存</i>                <br>函数分配的内存越多，相应的冰柱的颜色值就越大。因此，不能自行创建对象的函数看起来很苍白。反之亦然，分配内存的功能看起来更暗。</p><figure><img alt="冰柱图" title="冰柱图" src="/help/img/dotnet/2019.2/icicles_5.png" id="b81632a1" width="800" height="183"></figure>            <p></p></li><li class="list__item" id="e6ddd5d6"><p>                <i id="e6388df5">分枝</i>                <br>堆栈中的每个新调用子树（当一个函数调用另外两个其他函数时）都用一种新颜色绘制。</p><figure><img alt="冰柱分支" title="冰柱分支" src="/help/img/dotnet/2019.2/icicles_4.png" id="db7563f9" width="485" height="73"></figure>            <p></p></li><li class="list__item" id="9a93d286"><p>                <i id="e12b3194">系统名称空间</i>                <br>为了帮助您将系统调用与其他系统调用区分开来， <code class="code">System</code>名称空间以较不饱和的颜色绘制。考虑下面的示例： <code class="code">ThemeCatalogRegistrarBase</code>类不属于<code class="code">System</code>命名空间。</p><figure><img alt="系统调用" title="系统调用" src="/help/img/dotnet/2019.2/icicles_6.png" id="c7509fd3" width="434" height="80"></figure>            <p></p></li><li class="list__item" id="24a7b2da">                <p id="00a5f519">                    <i id="9df9b49f">几乎没有分配的功能</i>                    <br>为了简单起见，当多个（超过五个）后续调用未分配内存*时，dotMemory将它们分成一个小节。通常，这些是分析不感兴趣的系统调用。在堆栈跟踪中，这样的调用组显示为<i id="807111b3">折叠项</i> ，并且相应的栏用水平线图案绘制。<br>要扩展条形，请单击鼠标中键。</p>                <aside class="note " rel="00a5f519" id="65304995" data-title=""><p>*实际上，在此类调用中可能会进行一些微不足道的分配。该组中最后一根和第一根钢筋的长度彼此之间的差异不得超过2％。因此，谈论“ <i id="8f7cc95d">几乎</i>没有分配的功能”更为正确。</p></aside>                <p id="a523f149">                    </p><figure><img alt="折叠物品" title="折叠物品" src="/help/img/dotnet/2019.2/icicles_7.png" id="782e1030" width="397" height="191"></figure>                <p></p>            </li></ul>    </div>    <div class="chapter"><h2 id="zooming-in-and-out" data-toc="Icicles#zooming-in-and-out">放大和缩小</h2>        <p id="f84eb17a">如果要更详细地了解某个呼叫子树，则可以更改冰柱图表的比例。</p>        <section class="procedure-steps"><h3 id="22b16619">放大通话</h3><ul class="list "><li class="list__item" id="11c1ffe0">                <p id="66f6088c">应用<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Shift+click</span></kbd>到相应的栏。</p>                <p id="c7ee618a">条形图将占据图表的整个宽度。</p>            </li></ul></section>        <section class="procedure-steps"><h3 id="58f742f6">缩小</h3><ul class="list "><li class="list__item" id="ae9e0557"><p>双击或使用<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Shift+click</span></kbd>在堆栈中位于较高位置的呼叫（以较长的长条表示）。</p></li></ul></section>        <figure><img alt="冰柱图" title="冰柱图" src="/help/img/dotnet/2019.2/icicles_9.gif" id="307c09dd" width="444" height="326"></figure>        <aside class="note " rel="307c09dd" id="4ac61583" data-title="">            <p id="99e21768">为方便起见，当一组呼叫（条形）太短而无法在当前比例尺上显示时，图表将它们显示为一个<img alt="小物件" title="小物件" src="/help/img/dotnet/2019.2/icicles_8.png" id="fc488a13" width="13" height="18" class="inline-icon-13"> <i id="48fa43ff">小物品</i>栏。</p>        </aside>    </div>    <div class="chapter"><h2 id="selecting-objects-for-further-an" data-toc="Icicles#selecting-objects-for-further-an">选择对象进行进一步分析</h2>        <p id="5a26154b">在“ <a href="dotMemory_Call_Tree.html">呼叫树”</a>视图中，您可以选择以下主题进行进一步分析：</p>        <ul class="list _ul"><li class="list__item" id="7c9b0839"><p>                <a href="#instance">在特定功能实例中分配的对象</a> ;</p></li><li class="list__item" id="cfe0b6dd"><p>                <a href="#subtree">在功能子树中分配的对象</a> ;</p></li><li class="list__item" id="b32b8829"><p>                <a href="#merged">在函数的所有实例中分配的对象</a> 。</p></li><li class="list__item" id="2f6d3c07"><p>                                    <a href="#set">由整个对象集专有保留（控制）的对象</a> 。</p></li></ul>        <section class="procedure-steps"><h3 id="instance">选择由特定功能实例分配的对象（精确调用）</h3><ul class="list "><li class="list__item" id="471ccaf2">                <p id="2216dd6a">请执行以下任一操作：</p>                <ul class="list _ul"><li class="list__item" id="04ae08c9"><p>双击相应的栏。</p></li><li class="list__item" id="1ff77036"><p>右键单击该栏，然后选择“ <span class="control">打开由该函数实例分配的对象”</span> 。</p></li></ul>                <p id="b0791b49">此后，将<span class="control">在函数[function_name]</span>主题的<span class="control">实例中创建实例</span>并将其添加到“ <a href="First_Look_at_the_dotMemory_s_User_Interface.html#ui">分析路径”，</a>并且所需对象的列表将显示在“ <a href="Type_List.html">按类型分组”</a>视图中。</p>            </li></ul></section>        <section class="procedure-steps"><h3 id="subtree">选择在函数子树中分配的对象（函数实例及其所有基础调用）</h3><ul class="list "><li class="list__item" id="3ffe0c27">                <p id="1a490431">右键单击相应的栏，然后选择“ <span class="control">打开由该子树中的所有功能分配的对象”</span> 。</p>                <p id="05a963a7">此后， <span class="control">功能[function_name]</span>主题的<span class="control">Created in子树</span>将添加到<a href="First_Look_at_the_dotMemory_s_User_Interface.html#ui">Analysis Path，</a>并且所需对象的列表将显示在<a href="Type_List.html">Group by Types</a>视图中。</p>            </li></ul></section>        <section class="procedure-steps"><h3 id="merged">选择在函数的所有实例中分配的对象</h3><ul class="list "><li class="list__item" id="78725bab">                <p id="ab4037ce">右键单击相应的栏，然后选择<span class="control">打开由该函数的所有实例分配的对象</span> 。</p>                <p id="5f3a42fe">此后，将<span class="control">在函数[Function_name]的所有实例中创建的</span>对象将添加到“ <a href="First_Look_at_the_dotMemory_s_User_Interface.html#ui">分析路径”，</a>并且所需对象的列表将显示在“ <a href="Type_List.html">按类型分组”</a>视图中。</p>            </li></ul></section>                    <section class="procedure-steps"><h3 id="set">选择分析对象集专有保留的对象</h3><ul class="list "><li class="list__item" id="6265ae4d">                    <p id="8c05774b">点击<img alt="打开保留的对象" title="打开保留的对象" src="/help/img/dotnet/2019.2/open_retained_objects_button.png" id="2d2d3925" width="25" height="23" class="inline-icon-25"> <span class="control">打开此设置</span>按钮<span class="control">保留的对象</span> 。</p>                    <p id="edec5bc7">此后，“ <span class="control">专有保留的对象”</span>主题将添加到“ <a href="First_Look_at_the_dotMemory_s_User_Interface.html#ui">分析路径”，</a>并且所需对象的列表将显示在“ <a href="Type_List.html">按类型分组”</a>视图中。</p>                </li></ul></section>            </div>    <div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月8日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="dotMemory_Call_Tree.html">调用树</a> <a class="navigation-links__next" href="Back_Traces.html">回跟踪</a></div><section class="seealso" data-skip-index="skip"><div class="seealso__header"><h2>也可以看看</h2></div><div class="seealso__content"><div class="seealso__col" data-skip-index="skip"><h3>参考：</h3><ul class="list"><li class="list__item"><a href="Reference__Views_Legend.html">图示</a></li></ul></div></div></section></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>