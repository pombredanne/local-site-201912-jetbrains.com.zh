<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta name="robots" content="noindex"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/help/app/v2/analytics.js"></script><meta content="&#xA;        ASP.NET remote memory profiling, C# profiling from the console, remote profiling from command line,&#xA;        remote server profile memory&#xA;    " name="description" data-skip-index="skip"><meta charset="UTF-8"><title>Using dotMemory Command-Line Profiler - Help | dotMemory</title><link rel="stylesheet" href="/help/app/v2/app.css"></head><body data-id="Working_with_dotMemory_Command-Line_Profiler" data-disqus-id="Working_with_dotMemory_Command-Line_Profiler_dm"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search dotMemory Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>dotMemory 2018.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="secondary" value="rs">ReSharper 2.x/IntelliJ IDEA</option><option data-group="primary" value="vs" selected>Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="false"><h1 data-toc="Working_with_dotMemory_Command-Line_Profiler" id="Working_with_dotMemory_Command-Line_Profiler.xml">Using dotMemory Command-Line Profiler</h1>        <p id="e54dd6b0">        Sometimes it is necessary to automate the process of gathering memory snapshots. For example, if you want        to make profiling a part of your continuous integration builds (e.g., this can be a build step that performs        profiling of your integration tests) or when you simply want to speed up profiling routines (e.g., when you        regularly profile the same application and do not want to start the dotMemory user interface each time).        For this purpose, dotMemory offers the        <a href="/dotmemory/download/#section=command-line-profiler" data-external="true" target="_blank" rel="noopener noreferrer"><span>dotMemory.exe command-line tool</span></a>.    </p>    <p id="e997d5a9">        The <span class="filepath">dotMemory.exe</span> tool can be used to profile any .NET application (including an already running one) and        take memory snapshots.    </p>    <p id="80ad747c">        Note that the tool is distributed free of charge and does not require dotMemory to be installed.        You can freely upload it to any computer to take memory        snapshots of problematic        applications.    </p>    <p id="5badbafa">        There are four main <span class="filepath">dotMemory.exe</span> commands:        <ul class="list _ul"><li class="list__item" id="3c42c3c2"><p>                <code class="code" data-lang="Console">get-snapshot</code>                - instantly get snapshot of a running app.            </p></li><li class="list__item" id="737d53f7"><p>                <code class="code" data-lang="Console">attach</code>                - attach the profiler to a running app and get snapshots by condition, using the API, or by sending                commands to                stdin.            </p></li><li class="list__item" id="38e3c2a3"><p>                <code class="code" data-lang="Console">start</code>                - start an app and get snapshots by condition, using the API, or by sending commands to stdin.            </p></li><li class="list__item" id="8edb0e2e"><p>                <code class="code" data-lang="Console">start-iis</code>                - start IIS and get snapshots by condition, using the API, or by sending commands to stdin.            </p></li></ul>        For detailed information on a particular <span class="filepath">dotMemory.exe</span> command, run:        <div class="code-block" data-lang="Console"><code class="code-block__wrapper">dotMemory.exe <span class="nb">help</span> &lt;<span class="nb">command</span>&gt;</code></div>    </p>    <p id="dccb8513">        This section covers only most basic tool usage scenarios:        <ul class="list _ul"><li class="list__item" id="22523bbf"><p>                <a href="#instant">Instantly get a snapshot of an already running application</a>            </p></li><li class="list__item" id="6eb4851d"><p>                <a href="#condition">Run an application and get a snapshot by condition</a>            </p></li><li class="list__item" id="34b82078"><p>                <a href="#external">Run an application and get a snapshot by passing a message to stdin</a>            </p></li><li class="list__item" id="74e37d7a"><p>                <a href="#api">Run an application and control profiling using the API</a>            </p></li><li class="list__item" id="6c805ba8"><p>                <a href="#attach">Attach to and profile an already running application</a>            </p></li><li class="list__item" id="b3d9d170"><p>                <a href="#iis">Run and profile an ASP.NET application</a>            </p></li></ul>    </p>    <div class="chapter"><h2 id="instant" data-toc="Working_with_dotMemory_Command-Line_Profiler#instant">Getting snapshot of a running application</h2>        <p id="3ba533d2">            It is the most simple and demanded scenario. There are two ways of identifying the application            you want to take snapshot from: via its PID or via its name.        </p>        <section class="procedure-steps"><h2 id="1195df6f">To instantly get a snapshot of a running application by its PID (e.g., 6844):</h2><ul class="list "><li class="list__item" id="241a5f57"><p>                Run the command:                <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">dotMemory</span><span class="o">.</span><span class="na">exe</span> <span class="n">get</span><span class="o">-</span><span class="n">snapshot</span> <span class="mi">6844</span> <span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">dir</span><span class="o">=</span><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Snapshots</span></code></div>            </p></li></ul></section>        <p id="bf5d2f5e">            Here:            <ul class="list _ul"><li class="list__item" id="ef924163"><p>                    <code class="code" data-lang="Java">--save-to-dir=C:\Snapshots</code>                    - (optional) path to directory for saving a snapshot (more correctly, a workspace (.dmw file)). In                    this                    case, snapshot filename will be generated automatically. If you want to specify the filename by                    yourself,                    use the <code class="code" data-lang="Java">--save-to-file</code> option.                </p></li><li class="list__item" id="801fdb6e"><p>                    <code class="code" data-lang="Java">6844</code>                    - process PID (you can find it in Window Task Manager).                </p></li></ul>        </p>        <section class="procedure-steps"><h2 id="17c32356">To instantly get a snapshot of a running application by its name</h2><ul class="list "><li class="list__item" id="241a13c7"><p>                Run the command:                <div class="code-block" data-lang="Console"><code class="code-block__wrapper">dotMemory.exe get-snapshot MyApp --with-max-mem</code></div>                or                <div class="code-block" data-lang="Console"><code class="code-block__wrapper">dotMemory.exe get-snapshot MyApp --all</code></div>            </p></li></ul></section>        <p id="140249d9">            Here:            <ul class="list _ul"><li class="list__item" id="996d66a6"><p>                    <code class="code" data-lang="Java">MyApp</code>                    - process name (you can find it in Windows Task Manager). If there are more than one process                    with such name, you can remove the ambiguity either with the <code class="code" data-lang="Java">--with-max-mem</code> or                    <code class="code" data-lang="Java">--all</code>                    option.                </p></li><li class="list__item" id="88e0afdb"><p>                    <code class="code" data-lang="Java">--with-max-mem</code>                    - a process that consumes most of the memory will be profiled.                </p></li><li class="list__item" id="9c03f951"><p>                    <code class="code" data-lang="Java">--all</code>                    - all processes with the specified name will be profiled. dotMemory                    will take snapshots of all process (snapshot per process).                </p></li></ul>        </p>    </div>    <div class="chapter"><h2 id="condition" data-toc="Working_with_dotMemory_Command-Line_Profiler#condition">Starting application and getting snapshots by condition</h2>    <p id="5aa458ad">        Sometimes it may be necessary to track application memory consumption during a long time interval.        In this case, you can start your application under profiling and get snapshots only in case        a particular condition is satisfied: a periodic time interval ends or memory consumption increases by        a specified value.    </p>    <section class="procedure-steps"><h2 id="edb08725">To start MyApp.exe and take snapshots periodically</h2><ul class="list "><li class="list__item" id="6c3dcdce"><p>            Run the command:            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">dotMemory</span><span class="o">.</span><span class="na">exe</span> <span class="n">start</span> <span class="o">--</span><span class="n">trigger</span><span class="o">-</span><span class="n">timer</span><span class="o">=</span><span class="mi">30</span><span class="n">s</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">MyApp</span><span class="err">\</span><span class="n">MyApp</span><span class="o">.</span><span class="na">exe</span> <span class="n">MyAppArg1</span></code></div>        </p></li></ul></section>    <p id="d6f230f7">        Here:        <ul class="list _ul"><li class="list__item" id="87b8d7f5"><p>                <code class="code" data-lang="Java">--trigger-timer=30s</code>                - time period for taking snapshots (30 s in our case).            </p></li><li class="list__item" id="bf47bb35"><p>                <code class="code" data-lang="Java">C:\MyApp\MyApp.exe</code>                - path to the executable file of the profiled app.            </p></li><li class="list__item" id="037305d6"><p>                <code class="code" data-lang="Java">MyAppArg1</code>                - (optional) argument of MyApp.exe. Note that if application argument starts                with the dash (-) character, you can escape it using double dash (--). For example,                <br>                <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">dotMemory</span><span class="o">.</span><span class="na">exe</span> <span class="n">start</span> <span class="o">--</span><span class="n">trigger</span><span class="o">-</span><span class="n">timer</span><span class="o">=</span><span class="mi">30</span><span class="n">s</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">MyApp</span><span class="err">\</span><span class="n">MyApp</span><span class="o">.</span><span class="na">exe</span> <span class="o">--</span> <span class="o">-</span><span class="n">MyAppArg1</span></code></div>            </p></li></ul>    </p>    <section class="procedure-steps"><h2 id="739c1e28">To start MyApp.exe and take snapshots when memory consumption     increases by the specified value</h2><ul class="list "><li class="list__item" id="e4600c73"><p>            Run the command:            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">dotMemory</span><span class="o">.</span><span class="na">exe</span> <span class="n">start</span> <span class="o">--</span><span class="n">trigger</span><span class="o">-</span><span class="n">mem</span><span class="o">-</span><span class="n">inc</span><span class="o">=</span><span class="mi">50</span><span class="o">%</span> <span class="o">--</span><span class="n">trigger</span><span class="o">-</span><span class="n">delay</span><span class="o">=</span><span class="mi">5</span><span class="n">s</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">MyApp</span><span class="err">\</span><span class="n">MyApp</span><span class="o">.</span><span class="na">exe</span></code></div>        </p></li></ul></section>    <p id="7382828d">        Here:        <ul class="list _ul"><li class="list__item" id="37bc0d49"><p>                <code class="code" data-lang="Java">--trigger-mem-inc=50%</code>                - a snapshot will be taken only when memory consumption of MyApp increases by 50%.            </p></li><li class="list__item" id="c234b725"><p>                <code class="code" data-lang="Java">--trigger-delay=5s</code>                - a trigger will be enabled with the 5 s pause to                skip the application startup phase.            </p></li></ul>    </p>    </div>    <div class="chapter"><h2 id="external" data-toc="Working_with_dotMemory_Command-Line_Profiler#external">Starting application and getting snapshots using stdin messages</h2>        <p id="cbc7f26b">            Sometimes it's necessary to have direct control over the profiling process, e.g., get a snapshot at some            exact moment by a direct command. This can be done by sending special messages to stdin of dotMemory.exe.        </p>        <aside class="warning " data-title="" rel="cbc7f26b" id="d940430d"><p>            Messages sent to stdin must always start from a new line and end with a carriage return.            Both stdin and stdout messages have a format of a JSON array.        </p></aside>        <section class="procedure-steps"><h2 id="501f964c">To start MyApp.exe and control profiling using stdin messages</h2><ol class="list _decimal"><li class="list__item" id="b0a276e7">                No additional arguments are required. You can start profiling as usual                using <code class="code" data-lang="Java">start</code>, <code class="code" data-lang="Java">start-iis</code>, or <code class="code" data-lang="Java">attach</code> commands. For example:                <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">dotMemory</span><span class="o">.</span><span class="na">exe</span> <span class="n">start</span> <span class="n">c</span><span class="o">:</span><span class="err">\</span><span class="n">MyApp</span><span class="err">\</span><span class="n">MyApp</span><span class="o">.</span><span class="na">exe</span></code></div>                <p id="e1c21920">                    dotMemory is able to inform you about how the profiling process is going by sending special                    service messages to stdout. This might be especially helpful in case you control profiling by                    some external script. To enable support for stdout messages, run dotMemory with the                    <code class="code" data-lang="Java">--service-output</code>                    option, e.g.:                    <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">dotMemory</span><span class="o">.</span><span class="na">exe</span> <span class="n">start</span> <span class="o">--</span><span class="n">service</span><span class="o">-</span><span class="n">output</span> <span class="n">c</span><span class="o">:</span><span class="err">\</span><span class="n">MyApp</span><span class="err">\</span><span class="n">MyApp</span><span class="o">.</span><span class="na">exe</span></code></div>                    dotMemory sends the following messages to stdout:                    <ul class="list _ul"><li class="list__item" id="d72b9965"><p>                            Start of the profiling session                            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="err">##</span><span class="n">dotMemory</span><span class="o">[</span><span class="s">&quot;connected&quot;</span><span class="o">,</span> <span class="o">{</span><span class="n">pid</span><span class="o">:</span> <span class="mi">1234</span><span class="o">}]</span></code></div>                        </p></li><li class="list__item" id="1124eafd"><p>                            Saving the snapshot                            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="err">##</span><span class="n">dotMemory</span><span class="o">[</span><span class="s">&quot;workspace-saved&quot;</span><span class="o">,</span> <span class="o">{</span><span class="n">path</span><span class="o">:</span> <span class="s">&quot;...&quot;</span><span class="o">}]</span></code></div>                        </p></li></ul>                </p>            </li><li class="list__item" id="8f489362"><p>                Get a snapshot by sending the following command to stdin:                <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="err">##</span><span class="n">dotMemory</span><span class="o">[</span><span class="s">&quot;get-snapshot&quot;</span><span class="o">,</span> <span class="o">{</span><span class="n">pid</span><span class="o">:</span><span class="mi">1234</span><span class="o">}]</span></code></div>                If <code class="code" data-lang="Java">pid</code> is specified, dotMemory will take a snapshot of the process with the specified PID.                Otherwise, dotMemory will take snapshots of all profiled processes.            </p></li><li class="list__item" id="915af4c0"><p>                To stop profiling and kill the profiled application, send the following command to stdin:                <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="err">##</span><span class="n">dotMemory</span><span class="o">[</span><span class="s">&quot;disconnect&quot;</span><span class="o">]</span></code></div>                Works for all profiling sessions started with <code class="code" data-lang="Java">start</code>, <code class="code" data-lang="Java">start-iis</code>, or                <code class="code" data-lang="Java">attach</code>                commands.            </p></li></ol></section>    </div>    <div class="chapter"><h2 id="api" data-toc="Working_with_dotMemory_Command-Line_Profiler#api">Starting application and getting snapshots using api</h2>        <p id="eaf331ba">            You also have the option to control profiling (get snapshots, detach from process, and so on)            using the            <a href="Controlling_Profiling_Process_Through_API.html">API</a>.        </p>        <section class="procedure-steps"><h2 id="a8c6e07b">To start MyApp.exe and control profiling with API</h2><ul class="list "><li class="list__item" id="ad8677da"><p>                Run the command:                <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">dotMemory</span><span class="o">.</span><span class="na">exe</span> <span class="n">start</span> <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">api</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">MyApp</span><span class="err">\</span><span class="n">MyApp</span><span class="o">.</span><span class="na">exe</span></code></div>            </p></li></ul></section>    </div>    <div class="chapter"><h2 id="attach" data-toc="Working_with_dotMemory_Command-Line_Profiler#attach">Attaching to and profiling running applications</h2>        <p id="4258ace5">            If you want to profile an already running application and have full control over the            profiling process (unlike the <a href="#instant">get-snapshot</a> scenario), you should use the            <code class="code" data-lang="Java">attach</code>            command. It allows the profiler to attach to running processes (by PID or name as well as            <a href="#instant">get-snapshot</a>) and get snapshots using triggers, stdin commands, or the API.            For instance, here is the example of how to profile a running app MyApp.exe and get snapshots using a            trigger.        </p>        <section class="procedure-steps"><h2 id="111d2ef5">To attach to a running app and get snapshots periodically</h2><ul class="list "><li class="list__item" id="2852d8db"><p>                Run the command:                <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">dotMemory</span> <span class="n">attach</span> <span class="n">MyApp</span><span class="o">.</span><span class="na">exe</span> <span class="o">--</span><span class="n">trigger</span><span class="o">-</span><span class="n">timer</span><span class="o">=</span><span class="mi">30</span><span class="n">s</span></code></div>            </p></li></ul></section>    </div>    <div class="chapter"><h2 id="iis" data-toc="Working_with_dotMemory_Command-Line_Profiler#iis">Running and profiling iis-hosted web applications</h2>        <p id="b8199955">            If you want to profile an ASP.NET web application that runs on IIS server, you should use the            <code class="code" data-lang="Java">start-iis</code>            command. After you run the command, IIS will be started under profiling (for more            details on how IIS-hosted apps are profiled, refer to <a href="Profile_ASP_Web_Site.html"><span>Profile Web Application on IIS Server</span></a>).            Note that <code class="code" data-lang="Java">start-iis</code> supports the same ways of controlling profiling as            the <code class="code" data-lang="Java">start</code> command: using triggers, stdin commands, and the API.            For instance, here is the example of how to profile a web app and get snapshots using a trigger.        </p>        <section class="procedure-steps"><h2 id="6e18cacd">To run IIS under profiling and get snapshots periodically</h2><ul class="list "><li class="list__item" id="96582cde"><p>                Run the command:                <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">dotMemory</span><span class="o">.</span><span class="na">exe</span> <span class="n">start</span><span class="o">-</span><span class="n">iis</span> <span class="o">--</span><span class="n">trigger</span><span class="o">-</span><span class="n">timer</span><span class="o">=</span><span class="mi">30</span><span class="n">s</span> <span class="o">--</span><span class="n">open</span><span class="o">-</span><span class="n">url</span><span class="o">=</span><span class="n">localhost</span><span class="o">/</span><span class="n">myapp</span> <span class="o">--</span><span class="n">use</span><span class="o">-</span><span class="n">browser</span><span class="o">=</span><span class="n">Chrome</span></code></div>            </p></li></ul></section>        <p id="60b5d562">            Here:            <ul class="list _ul"><li class="list__item" id="ad8ede5a"><p>                    <code class="code" data-lang="Java">--open-url=localhost/myapp</code>                    - URL of the profiled application that will be opened after you run profiling.                </p></li><li class="list__item" id="df3dc068"><p>                    <code class="code" data-lang="Java">--use-browser=Chrome</code>                    - browser that should be used to open the URL. If not provided, the default system browser                    will be used.                </p></li></ul>        </p>    </div><div class="last-modified" data-skip-index="skip">Last modified: 15 March 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="dotMemory_API_Reference.html">API Reference</a><a class="navigation-links__next" href="Analyzing_Results.html">Analyzing Profiling Results</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/help/app/v2/app.js"></script></body></html>