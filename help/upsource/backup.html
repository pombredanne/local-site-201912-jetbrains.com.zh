<html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta charset="UTF-8"><title>备份和还原数据-帮助|帮助上游</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="backup"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索上游帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>上载2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="default" data-group="primary" selected>默认（Windows / Linux）</option><option value="mac_os_x_10.5_" data-group="secondary">默认（Mac OS X 10.5+）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="backup.xml" data-toc="backup">备份和还原数据</h1>   <p id="40272761">借助Upsource，您可以轻松备份和还原所有内容和配置数据，以防止在系统故障或升级到较新的版本时丢失数据。</p>   <div class="chapter"><h2 id="CreatingSchedulingBackups" data-toc="backup#CreatingSchedulingBackups">创建和安排备份</h2>      <section class="procedure-steps"><h3 id="47fb0211">创建备份</h3><ol class="list _decimal"><li class="list__item" id="73405996"><p>以管理员身份登录到Upsource。</p></li><li class="list__item" id="2ac78576"><p>点击设置图标<img alt="设定值" title="设定值" src="/help/img/upsource/2019.1/settings.png" id="14adb2d4" width="19" height="17" class="inline-icon-19">在屏幕的右上方。“ <span class="control">管理”</span>视图将打开。</p></li><li class="list__item" id="9d7089d1"><p>单击立即<span class="control">备份</span>链接。</p></li><li class="list__item" id="ac2734c3"><p>单击“ <span class="control">确定”</span>创建备份。</p></li></ol></section>      <p id="8764056d">将会在<span class="filepath"><upsource_home>\ backups</upsource_home></span>目录中创建一个包含已保存数据的新文件夹。文件夹名称反映了备份的日期和时间。备份过程完成后，该文件夹的路径将显示在项目列表的顶部：</p>      <figure><img alt="backup_path.png" title="backup_path.png" src="/help/img/upsource/2019.1/backup_path.png" id="1f85c9b2" width="610" height="628"></figure>      <aside class="note " rel="1f85c9b2" id="1def6a21" data-title="">         <p id="996ed2c7">此处列出的所有命令都是Windows命令。如果您使用的是Linux或macOS，只需更换<code class="code">.bat</code>与<code class="code">.sh</code> 。</p>      </aside>      <p id="f2f20954">您可以<b id="aaedba73">更改特定日期备份文件夹的存储位置，</b>并从默认<span class="filepath"><upsource_home>\ backups</upsource_home></span>目录切换到另一个目录：</p>      <section class="procedure-steps"><ol class="list _decimal"><li class="list__item" id="74d7059a"><p>            <a href="starting-stopping.html">停止</a>上传。</p></li><li class="list__item" id="5bba20ab"><p>运行以下命令：</p><div class="code-block" data-lang="bash"><upsource_home>/bin/upsource.bat配置--backups-dir =<backups_directory></backups_directory></upsource_home></div>哪里<code class="code"><backups_directory></code>是您要将备份文件夹存储在的目录。如果不存在，Upsource将创建它。<p></p></li><li class="list__item" id="765e29e1"><p>            <a href="starting-stopping.html">启动</a>上游。</p></li></ol></section>      <section class="procedure-steps"><h3 id="86c15e20">安排自动备份</h3><ol class="list _decimal"><li class="list__item" id="a38f9d78"><p>在<span class="control">管理</span>视图中，点击<span class="control">设置备份时间表</span> 。</p></li><li class="list__item" id="8180d6ef"><p>指定备份的时间间隔，然后单击“ <span class="control">保存”</span> 。</p></li></ol></section>      <p id="814393c1">当前，Upsource仅允许设置时间间隔，但是，如果您要<b id="bf335818">安排在特定的日期和时间进行备份</b> ，则可以使用作业计划程序工具（Windows的Task Scheduler或基于Unix的OS的<a href="https://en.wikipedia.org/wiki/Cron" rel="noopener noreferrer" data-external="true" target="_blank">Cron</a> ）运行以下命令：</p><div class="code-block" data-lang="bash"><upsource_home>/lib/upsource-console.bat -c“备份<target_directory>”</target_directory></upsource_home></div>哪里<code class="code"><target_directory></code>是要在其中存储备份数据的文件夹。<p></p>   </div>   <div class="chapter"><h2 id="RestoringBackup" data-toc="backup#RestoringBackup">从备份还原</h2>      <aside class="note " rel="RestoringBackup" id="8edcf557" data-title="">         <p id="1d385c24">由于备份目录仅包含Upsource本机数据，因此Upsource必须在还原过程中获取和索引存储库内容，这对于大型项目可能要花费很长时间（最多几个小时）。</p>      </aside>      <p id="860eb079">每个备份目录都包含<span class="filepath">数据</span>和<span class="filepath">conf</span>目录，这些目录又包含该备份期间保存的内容和配置数据。</p>      <p id="b0cbaaf7">您可以通过将选定备份的<span class="filepath">data</span>和<span class="filepath">conf</span>文件夹复制到您的数据库中来回滚到较早的时间点<span class="filepath"><upsource_home></upsource_home></span>目录。</p>      <p id="9fa76d9b">如果您的Upsource实例损坏，则可以<a href="install-config.html">安装</a>新实例，然后将所选备份的<span class="filepath">data</span>和<span class="filepath">conf</span>文件夹类似地从损坏的实例复制到<span class="filepath"><upsource_home></upsource_home></span>新的Upsource实例的目录。</p>      <p id="f2017b7c">另一个选择是使用特定于您当前和所需安装类型（ZIP或Docker）的<a href="upgrade.html">升级</a>过程，然后按照配置向导选择所需的备份。这样，您可以通过“升级”到相同的Upsource版本或更新的版本来还原损坏的实例。</p>      <p id="ce2b6ee5">如果您的Upsource安装包含大型项目，请考虑使用<a href="upgrade-with-a-minimal-downtime.html">高级升级过程</a>来最大程度地减少还原过程中Upsource服务器的停机时间。</p>   </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月9日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="maintaining-your-upsource-installation.html">维护您的Upsource安装</a> <a class="navigation-links__next" href="migrate.html">将您</a> <a class="navigation-links__prev" href="maintaining-your-upsource-installation.html">的Upsource安装</a> <a class="navigation-links__next" href="migrate.html">移动到另一台服务器</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>