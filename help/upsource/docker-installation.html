<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta charset="UTF-8"><title>Docker installation - Help | Upsource</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Docker_installation"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search Upsource Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>Upsource 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="default" selected>Default (Windows/Linux)</option><option data-group="secondary" value="mac_os_x_10.5_">Default (Mac OS X 10.5+)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Docker_installation" id="Docker_installation.xml">Docker installation</h1>    <p id="94be74c2">Before proceeding with the installation, make sure you have the latest version of <a href="https://www.docker.com/" data-external="true" target="_blank" rel="noopener noreferrer">Docker</a> installed on your host machine.    </p>    <div class="chapter"><h2 id="pull-image">1. Pull Upsource image</h2>        <p id="01f2ee15">Pull an image of the latest Upsource version from the Docker Hub Repository:</p>        <code class="code">docker pull jetbrains/upsource:&lt;version&gt;</code>        Where &lt;version&gt; is a full version number of an Upsource build.    </div>    <div class="chapter"><h2 id="prepare-folders">2. Prepare folders</h2>        <aside class="note " data-title="" rel="prepare-folders" id="8f932c85">            <p id="76cc5cef">You can skip this step and the volume-mapping commands shown in the next step for demo or test runs, but                doing so in production instances is not recommended. Without the mapping all Upsource data will be                routed to anonymous container volumes and may be accidentally lost with a container removal. Besides,                all data will be stored by the Docker engine in subfolders with cryptic names, making it nearly                impossible to locate and access for future backups or upgrades.            </p>        </aside>        <p id="a45f636b">Create empty directories to store Upsource data, configuration, log, and backup files:</p>        <div class="code-block" data-lang="bash">
            mkdir -p -m 750 &lt;path to data directory&gt; &lt;path to logs directory&gt; &lt;path to conf directory&gt;
            &lt;path to backups directory&gt;
    </div>        <p id="c0311870">These directories will be passed to the Upsource container as volumes.</p>        <p id="6136fdd1">It's recommended that you name the folders correspondingly:</p>        <ul class="list _ul"><li class="list__item" id="e3c55832">                <i id="c286ad96">data</i>            </li><li class="list__item" id="d5cfbf99">                <i id="3157e1ab">config</i>            </li><li class="list__item" id="7568ac97">                <i id="3f9dabb0">logs</i>            </li><li class="list__item" id="8ef0bfe5">                <i id="93ec27bf">backups</i>            </li></ul>        <p id="00d62268">The Upsource service runs inside the Docker container under a non-root account 13001:13001 (group:id). Give            that account read/write permissions to access the directories you've created            (Required for Linux only — skip this step for macOS or Windows):        </p>        <div class="code-block" data-lang="bash">
            chown -R 13001:13001 &lt;path to data directory&gt; &lt;path to logs directory&gt; &lt;path to conf
            directory&gt; &lt;path to backups directory&gt;
    </div>    </div>    <div class="chapter"><h2 id="run">3. Run Upsource</h2>        <p id="aa52c7ed">Use the following command to run a container with Upsource server and map Upsource data volumes and port:</p>        <div class="code-block" data-lang="bash">
            docker run -it --name &lt;upsource-server-instance&gt; \
            -v &lt;path to data directory&gt;:/opt/upsource/data \
            -v &lt;path to conf directory&gt;:/opt/upsource/conf \
            -v &lt;path to logs directory&gt;:/opt/upsource/logs \
            -v &lt;path to backups directory&gt;:/opt/upsource/backups \
            -p &lt;port on host&gt;:8080 \
            jetbrains/upsource:&lt;version&gt;
    </div>        <p id="9ea09717">Where:</p>        <p id="82c3cf63">            <code class="code">&lt;upsource-server-instance&gt;</code>            is a name you give to the container.        </p>        <p id="b20d8339">            <code class="code">-v &lt;path to data directory&gt;:/opt/upsource/data</code>            maps the <i id="c28541d3">data</i> directory in the container to the <i id="62307a14">data</i> directory you've created on the host            machine in Step 2. The same mapping is set for the other directories: <i id="ddf0b9bd">conf, logs, backups</i>.        </p>        <p id="b986e334">            <code class="code">-p &lt;port on host&gt;:8080</code>            this port mapping instructs your host machine to listen on &lt;port on host&gt; and propagate all traffic to            port 8080 inside the Docker container.        </p>        <p id="ae04a51e"><b id="a1c38f54">Windows only</b>: add the parameter <code class="code">-u root</code> after <code class="code">-p &lt;port on host&gt;:8080</code>.        </p>        <p id="551c6430">            <code class="code">jetbrains/upsource:&lt;version&gt;</code>            points to the correct image with the Upsource build.        </p>        <p id="52f51351">Upsource service is started on {0.0.0.0:8080} inside the Docker container, and port 8080 is mapped to &lt;port            on host&gt; you've specified. This way the service may be accessed from any machine that has network access            to &lt;port on host&gt; of your host machine. For instance, if FQDN of the host machine is host.mydomain.com            and the &lt;port on host&gt; is 7777, then the service will be available at http://host.mydomain.com:7777        </p>    </div>    <div class="chapter"><h2 id="configure">4. Configure Upsource</h2>        <p id="c66a89c1">On the first run, Upsource service will start with Configuration Wizard at the address mentioned above. Open            your browser, enter the address and follow the steps described in            <a href="configuration-wizard.html">Things to configure after the first start</a>            to complete the setup.        </p>        <p id="fecaff99">For automated installation purposes, you can <b id="023403ad">skip the wizard</b>, however you need to explicitly set <i id="f57c294f">            base URL        </i> — the URL at which the Upsource service will be available to the end users.        </p>        <p id="5ac134d4">To skip Configuration Wizard, run the following command <b id="0b009f02">before</b> running Upsource (Step 3):        </p>        <div class="code-block" data-lang="bash">
            docker run -it
            -v &lt;path to data directory&gt;:/opt/upsource/data \
            -v &lt;path to conf directory&gt;:/opt/upsource/conf \
            -v &lt;path to logs directory&gt;:/opt/upsource/logs \
            -v &lt;path to backups directory&gt;:/opt/upsource/backups \
            -p &lt;port on host&gt;:8080 \
            jetbrains/upsource:&lt;version&gt; \
            configure \
            -J-Ddisable.configuration.wizard.on.clean.install=true \
            --base-url=http://upsource.mydomain.com:XXXX
    </div>        <p id="5e8e905f"><b id="cca0f96d">Windows only</b>: add the parameter <code class="code">-u root</code> after <code class="code">-p &lt;port on host&gt;:8080</code>.        </p>        <p id="0344c0fa">If you ever need to <b id="c96522a0">change the base URL</b> for your running Upsource instance, proceed as follows:        </p>        <section class="procedure-steps"><ol class="list _decimal"><li class="list__item" id="066e36c9">                <p id="0b641acd">Stop Upsource:                    <code class="code">docker exec &lt;containerId&gt; stop</code>                </p>            </li><li class="list__item" id="48835cd2">                <p id="6da9bdb7">Run the following command:</p>                <div class="code-block" data-lang="bash">
                    docker run -it
                    -v &lt;path to data directory&gt;:/opt/upsource/data \
                    -v &lt;path to conf directory&gt;:/opt/upsource/conf \
                    -v &lt;path to logs directory&gt;:/opt/upsource/logs \
                    -v &lt;path to backups directory&gt;:/opt/upsource/backups \
                    -p &lt;port on host&gt;:8080 \
                    jetbrains/upsource:&lt;version&gt; \
                    configure --base-url=http://upsource.mydomain.com:XXXX
    </div>                <p id="96b62f61"><b id="3a7447af">Windows only</b>: add the parameter <code class="code">-u root</code> after                    <code class="code">-p &lt;port on host&gt;:8080</code>.                </p>            </li><li class="list__item" id="8a24338e">                <p id="dcde937d">Start Upsource:                    <code class="code">docker start &lt;containerId&gt;</code>                </p>            </li></ol></section>        <p id="bfeec9c6">Containers that are run to configure your installation are disposable and can be safely removed afterwards            with the <code class="code">docker rm</code> command.        </p>        <p id="578b6a40">To see all stopped containers, run            <code class="code">docker ps -a</code>        </p>    </div>    <div class="last-modified" data-skip-index="skip">Last modified: 9 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="zip-installation.html">ZIP installation</a><a class="navigation-links__next" href="in-cloud-installation.html">In-cloud installation</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>