<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta charset="UTF-8"><title>Tuning up a Docker installation - Help | Upsource</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Tuning_up_a_Docker_installation"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search Upsource Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>Upsource 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="default" selected>Default (Windows/Linux)</option><option data-group="secondary" value="mac_os_x_10.5_">Default (Mac OS X 10.5+)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Tuning_up_a_Docker_installation" id="Tuning_up_a_Docker_installation.xml">Tuning up a Docker installation</h1>    <aside class="note " data-title="" rel="Tuning_up_a_Docker_installation.xml" id="38a34660">        <p id="85aac9dc">The commands on this page are for Linux and OS X. For a Windows installation, replace <code class="code">.sh</code> with <code class="code">.bat</code> and use the backslash.        </p>        <p id="d67d156a">Always execute commands on behalf of the OS user that runs the Upsource service. These commands create            configuration files and folders. The Upsource service user should have sufficient permissions to access            these files and folders.        </p>    </aside>    <aside class="note " data-title="" rel="Tuning_up_a_Docker_installation.xml" id="0a29c700">        <p id="c8a27767">Read about Upsource services, processes, properties and how they're organized and interrelated in<a href="advanced-upsource-tuning.html">Advanced Upsource tuning</a>.        </p>    </aside>    <aside class="warning " data-title="" rel="Tuning_up_a_Docker_installation.xml" id="e1201067">        <p id="4141a08a">The one-way synchronization from the configuration file to the database can lead to problems if you're not            careful. System properties that are set in the Upsource UI are applied directly to the database. If you            change a setting in the UI that has been updated in the configuration file, the setting in the configuration            file will be applied to the database on restart, overwriting the setting in the UI.        </p>    </aside>    <div class="chapter"><h2 id="configure-launcher-properties" data-toc="Tuning_up_a_Docker_installation#configure-launcher-properties">Configuring Upsource Launcher properties</h2>        <p id="62d70f97">Upsource Launcher process uses:</p>        <ul class="list _ul"><li class="list__item" id="4748164f">                <p id="53a1221c">Upsource-specific properties — can be changed programmatically with the <code class="code">configure</code> command.                </p>                <p id="cd50ae4e">For a list of configurable Upsource-specific Launcher properties, see                    <a href="upsource-launcher-properties.html#upsource-specific-properties">Upsource-specific properties</a>                </p>            </li><li class="list__item" id="326bf3f8">                <p id="07493541">JVM properties — can be changed programmatically with the <code class="code">configure</code> command or by                    manually editing the configuration file <i id="f216057e">upsource.jvmoptions</i>.                </p>                <p id="53d65233">A JVM property can be also changed on a                    <b id="0ea9cdb2">                        <a href="#change-jvm-temporary">temporary</a>                    </b>                    basis, passing it as an ad hoc parameter with the regular <code class="code">run</code> command.                    This method only applies the changes for the current run and does not change the configuration file.                    Use this option when you want to test changes to your server configuration.                </p>                <p id="1022d1cc">For a list of the default JVM options for the Upsource Launcher process, see<a href="upsource-launcher-properties.html#default-jvm-options">Launcher default JVM options</a>.                </p>            </li></ul>        <section class="procedure-steps"><h3 id="50964181">To change Upsource-specific Launcher properties:</h3><ol class="list _decimal"><li class="list__item" id="5ae2e505">                <p id="3ebcaa58">Stop Upsource:                    <code class="code">docker exec &lt;containerId&gt; stop</code>                </p>            </li><li class="list__item" id="54d8465a"><p>Enter the regular <code class="code">run</code> command, followed by the <code class="code">configure</code> command and all of                the settings that you want to update in the configuration file. You can set multiple options in a single                command. For example:                <div class="code-block" data-lang="bash">
                    docker run -it
                    -v &lt;path to data directory&gt;:/opt/upsource/data \
                    -v &lt;path to conf directory&gt;:/opt/upsource/conf \
                    -v &lt;path to logs directory&gt;:/opt/upsource/logs \
                    -v &lt;path to backups directory&gt;:/opt/upsource/backups \
                    -p &lt;port on host&gt;:8080 \
                    jetbrains/upsource:&lt;version&gt; \
                    configure --listen-port 1111 --base-url http://upsource.mydomain.com:2222
    </div>            </p></li></ol></section>        <aside class="tip sideblock" data-title="" rel="50964181" id="efb8bc0e">            <p id="2646e458">You can mix Upsource-specific and JVM properties in a single <code class="code">configure</code> command.            </p>        </aside>        <section class="procedure-steps"><h3 id="change-jvm-program">To change JVM Launcher properties programmatically:</h3><ol class="list _decimal"><li class="list__item" id="32df84cd">                <p id="11cb332e">Stop Upsource:                    <code class="code">docker exec &lt;containerId&gt; stop</code>                </p>            </li><li class="list__item" id="466e3ced">                <p id="e8650b2c">Enter the regular <code class="code">run</code> command                </p>                                    <p id="080c4e2f">Specify the entry point</p>                                                    <p id="384002d4">Type in the <code class="code">configure</code> command followed by all of the settings that you want to                        update in the configuration file.                    </p>                                <p id="d654c118">Use the <code class="code">-J</code> prefix followed by a JVM option. Do not add any spaces between the prefix and                    the option.                </p>                <p id="bf1b7303">The symbol that precedes the option determines how it is applied:</p>                <ul class="list _ul"><li class="list__item" id="7ff8b3b8"><p>Add an option with the <code class="code">-</code> symbol.                    </p></li><li class="list__item" id="c98484ba"><p>Remove an option with the <code class="code">+</code> symbol.                    </p></li></ul>                <p id="9c554ed8">If you specify a value, the corresponding option is only removed if it has exactly the same value.                </p>                <p id="0f5b5cad">You can set multiple options in a single command.</p>                <p id="896b2d17">Example:</p>                <div class="code-block" data-lang="bash">
                    docker run -it
                    -v &lt;path to data directory&gt;:/opt/upsource/data \
                    -v &lt;path to conf directory&gt;:/opt/upsource/conf \
                    -v &lt;path to logs directory&gt;:/opt/upsource/logs \
                    -v &lt;path to backups directory&gt;:/opt/upsource/backups \
                    -p &lt;port on host&gt;:8080 \
                    jetbrains/upsource:&lt;version&gt; \
                    configure -J-Xmx800m
    </div>                <p id="6dad241e">In this example we increased the allocated JVM heap size from 600MB (default) to 800MB.</p>                <ul class="list _ul"><li class="list__item" id="2c9b906f"><p>Upsource starts with the specified settings.</p></li><li class="list__item" id="4588b19f"><p>The configuration file <i id="9edae3b8">upsource.jvmoptions</i> is modified and the new settings will be                        applied to any consequent startup.                    </p></li></ul>            </li></ol></section>        <p id="96909234">You can also change JVM setting by editing a configuration file manually.</p>        <section class="procedure-steps"><h3 id="change-jvm-manually">To change JVM Launcher properties manually:</h3><ol class="list _decimal"><li class="list__item" id="78bcf8a1">                <p id="ab1db86d">Stop Upsource:                    <code class="code">docker exec &lt;containerId&gt; stop</code>                </p>            </li><li class="list__item" id="64d030b1">                <p id="c2ec2d90">Open the configuration file <i id="ef1c1fb1">upsource.jvmoptions</i> located in &lt;path to conf directory&gt;/conf/.                </p>                <p id="37ff80fd">If the the file does not exist, create it and copy the contents of the sample configuration file with                    the <i id="0d577c7f">.dist</i> extension into it.                </p>            </li><li class="list__item" id="63ddd928"><p>Edit the JVM options directly in the file. Add new JVM options to the end of the file, listing each                option on a new line. To set a pre-defined JVM option, simply uncomment the corresponding line.            </p></li><li class="list__item" id="b7663765"><p>Save and close the file.</p></li><li class="list__item" id="e20a8bb5">                <p id="d4a5c4b2">Start Upsource: <code class="code">docker start &lt;containerId&gt;</code>.                </p>                <ul class="list _ul"><li class="list__item" id="049242fe"><p>The changes to the configuration file are copied to the database.</p></li><li class="list__item" id="91f608a5"><p>Upsource starts with the specified settings.</p></li></ul>            </li></ol></section>        <section class="procedure-steps"><h3 id="change-jvm-temporary">To change JVM Launcher properties on a temporary basis (ad hoc):</h3><ol class="list _decimal"><li class="list__item" id="e3d2a688">                <p id="c121092f">Stop Upsource:                    <code class="code">docker exec &lt;containerId&gt; stop</code>                </p>            </li><li class="list__item" id="81975aa6">                <p id="70c929c8">Enter the regular <code class="code">run</code> command, followed by all of the settings that you want to pass to                    Upsource on start.                </p>                <p id="739ba269">Example:</p>                <div class="code-block" data-lang="bash">
                    docker run -it
                    -v &lt;path to data directory&gt;:/opt/upsource/data \
                    -v &lt;path to conf directory&gt;:/opt/upsource/conf \
                    -v &lt;path to logs directory&gt;:/opt/upsource/logs \
                    -v &lt;path to backups directory&gt;:/opt/upsource/backups \
                    -p &lt;port on host&gt;:8080 \
                    jetbrains/upsource:&lt;version&gt; \
                    --J-Xmx1024m --J-XX:+HeapDumpOnOutOfMemoryError
    </div>                <p id="43c69fb2">Use the <code class="code">--J</code> prefix followed by a JVM option. Do not add any spaces between the prefix                    and the option.                </p>                <p id="640e5dcd">The symbol that precedes the option determines how it is applied:</p>                <ul class="list _ul"><li class="list__item" id="90a26d75"><p>Add an option with the <code class="code">-</code> symbol.                    </p></li><li class="list__item" id="5c78a7a8"><p>Remove an option with the <code class="code">+</code> symbol.                    </p></li></ul>                <p id="3910c05e">If you specify a value, the corresponding option is only removed if it has exactly the same value.                </p>                <p id="1d8309a8">You can set multiple options in a single command.</p>                <ul class="list _ul"><li class="list__item" id="33e4b62c"><p>Upsource starts with the specified settings, bypassing the configuration file.</p></li><li class="list__item" id="19800829"><p>The configuration file is not modified.</p></li><li class="list__item" id="a0972bff">                        <p id="c091f7d1">Subsequent starts that do not specify the ad hoc parameter use the settings that are stored                            in the configuration file. To run Upsource with the previous settings, simply restart it                            without passing any custom parameters.                        </p>                    </li></ul>            </li></ol></section>    </div>    <div class="chapter"><h2 id="configure-frontend-properties" data-toc="Tuning_up_a_Docker_installation#configure-frontend-properties">Configuring Upsource Frontend properties</h2>        <p id="22a9ea38">Upsource Frontend process uses:</p>        <ul class="list _ul"><li class="list__item" id="15ad88e2">                <p id="1ce7dbeb">                    <a href="upsource-frontend-properties.html#upsource-specific-properties">Upsource-specific                        properties                    </a>                </p>            </li><li class="list__item" id="d3c24325">                <p id="8a6aeecf">                    <a href="upsource-frontend-properties.html#default-jvm-options">JVM properties (options)</a>                </p>            </li></ul>        <p id="78cf6ca7">Upsource Frontend properties can be changed programmatically with the <code class="code">configure</code> command or by            manually editing the configuration file            <i id="153bbeab">upsource-frontend.jvmoptions</i>        </p>        <section class="procedure-steps"><h3 id="c5fa4a1b">To configure Frontend properties programmatically:</h3><ol class="list _decimal"><li class="list__item" id="997f6324">                <p id="80d9e75b">Stop Upsource:                    <code class="code">docker exec &lt;containerId&gt; stop</code>                </p>            </li><li class="list__item" id="74d80bcc">                <p id="5573aefb">Enter the regular <code class="code">run</code> command                </p>                                    <p id="a2071608">Specify the entry point</p>                                                    <p id="eb146c09">Type in the <code class="code">configure</code> command followed by all of the settings that you want to                        update in the configuration file.                    </p>                                <p id="b38f202d">Use the <code class="code">-J</code> prefix followed by a property or JVM option. Do not add any spaces between                    the prefix and the property.                </p>                <p id="adc07b26">The symbol that precedes the option determines how it is applied:</p>                <ul class="list _ul"><li class="list__item" id="6c902622"><p>Add an option with the <code class="code">-</code> symbol.                    </p></li><li class="list__item" id="a230bc02"><p>Remove an option with the <code class="code">+</code> symbol.                    </p></li></ul>                <p id="34541846">If you specify a value, the corresponding option is only removed if it has exactly the same value.                </p>                <p id="d5f29313">You can set multiple options in a single command.</p>                <p id="d897b636">Example:</p>                <div class="code-block" data-lang="bash">
                    docker run -it
                    -v &lt;path to data directory&gt;:/opt/upsource/data \
                    -v &lt;path to conf directory&gt;:/opt/upsource/conf \
                    -v &lt;path to logs directory&gt;:/opt/upsource/logs \
                    -v &lt;path to backups directory&gt;:/opt/upsource/backups \
                    -p &lt;port on host&gt;:8080 \
                    --entrypoint=/bin/bash jetbrains/upsource:&lt;version&gt; \
                    /opt/upsource/apps/upsource-frontend/bin/upsource-frontend.sh \
                    configure -J-Dfrontend.diff.filesize.limit=2000
    </div>                <p id="668c7473">In this example we increased the maximum number of lines to display in a diff from 1000(default) to                    2000.                </p>                <ul class="list _ul"><li class="list__item" id="6ae8c49a"><p>Upsource starts with the specified settings.</p></li><li class="list__item" id="a9ee6a32"><p>The configuration file <code class="code">upsource-frontend.jvmoptions</code> is modified and the new                        settings will be applied to any consequent startup.                    </p></li></ul>            </li></ol></section>        <section class="procedure-steps"><h3 id="a80480ee">To configure Frontend properties manually:</h3><ol class="list _decimal"><li class="list__item" id="793c779e">                <p id="b8e50915">Stop Upsource:                    <code class="code">docker exec &lt;containerId&gt; stop</code>                </p>            </li><li class="list__item" id="2b4514f6">                <p id="3b335b0e">Open the configuration file <i id="8d14603e">upsource-frontend.jvmoptions</i>. The file is located in the <code class="code">&lt;path to conf directory&gt;/conf/upsource-frontend/</code>. If the file does not exist, create                    it.                </p>            </li><li class="list__item" id="1f4ec382"><p>Edit existing properties directly in the file. Add new properties with their values to the end of the                file.            </p></li><li class="list__item" id="471baa2f"><p>Save and close the file.</p></li><li class="list__item" id="5e33f157">                <p id="5e35ef9f">Start Upsource: <code class="code">docker start &lt;containerId&gt;</code>.                </p>                <ul class="list _ul"><li class="list__item" id="9bd0a90a"><p>The changes to the configuration file are copied to the database.</p></li><li class="list__item" id="b0daa389"><p>Upsource starts with the specified settings.</p></li></ul>            </li></ol></section>    </div>    <div class="chapter"><h2 id="configure-cassandra-properties" data-toc="Tuning_up_a_Docker_installation#configure-cassandra-properties">Configuring Upsource Cassandra properties</h2>        You can manage the Cassandra process by changing its JVM options with the <code class="code">configure</code> command or by        manually editing the configuration file <i id="d4718455">cassandra.jvmoptions</i>. See        <a href="upsource-cassandra-properties.html">Upsource Cassandra properties</a>        for a list of the default options.        <section class="procedure-steps"><h3 id="79fd9028">To configure Cassandra properties programmatically:</h3><ol class="list _decimal"><li class="list__item" id="1a4a3c5f">                <p id="13ab2b31">Stop Upsource:                    <code class="code">docker exec &lt;containerId&gt; stop</code>                </p>            </li><li class="list__item" id="ac4b364c">                <p id="0d79882a">Enter the regular <code class="code">run</code> command                </p>                                    <p id="1a0fb9ae">Specify the entry point</p>                                                    <p id="4769a9ba">Type in the <code class="code">configure</code> command followed by all of the settings that you want to                        update in the configuration file.                    </p>                                <p id="e1dc656e">Use the <code class="code">-J</code> prefix followed by a JVM option. Do not add any spaces between the prefix and                    the option.                </p>                <p id="4276ce01">The symbol that precedes the option determines how it is applied:</p>                <ul class="list _ul"><li class="list__item" id="ad4d7d23"><p>Add an option with the <code class="code">-</code> symbol.                    </p></li><li class="list__item" id="12b7cddb"><p>Remove an option with the <code class="code">+</code> symbol.                    </p></li></ul>                <p id="e25a78df">If you specify a value, the corresponding option is only removed if it has exactly the same value.                </p>                <p id="39994842">You can set multiple options in a single command.</p>                <p id="9cf7448e">Example:</p>                <div class="code-block" data-lang="bash">
                    docker run -it
                    -v &lt;path to data directory&gt;:/opt/upsource/data \
                    -v &lt;path to conf directory&gt;:/opt/upsource/conf \
                    -v &lt;path to logs directory&gt;:/opt/upsource/logs \
                    -v &lt;path to backups directory&gt;:/opt/upsource/backups \
                    -p &lt;port on host&gt;:8080 \
                    --entrypoint=/bin/bash jetbrains/upsource:&lt;version&gt; \
                    /opt/upsource/apps/cassandra/bin/cassandra.sh \
                    configure -J-Xmx3500m -J-XX:+HeapDumpOnOutOfMemoryError
    </div>                <ul class="list _ul"><li class="list__item" id="6f1d9df0"><p>Upsource starts with the specified settings.</p></li><li class="list__item" id="654b86af"><p>The configuration file <i id="6db67578">cassandra.jvmoptions</i> is modified and the new settings will be                        applied to any consequent startup.                    </p></li></ul>            </li></ol></section>        <section class="procedure-steps"><h3 id="e262af28">To configure Cassandra properties manually:</h3><ol class="list _decimal"><li class="list__item" id="ff6b107a">                <p id="fb9a028f">Stop Upsource:                    <code class="code">docker exec &lt;containerId&gt; stop</code>                </p>            </li><li class="list__item" id="10de7f43">                <p id="ad1102ca">Open the configuration file <i id="b8ec634c">cassandra.jvmoptions</i> located in the <code class="code">&lt;path to conf directory&gt;/conf/cassandra/</code>.                </p>                <p id="cdabcca4">If the the file does not exist, create it and copy the contents of the sample configuration file with                    the <i id="2db98e10">.dist</i> extension into it.                </p>            </li><li class="list__item" id="12777809"><p>Edit the JVM options directly in the file. Add new JVM options to the end of the file, listing each                option on a new line. To set a pre-defined JVM option, simply uncomment the corresponding line.            </p></li><li class="list__item" id="1d9f8b22"><p>Save and close the file.</p></li><li class="list__item" id="16c271b2">                <p id="f610258f">Start Upsource: <code class="code">docker start &lt;containerId&gt;</code>.                </p>                <ul class="list _ul"><li class="list__item" id="519e1448"><p>The changes you made to the configuration file are copied to the database.</p></li><li class="list__item" id="53db6842"><p>Upsource starts with the specified settings.</p></li></ul>            </li></ol></section>    </div><div class="last-modified" data-skip-index="skip">Last modified: 9 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="tuning-up-a-zip-installation.html">Tuning up a ZIP installation</a><a class="navigation-links__next" href="upsource-launcher-properties.html">Upsource Launcher properties</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>