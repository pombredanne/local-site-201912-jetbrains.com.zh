<html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta charset="UTF-8"><title>调整Docker安装-帮助|帮助上游</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Tuning_up_a_Docker_installation"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索上游帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>上载2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="default" data-group="primary" selected>默认（Windows / Linux）</option><option value="mac_os_x_10.5_" data-group="secondary">默认（Mac OS X 10.5+）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Tuning_up_a_Docker_installation.xml" data-toc="Tuning_up_a_Docker_installation">调整Docker安装</h1>    <aside class="note " rel="Tuning_up_a_Docker_installation.xml" id="38a34660" data-title="">        <p id="85aac9dc">本页上的命令适用于Linux和OSX。对于Windows安装，请替换<code class="code">.sh</code>与<code class="code">.bat</code>并使用反斜杠。</p>        <p id="d67d156a">始终代表运行Upsource服务的OS用户执行命令。这些命令创建配置文件和文件夹。上游服务用户应具有足够的权限来访问这些文件和文件夹。</p>    </aside>    <aside class="note " rel="Tuning_up_a_Docker_installation.xml" id="0a29c700" data-title="">        <p id="c8a27767">阅读有关上游服务，流程，属性以及它们如何在<a href="advanced-upsource-tuning.html">高级上游调整中进行</a>组织和相互关联的<a href="advanced-upsource-tuning.html">信息</a> 。</p>    </aside>    <aside class="warning " rel="Tuning_up_a_Docker_installation.xml" id="e1201067" data-title="">        <p id="4141a08a">如果不小心，从配置文件到数据库的单向同步可能会导致问题。在“上游” UI中设置的系统属性将直接应用于数据库。如果您更改了配置文件中已更新的用户界面中的设置，则配置文件中的设置将在重新启动时应用于数据库，从而覆盖用户界面中的设置。</p>    </aside>    <div class="chapter"><h2 id="configure-launcher-properties" data-toc="Tuning_up_a_Docker_installation#configure-launcher-properties">配置上游启动器属性</h2>        <p id="62d70f97">上游启动器过程使用：</p>        <ul class="list _ul"><li class="list__item" id="4748164f">                <p id="53a1221c">特定于上游的属性-可以使用<code class="code">configure</code>命令。</p>                <p id="cd50ae4e">有关可配置的特定于上游的启动器属性的列表，请参阅<a href="upsource-launcher-properties.html#upsource-specific-properties">特定于上游的属性</a>                </p>            </li><li class="list__item" id="326bf3f8">                <p id="07493541">JVM属性-可以使用<code class="code">configure</code>命令或通过手动编辑配置文件<i id="f216057e">upsource.jvmoptions</i> 。</p>                <p id="53d65233">JVM属性也可以<b id="0ea9cdb2"><a href="#change-jvm-temporary">临时</a></b>更改，将其作为常规参数作为临时参数传递<code class="code">run</code>命令。此方法仅将更改应用于当前运行，而不更改配置文件。当您要测试对服务器配置的更改时，请使用此选项。</p>                <p id="1022d1cc">有关Upsource Launcher进程的默认JVM选项的列表，请参阅<a href="upsource-launcher-properties.html#default-jvm-options">Launcher默认JVM选项</a> 。</p>            </li></ul>        <section class="procedure-steps"><h3 id="50964181">要更改特定于上游的启动器属性：</h3><ol class="list _decimal"><li class="list__item" id="5ae2e505">                <p id="3ebcaa58">停止上载： <code class="code">docker exec <containerId> stop</code>                </p>            </li><li class="list__item" id="54d8465a"><p>输入常规<code class="code">run</code>命令，然后是<code class="code">configure</code>命令以及要在配置文件中更新的所有设置。您可以在一个命令中设置多个选项。例如：</p><div class="code-block" data-lang="bash"><path data="" to="" directory="">docker</path>运行<path data="" to="" directory="">-it</path> -v <path data="" to="" directory="">：/ opt / upsource / data \ -v <path to="" conf="" directory="">：/ opt / upsource / conf \ -v <path to="" logs="" directory="">：/ opt / upsource / logs \ -v <path to="" backups="" directory="">：/ opt / upsource / backups \ -p <port on="" host="">：8080 \ jetbrains / upsource： <version>\ configure</version> --listen <version>-port 1111 --base-url http://upsource.mydomain.com:2222</version></port></path></path></path></path></div>            <p></p></li></ol></section>        <aside class="tip sideblock" rel="50964181" id="efb8bc0e" data-title="">            <p id="2646e458">您可以将特定于Upsource的属性和JVM属性混合在一起<code class="code">configure</code>命令。</p>        </aside>        <section class="procedure-steps"><h3 id="change-jvm-program">要以编程方式更改JVM Launcher属性：</h3><ol class="list _decimal"><li class="list__item" id="32df84cd">                <p id="11cb332e">停止上载： <code class="code">docker exec <containerId> stop</code>                </p>            </li><li class="list__item" id="466e3ced">                <p id="e8650b2c">输入常规<code class="code">run</code>命令</p>                                    <p id="080c4e2f">指定入口点</p>                                                    <p id="384002d4">输入<code class="code">configure</code>命令，后跟要在配置文件中更新的所有设置。</p>                                <p id="d654c118">使用<code class="code">-J</code>前缀后跟JVM选项。不要在前缀和选项之间添加任何空格。</p>                <p id="bf1b7303">选项前的符号决定如何应用它：</p>                <ul class="list _ul"><li class="list__item" id="7ff8b3b8"><p>添加一个选项<code class="code">-</code>符号。</p></li><li class="list__item" id="c98484ba"><p>删除带有<code class="code">+</code>符号。</p></li></ul>                <p id="9c554ed8">如果指定一个值，则只有在其具有完全相同的值时才删除相应的选项。</p>                <p id="0f5b5cad">您可以在一个命令中设置多个选项。</p>                <p id="896b2d17">例：</p>                <div class="code-block" data-lang="bash"><path data="" to="" directory="">docker</path>运行<path data="" to="" directory="">-it</path> -v <path data="" to="" directory="">：/ opt / upsource / data \ -v <path to="" conf="" directory="">：/ opt / upsource / conf \ -v <path to="" logs="" directory="">：/ opt / upsource / logs \ -v <path to="" backups="" directory="">：/ opt / upsource / backups \ -p <port on="" host="">：8080 \ jetbrains / upsource： <version>\配置-J-Xmx800m</version></port></path></path></path></path></div>                <p id="6dad241e">在此示例中，我们将分配的JVM堆大小从600MB（默认）增加到800MB。</p>                <ul class="list _ul"><li class="list__item" id="2c9b906f"><p>上游从指定的设置开始。</p></li><li class="list__item" id="4588b19f"><p>修改了配置文件<i id="9edae3b8">upsource.jvmoptions</i> ，新设置将应用于随后的启动。</p></li></ul>            </li></ol></section>        <p id="96909234">您还可以通过手动编辑配置文件来更改JVM设置。</p>        <section class="procedure-steps"><h3 id="change-jvm-manually">要手动更改JVM Launcher属性：</h3><ol class="list _decimal"><li class="list__item" id="78bcf8a1">                <p id="ab1db86d">停止上载： <code class="code">docker exec <containerId> stop</code>                </p>            </li><li class="list__item" id="64d030b1">                <p id="c2ec2d90">打开位于<path to="" conf="" directory="">/ conf /中</path>的配置文件<i id="ef1c1fb1">upsource.jvmoptions</i> <path to="" conf="" directory="">。</path></p>                <p id="37ff80fd">如果该文件不存在，请创建它，然后将扩展名为<i id="0d577c7f">.dist</i>的示例配置文件的内容复制到其中。</p>            </li><li class="list__item" id="63ddd928"><p>直接在文件中编辑JVM选项。在文件末尾添加新的JVM选项，并在新行中列出每个选项。要设置预定义的JVM选项，只需取消注释相应的行。</p></li><li class="list__item" id="b7663765"><p>保存并关闭文件。</p></li><li class="list__item" id="e20a8bb5">                <p id="d4a5c4b2">启动上游： <code class="code">docker start <containerId></code> 。</p>                <ul class="list _ul"><li class="list__item" id="049242fe"><p>对配置文件的更改将复制到数据库。</p></li><li class="list__item" id="91f608a5"><p>上游从指定的设置开始。</p></li></ul>            </li></ol></section>        <section class="procedure-steps"><h3 id="change-jvm-temporary">要临时更改JVM Launcher属性（临时）：</h3><ol class="list _decimal"><li class="list__item" id="e3d2a688">                <p id="c121092f">停止上载： <code class="code">docker exec <containerId> stop</code>                </p>            </li><li class="list__item" id="81975aa6">                <p id="70c929c8">输入常规<code class="code">run</code>命令，然后是您要在启动时传递给Upsource的所有设置。</p>                <p id="739ba269">例：</p>                <div class="code-block" data-lang="bash"><path data="" to="" directory="">docker</path>运行<path data="" to="" directory="">-it</path> -v <path data="" to="" directory="">：/ opt / upsource / data \ -v <path to="" conf="" directory="">：/ opt / upsource / conf \ -v <path to="" logs="" directory="">：/ opt / upsource / logs \ -v <path to="" backups="" directory="">：/ opt / upsource / backups \ -p <port on="" host="">：8080 \ jetbrains / upsource： <version>\ --J-Xmx1024m --J-XX：+ HeapDumpOnOutOfMemoryError</version></port></path></path></path></path></div>                <p id="43c69fb2">使用<code class="code">--J</code>前缀后跟JVM选项。不要在前缀和选项之间添加任何空格。</p>                <p id="640e5dcd">选项前的符号决定如何应用它：</p>                <ul class="list _ul"><li class="list__item" id="90a26d75"><p>添加一个选项<code class="code">-</code>符号。</p></li><li class="list__item" id="5c78a7a8"><p>删除带有<code class="code">+</code>符号。</p></li></ul>                <p id="3910c05e">如果指定一个值，则只有在其具有完全相同的值时才删除相应的选项。</p>                <p id="1d8309a8">您可以在一个命令中设置多个选项。</p>                <ul class="list _ul"><li class="list__item" id="33e4b62c"><p>上游从指定的设置开始，绕过配置文件。</p></li><li class="list__item" id="19800829"><p>配置文件未修改。</p></li><li class="list__item" id="a0972bff">                        <p id="c091f7d1">随后的未指定临时参数的启动将使用存储在配置文件中的设置。要使用先前的设置运行Upsource，只需在不传递任何自定义参数的情况下重新启动它即可。</p>                    </li></ul>            </li></ol></section>    </div>    <div class="chapter"><h2 id="configure-frontend-properties" data-toc="Tuning_up_a_Docker_installation#configure-frontend-properties">配置上游前端属性</h2>        <p id="22a9ea38">上游前端流程使用：</p>        <ul class="list _ul"><li class="list__item" id="15ad88e2">                <p id="1ce7dbeb">                    <a href="upsource-frontend-properties.html#upsource-specific-properties">特定于上游的属性</a>                </p>            </li><li class="list__item" id="d3c24325">                <p id="8a6aeecf">                    <a href="upsource-frontend-properties.html#default-jvm-options">JVM属性（选项）</a>                </p>            </li></ul>        <p id="78cf6ca7">可以通过以下方式以编程方式更改上游前端属性<code class="code">configure</code>命令或通过手动编辑配置文件<i id="153bbeab">upsource-frontend.jvmoptions</i>        </p>        <section class="procedure-steps"><h3 id="c5fa4a1b">要以编程方式配置前端属性：</h3><ol class="list _decimal"><li class="list__item" id="997f6324">                <p id="80d9e75b">停止上载： <code class="code">docker exec <containerId> stop</code>                </p>            </li><li class="list__item" id="74d80bcc">                <p id="5573aefb">输入常规<code class="code">run</code>命令</p>                                    <p id="a2071608">指定入口点</p>                                                    <p id="eb146c09">输入<code class="code">configure</code>命令，后跟要在配置文件中更新的所有设置。</p>                                <p id="b38f202d">使用<code class="code">-J</code>前缀后跟一个属性或JVM选项。不要在前缀和属性之间添加任何空格。</p>                <p id="adc07b26">选项前的符号决定如何应用它：</p>                <ul class="list _ul"><li class="list__item" id="6c902622"><p>添加一个选项<code class="code">-</code>符号。</p></li><li class="list__item" id="a230bc02"><p>删除带有<code class="code">+</code>符号。</p></li></ul>                <p id="34541846">如果指定一个值，则只有在其具有完全相同的值时才删除相应的选项。</p>                <p id="d5f29313">您可以在一个命令中设置多个选项。</p>                <p id="d897b636">例：</p>                <div class="code-block" data-lang="bash"><path data="" to="" directory="">docker run -it</path> -v <path data="" to="" directory="">：/ opt / upsource / data \ -v <path to="" conf="" directory="">：/ opt / upsource / conf \ -v <path to="" logs="" directory="">：/ opt / upsource / logs \ -v <path to="" backups="" directory="">：/ opt / upsource / backups \ -p <port on="" host="">：8080 \- -entrypoint = / bin / bash jetbrains / upsource： <version>\ /opt/upsource/apps/upsource-frontend/bin/upsource-frontend.sh \ configure -J-Dfrontend.diff.filesize.limit = 2000</version></port></path></path></path></path></div>                <p id="668c7473">在此示例中，我们将差异显示的最大行数从1000（默认）增加到2000。</p>                <ul class="list _ul"><li class="list__item" id="6ae8c49a"><p>上游从指定的设置开始。</p></li><li class="list__item" id="a9ee6a32"><p>配置文件<code class="code">upsource-frontend.jvmoptions</code>会被修改，新设置将应用于随后的启动。</p></li></ul>            </li></ol></section>        <section class="procedure-steps"><h3 id="a80480ee">要手动配置前端属性：</h3><ol class="list _decimal"><li class="list__item" id="793c779e">                <p id="b8e50915">停止上载： <code class="code">docker exec <containerId> stop</code>                </p>            </li><li class="list__item" id="2b4514f6">                <p id="3b335b0e">打开配置文件<i id="8d14603e">upsource-frontend.jvmoptions</i> 。该文件位于<code class="code"><path to conf directory>/conf/upsource-frontend/</code> 。如果文件不存在，请创建它。</p>            </li><li class="list__item" id="1f4ec382"><p>直接在文件中编辑现有属性。将新属性及其值添加到文件末尾。</p></li><li class="list__item" id="471baa2f"><p>保存并关闭文件。</p></li><li class="list__item" id="5e33f157">                <p id="5e35ef9f">启动上游： <code class="code">docker start <containerId></code> 。</p>                <ul class="list _ul"><li class="list__item" id="9bd0a90a"><p>对配置文件的更改将复制到数据库。</p></li><li class="list__item" id="b0daa389"><p>上游从指定的设置开始。</p></li></ul>            </li></ol></section>    </div>    <div class="chapter"><h2 id="configure-cassandra-properties" data-toc="Tuning_up_a_Docker_installation#configure-cassandra-properties">配置上游Cassandra属性</h2>您可以通过使用以下命令更改其JVM选项来管理Cassandra进程<code class="code">configure</code>命令或通过手动编辑配置文件<i id="d4718455">cassandra.jvmoptions</i> 。请参阅上<a href="upsource-cassandra-properties.html">载Cassandra属性</a>以获取默认选项的列表。<section class="procedure-steps"><h3 id="79fd9028">要以编程方式配置Cassandra属性：</h3><ol class="list _decimal"><li class="list__item" id="1a4a3c5f">                <p id="13ab2b31">停止上载： <code class="code">docker exec <containerId> stop</code>                </p>            </li><li class="list__item" id="ac4b364c">                <p id="0d79882a">输入常规<code class="code">run</code>命令</p>                                    <p id="1a0fb9ae">指定入口点</p>                                                    <p id="4769a9ba">输入<code class="code">configure</code>命令，后跟要在配置文件中更新的所有设置。</p>                                <p id="e1dc656e">使用<code class="code">-J</code>前缀后跟JVM选项。不要在前缀和选项之间添加任何空格。</p>                <p id="4276ce01">选项前的符号决定如何应用它：</p>                <ul class="list _ul"><li class="list__item" id="ad4d7d23"><p>添加一个选项<code class="code">-</code>符号。</p></li><li class="list__item" id="12b7cddb"><p>删除带有<code class="code">+</code>符号。</p></li></ul>                <p id="e25a78df">如果指定一个值，则只有在其具有完全相同的值时才删除相应的选项。</p>                <p id="39994842">您可以在一个命令中设置多个选项。</p>                <p id="9cf7448e">例：</p>                <div class="code-block" data-lang="bash"><path data="" to="" directory="">docker run -it</path> -v <path data="" to="" directory="">：/ opt / upsource / data \ -v <path to="" conf="" directory="">：/ opt / upsource / conf \ -v <path to="" logs="" directory="">：/ opt / upsource / logs \ -v <path to="" backups="" directory="">：/ opt / upsource / backups \ -p <port on="" host="">：8080 \- -entrypoint = / bin / bash jetbrains / upsource： <version>\ /opt/upsource/apps/cassandra/bin/cassandra.sh \ configure -J-Xmx3500m -J-XX：+ HeapDumpOnOutOfMemoryError</version></port></path></path></path></path></div>                <ul class="list _ul"><li class="list__item" id="6f1d9df0"><p>上游从指定的设置开始。</p></li><li class="list__item" id="654b86af"><p>修改了配置文件<i id="6db67578">cassandra.jvmoptions</i> ，新设置将应用于随后的启动。</p></li></ul>            </li></ol></section>        <section class="procedure-steps"><h3 id="e262af28">要手动配置Cassandra属性：</h3><ol class="list _decimal"><li class="list__item" id="ff6b107a">                <p id="fb9a028f">停止上载： <code class="code">docker exec <containerId> stop</code>                </p>            </li><li class="list__item" id="10de7f43">                <p id="ad1102ca">打开位于以下位置的配置文件<i id="b8ec634c">cassandra.jvmoptions</i> <code class="code"><path to conf directory>/conf/cassandra/</code> 。</p>                <p id="cdabcca4">如果该文件不存在，请创建它，然后将扩展名为<i id="2db98e10">.dist</i>的示例配置文件的内容复制到其中。</p>            </li><li class="list__item" id="12777809"><p>直接在文件中编辑JVM选项。在文件末尾添加新的JVM选项，并在新行中列出每个选项。要设置预定义的JVM选项，只需取消注释相应的行。</p></li><li class="list__item" id="1d9f8b22"><p>保存并关闭文件。</p></li><li class="list__item" id="16c271b2">                <p id="f610258f">启动上游： <code class="code">docker start <containerId></code> 。</p>                <ul class="list _ul"><li class="list__item" id="519e1448"><p>您对配置文件所做的更改将复制到数据库中。</p></li><li class="list__item" id="53db6842"><p>上游从指定的设置开始。</p></li></ul>            </li></ol></section>    </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月9日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="tuning-up-a-zip-installation.html">调整ZIP安装</a> <a class="navigation-links__next" href="upsource-launcher-properties.html">Upsource Launcher属性</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>