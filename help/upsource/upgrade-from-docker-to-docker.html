<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta charset="UTF-8"><title>Upgrade from Docker to Docker - Help | Upsource</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Upgrade_from_Docker_to_Docker"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search Upsource Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>Upsource 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="default" selected>Default (Windows/Linux)</option><option data-group="secondary" value="mac_os_x_10.5_">Default (Mac OS X 10.5+)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Upgrade_from_Docker_to_Docker" id="Upgrade_from_Docker_to_Docker.xml">Upgrade from Docker to Docker</h1>    <p id="354f7c50">Upgrade procedures vary significantly depending on the version increment:</p>    <ul class="list _ul"><li class="list__item" id="426dae4b">            <p id="7e6188e7">                <a href="#major">Major upgrade</a> — i.e. 2018.1 to 2018.2            </p>        </li><li class="list__item" id="d15a102c">            <p id="7a465f0f">                <a href="#minor">Minor upgrade</a> — i.e. 2018.2.0 to 2018.2.5            </p>        </li></ul>    <div class="chapter"><h2 id="major">Major upgrade</h2>        <p id="fdb2bd55">Follow this instruction to upgrade <b id="d5f8665d">your existing Docker installation</b> to a newer major version (i.e.            2018.1.5 to 2018.2.0) <b id="3c2350d4">with a Docker distribution</b>.        </p>        <p id="753b155d">You can also use this procedure to migrate from            <a href="upsource-distributed-installation.html">Upsource distributed installation</a>            to a latest Docker version.        </p>        <section class="procedure-steps"><ol class="list _decimal"><li class="list__item" id="19b8e4d4">                <p id="d9346c1d"><b id="3988ead5">Back up your data!</b>. <a href="backup.html">Create a backup</a> while your existing Upsource                    installation is running.                </p>            </li><li class="list__item" id="02db9ca9">                <p id="954550e9">Stop the running container with your existing Upsource version:</p>                <code class="code">docker exec &lt;containerId&gt; stop</code>            </li><li class="list__item" id="e8ac2415">                <p id="c6c2035f">Delete all content from the <i id="4c6c0cf2">data</i> and <i id="0694d621">conf</i> folders — the folders you mapped as                    volumes to the <i id="e719008a">/opt/upsource/data</i> and <i id="1887e7d6">/opt/upsource/conf</i> inside the container during                    the installation of the existing instance.                </p>            </li><li class="list__item" id="60a9e2df">                <p id="b6fb9c5e">If the date-specific backup folder has been moved from the default directory (the one mapped as a                    volume to the <i id="dadb104e">/opt/upsource/backups</i> inside the container), copy the date-specific backup                    folder to the default directory.                </p>            </li><li class="list__item" id="70d73ed2">                <p id="696f8d04">Pull an image of the latest Upsource version from the Docker Hub Repository:</p>                <p id="7d6ddbbe">                    <code class="code">docker pull jetbrains/upsource:&lt;version&gt;</code>                    Where &lt;version&gt; is a full version number of an Upsource build.                </p>            </li><li class="list__item" id="926ac21f">                <p id="7fa6ceff">Run the new docker container and map Upsource data volumes and port:</p>                <div class="code-block" data-lang="bash">
                    docker run -it --name &lt;upsource-server-instance&gt; \
                    -v &lt;path to data directory&gt;:/opt/upsource/data \
                    -v &lt;path to conf directory&gt;:/opt/upsource/conf \
                    -v &lt;path to logs directory&gt;:/opt/upsource/logs \
                    -v &lt;path to backups directory&gt;:/opt/upsource/backups \
                    -p &lt;port on host&gt;:8080 \
                    jetbrains/upsource:&lt;version&gt;
    </div>                <p id="3eaee5f9">Where:</p>                <p id="9430c76c">                    <code class="code">&lt;upsource-server-instance&gt;</code>                    is a name you give to the container.                </p>                <p id="76adba43">                    <code class="code">-v &lt;path to data directory&gt;:/opt/upsource/data</code>                    maps the <i id="0ec95662">data</i> directory in the container to the corresponding <i id="e7091c9d">data</i> directory left on                    the host machine from the previous installation. The same mapping is set for the other directories: <i id="06bc300f">                    conf, logs, backups</i>.                </p>                <p id="171bf861">                    <code class="code">-p &lt;port on host&gt;:8080</code>                    this port mapping instructs your host machine to listen on &lt;port on host&gt; and propagate all                    traffic to port 8080 inside the Docker container.                </p>                <p id="91c951db">                    <code class="code">jetbrains/upsource:&lt;version&gt;</code>                    points to an image with the new Upsource version.                </p>            </li><li class="list__item" id="df9520a0">                <p id="1cff59e1">Follow the wizard.</p>                <p id="7a129fc0">After the container of the new version finishes the startup process, the Configuration Wizard is                    deployed and listens on the main Upsource port at the URL that ends with some non-root context:                </p>                <code class="code">http://&lt;host&gt;:&lt;port&gt;/contextPath</code>                <p id="005837a3">The wizard URL is printed in the console output and is recorded in the logs:</p>                <code class="code">"JetBrains Upsource Configuration Wizard will be available on [http://&lt;host&gt;:&lt;port&gt;/contextPath] after start"</code>                <p id="d65cad63">Look it up in the console, access the wizard, then follow its steps to finish the upgrade process:                </p>                <ul class="list _alpha-lower"><li class="list__item" id="7ea577b0">                        <p id="cda4c2d3">On the first page of Configuration Wizard click                            <span class="control">Upgrade</span>                        </p>                    </li><li class="list__item" id="fb9caf70">                        <p id="5a63fbab">Select the location of the last backup in the container. It's a date-specific directory                            inside the <i id="55690f61">backups</i> folder, e.g. <i id="49b4bf73">/opt/upsource/backups/2017 Jul 11 18-29-38</i>                        </p>                    </li><li class="list__item" id="e94ed420">                        <p id="aad91809">Verify your system settings and location of system directories. Click <span class="control">Upgrade                        </span> to finish.                        </p>                    </li></ul>                <p id="836e07bf">Meanwhile the Upsource service URL will be showing a page with the "Upgrade in progress" notice to                    Upsource end users.                </p>            </li><li class="list__item" id="f03ddf98">                <p id="239cba86">You can now remove the old container with the following command:</p>                <code class="code">docker rm &lt;containerId&gt;</code>                <p id="a5873cef">To see all stopped containers, run:</p>                <code class="code">docker ps -a</code>            </li></ol></section>    </div>    <div class="chapter"><h2 id="minor">Minor upgrade</h2>        <p id="3385ff0c">Follow this instruction to patch-upgrade <b id="67e7a461">your existing Docker installation</b> to a newer minor version            (i.e. 2018.2.0 to 2018.2.1) <b id="f3a47791">with a Docker distribution</b>.        </p>        <section class="procedure-steps"><ol class="list _decimal"><li class="list__item" id="aad04c95">                <p id="bad1735e">Stop the running container with your existing Upsource version:</p>                <code class="code">docker exec &lt;containerId&gt; stop</code>            </li><li class="list__item" id="8fd813dd">                <p id="2c092808">Pull an image of the latest Upsource version from the Docker Hub Repository:</p>                <p id="4d657127">                    <code class="code">docker pull jetbrains/upsource:&lt;version&gt;</code>                    Where &lt;version&gt; is a full version number of an Upsource build.                </p>            </li><li class="list__item" id="95cec33b">                <p id="0238dd72">Run the new docker container and map Upsource data volumes and port:</p>                <div class="code-block" data-lang="bash">
                    docker run -it --name &lt;upsource-server-instance&gt; \
                    -v &lt;path to data directory&gt;:/opt/upsource/data \
                    -v &lt;path to conf directory&gt;:/opt/upsource/conf \
                    -v &lt;path to logs directory&gt;:/opt/upsource/logs \
                    -v &lt;path to backups directory&gt;:/opt/upsource/backups \
                    -p &lt;port on host&gt;:8080 \
                    jetbrains/upsource:&lt;version&gt;
    </div>                <p id="3ad68245">Where:</p>                <p id="4502e5b3">                    <code class="code">&lt;upsource-server-instance&gt;</code>                    is a name you give to the container.                </p>                <p id="228333e8">                    <code class="code">-v &lt;path to data directory&gt;:/opt/upsource/data</code>                    maps the <i id="80864abd">data</i> directory in the container to the corresponding <i id="9611aeeb">data</i> directory left on                    the host machine from the previous installation. The same mapping is set for the other directories: <i id="d3b8d535">                    conf, logs, backups</i>.                </p>                <p id="09f4c259">                    <code class="code">-p &lt;port on host&gt;:8080</code>                    this port mapping instructs your host machine to listen on &lt;port on host&gt; and propagate all                    traffic to port 8080 inside the Docker container.                </p>                <p id="857aa633">                    <code class="code">jetbrains/upsource:&lt;version&gt;</code>                    points to an image with the new Upsource version.                </p>            </li><li class="list__item" id="41423a3e">                <p id="fc9ff676">Follow the wizard.</p>                <p id="f9202a09">After the container of the new version finishes the startup process, the Configuration Wizard is                    deployed and listens on the main Upsource port at the URL that ends with some non-root context:                </p>                <code class="code">http://&lt;host&gt;:&lt;port&gt;/contextPath</code>                <p id="b8d8327e">The wizard URL is printed in the console output and is recorded in the logs:</p>                <code class="code">"JetBrains Upsource Configuration Wizard will be available on [http://&lt;host&gt;:&lt;port&gt;/contextPath] after start"</code>                <p id="baf5de8a">Look it up in the console, access the wizard, then follow its steps to finish the upgrade process.                </p>                <p id="0c15a346">Meanwhile the Upsource service URL will be showing a page with the "Upgrade in progress" notice to                    Upsource end users.                </p>            </li><li class="list__item" id="bf4ed7a5">                <p id="b1761321">You can now remove the old container with the following command:</p>                <code class="code">docker rm &lt;containerId&gt;</code>                <p id="98ba3336">To see all stopped containers, run:</p>                <code class="code">docker ps -a</code>            </li></ol></section>        <aside class="note " data-title="" rel="b0a461e4" id="534106ba">            <p id="653ddc29">If you've changed the old Upsource image, you need to replicate the changes to the new Upsource image                before starting the new version.            </p>        </aside>    </div><div class="last-modified" data-skip-index="skip">Last modified: 9 August 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="upgrade-from-zip-to-docker.html">Upgrade from ZIP to Docker</a><a class="navigation-links__next" href="upgrade-with-a-zip-distribution.html">Upgrade with a ZIP distribution</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>