<html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta charset="UTF-8"><title>从Docker升级到Docker-帮助|帮助上游</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Upgrade_from_Docker_to_Docker"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索上游帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>上载2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="default" data-group="primary" selected>默认（Windows / Linux）</option><option value="mac_os_x_10.5_" data-group="secondary">默认（Mac OS X 10.5+）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Upgrade_from_Docker_to_Docker.xml" data-toc="Upgrade_from_Docker_to_Docker">从Docker升级到Docker</h1>    <p id="354f7c50">升级过程因版本增量而异：</p>    <ul class="list _ul"><li class="list__item" id="426dae4b">            <p id="7e6188e7">                <a href="#major">重大升级</a> -即从2018.1到2018.2</p>        </li><li class="list__item" id="d15a102c">            <p id="7a465f0f">                <a href="#minor">较小升级</a> -即从2018.2.0 <a href="#minor">升级</a>到2018.2.5</p>        </li></ul>    <div class="chapter"><h2 id="major">重大升级</h2>        <p id="fdb2bd55">请按照以下说明将<b id="d5f8665d">您现有的Docker安装</b>升级到更新的主要版本（即2018.1.5至2018.2.0） <b id="3c2350d4">和Docker发行版</b> 。</p>        <p id="753b155d">您还可以使用此过程从<a href="upsource-distributed-installation.html">Upsource分布式安装</a>迁移到最新的Docker版本。</p>        <section class="procedure-steps"><ol class="list _decimal"><li class="list__item" id="19b8e4d4">                <p id="d9346c1d"><b id="3988ead5">备份您的数据！</b> 。在现有的Upsource安装正在运行时<a href="backup.html">创建备份</a> 。</p>            </li><li class="list__item" id="02db9ca9">                <p id="954550e9">使用现有的Upsource版本停止正在运行的容器：</p>                <code class="code">docker exec <containerId> stop</code>            </li><li class="list__item" id="e8ac2415">                <p id="c6c2035f">从<i id="4c6c0cf2">data</i>和<i id="0694d621">conf</i>文件夹中删除所有内容，这些文件夹是在现有实例安装期间作为卷映射到容器内的<i id="e719008a">/ opt / upsource / data</i>和<i id="1887e7d6">/ opt / upsource / conf</i>的文件夹。</p>            </li><li class="list__item" id="60a9e2df">                <p id="b6fb9c5e">如果特定日期的备份文件夹已从默认目录（该卷作为卷映射到容器内的<i id="dadb104e">/ opt / upsource / backups</i> ）中<i id="dadb104e">移出</i> ，则将特定日期的备份文件夹复制到默认目录中。</p>            </li><li class="list__item" id="70d73ed2">                <p id="696f8d04">从Docker Hub存储库中获取最新的Upsource版本的图像：</p>                <p id="7d6ddbbe">                    <code class="code">docker pull jetbrains/upsource:<version></code>哪里<version>是Upsource版本的完整版本号。</version></p>            </li><li class="list__item" id="926ac21f">                <p id="7fa6ceff">运行新的docker容器并映射上游数据量和端口：</p>                <div class="code-block" data-lang="bash"><upsource-server-instance><path data="" to="" directory="">docker run -it</path></upsource-server-instance> --name <upsource-server-instance>\ -v <path data="" to="" directory="">：/ opt / upsource / data \ -v <path to="" conf="" directory="">：/ opt / upsource / conf \ -v <path to="" logs="" directory="">：/ opt / upsource / logs \ -v <path to="" backups="" directory="">：/ opt / upsource / backups \ -p <port on="" host="">：8080 \ jetbrains /上游： <version>
    </version></port></path></path></path></path></upsource-server-instance></div>                <p id="3eaee5f9">哪里：</p>                <p id="9430c76c">                    <code class="code"><upsource-server-instance></code>是您为容器指定的名称。</p>                <p id="76adba43">                    <code class="code">-v <path to data directory>:/opt/upsource/data</code>将容器中的<i id="0ec95662">数据</i>目录映射到上一次安装在主机上剩余的相应<i id="e7091c9d">数据</i>目录。为其他目录设置了相同的映射： <i id="06bc300f">conf，logs，backups</i> 。</p>                <p id="171bf861">                    <code class="code">-p <port on host>:8080</code>此端口映射指示您的主机侦听<port on="" host="">并将所有流量传播到Docker容器内的端口8080。</port></p>                <p id="91c951db">                    <code class="code">jetbrains/upsource:<version></code>指向具有新的Upsource版本的图像。</p>            </li><li class="list__item" id="df9520a0">                <p id="1cff59e1">按照向导。</p>                <p id="7a129fc0">新版本的容器完成启动过程后，将配置向导并在主Upsource端口上侦听以某些非根上下文结尾的URL：</p>                <code class="code">http://<host>:<port>/contextPath</code>                <p id="005837a3">向导URL打印在控制台输出中，并记录在日志中：</p>                <code class="code">"JetBrains Upsource Configuration Wizard will be available on [http://<host>:<port>/contextPath] after start"</code>                <p id="d65cad63">在控制台中查找它，访问向导，然后按照其步骤完成升级过程：</p>                <ul class="list _alpha-lower"><li class="list__item" id="7ea577b0">                        <p id="cda4c2d3">在“配置向导”的第一页上，单击“ <span class="control">升级”。</span>                        </p>                    </li><li class="list__item" id="fb9caf70">                        <p id="5a63fbab">选择容器中最后一个备份的位置。这是<i id="55690f61">backups</i>文件夹中特定于日期的目录，例如<i id="49b4bf73">/ opt / upsource / backups / 2017 Jul 11 18-29-38</i>                        </p>                    </li><li class="list__item" id="e94ed420">                        <p id="aad91809">验证系统设置和系统目录的位置。单击<span class="control">升级</span>完成。</p>                    </li></ul>                <p id="836e07bf">同时，Upsource服务URL将向Upsource最终用户显示一个带有“ Upgrade in progress”通知的页面。</p>            </li><li class="list__item" id="f03ddf98">                <p id="239cba86">现在，您可以使用以下命令删除旧容器：</p>                <code class="code">docker rm <containerId></code>                <p id="a5873cef">要查看所有停止的容器，请运行：</p>                <code class="code">docker ps -a</code>            </li></ol></section>    </div>    <div class="chapter"><h2 id="minor">小升级</h2>        <p id="3385ff0c">请按照以下说明<b id="f3a47791">使用Docker发行</b>版<b id="67e7a461">将现有Docker安装</b>进行补丁升级到较新的次要版本（即2018.2.0至2018.2.1）。</p>        <section class="procedure-steps"><ol class="list _decimal"><li class="list__item" id="aad04c95">                <p id="bad1735e">使用现有的Upsource版本停止正在运行的容器：</p>                <code class="code">docker exec <containerId> stop</code>            </li><li class="list__item" id="8fd813dd">                <p id="2c092808">从Docker Hub存储库中获取最新的Upsource版本的图像：</p>                <p id="4d657127">                    <code class="code">docker pull jetbrains/upsource:<version></code>哪里<version>是Upsource版本的完整版本号。</version></p>            </li><li class="list__item" id="95cec33b">                <p id="0238dd72">运行新的docker容器并映射上游数据量和端口：</p>                <div class="code-block" data-lang="bash"><upsource-server-instance><path data="" to="" directory="">docker run -it</path></upsource-server-instance> --name <upsource-server-instance>\ -v <path data="" to="" directory="">：/ opt / upsource / data \ -v <path to="" conf="" directory="">：/ opt / upsource / conf \ -v <path to="" logs="" directory="">：/ opt / upsource / logs \ -v <path to="" backups="" directory="">：/ opt / upsource / backups \ -p <port on="" host="">：8080 \ jetbrains /上游： <version>
    </version></port></path></path></path></path></upsource-server-instance></div>                <p id="3ad68245">哪里：</p>                <p id="4502e5b3">                    <code class="code"><upsource-server-instance></code>是您为容器指定的名称。</p>                <p id="228333e8">                    <code class="code">-v <path to data directory>:/opt/upsource/data</code>将容器中的<i id="80864abd">数据</i>目录映射到上一次安装在主机上剩余的相应<i id="9611aeeb">数据</i>目录。为其他目录设置了相同的映射： <i id="d3b8d535">conf，logs，backups</i> 。</p>                <p id="09f4c259">                    <code class="code">-p <port on host>:8080</code>此端口映射指示您的主机侦听<port on="" host="">并将所有流量传播到Docker容器内的端口8080。</port></p>                <p id="857aa633">                    <code class="code">jetbrains/upsource:<version></code>指向具有新的Upsource版本的图像。</p>            </li><li class="list__item" id="41423a3e">                <p id="fc9ff676">按照向导。</p>                <p id="f9202a09">新版本的容器完成启动过程后，将配置向导并在主Upsource端口上侦听以某些非根上下文结尾的URL：</p>                <code class="code">http://<host>:<port>/contextPath</code>                <p id="b8d8327e">向导URL打印在控制台输出中，并记录在日志中：</p>                <code class="code">"JetBrains Upsource Configuration Wizard will be available on [http://<host>:<port>/contextPath] after start"</code>                <p id="baf5de8a">在控制台中查找它，访问向导，然后按照其步骤完成升级过程。</p>                <p id="0c15a346">同时，Upsource服务URL将向Upsource最终用户显示一个带有“ Upgrade in progress”通知的页面。</p>            </li><li class="list__item" id="bf4ed7a5">                <p id="b1761321">现在，您可以使用以下命令删除旧容器：</p>                <code class="code">docker rm <containerId></code>                <p id="98ba3336">要查看所有停止的容器，请运行：</p>                <code class="code">docker ps -a</code>            </li></ol></section>        <aside class="note " rel="b0a461e4" id="534106ba" data-title="">            <p id="653ddc29">如果更改了旧的Upsource映像，则需要在开始新版本之前将更改复制到新的Upsource映像。</p>        </aside>    </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年8月9日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="upgrade-from-zip-to-docker.html">从ZIP升级到Docker</a> <a class="navigation-links__next" href="upgrade-with-a-zip-distribution.html">通过ZIP发行版升级</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>