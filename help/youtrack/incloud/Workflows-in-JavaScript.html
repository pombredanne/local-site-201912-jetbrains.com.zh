<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>JavaScript工作流程参考-帮助|帮助YouTrack InCloud</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Workflows-in-JavaScript" data-breadcrumbs="Administration.xml|Administration/Workflow-Guide.xml|Workflows/Workflows-in-JavaScript.xml|JavaScript Workflow Reference/rule-specific-properties.xml|Rule-specific Properties/context.xml|Context/requirements.xml|Requirements/using-workflow-api.xml|Using the Workflow API/Slack-Integration-HTML.xml|Building Integrations with Slack/JS-Workflow-REST-API.xml|Using REST API Methods in JavaScript Workflows/Workflow-Working-with-Dates-Times.xml|Working with Dates and Times/Workflow-Localization.xml|Localizing Workflow Messages/troubleshooting-workflows.xml|Troubleshooting Workflows/YouTrack-Api-Documentation.xml|YouTrack Workflow API/Workflow-Change-Log.xml|Change Log/v1-date-time.xml|date-time/v1-entities.xml|entities/v1-Agile.xml|Agile/v1-BaseComment.xml|BaseComment/v1-BaseEntity.xml|BaseEntity/v1-BaseWorkItem.xml|BaseWorkItem/v1-Build.xml|Build/v1-BundleProjectCustomField.xml|BundleProjectCustomField/v1-ChangesProcessor.xml|ChangesProcessor/v1-EnumField.xml|EnumField/v1-Field.xml|Field/v1-Fields.xml|Fields/v1-GroupProjectCustomField.xml|GroupProjectCustomField/v1-Issue.xml|Issue/v1-IssueAttachment.xml|IssueAttachment/v1-IssueComment.xml|IssueComment/v1-IssueLinkPrototype.xml|IssueLinkPrototype/v1-IssueTag.xml|IssueTag/v1-IssueWorkItem.xml|IssueWorkItem/v1-Iterator.xml|Iterator/v1-JsonForIssueAddAttachment.xml|JsonForIssueAddAttachment/v1-JsonForIssueAddComment.xml|JsonForIssueAddComment/v1-JsonForIssueAddWorkItem.xml|JsonForIssueAddWorkItem/v1-JsonForIssueConstructor.xml|JsonForIssueConstructor/v1-JsonForUserNotify.xml|JsonForUserNotify/v1-OwnedField.xml|OwnedField/v1-PeriodProjectCustomField.xml|PeriodProjectCustomField/v1-PersistentFile.xml|PersistentFile/v1-Project.xml|Project/v1-ProjectCustomField.xml|ProjectCustomField/v1-ProjectVersion.xml|ProjectVersion/v1-Requirement.xml|Requirement/v1-Requirements.xml|Requirements/v1-SavedQuery.xml|SavedQuery/v1-Set.xml|Set/v1-SimpleProjectCustomField.xml|SimpleProjectCustomField/v1-Sprint.xml|Sprint/v1-State.xml|State/v1-TeamcityBuildConfMapping.xml|TeamcityBuildConfMapping/v1-TeamcityServer.xml|TeamcityServer/v1-TextProjectCustomField.xml|TextProjectCustomField/v1-User.xml|User/v1-UserGroup.xml|UserGroup/v1-UserProjectCustomField.xml|UserProjectCustomField/v1-VcsChange.xml|VcsChange/v1-VcsServer.xml|VcsServer/v1-WatchFolder.xml|WatchFolder/v1-WorkItemType.xml|WorkItemType/v1-http.xml|http/v1-Connection.xml|Connection/v1-REQUEST_TYPES.xml|REQUEST_TYPES/v1-Response.xml|Response/v1-notifications.xml|notifications/v1-search.xml|search/v1-strings.xml|strings/v1-workflow.xml|workflow" data-main-title="JavaScript Workflow Reference"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索YouTrack InCloud帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack InCloud 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Workflows-in-JavaScript.xml" data-toc="Workflows-in-JavaScript">JavaScript工作流程参考</h1>    <p id="226a203d">从YouTrack 2017.2开始，您不必使用特定于域的编程语言编写工作流。只需使用JavaScript！</p>    <p id="f3386c81">JavaScript可以说是当今世界上最流行的编程语言。如果您自己不熟悉它，那么您的组织中很有可能会流利。通过切换到JavaScript，我们希望比以往任何时候都可以更轻松地访问YouTrack的编写工作流。</p>    <p id="f822d639">也就是说，要创建自己的工作流程，您确实需要编写一些代码。这需要对JavaScript有基本的了解。幸运的是，Web上有很多资源，其中最好的资源之一是<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" rel="noopener noreferrer" data-external="true" target="_blank">Mozilla基金会</a> ，后者继续监督该语言的开发。</p>    <p id="d0addaca">这也意味着在用JavaScript编写工作流时，您不需要做任何异常的事情。编写工作流程时，可以使用JavaScript支持的任何声明，变量，常量，数据类型，文字，函数，表达式和运算符。</p>    <p id="5fbd60f6">本文档的这一部分提供了一些指南，可以帮助您了解如何使用工作流API特有的自定义属性和方法。有关功能，属性和方法的完整列表，请参阅<a href="YouTrack-Api-Documentation.html">YouTrack Workflow API</a> 。</p>    <div class="chapter"><h2 id="2018-updates" data-toc="Workflows-in-JavaScript#2018-updates">YouTrack 2018.1的更新</h2>        <p id="c422369e">我们的JavaScript实现基于<a href="https://github.com/mozilla/rhino" rel="noopener noreferrer" data-external="true" target="_blank">Rhino</a> 。对于2018.1版本，我们采用了Rhino版本1.7.7.2。这意味着此版本的Rhino支持的ES6 / JS2015的所有功能也可用于YouTrack中的工作流。</p>        <p id="df614ff9">主要变化包括：</p>        <ul class="list _ul"><li class="list__item" id="d60c0b08"><p>支持许多ES6补充<code class="code">Math</code>类。</p></li><li class="list__item" id="81007021"><p>支持许多ES6补充<code class="code">Number</code>类。</p></li><li class="list__item" id="a2911c3f"><p>支持将ES6添加到<code class="code">String</code>类。</p></li><li class="list__item" id="0526ee2d"><p>初步支持ES6方法定义。</p></li><li class="list__item" id="1455fa78"><p>本地转换<code class="code">Error</code>实例转换为JSON。</p></li><li class="list__item" id="c1338e24"><p>的兼容性修复<code class="code">Date</code> ， <code class="code">Array</code>和<code class="code">String</code>等等。</p></li><li class="list__item" id="31ca6cbb"><p>方法支持<code class="code">Array.find()</code>和<code class="code">findIndex()</code> 。</p></li><li class="list__item" id="f975a51d"><p>方法支持<code class="code">String.trimLeft()</code>和<code class="code">trimRight()</code> 。</p></li><li class="list__item" id="08d58075"><p>支持V8 <code class="code">Error</code>扩展，包括<code class="code">Error.captureStackTrace</code> 。</p></li><li class="list__item" id="3619fe32"><p>支持类型化数组。</p></li><li class="list__item" id="4c5282d0"><p>支持附加“外部数据”作为任何对象的索引属性。</p></li></ul>        <p id="48b86d5e">若要查看ES5、6和7中的哪些高级JavaScript功能可用于YouTrack中的工作流程，请参阅<a href="http://mozilla.github.io/rhino/compat/engines.html" rel="noopener noreferrer" data-external="true" target="_blank">Rhino兼容性表</a> 。支持与<span class="control">rhino177</span>兼容的所有功能。</p>    </div>    <div class="chapter"><h2 id="major-changes-from-old-api" data-toc="Workflows-in-JavaScript#major-changes-from-old-api">与以前的工作流程编程语言相比的主要变化</h2>        <p id="5bf94df6">切换到JavaScript会更改编写工作流时引用特定实体和属性的方式。以下是与以前的API相比的主要更改的简短列表：</p>        <ol class="list _decimal"><li class="list__item" id="247f24fa"><p>的<code class="code">issue</code>参考永远不会被省略。您不能假设问题引用方法是从上下文中引用问题的，而是必须显式引用问题。</p></li><li class="list__item" id="a37deddc">与属性相关的方法的拼写有所不同。而且，这些功能现在是属性。获取方法得到简化。<div class="table-wrapper"><table width="100%" id="254c8509"><thead><tr id="ea2842ea" class="ijRowHead"><th id="7c0e6fb1" width="50%"><p>基于MPS的API</p></th><th id="734505f2"><p>JavaScript API</p></th></tr></thead><tbody><tr id="e9c62289" class="ijRowOdd"><td id="eb7b467c">                            <code class="code">issue.becomesResolved(), issue.becomesReported()</code>                        </td><td id="4712b316">                            <code class="code">issue.becomesResolved, issue.becomesReported</code>                        </td></tr><tr id="62fd8648" class="ijRowEven"><td id="61b99232">                            <code class="code">issue.getId(), issue.getUrl()</code>                        </td><td id="78b574fe">                            <code class="code">issue.id, issue.url</code>                        </td></tr></tbody></table></div>            </li><li class="list__item" id="a07886c2">与字段相关的关键字现在是方法。<div class="table-wrapper"><table width="100%" id="bdb19423"><thead><tr id="ec8d77da" class="ijRowHead"><th id="f30cdb25" width="50%"><p>基于MPS的API</p></th><th id="9e12955a"><p>JavaScript API</p></th></tr></thead><tbody><tr id="ec099c6b" class="ijRowOdd"><td id="47fdc40f">                            <code class="code">X.required</code>                        </td><td id="fdc65c28">                            <code class="code">issue.fields.required(ctx.X, <message>)</code>                        </td></tr><tr id="6cf52a92" class="ijRowEven"><td id="422eb2c5">                            <code class="code">X.changed</code>                        </td><td id="02e64157">                            <code class="code">issue.fields.isChanged(ctx.X)</code>                        </td></tr><tr id="b4db5804" class="ijRowOdd"><td id="5e61636c">                            <code class="code">X.becomes</code>                        </td><td id="6e1729c8">                            <code class="code">issue.fields.becomes(ctx.X, <ctx.X.value>)</code>                        </td></tr><tr id="132e7827" class="ijRowEven"><td id="6e903e33">                            <code class="code">X.oldValue</code>                        </td><td id="6e97b14d">                            <code class="code">issue.fields.oldValue(ctx.X)</code>                        </td></tr></tbody></table></div>            </li><li class="list__item" id="f00b841a">全局关键字和警告声明已更改。<div class="table-wrapper"><table width="100%" id="d79cc0e3"><thead><tr id="ae10cf55" class="ijRowHead"><th id="58371e16" width="50%"><p>基于MPS的API</p></th><th id="cae847db"><p>JavaScript API</p></th></tr></thead><tbody><tr id="ec6b709e" class="ijRowOdd"><td id="f8ed4b69">                            <code class="code">message</code>                        </td><td id="dda51162"><p>                            <code class="code">workflow.message(<message>)</code> （请参阅“ @ jetbrains / youtrack-scripting-api / workflow”模块）</p></td></tr><tr id="2e538444" class="ijRowEven"><td id="400c5364">                            <code class="code">assert</code>                        </td><td id="70cbeee8"><p>                            <code class="code">workflow.check(<condition>, <message>)</code> （请参阅“ @ jetbrains / youtrack-scripting-api / workflow”模块）</p></td></tr><tr id="5074dd97" class="ijRowOdd"><td id="90d079a0">                            <code class="code">loggedInUser</code>                        </td><td id="d82414e7">                            <code class="code">ctx.currentUser</code>                        </td></tr><tr id="8b57bb68" class="ijRowEven"><td id="4059303d">                            <code class="code">now</code>                        </td><td id="178e3848"><p>                            <code class="code">Date.now()</code> （标准JS日期API）</p></td></tr></tbody></table></div>            </li><li class="list__item" id="08450ef6">某些方法已完全更改：<div class="table-wrapper"><table width="100%" id="e74d56e9"><thead><tr id="1b9f6242" class="ijRowHead"><th id="183a3e2c" width="50%"><p>基于MPS的API</p></th><th id="80caf979"><p>JavaScript API</p></th></tr></thead><tbody><tr id="9556b480" class="ijRowOdd"><td id="e3be086d">                            <code class="code">loggedInUser.createNewIssue(<project name>)</code>                        </td><td id="0aa8e2ff">                            <code class="code">new entities.Issue(<user>, <project>, <summary>)</code>                        </td></tr></tbody></table></div>            </li></ol>    </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Custom-Workflow-Repository.html">自定义工作流存储库</a> <a class="navigation-links__next" href="rule-specific-properties.html">规则特定的属性</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>