<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Enhance Helpdesk Support - Help | YouTrack InCloud</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="enhance-helpdesk-support-workflows" data-breadcrumbs="Administration.xml|Administration/Workflow-Guide.xml|Workflows/Workflow-Use-Cases.xml|Use Cases for Workflows/enhance-helpdesk-support-workflows.xml|Enhance Helpdesk Support" data-main-title="Enhance Helpdesk Support"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search YouTrack InCloud Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack InCloud 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="enhance-helpdesk-support-workflows" id="enhance-helpdesk-support-workflows.xml">Enhance Helpdesk Support</h1>    <p id="0ca48995">YouTrack provides three main features that let you use it as a helpdesk:</p>    <ul class="list _ul"><li class="list__item" id="daf189a1"><p>The <a href="Mailbox-Integration.html">Mailbox Integration</a>, which pulls email messages from one or more email servers on a regular basis and processes them to create issues and comments.</p></li><li class="list__item" id="4a0cf186"><p>Email Notifications, which let you send messages to any email address.</p></li><li class="list__item" id="6a5f7b2d"><p>And, of course, Workflows, which help you glue it all together!</p></li></ul>  <p id="f5d169cc">The basic flow that is supported in YouTrack works as follows:</p>  <ul class="list _ul"><li class="list__item" id="abb09561"><p>A customer sends an email message to your support inbox. This creates a new issue in YouTrack.</p></li><li class="list__item" id="ffc45b3d"><p>A support engineer responds to the inquiry by adding a comment to the issue. This generates an email notification that is sent back to the customer as a reply to the original email.</p></li><li class="list__item" id="c0b7cd7e"><p>The custom replies to the email notification. The response is processed by YouTrack and added as a comment to the original issue.</p></li></ul>  <p id="8583547e">You can find a detailed description of this feature in our <a href="Use-YouTrack-as-a-Help-Desk.html">Helpdesk Tutorial</a>.</p>  <div class="chapter"><h2 id="support-service-level-agreements" data-toc="enhance-helpdesk-support-workflows#support-service-level-agreements">Support Service-level Agreements</h2>    <p id="3eff06be">An important element for an established product support team is the service-level agreement (SLA).      This helps set the customers’ expectations for receiving an answer to their requests and comments.</p>    <p id="055ecfd3">Consider an SLA with the following rules:</p>    <ul class="list _ul"><li class="list__item" id="437cfc49"><p>Business hours are from 10:00 – 18:00 CET.</p></li><li class="list__item" id="00b8a97e"><p>Customers can expect a response to their initial support request within three hours.</p></li><li class="list__item" id="585c956c"><p>The response time for a follow-up request is four hours.</p></li></ul>    <p id="42549ee3">You can support an SLA in YouTrack with a workflow. In YouTrack, we’ll customize the setup for our helpdesk project as follows:</p>    <ul class="list _ul"><li class="list__item" id="0d9d5e83"><p id="3c32fceb">The project that we use for the helpdesk uses the following values for the State field:</p>      <div class="table-wrapper"><table width="100%" id="7831fe81"><thead><tr id="c546d95e" class="ijRowHead"><th id="e47ccbb9" width="20%"><p>Value</p></th><th id="d92d219b"><p>Description</p></th></tr></thead><tbody><tr id="fd2f1d86" class="ijRowOdd"><td id="d84b5334"><p>New</p></td><td id="41141991"><p>Default value. Assigned to tickets upon creation.</p></td></tr><tr id="bab42224" class="ijRowEven"><td id="fbd8d698"><p>Open</p></td><td id="a17e6b3b"><p>Assigned to tickets that are waiting for a reaction from the support team.</p></td></tr><tr id="c05ee6ad" class="ijRowOdd"><td id="bf5d05e7"><p>Pending</p></td><td id="84ebda38"><p>Assigned to tickets that are waiting for a reaction from the customer.</p></td></tr><tr id="b92e68d6" class="ijRowEven"><td id="677aeea6"><p>On hold</p></td><td id="93ee57bb"><p>Used for tickets that require input from a developer.</p></td></tr><tr id="74c21218" class="ijRowOdd"><td id="6956b634"><p>Fixed</p></td><td id="2a9aae64"><p>Assigned to resolved tickets.</p></td></tr></tbody></table></div></li><li class="list__item" id="40999b84"><p>For <span class="control">New</span> tickets that have not been answered by the support team, the <span class="control">Overdue</span> tag is added three business hours after the issue was created.</p></li><li class="list__item" id="8689cbf9"><p>For <span class="control">Open</span> tickets, the <span class="control">Overdue</span> tag is added four business hours after the last comment from a customer was added.</p></li><li class="list__item" id="89b1ca33"><p>To sort tickets in the order that they should be answered, we add a private custom field: <span class="control">To reply before</span>. This field stores values as a date and time.</p></li></ul>    <p id="3453364c">When we set up these fields and attach the corresponding workflow rules, the support team can pull tickets from a queue that is ordered by response time using the following query:</p>    <div class="code-block" data-lang="none"><code class="code-block__wrapper">State: Open, New sort by: {To reply before} asc</code></div>    <p id="a8b09f52">First, we need a utility function that defines our business hours. This is saved as a custom script with the name <code class="code">time-operations</code>.</p>    <div class="code-block" data-lang="javascript">// Starting hour of the business day defined in the server time zone.
var START = 10;

// Finishing hour of the business day defined in the server time zone.
var FINISH = 18;

// Length of the business day in hours.
var BUSINESS_DAY_LENGTH = FINISH - START;

var HOUR_IN_MS = 60 * 60 * 1000;
var DAY_IN_MS = 24 * HOUR_IN_MS;

/*
  * @param {Date} [date] date to check to be inside business hours interval
  * @return {boolean} `true` is the date is within [START, FINISH) interval on
  * business days and `false` otherwise
*/
var isWithinBusinessHours = function(date) {
  var date1 = new Date(date);
  var dayOfWeek = date1.getDay();
  if (dayOfWeek === 0 || dayOfWeek === 1) {
    return false;
  }
  var hour = date1.getHours();
  return (hour &gt;= START &amp;&amp; hour &lt; FINISH);
};

/*
  * @param {Number} [date] date in ms from the start of the epoch
  * @param {Number} [hours] number of hours to add to this date
  * @returns {Number} resulting date with respect to business hours, defined above
*/
var addBusinessHours = function(date, hours) {
  var result = date + hours * HOUR_IN_MS;
  if (!isWithinBusinessHours(new Date(result))) {
    // It's evening, let's skip the night.
    result += (24 - BUSINESS_DAY_LENGTH) * HOUR_IN_MS;
  }
  if (!isWithinBusinessHours(new Date(result))) {
    // It's the weekend, let's skip it too.
    result += 2 * DAY_IN_MS;
  }
  return result;
};

exports.addBusinessHours = addBusinessHours;</div>    <p id="972a677d">Now, we can set the value of the <span class="control">To reply before</span> field according to our SLA.      The first rule is for the initial response:</p>    <div class="code-block" data-lang="javascript">var entities = require('@jetbrains/youtrack-scripting-api/entities');
var timeOp = require('./time-operations');

// Number of business hours to reply to the new issue.
var NEW_ISSUE_SLA = 3;

exports.rule = entities.Issue.onChange({
  title: 'New Issue SLA',
  guard: function(ctx) {
    return ctx.issue.becomesReported;
  },
  action: function(ctx) {
    ctx.issue.fields.ToReply = timeOp.addBusinessHours(Date.now(), NEW_ISSUE_SLA);
  },
  requirements: {
    ToReply: {
      type: entities.Field.dateTimeType,
      name: 'To reply before'
    }
  }
});</div>    <p id="9c206396">The second rule is for the follow-up:</p>    <div class="code-block" data-lang="javascript">var entities = require('@jetbrains/youtrack-scripting-api/entities');
var timeOp = require('./time-operations');

// Number of business hours to reply to the replied issue.
var REPLIED_ISSUE_SLA = 4;

exports.rule = entities.Issue.onChange({
  title: 'Replied Issue SLA',
  guard: function(ctx) {
    var comments = ctx.issue.comments;
    return comments.added.isNotEmpty() &amp;&amp;
      comments.added.last().author.login === ctx.helpdeskBot.login;
  },
  action: function(ctx) {
    ctx.issue.fields.ToReply = timeOp.addBusinessHours(Date.now(), REPLIED_ISSUE_SLA);
  },
  requirements: {
    ToReply: {
      type: entities.Field.dateTimeType,
      name: 'To reply before'
    },
    // This is the user which is set as reporter in mail rule settings:
    helpdeskBot: {
      type: entities.User,
      login: 'helpdesk-bot'
    }
  }
});</div>    <p id="c360d245">The following rule adds the <span class="control">Overdue</span> tag to tickets when the SLA is violated:</p>    <div class="code-block" data-lang="javascript">var entities = require('@jetbrains/youtrack-scripting-api/entities');

exports.rule = entities.Issue.onSchedule({
  title: 'Set “Overdue” tag',
  cron: '0 * * * * ?',
  search: 'State: Open, New has: {To reply before} tag: -overdue',
  action: function(ctx) {
    var toReply = ctx.issue.fields.ToReply;
    if (toReply &lt; Date.now()) {
      ctx.issue.addTag(ctx.overdue.name);
    }
  },
  requirements: {
    ToReply: {
      type: entities.Field.dateTimeType,
      name: 'To reply before'
    },
    overdue: {
      type: entities.IssueTag
    }
  }
});</div>    <p id="590fd88c">And finally, we clear the value from the <span class="control">To reply before</span> field and remove the <span class="control">Overdue</span> tag when the ticket no longer requires a response from the support team:</p>    <div class="code-block" data-lang="javascript">var entities = require('@jetbrains/youtrack-scripting-api/entities');

exports.rule = entities.Issue.onChange({
  title: 'Clear "To reply before" field and remove “Overdue” tag when issue is not “New” or “Open”',
  guard: function(ctx) {
    var fs = ctx.issue.fields;
    return fs.isChanged(ctx.State) &amp;&amp; fs.State &amp;&amp;
      fs.State.name !== ctx.State.New.name &amp;&amp;
      fs.State.name !== ctx.State.Open.name;
  },
  action: function(ctx) {
    var issue = ctx.issue;
    issue.fields.ToReply = null;
    if (issue.hasTag(ctx.overdue.name)) {
      issue.removeTag(ctx.overdue.name);
    }
  },
  requirements: {
    State: {
      type: entities.State.fieldType,
      Open: {},
      New: {}
    },
    ToReply: {
      type: entities.Field.dateTimeType,
      name: 'To reply before'
    },
    overdue: {
      type: entities.IssueTag
    }
  }
});</div>    <p id="ac1a40d3">You can apply additional logic to these rules depending on the terms of your support SLA, for example:</p>    <ul class="list _ul"><li class="list__item" id="55701f78"><p>You can assign priorities to each ticket and change the SLA response times based on the priority.</p></li><li class="list__item" id="6f3ea153"><p>You can set up a state machine to restrict the legal transitions between values for the <span class="control">State</span> field.</p></li><li class="list__item" id="c08813b9"><p>If you have an international team that works in different time zones and business hours, you can tune the <code class="code">time-operations</code> script to take these into account for each member of the support team.</p></li></ul>  </div>  <div class="chapter"><h2 id="assign-tickets-round-robin-rotations" data-toc="enhance-helpdesk-support-workflows#assign-tickets-round-robin-rotations">Assign Tickets with a Round-robin Rotation</h2>    <p id="69417586">Another popular helpdesk practice is to assign new tickets based on a round-robin scheme.      This balances the workload between members of the support team.      The idea is simple — whenever a new ticket appears, it is assigned to the team member who is assigned the fewest <span class="control">New</span> and <span class="control">Open</span> tickets.</p>    <p id="13ae1f62">The implementation is straight-forward.      When a new ticket is created, the workflow rule checks the workload of each support engineer.      The member of the team with the fewest tickets is selected as the assignee.</p>    <div class="code-block" data-lang="javascript">var entities = require('@jetbrains/youtrack-scripting-api/entities');
var search = require('@jetbrains/youtrack-scripting-api/search');

exports.rule = entities.Issue.onChange({
  title: 'Set Assignee automatically via Round Robin scheme',
  guard: function(ctx) {
    var issue = ctx.issue;
    return issue.becomesReported &amp;&amp; !issue.fields.Assignee;
  },
  action: function(ctx) {
    var assignees = ctx.Assignee.values;
    var numbers = {};
    assignees.forEach(function(assignee) {
      numbers[assignee.login] = 0;
    });

    var issues = search.search(ctx.issue.project, '#unresolved has: Assignee');
    issues.forEach(function(issue) {
      numbers[issue.fields.Assignee.login] += 1;
    });

    var min = Number.MAX_VALUE;
    var user = null;
    assignees.forEach(function(assignee) {
      if (numbers[assignee.login] &lt; min) {
        min = numbers[assignee.login];
        user = assignee;
      }
    });

    ctx.issue.fields.Assignee = user;
  },
  requirements: {
    Assignee: {
      type: entities.User.fieldType
    }
  }
});</div>    <p id="67498ebb">You can use this scheme not just for the helpdesk, but also for any process where you want to balance the workload.      Also, the rules for balancing new assignments can be much more complex.      For example, you can assign higher weights to overdue tickets.</p>  </div><div class="last-modified" data-skip-index="skip">Last modified: 29 November 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="generate-time-reports-workflow.html">Generate Time Reports</a><a class="navigation-links__next" href="send-internal-newsletters-workflow.html">Send Internal Newsletters</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>