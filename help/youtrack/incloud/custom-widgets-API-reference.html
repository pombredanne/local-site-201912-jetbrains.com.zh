<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');</script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>自定义小部件API参考-帮助| YouTrack InCloud</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="custom-widgets-API-reference" data-breadcrumbs="Resources-for-Developers.xml|Resources for Developers/building-custom-widgets.xml|Widget Development Guide/custom-widgets-API-reference.xml|Custom Widgets API Reference" data-main-title="Custom Widgets API Reference"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索YouTrack InCloud帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack InCloud 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="custom-widgets-API-reference.xml" data-toc="custom-widgets-API-reference">自定义小部件API参考</h1>    <p id="aa2f5001">我们为JavaScript提供了一个自定义库，其中包括用于处理自定义小部件的API。要安装此库，请使用以下实现之一：</p>    <ul class="list _ul"><li class="list__item" id="b75e14ad"><p>在您的标题中的<a href="https://unpkg.com/hub-dashboard-addons@latest" rel="noopener noreferrer" data-external="true" target="_blank">unpkg上</a>添加对<a href="https://unpkg.com/hub-dashboard-addons@latest" rel="noopener noreferrer" data-external="true" target="_blank">仪表板脚本</a>的引用<code class="code">index.html</code>文件。将参考包装在<code class="code"><script></code>标签。例如：</p><div class="code-block" data-lang="markup">
                <script src="https://unpkg.com/hub-dashboard-addons@latest"></script>
            </div>        <p></p></li><li class="list__item" id="47ecb86d"><p>使用npm软件包管理器将脚本与<code class="code">npm install hub-dashboard-addons</code>命令。然后，您可以根据需要在小部件中添加对脚本的引用。</p></li></ul>    <p id="b6fe1a3d">的<code class="code">Dashboard.registerWidget</code>函数接受用调用的回调<code class="code">dashboardAPI</code>和<code class="code">registerWidgetAPI</code>参数如下面的代码示例所示。要在上下文中查看此示例，请参考<a href="custom-widget-tutorial.html#create-the-script">创建脚本</a> 。</p>    <div class="code-block" data-lang="javascript">//注册小部件：Dashboard.registerWidget（function（dashboardAPI，registerWidgetAPI）{//加载GitHub配置文件数据loadAndRenderUser（USER_NAME）//设置小部件标题.then（user => dashboardAPI.setTitle（`GitHub User $ {user.login }`））; //添加刷新按钮。registerWidgetAPI（{onRefresh：（）=> loadAndRenderUser（USER_NAME）}）; }）;</div>    <p id="b5a5958b">使用以下参考来为仪表板构建自定义窗口小部件。</p>    <div class="chapter"><h2 id="dashboard-API" data-toc="custom-widgets-API-reference#dashboard-API">仪表板API</h2>        <p id="16f2192f">使用仪表板API与小部件包装程序和仪表板进行通信。所有这些方法都是异步的并返回<code class="code">Promise</code>对象。这些方法适用于<code class="code">dashboardApi</code>宾语。</p>        <div class="table-wrapper"><table class="  _layout-fixed" width="100%" id="setTitle"><thead><tr id="d16f7233" class="ijRowHead"><th id="162603b8" colspan="3"><p>setTitle（label：字符串，？labelUrl：字符串）：无效</p></th></tr></thead><tbody><tr id="024b0d39" class="ijRowOdd"><td id="8569af9b" width="20%"><p>描述</p></td><td id="39919f89" colspan="2"><p>设置显示在小部件标题中的文本。如果为<code class="code">labelUrl</code>参数，将文本设置为到目标URL的链接。</p></td></tr><tr id="56ed2f83" class="ijRowEven"><td id="8ba9a4d5" width="20%" rowspan="2"><p>参量</p></td><td id="6aa8af0d" width="20%"><code class="code">label</code></td><td id="5209a4f0"><p>显示为小部件标题的文本字符串。</p></td></tr><tr id="4a8f1ba3" class="ijRowOdd"><td id="88cf0f2f"><code class="code">labelURL</code></td><td id="6f02c54e"><p>用户单击窗口小部件标题时打开的目标页面的地址。如果未指定此可选参数，则将小部件标题设置为仅文本。</p></td></tr><tr id="874460f4" class="ijRowEven"><td id="c6302fe5"><p>例</p></td><td id="9942293f" colspan="2"><div class="code-block" data-lang="none">consoleApi.setTitle（'Some widget'）; consoleApi.setTitle（'A链接标头'，'https://example.com'）;</div> </td></tr></tbody></table></div>        <div class="table-wrapper"><table width="100%" id="setLoadingAnimationEnabled"><thead><tr id="58d9b705" class="ijRowHead"><th id="801dd58f" colspan="3"><p>setLoadingAnimationEnabled（enabled：boolean）：void</p></th></tr></thead><tbody><tr id="f3949c8b" class="ijRowOdd"><td id="b4261c5b" width="20%"><p>描述</p></td><td id="bcd3face" colspan="2"><p>切换小部件重新加载图标的图像旋转动画。当窗口小部件从远程服务器填充数据以指示进程正在后台运行时，请调用此方法。</p></td></tr><tr id="76583264" class="ijRowEven"><td id="c410d570"><p>参量</p></td><td id="26b6b785" width="10%"><code class="code">enabled</code></td><td id="70a316ba"><p>确定小部件重新加载图标是否旋转。</p></td></tr></tbody></table></div>        <div class="table-wrapper"><table class="  _layout-fixed" width="100%" id="alert"><thead><tr id="b75672a0" class="ijRowHead"><th id="a062c3c2" colspan="3"><p>警报（消息：字符串，？类型：字符串，？超时：数字）：字符串</p></th></tr></thead><tbody><tr id="29183be0" class="ijRowOdd"><td id="d83df6a3" width="20%"><p>描述</p></td><td id="86d7e47e" colspan="2"><p>在页面顶部显示系统警报。</p></td></tr><tr id="559c07fa" class="ijRowEven"><td id="9bbd95dd" rowspan="3"><p>参量</p></td><td id="cf8fd152" width="20%"><code class="code">message</code></td><td id="ca7108c2"><p>设置显示为系统警报的文本。</p></td></tr><tr id="b4c1d660" class="ijRowOdd"><td id="c8c32135"><code class="code">type</code></td><td id="dc99c3a0"><p>确定将哪种通知样式应用于警报。可能的值包括<code class="code">error</code> ， <code class="code">message</code> ， <code class="code">success</code>和<code class="code">warning</code> 。</p></td></tr><tr id="1fd5079a" class="ijRowEven"><td id="ca78b3cb"><code class="code">timeout</code></td><td id="ad9b0202"><p>警报显示在页面上的时间，以秒为单位。</p></td></tr><tr id="4a654f99" class="ijRowOdd"><td id="7639bcaf"><p>例</p></td><td id="dc3ff9da" colspan="2"><div class="code-block" data-lang="none">dashboardApi.alert（'这是标准通知'，'消息'）; dashboardApi.alert（'这是一个错误'，'错误'，10000）;</div> </td></tr></tbody></table></div>        <div class="table-wrapper"><table width="100%" id="enterConfigMode"><thead><tr id="d27d99e4" class="ijRowHead"><th id="7c8fa46b" colspan="2"><p>enterConfigMode（）：无效</p></th></tr></thead><tbody><tr id="af88ec51" class="ijRowOdd"><td id="5ba50129" width="20%"><p>描述</p></td><td id="1ec83a79"><p>调用配置模式。在配置模式下，窗口小部件的外观会发生变化，以指示可以更新其设置。<span class="control">刷新</span>图标也被隐藏。</p></td></tr></tbody></table></div>        <div class="table-wrapper"><table width="100%" id="exitConfigMode"><thead><tr id="e084e23a" class="ijRowHead"><th id="960bf25b" colspan="2"><p>exitConfigMode（）：无效</p></th></tr></thead><tbody><tr id="35a8dad9" class="ijRowOdd"><td id="136c28bc" width="20%"><p>描述</p></td><td id="9724aa06"><p>退出配置模式。</p></td></tr></tbody></table></div>        <div class="table-wrapper"><table width="100%" id="storeCache"><thead><tr id="c6a7f577" class="ijRowHead"><th id="0eccdbdd" colspan="3"><p>storeCache（cache：Object）：承诺<void></void></p></th></tr></thead><tbody><tr id="cc8461f2" class="ijRowOdd"><td id="e37b0801" width="20%"><p>描述</p></td><td id="f7949676" colspan="2"><p>将任何对象存储在客户端缓存中。使用此方法可将填充的数据本地存储并立即在仪表板上显示，然后从服务器刷新它。返回配置对象。</p></td></tr><tr id="466c2302" class="ijRowEven"><td id="ba72ef46"><p>参量</p></td><td id="ee065acb" width="20%"><code class="code">cache</code></td><td id="5e43a948"><p>指定要存储在缓存中的对象。</p></td></tr></tbody></table></div>        <div class="table-wrapper"><table width="100%" id="readCache"><thead><tr id="86d4bd72" class="ijRowHead"><th id="4838cfd5" colspan="2"><p>readCache（）：承诺<object></object></p></th></tr></thead><tbody><tr id="58b4b454" class="ijRowOdd"><td id="665eccc9" width="20%"><p>描述</p></td><td id="d671e156"><p>读取并返回以前存储在缓存中的对象。</p></td></tr></tbody></table></div>        <div class="table-wrapper"><table width="100%" id="storeConfig"><thead><tr id="d33b234d" class="ijRowHead"><th id="29cb9dc4" colspan="3"><p>storeConfig（config：Object）：承诺<void></void></p></th></tr></thead><tbody><tr id="e66ab5ec" class="ijRowOdd"><td id="1993f4d5" width="20%"><p>描述</p></td><td id="94e11c41" colspan="2"><p>将任何对象存储为小部件配置。如果配置模式处于活动状态，则退出配置模式。</p></td></tr><tr id="afc07d53" class="ijRowEven"><td id="dc70fbd7"><p>参量</p></td><td id="020884b7" width="20%"><code class="code">config</code></td><td id="c1df0977"><p>指定要存储为小部件配置的对象。</p></td></tr></tbody></table></div>        <div class="table-wrapper"><table width="100%" id="readConfig"><thead><tr id="b7068e52" class="ijRowHead"><th id="f380cfff" colspan="2"><p>readConfig（）：承诺<object></object></p></th></tr></thead><tbody><tr id="94f6836d" class="ijRowOdd"><td id="a6b185f5" width="20%"><p>描述</p></td><td id="990fab71"><p>读取并返回以前存储为配置对象的对象。</p></td></tr></tbody></table></div>        <div class="table-wrapper"><table class="  _layout-fixed" width="100%" id="fetch"><thead><tr id="fbfd6893" class="ijRowHead"><th id="0dd0c251" colspan="3"><p>fetch（serviceID：字符串，url：字符串，fetchConfig：对象）：承诺<object></object></p></th></tr></thead><tbody><tr id="dc1dea74" class="ijRowOdd"><td id="2b5f0343" width="20%"><p>描述</p></td><td id="fc1fadfd" colspan="2"><p>向指定的服务提出授权请求。该服务必须在小部件清单中指定。</p></td></tr><tr id="0e87b343" class="ijRowEven"><td id="6f7c221f" rowspan="3"><p>参量</p></td><td id="5896f936" width="20%"><code class="code">serviceID</code></td><td id="bbfa1fb5"><p>指定服务的ID。要获取服务ID， <a href="#fetchHub">请</a>首先使用<a href="#fetchHub">fetchHub</a> 。有关详细信息，请参阅<a href="/help/hub/Hub-Rest-Api-URL.html" rel="noopener noreferrer" data-external="true" target="_blank">Hub REST API</a> 。</p></td></tr><tr id="a6748d2a" class="ijRowOdd"><td id="4d04d9e3"><code class="code">url</code></td><td id="32fc27a7"><p>将URL设置为服务API端点。这是您要获取的资源的路径。该URL是相对于服务器主URL的。</p></td></tr><tr id="af82b2d0" class="ijRowEven"><td id="02220a30"><code class="code">fetchConfig</code></td><td id="3e0a4b4e"><p>定义一个可选的options对象。该对象包含要应用于请求的任何自定义设置。</p></td></tr><tr id="c8f06fae" class="ijRowOdd"><td id="81fa83fe"><p>例</p></td><td id="cb217050" colspan="2"><p></p><div class="code-block" data-lang="none">consoleApi.fetch（serviceId，'api / users'）.then（users => console.log（users））;</div>以下示例显示了如何在POST请求中使用此方法：<div class="code-block" data-lang="none">panelApi.fetch（serviceId，'api / users'，{方法：'POST'，正文：{payload：'test'}}}）.then（result => console.log（result））;</div> <p></p></td></tr></tbody></table></div>        <div class="table-wrapper"><table class="  _layout-fixed" width="100%" id="fetchHub"><thead><tr id="fcb2933e" class="ijRowHead"><th id="0f3810df" colspan="3"><p>fetchHub（URL：字符串，fetchConfig：对象）：承诺<object></object></p></th></tr></thead><tbody><tr id="16294cf8" class="ijRowOdd"><td id="b58ad96a" width="20%"><p>描述</p></td><td id="1f24bea9" colspan="2"><p>向集线器服务提出授权请求。</p></td></tr><tr id="3be0f9ed" class="ijRowEven"><td id="9908f0b2" rowspan="2"><p>参量</p></td><td id="e21beafc" width="20%"><code class="code">url</code></td><td id="bc6585ac"><p>将URL设置为集线器服务API端点。这是您要获取的资源的路径。该URL是相对于服务器主URL的。有关更多信息，请参阅<a href="/help/hub/Hub-Rest-Api-URL.html" rel="noopener noreferrer" data-external="true" target="_blank">Hub文档</a> 。</p></td></tr><tr id="c9ca8b40" class="ijRowOdd"><td id="8764a63c"><code class="code">fetchConfig</code></td><td id="c601774b"><p>定义一个可选的options对象。该对象包含要应用于请求的任何自定义设置。</p></td></tr><tr id="ff63adcd" class="ijRowEven"><td id="c30101cb"><p>例</p></td><td id="4cef6d97" colspan="2"><p></p><div class="code-block" data-lang="none">consoleApi.fetchHub（'api / rest / users / me？fields = name，login，profile（avatar（url））'）.then（响应=> console.log（response））;</div>以下示例显示了如何在POST请求中使用此方法：<div class="code-block" data-lang="none">dashboardApi.fetchHub（'api / rest / users / me'，{方法：'POST'，正文：{favoriteProjects：[]}}）.then（response => console.log（response））;</div> <p></p></td></tr></tbody></table></div>        <div class="table-wrapper"><table class="  _layout-fixed" width="100%" id="loadServices"><thead><tr id="7709f419" class="ijRowHead"><th id="a108271a" colspan="3"><p>loadServices（applicationName：string）：承诺<array><object>><object><p></p></object></object></array></p></th></tr></thead><tbody><tr id="7f3cef5c" class="ijRowOdd"><td id="3e8efe9d" width="20%"><p>描述</p></td><td id="d7ac69e8" colspan="2"><p id="2dee815d">返回连接到集线器服务且满足以下要求的最低版本要求的服务列表： <code class="code">dependencies</code>的部分<code class="code">manifest.json</code>小部件的文件。</p>                    <ul class="list _ul"><li class="list__item" id="bd0f69da"><p>如果使用指定的服务<code class="code">applicationName</code>参数未在中引用<code class="code">dependencies</code>小部件清单的“部分”，将引发异常。</p></li><li class="list__item" id="d97eb231"><p>如果连接到集线器服务的指定服务不满足最低版本要求，则返回一个空数组。</p></li></ul></td></tr><tr id="881dd80a" class="ijRowEven"><td id="8c8ca50f"><p>参量</p></td><td id="2a968e3a" width="20%"><code class="code">applicationName</code></td><td id="e6ef8cde"><p>确定对照哪些服务进行检查<code class="code">dependencies</code>在小部件清单中。</p></td></tr><tr id="804ce438" class="ijRowOdd"><td id="b21889e2"><p>例</p></td><td id="c054fcc4" colspan="2"><p>以下示例检查集线器服务中与以下版本中引用的YouTrack版本兼容的YouTrack版本： <code class="code">dependencies</code>小部件清单的部分。该应用程序的兼容版本列表已打印到控制台。</p><div class="code-block" data-lang="none">dasboardApi.loadServices（'YouTrack'）.then（youtracks => console.log（youtracks [0]））;</div><p></p></td></tr></tbody></table></div>        <div class="table-wrapper"><table width="100%" id="removeWidget"><thead><tr id="57762e04" class="ijRowHead"><th id="c60b4bad" colspan="2"><p>removeWidget（）：无效</p></th></tr></thead><tbody><tr id="c1ec66d8" class="ijRowOdd"><td id="73cedd4d" width="20%"><p>描述</p></td><td id="0d475460"><p>从仪表板上删除自定义窗口小部件。</p></td></tr></tbody></table></div>    </div>    <div class="chapter"><h2 id="widget-API" data-toc="custom-widgets-API-reference#widget-API">小部件API</h2>        <p id="2ef778e3">使用小部件API可以控制自定义小部件上控件的可见性。这些方法适用于<code class="code">widgetApi</code>宾语。</p>        <div class="table-wrapper"><table width="100%" id="onRefresh"><thead><tr id="88593b38" class="ijRowHead"><th id="b421dbe4" colspan="2"><p>onRefresh（）：？诺言<void></void></p></th></tr></thead><tbody><tr id="6734ed91" class="ijRowOdd"><td id="543d0457" width="20%"><p>描述</p></td><td id="23d9ed34"><p>在窗口小部件标题中单击<span class="control">刷新</span>图标时，调用操作。如果未设置，则<span class="control">刷新</span>图标不会显示在标题中。</p></td></tr></tbody></table></div>        <div class="table-wrapper"><table width="100%" id="onConfigure"><thead><tr id="424a95ca" class="ijRowHead"><th id="a17d7ad2" colspan="2"><p>onConfigure（）：无效</p></th></tr></thead><tbody><tr id="cd31c6aa" class="ijRowOdd"><td id="163a970c" width="20%"><p>描述</p></td><td id="1e1d8ce9"><p>从小部件菜单中选择“ <span class="control">编辑”</span>选项时，调用一个动作。如果未设置，则不显示“ <span class="control">编辑”</span>选项。</p></td></tr></tbody></table></div>    </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="test-custom-widgets.html">测试自定义小部件</a> <a class="navigation-links__next" href="sample-custom-widgets.html">样本自定义小部件</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>