<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>OAuth 2.0授权-帮助|帮助YouTrack InCloud</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="OAuth-Authorization" data-breadcrumbs="Resources-for-Developers.xml|Resources for Developers/api-log-in-to-youtrack.xml|Log in to YouTrack/OAuth-Authorization.xml|OAuth 2.0 Authorization" data-main-title="OAuth 2.0 Authorization"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索YouTrack InCloud帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack InCloud 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="OAuth-Authorization.xml" data-toc="OAuth-Authorization">OAuth 2.0授权</h1>    <p id="b3b30167">要使用OAuth 2.0通过REST API访问YouTrack资源，您需要登录，授权并获取YouTrack的访问令牌。授权由集线器服务提供。</p>    <p id="5b1fd21d">我们仅建议您在应用程序需要客户端身份验证时使用OAuth 2.0。否则，最好使用基于令牌的授权。有关更多信息，请参阅<a href="authentication-with-permanent-token.html">永久令牌授权</a> 。</p>    <aside class="prompt" rel="5b1fd21d" id="9c3f31d3" data-type="warning" data-title="">        <p id="a77655f3">不要尝试在内置集线器服务中注册外部服务！这可能会导致服务崩溃或故障。它还可能导致数据库损坏或数据丢失。</p>    </aside>                <p id="de17a87b">连接到YouTrack InCloud实例的集线器服务仅支持<a href="#implicit-authorization-grants">隐式授权授予</a> 。</p>        <p id="be9db006">要使用隐式OAuth 2.0授权，您的客户端应用程序必须在Internet上公开可用。此类应用程序通常用JavaScript编写并在Web浏览器中运行。</p>            <div class="chapter"><h2 id="HubOauthEndpoints" data-toc="OAuth-Authorization#HubOauthEndpoints">终点</h2>        <p id="f7a14d74">内置的中心服务使用以下OAuth 2.0端点：</p>        <div class="table-wrapper"><table width="100%" id="261e2fb5"><thead><tr id="640add3b" class="ijRowHead"><th id="ca61964a" width="20%"><p>终点</p></th><th id="5a050809"><p>网址</p></th></tr></thead><tbody><tr id="5a0ed516" class="ijRowOdd"><td id="f16cfa68"><p>认证方式</p></td><td id="341a1b62"><code class="code"><Hub service URL>/api/rest/oauth2/auth</code></td></tr><tr id="f33a1260" class="ijRowEven"><td id="5b5219b4"><p>代币</p></td><td id="459cd2af"><code class="code"><Hub service URL>/api/rest/oauth2/token</code></td></tr></tbody></table></div>                            <p id="bd80df70">的<code class="code"><Hub service URL></code>是网络环境中集线器服务的访问点。对于YouTrack InCloud，当您替换<code class="code">/youtrack</code>您的YouTrack基本网址中的路径<code class="code">/hub</code> 。例如， <code class="code">company-domain.myjetbrains.com/hub</code> 。</p>            <p id="2b57422d">您可以在“ <span class="control">域设置”</span>页面上找到实例的基本URL。有关更多信息，请参阅<a href="Domain-Settings.html">域设置</a> 。</p>            </div>    <div class="chapter"><h2 id="implicit-authorization-grants" data-toc="OAuth-Authorization#implicit-authorization-grants">隐式授权</h2>    <p id="1ce189d1">YouTrack支持OAuth 2.0授权以及<a href="https://tools.ietf.org/html/rfc6749#section-4.2" rel="noopener noreferrer" data-external="true" target="_blank">OAuth 2.0授权框架中</a>指定的隐式授权。</p>            <p id="92898512">要从YouTrack获取访问令牌，您需要提供以下参数的值：</p>        <a name="Send User to Authorization Server (Hub)"></a>        <div class="chapter"><h3 id="SendUserToAuthServer" data-toc="OAuth-Authorization#SendUserToAuthServer">要求</h3>            <p id="15449c31">要启动身份验证，请将浏览器重定向到授权端点：</p>            <div class="code-block" data-lang="markup">$ {Hub服务URL} / api / rest / oauth2 / auth？response_type = token＆state = $ {State}＆redirect_uri = $ {客户端重定向URI}＆request_credentials = $ {请求凭据模式}＆client_id = $ {客户端服务ID}＆scope = $ {Scope}</div>            <p id="5f3d5777">例：</p>            <div class="code-block" data-lang="markup">https://www.company-youtrack.com/hub/api/rest/oauth2/auth?response_type=token&state=9b8fdea0-fc3a-410c-9577-5dee1ae028da&redirect_uri=https%3A%2F%2Fmyservice.company.com%2Fauthorized&request_credentials= skip＆client_id = 98071167-004c-4ddf-ba37-5d4599fdf319＆scope = 0-0-0-0-0％2098071167-004c-4ddf-ba37-5d4599fdf319</div>            <p id="2aeae377">要从YouTrack获取访问令牌，您需要在授权请求中为以下参数提供值：</p>            <div class="table-wrapper"><table width="100%" id="ebde0859"><thead><tr id="32cee37b" class="ijRowHead"><th id="9bb09239" width="20%"><p>参数</p></th><th id="e0f4e591"><p>描述</p></th></tr></thead><tbody><tr id="15ca97d6" class="ijRowOdd"><td id="ad8a86be"><code class="code">response_type</code></td><td id="afdc32a3"><p>在OAuth 2.0请求中指定授予类型。对于隐式授予，请使用<code class="code">token</code> 。</p></td></tr><tr id="43fc96b8" class="ijRowEven"><td id="4aba4759"><code class="code">state</code></td><td id="3636467e"><p>当前应用程序状态的标识符。例如，它可以是本地存储对象的键，该对象包含有关当前用户在客户端应用程序中的位置的信息。</p></td></tr><tr id="078a4f6b" class="ijRowOdd"><td id="c986c3e9"><code class="code">redirect_uri</code></td><td id="a6ce0cc3"><p>客户端应用程序中的URI，可以处理来自Hub的响应。</p></td></tr><tr id="c1d025a2" class="ijRowEven"><td id="a9ad34c7"><code class="code">request_credentials</code></td><td id="e9c411b3">一个参数，该参数确定是否应要求用户登录。以下值是有效的：<ul class="list _bullet"><li class="list__item" id="b9243acf">                                <code class="code">skip</code> —在客户端应用程序允许匿名访问时使用。<ul class="list _bullet"><li class="list__item" id="1c528b94"><p>如果用户已经登录到集线器，则授予该用户对客户端应用程序的访问权限。</p></li><li class="list__item" id="2adec78c"><p>如果用户未登录到集线器并且未禁止来宾帐户，则该用户被授予作为来宾访问客户端应用程序的权限。</p></li><li class="list__item" id="571673c9"><p>如果用户未登录到集线器并且访客帐户被禁止，则该用户将被重定向到登录页面。</p></li></ul>                            </li><li class="list__item" id="8780d45f"><p>                                <code class="code">silent</code> - 和...一样<code class="code">skip</code> ，但在所有情况下都将用户重定向到客户端应用程序。如果禁止来宾帐户，则会将用户重定向到带有身份验证错误的客户端应用程序。</p></li><li class="list__item" id="cafaaa64"><p>                                <code class="code">required</code> —将用户从集线器中注销，并将他们重定向到登录页面。用作对客户端应用程序中注销请求的响应。</p></li><li class="list__item" id="630938e7">                                <code class="code">default</code> —在客户端应用程序不允许匿名访问时使用。<ul class="list _bullet"><li class="list__item" id="6743f179"><p>如果用户已经登录到集线器，则授予该用户对客户端应用程序的访问权限。</p></li><li class="list__item" id="058237e3"><p>如果用户未登录集线器，则该用户将被重定向到登录页面。</p></li></ul>                            </li></ul>                    </td></tr><tr id="dea69038" class="ijRowOdd"><td id="53ef63c5"><code class="code">client_id</code></td><td id="ec84a031"><p>在内置集线器服务中注册的YouTrack服务的ID。要获取YouTrack服务ID，请打开<span class="menupath" data-skip-index="skip">管理>集线器集成</span>页面：</p><figure><img alt="OAuth Yt服务ID" title="OAuth Yt服务ID" src="/help/img/youtrack/2019.2/oauthYTServiceId.png" id="da12b743" width="672" height="223"></figure><p></p></td></tr><tr id="b7a77c4f" class="ijRowEven"><td id="5873c1ec"><code class="code">scope</code></td><td id="8a0f94bf"><p>处理API请求的访问范围。在内置集线器中使用YouTrack服务的符号名称： <code class="code">YouTrack</code> 。</p></td></tr></tbody></table></div>        </div>        <div class="chapter"><h3 id="AuthServerResponse" data-toc="OAuth-Authorization#AuthServerResponse">回应</h3>            <p id="3161ac20">客户端服务应该能够处理来自集线器的URL，该URL作为URL传递。 <code class="code">redirect_uri</code> 。响应参数在URL中的井号后传递。结果，这些参数不会发送到服务器，也不会被恶意因素拦截。</p>            <p id="e305848b">如果资源所有者批准了访问请求，则集线器将使用以下命令将以下参数添加到重定向URI的片段组件中，以发出访问令牌并将其传递给客户端。 <code class="code">"application/x-www-form-urlencoded"</code>格式：</p>            <div class="table-wrapper"><table width="100%" id="01f73c41"><thead><tr id="a0b2be8c" class="ijRowHead"><th id="7ff86068" width="20%"><p>参数</p></th><th id="fc5bad9f"><p>描述</p></th></tr></thead><tbody><tr id="f4dfec61" class="ijRowOdd"><td id="dc8a711d"><code class="code">access_token</code></td><td id="647e45a0"><p>集线器发出的访问令牌。</p></td></tr><tr id="c88ca7f7" class="ijRowEven"><td id="0a083fe5"><code class="code">token_type</code></td><td id="59436db4"><p>Hub发行的令牌的类型。该值不区分大小写。</p></td></tr><tr id="b0adf5f9" class="ijRowOdd"><td id="c1d33da0"><code class="code">expires_in</code></td><td id="081c8a9b"><p>访问令牌的生存期（以秒为单位）。例如， <code class="code">3600</code>表示访问令牌从生成响应的时间起一小时后过期。</p></td></tr><tr id="7666a5fd" class="ijRowEven"><td id="228beba2"><code class="code">scope</code></td><td id="59ce0014"><p>如果与客户要求的范围相同，则为可选；否则，是必需的。集线器中访问令牌的范围是<code class="code">service_id</code> 。</p></td></tr><tr id="4d77b8ef" class="ijRowOdd"><td id="7b8d6350"><code class="code">state</code></td><td id="b3d8b8c3"><p>如果需要<code class="code">state</code>参数在客户端授权请求中指定。从客户端收到的确切值。</p></td></tr></tbody></table></div>            <p id="71fd5ae0">请注意，授权服务器（Hub） <i id="3365aa3d">不会发出刷新令牌</i> 。</p>            <p id="ebbf88be">例如，中心服务器通过发送以下HTTP响应来重定向用户代理：</p>            <div class="code-block" data-lang="markup">HTTP / 1.1 302找到的位置：http://myservice.company.com/authorized#access_token=1443459450185.0-0-0-0-0.98071167-004c-4ddf-ba37-5d4599fdf319.0-0-0-0-0%3B1 .MCwCFC％2FYWvLjHdzOdpLleDLITJn4Mz9rAhRklCoZ2dlMkh2aCd1K5QQ89ibsxg％3D％3D＆token_type = Bearer＆expires_in = 3600＆scope = 0-0-0-0-0％2098071167-a-da-dd-f4df-a4df-d4-df-a4df-a4df-d4-df-a-df-a-df-a-d-a-df-a-d-a-d-a-df-a-d-a-df-a-dd-state = 3d％3D％3d＆token_type = bearer＆expires_in = 3600＆scope = 0-0-0-0-0％2098071167-a4df4df-d4a-d5a-d4df-a4df-d4-df-d4df-d4df-a-df-a-df-a-d-a-df-a-dd-state</div>                    </div>        <div class="chapter"><h3 id="ErrorRedirectBackFromHub" data-toc="OAuth-Authorization#ErrorRedirectBackFromHub">OAuth 2.0错误</h3>            <p id="b223015f">如果由于丢失，无效或不匹配的重定向URI而导致请求失败，或者客户端标识符丢失或无效，则中心服务器将错误通知资源所有者，并且不会自动将用户代理重定向到无效的重定向URI。 。</p>            <p id="06084192">如果资源所有者拒绝访问请求，或者如果请求由于某种原因而不是丢失或无效的重定向URI失败，则授权服务器通过使用“ <code class="code">application/x-www-form-urlencoded</code>格式：</p>            <div class="table-wrapper"><table width="100%" id="a28e055c"><thead><tr id="e337d68f" class="ijRowHead"><th id="816783f1" width="20%"><p>参数</p></th><th id="95359a27"><p>描述</p></th></tr></thead><tbody><tr id="1839d639" class="ijRowOdd"><td id="792945df"><code class="code">error</code></td><td id="6d3e4a02"><p>单个ASCII [USASCII]错误代码。有关可能的错误的列表，请参阅<a href="#AuthorizationResponseErrors">授权响应错误</a>和<a href="#token-response-error-codes">令牌响应错误</a> 。</p></td></tr><tr id="68e530ea" class="ijRowEven"><td id="ea3d0657"><code class="code">error_description</code></td><td id="87b1f096"><p>人工可读的ASCII [USASCII]文本提供了其他信息，用于帮助客户端开发人员了解问题所在。</p></td></tr><tr id="dc3d9bac" class="ijRowOdd"><td id="38117ca7"><code class="code">error_uri</code></td><td id="ec6376cb"><p>一个URI，用于标识人类可读的网页以及有关该错误的信息，用于向客户端开发人员提供其他信息。</p></td></tr><tr id="883a7973" class="ijRowEven"><td id="03b37079"><code class="code">state</code></td><td id="71479729"><p>如果客户端授权请求中存在“状态”参数，则为必需。从客户端收到的确切值。</p></td></tr></tbody></table></div>            <p id="0718a8d8">例如，集线器通过发送以下HTTP响应来重定向用户代理：</p>            <div class="code-block" data-lang="markup">HTTP / 1.1 302找到位置：https://myservice.company.com/cb#error=access_denied&state=xyz</div>                        <div class="chapter"><h4 id="AuthorizationResponseErrors">授权响应错误</h4>                <p id="8bd2b019">请求到授权端点可以返回以下错误。</p>                <div class="table-wrapper"><table class=" wide" width="100%" id="1608cfac"><thead><tr id="ae53cdca" class="ijRowHead"><th id="85c77f8b" width="20%"><p>错误</p></th><th id="fc0db5e8" width="40%"><p>描述</p></th><th id="e895718a" width="40%"><p>解</p></th></tr></thead><tbody><tr id="b6cf7986" class="ijRowOdd"><td id="45591976"><a name="auth.invalid_request"></a><code class="code">invalid_request</code></td><td id="abfc9f80"><p>对集线器的授权请求缺少必需的参数，包括无效的参数值，多次包含一个参数，或者格式错误。</p></td><td id="102afa1e"><p>验证所有参数是否正确，是否提供了<code class="code">service_id</code>存在，依此类推。</p></td></tr><tr id="cccf60c7" class="ijRowEven"><td id="9938da42"><a name="auth.unauthorized_client"></a><code class="code">unauthorized_client</code></td><td id="c8749865"><p>客户端无权使用此方法请求授权码，或者<code class="code">redirect_URI</code>的服务不正确或丢失。</p></td><td id="a5732da3"><ol class="list _decimal"><li class="list__item" id="4fb1e353"><p>确保<code class="code">redirect_uri</code>是正确的，并且已正确注册为服务的重定向URI之一。</p></li><li class="list__item" id="35911a8b"><p>确保您的服务至少提供一项<code class="code">redirect_uri</code>在集线器中。</p></li></ol></td></tr><tr id="63f493dc" class="ijRowOdd"><td id="70e43753"><code class="code">access_denied</code></td><td id="dbbbb3f4"><p>资源所有者或集线器拒绝了该请求。</p></td><td id="19384dd4"><p>确认您使用的是正确的值<code class="code">scope</code>参数。</p></td></tr><tr id="279d5b8a" class="ijRowEven"><td id="6c3e4fa9"><a name="auth.unsupported_responce_type"></a><code class="code">unsupported_response_type</code></td><td id="94dbb327"><p>集线器不支持使用此方法获取授权码。</p></td><td id="536badfe"><p>确认您已为<code class="code">response_type</code>至<code class="code">token</code> 。</p></td></tr><tr id="d0578e73" class="ijRowOdd"><td id="99a863c0"><a name="auth.invalid_scope"></a><code class="code">invalid_scope</code></td><td id="eaf089e4"><p>请求授权的范围与任何注册的服务都不匹配。</p></td><td id="bac4deb2"><p>确保该请求是正确的。</p></td></tr><tr id="6a10a2b8" class="ijRowEven"><td id="6ee1628d"><code class="code">server_error</code></td><td id="bd00df47"><p>集线器服务遇到意外状况，阻止其满足请求。（由于无法使用HTTP重定向将500内部服务器错误HTTP状态代码返回给客户端，因此需要此错误代码。）</p></td><td id="bd3ee8d4"><p>YouTrack与集线器服务之间的连接可能不同步。在YouTrack中打开“ <span class="control">集线器集成”</span>页面并运行诊断。</p></td></tr><tr id="341d3965" class="ijRowOdd"><td id="302722eb"><code class="code">temporarily_unavailable</code></td><td id="3cbb07c7"><p>由于服务器的暂时超载或维护，授权服务器当前无法处理该请求。（由于无法使用HTTP重定向将503服务不可用HTTP状态代码返回给客户端，因此需要此错误代码。）</p></td><td id="dd4cb004"><p>YouTrack与集线器服务之间的连接可能不同步。在YouTrack中打开“ <span class="control">集线器集成”</span>页面并运行诊断。</p></td></tr></tbody></table></div>            </div>            <div class="chapter"><h4 id="token-response-error-codes">令牌响应错误</h4>                <p id="3a839228">请求可以向令牌端点返回以下错误。有关更多信息，请阅读<a href="https://tools.ietf.org/html/rfc6749#section-5.2" rel="noopener noreferrer" data-external="true" target="_blank">RFC6749标准中</a>定义的每个错误的定义。</p>                <div class="table-wrapper"><table class=" wide" width="100%" id="39285e76"><thead><tr id="6f9bf648" class="ijRowHead"><th id="0e2067fc" width="20%"><p>错误</p></th><th id="a8d1f565" width="40%"><p>描述</p></th><th id="c3280eaf" width="40%"><p>解</p></th></tr></thead><tbody><tr id="70f19a5e" class="ijRowOdd"><td id="db0a5807">                            <a name="token.invalid_request"></a>                            <code class="code">invalid_request</code>                        </td><td id="7152ce61">                            <p id="015f82d5">该请求缺少必需的参数，包括不受支持的参数值（授权类型除外），重复参数，包括多个凭据，利用多个以上的机制来认证客户端，或者格式错误。</p>                        </td><td id="26ae3920"><p>检查响应头，然后检查请求是否正确。</p></td></tr><tr id="0b7035de" class="ijRowEven"><td id="6559cf72">                            <a name="token.invalid_client"></a>                            <code class="code">invalid_client</code>                        </td><td id="15d6b7a8"><p>客户端身份验证失败。例如，客户端未知，不包括客户端身份验证或身份验证方法不受支持。</p></td><td id="6b416141"><p>检查值<code class="code">client_id</code>参数。</p></td></tr><tr id="7a467c07" class="ijRowOdd"><td id="235b4455">                            <a name="token.unsupported_grant_type"></a>                            <code class="code">unsupported_grant_type</code>                        </td><td id="8028e5d1"><p>集线器不支持授权授予类型。</p></td><td id="be7c903a"><p>确认您已为<code class="code">response_type</code>至<code class="code">token</code> 。</p></td></tr><tr id="02d8d1ab" class="ijRowEven"><td id="5d82ff23">                            <a name="token.invalid_scope"></a>                            <code class="code">invalid_scope</code>                        </td><td id="382ba15b"><p>您需要访问令牌的范围与任何注册的服务都不匹配。</p></td><td id="3180293b"><p>确认您使用的是正确的值<code class="code">scope</code>参数。</p></td></tr></tbody></table></div>            </div>        </div>    </div>    <div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="authentication-with-permanent-token.html">永久令牌授权</a> <a class="navigation-links__next" href="youtrack-rest-api-reference.html">REST API</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>