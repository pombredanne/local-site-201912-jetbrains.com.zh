<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/help/app/v2/analytics.js"></script><meta charset="UTF-8"><meta name="robots" content="noindex"><title>Subtasks - Help | YouTrack Standalone</title><link rel="stylesheet" href="/help/app/v2/app.css"></head><body data-id="Workflow-Subtasks"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search YouTrack Standalone Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2018.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="false"><h1 data-toc="Workflow-Subtasks" id="Workflow-Subtasks.xml">Subtasks</h1>  <p id="cc44ebe9">This workflow automatically sets the state of a parent task when the state changes in issues that are linked as    subtasks.  </p>  <div class="table-wrapper"><table class="left_header                 " width="100%" id="d8494aa3"><tbody><tr id="eda9eb27" class="ijRowOdd"><th id="a6256c49"><p>Name</p></th><td id="80077f1d"><p>@jetbrains/youtrack-workflow-subtasks</p></td></tr><tr id="1f8d0261" class="ijRowEven"><th id="ba0ae067"><p>Auto-attached</p></th><td id="4d9f0a96"><p>yes</p></td></tr><tr id="8d9da8e2" class="ijRowOdd"><th id="a8d8d41f"><p>Modules</p></th><td id="ba9b62d5"><p>        <a href="#open-parent">Open parent task when subtask changes to an unresolved state</a>        (on-change rule)        <br>        <a href="#fix-parent">Fix parent task when all subtasks are resolved</a>        (on-change rule)      </p></td></tr></tbody></table></div>  <div class="chapter"><h2 id="127ec5f0">Use Case</h2>    <p id="8662861b">You want to automatically update the state of a parent task when changes are applied to subtasks.</p>    <ul class="list _ul"><li class="list__item" id="0b7981f7"><p>When any subtask is set to an unresolved state, the state of the parent task changes to <span class="control">        Open</span>.      </p></li><li class="list__item" id="cf48b4ae"><p>When all subtasks are set to a resolved state, the state of the parent task changes to <span class="control">        Fixed</span>.      </p></li></ul>  </div>  <div class="chapter"><h2 id="33915e1b">Modules</h2>    <p id="678df711">This workflow includes two modules.</p>    <div class="chapter"><h3 id="open-parent">Open parent task when subtask changes to an unresolved state</h3>      <p id="5b4f095b">When the state of an issue is set to an unresolved state, this rule checks whether the issue is linked as a        subtask of a parent task.        If the parent task belongs to an active project and has a resolved state, the state of the parent task is        changed to <span class="control">Open</span>.      </p>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">workflow</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/workflow&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Open parent task when subtask changes to an unresolved state&#39;</span><span class="p">),</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">isReported</span> <span class="o">&amp;&amp;</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">becomesUnresolved</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">processParent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">issue</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="s1">&#39;subtask of&#39;</span><span class="p">].</span><span class="nx">isEmpty</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="kd">var</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="s1">&#39;subtask of&#39;</span><span class="p">].</span><span class="nx">first</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">parent</span> <span class="o">&amp;&amp;</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">project</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">parent</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">isArchived</span> <span class="o">&amp;&amp;</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">isReported</span> <span class="o">&amp;&amp;</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">isResolved</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">field</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">findFieldByName</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">findValueByName</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">Open</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">parent</span><span class="p">.</span><span class="nx">State</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
            <span class="nx">workflow</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Automatically reopen {0}&#39;</span><span class="p">,</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">id</span><span class="p">));</span>
            <span class="k">return</span> <span class="nx">parent</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">issue</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">issue</span> <span class="o">=</span> <span class="nx">processParent</span><span class="p">(</span><span class="nx">issue</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">State</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">fieldType</span><span class="p">,</span>
      <span class="nx">Open</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    </div>    <div class="chapter"><h3 id="fix-parent">Fix parent task when all subtasks are resolved</h3>      <p id="37bce222">When the state of an issue is set to a resolved state, this rule checks whether the issue is linked as a        subtask of a parent task.        If the parent task is unresolved, the rule checks the current state for all other issues that are linked to the        parent task as subtasks.        If all other subtasks are resolved, the state of the parent task is set to <span class="control">Fixed</span>.      </p>      <p id="e31ef322">The rule then checks the parent task to see if it is linked as a subtask to a parent task and performs the same        operation.      </p>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">workflow</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/workflow&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Fix parent when all subtasks are resolved&#39;</span><span class="p">),</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">isReported</span> <span class="o">&amp;&amp;</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">becomesResolved</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">processParent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">issue</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="s1">&#39;subtask of&#39;</span><span class="p">].</span><span class="nx">isEmpty</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="kd">var</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="s1">&#39;subtask of&#39;</span><span class="p">].</span><span class="nx">first</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">parent</span> <span class="o">&amp;&amp;</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">project</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">parent</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">isArchived</span> <span class="o">&amp;&amp;</span>
        <span class="nx">parent</span><span class="p">.</span><span class="nx">isReported</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">parent</span><span class="p">.</span><span class="nx">isResolved</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">unresolvedSubtask</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="s1">&#39;parent for&#39;</span><span class="p">].</span><span class="nx">find</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">subtask</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">subtask</span><span class="p">.</span><span class="nx">isReported</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">subtask</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">isResolved</span><span class="p">;</span>
        <span class="p">});</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">unresolvedSubtask</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">field</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">findFieldByName</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">findValueByName</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">Fixed</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">parent</span><span class="p">.</span><span class="nx">State</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
              <span class="nx">workflow</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Automatically set {0} as Done&#39;</span><span class="p">,</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">id</span><span class="p">));</span>
              <span class="k">return</span> <span class="nx">parent</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">issue</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">issue</span> <span class="o">=</span> <span class="nx">processParent</span><span class="p">(</span><span class="nx">issue</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">State</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">fieldType</span><span class="p">,</span>
      <span class="nx">Fixed</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    </div>  </div><div class="last-modified" data-skip-index="skip">Last modified: 7 March 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Workflow-Subtask-Inherit-Subsystem.html">Subtask Inherit Subsystem</a><a class="navigation-links__next" href="Workflow-Task-Assignee.html">Task Assignee</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/help/app/v2/app.js"></script></body></html>