<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/help/app/v2/analytics.js"></script><meta charset="UTF-8"><meta name="robots" content="noindex"><title>Slack Notifications - Help | YouTrack Standalone</title><link rel="stylesheet" href="/help/app/v2/app.css"></head><body data-id="slack-notifications-workflow"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search YouTrack Standalone Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2018.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="false"><h1 data-toc="slack-notifications-workflow" id="slack-notifications-workflow.xml">Slack Notifications</h1>  <p id="53114176">This workflow posts a notification to Slack when an issue is created, resolved, or reopened.  </p>  <div class="table-wrapper"><table class="left_header                 " width="100%" id="373a9562"><tbody><tr id="f6e4e112" class="ijRowOdd"><th id="55c8b757"><p>Name</p></th><td id="2c9818e1"><p>@jetbrains/youtrack-workflow-slack-notifications-simple</p></td></tr><tr id="c2cc3815" class="ijRowEven"><th id="ee105dca"><p>Auto-attached</p></th><td id="8cf073cb"><p>no</p></td></tr><tr id="3f4dd402" class="ijRowOdd"><th id="1916d1c5"><p>Modules</p></th><td id="d639511b"><p>        <a href="#send-to-slack">Send notification to slack when an issue is reported, resolved, or reopened</a>        (on-change rule)      </p></td></tr></tbody></table></div>  <div class="chapter"><h2 id="b661130b">Use Case</h2>    <p id="05182d2b">This workflow helps teams who use Slack as their primary communication hub to stay up to date with their issues in YouTrack.</p>    <p id="4bd2cc4e">While the workflow is written to post notifications to Slack when an issue is created, resolved, or reopened, you can easily customize this notification scheme to include other events that are important to you.</p>    <p id="bddfab72">To use this workflow, you need to create an Incoming Webhooks Integration in Slack. This gives you the ability to post a message from an external source to a specific channel in Slack.      For instructions, refer to the <a href="https://jetbrains.slack.com/apps/new/A0F7XDUAZ-incoming-webhooks" data-external="true" target="_blank" rel="noopener noreferrer"><span>Slack App Directory</span></a>.</p>    <p id="a3697fec">When you add an Incoming Webhook, Slack generates a Webhook URL.</p>    <figure><a class="lightbox" href="/help/img/youtrack/2018.1/slack-notifications-setup.zoomed.png"><img alt="slack notifications setup" title="slack notifications setup" src="/help/img/youtrack/2018.1/slack-notifications-setup.png" id="53a3b8e7" width="600" height="521"></a></figure>    <p id="411e1eb7">Copy this URL and use this as the value for the <code class="code" data-lang="Java">var SLACK_WEBHOOK_URL</code> statement in the on-change rule.    You might also take a minute to read through the setup instructions on this page in Slack, as it explains exactly how this integration works and can help you identify how to customize this workflow should you want to modify the message content and appearance.</p>    <p id="404546f6">Note that Incoming Webhooks are channel-specific.    If you want to send notifications to different channels on a per-project basis, you can add separate modules to this workflow for each project team.     You can then configure copies of this rule to send notification to the channels that are used by each team.</p>    <p id="76ecb755">This workflow requires that the <span class="control">Priority</span>, <span class="control">State</span>, and <span class="control">Assignee</span> custom fields are available in your project.</p>  </div>  <div class="chapter"><h2 id="83afd834">Modules</h2>    <p id="3de9e35b">When an is created, resolved, or reopened, this on-change rule posts a notification to Slack.      The JSON payload that contains the message is defined in the <code class="code" data-lang="Java">var payload</code> statement.</p>    <p id="7333dc7d">If a message is not posted successfully, a warning is posted to the workflow console.</p>    <div class="chapter"><h3 id="send-to-slack">Send notification to slack when an issue is reported, resolved, or reopened</h3>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="c1">// Thanks to Michael Rush for the original version of this rule (https://software-development.dfstudio.com/youtracks-new-javascript-workflows-make-slack-integration-a-breeze-d3275605d565)</span>

<span class="c1">// IMPORTANT: Use a valid Incoming Webhook from Slack. To get one, go to https://my.slack.com/services/new/incoming-webhook/</span>
<span class="kd">var</span> <span class="nx">SLACK_WEBHOOK_URL</span> <span class="o">=</span> <span class="s1">&#39;REPLACE_THIS_WITH_YOUR_WEBHOOK_URL&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/http&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Send notifications to Slack whenever an issue is reported, resolved, or reopened&#39;</span><span class="p">,</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">becomesReported</span> <span class="o">||</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">becomesResolved</span> <span class="o">||</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">becomesUnresolved</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">issueLink</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">url</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">message</span><span class="p">,</span> <span class="nx">isNew</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">becomesReported</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">message</span> <span class="o">=</span> <span class="s2">&quot;Created: &quot;</span><span class="p">;</span>
      <span class="nx">isNew</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">becomesResolved</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">message</span> <span class="o">=</span> <span class="s2">&quot;Resolved: &quot;</span><span class="p">;</span>
      <span class="nx">isNew</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">becomesUnresolved</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">message</span> <span class="o">=</span> <span class="s2">&quot;Reopened: &quot;</span><span class="p">;</span>
      <span class="nx">isNew</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">message</span> <span class="o">+=</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">summary</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">changedByTitle</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="nx">changedByName</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">isNew</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">changedByTitle</span> <span class="o">=</span> <span class="s2">&quot;Created By&quot;</span><span class="p">;</span>
      <span class="nx">changedByName</span> <span class="o">=</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">reporter</span><span class="p">.</span><span class="nx">fullName</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">changedByTitle</span> <span class="o">=</span> <span class="s2">&quot;Updated By&quot;</span><span class="p">;</span>
      <span class="nx">changedByName</span> <span class="o">=</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">updatedBy</span><span class="p">.</span><span class="nx">fullName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;attachments&quot;</span><span class="o">:</span> <span class="p">[{</span>
        <span class="s2">&quot;fallback&quot;</span><span class="o">:</span> <span class="nx">message</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="nx">issueLink</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pretext&quot;</span><span class="o">:</span> <span class="nx">message</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="nx">issueLink</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;color&quot;</span><span class="o">:</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Priority</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">||</span> <span class="s2">&quot;#edb431&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fields&quot;</span><span class="o">:</span> <span class="p">[{</span>
          <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;State&quot;</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
          <span class="s2">&quot;short&quot;</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;Priority&quot;</span><span class="p">,</span>
            <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Priority</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
            <span class="s2">&quot;short&quot;</span><span class="o">:</span> <span class="kc">true</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;Assignee&quot;</span><span class="p">,</span>
            <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Assignee</span> <span class="o">?</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Assignee</span><span class="p">.</span><span class="nx">fullName</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="s2">&quot;short&quot;</span><span class="o">:</span> <span class="kc">true</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="nx">changedByTitle</span><span class="p">,</span>
            <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="nx">changedByName</span><span class="p">,</span>
            <span class="s2">&quot;short&quot;</span><span class="o">:</span> <span class="kc">true</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}]</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">connection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Connection</span><span class="p">(</span><span class="nx">SLACK_WEBHOOK_URL</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2000</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">connection</span><span class="p">.</span><span class="nx">postSync</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">payload</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">isSuccess</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">&#39;Failed to post notification to Slack. Details: &#39;</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">Priority</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">EnumField</span><span class="p">.</span><span class="nx">fieldType</span>
    <span class="p">},</span>
    <span class="nx">State</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">fieldType</span>
    <span class="p">},</span>
    <span class="nx">Assignee</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">fieldType</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    </div>  </div><div class="last-modified" data-skip-index="skip">Last modified: 7 March 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Workflow-Auto-Raise-Priority.html">SLA Priority</a><a class="navigation-links__next" href="Workflow-Standalone-Work-Timer.html">Stopwatch-style Work Timer</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/help/app/v2/app.js"></script></body></html>