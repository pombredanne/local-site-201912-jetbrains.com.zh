<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>在VCS提交中应用命令-帮助|帮助YouTrack单机版</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Apply-Commands-in-VCS-Commits" data-breadcrumbs="Commands.xml|Commands/Apply-Commands-in-VCS-Commits.xml|Apply Commands in VCS Commits" data-main-title="Apply Commands in VCS Commits" data-article-props="
                {
                
            " seeals=":[=" titl=":=" system="" administratio=",=" link=":=" ur=":" integration-with-teamcity.htm="," tex=":" teamcity="" integratio="}=" integration-with-upsource.htm="," upsource="" ="url"="vcs-changes.html" ="text"="view=" }="" ]},="" ,="" configure-teamcity-integration.htm="," integrate="" with="" teamcit="}=" connect-to-a-vcs.htm="," connect="" to="" a="" vc="}=" =""><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索YouTrack独立帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Apply-Commands-in-VCS-Commits.xml" data-toc="Apply-Commands-in-VCS-Commits">在VCS提交中应用命令</h1>    <a name="Executing_Commands_from_a_Comment_to_a_VCS_Change_Commit"></a>    <p id="f0292360">当您将更改提交到版本控制系统中的代码存储库时，可以将命令应用于问题。您甚至不需要打开YouTrack。要应用这些更改，请使用特殊格式在提交消息中指定命令。有关YouTrack支持的命令的完整列表，请参阅《 <a href="Command-Reference.html">命令参考》</a> 。</p>    <p id="983a05f3">您可能已经了解了如何<a href="Map-Issues-to-VCS-Change-Commit.html">在提交消息中添加指向问题的链接</a> 。这更进一步。您不仅可以添加链接来帮助您在问题和版本控制系统之间导航，还可以应用YouTrack可以识别的任何命令，而无需离开IDE或存储库。</p>    <p id="250e9724">以下集成支持此功能：</p>    <ul class="list _ul"><li class="list__item" id="7e6b39f9"><a href="Integration-with-TeamCity.html">TeamCity整合</a></li><li class="list__item" id="a3570aef"><a href="Integration-with-Upsource.html">上游整合</a></li><li class="list__item" id="4233b86d"><p><a href="Integration-with-Version-Control-Systems.html">VCS集成</a> （GitHub，Bitbucket和GitLab）</p></li></ul>    <p id="7d398e29">对于构建服务器集成，此功能的可用性取决于项目中集成的配置。具体来说，构建配置和项目之间映射的“ <span class="control">流程更改”</span>设置必须设置为“ <span class="control">附加并应用命令”</span> 。否则，YouTrack将忽略命令。</p>    <div class="chapter"><h2 id="match-vcs-commit-author-with-users-youtrack" data-toc="Apply-Commands-in-VCS-Commits#match-vcs-commit-author-with-users-youtrack">匹配的VCS提交作者和YouTrack用户</h2>    <p id="f0adeb26">要链接VCS更改并处理提交消息中的命令，YouTrack必须找到与提交消息的作者匹配的用户帐户。如果在提交消息中指定了命令，则会基于在YouTrack中授予用户帐户的访问权限来应用命令。根据与版本控制系统的连接类型，以不同的方式标识用户帐户。</p>    <div class="table-wrapper"><table width="100%" id="be4b26a2"><thead><tr id="d0d72863" class="ijRowHead"><th id="fdb0c0ef" width="20%"><p>连接类型</p></th><th id="563b3d37"><p>描述</p></th></tr></thead><tbody><tr id="2a6f09f5" class="ijRowOdd"><td id="3b533218"><p>TeamCity整合</p></td><td id="12ac4da5"><p id="9358a556">YouTrack检查将更改提交给VCS的用户的TeamCity用户个人资料中存储的电子邮件地址。要识别提交更改的TeamCity用户，应将VCS用户名与TeamCity中的用户配置文件关联。</p>            </td></tr><tr id="47133077" class="ijRowEven"><td id="0aedd13b"><p>上游整合</p></td><td id="bc4a9751"><p>通过连接到外部集线器来支持此集成，该外部集线器同时管理Upsource和YouTrack的用户帐户。该命令由在VCS提交消息中输入命令的同一用户在YouTrack中应用。</p></td></tr><tr id="23d169b8" class="ijRowOdd"><td id="fd63f49e"><p>VCS集成</p></td><td id="f887f0fe"><p id="1d2fc006">对于VCS集成，将命令应用于问题的功能仅限于VCS集成设置中属于<span class="control">Committers</span>组的用户。</p>                <ul class="list _ul"><li class="list__item" id="30e3d021"><p>首先，YouTrack搜索其电子邮件地址与提交作者的电子邮件地址匹配的用户帐户。如果找到，则代表该用户执行命令。</p></li><li class="list__item" id="d96facf6"><p id="1b4c33af">如果“ <span class="control">提交者”</span>组中的所有用户都没有这样的电子邮件地址，则YouTrack尝试按名称查找匹配项。它采用集成VCS提供的值，并将其与存储在属于<span class="control">Committers</span>组的用户的集线器帐户中的<span class="control">VCS用户名</span>列表进行比较。</p>                    <ul class="list _ul"><li class="list__item" id="383ed0e6"><p>GitHub和GitLab提供存储为<span class="control">Name</span>的值。</p></li><li class="list__item" id="c91f1524"><p>Bitbucket提供存储为<span class="control">昵称</span>的值。</p></li></ul>                    </li></ul>            </td></tr></tbody></table></div>    <p id="7a6fc4a8">如果在YouTrack中找不到提交消息的作者，则不会应用该命令。用户名在VCS更改选项卡上以红色文本显示。警告工具提示提供了可用于解决问题的信息。</p>    <figure><a class="lightbox" href="/help/img/youtrack/2019.2/vcs-user-not-found.zoomed.png"><img alt="找不到VCS用户" title="找不到VCS用户" src="/help/img/youtrack/2019.2/vcs-user-not-found.png" id="7022c43c" width="600" height="94"></a></figure>        <p id="57d905af">用户基本上可以做两件事来解决此问题：</p>        <ul class="list _ul"><li class="list__item" id="f57f0f8a"><p>为他们在YouTrack和集成的VCS中的帐户使用相同的电子邮件地址。</p></li><li class="list__item" id="5fd2fbca"><p id="01fbfc02">将其名称（或Bitbucket的昵称）添加到其Hub帐户中的<span class="control">VCS用户名</span>列表中。</p>                <aside class="prompt" rel="01fbfc02" id="09584ffc" data-type="note" data-title=""><p id="9124c204">GitHub和GitLab用户经常输入其用户名，而不是在其个人资料中存储为<span class="control">Name</span>的值。如果您仍然无法在将消息提交到GitHub或GitLab存储库的命令中应用命令时遇到麻烦，请检查<span class="control">VCS用户名</span>中的<span class="control">Name</span> 。</p>                <p id="39785b86">例如，如果传奇软件工程师Linus Torvalds要确保他的GitHub提交已正确链接到他的VCS更改，则他需要将<span class="control">Linus Torvalds</span>添加到YouTrack的<span class="control">VCS用户名</span>列表中，而不是<code class="code">torvalds</code> ，这是他在GitHub中的用户名。</p></aside>            </li></ul>    </div>    <div class="chapter"><h2 id="command-related-notifications" data-toc="Apply-Commands-in-VCS-Commits#command-related-notifications">与命令有关的通知</h2>        <p id="37ce6efe">有一些特殊的事件类别，使您可以监视VCS是否将更改应用于问题并建立服务器集成。这些事件的订阅选项在您的YouTrack个人资料设置中可用。</p>        <figure><a class="lightbox" href="/help/img/youtrack/2019.2/command-related-notifications.zoomed.png"><img alt="与命令有关的通知" title="与命令有关的通知" src="/help/img/youtrack/2019.2/command-related-notifications.png" id="795c0d11" width="600" height="267"></a></figure>        <p id="36d79f1c">提供以下选项：</p>        <div class="table-wrapper"><table width="100%" id="d7af7717"><thead><tr id="6699d8c4" class="ijRowHead"><th id="dd33c9eb" width="20%"><p>通知事件</p></th><th id="765ee97b"><p>描述</p></th></tr></thead><tbody><tr id="73e446ea" class="ijRowOdd"><td id="9884d6a3"><p>VCS应用的更新并建立服务器集成</p></td><td id="07f56703"><p>在VCS提交中的注释中输入的命令更改应用于问题时，发送通知。这可以帮助您验证您的更改是否已由集成构建服务器或VCS处理。</p></td></tr><tr id="df8eeeb1" class="ijRowEven"><td id="cb3bf4aa"><p>VCS处理的提交和构建服务器集成中的命令失败</p></td><td id="c5e221ec"><p>当在VCS提交中的注释中输入的命令未能更新问题时，发送通知。这可以帮助您识别VCS用户名与他们的YouTrack帐户不正确匹配的用户或识别无效的命令语法。</p></td></tr></tbody></table></div>            <p id="ee6b9195">要了解如何更新YouTrack个人资料中的通知设置，请参阅<a href="Notifications.html#general-notifications-scheme">常规通知方案</a> 。</p>    </div>    <div class="chapter"><h2 id="vcs-commit-command-syntax" data-toc="Apply-Commands-in-VCS-Commits#vcs-commit-command-syntax">命令语法</h2>        <p id="60160896">VCS或构建服务器集成的设置包括一个用于分析提交以发表问题注释的选项。启用<span class="control">针对问题注释</span>的<span class="control">解析提交后</span> ，提交消息文本将命令复制到单独的问题注释后以新行开始。可以基于每个项目独立启用或禁用此功能，默认情况下处于禁用状态。要了解更多信息，请参阅<a href="Add-a-Comment.html#add-comment-vcs-commits">从VCS Commits生成注释</a> 。</p>    <p id="33880047">用于将命令应用于问题的模式不受此设置的影响。使用以下语法将命令应用于来自VCS提交消息的问题：</p>    <div class="code-block" data-lang="none"><code class="code-block__wrapper">[commit message text] #issueID [command 1] [command 2] ... [command n] [issue comment text] ...</code></div>    <p id="ea267a46">要么</p>    <div class="code-block" data-lang="none"><code class="code-block__wrapper">[commit message text] ^issueID [command 1] [command 2] ... [command n] [issue comment text] ...</code></div>        <p id="a6ec6ba4">整个提交消息（包括命令和问题注释）在活动流中显示为VCS更改记录的一部分。</p>        <figure><a class="lightbox" href="/help/img/youtrack/2019.2/commit-message-with-command.zoomed.png"><img alt="用命令提交消息" title="用命令提交消息" src="/help/img/youtrack/2019.2/commit-message-with-command.png" id="7431261a" width="600" height="190"></a></figure>        <p id="20f9acfd">消息文本分为以下几部分：</p>        <div class="table-wrapper"><table width="100%" id="aa558f54"><thead><tr id="31cb206a" class="ijRowHead"><th id="02cba299" width="20%"><p>零件</p></th><th id="e2d46a18"><p>描述</p></th></tr></thead><tbody><tr id="43a4471f" class="ijRowOdd"><td id="e4a91433"><p>提交消息文字</p></td><td id="90c01026"><p id="c694c057">仅将数字符号或插入号前面的字符串添加到VCS更改记录中。此文本不用作对此问题的评论。</p>                    <p id="c5512b47">提交消息文本可以换行并包含空行。</p></td></tr><tr id="87ff592f" class="ijRowEven"><td id="8101dee8"><p>指令</p></td><td id="6fc0f2dc"><p id="074c4c86">YouTrack会将数字符号（＃）或插入符号（^）识别为问题的标志，然后跟随命令。解析数字符号或插入号后面的字符以匹配问题ID。问题ID后面的任何字符串都将被解析为命令，直到当前行的末尾。如果命令的任何部分换行到下一行，则该命令将被截断。您可以通过以数字符号或插入号开头的新行来将附加命令应用于一个或多个问题。</p>                    <p id="b91ebcf0">如果字符串包含任何不正确的命令或属性引用，则不会应用该命令。该命令中的错误在VCS更改选项卡上突出显示。</p>                    <p id="b57f0760">有关YouTrack支持的命令的完整列表，请参阅《 <a href="Command-Reference.html">命令参考》</a> 。</p></td></tr><tr id="2b05c62a" class="ijRowOdd"><td id="a52d2a77"><p>发表评论文字</p></td><td id="f6686915"><p id="98d0fd47">如果为您的集成启用了“ <span class="control">分析提交问题的注释”</span>选项，则将命令复制到问题后作为新行添加的文本作为注释。您可以在命令之间添加多行文本。</p>                    <p id="4a5f9b68">如果在项目中禁用了此选项，则文本仅在VCS更改记录中可见。有关更多信息，请参见<a href="Add-a-Comment.html#add-comment-vcs-commits">从VCS提交生成注释</a> 。</p></td></tr><tr id="e37c5ec3" class="ijRowEven"><td id="db503a97"><p>问题编号</p></td><td id="14ef976e"><p>在提交消息中找到的任何问题ID都将转换为超链接。这包括为命令标记的问题以及在提交消息或问题注释文本中简单提及的问题。</p></td></tr></tbody></table></div>    </div>        <div class="chapter"><h2 id="update-multiple-issues" data-toc="Apply-Commands-in-VCS-Commits#update-multiple-issues">更新多个问题</h2>    <p id="0cc7847e">您还可以通过按括号中的ID对问题进行分组，将命令应用于多个问题。您不需要如此，因此可以为每个问题分别指定相同的命令。例如：</p>    <div class="code-block" data-lang="shell">（＃TST-12，＃TST-324，＃TST-433）已由john.d修订$ {revision}修复</div>    <p id="3a4f96b9">本示例中的命令适用于三个问题。发行状态设置为<span class="control">固定</span> ， <span class="control">审阅者</span>字段设置为<code class="code">john.d</code> 。“ <span class="control">版本”</span>字段的值会自动设置为当前版本。 <code class="code">${revision}</code>占位符。</p>    <p id="a25b52cd">下面的示例向您展示如何更新老板等问题。一条提交消息会立即应用所有这些更改：</p>    <ul class="list _ul"><li class="list__item" id="c4e99fa1"><p>对于问题TST-345，状态设置为<span class="control">固定</span> ，将检查更改的开发人员添加到“审阅<span class="control">者”</span>字段中，将TeamCity的修订号添加到“ <span class="control">修订”</span>字段中，并为该问题添加评论。</p></li><li class="list__item" id="c21be933"><p>对于问题TST-423和TST-348，状态设置为<span class="control">“进行中”，</span>并且对这两个问题都添加了注释。</p></li></ul>    <div class="code-block" data-lang="shell">通过此提交，我取得了以下进展：＃TST-345已修复，由daria.s修订$ {revision} @William_Johnson我终于修复了这个令人讨厌的错误！（＃TST-423，＃TST-348）正在进行中，我实现了代码来支持此用例，但需要描述测试步骤。</div>    </div>    <div class="chapter"><h2 id="vcs-commit-placeholders" data-toc="Apply-Commands-in-VCS-Commits#vcs-commit-placeholders">占位符</h2>        <p id="6f71e6fe">您可以使用<code class="code">${revision}</code>提交消息中的占位符。占位符将替换为VCS提交的实际哈希。</p>        <p id="cbb31789">TeamCity集成支持用于构建属性的其他占位符。这些占位符用于自动应用到在YouTrack中分配了内部版本号的所有问题的命令。您不能在手动提交消息中使用这些其他占位符。有关更多信息，请参见<a href="Integration-with-TeamCity.html">TeamCity集成</a> 。</p>    </div>    <div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Command-Grammar.html">命令语法</a> <a class="navigation-links__next" href="Apply-Commands-over-Jabber.html">在Jabber上应用命令</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>