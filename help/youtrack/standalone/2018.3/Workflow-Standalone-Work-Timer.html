<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/help/app/v2/analytics.js"></script><meta charset="UTF-8"><meta name="robots" content="noindex"><title>Stopwatch-style Work Timer - Help | YouTrack Standalone</title><link rel="stylesheet" href="/help/app/v2/app.css"></head><body data-id="Workflow-Standalone-Work-Timer"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search YouTrack Standalone Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2018.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="false"><h1 data-toc="Workflow-Standalone-Work-Timer" id="Workflow-Standalone-Work-Timer.xml">Stopwatch-style Work Timer</h1>  <p id="11ef049d">This workflow enables a timer that tracks the amount of time spent working on an issue.  The behavior is similar to the <a href="Workflow-Work-Timer.html"><span>In Progress Work Timer</span></a>.    Instead of using the value for the <span class="control">State</span> to start and stop the timer, this workflow uses the values for an independent <span class="control">Timer</span> field.</p>  <p id="bdf4343c">Use this workflow when you want to track time spent working on an issue without affecting the value for the <span class="control">State</span> field.</p>  <div class="table-wrapper"><table class="left_header                 " width="100%" id="fbe70957"><tbody><tr id="c3000669" class="ijRowOdd"><th id="1378b5ab" width="20%"><p>Name</p></th><td id="53e78b8f"><p>@jetbrains/youtrack-workflow-standalone-work-timer</p></td></tr><tr id="3299220b" class="ijRowEven"><th id="ac0999f6"><p>Previous Title</p></th><td id="1be1ae3f"><p>Standalone Work Timer</p></td></tr><tr id="08213741" class="ijRowOdd"><th id="2f5cd9f8"><p>Auto-attached</p></th><td id="7ad0ff59"><p>no</p></td></tr><tr id="06a13148" class="ijRowEven"><th id="bf0e7033"><p>Modules</p></th><td id="a6496bbc"><p>        <a href="#start-timer">Start timer when the value for "Timer" becomes "Start"</a>        (on-change rule)        <br>        <a href="#stop-timer">Stop timer when the value for "Timer" becomes "Stop"</a>        (on-change rule)      </p></td></tr></tbody></table></div>  <section class="procedure-steps"><h2 id="b3e32be5">To enable this workflowÇ</h2><ol class="list _decimal"><li class="list__item" id="72fc5b63"><p>Enable and configure time tracking for your project.    For instructions, see <a href="Enable-and-Configure-Time-Tracking.html"><span>Enable Time Tracking</span></a>.</p></li><li class="list__item" id="77b8df4f">Add a field that stores an <code class="code" data-lang="Java">enum</code> type with the name <span class="control">Timer</span> to your project.      <ul class="list _ul"><li class="list__item" id="539514c4"><p>Configure the field to store a single value.</p></li><li class="list__item" id="af40dc74"><p>Configure the field to allow an empty value.</p></li><li class="list__item" id="b8e83d61"><p>Add the values <span class="control">Start</span> and <span class="control">Stop</span> to the field.</p></li></ul>    </li><li class="list__item" id="38633b28"><p>Add a field that stores a <code class="code" data-lang="Java">date and time</code> type with the name <span class="control">Timer time</span> to your project.    </p></li><li class="list__item" id="0b575bec"><p>Attach the <span class="control">Stopwatch-style Work Timer</span> workflow to your project.    </p></li></ol></section>  <div class="chapter"><h2 id="f57c08ef">Use Case</h2>    <p id="fa951586">This workflow enables a timer that you can use to track the amount of time you spend working on an issue.      When you stop the timer, the elapsed time is automatically added to the issue as a work item.</p>    <ol class="list _decimal"><li class="list__item" id="4797d45b">When you start working on an issue, set the value of the <span class="control">Timer</span> field to <span class="control">Start</span>.      <ul class="list _ul"><li class="list__item" id="53056b42"><p>The workflow displays the message: <span class="control">The timer is started.</span></p></li><li class="list__item" id="8ef66f0b"><p>The value for the <span class="control">Timer time</span> field is set to the current date and time.</p></li></ul></li><li class="list__item" id="c1cd9bdb"><p>Continue working as you would with any other issue. Try to avoid distractions — the clock is ticking!</p></li><li class="list__item" id="76c20c74">When you have completed your work, change the value of the <span class="control">Timer</span> field to <span class="control">Stop</span>.        <ul class="list _ul"><li class="list__item" id="a54dc2cc"><p>The workflow displays the message: <span class="control">Work time added.</span></p></li><li class="list__item" id="e8b573ae"><p>A work item is added to the issue.</p></li></ul></li></ol>    <p id="9e8289f9">Each work item is assigned the following values:</p>    <ul class="list _ul"><li class="list__item" id="82593296"><p>The current user is set as the work author.</p></li><li class="list__item" id="9eb12530"><p>The work date is set to the current date with the <code class="code" data-lang="Java">Date.now()</code> method.</p></li><li class="list__item" id="f1b17509"><p>The comment is set to: <span class="control">The work item automatically added by the timer.</span></p></li><li class="list__item" id="4dd365dd"><p>The spent time is calculated based on the difference between the value for the <span class="control">Timer time</span> field and the current date and time.</p></li></ul>    <p id="c83e637b">The workflow does not assign a work type to work items.    If you want to add a specific work type programmatically, you can modify the on-change rule that stops the timer and generates the work item.    For an example, see the suggested customization for the <a href="#stop-timer">Stop timer when the value for "Timer" becomes "Stop"</a> rule.</p>  </div>  <div class="chapter"><h2 id="99484fa5">Modules</h2>    <p id="9c39643b">This workflow includes two modules.</p>    <div class="chapter"><h3 id="start-timer">Start timer when the value for "Timer" becomes "Start"</h3>      <p id="d74a71a3">The first module contains an on-change rule that starts the timer.</p>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">workflow</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/workflow&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Start timer when the value for &quot;Timer&quot; becomes &quot;Start&quot;&#39;</span><span class="p">),</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">becomes</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">Timer</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">Timer</span><span class="p">.</span><span class="nx">Start</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">TimerTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
    <span class="nx">workflow</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;The timer is started.&#39;</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">Timer</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">EnumField</span><span class="p">.</span><span class="nx">fieldType</span><span class="p">,</span>
      <span class="nx">Start</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="nx">TimerTime</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Field</span><span class="p">.</span><span class="nx">dateType</span><span class="p">,</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Timer time&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>      <p id="35fd0401">The second module contains an on-change rule that stops the timer. The elapsed time is added to the issue as a work item.</p>    </div>    <div class="chapter"><h3 id="stop-timer">Stop timer when the value for "Timer" becomes "Stop"</h3>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">workflow</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/workflow&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Stop timer when the value for &quot;Timer&quot; becomes &quot;Stop&quot;&#39;</span><span class="p">),</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">becomes</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">Timer</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">Timer</span><span class="p">.</span><span class="nx">Stop</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">TimerTime</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">oldValue</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">Timer</span><span class="p">).</span><span class="nx">name</span> <span class="o">===</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">Timer</span><span class="p">.</span><span class="nx">Start</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">newWorkItem</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">description</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;The work item automatically added by the timer.&#39;</span><span class="p">),</span>
        <span class="nx">date</span><span class="o">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
        <span class="nx">author</span><span class="o">:</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">currentUser</span><span class="p">,</span>
        <span class="nx">duration</span><span class="o">:</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">intervalToWorkingMinutes</span><span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">TimerTime</span><span class="p">,</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
      <span class="p">};</span>
      <span class="nx">issue</span><span class="p">.</span><span class="nx">addWorkItem</span><span class="p">(</span><span class="nx">newWorkItem</span><span class="p">);</span>
      <span class="nx">workflow</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Work time added&#39;</span><span class="p">));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">workflow</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Looks like the timer hasn\&#39;t been started.&#39;</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">Timer</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">EnumField</span><span class="p">.</span><span class="nx">fieldType</span><span class="p">,</span>
      <span class="nx">Stop</span><span class="o">:</span> <span class="p">{},</span>
      <span class="nx">Start</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="nx">TimerTime</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Field</span><span class="p">.</span><span class="nx">dateType</span><span class="p">,</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Timer time&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>      <p id="72c8ccf5">The default workflow doesn't set a value for the work type.      If you want to set a default work type for work items that are generated by this workflow, you can customize this rule.</p>      <p id="66e262a6">The following code shows an alternative approach for setting the <code class="code" data-lang="Java">action</code> property.        Here, the <code class="code" data-lang="Java">workItemType</code> variable finds the work item type in the current project with the name <span class="control">Development</span> and adds it to the work item.</p>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">oldValue</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">Timer</span><span class="p">).</span><span class="nx">name</span> <span class="o">===</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">Timer</span><span class="p">.</span><span class="nx">Start</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">workItemType</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">WorkItemType</span><span class="p">.</span><span class="nx">findByProject</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">project</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">workType</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">workType</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;Development&#39;</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="kd">var</span> <span class="nx">newWorkItem</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">description</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;The work item automatically added by the timer.&#39;</span><span class="p">),</span>
      <span class="nx">date</span><span class="o">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
      <span class="nx">author</span><span class="o">:</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">currentUser</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">workItemType</span><span class="p">,</span>
      <span class="nx">duration</span><span class="o">:</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">intervalToWorkingMinutes</span><span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">TimerTime</span><span class="p">,</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
    <span class="p">};</span>
    <span class="nx">issue</span><span class="p">.</span><span class="nx">addWorkItem</span><span class="p">(</span><span class="nx">newWorkItem</span><span class="p">);</span>
    <span class="nx">workflow</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Work time added&#39;</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">workflow</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Looks like the timer hasn\&#39;t been started.&#39;</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">},</span></code></div>    </div>  </div><div class="last-modified" data-skip-index="skip">Last modified: 7 March 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="slack-notifications-workflow.html">Slack Notifications</a><a class="navigation-links__next" href="Workflow-Subsystem-Assignee.html">Subsystem Assignee</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/help/app/v2/app.js"></script></body></html>