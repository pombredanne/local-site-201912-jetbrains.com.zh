<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta name="robots" content="noindex"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/help/app/v2/analytics.js"></script><meta charset="UTF-8"><title>Enhance Helpdesk Support - Help | YouTrack Standalone</title><link rel="stylesheet" href="/help/app/v2/app.css"></head><body data-id="enhance-helpdesk-support-workflows"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search YouTrack Standalone Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2018.4 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="false"><h1 data-toc="enhance-helpdesk-support-workflows" id="enhance-helpdesk-support-workflows.xml">Enhance Helpdesk Support</h1>    <p id="944e8035">YouTrack provides three main features that let you use it as a helpdesk:</p>    <ul class="list _ul"><li class="list__item" id="973edeb3"><p>The <a href="Mailbox-Integration.html"><span>Mailbox Integration</span></a>, which pulls email messages from one or more email servers on a regular basis and processes them to create issues and comments.</p></li><li class="list__item" id="44914920"><p><a href="enable-email-notifications.html">Email Notifications</a>, which let you send messages to any email address.</p></li><li class="list__item" id="a4610137"><p>And, of course, Workflows, which help you glue it all together!</p></li></ul>  <p id="3f01013a">The basic flow that is supported in YouTrack works as follows:</p>  <ul class="list _ul"><li class="list__item" id="e88bca3c"><p>A customer sends an email message to your support inbox. This creates a new issue in YouTrack.</p></li><li class="list__item" id="bfd94cbc"><p>A support engineer responds to the inquiry by adding a comment to the issue. This generates an email notification that is sent back to the customer as a reply to the original email.</p></li><li class="list__item" id="635d13c2"><p>The custom replies to the email notification. The response is processed by YouTrack and added as a comment to the original issue.</p></li></ul>  <p id="4be6c7c4">You can find a detailed description of this feature in our <a href="Use-YouTrack-as-a-Help-Desk.html">Helpdesk Tutorial</a>.</p>  <div class="chapter"><h2 id="support-service-level-agreements" data-toc="enhance-helpdesk-support-workflows#support-service-level-agreements">Support Service-level Agreements</h2>    <p id="cb75bcd0">An important element for an established product support team is the service-level agreement (SLA).      This helps set the customers’ expectations for receiving an answer to their requests and comments.</p>    <p id="ab94f050">Consider an SLA with the following rules:</p>    <ul class="list _ul"><li class="list__item" id="dfefa6fc"><p>Business hours are from 10:00 – 18:00 CET.</p></li><li class="list__item" id="7ac87847"><p>Customers can expect a response to their initial support request within three hours.</p></li><li class="list__item" id="1c265bd9"><p>The response time for a follow-up request is four hours.</p></li></ul>    <p id="e6373fc5">You can support an SLA in YouTrack with a workflow. In YouTrack, we’ll customize the setup for our helpdesk project as follows:</p>    <ul class="list _ul"><li class="list__item" id="95b50ba4">The project that we use for the helpdesk uses the following values for the State field:      <div class="table-wrapper"><table class="                 " width="100%" id="6617d8a7"><thead><tr id="f3a23883" class="ijRowHead"><th id="b274fdb4" width="20%"><p>Value</p></th><th id="0dca0b02"><p>Description</p></th></tr></thead><tbody><tr id="b789a0ec" class="ijRowOdd"><td id="9cde04fc"><p>New</p></td><td id="d9d15cd7"><p>Default value. Assigned to tickets upon creation.</p></td></tr><tr id="6fb9487c" class="ijRowEven"><td id="2a77baed"><p>Open</p></td><td id="a40487fc"><p>Assigned to tickets that are waiting for a reaction from the support team.</p></td></tr><tr id="2e8cd23b" class="ijRowOdd"><td id="5bc09b60"><p>Pending</p></td><td id="2074dee9"><p>Assigned to tickets that are waiting for a reaction from the customer.</p></td></tr><tr id="04f818dc" class="ijRowEven"><td id="40b4e831"><p>On hold</p></td><td id="e353c823"><p>Used for tickets that require input from a developer.</p></td></tr><tr id="05178a22" class="ijRowOdd"><td id="851bc43f"><p>Fixed</p></td><td id="85146b82"><p>Assigned to resolved tickets.</p></td></tr></tbody></table></div></li><li class="list__item" id="d4a9c54c"><p>For <span class="control">New</span> tickets that have not been answered by the support team, the <span class="control">Overdue</span> tag is added three business hours after the issue was created.</p></li><li class="list__item" id="039e278a"><p>For <span class="control">Open</span> tickets, the <span class="control">Overdue</span> tag is added four business hours after the last comment from a customer was added.</p></li><li class="list__item" id="7750f348"><p>To sort tickets in the order that they should be answered, we add a private custom field: <span class="control">To reply before</span>. This field stores values as a date and time.</p></li></ul>    <p id="bff35ce7">When we set up these fields and attach the corresponding workflow rules, the support team can pull tickets from a queue that is ordered by response time using the following query:</p>    <div class="code-block" data-lang="Java"><code class="code-block__wrapper">State: Open, New sort by: {To reply before} asc</code></div>    <p id="31aa69a6">First, we need a utility function that defines our business hours. This is saved as a custom script with the name <code class="code" data-lang="Java">time-operations</code>.</p>    <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="c1">// Starting hour of the business day defined in the server time zone.</span>
<span class="kd">var</span> <span class="nx">START</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="c1">// Finishing hour of the business day defined in the server time zone.</span>
<span class="kd">var</span> <span class="nx">FINISH</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span>

<span class="c1">// Length of the business day in hours.</span>
<span class="kd">var</span> <span class="nx">BUSINESS_DAY_LENGTH</span> <span class="o">=</span> <span class="nx">FINISH</span> <span class="o">-</span> <span class="nx">START</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">HOUR_IN_MS</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">DAY_IN_MS</span> <span class="o">=</span> <span class="mi">24</span> <span class="o">*</span> <span class="nx">HOUR_IN_MS</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm">  * @param {Date} [date] date to check to be inside business hours interval</span>
<span class="cm">  * @return {boolean} `true` is the date is within [START, FINISH) interval on</span>
<span class="cm">  * business days and `false` otherwise</span>
<span class="cm">*/</span>
<span class="kd">var</span> <span class="nx">isWithinBusinessHours</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">date1</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">dayOfWeek</span> <span class="o">=</span> <span class="nx">date1</span><span class="p">.</span><span class="nx">getDay</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">dayOfWeek</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">dayOfWeek</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kd">var</span> <span class="nx">hour</span> <span class="o">=</span> <span class="nx">date1</span><span class="p">.</span><span class="nx">getHours</span><span class="p">();</span>
  <span class="k">return</span> <span class="p">(</span><span class="nx">hour</span> <span class="o">&gt;=</span> <span class="nx">START</span> <span class="o">&amp;&amp;</span> <span class="nx">hour</span> <span class="o">&lt;</span> <span class="nx">FINISH</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm">  * @param {Number} [date] date in ms from the start of the epoch</span>
<span class="cm">  * @param {Number} [hours] number of hours to add to this date</span>
<span class="cm">  * @returns {Number} resulting date with respect to business hours, defined above</span>
<span class="cm">*/</span>
<span class="kd">var</span> <span class="nx">addBusinessHours</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">date</span><span class="p">,</span> <span class="nx">hours</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">date</span> <span class="o">+</span> <span class="nx">hours</span> <span class="o">*</span> <span class="nx">HOUR_IN_MS</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isWithinBusinessHours</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">result</span><span class="p">)))</span> <span class="p">{</span>
    <span class="c1">// It&#39;s evening, let&#39;s skip the night.</span>
    <span class="nx">result</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">24</span> <span class="o">-</span> <span class="nx">BUSINESS_DAY_LENGTH</span><span class="p">)</span> <span class="o">*</span> <span class="nx">HOUR_IN_MS</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isWithinBusinessHours</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">result</span><span class="p">)))</span> <span class="p">{</span>
    <span class="c1">// It&#39;s the weekend, let&#39;s skip it too.</span>
    <span class="nx">result</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nx">DAY_IN_MS</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">addBusinessHours</span> <span class="o">=</span> <span class="nx">addBusinessHours</span><span class="p">;</span></code></div>    <p id="d80689ff">Now, we can set the value of the <span class="control">To reply before</span> field according to our SLA.      The first rule is for the initial response:</p>    <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">timeOp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./time-operations&#39;</span><span class="p">);</span>

<span class="c1">// Number of business hours to reply to the new issue.</span>
<span class="kd">var</span> <span class="nx">NEW_ISSUE_SLA</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;New Issue SLA&#39;</span><span class="p">,</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">becomesReported</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">ToReply</span> <span class="o">=</span> <span class="nx">timeOp</span><span class="p">.</span><span class="nx">addBusinessHours</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span> <span class="nx">NEW_ISSUE_SLA</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">ToReply</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Field</span><span class="p">.</span><span class="nx">dateTimeType</span><span class="p">,</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;To reply before&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    <p id="1e5975e7">The second rule is for the follow-up:</p>    <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">timeOp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./time-operations&#39;</span><span class="p">);</span>

<span class="c1">// Number of business hours to reply to the replied issue.</span>
<span class="kd">var</span> <span class="nx">REPLIED_ISSUE_SLA</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Replied Issue SLA&#39;</span><span class="p">,</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">comments</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">comments</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">comments</span><span class="p">.</span><span class="nx">added</span><span class="p">.</span><span class="nx">isNotEmpty</span><span class="p">()</span> <span class="o">&amp;&amp;</span>
      <span class="nx">comments</span><span class="p">.</span><span class="nx">added</span><span class="p">.</span><span class="nx">last</span><span class="p">().</span><span class="nx">author</span><span class="p">.</span><span class="nx">login</span> <span class="o">===</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">helpdeskBot</span><span class="p">.</span><span class="nx">login</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">ToReply</span> <span class="o">=</span> <span class="nx">timeOp</span><span class="p">.</span><span class="nx">addBusinessHours</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span> <span class="nx">REPLIED_ISSUE_SLA</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">ToReply</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Field</span><span class="p">.</span><span class="nx">dateTimeType</span><span class="p">,</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;To reply before&#39;</span>
    <span class="p">},</span>
    <span class="c1">// This is the user which is set as reporter in mail rule settings:</span>
    <span class="nx">helpdeskBot</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">User</span><span class="p">,</span>
      <span class="nx">login</span><span class="o">:</span> <span class="s1">&#39;helpdesk-bot&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    <p id="23e0ec5b">The following rule adds the <span class="control">Overdue</span> tag to tickets when the SLA is violated:</p>    <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onSchedule</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Set “Overdue” tag&#39;</span><span class="p">,</span>
  <span class="nx">cron</span><span class="o">:</span> <span class="s1">&#39;0 * * * * ?&#39;</span><span class="p">,</span>
  <span class="nx">search</span><span class="o">:</span> <span class="s1">&#39;State: Open, New has: {To reply before} tag: -overdue&#39;</span><span class="p">,</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">toReply</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">ToReply</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">toReply</span> <span class="o">&lt;</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span> <span class="p">{</span>
      <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">addTag</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">overdue</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">ToReply</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Field</span><span class="p">.</span><span class="nx">dateTimeType</span><span class="p">,</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;To reply before&#39;</span>
    <span class="p">},</span>
    <span class="nx">overdue</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">IssueTag</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    <p id="4da0b01f">And finally, we clear the value from the <span class="control">To reply before</span> field and remove the <span class="control">Overdue</span> tag when the ticket no longer requires a response from the support team:</p>    <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Clear &quot;To reply before&quot; field and remove “Overdue” tag when issue is not “New” or “Open”&#39;</span><span class="p">,</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">isChanged</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">State</span> <span class="o">&amp;&amp;</span>
      <span class="nx">fs</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">name</span> <span class="o">!==</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">New</span><span class="p">.</span><span class="nx">name</span> <span class="o">&amp;&amp;</span>
      <span class="nx">fs</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">name</span> <span class="o">!==</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">Open</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>
    <span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">ToReply</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">hasTag</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">overdue</span><span class="p">.</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">issue</span><span class="p">.</span><span class="nx">removeTag</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">overdue</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">State</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">fieldType</span><span class="p">,</span>
      <span class="nx">Open</span><span class="o">:</span> <span class="p">{},</span>
      <span class="nx">New</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="nx">ToReply</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Field</span><span class="p">.</span><span class="nx">dateTimeType</span><span class="p">,</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;To reply before&#39;</span>
    <span class="p">},</span>
    <span class="nx">overdue</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">IssueTag</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    <p id="544a9e8d">You can apply additional logic to these rules depending on the terms of your support SLA, for example:</p>    <ul class="list _ul"><li class="list__item" id="7c80bf8b"><p>You can assign priorities to each ticket and change the SLA response times based on the priority.</p></li><li class="list__item" id="3666ef76"><p>You can set up a state machine to restrict the legal transitions between values for the <span class="control">State</span> field.</p></li><li class="list__item" id="d3d07ab8"><p>If you have an international team that works in different time zones and business hours, you can tune the <code class="code" data-lang="Java">time-operations</code> script to take these into account for each member of the support team.</p></li></ul>  </div>  <div class="chapter"><h2 id="assign-tickets-round-robin-rotations" data-toc="enhance-helpdesk-support-workflows#assign-tickets-round-robin-rotations">Assign Tickets with a Round-robin Rotation</h2>    <p id="dd8fa6f6">Another popular helpdesk practice is to assign new tickets based on a round-robin scheme.      This balances the workload between members of the support team.      The idea is simple — whenever a new ticket appears, it is assigned to the team member who is assigned the fewest <span class="control">New</span> and <span class="control">Open</span> tickets.</p>    <p id="8efe3859">The implementation is straight-forward.      When a new ticket is created, the workflow rule checks the workload of each support engineer.      The member of the team with the fewest tickets is selected as the assignee.</p>    <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">search</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/search&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Set Assignee automatically via Round Robin scheme&#39;</span><span class="p">,</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">becomesReported</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Assignee</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">assignees</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">Assignee</span><span class="p">.</span><span class="nx">values</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numbers</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">assignees</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">assignee</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">numbers</span><span class="p">[</span><span class="nx">assignee</span><span class="p">.</span><span class="nx">login</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">issues</span> <span class="o">=</span> <span class="nx">search</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">project</span><span class="p">,</span> <span class="s1">&#39;#unresolved has: Assignee&#39;</span><span class="p">);</span>
    <span class="nx">issues</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">issue</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">numbers</span><span class="p">[</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Assignee</span><span class="p">.</span><span class="nx">login</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">min</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">.</span><span class="nx">MAX_VALUE</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nx">assignees</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">assignee</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">numbers</span><span class="p">[</span><span class="nx">assignee</span><span class="p">.</span><span class="nx">login</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nx">min</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">min</span> <span class="o">=</span> <span class="nx">numbers</span><span class="p">[</span><span class="nx">assignee</span><span class="p">.</span><span class="nx">login</span><span class="p">];</span>
        <span class="nx">user</span> <span class="o">=</span> <span class="nx">assignee</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Assignee</span> <span class="o">=</span> <span class="nx">user</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">Assignee</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">fieldType</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    <p id="826e0a74">You can use this scheme not just for the helpdesk, but also for any process where you want to balance the workload.      Also, the rules for balancing new assignments can be much more complex.      For example, you can assign higher weights to overdue tickets.</p>  </div><div class="last-modified" data-skip-index="skip">Last modified: 8 March 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="generate-time-reports-workflow.html">Generate Time Reports</a><a class="navigation-links__next" href="send-internal-newsletters-workflow.html">Send Internal Newsletters</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/help/app/v2/app.js"></script></body></html>