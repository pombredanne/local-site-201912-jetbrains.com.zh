<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/help/app/v2/analytics.js"></script><meta charset="UTF-8"><meta name="robots" content="noindex"><title>Duplicates - Help | YouTrack Standalone</title><link rel="stylesheet" href="/help/app/v2/app.css"></head><body data-id="Workflow-Duplicates"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search YouTrack Standalone Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2017.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="false"><h1 data-toc="Workflow-Duplicates" id="Workflow-Duplicates.xml">Duplicates</h1>  <a name="Processing_Duplicates"></a>  <p id="7bf2da92">This workflow provides several options for managing duplicate issues.</p>  <div class="table-wrapper"><table class="left_header                 " width="100%" id="1f2ada4e"><tbody><tr id="195cfc2a" class="ijRowOdd"><th id="cde6ae81"><p>Name</p></th><td id="31711c76"><p>@jetbrains/youtrack-workflow-duplicates</p></td></tr><tr id="768ed2a3" class="ijRowEven"><th id="6cad5879"><p>Auto-attached</p></th><td id="d1268d37"><p>yes</p></td></tr><tr id="49e01513" class="ijRowOdd"><th id="95e423cc"><p>Modules</p></th><td id="da54307c"><p>        <a href="#tree-structure">Attach duplicate links to single duplicated issue</a>        (on-change rule)        <br>        <a href="#raise-priority">Raise priority when issue is duplicated by another issue</a>        (on-change rule)        <br>        <a href="#reopen-duplicate">Reopen issue when all duplicates links are removed</a>        (on-change rule)        <br>        <a href="#set-duplicate">Set state to "Duplicate" when duplicates link is added to issue</a>        (on-change rule)        <br>        <a href="#must-have-duplicate-link">Require links to duplicate issue when state becomes "Duplicate"</a>        (on-change rule)        <br>      </p></td></tr></tbody></table></div>  <div class="chapter"><h2 id="2748f784">Use Case</h2>    <p id="a620e5d8">This workflow supports several different use cases that help you automatically process duplicate issues.</p>    <ul class="list _ul"><li class="list__item" id="2675f09e"><p>Prevent users from deleting a <span class="control">duplicates</span> link from an issue in a <span class="control">Duplicate      </span> state.      </p></li><li class="list__item" id="7582259b"><p>Ensure that all issues with a <span class="control">Duplicate</span> state are linked to a duplicated issue.      </p></li><li class="list__item" id="bda16516"><p>Automatically change the issue state to <span class="control">Duplicate</span> when a <span class="control">duplicates</span> link        is added.      </p></li><li class="list__item" id="0a79303c"><p>Raise the priority of an issue when a <span class="control">duplicates</span> link is added.      </p></li><li class="list__item" id="beca46f1"><p>Attach <span class="control">duplicates</span> links to a single issue instead of creating duplicates of duplicate        issues.      </p></li></ul>  </div>  <div class="chapter"><h2 id="5ea9c354">Modules</h2>    <p id="80ef7518">This workflow includes several different rules that can be applied to manage duplicate issues.</p>    <div class="chapter"><h3 id="tree-structure">Attach duplicate links to single duplicated issue</h3>      <p id="1aba6e3d">The first rule automatically attaches duplicate issues to a single issue. This prevents users from creating a        duplicates 'tree' and        consolidates all duplicates links in a single issue.      </p>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">workflow</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/workflow&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Attach duplicate links to single duplicated issue&#39;</span><span class="p">),</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">.</span><span class="nx">duplicates</span><span class="p">.</span><span class="nx">isChanged</span> <span class="o">||</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="s1">&#39;is duplicated by&#39;</span><span class="p">].</span><span class="nx">isChanged</span> <span class="o">||</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">isChanged</span><span class="p">(</span><span class="s1">&#39;duplicateCluster&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">duplicateRoot</span> <span class="o">=</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">duplicateRoot</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">duplicateRoot</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">.</span><span class="nx">duplicates</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">issue</span> <span class="o">!==</span> <span class="nx">duplicateRoot</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">.</span><span class="nx">duplicates</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">duplicateRoot</span><span class="p">);</span>
        <span class="nx">duplicateRoot</span><span class="p">.</span><span class="nx">links</span><span class="p">.</span><span class="nx">duplicates</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">Duplicate</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">IssueLinkPrototype</span><span class="p">,</span>
      <span class="nx">outward</span><span class="o">:</span> <span class="s1">&#39;is duplicated by&#39;</span><span class="p">,</span>
      <span class="nx">inward</span><span class="o">:</span> <span class="s1">&#39;duplicates&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    </div>    <div class="chapter"><h3 id="raise-priority">Raise priority when issue is duplicated by another issue</h3>      <p id="d742883d">The next rule attempts to raise the priority of an issue when it is duplicated by one or more issues.        If a duplicate issue has a higher priority than the issue it duplicates, the priority of the original issue is        raised.      </p>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">workflow</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/workflow&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Raise priority when issue is duplicated by another issue&#39;</span><span class="p">),</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="s1">&#39;is duplicated by&#39;</span><span class="p">].</span><span class="nx">added</span><span class="p">.</span><span class="nx">isNotEmpty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Priority</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">currentPriorityOrdinal</span> <span class="o">=</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Priority</span><span class="p">.</span><span class="nx">ordinal</span><span class="p">;</span>
    <span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="s1">&#39;is duplicated by&#39;</span><span class="p">].</span><span class="nx">added</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">added</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">added</span><span class="p">.</span><span class="nx">project</span> <span class="o">!==</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">project</span> <span class="o">&amp;&amp;</span> <span class="nx">added</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">findFieldByName</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">Priority</span><span class="p">.</span><span class="nx">name</span><span class="p">).</span><span class="nx">values</span><span class="p">.</span><span class="nx">first</span> <span class="o">!==</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">Priority</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">first</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">added</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Priority</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">added</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Priority</span><span class="p">.</span><span class="nx">ordinal</span> <span class="o">&lt;</span> <span class="nx">currentPriorityOrdinal</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Priority</span> <span class="o">=</span> <span class="nx">added</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Priority</span><span class="p">;</span>
        <span class="nx">currentPriorityOrdinal</span> <span class="o">=</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">Priority</span><span class="p">.</span><span class="nx">ordinal</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">Priority</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">EnumField</span><span class="p">.</span><span class="nx">fieldType</span>
    <span class="p">},</span>
    <span class="nx">Duplicate</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">IssueLinkPrototype</span><span class="p">,</span>
      <span class="nx">outward</span><span class="o">:</span> <span class="s1">&#39;is duplicated by&#39;</span><span class="p">,</span>
      <span class="nx">inward</span><span class="o">:</span> <span class="s1">&#39;duplicates&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    </div>    <div class="chapter"><h3 id="reopen-duplicate">Reopen issue when all duplicates links are removed</h3>      <p id="4c1a63d6">The next rule automatically changes the issue state from <span class="control">Duplicate</span> to <span class="control">Open      </span> if there are no <span class="control">duplicates</span> links attached to the issue.      </p>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">workflow</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/workflow&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Reopen issue when all duplicates links are removed&#39;</span><span class="p">),</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">Duplicate</span><span class="p">.</span><span class="nx">name</span> <span class="o">&amp;&amp;</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">.</span><span class="nx">duplicates</span><span class="p">.</span><span class="nx">removed</span><span class="p">.</span><span class="nx">isNotEmpty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">.</span><span class="nx">duplicates</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">();</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">State</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">Open</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">State</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">fieldType</span><span class="p">,</span>
      <span class="nx">Duplicate</span><span class="o">:</span> <span class="p">{},</span>
      <span class="nx">Open</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="nx">Duplicate</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">IssueLinkPrototype</span><span class="p">,</span>
      <span class="nx">outward</span><span class="o">:</span> <span class="s1">&#39;is duplicated by&#39;</span><span class="p">,</span>
      <span class="nx">inward</span><span class="o">:</span> <span class="s1">&#39;duplicates&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    </div>    <div class="chapter"><h3 id="set-duplicate">Set state to "Duplicate" when duplicates link is added to issue</h3>      <p id="fb652620">The next rule automatically changes the issue state to <span class="control">Duplicate</span> when a user adds a <span class="control">        duplicates      </span> link.      </p>      <p id="537bd119">When an issue is updated, this rule checks that the list <span class="control">duplicates</span> links is not empty and        the state of this issue is not <span class="control">Duplicate</span>.        If a <span class="control">duplicates</span> link is added and the issue state is not <span class="control">Duplicate</span>, the        rule verifies that the user has permission to update the State field.        If the user has sufficient permission, the issue state is set to <span class="control">Duplicate</span>.      </p>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">workflow</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/workflow&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Set state to &quot;Duplicate&quot; when duplicates link is added to issue&#39;</span><span class="p">),</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">.</span><span class="nx">duplicates</span><span class="p">.</span><span class="nx">added</span><span class="p">.</span><span class="nx">isNotEmpty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">State</span> <span class="o">!==</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">Duplicate</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">canBeWrittenBy</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">currentUser</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">State</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">Duplicate</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">State</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">fieldType</span><span class="p">,</span>
      <span class="nx">Duplicate</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="nx">Duplicate</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">IssueLinkPrototype</span><span class="p">,</span>
      <span class="nx">outward</span><span class="o">:</span> <span class="s1">&#39;is duplicated by&#39;</span><span class="p">,</span>
      <span class="nx">inward</span><span class="o">:</span> <span class="s1">&#39;duplicates&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    </div>    <div class="chapter"><h3 id="must-have-duplicate-link">Require links to duplicate issue when state becomes "Duplicate"</h3>      <a name="Ensure_Duplicate_issue_has_links_to_Duplicated_issues_"></a>      <p id="cd0cfd2f">The next rule forces users to add a link to a duplicated issue when they change an issue state to <span class="control">        Duplicate</span>.      </p>      <p id="e7cca536">When issue is updated, this rule verifies that the issue state is changed to <span class="control">Duplicate</span>.        If the state is changed to <span class="control">Duplicate</span> and the list of duplicates-type links is empty, the user        is notified to add a link to a duplicated issue.      </p>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">workflow</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/workflow&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Require links to duplicate issue when state becomes &quot;Duplicate&quot;&#39;</span><span class="p">),</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">becomes</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">Duplicate</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">required</span><span class="p">(</span><span class="s1">&#39;duplicates&#39;</span><span class="p">,</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Add link to duplicate issue.&#39;</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">State</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">fieldType</span><span class="p">,</span>
      <span class="nx">Duplicate</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="nx">Duplicate</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">IssueLinkPrototype</span><span class="p">,</span>
      <span class="nx">outward</span><span class="o">:</span> <span class="s1">&#39;is duplicated by&#39;</span><span class="p">,</span>
      <span class="nx">inward</span><span class="o">:</span> <span class="s1">&#39;duplicates&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    </div>  </div>  <div class="last-modified" data-skip-index="skip">Last modified: 7 March 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Workflow-Due-Date.html">Due Date</a><a class="navigation-links__next" href="Workflow-Forgotten-Attachment.html">Forgotten Attachment</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/help/app/v2/app.js"></script></body></html>