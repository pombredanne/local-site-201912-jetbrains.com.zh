<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/help/app/v2/analytics.js"></script><meta charset="UTF-8"><meta name="robots" content="noindex"><title>Subtask Inherit Fix Versions - Help | YouTrack Standalone</title><link rel="stylesheet" href="/help/app/v2/app.css"></head><body data-id="Workflow-Subtask-Inherit-Fix-Versions"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search YouTrack Standalone Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2017.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="false"><h1 data-toc="Workflow-Subtask-Inherit-Fix-Versions" id="Workflow-Subtask-Inherit-Fix-Versions.xml">Subtask Inherit Fix Versions</h1>  <p id="d0797173">This workflow automatically updates the fix version of a subtask to the fix version set for a parent task.</p>  <div class="table-wrapper"><table class="left_header                 " width="100%" id="7355a299"><tbody><tr id="1f3bde84" class="ijRowOdd"><th id="46e3d47d"><p>Name</p></th><td id="ee9a42c3"><p>@jetbrains/youtrack-workflow-subtask-inherit-fix-versions</p></td></tr><tr id="5cb747c5" class="ijRowEven"><th id="450d43c8"><p>Auto-attached</p></th><td id="684883f6"><p>yes</p></td></tr><tr id="972a7f6e" class="ijRowOdd"><th id="76f7e488"><p>Modules</p></th><td id="7dfdf60a"><p>        <a href="#set-parent">Copy fix versions from parent task when issue is linked as a subtask</a>        (on-change rule)        <br>        <a href="#set-fix-versions">Set fix versions for subtasks when fix versions are added to parent task</a>        (on-change rule)<br>        <a href="#copy-values-script">copy-values.js</a> (custom script)      </p></td></tr></tbody></table></div>  <div class="chapter"><h2 id="72239f74">Use Case</h2>    <p id="1421f511">This workflow helps you manage the fix version set for tasks and subtasks.</p>    <p id="3a5dbcc6">This workflow updates the values that are stored in the <span class="control">Fix versions</span> custom field.      To use this workflow, you need to make sure this field is used in the projects that you want to update.      The option to store multiple values in the <span class="control">Fix versions</span> field must be enabled in all of the      projects that use this workflow.    </p>  </div>  <div class="chapter"><h2 id="a4530abe">Modules</h2>    <p id="73f96a63">This workflow includes the modules.    The first two modules contain on-change rules that synchronize the value set for the <span class="control">Fix verions</span> field between parent tasks and subtasks.    The third module contains a custom script that is shared by these rules.</p>    <div class="chapter"><h3 id="set-parent">Copy fix versions from parent task when issue is linked as a subtask</h3>      <p id="de559856">This rule checks a subtask when it is linked to a parent task.</p>      <ul class="list _ul"><li class="list__item" id="a27c421c"><p>If the subtask belongs to a different project from the parent task and the projects use different sets of          values for the <span class="control">Fix versions</span> field,          the fix versions are set for the parent task only.        </p></li><li class="list__item" id="79f957cc"><p>If the subtask and parent task belong to the same project, the fix versions assigned to the parent task are          set as the fix versions for any unresolved subtasks.        </p></li></ul>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">workflow</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/workflow&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">copy</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./copy-values&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Copy fix versions from parent task when issue is linked as a subtask&#39;</span><span class="p">),</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">!</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="s1">&#39;parent for&#39;</span><span class="p">].</span><span class="nx">added</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">();</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">safeSetFixVersions</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">subtask</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">subtask</span><span class="p">.</span><span class="nx">project</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">subtask</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">isArchived</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">subtask</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">key</span> <span class="o">===</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">key</span> <span class="o">||</span> <span class="nx">subtask</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">findFieldByName</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">FixVersions</span><span class="p">.</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">subtask</span><span class="p">.</span><span class="nx">isResolved</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">copy</span><span class="p">.</span><span class="nx">copyValues</span><span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">FixVersions</span><span class="p">,</span> <span class="nx">subtask</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">FixVersions</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span>

    <span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="s1">&#39;parent for&#39;</span><span class="p">].</span><span class="nx">added</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">safeSetFixVersions</span><span class="p">);</span>


  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">FixVersions</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">ProjectVersion</span><span class="p">.</span><span class="nx">fieldType</span><span class="p">,</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Fix versions&#39;</span><span class="p">,</span>
      <span class="nx">multi</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    </div>    <div class="chapter"><h3 id="set-fix-versions">Set fix versions for subtasks when fix versions are added to parent task</h3>      <p id="f3acef9f">The next rule checks for subtasks when the fix versions are set for an issue.</p>      <ul class="list _ul"><li class="list__item" id="38013b90"><p>If the subtasks are in an archived project or belong to a different project from the parent issue and the          projects use different sets of values for the <span class="control">Fix versions</span> field,          the fix versions are set for the parent task only.        </p></li><li class="list__item" id="fbbfebf8"><p>If the subtasks are in an active project and belong to the same project as the parent task, the fix versions          for each unresolved subtask are set to the fix versions that are set for the parent task.        </p></li></ul>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="kd">var</span> <span class="nx">entities</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/entities&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">workflow</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@jetbrains/youtrack-scripting-api/workflow&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">copy</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./copy-values&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">rule</span> <span class="o">=</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">Issue</span><span class="p">.</span><span class="nx">onChange</span><span class="p">({</span>
  <span class="nx">title</span><span class="o">:</span> <span class="nx">workflow</span><span class="p">.</span><span class="nx">i18n</span><span class="p">(</span><span class="s1">&#39;Set fix versions for subtasks when fix versions are added to parent task&#39;</span><span class="p">),</span>
  <span class="nx">guard</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">FixVersions</span><span class="p">.</span><span class="nx">added</span><span class="p">.</span><span class="nx">isNotEmpty</span><span class="p">();</span>
  <span class="p">},</span>
  <span class="nx">action</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">issue</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">issue</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">safeSetFixVersions</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">subtask</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">subtask</span><span class="p">.</span><span class="nx">project</span> <span class="o">&amp;&amp;</span> <span class="nx">subtask</span><span class="p">.</span><span class="nx">isReported</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">subtask</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">isArchived</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">subtask</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">key</span> <span class="o">===</span> <span class="nx">issue</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">key</span> <span class="o">||</span> <span class="nx">subtask</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">findFieldByName</span><span class="p">(</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">FixVersions</span><span class="p">.</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">subtask</span><span class="p">.</span><span class="nx">isResolved</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">copy</span><span class="p">.</span><span class="nx">copyValues</span><span class="p">(</span><span class="nx">issue</span><span class="p">.</span><span class="nx">fields</span><span class="p">.</span><span class="nx">FixVersions</span><span class="p">.</span><span class="nx">added</span><span class="p">,</span> <span class="nx">subtask</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">FixVersions</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">};</span>

     <span class="nx">issue</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="s1">&#39;parent for&#39;</span><span class="p">].</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">safeSetFixVersions</span><span class="p">);</span>

  <span class="p">},</span>
  <span class="nx">requirements</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">FixVersions</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">entities</span><span class="p">.</span><span class="nx">ProjectVersion</span><span class="p">.</span><span class="nx">fieldType</span><span class="p">,</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Fix versions&#39;</span><span class="p">,</span>
      <span class="nx">multi</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></code></div>    </div>    <div class="chapter"><h3 id="copy-values-script">copy-values.js</h3>      <p id="6a07d8e9">This module contains a custom script that is used in both of the rules for this workflow.</p>      <div class="code-block" data-lang="Javascript"><code class="code-block__wrapper"><span class="nx">exports</span><span class="p">.</span><span class="nx">copyValues</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">values</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">field</span> <span class="o">=</span> <span class="nx">to</span><span class="p">.</span><span class="nx">project</span><span class="p">.</span><span class="nx">findFieldByName</span><span class="p">(</span><span class="nx">field</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">to</span><span class="p">.</span><span class="nx">fields</span><span class="p">[</span><span class="nx">field</span><span class="p">.</span><span class="nx">name</span><span class="p">].</span><span class="nx">clear</span><span class="p">();</span>
    <span class="nx">values</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">it</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">version</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">findValueByName</span><span class="p">(</span><span class="nx">it</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">version</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">to</span><span class="p">.</span><span class="nx">fields</span><span class="p">[</span><span class="nx">field</span><span class="p">.</span><span class="nx">name</span><span class="p">].</span><span class="nx">add</span><span class="p">(</span><span class="nx">version</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span></code></div>    </div>  </div><div class="last-modified" data-skip-index="skip">Last modified: 7 March 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Workflow-Subtask-Inherit-Assignee.html">Subtask Inherit Assignee</a><a class="navigation-links__next" href="Workflow-Subtask-Inherit-Subsystem.html">Subtask Inherit Subsystem</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/help/app/v2/app.js"></script></body></html>