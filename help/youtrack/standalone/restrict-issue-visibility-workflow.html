<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>使用工作流限制问题的可见性-帮助|帮助YouTrack单机版</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="restrict-issue-visibility-workflow" data-breadcrumbs="Administration.xml|Administration/Workflow-Guide.xml|Workflows/Workflow-Use-Cases.xml|Use Cases for Workflows/restrict-issue-visibility-workflow.xml|Restrict Issue Visibility with Workflows" data-main-title="Restrict Issue Visibility with Workflows"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索YouTrack独立帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="restrict-issue-visibility-workflow.xml" data-toc="restrict-issue-visibility-workflow">限制工作流的问题可见性</h1>    <p id="ac346ceb">您可以在YouTrack中使用权限方案来限制对YouTrack中的问题的读取访问权限。在项目中具有<span class="control">创建问题</span>权限但没有<span class="control">读取问题</span>权限的用户只能看到他们自己创建的问题。但是，此设置非常二进制。用户可以只阅读和更新自己报告的问题，也可以访问项目中的所有问题。在现实生活中，情况通常要复杂得多。如果您希望某些人阅读和更新一些问题，不仅是他们创建的问题，而且是与他们共享的问题，会发生什么？</p>    <p id="c21fee0f">为了支持此用例，您可以授予报告者“ <span class="control">读取问题”的</span>权限，并使用工作流将问题的可见性自动限制在排除其他报告者的组中。以下工作流程规则会在报告问题后立即限制问题的可见性。</p>    <div class="code-block" data-lang="javascript">var实体= require（'@ jetbrains / youtrack-scripting-api / entities'）; var工作流程= require（'@ jetbrains / youtrack-scripting-api / workflow'）; Exports.rule =实体。Issue.onChange（{title：'在提交时将“可见到”组设置为'，警卫：function（ctx）{return ctx.issue.becomesReported;}，action：function（ctx）{ctx.issue.permittedGroups.add（ctx .viewers）；工作流程.message（“来自“'+ ctx.viewers.name +'”组的用户可以看到此请求。'）;}，要求：{观众：{类型：实体。UserGroup}}}）;</div>  <p id="186dc7f0">每个问题对其记者和任何成员可见<code class="code">Viewers</code>组。但是，记者或<code class="code">Viewers</code>组可以与项目中具有“ <span class="control">读取问题”</span>权限的任何其他用户“共享”该问题。要共享问题，用户从“ <span class="control">可见”</span>列表中选择另一个用户。</p>        <p id="107c1652">您可以使用多种其他方法来使用工作流来管理可见性。您可以考虑添加以下一项或多项规则，以提高整个方案的灵活性。</p>      <div class="chapter"><h2 id="add-mentioned-users" data-toc="restrict-issue-visibility-workflow#add-mentioned-users">添加提及的用户</h2>        <p id="0c7968f2">当在评论中@提及用户时，此规则会自动将用户添加到“ <span class="control">可见”</span>列表中。</p>        <div class="code-block" data-lang="javascript">var实体= require（'@ jetbrains / youtrack-scripting-api / entities'）; var工作流程= require（'@ jetbrains / youtrack-scripting-api / workflow'）; var loginRegex = /@(([[A-Z0-9._@$$\\-=|])*)/gi; Exports.rule =实体。Issue.onChange（{title：'将用户自动添加到“可见的”列表中”，警卫：function（ctx）{var issue = ctx.issue;返回issue.comments.added.isNotEmpty（）&&（issue.permittedGroups。 isNotEmpty（）|| issue.permittedUsers.isNotEmpty（））;}，操作：function（ctx）{var issue = ctx.issue; var text =''; issue.comments.added.forEach（function（comment）{text + = comment.text +'\ n';}）; var message =''; var matchs = text.match（loginRegex）; if（matches）{match.forEach（function（m）{var login = m.slice （1）; if（登录）{var user =实体。User.findByLogin（login）;如果（使用者）{issue.permittedUsers.add（使用者）;消息+ ='用户“'+ user.fullName +'”已添加到发行阅读器。'; } else {消息+ ='未登录的用户''+登录+'“。'; }}}）; } if（message）{工作流.message（message）; } }， 要求： {} }）;</div>      </div>      <div class="chapter"><h2 id="block-visibility-updates-reported-issues" data-toc="restrict-issue-visibility-workflow#block-visibility-updates-reported-issues">阻止对可见性设置的更新</h2>        <p id="e254338b">此规则阻止对已报告问题的“ <span class="control">可见”</span>设置进行更改。这可以防止对包含敏感数据的问题的可见性设置进行不必要的更改。</p>        <div class="code-block" data-lang="javascript">//此规则假定在报告问题时，将问题可见性设置为特定的组。//每个项目都有其自己的可见性组。var实体= require（'@ jetbrains / youtrack-scripting-api / entities'）; var工作流程= require（'@ jetbrains / youtrack-scripting-api / workflow'）; Exports.rule =实体。Issue.onChange（{title：'阻止更改为已报告问题的可见性组'，警卫：function（ctx）{var issue = ctx.issue; return issue.isReported &&！issue.becomesReported && issue.isChanged（'permittedGroups'）; }，操作：function（ctx）{working.check（false，'您不能更改已报告问题的组可见性限制。'+'相反，您可以将单个用户添加到“可见”列表。'）; }， 要求： {} }）;</div>      </div><div class="chapter"><h2 id="block-removing-other-users" data-toc="restrict-issue-visibility-workflow#block-removing-other-users">阻止用户删除其他用户</h2>      <p id="5a6f717a">此规则可防止用户从“可<span class="control">见到”</span>列表中删除其他用户。</p>        <div class="code-block" data-lang="javascript">var实体= require（'@ jetbrains / youtrack-scripting-api / entities'）; var工作流程= require（'@ jetbrains / youtrack-scripting-api / workflow'）; Exports.rule =实体。Issue.onChange（{title：'不要从“可见的”列表中删除用户”，警卫：function（ctx）{var issue = ctx.issue; return issue.permittedUsers.removed.isNotEmpty（）;}，操作：功能（ctx）{workflow.check（false，“您不能从“可见”列表中删除其他用户。'）; }， 要求： {} }）;</div></div>      <div class="chapter"><h2 id="field-based-visibility" data-toc="restrict-issue-visibility-workflow#field-based-visibility">更新分配的可见性</h2>      <p id="d9a6dcf2">在存储用户类型（例如，授权者或验证者）的自定义字段中选择用户后，此规则会自动将用户添加到“ <span class="control">可见”</span>列表中。</p>      <p id="b119623b">您还可以使用此规则的修改版本，以使敏感问题对项目团队的其他成员隐藏。例如，您的公司不希望会计师看到其他会计师处理的付款请求。在这里，您可以将用户设置为受让人时将其添加到“ <span class="control">可见”</span>列表中。</p>        <div class="code-block" data-lang="javascript">var实体= require（'@ jetbrains / youtrack-scripting-api / entities'）; var工作流程= require（'@ jetbrains / youtrack-scripting-api / workflow'）; Exports.rule =实体。Issue.onChange（{title：'将授权者添加到“可见的”列表中”，警卫：function（ctx）{var fs = ctx.issue.fields;返回fs.isChanged（ctx。AuthBy）&& fs。AuthBy; }，动作：function（ctx）{var issue = ctx.issue; issue.permittedUsers.add（issue.fields。AuthBy）; workflow.message（'问题现在对'+ issue.fields可见。AuthBy.fullName）; }，要求：{AuthBy：{类型：实体。User.fieldType，名称：“ Authorizer”}}}）；</div>      </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Workflow-Use-Cases.html">工作流用例</a> <a class="navigation-links__next" href="prevent-unwanted-updates-workflows.html">可防止不必要的更新</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>