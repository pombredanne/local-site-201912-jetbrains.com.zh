<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>从命令行配置内置TLS-帮助|帮助YouTrack单机版</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="server-tls-from-command-line" data-breadcrumbs="Installation-and-Upgrade.xml|Installation and Upgrade/secure-connection-for-youtrack-server.xml|Secure Connection for YouTrack Server/configure-server-tls-from-command-line.xml|Configure Built-in TLS from the Command Line" data-main-title="Configure Built-in TLS from the Command Line"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索YouTrack独立帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="configure-server-tls-from-command-line.xml" data-toc="server-tls-from-command-line">从命令行配置内置TLS</h1>    <p id="fb8522e4">本页上的说明向您显示如何使用命令行参数为现有安装配置内置TLS。</p>    <p id="01101239">使用命令行，可以在以下连接模式之间切换：</p>    <div class="table-wrapper"><table width="100%" id="f41a822f"><thead><tr id="55718810" class="ijRowHead"><th id="d2264ed5" width="20%"><p>模式</p></th><th id="9cdc3c0f"><p>描述</p></th></tr></thead><tbody><tr id="c69e6b5b" class="ijRowOdd"><td id="3307a04c"><p>HTTP</p></td><td id="10443a0c"><p id="17175000">默认的HTTP模式。TLS已禁用。</p>                <p id="b997ad51">HTTP模式仅适用于测试安装或通过SSL终止的反向代理服务器路由到YouTrack的连接时。</p></td></tr><tr id="b79fc650" class="ijRowEven"><td id="124b0568"><p>HTTPS</p></td><td id="4480be6f"><p id="4ca2852e">安全的HTTPS模式。启用了TLS。</p>                <p id="0f02ec47">配置参数使您可以使用以下文件格式保护服务器连接：</p>                <ul class="list _ul"><li class="list__item" id="4b6a9471"><p>包含<a href="https://en.wikipedia.org/wiki/Keystore" rel="noopener noreferrer" data-external="true" target="_blank">JKS</a>或<a href="https://en.wikipedia.org/wiki/PKCS_12" rel="noopener noreferrer" data-external="true" target="_blank">PKCS＃12</a>格式的私钥/证书数据的密钥库。</p></li><li class="list__item" id="e8ee5412"><p>私钥，证书和（可选）证书链作为<a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail" rel="noopener noreferrer" data-external="true" target="_blank">PEM</a>格式的单独文件。</p></li></ul>            </td></tr></tbody></table></div>    <p id="b501eeff">要切换模式，请停止YouTrack并运行<code class="code">configure</code>命令。您为命令中的每个参数指定的值定义了您选择的配置。有关详细说明以及每种配置的属性的完整列表，请参见下文。</p>    <div class="chapter"><h2 id="switch-to-http" data-toc="server-tls-from-command-line#switch-to-http">切换到HTTP模式</h2>        <p id="b9c3e84f">当您以纯HTTP模式运行YouTrack时，Web浏览器与服务器之间的连接无法通过SSL / TLS进行保护。YouTrack还经过优化，可以使用HTTP / 2协议，大多数服务器仅支持HTTPS连接。为了获得最佳性能，强烈建议您不要使用纯HTTP。</p>        <p id="bb7535b4">从HTTPS模式安全切换到HTTP的一种情况是修改服务器环境以使用SSL终止反向代理。在这种情况下，您可以将YouTrack切换为以HTTP模式运行。您可以配置反向代理来保护服务器流量并支持HTTP / 2连接，而不是使用内置TLS。</p>    <section class="procedure-steps"><h3 id="HTTP">要切换到HTTP模式：</h3><ol class="list _decimal"><li class="list__item" id="14e6f165"><p><a href="Stop-and-Start-YouTrack.html">停止YouTrack服务</a> 。</p></li><li class="list__item" id="e85e5027">            <p id="7da5be8c">输入以下命令：</p>            <div class="code-block" data-lang="none"><code class="code-block__wrapper"><youtrack>/bin/youtrack.sh configure \ --listen-port=8080 \ [--base-url=<new base URL>] \ --secure-mode=disable</code></div>            <p id="67db9b1b">如果由于切换到HTTP模式而导致服务器基本URL更改，请使用<code class="code">--base-url=<new base URL></code>参数以设置此值。</p>            <aside class="prompt" rel="67db9b1b" id="cbec37c1" data-type="note" data-title="">                <p id="3a608d54">更改基本URL时，需要在与安装集成的每个服务中重新注册YouTrack。这包括为第三方身份验证模块生成新的客户端ID和机密，以及为VCS集成生成访问令牌。</p>            </aside>            <p id="484ce22e">有关此命令中使用的参数的更多信息，请参阅“ <a href="#configure-properties">配置参数”</a> 。</p>        </li><li class="list__item" id="9fc05cc4"><p><a href="Stop-and-Start-YouTrack.html">启动YouTrack服务</a> 。</p></li></ol></section>    </div>    <div class="chapter"><h2 id="switch-to-https-secure-mode" data-toc="server-tls-from-command-line#switch-to-https-secure-mode">切换到HTTPS模式</h2>        <p id="d103c112">的<code class="code">configure</code>命令可让您从HTTP切换到HTTPS模式。要启用安全的HTTPS模式，您需要向YouTrack提供私钥和证书。您可以提供私钥和证书，如下所示：</p>        <ul class="list _ul"><li class="list__item" id="b98e62e5"><p>包含<a href="https://en.wikipedia.org/wiki/Keystore" rel="noopener noreferrer" data-external="true" target="_blank">JKS</a>或<a href="https://en.wikipedia.org/wiki/PKCS_12" rel="noopener noreferrer" data-external="true" target="_blank">PKCS＃12</a>格式的私钥/证书数据的密钥库。</p></li><li class="list__item" id="c35df0ff"><p>私钥，证书和（可选）证书链作为<a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail" rel="noopener noreferrer" data-external="true" target="_blank">PEM</a>格式的单独文件。</p></li></ul>        <p id="ce7c9da4">在开始之前，请将安全文件复制到YouTrack服务器可用的位置。</p>        <p id="d87609c7">的<code class="code">configure</code>该命令支持特定于这些文件类型的不同属性。请按照适用于您可用文件类型的过程进行操作。</p>        <p id="32bbb507">如果您已经配置了HTTPS，并且只想向您的YouTrack服务器应用新的证书和私钥，则也可以按照以下过程进行操作。</p>    <section class="procedure-steps"><h3 id="HTTPS-keystore">要使用SSL密钥库文件切换到HTTPS模式，请执行以下操作：</h3><ol class="list _decimal"><li class="list__item" id="b46bbda0"><p><a href="Stop-and-Start-YouTrack.html">停止YouTrack服务</a> 。</p></li><li class="list__item" id="226edeae">            <p id="fb74b1cc">运行以下命令：</p>            <div class="code-block" data-lang="none"><code class="code-block__wrapper"><youtrack>/bin/youtrack.sh configure \ --listen-port=443 \ [--base-url=<new base URL>] \ --secure-mode=tls \ --tls-server-cert-keystore-file=<path-to-keystore> \ --tls-server-cert-keystore-password=<keystore password> \ --tls-server-cert-keystore-key-alias=<private key entry alias> \ [--tls-server-cert-keystore-key-password=<private key entry password>] \ --tls-redirect-from-http=<[true|false]> \ [--tls-redirect-from-http-listen-port=8080]</code></div>            <ul class="list _ul"><li class="list__item" id="576d45f3"><p id="46a33d98">如果由于切换到HTTPS模式而导致服务器基本URL更改，请使用<code class="code">--base-url=<new base URL></code>参数以设置此值。</p>                    <aside class="prompt" rel="46a33d98" id="47a9de86" data-type="note" data-title="">                        <p id="4db9bb7c">更改基本URL时，需要在与安装集成的每个服务中重新注册YouTrack。这包括为第三方身份验证模块生成新的客户端ID和机密，以及为VCS集成生成访问令牌。</p>                    </aside>                </li><li class="list__item" id="ff2658a8"><p>如果从HTTP模式切换到HTTPS模式，则可以指定重定向侦听端口。此非安全端口接收所有HTTP请求，并将它们重定向到安全监听端口。为此，请使用<code class="code">tls-redirect-from-http=true</code>并为<code class="code">tls-redirect-from-http-listen-port=<your redirect port number></code>属性。</p></li></ul>            <p id="c2b5ca66">有关此命令中使用的参数的更多信息，请参阅“ <a href="#configure-properties">配置参数”</a> 。</p>        </li><li class="list__item" id="c19a2044"><p><a href="Stop-and-Start-YouTrack.html">启动YouTrack服务</a> 。</p></li></ol></section>    <section class="procedure-steps"><h3 id="HTTPS-privateKeyAndCert">要使用私钥和证书切换到HTTPS模式，请执行以下操作：</h3><ol class="list _decimal"><li class="list__item" id="7e02134e"><p><a href="Stop-and-Start-YouTrack.html">停止YouTrack服务</a> 。</p></li><li class="list__item" id="1f857930"><p id="df191c86">运行以下命令：</p>            <div class="code-block" data-lang="none"><code class="code-block__wrapper"><youtrack>bin/youtrack.sh configure \ --listen-port=443 \ [--base-url=<new base URL>] \ --secure-mode=tls \ --tls-server-cert-key-file=<path-to-private-key-file> \ --tls-server-cert-file=<path-to-certificate-file> \ [--tls-server-cert-chain-file=<path-to-certificate-chain-file>] \ --tls-redirect-from-http=<[true|false]> \ [--tls-redirect-from-http-listen-port=8080]</code></div>            <ul class="list _ul"><li class="list__item" id="6b44b735"><p>如果私钥已加密，请添加<code class="code">tls-server-cert-private-key-passphrase</code>属性以提供密钥的密码短语。</p></li><li class="list__item" id="21cc60bf"><p>如果要定义证书文件的相对路径，请使用<code class="code">tls-server-cert-key-file</code> ， <code class="code">tls-server-cert-file</code>和<code class="code">tls-server-cert-chain-file</code> 。设置附加值<code class="code">tls-server-cert-folder</code>属性以及目录的绝对路径。相对路径针对指定的绝对路径进行解析。</p></li><li class="list__item" id="cfca65b1"><p id="2ded1f99">如果由于切换到HTTPS模式而导致服务器基本URL更改，请使用<code class="code">--base-url=<new base URL></code>参数以设置此值。</p>                    <aside class="prompt" rel="2ded1f99" id="052e594a" data-type="note" data-title="">                        <p id="937e8056">更改基本URL时，需要在与安装集成的每个服务中重新注册YouTrack。这包括为第三方身份验证模块生成新的客户端ID和机密，以及为VCS集成生成访问令牌。</p>                    </aside>                </li><li class="list__item" id="99a20c82"><p>如果从HTTP模式切换到HTTPS模式，则可以指定重定向侦听端口。此非安全端口接收所有HTTP请求，并将它们重定向到安全监听端口。为此，请使用<code class="code">tls-redirect-from-http=true</code>并为<code class="code">tls-redirect-from-http-listen-port=<your redirect port number></code>属性。</p></li></ul>            <p id="52146893">有关此命令中使用的参数的更多信息，请参阅“ <a href="#configure-properties">配置参数”</a> 。</p>        </li><li class="list__item" id="e0e947de"><p><a href="Stop-and-Start-YouTrack.html">启动YouTrack服务</a> 。</p></li></ol></section>    </div>    <div class="chapter"><h2 id="configure-properties" data-toc="server-tls-from-command-line#configure-properties">配置参数</h2>    <p id="f87f910d">下表提供了可用于配置内置TLS的参数列表。</p>    <div class="table-wrapper"><table class=" wide" width="100%" id="a4c7a697"><thead><tr id="32015eb4" class="ijRowHead"><th id="c775b8b8" width="20%"><p>属性</p></th><th id="142ba902" width="20%"><p>值</p></th><th id="09277345"><p>描述</p></th></tr></thead><tbody><tr id="cf5c20c1" class="ijRowOdd"><td id="c4123608"><p>安全模式</p></td><td id="57bfa8ba"><p><code class="code">disable</code> |<code class="code">tls</code></p></td><td id="72081118"><p id="5721d595">应用于YouTrack服务器的连接模式。此属性支持以下值：</p>                <ul class="list _ul"><li class="list__item" id="26d2c01c"><p><code class="code">disable</code> — TLS被禁用。这是此属性的默认值。</p></li><li class="list__item" id="49948c76"><p><code class="code">tls</code> —启用了TLS。</p></li></ul>            </td></tr><tr id="adcdcadf" class="ijRowEven"><td id="18b17384"><p>监听端口</p></td><td id="706d1f48"></td><td id="130c418d"><p>YouTrack侦听HTTP流量的端口。</p></td></tr><tr id="04d66bd8" class="ijRowOdd"><td id="100b6434"><p>基本网址</p></td><td id="d09bbf9b"></td><td id="ab2f65a7"><p id="ec9402f8">最终用户请求访问您的YouTrack安装的URL。例如， <code class="code">https://youtrack.mydomain.com</code> 。</p>                <ul class="list _ul"><li class="list__item" id="b64b076d"><p>当值为<code class="code">secure-mode</code>财产是<code class="code">tls</code>或您的YouTrack安装在SSL终止的反向代理服务器后面受到保护，则网址应以<code class="code">https</code> 。</p></li><li class="list__item" id="dfc91d3d"><p>否则（使用纯HTTP运行YouTrack时），URL以<code class="code">http</code> 。</p></li></ul>            </td></tr><tr id="6c4ec712" class="ijRowEven"><td id="24c7b6da"><p>tls-redirect-from-http</p></td><td id="3b7a52c4"><p><code class="code">true</code> |<code class="code">false</code></p></td><td id="3f195170"><p id="5b64783c">设置为true，以启用其他端口（由属性定义） <code class="code">tls-redirect-from-http-listen-port</code> ）接受未加密的HTTP流量并将其重定向到该属性定义的安全端口<code class="code">listen-port</code> 。</p>                <p id="606111d3">默认值为<code class="code">false</code> 。</p></td></tr><tr id="5c851d34" class="ijRowOdd"><td id="bbcebd8a"><p>tls-redirect-from-http-listen-port</p></td><td id="723c1143"></td><td id="04a8907c"><p>指定其他端口以接受未加密的HTTP流量，并将其重定向到该属性定义的安全端口<code class="code">listen-port</code> （要启用此端口，请设置属性<code class="code">tls-redirect-from-http</code>至<code class="code">true</code> ）。</p></td></tr><tr id="73bdd06e" class="ijRowEven"><td id="af9ea518"><p>tls-server-cert-folder</p></td><td id="a7d000a6"></td><td id="36997f5d"><p id="219211ab">一个（可选）绝对路径，用于解析其他命令行参数定义的相对路径（如果存在）。根据该目录解析在其他属性中指定的服务器证书文件的相对路径。可以引用相对路径的属性是：</p>                <ul class="list _ul"><li class="list__item" id="b5855a53"><code class="code">tls-server-cert-key-file</code></li><li class="list__item" id="05ded596"><code class="code">tls-server-cert-file</code></li><li class="list__item" id="0d4a8ebd"><code class="code">tls-server-cert-chain-file</code></li><li class="list__item" id="11d26444"><code class="code">tls-server-cert-keystore-file</code></li></ul>            </td></tr><tr id="26691efc" class="ijRowOdd"><td id="394395e9"><p>tls-server-cert-keystore-file</p></td><td id="e6ce4587"></td><td id="c7c528e2"><p><a href="https://en.wikipedia.org/wiki/Keystore" rel="noopener noreferrer" data-external="true" target="_blank">JKS</a>或<a href="https://en.wikipedia.org/wiki/PKCS_12" rel="noopener noreferrer" data-external="true" target="_blank">PKCS＃12</a>格式的密钥库文件的位置。</p></td></tr><tr id="4adf1dc3" class="ijRowEven"><td id="dd1077fb"><p>tls-server-cert-keystore-password</p></td><td id="a8a02e08"></td><td id="8861756b"><p>密钥库完整性密码</p></td></tr><tr id="902357b6" class="ijRowOdd"><td id="a2d070e5"><p>tls-服务器-证书-密钥库-密钥别名</p></td><td id="ceac8269"></td><td id="b5ff47da"><p id="36f2f28f">密钥库中包含服务器证书和私钥的条目的别名。如果您的密钥库使用<a href="https://en.wikipedia.org/wiki/PKCS_12" rel="noopener noreferrer" data-external="true" target="_blank">PKCS＃12</a>格式，请遵循以下准则：</p>                <ul class="list _ul"><li class="list__item" id="07e97b37"><p>使用存储为<code class="code">friendlyName</code>在密钥库中。</p></li><li class="list__item" id="26f8ac2c"><p>如果私钥和证书对未标记为<code class="code">friendlyName</code>在生成期间，请使用此参数在密钥库中提供此对的序号。对于仅包含一个证书和私钥对的密钥库，请将值设置为<code class="code">1</code> 。</p></li></ul>            </td></tr><tr id="6669a3af" class="ijRowEven"><td id="ee051d32"><p>tls-server-cert-keystore-key-password</p></td><td id="069d0e17"></td><td id="9c0843bd"><p>用于保护服务器在密钥库中的私钥条目的密码。</p></td></tr><tr id="e9bd0c5c" class="ijRowOdd"><td id="c301e47f"><p>tls服务器证书密钥文件</p></td><td id="d4b98cd3"></td><td id="8200926a"><p>以<a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail" rel="noopener noreferrer" data-external="true" target="_blank">PEM</a>格式存储的私钥（ <a href="https://en.wikipedia.org/wiki/PKCS_1" rel="noopener noreferrer" data-external="true" target="_blank">PKCS＃1</a>或<a href="https://en.wikipedia.org/wiki/PKCS_8" rel="noopener noreferrer" data-external="true" target="_blank">PKCS＃8</a> ）文件的位置。</p></td></tr><tr id="226dd285" class="ijRowEven"><td id="be76b254"><p>tls-server-cert-file</p></td><td id="b1d9b4df"></td><td id="2b247d24"><p>证书文件的位置，以<a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail" rel="noopener noreferrer" data-external="true" target="_blank">PEM</a>格式存储。</p></td></tr><tr id="a7ae3299" class="ijRowOdd"><td id="b37d2e38"><p>tls服务器证书链文件</p></td><td id="6af9a360"></td><td id="3128cb91"><p>包含证书链的文件的（可选）位置，以<a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail" rel="noopener noreferrer" data-external="true" target="_blank">PEM</a>格式存储。</p></td></tr><tr id="eb188949" class="ijRowEven"><td id="d61f2fda"><p>tls-server-cert-private-key-passphrase</p></td><td id="170cefe3"><p>串</p></td><td id="9239ed9f"><p>如果您使用加密的私钥，则使用此属性提供用于加密的密码短语。同时支持<a href="https://en.wikipedia.org/wiki/PKCS_1" rel="noopener noreferrer" data-external="true" target="_blank">PKCS＃1</a>和<a href="https://en.wikipedia.org/wiki/PKCS_8" rel="noopener noreferrer" data-external="true" target="_blank">PKCS＃8</a>格式。</p></td></tr></tbody></table></div>    </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="configure-server-tls-configuration-wizard.html">在基于Web的配置向导中配置内置TLS在</a> <a class="navigation-links__next" href="switch-between-third-party-proxy-and-built-in-tls.html">第三方代理和内置TLS之间切换</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>