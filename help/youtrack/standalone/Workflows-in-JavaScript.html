<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>JavaScript工作流程参考-帮助|帮助YouTrack单机版</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Workflows-in-JavaScript" data-breadcrumbs="Administration.xml|Administration/Workflow-Guide.xml|Workflows/Workflows-in-JavaScript.xml|JavaScript Workflow Reference/rule-specific-properties.xml|Rule-specific Properties/context.xml|Context/requirements.xml|Requirements/using-workflow-api.xml|Using the Workflow API/Slack-Integration-HTML.xml|Building Integrations with Slack/JS-Workflow-REST-API.xml|Using REST API Methods in JavaScript Workflows/Workflow-Working-with-Dates-Times.xml|Working with Dates and Times/Workflow-Localization.xml|Localizing Workflow Messages/troubleshooting-workflows.xml|Troubleshooting Workflows/YouTrack-Api-Documentation.xml|YouTrack Workflow API/Workflow-Change-Log.xml|Change Log/v1-date-time.xml|date-time/v1-entities.xml|entities/v1-Agile.xml|Agile/v1-BaseComment.xml|BaseComment/v1-BaseEntity.xml|BaseEntity/v1-BaseWorkItem.xml|BaseWorkItem/v1-Build.xml|Build/v1-BundleProjectCustomField.xml|BundleProjectCustomField/v1-ChangesProcessor.xml|ChangesProcessor/v1-EnumField.xml|EnumField/v1-Field.xml|Field/v1-Fields.xml|Fields/v1-GroupProjectCustomField.xml|GroupProjectCustomField/v1-Issue.xml|Issue/v1-IssueAttachment.xml|IssueAttachment/v1-IssueComment.xml|IssueComment/v1-IssueLinkPrototype.xml|IssueLinkPrototype/v1-IssueTag.xml|IssueTag/v1-IssueWorkItem.xml|IssueWorkItem/v1-Iterator.xml|Iterator/v1-JsonForIssueAddAttachment.xml|JsonForIssueAddAttachment/v1-JsonForIssueAddComment.xml|JsonForIssueAddComment/v1-JsonForIssueAddWorkItem.xml|JsonForIssueAddWorkItem/v1-JsonForIssueConstructor.xml|JsonForIssueConstructor/v1-JsonForUserNotify.xml|JsonForUserNotify/v1-OwnedField.xml|OwnedField/v1-PeriodProjectCustomField.xml|PeriodProjectCustomField/v1-PersistentFile.xml|PersistentFile/v1-Project.xml|Project/v1-ProjectCustomField.xml|ProjectCustomField/v1-ProjectVersion.xml|ProjectVersion/v1-Requirement.xml|Requirement/v1-Requirements.xml|Requirements/v1-SavedQuery.xml|SavedQuery/v1-Set.xml|Set/v1-SimpleProjectCustomField.xml|SimpleProjectCustomField/v1-Sprint.xml|Sprint/v1-State.xml|State/v1-TeamcityBuildConfMapping.xml|TeamcityBuildConfMapping/v1-TeamcityServer.xml|TeamcityServer/v1-TextProjectCustomField.xml|TextProjectCustomField/v1-User.xml|User/v1-UserGroup.xml|UserGroup/v1-UserProjectCustomField.xml|UserProjectCustomField/v1-VcsChange.xml|VcsChange/v1-VcsServer.xml|VcsServer/v1-WatchFolder.xml|WatchFolder/v1-WorkItemType.xml|WorkItemType/v1-http.xml|http/v1-Connection.xml|Connection/v1-REQUEST_TYPES.xml|REQUEST_TYPES/v1-Response.xml|Response/v1-notifications.xml|notifications/v1-search.xml|search/v1-strings.xml|strings/v1-workflow.xml|workflow" data-main-title="JavaScript Workflow Reference"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索YouTrack独立帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Workflows-in-JavaScript.xml" data-toc="Workflows-in-JavaScript">JavaScript工作流程参考</h1>    <p id="b043fdf7">从YouTrack 2017.2开始，您不必使用特定于域的编程语言编写工作流。只需使用JavaScript！</p>    <p id="b93f455c">JavaScript可以说是当今世界上最流行的编程语言。如果您自己不熟悉它，那么您的组织中很有可能会流利。通过切换到JavaScript，我们希望比以往任何时候都可以更轻松地访问YouTrack的编写工作流。</p>    <p id="7b7ebb93">也就是说，要创建自己的工作流程，您确实需要编写一些代码。这需要对JavaScript有基本的了解。幸运的是，Web上有很多资源，其中最好的资源之一是<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" rel="noopener noreferrer" data-external="true" target="_blank">Mozilla基金会</a> ，后者继续监督该语言的开发。</p>    <p id="6a67e5d2">这也意味着在用JavaScript编写工作流时，您不需要做任何异常的事情。编写工作流程时，可以使用JavaScript支持的任何声明，变量，常量，数据类型，文字，函数，表达式和运算符。</p>    <p id="7ff165ab">本文档的这一部分提供了一些指南，可以帮助您了解如何使用工作流API特有的自定义属性和方法。有关功能，属性和方法的完整列表，请参阅<a href="YouTrack-Api-Documentation.html">YouTrack Workflow API</a> 。</p>    <div class="chapter"><h2 id="2018-updates" data-toc="Workflows-in-JavaScript#2018-updates">YouTrack 2018.1的更新</h2>        <p id="9649b987">我们的JavaScript实现基于<a href="https://github.com/mozilla/rhino" rel="noopener noreferrer" data-external="true" target="_blank">Rhino</a> 。对于2018.1版本，我们采用了Rhino版本1.7.7.2。这意味着此版本的Rhino支持的ES6 / JS2015的所有功能也可用于YouTrack中的工作流。</p>        <p id="e67a9913">主要变化包括：</p>        <ul class="list _ul"><li class="list__item" id="7b9f2d18"><p>支持许多ES6补充<code class="code">Math</code>类。</p></li><li class="list__item" id="a9169880"><p>支持许多ES6补充<code class="code">Number</code>类。</p></li><li class="list__item" id="c28b7548"><p>支持将ES6添加到<code class="code">String</code>类。</p></li><li class="list__item" id="30a8613d"><p>初步支持ES6方法定义。</p></li><li class="list__item" id="cdb218d4"><p>本地转换<code class="code">Error</code>实例转换为JSON。</p></li><li class="list__item" id="7cb94348"><p>的兼容性修复<code class="code">Date</code> ， <code class="code">Array</code>和<code class="code">String</code>等等。</p></li><li class="list__item" id="6f95afef"><p>方法支持<code class="code">Array.find()</code>和<code class="code">findIndex()</code> 。</p></li><li class="list__item" id="386e7c93"><p>方法支持<code class="code">String.trimLeft()</code>和<code class="code">trimRight()</code> 。</p></li><li class="list__item" id="5b87a3f8"><p>支持V8 <code class="code">Error</code>扩展，包括<code class="code">Error.captureStackTrace</code> 。</p></li><li class="list__item" id="6391e6c6"><p>支持类型化数组。</p></li><li class="list__item" id="e393eed5"><p>支持附加“外部数据”作为任何对象的索引属性。</p></li></ul>        <p id="7b48bf9a">若要查看ES5、6和7中的哪些高级JavaScript功能可用于YouTrack中的工作流程，请参阅<a href="http://mozilla.github.io/rhino/compat/engines.html" rel="noopener noreferrer" data-external="true" target="_blank">Rhino兼容性表</a> 。支持与<span class="control">rhino177</span>兼容的所有功能。</p>    </div>    <div class="chapter"><h2 id="major-changes-from-old-api" data-toc="Workflows-in-JavaScript#major-changes-from-old-api">与以前的工作流程编程语言相比的主要变化</h2>        <p id="94f99e36">切换到JavaScript会更改编写工作流时引用特定实体和属性的方式。以下是与以前的API相比的主要更改的简短列表：</p>        <ol class="list _decimal"><li class="list__item" id="dbe82c3b"><p>的<code class="code">issue</code>参考永远不会被省略。您不能假设问题引用方法是从上下文中引用问题的，而是必须显式引用问题。</p></li><li class="list__item" id="91d78e77">与属性相关的方法的拼写有所不同。而且，这些功能现在是属性。获取方法得到简化。<div class="table-wrapper"><table width="100%" id="f3ab3ae5"><thead><tr id="902d2db5" class="ijRowHead"><th id="80dbc0a5" width="50%"><p>基于MPS的API</p></th><th id="1be55767"><p>JavaScript API</p></th></tr></thead><tbody><tr id="f5cc8079" class="ijRowOdd"><td id="69293253">                            <code class="code">issue.becomesResolved(), issue.becomesReported()</code>                        </td><td id="475a011c">                            <code class="code">issue.becomesResolved, issue.becomesReported</code>                        </td></tr><tr id="576b44b5" class="ijRowEven"><td id="461064ff">                            <code class="code">issue.getId(), issue.getUrl()</code>                        </td><td id="088c8abc">                            <code class="code">issue.id, issue.url</code>                        </td></tr></tbody></table></div>            </li><li class="list__item" id="94345abf">与字段相关的关键字现在是方法。<div class="table-wrapper"><table width="100%" id="5eeec61a"><thead><tr id="4cedbe30" class="ijRowHead"><th id="8b6bbd35" width="50%"><p>基于MPS的API</p></th><th id="00e9a702"><p>JavaScript API</p></th></tr></thead><tbody><tr id="3c1d19f9" class="ijRowOdd"><td id="ba738690">                            <code class="code">X.required</code>                        </td><td id="2b821e44">                            <code class="code">issue.fields.required(ctx.X, <message>)</code>                        </td></tr><tr id="461b7382" class="ijRowEven"><td id="afc6de98">                            <code class="code">X.changed</code>                        </td><td id="27a11eb7">                            <code class="code">issue.fields.isChanged(ctx.X)</code>                        </td></tr><tr id="050f94b5" class="ijRowOdd"><td id="a0e31b51">                            <code class="code">X.becomes</code>                        </td><td id="cb2faa95">                            <code class="code">issue.fields.becomes(ctx.X, <ctx.X.value>)</code>                        </td></tr><tr id="6ad31e17" class="ijRowEven"><td id="31b43ee1">                            <code class="code">X.oldValue</code>                        </td><td id="5ba8f8b3">                            <code class="code">issue.fields.oldValue(ctx.X)</code>                        </td></tr></tbody></table></div>            </li><li class="list__item" id="3d911a62">全局关键字和警告声明已更改。<div class="table-wrapper"><table width="100%" id="9e392307"><thead><tr id="cea489d7" class="ijRowHead"><th id="6bc168e7" width="50%"><p>基于MPS的API</p></th><th id="117506b6"><p>JavaScript API</p></th></tr></thead><tbody><tr id="566546ad" class="ijRowOdd"><td id="951e698e">                            <code class="code">message</code>                        </td><td id="b2444f48"><p>                            <code class="code">workflow.message(<message>)</code> （请参阅“ @ jetbrains / youtrack-scripting-api / workflow”模块）</p></td></tr><tr id="f396c845" class="ijRowEven"><td id="67fd8f14">                            <code class="code">assert</code>                        </td><td id="2e682828"><p>                            <code class="code">workflow.check(<condition>, <message>)</code> （请参阅“ @ jetbrains / youtrack-scripting-api / workflow”模块）</p></td></tr><tr id="f1e32100" class="ijRowOdd"><td id="a014054d">                            <code class="code">loggedInUser</code>                        </td><td id="3c160894">                            <code class="code">ctx.currentUser</code>                        </td></tr><tr id="ca8e4bc7" class="ijRowEven"><td id="6869cbc8">                            <code class="code">now</code>                        </td><td id="2cb61728"><p>                            <code class="code">Date.now()</code> （标准JS日期API）</p></td></tr></tbody></table></div>            </li><li class="list__item" id="58cbf808">某些方法已完全更改：<div class="table-wrapper"><table width="100%" id="2d82a9e7"><thead><tr id="a3241ed1" class="ijRowHead"><th id="89a68008" width="50%"><p>基于MPS的API</p></th><th id="2767ff6a"><p>JavaScript API</p></th></tr></thead><tbody><tr id="9fb614d2" class="ijRowOdd"><td id="01cad8a5">                            <code class="code">loggedInUser.createNewIssue(<project name>)</code>                        </td><td id="d9f685ac">                            <code class="code">new entities.Issue(<user>, <project>, <summary>)</code>                        </td></tr></tbody></table></div>            </li></ol>    </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Custom-Workflow-Repository.html">自定义工作流存储库</a> <a class="navigation-links__next" href="rule-specific-properties.html">规则特定的属性</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>