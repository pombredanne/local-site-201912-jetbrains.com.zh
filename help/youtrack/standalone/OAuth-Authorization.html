<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>OAuth 2.0授权-帮助|帮助YouTrack单机版</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="OAuth-Authorization" data-breadcrumbs="Resources-for-Developers.xml|Resources for Developers/api-log-in-to-youtrack.xml|Log in to YouTrack/OAuth-Authorization.xml|OAuth 2.0 Authorization" data-main-title="OAuth 2.0 Authorization"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索YouTrack独立帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="OAuth-Authorization.xml" data-toc="OAuth-Authorization">OAuth 2.0授权</h1>    <p id="897da11b">要使用OAuth 2.0通过REST API访问YouTrack资源，您需要登录，授权并获取YouTrack的访问令牌。授权由集线器服务提供。</p>    <p id="7151bf8b">我们仅建议您在应用程序需要客户端身份验证时使用OAuth 2.0。否则，最好使用基于令牌的授权。有关更多信息，请参阅<a href="authentication-with-permanent-token.html">永久令牌授权</a> 。</p>    <aside class="prompt" rel="7151bf8b" id="cb686024" data-type="warning" data-title="">        <p id="301cf931">不要尝试在内置集线器服务中注册外部服务！这可能会导致服务崩溃或故障。它还可能导致数据库损坏或数据丢失。</p>    </aside>            <p id="4cb17f92">如果您的YouTrack Standalone安装已连接到外部集线器服务，则可以使用集线器支持的任何OAuth 2.0授权流程。内置的Hub服务仅支持隐式授权授予。外部集线器安装支持多种授权方法。有关详细信息，请参阅<a href="/help/hub/OAuth-2.0-Authorization.html" rel="noopener noreferrer" data-external="true" target="_blank">Hub文档</a> 。</p>            <p id="ca9d61b9">要使用隐式OAuth 2.0授权，您的客户端应用程序必须在Internet上公开可用。此类应用程序通常用JavaScript编写并在Web浏览器中运行。</p>            <div class="chapter"><h2 id="HubOauthEndpoints" data-toc="OAuth-Authorization#HubOauthEndpoints">终点</h2>        <p id="a69fc917">内置的中心服务使用以下OAuth 2.0端点：</p>        <div class="table-wrapper"><table width="100%" id="774de561"><thead><tr id="69fdeb8a" class="ijRowHead"><th id="ece88bfd" width="20%"><p>终点</p></th><th id="5c0d3daa"><p>网址</p></th></tr></thead><tbody><tr id="b4462123" class="ijRowOdd"><td id="279b55c4"><p>认证方式</p></td><td id="75350b51"><code class="code"><Hub service URL>/api/rest/oauth2/auth</code></td></tr><tr id="f95bfad7" class="ijRowEven"><td id="941d32f7"><p>代币</p></td><td id="10a54feb"><code class="code"><Hub service URL>/api/rest/oauth2/token</code></td></tr></tbody></table></div>                    <p id="a946cc32">的<code class="code"><Hub service URL></code>是网络环境中集线器服务的访问点。对于YouTrack Standalone安装，可以从带有路径的YouTrack基本URL访问该服务。 <code class="code">/hub</code> 。例如， <code class="code">www.company-youtrack.com/hub</code> 。</p>            <p id="16650df0">您可以在“ <span class="control">全局设置”</span>页面上找到安装的基本URL。有关更多信息，请参见<a href="Managing-Global-Settings.html#general-system-settings">System</a> 。</p>                    </div>    <div class="chapter"><h2 id="implicit-authorization-grants" data-toc="OAuth-Authorization#implicit-authorization-grants">隐式授权</h2>    <p id="1248e6c3">YouTrack支持OAuth 2.0授权以及<a href="https://tools.ietf.org/html/rfc6749#section-4.2" rel="noopener noreferrer" data-external="true" target="_blank">OAuth 2.0授权框架中</a>指定的隐式授权。</p>            <p id="c2c6f14a">要从YouTrack获取访问令牌，您需要提供以下参数的值：</p>        <a name="Send User to Authorization Server (Hub)"></a>        <div class="chapter"><h3 id="SendUserToAuthServer" data-toc="OAuth-Authorization#SendUserToAuthServer">要求</h3>            <p id="b0b75bba">要启动身份验证，请将浏览器重定向到授权端点：</p>            <div class="code-block" data-lang="markup">$ {Hub服务URL} / api / rest / oauth2 / auth？response_type = token＆state = $ {State}＆redirect_uri = $ {客户端重定向URI}＆request_credentials = $ {请求凭据模式}＆client_id = $ {客户端服务ID}＆scope = $ {Scope}</div>            <p id="a875c879">例：</p>            <div class="code-block" data-lang="markup">https://www.company-youtrack.com/hub/api/rest/oauth2/auth?response_type=token&state=9b8fdea0-fc3a-410c-9577-5dee1ae028da&redirect_uri=https%3A%2F%2Fmyservice.company.com%2Fauthorized&request_credentials= skip＆client_id = 98071167-004c-4ddf-ba37-5d4599fdf319＆scope = 0-0-0-0-0％2098071167-004c-4ddf-ba37-5d4599fdf319</div>            <p id="4f4d8355">要从YouTrack获取访问令牌，您需要在授权请求中为以下参数提供值：</p>            <div class="table-wrapper"><table width="100%" id="b54ecd46"><thead><tr id="e020f919" class="ijRowHead"><th id="9c7d09db" width="20%"><p>参数</p></th><th id="04e03db6"><p>描述</p></th></tr></thead><tbody><tr id="69cb0d61" class="ijRowOdd"><td id="a0f984c0"><code class="code">response_type</code></td><td id="62ce805e"><p>在OAuth 2.0请求中指定授予类型。对于隐式授予，请使用<code class="code">token</code> 。</p></td></tr><tr id="b37b5ba3" class="ijRowEven"><td id="4a0ef153"><code class="code">state</code></td><td id="0e2620b8"><p>当前应用程序状态的标识符。例如，它可以是本地存储对象的键，该对象包含有关当前用户在客户端应用程序中的位置的信息。</p></td></tr><tr id="b67a2648" class="ijRowOdd"><td id="78c53eec"><code class="code">redirect_uri</code></td><td id="cbaf6961"><p>客户端应用程序中的URI，可以处理来自Hub的响应。</p></td></tr><tr id="42bb73ce" class="ijRowEven"><td id="64289946"><code class="code">request_credentials</code></td><td id="444504ff">一个参数，该参数确定是否应要求用户登录。以下值是有效的：<ul class="list _bullet"><li class="list__item" id="8d5a119f">                                <code class="code">skip</code> —在客户端应用程序允许匿名访问时使用。<ul class="list _bullet"><li class="list__item" id="179f6876"><p>如果用户已经登录到集线器，则授予该用户对客户端应用程序的访问权限。</p></li><li class="list__item" id="ef4267b9"><p>如果用户未登录到集线器并且未禁止来宾帐户，则该用户被授予作为来宾访问客户端应用程序的权限。</p></li><li class="list__item" id="2e5a2259"><p>如果用户未登录到集线器并且访客帐户被禁止，则该用户将被重定向到登录页面。</p></li></ul>                            </li><li class="list__item" id="28d3566d"><p>                                <code class="code">silent</code> - 和...一样<code class="code">skip</code> ，但在所有情况下都将用户重定向到客户端应用程序。如果禁止来宾帐户，则会将用户重定向到带有身份验证错误的客户端应用程序。</p></li><li class="list__item" id="cade0357"><p>                                <code class="code">required</code> —将用户从集线器中注销，并将他们重定向到登录页面。用作对客户端应用程序中注销请求的响应。</p></li><li class="list__item" id="715a8559">                                <code class="code">default</code> —在客户端应用程序不允许匿名访问时使用。<ul class="list _bullet"><li class="list__item" id="4cd694b3"><p>如果用户已经登录到集线器，则授予该用户对客户端应用程序的访问权限。</p></li><li class="list__item" id="96c7ab27"><p>如果用户未登录集线器，则该用户将被重定向到登录页面。</p></li></ul>                            </li></ul>                    </td></tr><tr id="f6d9f1ad" class="ijRowOdd"><td id="4b5ff78e"><code class="code">client_id</code></td><td id="60e4d9fa"><p>在内置集线器服务中注册的YouTrack服务的ID。要获取YouTrack服务ID，请打开<span class="menupath" data-skip-index="skip">管理>集线器集成</span>页面：</p><figure><img alt="OAuth Yt服务ID" title="OAuth Yt服务ID" src="/help/img/youtrack/2019.2/oauthYTServiceId.png" id="34447d3b" width="672" height="223"></figure><p></p></td></tr><tr id="cb0d3129" class="ijRowEven"><td id="82f516af"><code class="code">scope</code></td><td id="c19bd9e4"><p>处理API请求的访问范围。在内置集线器中使用YouTrack服务的符号名称： <code class="code">YouTrack</code> 。</p></td></tr></tbody></table></div>        </div>        <div class="chapter"><h3 id="AuthServerResponse" data-toc="OAuth-Authorization#AuthServerResponse">回应</h3>            <p id="8626e4a6">客户端服务应该能够处理来自集线器的URL，该URL作为URL传递。 <code class="code">redirect_uri</code> 。响应参数在URL中的井号后传递。结果，这些参数不会发送到服务器，也不会被恶意因素拦截。</p>            <p id="e581c2d2">如果资源所有者批准了访问请求，则集线器将使用以下命令将以下参数添加到重定向URI的片段组件中，以发出访问令牌并将其传递给客户端。 <code class="code">"application/x-www-form-urlencoded"</code>格式：</p>            <div class="table-wrapper"><table width="100%" id="55823d19"><thead><tr id="f8c5a5bf" class="ijRowHead"><th id="1f5cf982" width="20%"><p>参数</p></th><th id="1a973588"><p>描述</p></th></tr></thead><tbody><tr id="7af571d1" class="ijRowOdd"><td id="a4d42e20"><code class="code">access_token</code></td><td id="bc00cc6f"><p>集线器发出的访问令牌。</p></td></tr><tr id="15dba5e6" class="ijRowEven"><td id="b07f4e05"><code class="code">token_type</code></td><td id="0a3cbe95"><p>Hub发行的令牌的类型。该值不区分大小写。</p></td></tr><tr id="ea36a324" class="ijRowOdd"><td id="7989801e"><code class="code">expires_in</code></td><td id="0f0b9f18"><p>访问令牌的生存期（以秒为单位）。例如， <code class="code">3600</code>表示访问令牌自生成响应之日起一小时后过期。</p></td></tr><tr id="a2d3a496" class="ijRowEven"><td id="17797feb"><code class="code">scope</code></td><td id="4614af0a"><p>如果与客户要求的范围相同，则为可选；否则，是必需的。集线器中访问令牌的范围是<code class="code">service_id</code> 。</p></td></tr><tr id="5a013c12" class="ijRowOdd"><td id="107e759f"><code class="code">state</code></td><td id="08488808"><p>如果需要<code class="code">state</code>参数在客户端授权请求中指定。从客户端收到的确切值。</p></td></tr></tbody></table></div>            <p id="279dbbf7">请注意，授权服务器（Hub） <i id="b95721a9">不会发出刷新令牌</i> 。</p>            <p id="5dc494ae">例如，中心服务器通过发送以下HTTP响应来重定向用户代理：</p>            <div class="code-block" data-lang="markup">HTTP / 1.1 302找到的位置：http://myservice.company.com/authorized#access_token=1443459450185.0-0-0-0-0.98071167-004c-4ddf-ba37-5d4599fdf319.0-0-0-0-0%3B1 .MCwCFC％2FYWvLjHdzOdpLleDLITJn4Mz9rAhRklCoZ2dlMkh2aCd1K5QQ89ibsxg％3D％3D＆token_type = Bearer＆expires_in = 3600＆scope = 0-0-0-0-0％2098071167-a-da-dd-f4df-a4df-d4-df-a4df-a4df-d4-df-a-df-a-df-a-d-a-df-a-d-a-d-a-df-a-d-a-df-a-dd-state = 3d％3D％3d＆token_type = bearer＆expires_in = 3600＆scope = 0-0-0-0-0％2098071167-a4df4df-d4a-d5a-d4df-a4df-d4-df-d4df-d4df-a-df-a-df-a-d-a-df-a-dd-state</div>                    </div>        <div class="chapter"><h3 id="ErrorRedirectBackFromHub" data-toc="OAuth-Authorization#ErrorRedirectBackFromHub">OAuth 2.0错误</h3>            <p id="5aa21093">如果由于丢失，无效或不匹配的重定向URI而导致请求失败，或者客户端标识符丢失或无效，则中心服务器将错误通知资源所有者，并且不会自动将用户代理重定向到无效的重定向URI。 。</p>            <p id="0924fa15">如果资源所有者拒绝访问请求，或者如果请求由于某种原因而不是丢失或无效的重定向URI失败，则授权服务器通过使用“ <code class="code">application/x-www-form-urlencoded</code>格式：</p>            <div class="table-wrapper"><table width="100%" id="c1d8f024"><thead><tr id="5ee2375c" class="ijRowHead"><th id="9903458d" width="20%"><p>参数</p></th><th id="1c220e41"><p>描述</p></th></tr></thead><tbody><tr id="fe5d23b0" class="ijRowOdd"><td id="b50b3b99"><code class="code">error</code></td><td id="322b56cd"><p>单个ASCII [USASCII]错误代码。有关可能的错误的列表，请参阅<a href="#AuthorizationResponseErrors">授权响应错误</a>和<a href="#token-response-error-codes">令牌响应错误</a> 。</p></td></tr><tr id="f4c1e14f" class="ijRowEven"><td id="6f330001"><code class="code">error_description</code></td><td id="cff3daba"><p>人工可读的ASCII [USASCII]文本提供了其他信息，用于帮助客户端开发人员了解问题所在。</p></td></tr><tr id="941c6777" class="ijRowOdd"><td id="4527648d"><code class="code">error_uri</code></td><td id="d664214e"><p>一个URI，用于标识人类可读的网页以及有关该错误的信息，用于向客户端开发人员提供其他信息。</p></td></tr><tr id="ffb9c9ea" class="ijRowEven"><td id="e016caee"><code class="code">state</code></td><td id="b879d937"><p>如果客户端授权请求中存在“状态”参数，则为必需。从客户端收到的确切值。</p></td></tr></tbody></table></div>            <p id="55e77525">例如，集线器通过发送以下HTTP响应来重定向用户代理：</p>            <div class="code-block" data-lang="markup">HTTP / 1.1 302找到位置：https://myservice.company.com/cb#error=access_denied&state=xyz</div>                        <div class="chapter"><h4 id="AuthorizationResponseErrors">授权响应错误</h4>                <p id="3446b1fa">请求到授权端点可以返回以下错误。</p>                <div class="table-wrapper"><table class=" wide" width="100%" id="126679b7"><thead><tr id="6a85f28e" class="ijRowHead"><th id="19e0ecaa" width="20%"><p>错误</p></th><th id="59b49cb3" width="40%"><p>描述</p></th><th id="be20127b" width="40%"><p>解</p></th></tr></thead><tbody><tr id="8fc95c63" class="ijRowOdd"><td id="891ff403"><a name="auth.invalid_request"></a><code class="code">invalid_request</code></td><td id="b8e51137"><p>对集线器的授权请求缺少必需的参数，包括无效的参数值，多次包含一个参数，或者格式错误。</p></td><td id="dc7928f7"><p>验证所有参数是否正确，是否提供了<code class="code">service_id</code>存在，依此类推。</p></td></tr><tr id="768dd637" class="ijRowEven"><td id="8779de14"><a name="auth.unauthorized_client"></a><code class="code">unauthorized_client</code></td><td id="2c199d66"><p>客户端无权使用此方法请求授权码，或者<code class="code">redirect_URI</code>的服务不正确或丢失。</p></td><td id="f1ff3064"><ol class="list _decimal"><li class="list__item" id="ef573ff8"><p>确保<code class="code">redirect_uri</code>是正确的，并且已正确注册为服务的重定向URI之一。</p></li><li class="list__item" id="cd30d6e8"><p>确保您的服务至少提供一项<code class="code">redirect_uri</code>在集线器中。</p></li></ol></td></tr><tr id="df1453a1" class="ijRowOdd"><td id="f2d12d90"><code class="code">access_denied</code></td><td id="afb5fda9"><p>资源所有者或集线器拒绝了该请求。</p></td><td id="cd6e1d5d"><p>确认您使用的是正确的值<code class="code">scope</code>参数。</p></td></tr><tr id="3591d965" class="ijRowEven"><td id="3ceb1e43"><a name="auth.unsupported_responce_type"></a><code class="code">unsupported_response_type</code></td><td id="41157189"><p>集线器不支持使用此方法获取授权码。</p></td><td id="a602e9de"><p>确认您已为<code class="code">response_type</code>至<code class="code">token</code> 。</p></td></tr><tr id="828b7e31" class="ijRowOdd"><td id="24d1501c"><a name="auth.invalid_scope"></a><code class="code">invalid_scope</code></td><td id="8bed3268"><p>请求授权的范围与任何注册的服务都不匹配。</p></td><td id="4c539b6a"><p>确保该请求是正确的。</p></td></tr><tr id="58f5e230" class="ijRowEven"><td id="02be1adb"><code class="code">server_error</code></td><td id="69391216"><p>集线器服务遇到意外状况，阻止其满足请求。（由于无法使用HTTP重定向将500内部服务器错误HTTP状态代码返回给客户端，因此需要此错误代码。）</p></td><td id="62898cae"><p>YouTrack与集线器服务之间的连接可能不同步。在YouTrack中打开“ <span class="control">集线器集成”</span>页面并运行诊断。</p></td></tr><tr id="0c72e563" class="ijRowOdd"><td id="4a68fc32"><code class="code">temporarily_unavailable</code></td><td id="c6793ca2"><p>由于服务器的暂时超载或维护，授权服务器当前无法处理该请求。（由于无法使用HTTP重定向将503服务不可用HTTP状态代码返回给客户端，因此需要此错误代码。）</p></td><td id="2491a1ef"><p>YouTrack与集线器服务之间的连接可能不同步。在YouTrack中打开“ <span class="control">集线器集成”</span>页面并运行诊断。</p></td></tr></tbody></table></div>            </div>            <div class="chapter"><h4 id="token-response-error-codes">令牌响应错误</h4>                <p id="c9f799e0">请求可以向令牌端点返回以下错误。有关更多信息，请阅读<a href="https://tools.ietf.org/html/rfc6749#section-5.2" rel="noopener noreferrer" data-external="true" target="_blank">RFC6749标准中</a>定义的每个错误的定义。</p>                <div class="table-wrapper"><table class=" wide" width="100%" id="a89478c9"><thead><tr id="36ff7e75" class="ijRowHead"><th id="09c782be" width="20%"><p>错误</p></th><th id="1e725898" width="40%"><p>描述</p></th><th id="595f5f59" width="40%"><p>解</p></th></tr></thead><tbody><tr id="b90193fe" class="ijRowOdd"><td id="8fd7191a">                            <a name="token.invalid_request"></a>                            <code class="code">invalid_request</code>                        </td><td id="5ab7ba68">                            <p id="7fe549a9">该请求缺少必需的参数，包括不受支持的参数值（授权类型除外），重复参数，包括多个凭据，利用多个以上的机制来认证客户端，或者格式错误。</p>                        </td><td id="159ec6a3"><p>检查响应头，然后检查请求是否正确。</p></td></tr><tr id="b41de8a3" class="ijRowEven"><td id="90943a53">                            <a name="token.invalid_client"></a>                            <code class="code">invalid_client</code>                        </td><td id="bfaac307"><p>客户端身份验证失败。例如，客户端未知，不包括客户端身份验证或身份验证方法不受支持。</p></td><td id="fe2bdab5"><p>检查值<code class="code">client_id</code>参数。</p></td></tr><tr id="cf0e7284" class="ijRowOdd"><td id="7f9a8ac3">                            <a name="token.unsupported_grant_type"></a>                            <code class="code">unsupported_grant_type</code>                        </td><td id="a7e37d46"><p>集线器不支持授权授予类型。</p></td><td id="4e6b7814"><p>确认您已为<code class="code">response_type</code>至<code class="code">token</code> 。</p></td></tr><tr id="bc0da822" class="ijRowEven"><td id="61266df6">                            <a name="token.invalid_scope"></a>                            <code class="code">invalid_scope</code>                        </td><td id="ed90b093"><p>您需要访问令牌的范围与任何注册的服务都不匹配。</p></td><td id="1824731d"><p>确认您使用的是正确的值<code class="code">scope</code>参数。</p></td></tr></tbody></table></div>            </div>        </div>    </div>    <div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="authentication-with-permanent-token.html">永久令牌授权</a> <a class="navigation-links__next" href="youtrack-rest-api-reference.html">REST API</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>