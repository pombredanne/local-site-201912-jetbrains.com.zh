<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Workflow Tutorial - Help | YouTrack Standalone</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Workflow-Tutorial" data-breadcrumbs="Administration.xml|Administration/Workflow-Guide.xml|Workflows/Workflow-Tutorial.xml|Workflow Tutorial" data-main-title="Workflow Tutorial"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search YouTrack Standalone Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Workflow-Tutorial" id="Workflow-Tutorial.xml">Workflow Tutorial</h1>  <p id="4ecc6c1e">Workflows are the ultimate option for customizing YouTrack.    You can apply sets of rules to issues in a project and automate changes in issue states to make YouTrack adapt to    your process.  </p>  <p id="08faa8a0">This tutorial shows you how to create a workflow and define its rules.    The tutorial also introduces you to the language that is used for writing workflow code.  </p>  <div class="chapter"><h2 id="workflow-tutorial-prerequisites" data-toc="Workflow-Tutorial#workflow-tutorial-prerequisites">Prerequisites</h2>    <ul class="list _bullet"><li class="list__item" id="1a8e3f22"><p>You have permission to create and edit workflows.        These tasks require that you have the <span class="control">Read Project</span> and <span class="control">Update Project</span> permissions        in at least one project.        Users with the <span class="control">Low-level Administration</span> permission can create workflows and edit any workflow        in the system.      </p></li><li class="list__item" id="25c1ef3f"><p>You are familiar with your YouTrack configuration.        This means that you know how your projects are configured and the fields that are used in issues for each        project.      </p></li><li class="list__item" id="b50e3e10"><p>You have a basic understanding of JavaScript.</p></li><li class="list__item" id="b4ce5785"><p>You have verified that the existing workflows do not support your use case.        You need to write new rules and attach them to one or more projects.      </p></li><li class="list__item" id="97c95966"><p>You have created a backup of your YouTrack database.        Errors in custom workflows can lead to the inadvertent removal of important data or corruption of the database.        We strongly recommend that you back up your YouTrack database before you update workflows.        This task requires the <span class="control">Low-level Admin Write</span> permission.      </p></li></ul>  </div>  <div class="chapter"><h2 id="workflow-tutorial-use-case" data-toc="Workflow-Tutorial#workflow-tutorial-use-case">Use Case</h2>    <p id="c07cce6d">Let's say your team follows a Kanban process and would like to use the YouTrack Agile Board.      The columns of the board represent each department.      Your team has a set process for moving issues from one department to the next.      Team members can see which department is working on an issue at the moment.      The color of the issue card represents the time left until the deadline.      The card starts out green and then, based on a specific workflow, turns yellow and then red as the deadline      approaches.    </p>    <p id="e80d2ec7">Your task is to set up the project and create workflows to support the board as described above.</p>    <p id="0fcd3ca1">      <figure><a class="lightbox" href="/help/img/youtrack/2019.2/workflow-tutorial-agile-board.zoomed.png"><img alt="color cards on agile board by deadline" title="color cards on agile board by deadline" src="/help/img/youtrack/2019.2/workflow-tutorial-agile-board.png" id="d6292f6f" width="600" height="175"></a></figure>    </p>  </div>  <div class="chapter"><h2 id="project-configuration-workflow-tutorial" data-toc="Workflow-Tutorial#project-configuration-workflow-tutorial">Set Up the Project</h2>    <p id="1b6f5e6c">To have colored cards on the board, you need an enumerated field in your project.      Let's call the project <span class="control">WebDev</span> and name the field <span class="control">DeadlineApproach</span>.      You add this field to your project and add the following set of values:    </p>    <ul class="list _ul"><li class="list__item" id="7b5cf4a7"><p>More than a week</p></li><li class="list__item" id="c335b053"><p>1 week</p></li><li class="list__item" id="6f6703fc"><p>4-6 days</p></li><li class="list__item" id="468969cc"><p>2-3 days</p></li><li class="list__item" id="4e905ac7"><p>1 day</p></li></ul>    <p id="cff02454">      <figure><a class="lightbox" href="/help/img/youtrack/2019.2/workflow-tutorial-field-settings.zoomed.png"><img alt="deadline field settings" title="deadline field settings" src="/help/img/youtrack/2019.2/workflow-tutorial-field-settings.png" id="62fabcec" width="600" height="297"></a></figure>    </p>    <p id="f42475c0">You define the colors when you add values to the set of values available for the field.</p>    <p id="e3736d71">You also need to add a <span class="control">Due Date</span> field to your project to store the deadline.</p>    <p id="4e21ea3d">Now that you have defined the color scheme for the custom field, you need to apply this color scheme to the cards on your agile board.</p>    <section class="procedure-steps"><h3 id="03f96842">To configure your agile board:</h3><ol class="list _decimal"><li class="list__item" id="1749e356"><p>Click the <span class="control">Agile Boards</span> link in the header.</p></li><li class="list__item" id="2e2ab1c1"><p>Choose your board from the drop-down list.</p></li><li class="list__item" id="6d8561db"><p>Click the <span class="control">Board settings</span> button, then select the <span class="control">Card</span> tab.</p></li><li class="list__item" id="41ce2198"><p>From the <span class="control">Color Scheme</span> drop-down list, select <span class="control">Deadline Approach</span>.</p></li></ol></section>  </div>  <div class="chapter"><h2 id="tutorial-create-workflow" data-toc="Workflow-Tutorial#tutorial-create-workflow">Create the Workflow</h2>    <p id="3616603e">Workflows are really nothing more than a container for the modules that define your rules. First, you create the      workflow. Then you add modules that contain the rules to it.    </p>    <section class="procedure-steps"><h3 id="9788b8f2">To create the workflow:</h3><ol class="list _decimal"><li class="list__item" id="59f4e0fe"><p>From the <span class="control">Core Features</span> section of the <span class="control">Administration</span> menu,        select <span class="control">Workflows</span>.      </p></li><li class="list__item" id="a67333a6">Click the <span class="control">Create workflow</span> button.        <ul class="list _ul"><li class="list__item" id="7689ecbc"><p>The <span class="control">New Workflow</span> dialog opens.          </p></li></ul>      </li><li class="list__item" id="1268ef6e">Enter a <span class="control">Name</span> and a <span class="control">Title</span>.        <p id="946b3d22">Let's name the workflow <span class="control">kanban-color-scheme</span> and give it the title <span class="control">Kanban Color          Scheme</span>.        </p>      </li><li class="list__item" id="869766d9">Click the <span class="control">Save</span> button.        <ul class="list _ul"><li class="list__item" id="90c67e8e"><p>The workflow is added to the list on the <span class="control">Workflows</span> page.          </p></li></ul>      </li></ol></section>  </div>  <div class="chapter"><h2 id="tutorial-create-on-change-rule" data-toc="Workflow-Tutorial#tutorial-create-on-change-rule">Create an On-change Rule</h2>    <p id="774448ce">You need to add two rules to the workflow:</p>    <ul class="list _ul"><li class="list__item" id="6bbca4e0"><p>An on-change rule that runs when an issue is changed,        when a new issue is created, and the <span class="control">Due Date</span> field is updated.      </p></li><li class="list__item" id="7da25b53"><p>An on-schedule rule that updates the color of the cards daily.</p></li></ul>    <section class="procedure-steps"><h3 id="d8e8dcbf">To add the on-change rule:</h3><ol class="list _decimal"><li class="list__item" id="79cb0066">Locate the workflow in the <span class="control">Workflows</span> list and click its name.        <ul class="list _ul"><li class="list__item" id="2f4e2909"><p>The <span class="control">New Module</span> dialog opens in the sidebar.          </p></li></ul>      </li><li class="list__item" id="1bc1f556">Click the <span class="control">On-change</span> button.        <ul class="list _ul"><li class="list__item" id="ea37e1b3"><p>The <span class="control">New Module</span> dialog opens.          </p></li></ul>      </li><li class="list__item" id="7af718b1"><p>Enter a <span class="control">Name</span> for the module.        We'll call this one <code class="code">apply-color-by-due-date</code>.      </p></li><li class="list__item" id="1b3c50f6">Click the <span class="control">Save</span> button.        <ul class="list _ul"><li class="list__item" id="646eca99"><p>The module is added to the current workflow.</p></li><li class="list__item" id="aee383ed"><p>The template for an on-change rule loads in the workflow editor.</p></li></ul>      </li></ol></section>    <p id="0ba3b0b3">Now let's define the on-change rule.</p>        <p id="836905b0">You can copy and paste this block of code directly into the editor.</p>    <div class="code-block" data-lang="javascript">var entities = require('@jetbrains/youtrack-scripting-api/entities');

exports.DAY_IN_MS = 24 * 60 * 60 * 1000;

exports.rule = entities.Issue.onChange({
  title: 'Apply color by due date',
  guard: function(ctx) {
    return (ctx.issue.becomesReported || ctx.issue.fields.isChanged(ctx.DueDate)) &amp;&amp;
      ctx.issue.fields.DueDate;
  },
  action: function(ctx) {
    var issueFields = ctx.issue.fields;
    var diffInDays = Math.round((issueFields.DueDate -
      Date.now()) / exports.DAY_IN_MS);
    if (diffInDays &gt; 7) {
      issueFields.DeadlineApproach = ctx.DeadlineApproach.moreThanAWeek;
    } else if (diffInDays &gt; 6) {
      issueFields.DeadlineApproach = ctx.DeadlineApproach.oneWeek;
    } else if (diffInDays &gt; 3) {
      issueFields.DeadlineApproach = ctx.DeadlineApproach.fourToSixDays;
    } else if (diffInDays &gt; 1) {
      issueFields.DeadlineApproach = ctx.DeadlineApproach.twoToThreeDays;
    } else {
      issueFields.DeadlineApproach = ctx.DeadlineApproach.oneDay;
    }
  },
  requirements: {
    DueDate: {
      type: entities.Field.dateType,
      name: 'Due Date'
    },
    DeadlineApproach: {
      type: entities.EnumField.fieldType,
      moreThanAWeek: {
        name: 'More than a week'
      },
      oneWeek: {
        name: '1 week'
      },
      fourToSixDays: {
        name: '4-6 days'
      },
      twoToThreeDays: {
        name: '2-3 days'
      },
      oneDay: {
        name: '1 day'
      }
    }
  }
});</div>    <p id="458cb7bf">When finished, click the <span class="control">Save</span> button.    </p>  </div>  <div class="chapter"><h2 id="tutorial-create-on-schedule-rule" data-toc="Workflow-Tutorial#tutorial-create-on-schedule-rule">Create an On-schedule Rule</h2>    <p id="7671fb37">The next step is to create the on-schedule rule.      This rule checks all of the issues in the project on a set schedule and updates the color scheme that is applied      to each card on the Kanban board based on how near each issue is to its due date.    </p>    <section class="procedure-steps"><h3 id="352276c7">To add the on-schedule rule:</h3><ol class="list _decimal"><li class="list__item" id="2e5456ed">Click the <span class="control">Add module</span> icon in the sidebar, then select <span class="control">On-schedule</span> from        the list.        <ul class="list _ul"><li class="list__item" id="400ae73a"><p>The <span class="control">New Module</span> dialog opens.          </p></li></ul>      </li><li class="list__item" id="76130b00"><p>Enter a <span class="control">Name</span> for the module.        We'll call this one <code class="code">change-color-over-time</code>.      </p></li><li class="list__item" id="cd0c3a12">Click the <span class="control">Save</span> button.        <ul class="list _ul"><li class="list__item" id="39048a8c"><p>The module is added to the current workflow.</p></li><li class="list__item" id="364c9f10"><p>The template for an on-schedule rule loads in the workflow editor.</p></li></ul>      </li><li class="list__item" id="b4783b29"><p>Copy the following code block and paste it into the editor, then click the <span class="control">Save</span> button.</p></li></ol></section>        <div class="code-block" data-lang="javascript">var entities = require('@jetbrains/youtrack-scripting-api/entities');

exports.DAY_IN_MS = 24 * 60 * 60 * 1000;

exports.rule = entities.Issue.onSchedule({
  title: 'Change color over time',
  search: '#Unresolved has: {Due Date}',
  cron: '0 0 9 1/1 * ? *',
  action: function(ctx) {
    var issueFields = ctx.issue.fields;
    var diffInDays = Math.round((issueFields.DueDate -
      Date.now()) / exports.DAY_IN_MS);
    if (diffInDays &gt; 7) {
      issueFields.DeadlineApproach = ctx.DeadlineApproach.moreThanAWeek;
    } else if (diffInDays &gt; 6) {
      issueFields.DeadlineApproach = ctx.DeadlineApproach.oneWeek;
    } else if (diffInDays &gt; 3) {
      issueFields.DeadlineApproach = ctx.DeadlineApproach.fourToSixDays;
    } else if (diffInDays &gt; 1) {
      issueFields.DeadlineApproach = ctx.DeadlineApproach.twoToThreeDays;
    } else {
      issueFields.DeadlineApproach = ctx.DeadlineApproach.oneDay;
    }
  },
  requirements: {
    DueDate: {
      type: entities.Field.dateType,
      name: 'Due Date'
    },
    DeadlineApproach: {
      type: entities.EnumField.fieldType,
      moreThanAWeek: {
        name: 'More than a week'
      },
      oneWeek: {
        name: '1 week'
      },
      fourToSixDays: {
        name: '4-6 days'
      },
      twoToThreeDays: {
        name: '2-3 days'
      },
      oneDay: {
        name: '1 day}'
      }
    }
  }
});</div>    <p id="06096761">Here's a basic explanation of what happens in this script:</p>    <ul class="list _ul"><li class="list__item" id="5345b1fa"><p>First, you set the <code class="code">search</code> property. This is necessary because you only want this rule to be applied to        unresolved issues.</p></li><li class="list__item" id="e136e8a8"><p>Next, you set the schedule. The schedule is determined by the <code class="code">cron</code> property.</p></li><li class="list__item" id="0c9490e0"><p>Then you have a series of <code class="code">if</code> statements that check how close the <span class="control">Due Date</span> is to the        current date.</p></li><li class="list__item" id="31a9abf0"><p>The <code class="code">Date.now</code> method returns a value that corresponds to the current date and time in UTC.</p></li><li class="list__item" id="b643902b"><p>As with the on-change rule, we set the requirements for custom fields and their values.      These requirements must exist in the project for the workflow to execute properly.</p></li></ul>    <p id="ef1eeea5">With these two rules, your workflow looks as follows:</p>    <figure><a class="lightbox" href="/help/img/youtrack/2019.2/kanban-color-scheme.zoomed.png"><img alt="Kanban color scheme" title="Kanban color scheme" src="/help/img/youtrack/2019.2/kanban-color-scheme.png" id="7141809e" width="600" height="248"></a></figure>  </div>  <div class="chapter"><h2 id="tutorial-attach-workflow-to-project" data-toc="Workflow-Tutorial#tutorial-attach-workflow-to-project">Attach the Workflow to a Project</h2>    <p id="752379a0">The last step is to attach the workflow and enable the rules in your project.</p>    <section class="procedure-steps"><h3 id="ce56e6e1">To attach a new workflow to a project:</h3><ol class="list _decimal"><li class="list__item" id="663f060e"><p>From the <span class="control">Core Features</span> section of the <span class="control">Administration</span> menu, select <span class="control">Workflows</span>.</p></li><li class="list__item" id="d3af9ef4"><p>Select the workflow from the list. If the sidebar is hidden, click the <span class="control">Show Details</span> button.      </p></li><li class="list__item" id="51c9407b"><p>Click the + sign for <span class="control">Projects</span> in the sidebar and select the projects to which you want to        attach the workflow. You can attach the same workflow to several projects at once.      </p></li></ol></section>    <p id="d6ee29f1">If there are projects that do not meet the workflow requirements, the <span class="control">requires setup</span> flag is shown.      This can mean that the project does not use the required custom fields, values are missing from the set of values in a custom field, or that there are groups, saved searches, projects or other system-wide entities that do not exist in YouTrack.</p>    <section class="procedure-steps"><h3 id="0fd9461c">To complete the setup:</h3><ol class="list _decimal"><li class="list__item" id="7fc91886"><p>Expand the workflow in the list.</p></li><li class="list__item" id="4e8b6aa3"><p>Select the first rule that is marked with the <span class="control">requires setup</span> flag without opening the module in the workflow editor.        Meaning, select the rule without clicking the link for the module name.</p></li><li class="list__item" id="d6e931ba">Move the pointer over any of the projects that are displayed in red text.        <ul class="list _ul"><li class="list__item" id="bb90fba0"><p>A tooltip displays the changes that are required to activate the workflow in each project.</p></li></ul>        <figure><a class="lightbox" href="/help/img/youtrack/2019.2/workflow-tutorial-requires-setup.zoomed.png"><img alt="workflow requires setup" title="workflow requires setup" src="/help/img/youtrack/2019.2/workflow-tutorial-requires-setup.png" id="5dc34ec7" width="600" height="186"></a></figure>      </li><li class="list__item" id="ff423369">Click the <span class="control">Apply fixes</span> link.        <ul class="list _ul"><li class="list__item" id="b96faa72"><p>The <span class="control">Apply fixes</span> dialog opens.</p></li></ul>        <figure><a class="lightbox" href="/help/img/youtrack/2019.2/workflow-tutorial-apply-fixes.zoomed.png"><img alt="workflow apply fixes" title="workflow apply fixes" src="/help/img/youtrack/2019.2/workflow-tutorial-apply-fixes.png" id="e2192722" width="600" height="281"></a></figure>      </li><li class="list__item" id="c081d02c"><p>Select all of the required fixes, then click the <span class="control">Apply</span> button.</p></li><li class="list__item" id="928a703f">Repeat steps x and y for all of the projects that require setup.        <ul class="list _ul"><li class="list__item" id="8470ef9c"><p>When done, the <span class="control">requires setup</span> flag is automatically removed from each rule.</p></li><li class="list__item" id="f3e4cae1"><p>When you refresh the page, the <span class="control">requires setup</span> flag is removed from the workflow.</p></li></ul></li></ol></section>    <p id="b84dea9e">The attached workflow starts working immediately.      If you edit to a workflow that is currently attached to a project, the changes take effect when you save your changes in the workflow editor.    However, if you add requirements to the workflow that require additional setup, the workflow will not execute properly until the requirements are met.</p>  </div>  <div class="last-modified" data-skip-index="skip">Last modified: 29 November 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="workflow-transactions.html">Transactions</a><a class="navigation-links__next" href="Workflow-Use-Cases.html">Use Cases for Workflows</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>