<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>工作流程教程-帮助| YouTrack单机版</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Workflow-Tutorial" data-breadcrumbs="Administration.xml|Administration/Workflow-Guide.xml|Workflows/Workflow-Tutorial.xml|Workflow Tutorial" data-main-title="Workflow Tutorial"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索YouTrack独立帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Workflow-Tutorial.xml" data-toc="Workflow-Tutorial">工作流程教程</h1>  <p id="4ecc6c1e">工作流是自定义YouTrack的最终选择。您可以将规则集应用于项目中的问题，并自动更改问题状态，以使YouTrack适应您的流程。</p>  <p id="08faa8a0">本教程向您展示如何创建工作流程并定义其规则。本教程还向您介绍了用于编写工作流代码的语言。</p>  <div class="chapter"><h2 id="workflow-tutorial-prerequisites" data-toc="Workflow-Tutorial#workflow-tutorial-prerequisites">先决条件</h2>    <ul class="list _bullet"><li class="list__item" id="1a8e3f22"><p>您有权创建和编辑工作流程。这些任务要求您至少在一个项目中具有“ <span class="control">读取项目”</span>和“ <span class="control">更新项目”</span>权限。具有“ <span class="control">低级管理”</span>权限的用户可以创建工作流程并编辑系统中的任何工作流程。</p></li><li class="list__item" id="25c1ef3f"><p>您熟悉您的YouTrack配置。这意味着您知道如何配置项目以及每个项目的问题中使用的字段。</p></li><li class="list__item" id="b50e3e10"><p>您对JavaScript有基本的了解。</p></li><li class="list__item" id="b4ce5785"><p>您已验证现有工作流程不支持您的用例。您需要编写新规则并将其附加到一个或多个项目。</p></li><li class="list__item" id="97c95966"><p>您已经创建了YouTrack数据库的备份。自定义工作流中的错误可能导致无意中删除重要数据或损坏数据库。强烈建议您在更新工作流之前备份YouTrack数据库。此任务需要“ <span class="control">低级管理员写”</span>权限。</p></li></ul>  </div>  <div class="chapter"><h2 id="workflow-tutorial-use-case" data-toc="Workflow-Tutorial#workflow-tutorial-use-case">用例</h2>    <p id="c07cce6d">假设您的团队遵循看板流程，并希望使用YouTrack Agile Board。董事会各栏代表每个部门。您的团队有一套确定的流程，可以将问题从一个部门转移到另一个部门。团队成员可以看到当前哪个部门正在处理问题。发行卡的颜色表示到截止日期为止的剩余时间。该卡从绿色开始，然后根据特定的工作流程，先变成黄色，然后变成红色，直到截止日期临近。</p>    <p id="e80d2ec7">如上所述，您的任务是设置项目并创建工作流以支持董事会。</p>    <p id="0fcd3ca1">      </p><figure><a class="lightbox" href="/help/img/youtrack/2019.2/workflow-tutorial-agile-board.zoomed.png"><img alt="截止日期之前敏捷板上的色卡" title="截止日期之前敏捷板上的色卡" src="/help/img/youtrack/2019.2/workflow-tutorial-agile-board.png" id="d6292f6f" width="600" height="175"></a></figure>    <p></p>  </div>  <div class="chapter"><h2 id="project-configuration-workflow-tutorial" data-toc="Workflow-Tutorial#project-configuration-workflow-tutorial">设置项目</h2>    <p id="1b6f5e6c">要在板上放置彩色卡，您的项目中需要一个枚举字段。让我们将项目<span class="control">称为WebDev</span>并将字段命名为<span class="control">DeadlineApproach</span> 。您将此字段添加到您的项目，并添加以下值集：</p>    <ul class="list _ul"><li class="list__item" id="7b5cf4a7"><p>一个多星期</p></li><li class="list__item" id="c335b053"><p>1周</p></li><li class="list__item" id="6f6703fc"><p>4-6天</p></li><li class="list__item" id="468969cc"><p>2-3天</p></li><li class="list__item" id="4e905ac7"><p>1天</p></li></ul>    <p id="cff02454">      </p><figure><a class="lightbox" href="/help/img/youtrack/2019.2/workflow-tutorial-field-settings.zoomed.png"><img alt="截止日期字段设置" title="截止日期字段设置" src="/help/img/youtrack/2019.2/workflow-tutorial-field-settings.png" id="62fabcec" width="600" height="297"></a></figure>    <p></p>    <p id="f42475c0">在将值添加到该字段的可用值集中时，可以定义颜色。</p>    <p id="e3736d71">您还需要在项目中添加<span class="control">截止日期</span>字段以存储截止日期。</p>    <p id="4e21ea3d">现在，您已经为自定义字段定义了配色方案，您需要将此配色方案应用于敏捷板上的卡。</p>    <section class="procedure-steps"><h3 id="03f96842">要配置您的敏捷板：</h3><ol class="list _decimal"><li class="list__item" id="1749e356"><p>单击标题中的“ <span class="control">敏捷板”</span>链接。</p></li><li class="list__item" id="2e2ab1c1"><p>从下拉列表中选择板。</p></li><li class="list__item" id="6d8561db"><p>单击<span class="control">板设置</span>按钮，然后选择<span class="control">卡</span>选项卡。</p></li><li class="list__item" id="41ce2198"><p>从“ <span class="control">配色方案”</span>下拉列表中，选择“ <span class="control">截止时间方法”</span> 。</p></li></ol></section>  </div>  <div class="chapter"><h2 id="tutorial-create-workflow" data-toc="Workflow-Tutorial#tutorial-create-workflow">创建工作流程</h2>    <p id="3616603e">实际上，工作流不过是定义规则的模块的容器。首先，创建工作流程。然后，向其中添加包含规则的模块。</p>    <section class="procedure-steps"><h3 id="9788b8f2">要创建工作流程：</h3><ol class="list _decimal"><li class="list__item" id="59f4e0fe"><p>在<span class="control">管理</span>菜单的<span class="control">核心功能</span>部分中，选择<span class="control">工作流程</span> 。</p></li><li class="list__item" id="a67333a6">单击<span class="control">创建工作流程</span>按钮。<ul class="list _ul"><li class="list__item" id="7689ecbc"><p>将打开“ <span class="control">新建工作流”</span>对话框。</p></li></ul>      </li><li class="list__item" id="1268ef6e">输入<span class="control">名称</span>和<span class="control">标题</span> 。<p id="946b3d22">让我们将工作流程命名为<span class="control">kanban-color-scheme，</span>并为其命名为<span class="control">Kanban Color Scheme</span> 。</p>      </li><li class="list__item" id="869766d9">单击<span class="control">保存</span>按钮。<ul class="list _ul"><li class="list__item" id="90c67e8e"><p>工作流将添加到“ <span class="control">工作流”</span>页面上的列表中。</p></li></ul>      </li></ol></section>  </div>  <div class="chapter"><h2 id="tutorial-create-on-change-rule" data-toc="Workflow-Tutorial#tutorial-create-on-change-rule">创建变更规则</h2>    <p id="774448ce">您需要向工作流程添加两个规则：</p>    <ul class="list _ul"><li class="list__item" id="6bbca4e0"><p>在更改问题，创建新问题以及更新“ <span class="control">到期日期”</span>字段时运行的变更规则。</p></li><li class="list__item" id="7da25b53"><p>计划规则，每天更新卡的颜色。</p></li></ul>    <section class="procedure-steps"><h3 id="d8e8dcbf">要添加变更规则：</h3><ol class="list _decimal"><li class="list__item" id="79cb0066">在“ <span class="control">工作流”</span>列表中找到该工作<span class="control">流</span> ，然后单击其名称。<ul class="list _ul"><li class="list__item" id="2f4e2909"><p>侧栏中将打开“ <span class="control">新模块”</span>对话框。</p></li></ul>      </li><li class="list__item" id="1bc1f556">单击<span class="control">更改</span>按钮。<ul class="list _ul"><li class="list__item" id="ea37e1b3"><p>将打开“ <span class="control">新模块”</span>对话框。</p></li></ul>      </li><li class="list__item" id="7af718b1"><p>输入模块的<span class="control">名称</span> 。我们称这个为<code class="code">apply-color-by-due-date</code> 。</p></li><li class="list__item" id="1b3c50f6">单击<span class="control">保存</span>按钮。<ul class="list _ul"><li class="list__item" id="646eca99"><p>该模块已添加到当前工作流程中。</p></li><li class="list__item" id="aee383ed"><p>更改规则的模板将加载到工作流编辑器中。</p></li></ul>      </li></ol></section>    <p id="0ba3b0b3">现在让我们定义变化规则。</p>        <p id="836905b0">您可以将此代码块直接复制并粘贴到编辑器中。</p>    <div class="code-block" data-lang="javascript">var实体= require（'@ jetbrains / youtrack-scripting-api / entities'）;出口。DAY_IN_MS = 24 * 60 * 60 * 1000; Exports.rule =实体。Issue.onChange（{标题：“在到期日之前应用颜色”，警卫：function（ctx）DueDate））&& ctx.issue.fields。截止日期; }，操作：function（ctx）{var issueFields = ctx.issue.fields; var diffInDays = Math.round（（issueFields。DueDate-Date.now（））/导出。DAY_IN_MS）; if（diffInDays> 7）{issueFields。DeadlineApproach = ctx。DeadlineApproach.moreThanAWeek; } else if（diffInDays> 6）{issueFields。DeadlineApproach = ctx。DeadlineApproach.oneWeek; } else if（diffInDays> 3）{issueFields。DeadlineApproach = ctx。DeadlineApproach.fourToSixDays; } else if（diffInDays> 1）{issueFields。DeadlineApproach = ctx。DeadlineApproach.twoToThreeDays; } else {issueFields。DeadlineApproach = ctx。DeadlineApproach.oneDay; }}，要求：{DueDate：{类型：实体。Field.dateType，名称：“到期日”}，DeadlineApproach：{类型：实体。EnumField.fieldType，moreThanAWeek：{名称：“超过一周”}，oneWeek：{名称：“ 1周”}，fourToSixDays：{名称：“ 4-6天”}，twoToThreeDays：{名称：“ 2-3 days'}，oneDay：{name：'1 day'}}}}）;</div>    <p id="458cb7bf">完成后，单击“ <span class="control">保存”</span>按钮。</p>  </div>  <div class="chapter"><h2 id="tutorial-create-on-schedule-rule" data-toc="Workflow-Tutorial#tutorial-create-on-schedule-rule">创建按计划规则</h2>    <p id="7671fb37">下一步是创建按计划规则。该规则将按设定的时间表检查项目中的所有问题，并根据每个问题离到期日期的距离来更新应用于看板上每个卡的配色方案。</p>    <section class="procedure-steps"><h3 id="352276c7">要添加按计划规则：</h3><ol class="list _decimal"><li class="list__item" id="2e5456ed">单击边栏中的“ <span class="control">添加模块”</span>图标，然后从列表中选择<span class="control">“按计划</span> ”。<ul class="list _ul"><li class="list__item" id="400ae73a"><p>将打开“ <span class="control">新模块”</span>对话框。</p></li></ul>      </li><li class="list__item" id="76130b00"><p>输入模块的<span class="control">名称</span> 。我们称这个为<code class="code">change-color-over-time</code> 。</p></li><li class="list__item" id="cd0c3a12">单击<span class="control">保存</span>按钮。<ul class="list _ul"><li class="list__item" id="39048a8c"><p>该模块已添加到当前工作流程中。</p></li><li class="list__item" id="364c9f10"><p>预定规则的模板将加载到工作流编辑器中。</p></li></ul>      </li><li class="list__item" id="b4783b29"><p>复制以下代码块并将其粘贴到编辑器中，然后单击“ <span class="control">保存”</span>按钮。</p></li></ol></section>        <div class="code-block" data-lang="javascript">var实体= require（'@ jetbrains / youtrack-scripting-api / entities'）;出口。DAY_IN_MS = 24 * 60 * 60 * 1000; Exports.rule =实体。Issue.onSchedule（{标题：“随时间更改颜色”，搜索：“＃Unresolved has：{Due Date}”，cron：“ 0 0 9 1/1 *？*'，操作：function（ctx）{var issueFields = ctx.issue.fields; var diffInDays = Math.round（（issueFields。DueDate-Date.now（））/导出。DAY_IN_MS）; if（diffInDays> 7）{issueFields。DeadlineApproach = ctx。DeadlineApproach.moreThanAWeek; } else if（diffInDays> 6）{issueFields。DeadlineApproach = ctx。DeadlineApproach.oneWeek; } else if（diffInDays> 3）{issueFields。DeadlineApproach = ctx。DeadlineApproach.fourToSixDays; } else if（diffInDays> 1）{issueFields。DeadlineApproach = ctx。DeadlineApproach.twoToThreeDays; } else {issueFields。DeadlineApproach = ctx。DeadlineApproach.oneDay; }}，要求：{DueDate：{类型：实体。Field.dateType，名称：“到期日”}，DeadlineApproach：{类型：实体。EnumField.fieldType，moreThanAWeek：{名称：“超过一周”}，oneWeek：{名称：“ 1周”}，fourToSixDays：{名称：“ 4-6天”}，twoToThreeDays：{名称：“ 2-3 days'}，oneDay：{name：'1 day}'}}}}）;</div>    <p id="06096761">这是此脚本中发生的基本说明：</p>    <ul class="list _ul"><li class="list__item" id="5345b1fa"><p>首先，您将<code class="code">search</code>属性。这是必要的，因为您只希望将此规则应用于未解决的问题。</p></li><li class="list__item" id="e136e8a8"><p>接下来，设置时间表。时间表由<code class="code">cron</code>属性。</p></li><li class="list__item" id="0c9490e0"><p>然后你有一系列<code class="code">if</code>用于检查“ <span class="control">到期日期”</span>与当前日期的距离的语句。</p></li><li class="list__item" id="31a9abf0"><p>的<code class="code">Date.now</code>方法返回的值与UTC中的当前日期和时间相对应。</p></li><li class="list__item" id="b643902b"><p>与变化规则一样，我们为自定义字段及其值设置要求。这些要求必须存在于项目中，才能正确执行工作流程。</p></li></ul>    <p id="ef1eeea5">使用这两个规则，您的工作流程如下所示：</p>    <figure><a class="lightbox" href="/help/img/youtrack/2019.2/kanban-color-scheme.zoomed.png"><img alt="看板配色方案" title="看板配色方案" src="/help/img/youtrack/2019.2/kanban-color-scheme.png" id="7141809e" width="600" height="248"></a></figure>  </div>  <div class="chapter"><h2 id="tutorial-attach-workflow-to-project" data-toc="Workflow-Tutorial#tutorial-attach-workflow-to-project">将工作流程附加到项目</h2>    <p id="752379a0">最后一步是附加工作流程并在项目中启用规则。</p>    <section class="procedure-steps"><h3 id="ce56e6e1">要将新的工作流程附加到项目：</h3><ol class="list _decimal"><li class="list__item" id="663f060e"><p>在<span class="control">管理</span>菜单的<span class="control">核心功能</span>部分中，选择<span class="control">工作流程</span> 。</p></li><li class="list__item" id="d3af9ef4"><p>从列表中选择工作流程。如果侧边栏处于隐藏状态，请单击<span class="control">显示详细信息</span>按钮。</p></li><li class="list__item" id="51c9407b"><p>单击侧栏中的<span class="control">项目</span>的+号，然后选择要附加工作流程的项目。您可以一次将同一工作流程附加到多个项目。</p></li></ol></section>    <p id="d6ee29f1">如果存在不满足工作流程要求的项目，则会显示<span class="control">require setup</span>标志。这可能意味着项目不使用必需的自定义字段，自定义字段中的一组值中缺少值，或者YouTrack中不存在某些组，保存的搜索，项目或其他系统范围内的实体。</p>    <section class="procedure-steps"><h3 id="0fd9461c">要完成设置：</h3><ol class="list _decimal"><li class="list__item" id="7fc91886"><p>展开列表中的工作流程。</p></li><li class="list__item" id="4e8b6aa3"><p>选择第一个标有“ <span class="control">requires setup”</span>标记的规则，而无需在工作流编辑器中打开模块。含义，选择规则而不单击模块名称的链接。</p></li><li class="list__item" id="d6e931ba">将指针移到以红色文本显示的任何项目上。<ul class="list _ul"><li class="list__item" id="bb90fba0"><p>工具提示显示激活每个项目中的工作流所需的更改。</p></li></ul>        <figure><a class="lightbox" href="/help/img/youtrack/2019.2/workflow-tutorial-requires-setup.zoomed.png"><img alt="工作流程需要设置" title="工作流程需要设置" src="/help/img/youtrack/2019.2/workflow-tutorial-requires-setup.png" id="5dc34ec7" width="600" height="186"></a></figure>      </li><li class="list__item" id="ff423369">单击“ <span class="control">应用修订”</span>链接。<ul class="list _ul"><li class="list__item" id="b96faa72"><p>将打开“ <span class="control">应用修订”</span>对话框。</p></li></ul>        <figure><a class="lightbox" href="/help/img/youtrack/2019.2/workflow-tutorial-apply-fixes.zoomed.png"><img alt="工作流程应用修复" title="工作流程应用修复" src="/help/img/youtrack/2019.2/workflow-tutorial-apply-fixes.png" id="e2192722" width="600" height="281"></a></figure>      </li><li class="list__item" id="c081d02c"><p>选择所有必需的修复程序，然后单击“ <span class="control">应用”</span>按钮。</p></li><li class="list__item" id="928a703f">对所有需要安装的项目重复步骤x和y。<ul class="list _ul"><li class="list__item" id="8470ef9c"><p>完成后，会自动从每个规则中删除<span class="control">require setup</span>标志。</p></li><li class="list__item" id="f3e4cae1"><p>刷新页面时，从工作流中删除了<span class="control">require setup</span>标志。</p></li></ul></li></ol></section>    <p id="b84dea9e">附加的工作流程将立即开始工作。如果您编辑当前连接到项目的工作流，则更改将在您将更改保存在工作流编辑器中时生效。但是，如果您将要求添加到需要额外设置的工作流中，则在满足要求之前，工作流将无法正确执行。</p>  </div>  <div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__next" href="Workflow-Use-Cases.html">工作流的</a> <a class="navigation-links__prev" href="workflow-transactions.html">交易</a> <a class="navigation-links__next" href="Workflow-Use-Cases.html">用例</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>