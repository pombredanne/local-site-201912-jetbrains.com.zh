<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>生成时间报告-帮助| YouTrack单机版</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="generate-time-reports-workflow" data-breadcrumbs="Administration.xml|Administration/Workflow-Guide.xml|Workflows/Workflow-Use-Cases.xml|Use Cases for Workflows/generate-time-reports-workflow.xml|Generate Time Reports" data-main-title="Generate Time Reports"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索YouTrack独立帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>YouTrack Standalone 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="generate-time-reports-workflow.xml" data-toc="generate-time-reports-workflow">生成时间报告</h1>  <p id="5e4c535a">YouTrack使您可以选择在“ <a href="Time-Report.html">时间报告”</a>上收集和显示时间跟踪数据。该报告显示了在一个或多个项目中处理问题所花费的总时间。它显示完成的工作类型和原始估算。花费的时间可以按执行的工作类型或执行任务的用户进行分组。</p>  <p id="c28a86f2">时间报告有助于回答以下问题：</p>  <ul class="list _ul"><li class="list__item" id="da58e27a"><p>上周记录了多少工作，谁完成了这项工作？</p></li><li class="list__item" id="e2eb30a7"><p>如何在不同项目之间分配时间？</p></li><li class="list__item" id="9f676814"><p>通常分配给员工的问题被高估或低估了吗？</p></li></ul>  <p id="e97fc34f">但是，这里的主要问题是您需要手动分析此数据。每次您想要监视此活动时，都需要访问报告，重新计算它，然后分析数据。如果需要进行任何历史分析，则必须导出数据并在外部工具中处理数字。</p>  <div class="chapter"><h2 id="use-workflows-reporting" data-toc="generate-time-reports-workflow#use-workflows-reporting">使用工作流作为报告工具</h2>    <p id="ac84800e">尽管工作流无法直接访问计算出的报告数据，但它们可以以问题和工作项的形式访问原始数据。使用时间表规则，您可以定期报告所需的任何内容，然后通过电子邮件将其发送给某人，无论是团队负责人还是员工。</p>    <p id="9e4ebd22">首先，从一个可以用来分析问题的核心模块开始。该脚本查找在特定时间范围内记录的给定项目中给定受让人的所有工作项。在其他工作流程规则中引用了此模块后，请将其另存为一个名为<code class="code">work-items</code> ：</p>    <div class="code-block" data-lang="javascript">var search = require（'@ jetbrains / youtrack-scripting-api / search'）; var date = require（'@ jetbrains / youtrack-scripting-api / date-time'）;函数formatter（timestamp）{返回date.format（timestamp，'yyyy-MM-dd'）; } / ** * @param {用户} [作者]工作项作者* @param {Project} [项目]要从* @param {Number}中获取问题的项目[从]开始，以毫秒为单位* @param {Number} [to]以纪元开始的结束日期，以毫秒为单位* @return {[WorkItem]}与参数匹配的工作项列表* / var fetchWorkItems = function（author，project，from，to）{//生成搜索查找问题的字符串，//在“发件人”和“至”之间，由“作者”添加了至少一个工作项：var searchQuery ='工作作者：'+ author.login +''; searchQuery + ='工作日期：'+ formatter（from）+'..'+ formatter（to）; //现在我们可以在`project`中遍历这些问题，//选择我们需要的工作项：var items = []; var issue = search.search（project，searchQuery）; issue.forEach（function（issue）{issue.workItems.forEach（function（item）{{if（item.author.login === author.login && item.date> = from && item.date <= to）{项目.push（item）;}}）}）; //返回数组：返回项目； }; Exports.fetchWorkItems = fetchWorkItems;</div>    <p id="96e9fd09">现在，帮助您的团队领导回答以下问题：每个开发人员上周记录了多少工作？从开发人员列表中的“ <span class="control">受让人”</span>字段中提取一组值，获取每个项目的工作项，并计算记录的时间与所需工作时间之间的差（例如，每个开发人员40小时）。</p>    <p id="25e2caa8">就像您在按计划运行的其他工作流中可能已经看到的那样，该规则使用<i id="7dcbcaac">锚点问题</i> 。锚定问题使您可以将问题所属的项目拉到上下文中，并遍历项目中的其他问题。它还可以确保规则在每个计划执行中仅运行一次。</p>    <p id="921ab8b2">对于主播问题，只需创建一个描述如下的问题：“请永远不要删除此问题！”并将其设置为已解决状态。然后，您可以在<code class="code">search</code>预定规则的属性。这使得该规则在每次计划的时间精确地运行一次。您可以在以下规则中看到此技术的应用。</p>    <div class="code-block" data-lang="javascript">var实体= require（'@ jetbrains / youtrack-scripting-api / entities'）; var wi = require（'./ work-items'）; var DAY_IN_MS = 24 * 60 * 60 * 1000; var HOURS_TO_WORK_A_WEEK = 40; Exports.rule =实体。Issue.onSchedule（{标题：“每周一发送报告至项目负责人”，cron：“ 0 0 10吗？* MON'，搜索：'＃WI-1'，// // TODO：用锚点发布操作的ID替换：function（ctx）{var project = ctx.issue.project; //计算上周的开始和结束：var from = new Date（）; from.setHours（0，0，0，0）; //从= from.getTime（）开始这一天的开始-7 * DAY_IN_MS; //上周一星期一的开始var到=从+ 7 * DAY_IN_MS-1; //最后一个星期日的结束// //从项目的“受理人”字段中获取受理人的列表，//获取每个工作项的列表，并计算每个受理人报告的工作项的持续时间之和// ：var durations = {}; var分配者= ctx。受让人值; Assignees.forEach（function（assignee）{var items = wi.fetchWorkItems（assignee，project，from，to）; var duration = 0; //持续时间以分钟为单位items.forEach（function（item）{duration + = item.duration ;}）; durations [assignee.login] =持续时间/ 60;}）; //创建电子邮件内容：var subject ='[YouTrack，Report]上周完成的工作报告'; var body ='这是上周的报告：\ n \ n'; Assignees.forEach（function（assignee）{var duration = durations [assignee.login]; var text = Assignee.fullName +'for'+ duration +'hour's'; if（duration> HOURS_TO_WORK_A_WEEK）{text + = '（'+（持续时间-HOURS_TO_WORK_A_WEEK）+'小时）的加班时间。\ n';}否则，如果（duration <HOURS_TO_WORK_A_WEEK）{text + ='（'+（HOURS_TO_WORK_A_WEEK-持续时间）+小时s））。\ n';} else {text + ='。\ n';} body + = text;}）; body + ='\ n真诚的，YouTrack \ n'; //发送电子邮件至项目负责人：project.leader.notify（subject，body）; }，要求：{受让人：{类型：实体。User.fieldType}}}）;</div>    <p id="a750e448">关于此规则的很酷的事情是它是高度可定制的。以下是可以推动此功能的一些可能的方向：</p>    <ul class="list _ul"><li class="list__item" id="3531e8b1"><p>不要使用“受让人”字段的一组值，而是根据一个或多个组中的成员资格生成开发人员列表。</p></li><li class="list__item" id="7392cad8"><p>从多个项目中提取数据并计算每个项目所花费的时间，将项目或开发人员所花费的时间分组。</p></li><li class="list__item" id="00de56b0"><p>映射每个开发人员所需的工作时间，而不是使用公共常数。</p></li></ul>    <p id="b4e9073c">作为第二个示例，当记录的工作量少于周末需要的工作时间时，向开发人员发送提醒：</p>    <div class="code-block" data-lang="javascript">var实体= require（'@ jetbrains / youtrack-scripting-api / entities'）; var wi = require（'./ work-items'）; var DAY_IN_MS = 24 * 60 * 60 * 1000; var HOURS_TO_WORK_A_WEEK = 40; Exports.rule =实体。Issue.onSchedule（{title：'如果未记录足够的工作，请在周五提醒开发人员'，cron：'0 0 16吗？* FRI'，搜索：'＃WI-1'，// // TODO：用锚点发布操作的ID替换：function（ctx）{var project = ctx.issue.project; //计算本周的开始和结束：var to = new Date（）; //当前时刻var from = new Date（to-4 * DAY_IN_MS）; //星期一16:00 from.setHours（0，0，0，0）; from = from.getTime（）; //上周一的开始// //从项目的“受理人”字段中获取受理人的列表，//获取每个工作项的工作清单，并计算每个受理人报告的工作项的工期总和// ：var durations = {}; var分配者= ctx。受让人值; Assignees.forEach（function（assignee）{var items = wi.fetchWorkItems（assignee，project，from，to）; var duration = 0; //持续时间以分钟为单位items.forEach（function（item）{duration + = item.duration ;}）; durations [assignee.login] =持续时间/ 60;}）; //如果工作尚未完成，则发送电子邮件：assignees.forEach（function（assignee）{var duration = durations [assignee.login]; if（duration <HOURS_TO_WORK_A_WEEK）{var subject ='[YouTrack，Reminder]工作已完成这周”； var body ='嘿'+ Assignee.fullName +'，\ n \ n'; body + ='看起来您忘了记录某些工作：您为'+ project.name +'做过工作+持续时间+'小时，而不是'+您需要HOURS_TO_WORK_A_WEEK +'。\ n';正文+ ='\ n真诚的，您是YouTrack \ n'; Assignee.notify（subject，body）;}}）; }，要求：{受让人：{类型：实体。User.fieldType}}}）;</div>    <p id="89c65cdf">扩展先前脚本的相同想法也同样适用于此。使用访问工作项的功能，您不仅可以计算可计费的小时数，还可以计算其他数字特征，例如团队的集体速度和每个开发人员的相对绩效。</p>  </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="track-spent-time-workflow.html">跟踪花费的时间</a> <a class="navigation-links__next" href="enhance-helpdesk-support-workflows.html">增强服务台支持</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>