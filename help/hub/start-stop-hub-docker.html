<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Start and Stop Docker Container - Help | Hub</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="start-stop-hub-docker"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search Hub Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>Hub 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="start-stop-hub-docker" id="start-stop-hub-docker.xml">Start and Stop Docker Container</h1>    <a name="start-stop-intro"></a>    <p id="23302ad0">This page describes how to stop and start your Hub server.</p>    <p id="e63fdd33">The following situations require that you stop your Hub server:</p>    <ul class="list _ul"><li class="list__item" id="149ff5ab"><p>You want to change the location of the Hub database.</p></li><li class="list__item" id="e6c79cdd"><p>You want to modify Hub properties or JVM options for your Hub server.</p></li><li class="list__item" id="e0030efa"><p>You want to upgrade your Hub installation.</p></li></ul>    <div class="chapter"><h2 id="hub-docker-start">Run Hub docker container</h2>        <p id="7b60010b">To run Hub container, execute the command:</p>        <div class="code-block" data-lang="bash">
            docker run -it --name hub-server-instance \
            -v &lt;path to data directory&gt;:/opt/hub/data \
            -v &lt;path to conf directory&gt;:/opt/hub/conf \
            -v &lt;path to logs directory&gt;:/opt/hub/logs \
            -v &lt;path to backups directory&gt;:/opt/hub/backups \
            -p &lt;port on host&gt;:8080 \
            jetbrains/hub:&lt;version&gt;
    </div>        <p id="d5bd836e">Command attributes:</p>        <ul class="list _bullet"><li class="list__item" id="5541e936"><p>                <code class="code">-it</code> — a flag that attaches Hub container input and output including the startup                logs to the                terminal window. Note that pressing `Ctrl+C` when the terminal is attached to a container output                causes                the container to shut down. Use `Ctrl+PQ` in order to detach the terminal from container output. For                more details, see <a href="https://docs.docker.com/engine/reference/commandline/attach/#extended-description" data-external="true" target="_blank" rel="noopener noreferrer">the official docker documentation</a>.            </p></li><li class="list__item" id="ba794fb3"><p>                <code class="code">--name hub-server-instance</code> — the arbitrary name for the container.            </p></li><li class="list__item" id="d621c5d7"><p>                <code class="code">-v &lt;path to NNN directory&gt;:/opt/hub/NNN</code> — binding the Hub-specific 'NNN'                directory on the                host machine to the respective <code class="code">/opt/hub/NNN</code> directory inside the container.            </p></li><li class="list__item" id="f01e2d9f"><p>                <code class="code">-p &lt;port on host&gt;:8080</code> — parameter that defines the ports mapping. It                instructs the                host machine to listen on port <code class="code">&lt;port on host&gt;</code> and propagate all traffic to the                port                `8080` inside the docker container.            </p></li></ul>    </div>    <div class="chapter"><h2 id="stop-docker-container">Stop Hub docker container</h2>        <p id="bb53dc90">To stop the Hub service gracefully, run the command:</p>        <div class="code-block" data-lang="bash">
            docker exec &lt;containerId&gt; stop
    </div>        <p id="b7a83450">For a graceful shutdown, you can also use the standard <code class="code">docker kill</code> command:        </p>        <div class="code-block" data-lang="bash">
            docker kill --signal=SIGTERM &lt;containerId&gt;
    </div>`        <p id="5eba295e">We do not recommend using the standard command `<code class="code">docker stop</code>`. By default, this command sends            the `<code class="code">SIGTERM</code>` signal to the Hub process inside the Docker container, then waits for 10            seconds. If Hub does not finish the shutdown within that time period, the `<code class="code">SIGKILL</code>` is sent            to the            kernel and the Hub process is killed. This may lead to data corruption. To avoid this outcome, specify            an appropriate timeout value when using this command.            For example, the following command leaves enough time for the Hub service to shut down:        </p>        <div class="code-block" data-lang="bash">
            docker stop -t 60 &lt;containerId&gt;
    </div>    </div>    <div class="chapter"><h2 id="run-container-as-service">Run Hub container as a service</h2>        <p id="d2a8d67e">Docker team recommends to use cross-platform built-in restart policy for running container as a service.            For this, <a href="https://docs.docker.com/install/linux/linux-postinstall//#configure-docker-to-start-on-boot" data-external="true" target="_blank" rel="noopener noreferrer">configure your docker service to start on system boot</a> and simply add parameter <code class="code">--restart unless-stopped</code> to the            <code class="code">docker run</code> command that starts Hub.        </p>        <p id="024916fe">However, when it comes to the sequential start of several services (including Hub), the restart policy            method will not suit.            You can <a href="https://docs.docker.com/config/containers/start-containers-automatically/#use-a-process-manager" data-external="true" target="_blank" rel="noopener noreferrer">use a process manager</a> instead.        </p>        <p id="48183142">Here's an example of how to run Hub container as a service on Linux with help of <code class="code">systemd</code>.        </p>        <section class="procedure-steps"><h3 id="25d0e93d">To run Hub container as a service on Linux with systemd</h3><ol class="list _decimal"><li class="list__item" id="c1093ba1"><p>Create a service descriptor file <code class="code">/etc/systemd/system/docker.hub.service</code>:                <div class="code-block" data-lang="bash">
                    [Unit]
                    Description=Hub Service
                    After=docker.service
                    Requires=docker.service

                    [Service]
                    TimeoutStartSec=0
                    Restart=always
                    ExecStartPre=-/usr/bin/docker exec %n stop
                    ExecStartPre=-/usr/bin/docker rm %n
                    ExecStartPre=/usr/bin/docker pull jetbrains/hub:&lt;version&gt;
                    ExecStart=/usr/bin/docker run --rm --name %n \
                    -v :/opt/hub/data \
                    -v :/opt/hub/conf \
                    -v :/opt/hub/logs \
                    -v :/opt/hub/backups \
                    -p :8080 \
                    jetbrains/hub:&lt;version&gt;

                    [Install]
                    WantedBy=default.target
    </div>            </p></li><li class="list__item" id="1e78adf5"><p>Enable starting the service on system boot with the following command:                <div class="code-block" data-lang="bash">
                    systemctl enable docker.hub
    </div>            </p></li></ol></section>        <p id="c406427f">You can also stop and start the service manually at any moment with the following commands,            respectively:        </p>        <div class="code-block" data-lang="bash">
            sudo service docker.hub stop
            sudo service docker.hub start
    </div>    </div><div class="last-modified" data-skip-index="skip">Last modified: 9 September 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="restore-docker-installation.html">Restore a Docker Installation</a><a class="navigation-links__next" href="docker-change-database-location.html">Change Database Location for Docker</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>