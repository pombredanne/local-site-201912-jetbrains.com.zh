<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Custom Widget Tutorial - Help | Hub</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="how-to-build-custom-widget"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search Hub Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>Hub 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="how-to-build-custom-widget" id="how-to-build-custom-widget.xml">Custom Widget Tutorial</h1>    <p id="cfb4b5b2">This page walks you though the steps for building a custom widget.        We decided to cover a very simple case: a sample widget that displays profile information for a user in GitHub.        This widget doesn't perform any complex operations, like authentication and authorization in a third-party service, nor does it have complex style elements.        Still, we hope that this tutorial helps you grasp the basic concept behind a custom widget.</p>    <p id="c268289c">This tutorial describes the following steps:</p>    <ul class="list _ul"><li class="list__item" id="9e6fdc27"><a href="#create-widget-manifest">Building the widget manifest</a></li><li class="list__item" id="3228a070"><a href="#create-index.html-file">Creating an entry point for your widget</a></li><li class="list__item" id="65aecc85"><a href="#create-the-script">Writing a script for the widget</a></li><li class="list__item" id="32ac0c79"><a href="#test-the-widget">Testing the widget</a></li><li class="list__item" id="8934ad00"><a href="#upload-the-widget">Uploading the widget to Hub</a></li><li class="list__item" id="1392698a"><a href="#upload-plugins-repository">Uploading the widget to the JetBrains Plugins Repository</a></li></ul>    <div class="chapter"><h2 id="create-widget-manifest" data-toc="how-to-build-custom-widget#create-widget-manifest">Create the Widget Manifest</h2>        <p id="526019f0">As the first step, we create the <code class="code">manifest.json</code> file.            This file defines the attributes for the custom widget.</p>        <p id="12cc1bff">For Hub to read and display the attributes in the widget manifest:</p>        <ul class="list _ul"><li class="list__item" id="c3191f58"><p>The file must be named <code class="code">manifest.json</code>.</p></li><li class="list__item" id="492191db"><p>The file must be stored in the top-most level of the ZIP archive.</p></li></ul>        <p id="441eb817">Here is the manifest file for our sample widget:</p>        <div class="code-block" data-lang="json">{
    "key": "github-user-widget",
    "version": "0.0.1",
    "name": "GitHub User Information",
    "description": "Widget shows information about GitHub user.",
    "author": "anonymous",
    "products": {
    "Hub": "&gt;=2018.1",
    "YouTrack": "&gt;=2018.1"
    }
}</div>        <p id="d834b0a0">Our widget manifest contains definitions for just a few attributes.        For a complete list of the attributes that you need to define in the manifest file, see <a href="building-custom-widgets.html#widget-manifest">Widget Manifest</a>.</p>    </div>    <div class="chapter"><h2 id="create-index.html-file" data-toc="how-to-build-custom-widget#create-index.html-file">Create an index.html File</h2>        <p id="33949c14">Second step is to create an entry point for your widget: an <code class="code">index.html</code> file.            This is a standard HTML5 file.            Here, we include a reference to the <code class="code">hub-dashboard-addons</code> library.            This library allows communication between the widget and the page that it is plugged into in Hub.            The file also contains CSS styles that manipulate the presentation of data retrieved from the GitHub profile.            The <code class="code">body</code> element includes the widget script itself (<code class="code">index.js</code>).</p>        <div class="code-block" data-lang="markup">
            
            &lt;!doctype html&gt;
            &lt;html&gt;
                &lt;head&gt;
                    &lt;meta charset="utf-8"&gt;
                    &lt;!-- Default styles of dashboard widgets --&gt;
                    &lt;link rel="stylesheet" type="text/css" href="https://unpkg.com/hub-dashboard-addons@latest/dashboard.css"&gt;

                    &lt;!-- Include dashboard connector from CDN --&gt;
                    &lt;script src="https://unpkg.com/hub-dashboard-addons@latest"&gt;&lt;/script&gt;

                    &lt;style&gt;
                        .user-avatar {
                            width: 64px;
                            height: 64px;
                        }
                    &lt;/style&gt;
                &lt;/head&gt;
                &lt;body&gt;
                    &lt;div id="user-details"&gt;Loading...&lt;/div&gt;

                    &lt;script src="index.js"&gt;&lt;/script&gt;
                &lt;/body&gt;
            &lt;/html&gt;
            
        </div>    </div>    <div class="chapter"><h2 id="create-the-script" data-toc="how-to-build-custom-widget#create-the-script">Create the Script</h2>        <p id="e53ade91">The third step is to create the script itself. In our case, the script retrieves and displays the user profile of a specified GitHub user.</p>    <div class="code-block" data-lang="javascript">
        
        /* Declare a constant that contains a login of the target github user */

        const USER_NAME = 'jetbrains';

        /* The following renderUserDetails(user) function creates and inserts the user profile data into the DOM */

        function renderUserDetails(user) {
            const container = document.getElementById('user-details');

            container.innerHTML = `
            &lt;img src=${user.avatar_url} class="user-avatar"/&gt;
            &lt;h4&gt;${user.name} aka &lt;a href="${user.html_url}"&gt;${user.login}&lt;/a&gt;&lt;/h4&gt;
            &lt;div&gt;
            &lt;div&gt;Followers: ${user.followers}&lt;/div&gt;
            &lt;div&gt;Repos: ${user.public_repos}&lt;/div&gt;
            `;
        }

        /* The following function actually retrieves the data from GitHub using the GitHub API.
            It uses the Fetch API (https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API) */

        function loadAndRenderUser(userLogin) {
            return fetch(`https://api.github.com/users/${userLogin}`)
            .then(response =&gt; {
                return response.ok ? response.json() : new Error(response);
            })
            .then(user =&gt; {
                renderUserDetails(user);
                return user;
            })
            .catch(err =&gt; console.warn(err));
        }

        /* The last step is to register the widget in the dashboard and initiate loading the user data.
            Also, this block defines displayed widget title and adds the refresh button.
            When you click the refresh button, the script will reload and re-render the user profile data.
            We use Dashboard API to implement this functionality. */

        // Register widget:
        Dashboard.registerWidget(function (dashboardAPI, registerWidgetAPI) {
            // Load GitHub profile data
            loadAndRenderUser(USER_NAME)
            // Set the widget title
            .then(user =&gt; dashboardAPI.setTitle(`GitHub User ${user.login}`));

            // Add the refresh button.
            registerWidgetAPI({
                onRefresh: () =&gt; loadAndRenderUser(USER_NAME)
            });
        });
        

    </div>    </div>    <div class="chapter"><h2 id="test-the-widget" data-toc="how-to-build-custom-widget#test-the-widget">Test the Widget</h2>        <p id="87caa0d5">To test the widget, we need to load it in the <span class="control">Widgets Playground</span>. First, we run a static server on the local directory with the custom widget files. In our case,            we use <a href="https://www.npmjs.com/package/http-server" data-external="true" target="_blank" rel="noopener noreferrer">npm http-server</a> that requires Node.js. To simplify the matters even more, we use a Hub service that is available over HTTP.            If you have Hub running over HTTPS, then you need to host your widget over HTTPS as well. In this case, you can give a try to <code class="code">https://ngrok.com</code> service.            For more information, see <a href="test-custom-widgets.html#testing-widgets-over-HTTPS">Testing Widgets over a Secure Connection</a>.        </p>        <section class="procedure-steps"><h3 id="d789a765">To serve the widget over HTTP:</h3><ol class="list _decimal"><li class="list__item" id="27b2c960"><p>Install the HTTP server:                <div class="code-block" data-lang="bash">npm i http-server -g</div>            </p></li><li class="list__item" id="de0e7d63"><p>                From the custom widget directory, run the HTTP server with the following command:                <div class="code-block" data-lang="bash">
                    http-server . --cors -c-1 -p 9033
    </div>                The HTTP server starts and serves the content on the current directory. In the response, you see the IP addresses (both internal and external)                at which the HTTP server is accessible. For example:                <figure><a class="lightbox" href="/help/img/hub/2019.1/http-server-started.zoomed.png"><img alt="http-server starts" title="http-server starts" src="/help/img/hub/2019.1/http-server-started.png" id="f26493d9" width="600" height="130"></a></figure>            </p></li></ol></section>        <p id="58601dfc">We run the Hub service locally, so we can load the widget into the widgets playground from the <code class="code">http://localhost:9033/</code> address.</p>        <section class="procedure-steps"><h3 id="88d123eb">To load your widget in the widgets playground:</h3><ol class="list _decimal"><li class="list__item" id="cbe67bb7">Open the <span class="control">Widgets Playground</span> page in Hub.            <ul class="list _ul"><li class="list__item" id="2f2cb08a"><p>In the <span class="control">Server Settings</span> section of the <span class="control">Administration</span> menu, select <span class="control">Custom Widgets</span>.</p></li><li class="list__item" id="cdfc35f0"><p>Click the <span class="control">Widgets playground</span> link in the header.</p></li></ul></li><li class="list__item" id="3aa8edfc"><p>Enter the web address for your custom widget in the input field. In our case, <code class="code">http://localhost:9033/</code></p></li><li class="list__item" id="8beb9dd1">Click the <span class="control">Load widget</span> button.                <ul class="list _ul"><li class="list__item" id="62e86457"><p>The widget is loaded and displayed in the widgets playground.                        <figure><a class="lightbox" href="/help/img/hub/2019.1/widget-playground.zoomed.png"><img alt="Widget playground" title="Widget playground" src="/help/img/hub/2019.1/widget-playground.png" id="6ba1e768" width="600" height="328"></a></figure></p></li></ul>            </li></ol></section>        <p id="2d9b597b">If you modify the code and upload these changes to your web server, use the <span class="control">Reload widget</span>            button to refresh the widget content and test the updates.</p>        <p id="78e86d85">To learn more about testing custom widgets, see <a href="test-custom-widgets.html">Test a Custom Widget</a>.</p>    </div>    <div class="chapter"><h2 id="upload-the-widget" data-toc="how-to-build-custom-widget#upload-the-widget">Upload the Widget</h2>        <p id="9619ed12">Now that we successfully tested the widget in the playground, we can upload it to the production environment.</p>        <p id="4390ef18">First, we create a ZIP archive with the widget files. You can use any archive application to your liking. Just remember that <code class="code">manifest.json</code> and <code class="code">index.html</code> files must be located on the top-most level of the ZIP archive.</p>        <p id="121116ee">For example, we used command line prompt in macOS to create the archive. Our sample widget contains only three files and all of them are located in the same directory without any subdirectories. Thus the command to create the archive is very simple (run in the custom widget directory):</p>            <div class="code-block" data-lang="bash">zip custom-widget.zip *</div>        <p id="bd610993">We created the <code class="code">custom-widget.zip</code> file. Now we just need to upload it to the production environment:</p>        <section class="procedure-steps"><h3 id="upload-sample-widget-to-production">To upload your widget:</h3><ol class="list _decimal"><li class="list__item" id="15fd200a"><p>Open the <span class="control">Custom Widgets</span> page in Hub.</p></li><li class="list__item" id="b1460f40">Click the <span class="control">New widget</span> button.                <ul class="list _ul"><li class="list__item" id="81553061"><p>The <span class="control">New widget</span> dialog opens.</p></li></ul>            </li><li class="list__item" id="afe84b15">Select the ZIP archive to upload.                <figure><a class="lightbox" href="/help/img/hub/2019.1/new-widget-dialog-with-info.zoomed.png"><img alt="New widget dialog with info" title="New widget dialog with info" src="/help/img/hub/2019.1/new-widget-dialog-with-info.png" id="7ae18321" width="600" height="358"></a></figure>                <ul class="list _ul"><li class="list__item" id="6e38b906"><p>The information from the <code class="code">manifest.json</code> file is shown in the dialog.</p></li></ul>            </li><li class="list__item" id="33155510">Click the <span class="control">Upload</span> button.                <ul class="list _ul"><li class="list__item" id="59ef56a0"><p>The widget is uploaded to the server and displayed in the list of available custom widgets.                    <figure><a class="lightbox" href="/help/img/hub/2019.1/custom-widget-uploaded-to-production.zoomed.png"><img alt="Custom widget uploaded to production" title="Custom widget uploaded to production" src="/help/img/hub/2019.1/custom-widget-uploaded-to-production.png" id="6fcadac5" width="600" height="311"></a></figure>                        It also appears in the <span class="control">Add widget</span> drop-down menu on dashboards and project overview pages:                        <figure><a class="lightbox" href="/help/img/hub/2019.1/dashboard-custom-widget-menu.zoomed.png"><img alt="Dashboard custom widget menu" title="Dashboard custom widget menu" src="/help/img/hub/2019.1/dashboard-custom-widget-menu.png" id="f4a7f71c" width="600" height="264"></a></figure>                    </p></li></ul>            </li></ol></section>        <p id="ef7ba2cd">That's it! The new custom widget is available to users in Hub and can be added to dashboards and project overview pages.</p>    </div>    <div class="chapter"><h2 id="upload-plugins-repository" data-toc="how-to-build-custom-widget#upload-plugins-repository">Upload the Widget to the JetBrains Plugins Repository</h2>        <p id="797814d5">The final and optional step is to share your widget with other companies who are working with Hub by uploading your widget to the <a href="https://plugins.jetbrains.com/" data-external="true" target="_blank" rel="noopener noreferrer">JetBrains Plugins Repository</a>.</p>        <section class="procedure-steps"><h3 id="e3dfdb45">To upload your widget to the repository:</h3><ol class="list _decimal"><li class="list__item" id="afcfe042"><p>In your web browser, access the <a href="https://plugins.jetbrains.com/" data-external="true" target="_blank" rel="noopener noreferrer">JetBrains Plugins Repository</a>.</p></li><li class="list__item" id="04316705">Click the <span class="control">Sign In</span> button in the header.            <ul class="list _ul"><li class="list__item" id="90355e8f"><p>If you already have a JetBrains Account, enter your email address and password.</p></li><li class="list__item" id="4620b93f"><p>If you don't have a JetBrains Account, register with your email address and create an account.</p></li></ul></li><li class="list__item" id="7fa8edc9">From the header, select <span data-skip-index="skip" class="menupath">Team Tools &gt; Hub</span>.            <ul class="list _ul"><li class="list__item" id="10a55746"><p>The <span class="control">Hub Widgets</span> page opens.</p></li></ul></li><li class="list__item" id="58082dfb">Click the <span class="control">Upload Widget</span> button in the header.            <ul class="list _ul"><li class="list__item" id="6ad8c57b"><p>The <span class="control">Adding new widget</span> page opens.</p></li></ul></li><li class="list__item" id="a6479cfc"><p>Select a <span class="control">Category</span> from the drop-down list.</p></li><li class="list__item" id="12996885"><p>Click the <span class="control">Choose File</span> button and select the ZIP archive that contains your custom widget.</p></li><li class="list__item" id="1d0fdc75">Click the <span class="control">Upload New Plugin</span> button.            <ul class="list _ul"><li class="list__item" id="c003b605"><p>Your custom widget is uploaded to the JetBrains Plugins Repository.</p></li><li class="list__item" id="47eb39a1"><p>When a moderator has reviewed the widget and approved it for publication, the widget is added to the directory.</p></li></ul></li></ol></section>    </div><div class="last-modified" data-skip-index="skip">Last modified: 9 September 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="building-custom-widgets.html">Widget Development Guide</a><a class="navigation-links__next" href="test-custom-widgets.html">Test a Custom Widget</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>