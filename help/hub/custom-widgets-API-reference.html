<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');</script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>自定义小部件API参考-帮助|毂</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="custom-widgets-API-reference"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索中心帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>Hub 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="custom-widgets-API-reference.xml" data-toc="custom-widgets-API-reference">自定义小部件API参考</h1>    <p id="3cbe2a5f">我们为JavaScript提供了一个自定义库，其中包括用于处理自定义小部件的API。要安装此库，请使用以下实现之一：</p>    <ul class="list _ul"><li class="list__item" id="fd9abb07"><p>在您的标题中的<a href="https://unpkg.com/hub-dashboard-addons@latest" rel="noopener noreferrer" data-external="true" target="_blank">unpkg上</a>添加对<a href="https://unpkg.com/hub-dashboard-addons@latest" rel="noopener noreferrer" data-external="true" target="_blank">仪表板脚本</a>的引用<code class="code">index.html</code>文件。将参考包装在<code class="code"><script></code>标签。例如：</p><div class="code-block" data-lang="markup">
                <script src="https://unpkg.com/hub-dashboard-addons@latest"></script>
            </div>        <p></p></li><li class="list__item" id="10765e75"><p>使用npm软件包管理器将脚本与<code class="code">npm install hub-dashboard-addons</code>命令。然后，您可以根据需要在小部件中添加对脚本的引用。</p></li></ul>    <p id="7ca5b1f8">的<code class="code">Dashboard.registerWidget</code>函数接受用调用的回调<code class="code">dashboardAPI</code>和<code class="code">registerWidgetAPI</code>参数如下面的代码示例所示。要在上下文中查看此示例，请参考<a href="how-to-build-custom-widget.html#create-the-script">创建脚本</a> 。</p>    <div class="code-block" data-lang="javascript">//注册小部件：Dashboard.registerWidget（function（dashboardAPI，registerWidgetAPI）{//加载GitHub配置文件数据loadAndRenderUser（USER_NAME）//设置小部件标题.then（user => dashboardAPI.setTitle（`GitHub User $ {user.login }`））; //添加刷新按钮。registerWidgetAPI（{onRefresh：（）=> loadAndRenderUser（USER_NAME）}）; }）;</div>    <p id="bdfb3413">使用以下参考来为您的Hub仪表板和项目概述页面构建自定义窗口小部件。</p>    <div class="chapter"><h2 id="dashboard-API" data-toc="custom-widgets-API-reference#dashboard-API">仪表板API</h2>        <p id="70945b62">使用仪表板API与窗口小部件包装程序和窗口小部件插入的页面进行通信。所有这些方法都是异步的并返回<code class="code">Promise</code>对象。这些方法适用于<code class="code">dashboardApi</code>宾语。</p>        <div class="chapter"><h3 id="alert" data-toc="custom-widgets-API-reference#alert">警报</h3>            <p id="3ebbea44">在页面的右下角显示系统警报。</p>            <h4 id="324a2d19">句法</h4>            <div class="code-block" data-lang="javascript">警报（消息：字符串，？类型：字符串，？超时：整数）：字符串</div>            <h4 id="cbb0e96b">参量</h4>            <div class="table-wrapper"><table class=" wide" width="100%" id="6f72523e"><thead><tr id="2a21c03f" class="ijRowHead"><th id="5822a6bd"><p>参数</p></th><th id="388bf4fd"><p>类型</p></th><th id="c5ec8bab"><p>描述</p></th></tr></thead><tbody><tr id="a9154665" class="ijRowOdd"><td id="178a7e37"><p>信息</p></td><td id="7d7cfa1c"><p>串</p></td><td id="ef0ef793"><p>设置显示为系统警报的文本。</p></td></tr><tr id="e73b950f" class="ijRowEven"><td id="f9fb6e77"><p>类型</p></td><td id="d9be2417"><p>串</p></td><td id="115cffa9"><p>确定将哪种通知样式应用于警报。可能的值包括<code class="code">error</code> ， <code class="code">message</code> ， <code class="code">success</code>和<code class="code">warning</code> 。</p></td></tr><tr id="51577b75" class="ijRowOdd"><td id="0d5e3cdc"><p>超时</p></td><td id="e115148b"><p>整数</p></td><td id="1e752afc"><p>警报显示在页面上的时间，以秒为单位。</p></td></tr></tbody></table></div>            <h4 id="f117e399">例</h4>            <div class="code-block" data-lang="javascript">dashboardApi.alert（'这是标准通知'，'消息'）; dashboardApi.alert（'这是一个错误'，'错误'，10000）;</div>        </div>        <div class="chapter"><h3 id="clearError" data-toc="custom-widgets-API-reference#clearError">clearError</h3>            <p id="a026b28e">删除使用<a href="#setError">setError</a>方法添加到小部件标题的警告图标。</p>            <p id="49db3877">自Hub 2019.1起可用。XXXXX</p>            <h4 id="75fb93ae">句法</h4>            <div class="code-block" data-lang="javascript">clearError（）：无效</div>        </div>        <div class="chapter"><h3 id="enterConfigMode" data-toc="custom-widgets-API-reference#enterConfigMode">enterConfigMode</h3>            <p id="ead07a59">调用配置模式。在配置模式下，窗口小部件的外观会发生变化，以指示可以更新其设置。<span class="control">刷新</span>图标也被隐藏。</p>            <h4 id="5d67790e">句法</h4>            <div class="code-block" data-lang="javascript">enterConfigMode（）：无效</div>        </div>        <div class="chapter"><h3 id="exitConfigMode" data-toc="custom-widgets-API-reference#exitConfigMode">exitConfigMode</h3>            <p id="d3e1c054">退出配置模式。</p>            <h4 id="bdab2c63">句法</h4>            <div class="code-block" data-lang="javascript">exitConfigMode（）：无效</div>        </div>        <div class="chapter"><h3 id="fetch" data-toc="custom-widgets-API-reference#fetch">取</h3>            <p id="11ea6efb">向指定的服务提出授权请求。该服务必须在小部件清单中指定。</p>            <h4 id="0427e9bc">句法</h4>            <div class="code-block" data-lang="javascript">fetch（serviceID：字符串，url：字符串，fetchConfig：对象）：承诺<object></object></div>            <h4 id="6aeccdf2">参量</h4>            <div class="table-wrapper"><table class=" wide" width="100%" id="e1eaf356"><thead><tr id="ad6b9822" class="ijRowHead"><th id="534b72cb"><p>参数</p></th><th id="5eef63d6"><p>类型</p></th><th id="a14a0738"><p>描述</p></th></tr></thead><tbody><tr id="18fcbca8" class="ijRowOdd"><td id="ac2e66c5"><p>serviceID</p></td><td id="af5767fa"><p>串</p></td><td id="854ed2b0"><p>指定服务的ID。要获取服务ID， <a href="#fetchHub">请</a>首先使用<a href="#fetchHub">fetchHub</a> 。有关详细信息，请参见<a href="HUB-REST-API_Services_Get-All-Services.html">获取所有服务</a> 。</p></td></tr><tr id="34c0aaf4" class="ijRowEven"><td id="e34e38b5"><p>网址</p></td><td id="6da8a382"><p>串</p></td><td id="d0ebae11"><p>将URL设置为服务API端点。这是您要获取的资源的路径。该URL是相对于服务器主URL的。</p></td></tr><tr id="61a7e74b" class="ijRowOdd"><td id="67909539"><p>fetchConfig</p></td><td id="6864e86b"><p>宾语</p></td><td id="0dcb45ca"><p>定义一个可选的options对象。该对象包含要应用于请求的任何自定义设置。</p></td></tr></tbody></table></div>            <h4 id="eda7542e">例</h4>            <div class="code-block" data-lang="javascript">consoleApi.fetch（serviceId，'api / users'）.then（users => console.log（users））;</div>            <p id="7342022f">以下示例显示了如何在POST请求中使用此方法：</p>            <div class="code-block" data-lang="javascript">panelApi.fetch（serviceId，'api / users'，{方法：'POST'，正文：{payload：'test'}}}）.then（result => console.log（result））;</div>        </div>        <div class="chapter"><h3 id="fetchHub" data-toc="custom-widgets-API-reference#fetchHub">fetchHub</h3>            <p id="03ef1da0">向集线器服务提出授权请求。</p>            <h4 id="1f1d6ac8">句法</h4>            <div class="code-block" data-lang="javascript">fetchHub（URL：字符串，fetchConfig：对象）：承诺<object></object></div>            <h4 id="23964599">参量</h4>            <div class="table-wrapper"><table class=" wide" width="100%" id="a272b25b"><thead><tr id="b02d8029" class="ijRowHead"><th id="ba5520e6"><p>参数</p></th><th id="2e44114d"><p>类型</p></th><th id="f9c3ee0b"><p>描述</p></th></tr></thead><tbody><tr id="e64322c2" class="ijRowOdd"><td id="191d8122"><p>网址</p></td><td id="0ba77a7f"><p>串</p></td><td id="b37c6654"><p>将URL设置为集线器服务API端点。这是您要获取的资源的路径。该URL是相对于服务器主URL的。有关更多信息，请参阅<a href="Hub-Rest-Api-URL.html">REST API URL和端点</a> 。</p></td></tr><tr id="fedd4d62" class="ijRowEven"><td id="3ace5a03"><p>fetchConfig</p></td><td id="43630d8b"><p>宾语</p></td><td id="c709fc23"><p>定义一个可选的options对象。该对象包含要应用于请求的任何自定义设置。</p></td></tr></tbody></table></div>            <h4 id="e84defa8">例</h4>            <div class="code-block" data-lang="javascript">consoleApi.fetchHub（'api / rest / users / me？fields = name，login，profile（avatar（url））'）.then（响应=> console.log（response））;</div>            <p id="93153ca6">以下示例显示了如何在POST请求中使用此方法：</p>            <div class="code-block" data-lang="javascript">dashboardApi.fetchHub（'api / rest / users / me'，{方法：'POST'，正文：{favoriteProjects：[]}}）.then（response => console.log（response））;</div>        </div>        <div class="chapter"><h3 id="loadServices" data-toc="custom-widgets-API-reference#loadServices">loadServices</h3>            <p id="7ef3a5e3">返回连接到集线器服务且满足以下要求的最低版本要求的服务列表： <code class="code">dependencies</code>的部分<code class="code">manifest.json</code>小部件的文件。</p>            <ul class="list _ul"><li class="list__item" id="41429dac"><p>如果使用指定的服务<code class="code">applicationName</code>参数未在中引用<code class="code">dependencies</code>小部件清单的“部分”，将引发异常。</p></li><li class="list__item" id="782e9537"><p>如果连接到集线器服务的指定服务不满足最低版本要求，则返回一个空数组。</p></li></ul>            <h4 id="4e8ae157">句法</h4>            <div class="code-block" data-lang="javascript">loadServices（applicationName：string）：承诺<array><object>><object>            <h4 id="ded00427">参量</h4>            <div class="table-wrapper"><table class=" wide" width="100%" id="59814011"><thead><tr id="6cccb099" class="ijRowHead"><th id="18c099c1"><p>参数</p></th><th id="46200af3"><p>类型</p></th><th id="433544cb"><p>描述</p></th></tr></thead><tbody><tr id="634cc031" class="ijRowOdd"><td id="d514a02e"><p>应用名称</p></td><td id="8f53ea53"><p>串</p></td><td id="ceee2204"><p>确定对照哪些服务进行检查<code class="code">dependencies</code>在小部件清单中。</p></td></tr></tbody></table></div>            <h4 id="1e61d2ca">例</h4>            <p id="9b938326">以下示例检查集线器服务中与以下版本中引用的YouTrack版本兼容的YouTrack版本： <code class="code">dependencies</code>小部件清单的部分。该应用程序的兼容版本列表已打印到控制台。</p>            <div class="code-block" data-lang="javascript">dasboardApi.loadServices（'YouTrack'）.then（youtracks => console.log（youtracks [0]））;</div>                <div class="chapter"><h3 id="readCache" data-toc="custom-widgets-API-reference#readCache">readCache</h3>            <p id="517d1a20">读取并返回以前存储在缓存中的对象。</p>            <h4 id="159610e6">句法</h4>            <div class="code-block" data-lang="javascript">readCache（）：承诺<object></object></div>        </div>        <div class="chapter"><h3 id="readConfig" data-toc="custom-widgets-API-reference#readConfig">readConfig</h3>            <p id="5e907800">读取并返回以前存储为配置对象的对象。</p>            <h4 id="e01c7a2d">句法</h4>            <div class="code-block" data-lang="javascript">readConfig（）：承诺<object></object></div>        </div>        <div class="chapter"><h3 id="removeWidget" data-toc="custom-widgets-API-reference#removeWidget">removeWidget</h3>            <p id="c6a2b35d">从仪表板或项目概述页面中删除自定义窗口小部件。</p>            <h4 id="b772ef67">句法</h4>            <div class="code-block" data-lang="javascript">removeWidget（）：无效</div>        </div>        <div class="chapter"><h3 id="setLoadingAnimationEnabled" data-toc="custom-widgets-API-reference#setLoadingAnimationEnabled">setLoadingAnimationEnabled</h3>            <p id="d68538a1">切换小部件重新加载图标的图像旋转动画。当窗口小部件从远程服务器填充数据以指示进程正在后台运行时，请调用此方法。</p>            <h4 id="26117d85">句法</h4>            <div class="code-block" data-lang="javascript">setLoadingAnimationEnabled（enabled：boolean）：void</div>            <h4 id="b8b2fddc">参量</h4>            <div class="table-wrapper"><table class=" wide" width="100%" id="7a29a79d"><thead><tr id="9a5d4de5" class="ijRowHead"><th id="1ebb62df"><p>参数</p></th><th id="7cd5c23e"><p>类型</p></th><th id="d8d8faad"><p>描述</p></th></tr></thead><tbody><tr id="9d302dac" class="ijRowOdd"><td id="0398911e"><p>已启用</p></td><td id="ed27825b"><p>布尔型</p></td><td id="075a4076"><p>确定小部件重新加载图标是否旋转。</p></td></tr></tbody></table></div>        </div>        <div class="chapter"><h3 id="setError" data-toc="custom-widgets-API-reference#setError">setError</h3>            <p id="3b5a093d">在小部件标题的标题左侧添加警告图标。为该字符串指定的文本字符串<code class="code">data</code>当用户将指针悬停在警告图标上时，将显示参数。</p>            <p id="1e74f759">自Hub 2019.1起可用。XXXXX</p>            <h4 id="a6e5a943">句法</h4>            <div class="code-block" data-lang="javascript">setError（data：string）：无效</div>            <h4 id="c13d5959">参量</h4>            <div class="table-wrapper"><table class=" wide" width="100%" id="c7111a46"><thead><tr id="53633b8d" class="ijRowHead"><th id="3d3f814c"><p>参数</p></th><th id="2a40ba14"><p>类型</p></th><th id="b52dd684"><p>描述</p></th></tr></thead><tbody><tr id="9eada7d3" class="ijRowOdd"><td id="e097b608"><p>数据</p></td><td id="a465bfaa"><p>串</p></td><td id="c3880239"><p>用户将鼠标悬停在警告图标上时显示的文本。</p></td></tr></tbody></table></div>        </div>        <div class="chapter"><h3 id="setTitle" data-toc="custom-widgets-API-reference#setTitle">setTitle</h3>            <p id="f2f7bd1e">设置显示在小部件标题中的文本。如果为<code class="code">labelUrl</code>参数，将文本设置为到目标URL的链接。</p>            <h4 id="88723478">句法</h4>            <div class="code-block" data-lang="javascript">setTitle（label：字符串，？labelUrl：字符串）：无效</div>            <h4 id="e39a8b3a">参量</h4>            <div class="table-wrapper"><table class=" wide" width="100%" id="3b38c7a3"><thead><tr id="6a7eb18c" class="ijRowHead"><th id="591ce86e"><p>参数</p></th><th id="99c7714b"><p>类型</p></th><th id="b13372b0"><p>描述</p></th></tr></thead><tbody><tr id="95ea63e6" class="ijRowOdd"><td id="e5c52d44"><p>标签</p></td><td id="b025c058"><p>串</p></td><td id="49831341"><p>显示为小部件标题的文本字符串。</p></td></tr><tr id="fa1afe8b" class="ijRowEven"><td id="7e4283da"><p>labelURL</p></td><td id="4745759d"><p>串</p></td><td id="88f40911"><p>用户单击窗口小部件标题时打开的目标页面的地址。如果未指定此可选参数，则将小部件标题设置为仅文本。</p></td></tr></tbody></table></div>            <h4 id="76242972">例</h4>            <div class="code-block" data-lang="javascript">consoleApi.setTitle（'Some widget'）; consoleApi.setTitle（'A链接标头'，'https://example.com'）;</div>        </div>        <div class="chapter"><h3 id="storeCache" data-toc="custom-widgets-API-reference#storeCache">storeCache</h3>            <p id="84f0565f">将任何对象存储在客户端缓存中。使用此方法可将填充的数据本地存储并立即在仪表板上显示，然后从服务器刷新它。返回配置对象。</p>            <h4 id="7388bf2a">句法</h4>            <div class="code-block" data-lang="javascript">storeCache（cache：Object）：承诺<void></void></div>            <h4 id="ed38c5f9">参量</h4>            <div class="table-wrapper"><table class=" wide" width="100%" id="3700d869"><thead><tr id="6e925e44" class="ijRowHead"><th id="946d4adf"><p>参数</p></th><th id="7b4891da"><p>类型</p></th><th id="2b01c036"><p>描述</p></th></tr></thead><tbody><tr id="9921400e" class="ijRowOdd"><td id="d0917023"><p>快取</p></td><td id="2c811364"><p>宾语</p></td><td id="373685ab"><p>指定要存储在缓存中的对象。</p></td></tr></tbody></table></div>        </div>        <div class="chapter"><h3 id="storeConfig" data-toc="custom-widgets-API-reference#storeConfig">storeConfig</h3>            <p id="8d06fd29">将任何对象存储为小部件配置。如果配置模式处于活动状态，则退出配置模式。</p>            <h4 id="8117ac13">句法</h4>            <div class="code-block" data-lang="javascript">storeConfig（config：Object）：承诺<void></void></div>            <h4 id="3f2e1e90">参量</h4>            <div class="table-wrapper"><table class=" wide" width="100%" id="513a0af2"><thead><tr id="c07e5210" class="ijRowHead"><th id="ba62f1ab"><p>参数</p></th><th id="ba0e1ca0"><p>类型</p></th><th id="1628c845"><p>描述</p></th></tr></thead><tbody><tr id="e114c125" class="ijRowOdd"><td id="fc0224fb"><p>配置</p></td><td id="e1be14ad"><p>宾语</p></td><td id="9bc475ae"><p>指定要存储为小部件配置的对象。</p></td></tr></tbody></table></div>        </div>        <div class="chapter"><h2 id="widget-API" data-toc="custom-widgets-API-reference#widget-API">小部件API</h2>        <p id="a08c4b9c">使用小部件API可以控制自定义小部件上控件的可见性。这些方法适用于<code class="code">widgetApi</code>宾语。</p>        <div class="chapter"><h3 id="onConfigure" data-toc="custom-widgets-API-reference#onConfigure">onConfigure</h3>            <p id="29bbcf63">从小部件菜单中选择“ <span class="control">编辑”</span>选项时，调用一个动作。如果未设置，则不显示“ <span class="control">编辑”</span>选项。</p>            <h4 id="6e32efb7">句法</h4>            <div class="code-block" data-lang="javascript">onConfigure（）：无效</div>        </div>        <div class="chapter"><h3 id="onRefresh" data-toc="custom-widgets-API-reference#onRefresh">onRefresh</h3>            <p id="30507365">在窗口小部件标题中单击<span class="control">刷新</span>图标时，调用操作。如果未设置，则<span class="control">刷新</span>图标不会显示在标题中。</p>            <h4 id="74438841">句法</h4>            <div class="code-block" data-lang="javascript">onRefresh（）：？诺言<void></void></div>        </div>    </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年9月9日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="test-custom-widgets.html">测试自定义小部件</a> <a class="navigation-links__next" href="sample-custom-widgets.html">样本自定义小部件</a></div><div id="disqus_thread" data-skip-index="skip"></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></object></object></array></div></div></div></article></div></section></main></div></body></html>