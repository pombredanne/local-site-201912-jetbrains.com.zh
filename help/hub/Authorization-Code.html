<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Authorization Code - Help | Hub</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Authorization-Code"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search Hub Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>Hub 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Authorization-Code" id="Authorization-Code.xml">Authorization Code</h1>    <a name="Authorization code flow"></a>    <div class="chapter"><h2 id="StandardReference" data-toc="Authorization-Code#StandardReference">Reference to the Standard</h2>        <p id="e77ad64a">See            <a href="https://tools.ietf.org/html/rfc6749#section-4.1" data-external="true" target="_blank" rel="noopener noreferrer">Authorization code flow specification</a>            for more info.        </p>    </div>    <a name="Prerequisites"></a>    <div class="chapter"><h2 id="PreRequisites" data-toc="Authorization-Code#PreRequisites">Prerequisites</h2>        <p id="e29c131c"><b id="dd84f67a">Client is a web application</b>.        </p>        <p id="1db8a245">            A web application is a confidential client running on a web server. Resource owners access the client via                an HTML user                interface rendered in a user-agent on the device used by the resource owner. The client credentials as                well as any access                token issued to the client are stored on the web server and are not exposed to or accessible by the                resource owner.        </p>        <dl><dt id="9827c904">Client service_ID</dt><dd>An ID of the service associated with the client in Hub.</dd><dt id="48aae6b7">Client service_secret</dt><dd>The secret of the service associated with the client in Hub.</dd><dt id="2717c972">scope</dt><dd>A space separated list of IDs of the registered in Hub services associated with the                resource servers. For example, if the client wants to access issues in YouTrack it should find out the                ID                of YouTrack service in Hub. The client can access more then one resource server with a single access                token.            </dd><dt id="ae7418bc">redirect_URI of the client</dt><dd>An URI at the client application that can handle response from                authorization server.            </dd><dt id="2c5ebd4b">Hub URL</dt><dd>An URL of Hub server.</dd><dt id="83b06f2e">State</dt><dd>An identifier of current application state. For example, it can be a key for a local                storage                object that contains information about current user location in the client service.            </dd><dt id="36d8b564">request_credentials</dt><dd>A parameter that controls if login form should be shown to a user.                Following values are valid:                <ul class="list _bullet"><li class="list__item" id="aba5bc71">                        <p id="0bbbc19a">                            <code class="code">skip</code>                            — use this option, if the client service generally allows anonymous access.                            It works as following:                        </p>                        <ul class="list _bullet"><li class="list__item" id="43c4de86"><p>if the user is already logged in to Hub, then authorize her to the client service,</p></li><li class="list__item" id="883680b7"><p>if the user is not logged in to Hub and guest account is not banned, then authorize                                guest to                                the client service,                            </p></li><li class="list__item" id="6d2c4b53"><p>if the user is not logged in to Hub and guest account is banned then navigate to login                                form.                            </p></li></ul>                    </li><li class="list__item" id="dc246ee1"><p>                        <code class="code">silent</code>                        — same as<code class="code">skip</code>, but will return back anyway. If guest account is banned, then                        this option returns to the client service with an authentication error.                    </p></li><li class="list__item" id="5366b506"><p>                        <code class="code">required</code>                        — logs out user and shows login form. Use this option as a response to                        log out in the client service.                    </p></li><li class="list__item" id="ebfe1060">                        <p id="41ea2df9">                            <code class="code">default</code>                            — use this option if the client service does not allow anonymous access.                            It works as following:                        </p>                        <ul class="list _bullet"><li class="list__item" id="02c5cc9d"><p>if the user is already logged in to Hub, then authorize her to the client service,</p></li><li class="list__item" id="26b4a253"><p>if the user is not logged in to Hub, then navigate her to login form.</p></li></ul>                    </li></ul>            </dd><dt id="7985a933">access_type</dt><dd>                Indicates whether the application requires access to Hub when the user is not online.                Allowed values: <code class="code">online</code> (used by default) and <code class="code">offline</code>. If the application                requires refreshing access tokens when the user is not online, use the <code class="code">offline</code> value.                In this case Hub issues a <a href="Refresh-Token.html">refresh token</a> for the application the first time it exchanges an authorization code for a user.                Refer to the <a href="Refresh-Token.html">Refresh Token</a> page for more information.            </dd></dl>    </div>    <a name="Send User to the Authorization Server (Hub)"></a>    <div class="chapter"><h2 id="SendUserToHub" data-toc="Authorization-Code#SendUserToHub">Sending User to the Authorization Server (Hub)</h2>        <p id="46f8e589">To start authentication code should send to browser redirect response to the URL in the following format:</p>        <div class="code-block" data-lang="markup">
            ${Hub Service URL}/api/rest/oauth2/auth?response_type=code&amp;state=${State}&amp;redirect_uri=${Client redirect URI}&amp;request_credentials=${Request credentials mode}&amp;client_id=${Client service ID}&amp;scope=${Scope}&amp;access_type={online|offline}
        </div>.        <p id="0b3d4d58">Example:</p>        <div class="code-block" data-lang="markup">
            https://hub.company.com/api/rest/oauth2/auth?response_type=code&amp;state=9b8fdea0-fc3a-410c-9577-5dee1ae028da&amp;redirect_uri=https%3A%2F%2Fmyservice.company.com%2Fauthorized&amp;request_credentials=skip&amp;client_id=98071167-004c-4ddf-ba37-5d4599fdf319&amp;scope=0-0-0-0-0%2098071167-004c-4ddf-ba37-5d4599fdf319
        </div>        <p id="74f89fa5">To instruct Hub to issue the refresh token, add the <code class="code">access_type=offline</code> parameter to your request:</p>        <div class="code-block" data-lang="markup">
            ${Hub Service URL}/api/rest/oauth2/auth?response_type=code&amp;state=${State}&amp;redirect_uri=${Client redirect URI}&amp;request_credentials=${Request credentials mode}&amp;client_id=${Client service ID}&amp;scope=${Scope}&amp;access_type=offline
        </div>.    </div>    <a name="Handle Redirect Back from the Authorization Server"></a>    <div class="chapter"><h2 id="HandleRedirectFromHub" data-toc="Authorization-Code#HandleRedirectFromHub">Handling Redirect Back from the Authorization Server (Hub)</h2>        <p id="692ff398">If the resource owner grants the access request, the Hub issues an authorization code and delivers it to the client by            adding the following parameters to the query component of the redirection URI using the            <code class="code">"application/x-www-form-urlencoded"</code>            format:        </p>        <dl><dt id="eaec15b0">code</dt><dd>                The authorization code generated by the                authorization server. The authorization code will expire                shortly after it is issued to mitigate the risk of leaks.                The client must not use the authorization code                more than once. If an authorization code is used more than                once, Hub will deny the request.                The authorization code is bound to                the client identifier and redirection URI.            </dd><dt id="ce187d89">state</dt><dd>                The exact value received from the                client in the authorization request.            </dd></dl>        <p id="da81cc5e">For example, the authorization server (Hub) redirects the user-agent by            sending the following HTTP response:        </p>        <div class="code-block" data-lang="markup">
            HTTP/1.1 302 Found
            Location: https://myservice.company.com/authorized?code=SplxlOBeZQQYbYS6WxSbIA&amp;state=xyz
        </div>        <p id="f7089280">The client must ignore unrecognized response parameters.</p>    </div>    <div class="chapter"><h2 id="ErrorRedirectFromHub" data-toc="Authorization-Code#ErrorRedirectFromHub">Handling Error Redirect Back from Hub</h2>        <p id="4b4eb7f8">            If the resource owner denies the access request or if the request            fails for reasons other than a missing or invalid redirection URI,            Hub informs the client by adding the following            parameters to the query component of the redirection URI using the            "<code class="code">application/x-www-form-urlencoded</code>" format:        </p>        <dl><dt id="272bd898">error</dt><dd>                <p id="1ccd8b69">A single ASCII [USASCII] error code from the                    following:                </p>                <ul class="list _bullet"><li class="list__item" id="3f6995d0"><p>                        <code class="code">invalid_request</code>                        -                        The request is missing a required parameter, includes an                        invalid parameter value, includes a parameter more than                        once, or is otherwise malformed.                    </p></li><li class="list__item" id="7a9fd054"><p>                        <code class="code">unauthorized_client</code>                        -                        The client is not authorized to request an authorization                        code using this method.                    </p></li><li class="list__item" id="8ef6966f"><p>                        <code class="code">access_denied</code>                        -                        The resource owner or Hub denied the request.                    </p></li><li class="list__item" id="30a8a90c"><p>                        <code class="code">unsupported_response_type</code>                        Hub does not support obtaining an                        authorization code using this method.                    </p></li><li class="list__item" id="9b13e88a"><p>                        <code class="code">invalid_scope</code>                        The requested scope is invalid, unknown, or malformed.                    </p></li><li class="list__item" id="53e83c95"><p>                        <code class="code">server_error</code>                        The Hub server encountered an unexpected                        condition that prevented it from fulfilling the request.                        (This error code is needed because a 500 Internal Server                        Error HTTP status code cannot be returned to the client                        via an HTTP redirect.)                    </p></li><li class="list__item" id="955bdfdb"><p>                        <code class="code">temporarily_unavailable</code>                        The authorization server is currently unable to handle                        the request due to a temporary overloading or maintenance                        of the server. (This error code is needed because a 503                        Service Unavailable HTTP status code cannot be returned                        to the client via an HTTP redirect.)                    </p></li></ul>            </dd><dt id="278293ef">error_description</dt><dd>                Human-readable ASCII [USASCII] text providing                additional information, used to assist the client developer in                understanding the error that occurred.            </dd><dt id="00655b4b">error_uri</dt><dd>                A URI identifying a human-readable web page with                information about the error, used to provide the client                developer with additional information about the error.            </dd><dt id="c9471af6">state</dt><dd>                Required if a "state" parameter was present in the client                authorization request. The exact value received from the                client.            </dd></dl>    </div>    <div class="chapter"><h2 id="ExchangingCodeForToken" data-toc="Authorization-Code#ExchangingCodeForToken">Exchanging Code for an Access Token</h2>        <p id="f94ec8e7">After the client receives the code it can exchange it for an access token.</p>        <p id="d09fa07b">The client makes a request to the Hub token endpoint by sending the following parameters using            the "<code class="code">application/x-www-form-urlencoded</code>"            format with a character encoding of UTF-8 in the HTTP request entity-body:        </p>        <div class="code-block" data-lang="markup">
            POST /api/rest/oauth2/token
            Host: ${Hub Service URL}
            Accept: application/json
            Authorization: Basic ${base64(${Client service ID} + ":" + ${Client service secret})}
            Content-Type: application/x-www-form-urlencoded

            grant_type=authorization_code&amp;code=${Code received on a previous step}&amp;redirect_uri=${Client redirect URI}
        </div>        <p id="6766e149">Example:</p>        <div class="code-block" data-lang="markup">
            POST /api/rest/oauth2/token
            Host: hub.company.com
            Accept: application/json
            Authorization: Basic OTgwNzExNjctMDA0Yy00ZGRmLWJhMzctNWQ0NTk5ZmRmMzE5OmVBVXlLZ1ZmaFNiVg0K
            Content-Type: application/x-www-form-urlencoded

            grant_type=authorization_code&amp;code=SplxlOBeZQQYbYS6WxSbIA&amp;redirect_uri=https%3A%2F%2Fmyservice.company.com%2Fauthorized
        </div>    </div>    <div class="chapter"><h2 id="HandlingTokenResponse" data-toc="Authorization-Code#HandlingTokenResponse">Handling Access Token Response</h2>        <p id="4f50ef5e">            If the access token request is valid and authorized, Hub issues an access token. If the request client            authentication failed or is invalid, the Hub server returns an error response.        </p>        <p id="ba85d868">Example of a successful response:</p>        <div class="code-block" data-lang="markup">
            HTTP/1.1 200 OK
            Content-Type: application/json;charset=UTF-8

            {
            "access_token":"1443459450185.0-0-0-0-0.98071167-004c-4ddf-ba37-5d4599fdf319.0-0-0-0-0%3B1.MCwCFC%2FYWvLjHdzOdpLleDLITJn4Mz9rAhRklCoZ2dlMkh2aCd1K5QQ89ibsxg%3D%3D
            "expires_in":3600,
            }
        </div>    </div><div class="last-modified" data-skip-index="skip">Last modified: 9 September 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Implicit.html">Implicit</a><a class="navigation-links__next" href="Refresh-Token.html">Refresh Token</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>