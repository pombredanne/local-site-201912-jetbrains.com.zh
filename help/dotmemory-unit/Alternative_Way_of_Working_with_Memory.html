<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/help/app/v2/analytics.js"></script><meta class="swiftype" name="product" data-type="string" content="/dotmemory-unit"><meta charset="UTF-8"><title>Alternative Way of Working with Memory - Help | dotMemory Unit</title><link rel="stylesheet" href="/help/app/v2/app.css"></head><body data-id="Alternative_Way_of_Working_with_Memory" data-disqus-id="Alternative_Way_of_Working_with_Memory_dmu"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper" data-swiftype-index="false"><section class="panel _nav" data-swiftype-index="false"><header class="panel__header" data-swiftype-index="false"><div class="container" data-swiftype-index="false"><form class="search-box" data-swiftype-index="false"><label for="search-box__input" class="search-box__label" data-swiftype-index="false"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search dotMemory Unit Help"></label><div class="search-box__clear" title="Clear" data-swiftype-index="false"></div></form></div></header><nav class="panel__content" data-swiftype-index="false"><div class="container _nav" data-swiftype-index="false"><menu class="nav-tree" data-swiftype-index="false"></menu></div><div class="container _footer panel__footer" data-swiftype-index="false"><p data-swiftype-index="false"><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main" data-swiftype-index="false"><header class="panel__header" data-swiftype-index="false"><div class="container" data-swiftype-index="false"><h3>dotMemory Unit 3.0 Help</h3><div class="shortcuts-switcher" data-swiftype-index="false"><label for="switch-shortcuts" data-swiftype-index="false">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1" data-swiftype-index="false"><option data-group="secondary" value="rs">ReSharper 2.x/IntelliJ IDEA</option><option data-group="primary" value="vs" selected>Visual Studio</option></select></div><div class="panel-trigger" data-swiftype-index="false"></div></div></header><section class="panel__content" data-swiftype-index="false"><div class="container"><article class="article" data-shortcut-switcher="false" data-swiftype-index="true"><h1 data-toc="Alternative_Way_of_Working_with_Memory">Alternative Way of Working with Memory</h1><p id="d16e2">        If, for some reason, you do not want to work with memory in a way described in <a href="Working_with_Memory.html"><span>Working with Memory</span></a>,        you have an alternative. We do not hide the "kernel" level of the framework which is based on the        <code class="code" data-lang="Java">dotMemoryApi</code> static class. This class allows you to directly work with memory        snapshots without using lambdas. Actually, the <a href="Working_with_Memory.html">dotMemory.Check</a> method is a wrapper        of <code class="code" data-lang="Java">dotMemoryApi</code> calls.    </p><p id="d16e16">        You can use the <code class="code" data-lang="Java">dotMemoryApi</code> class to write your own wrapper or directly work with memory snapshots.    </p><p id="d16e22">In the latter case, you should keep in mind the following peculiarities:</p><ul class="list _ul"><li class="list__item">            Taking a snapshot may be a time-consuming operation.        </li><li class="list__item">            Snapshots contain memory data on the moment you take them, not on the moment you access them.        </li><li class="list__item">            In case of errors in the test code, test runner will be unable to distinguish whether the test fails because            of a dotMemory Unit call or other test code.        </li><li class="list__item">            All dotMemory Unit calls should be preceded by the check on whether the support for dotMemory Unit is enabled.        </li></ul><p id="d16e35">        For example, the following assertion    </p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">dotMemory</span><span class="o">.</span><span class="na">Check</span><span class="o">(</span><span class="n">memory</span> <span class="o">=&gt;</span>
<span class="o">{</span>
    <span class="n">Assert</span><span class="o">.</span><span class="na">That</span><span class="o">(</span><span class="n">memory</span><span class="o">.</span><span class="na">GetObjects</span><span class="o">(</span><span class="n">where</span> <span class="o">=&gt;</span> <span class="n">where</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">Is</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">&gt;()).</span><span class="na">ObjectsCount</span><span class="o">,</span> <span class="n">Is</span><span class="o">.</span><span class="na">EqualTo</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span>
<span class="o">});</span></code></div><p id="d16e42">can be rewritten as</p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="k">if</span> <span class="o">(</span><span class="n">dotMemoryApi</span><span class="o">.</span><span class="na">IsEnabled</span><span class="o">)</span>
<span class="o">{</span>
    <span class="n">var</span> <span class="n">snapshot1</span> <span class="o">=</span> <span class="n">dotMemoryApi</span><span class="o">.</span><span class="na">GetSnapshot</span><span class="o">();</span>

    <span class="n">Assert</span><span class="o">.</span><span class="na">That</span><span class="o">(</span><span class="n">snapshot1</span><span class="o">.</span><span class="na">GetObjects</span><span class="o">(</span><span class="n">where</span> <span class="o">=&gt;</span> <span class="n">where</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">Is</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">&gt;()).</span><span class="na">ObjectsCount</span><span class="o">,</span> <span class="n">Is</span><span class="o">.</span><span class="na">EqualTo</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span>
<span class="o">}</span></code></div><div class="chapter"><h2 id="dotMemoryApi" data-toc="Alternative_Way_of_Working_with_Memory#dotMemoryApi">dotMemoryApi static class</h2>    <div class="chapter"><h3 id="d16e50">dotMemoryApi methods</h3>    <div class="table-wrapper"><table class="                  _layout-fixed" width="100%" id="d16e52"><thead><tr id="d16e53" class="ijRowHead"><th width="40%" id="d16e54">Name</th><th width="60%" id="d16e56">Description</th></tr></thead><tbody><tr id="d16e58" class="ijRowOdd"><td id="d16e59">                <code class="code" data-lang="Java">GetSnapshot(): Snapshot</code>            </td><td id="d16e64">                Returns a <a href="#Snapshot">Snapshot</a>                instance which is a reference to memory data in the current execution point.                Use this reference to get data about objects in memory, compare it with data from another snapshot,                or get data about memory traffic between two snapshots.            </td></tr><tr id="d16e69" class="ijRowEven"><td id="d16e70">                <code class="code" data-lang="C#">GetDifference(Snapshot snapshot1, Snapshot snapshot2): SnapshotDifference</code>            </td><td id="d16e75">                Gets difference between <code class="code" data-lang="Java">snapshot1</code> and <code class="code" data-lang="Java">snapshot2</code>. <br>                Returns an instance of the                <a href="Reference_Comparing_Snapshots.html#SnapshotDifference">SnapshotDifference</a> type that                contains data about objects that were allocated and collected in the time interval between getting the snapshots.            </td></tr><tr id="d16e88" class="ijRowOdd"><td id="d16e89">                <code class="code" data-lang="C#">GetTrafficBetween(Snapshot snapshot1, Snapshot snapshot2): Traffic</code>            </td><td id="d16e94">                Gets data about memory traffic in the time interval between taking <code class="code" data-lang="Java">snapshot1</code> and                <code class="code" data-lang="Java">snapshot2</code>.  <br>                Returns an instance of the <a href="Traffic_Class.html">Traffic</a>                type that allows you to get data about objects that were allocated                and collected during the specified time interval.            </td></tr><tr id="d16e107" class="ijRowEven"><td id="d16e108">                <code class="code" data-lang="Java">SaveCollectedData(string directoryPath)</code>            </td><td id="d16e113">                Saves the workspace containing all memory snapshots collected during unit test run using the directory path                specified by <code class="code" data-lang="Java">directoryPath</code>. This can be either a full path or a path relative to                the profiled assembly.            </td></tr></tbody></table></div>    </div>        <div class="chapter"><h3 id="d16e120">dotMemoryApi properties</h3>    <div class="table-wrapper"><table class=" wide                  _layout-fixed" width="100%" id="d16e122"><thead><tr id="d16e123" class="ijRowHead"><th width="25%" id="d16e124">Name</th><th width="15%" id="d16e126">Type</th><th width="60%" id="d16e128">Description</th></tr></thead><tbody><tr id="d16e130" class="ijRowOdd"><td id="d16e131">                <code class="code" data-lang="Java">IsEnabled</code>            </td><td id="d16e136">                <code class="code" data-lang="Java">bool</code>            </td><td id="d16e141">                Returns <code class="code" data-lang="Java">true</code> if a test is run under dotMemory Unit.                Check this property before calling Assert statements.            </td></tr><tr id="d16e146" class="ijRowEven"><td id="d16e147">                <code class="code" data-lang="Java">CollectAllocations</code>            </td><td id="d16e152">                <code class="code" data-lang="Java">bool</code>            </td><td id="d16e157">                Defines whether the memory allocation data (memory traffic and creation stack trace data) must be                collected. Set to <code class="code" data-lang="Java">true</code> if you need the allocation data for your assertions.                Note that this will significantly increase the profiling overhead.            </td></tr></tbody></table></div>    </div>    </div><div class="chapter"><h2 id="Snapshot" data-toc="Alternative_Way_of_Working_with_Memory#Snapshot">Snapshot class</h2>    <p id="d16e167">        Represents memory data in some execution point.    </p>    <div class="chapter"><h3 id="d16e170">Snapshot methods</h3>    <div class="table-wrapper"><table class="                  _layout-fixed" width="100%" id="d16e172"><thead><tr id="d16e173" class="ijRowHead"><th width="40%" id="d16e174">Name</th><th width="60%" id="d16e176">Description</th></tr></thead><tbody><tr id="d16e178" class="ijRowOdd"><td id="d16e179">                <code class="code" data-lang="Java">GetObjects(Func&lt;ObjectProperty, Query&gt; query): ObjectSet</code>            </td><td id="d16e184">                (Inherited from <a href="Working_with_Object_Sets.html">ObjectSet</a>) <br>                Gets a subset of objects by a specific condition. The condition is defined by                <code class="code" data-lang="Java">query</code> in the form of a lambda expression. The                <a href="Working_with_Object_Sets.html#ObjectProperty">ObjectProperty</a> object                passed to the lambda allows selecting objects by type, interface, and other parameters. <br>                Returns an instance of the <a href="Working_with_Object_Sets.html#ObjectSet">ObjectSet</a> type.            </td></tr><tr id="d16e203" class="ijRowEven"><td id="d16e204">                <code class="code" data-lang="Java">GroupByType: IReadOnlyCollection&lt;TypeMemoryInfo&gt;</code>            </td><td id="d16e209">                (Inherited from <a href="Working_with_Object_Sets.html">ObjectSet</a>) <br>                Returns a collection of objects of the                <a href="Working_with_Object_Sets.html#TypeMemoryInfo">TypeMemoryInfo</a> type.                Each object represents a particular type from the                source object set and carries info about the number of objects of that type and their total size.            </td></tr></tbody></table></div>    </div>        <div class="chapter"><h3 id="d16e221">Snapshot properties</h3>    <div class="table-wrapper"><table class=" wide                  _layout-fixed" width="100%" id="d16e223"><thead><tr id="d16e224" class="ijRowHead"><th width="25%" id="d16e225">Name</th><th width="15%" id="d16e227">Type</th><th width="60%" id="d16e229">Description</th></tr></thead><tbody><tr id="d16e231" class="ijRowOdd"><td id="d16e232">                <code class="code" data-lang="Java">ObjectsCount</code>            </td><td id="d16e237">                <code class="code" data-lang="Java">int</code>            </td><td id="d16e242">                (Inherited from <a href="Working_with_Object_Sets.html#ObjectSet">ObjectSet</a>) <br>                Total number of objects in memory.            </td></tr><tr id="d16e249" class="ijRowEven"><td id="d16e250">                <code class="code" data-lang="Java">SizeInBytes</code>            </td><td id="d16e255">                <code class="code" data-lang="Java">long</code>            </td><td id="d16e260">                (Inherited from <a href="Working_with_Object_Sets.html#ObjectSet">ObjectSet</a>) <br>                Total size of objects in memory.            </td></tr></tbody></table></div></div>    </div><div class="last-modified" data-swiftype-index="false">Last modified: 16 January 2018 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-swiftype-index="false"><a class="navigation-links__prev" href="Working_with_Memory.html" data-swiftype-index="false">Working with Memory</a><a class="navigation-links__next" href="Configuring_dotMemory_Unit.html" data-swiftype-index="false">Configuring dotMemory Unit</a></div></article><div id="disqus_thread" data-swiftype-index="false"></div></div></section></main></div><script src="/help/app/v2/app.js"></script></body></html>