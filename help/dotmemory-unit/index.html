<html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/help/app/v2/analytics.js"></script><meta class="swiftype" name="product" data-type="string" content="/dotmemory-unit"><meta charset="UTF-8"><title>简介-帮助|点存储单元</title><link rel="stylesheet" href="/help/app/v2/app.css"></head><body  data-id="Introducton" data-disqus-id="Introduction_dmu"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper" data-swiftype-index="false"><section class="panel _nav" data-swiftype-index="false"><header class="panel__header" data-swiftype-index="false"><div class="container" data-swiftype-index="false"><form class="search-box" data-swiftype-index="false"><label class="search-box__label" for="search-box__input" data-swiftype-index="false"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索dotMemory单元帮助"></label><div class="search-box__clear" title="明确" data-swiftype-index="false"></div></form></div></header><nav class="panel__content" data-swiftype-index="false"><div class="container _nav" data-swiftype-index="false"><menu class="nav-tree" data-swiftype-index="false"></menu></div><div class="container _footer panel__footer" data-swiftype-index="false"><p data-swiftype-index="false"><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main" data-swiftype-index="false"><header class="panel__header" data-swiftype-index="false"><div class="container" data-swiftype-index="false"><h3>dotMemory Unit 3.0帮助</h3><div class="shortcuts-switcher" data-swiftype-index="false"><label for="switch-shortcuts" data-swiftype-index="false">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1" data-swiftype-index="false"><option value="rs" data-group="secondary">ReSharper 2.x / IntelliJ IDEA</option><option value="vs" data-group="primary" selected>视觉工作室</option></select></div><div class="panel-trigger" data-swiftype-index="false"></div></div></header><section class="panel__content" data-swiftype-index="false"><div class="container"><article class="article" data-shortcut-switcher="false" data-swiftype-index="true"><h1 data-toc="Introducton">介绍</h1><p id="d1448e2">dotMemory Unit是一个单元测试框架，可让您编写测试以检查代码是否存在各种内存问题。例如，这些测试可以是通过检查内存中特定类型的对象来确定泄漏的测试，也可以是跟踪内存流量并在流量超过某个阈值时失败的测试。换句话说，dotMemory Unit通过内存分析器的功能扩展了单元测试框架的可能性。更具体地说，dotMemory单元允许：</p><ul class="list _ul"><li class="list__item">检查内存中是否存在某种类型的对象，</li><li class="list__item">检查内存流量，</li><li class="list__item">在内存快照之间获得差异，</li><li class="list__item">保存内存快照，以便在<a href="/dotmemory/" data-external="true"><span>dotMemory</span></a> （独立的.NET内存分析器）中进行进一步研究。</li></ul><div class="chapter"><h2 id="d1448e18" data-toc="Introducton#d1448e18">dotMemory单元如何工作</h2>    <ul class="list _ul"><li class="list__item">dotMemory Unit作为NuGet软件包（如果使用ReSharper单元测试运行器，则很方便）或zip软件包（如果要使用独立的dotMemory Unit启动器）分发。</li><li class="list__item">可以使用ReSharper单元测试运行程序运行对dotMemory Unit支持的测试。在这种情况下，您应该在计算机上安装ReSharper 9.1（或更高版本）或dotCover 3.1（或更高版本）。另一个选择是使用独立的dotMemory Unit启动器运行测试。您可以从NuGet软件包中获取启动器，也可以从<a href="/dotmemory/unit/" data-external="true"><span>dotMemory Unit页面</span></a>上的可用zip中获取启动器。在<a href="Using_dotMemory_Unit_Standalone_Runner.html"><span>使用dotMemory Unit独立启动</span></a>器中了解如何使用启动<a href="Using_dotMemory_Unit_Standalone_Runner.html"><span>器</span></a> 。</li><li class="list__item">安装dotMemory Unit软件包后，ReSharper的单元测试菜单将<span class="control">在dotMemory Unit下</span>获得其他项<span class="control">Run Unit Tests</span> 。在这种模式下，测试运行程序将执行dotMemory Unit框架调用以及常规测试逻辑。如果您以“正常”方式运行测试（不支持dotMemory Unit），则根据设置，测试将失败，或者dotMemory Unit调用将被忽略。</li><li class="list__item">dotMemory Unit可以与市场上几乎所有的<a href="Supported_Unit_Testing_Frameworks.html">单元测试框架一起</a>使用，包括MSTest，NUnit和xUnit.net。</li></ul>    </div><div class="chapter"><h2 id="d1448e42" data-toc="Introducton#d1448e42">看起来如何</h2>    <p id="d1448e44">为了快速向您介绍该框架，让我们考虑以下测试示例。</p>    <div class="code-block" data-lang="C#"><code class="code-block__wrapper"><span class="na">[Test]</span> <span class="k">public</span> <span class="k">void</span> <span class="nf">TestMethod1</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="c1">// do some work</span> <span class="n">dotMemory</span><span class="p">.</span><span class="n">Check</span><span class="p">(</span><span class="n">memory</span> <span class="p">=></span> <span class="n">Assert</span><span class="p">.</span><span class="n">That</span><span class="p">(</span><span class="n">memory</span><span class="p">.</span><span class="n">GetObjects</span><span class="p">(</span><span class="k">where</span> <span class="p">=></span> <span class="k">where</span><span class="p">.</span><span class="n">Type</span><span class="p">.</span><span class="n">Is</span><span class="p"><</span><span class="n">Foo</span><span class="p">>()).</span><span class="n">ObjectsCount</span><span class="p">,</span> <span class="n">Is</span><span class="p">.</span><span class="n">EqualTo</span><span class="p">(</span><span class="m">0</span><span class="p">)));</span> <span class="p">}</span></code></div>    <p id="d1448e50">此NUnit测试选择了<code class="code" data-lang="Java">Foo</code>从内存中键入并断言没有此类对象。当您在代码中查找内存泄漏时，这种测试非常普遍。</p>    <p id="d1448e56">请注意，dotMemory Unit不会强制您使用任何特定的Assert语法。只需使用您要编写测试的框架的语法。例如，显示的断言使用NUnit语法，但可以很容易地为MSTest *更新：</p>    <div class="code-block" data-lang="C#"><code class="code-block__wrapper"><span class="n">Assert</span><span class="p">.</span><span class="n">AreEqual</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">memory</span><span class="p">.</span><span class="n">GetObjects</span><span class="p">(</span><span class="k">where</span> <span class="p">=></span> <span class="k">where</span><span class="p">.</span><span class="n">Type</span><span class="p">.</span><span class="n">Is</span><span class="p"><</span><span class="n">Foo</span><span class="p">>()).</span><span class="n">ObjectsCount</span><span class="p">);</span></code></div>    <aside class="note sideblock" data-title="">        <p id="d1448e65">*本文档中的所有示例均针对NUnit。</p>    </aside>    </div><div class="chapter"><h2 id="d1448e70" data-toc="Introducton#d1448e70">何时使用dotMemory Unit</h2>    <p id="d1448e72">以与对应用程序逻辑进行单元测试相同的方式使用“内存”测试：</p>    <ul class="list _ul"><li class="list__item">手动找到问题（例如泄漏）后，编写涵盖该问题的内存测试。</li><li class="list__item">编写测试以进行主动测试-确保新产品功能不会造成任何内存问题，例如内存中剩余的对象或大内存流量。</li></ul>    </div><div class="chapter"><h2 id="d1448e83" data-toc="Introducton#d1448e83">入门</h2>    <p id="d1448e85">开始编写自己的“内存”测试的最快方法是阅读<a href="Get_Started.html"><span>“入门”</span></a> 。它包含有关安装dotMemory Unit和运行“内存”测试的信息。如果要查找测试示例，请参阅“ <a href="Unit_Examples.html"><span>示例”</span></a>部分。有关某些框架方法的详细信息，请<a href="Reference.html"><span>参考参考</span></a>部分。</p>    </div><div class="chapter"><h2 id="d1448e95" data-toc="Introducton#d1448e95">快照兼容性</h2>            <div class="table-wrapper"><table class="                 " width="30%" id="d1448e97"><thead><tr id="d1448e98" class="ijRowHead"><th colspan="4" id="d1448e99"></th></tr></thead><tbody><tr id="d1448e100" class="ijRowOdd"><td width="20%" rowspan="2" id="d1448e101">                        <i id="d1448e103">保存在</i>                    </td><td colspan="4" id="d1448e106">                        <i id="d1448e108">打开</i>                    </td></tr><tr id="d1448e111" class="ijRowEven"><td id="d1448e112">dotMemory 10-2017.1</td><td id="d1448e114">dotMemory 2017.2</td><td id="d1448e116">dotMemory 2017.3</td></tr><tr id="d1448e118" class="ijRowOdd"><td id="d1448e119">dotMemory单元1.0-2.3</td><td id="d1448e121">+</td><td id="d1448e123">--</td><td id="d1448e125">--</td></tr><tr id="d1448e127" class="ijRowEven"><td id="d1448e128">dotMemory单元2.4</td><td id="d1448e130">--</td><td id="d1448e132">+</td><td id="d1448e134">+</td></tr><tr id="d1448e136" class="ijRowOdd"><td id="d1448e137">dotMemory单元3.0</td><td id="d1448e139">--</td><td id="d1448e141">--</td><td id="d1448e143">+</td></tr></tbody></table></div>        </div><div class="last-modified" data-swiftype-index="false">上次修改时间：2018年1月16日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-swiftype-index="false"><a class="navigation-links__next" href="Supported_Unit_Testing_Frameworks.html" data-swiftype-index="false">支持的框架</a></div></article><div id="disqus_thread" data-swiftype-index="false"></div></div></section></main></div><script src="/help/app/v2/app.js"></script></body></html>