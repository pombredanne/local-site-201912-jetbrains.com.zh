<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>配置Maven触发器-帮助|帮助团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Configuring Maven Triggers" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-build-triggers.md|Configuring Build Triggers/configuring-maven-triggers.md|Configuring Maven Triggers" data-main-title="Configuring Maven Triggers" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/configuring-maven-triggers.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="configuring-maven-triggers.md" data-toc="Configuring Maven Triggers">配置Maven触发器</h1><p id="ffff2974">构建配置设置的“ <b id="b6a738d4">触发器”</b>页面允许您添加以下Maven依赖触发器：</p><p id="ff6dba4c"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#ConfiguringMavenTriggers-MavenSnapshotDependencyTrigger">Maven快照相关性触发器</a></li><li class="list__item"><a href="#ConfiguringMavenTriggers-MavenArtifactDependencyTrigger">Maven工件依赖触发器</a><ul class="list _bullet"><li class="list__item"><a href="#ConfiguringMavenTriggers-AdvancedOptions">高级选项</a></li><li class="list__item"><a href="#ConfiguringMavenTriggers-VersionRanges">版本范围</a></li></ul></li></ul><p></p><p id="3e3059e6"><b id="3d9da270">基于校验和的触发</b></p><p id="1ffc2d48">触发器通过根据本地存储版本验证存储库中的依赖项校验和，来检查依赖项的内容是否实际上已更改。在触发构建之前，TeamCity尝试通过下载与该工件关联的文件摘要（MD5 / SHA-1）来确定所需依赖项的校验和。</p><p id="fa26dbec">如果校验和可以检索，并且与本地存储的校验和匹配，则不会触发构建。如果校验和不同，则会触发构建。</p><p id="a93bc0b0">如果无法从远程服务器检索校验和，则将下载依赖项，TeamCity将计算其校验和并遵循上述构建触发机制。</p><a name="MavenSnapshotDependencyTrigger"></a><a name="Maven-Snapshot-Dependency-Trigger"></a><div class="chapter"><h2 id="ConfiguringMavenTriggers-MavenSnapshotDependencyTrigger">Maven快照相关性触发器</h2><p id="a9cfbe49">当通过校验和更改检测到远程存储库中的快照依赖项内容有实际修改时，Maven快照依赖项触发器会将新版本添加到队列中。</p><p id="90ce1564">依赖工件根据POM和服务器端<a href="maven-server-side-settings.html">Maven设置</a>进行解析。</p><aside class="note " rel="90ce1564" id="141f564f" data-title=""><p id="1dfea256">请注意，由于Maven在构建过程中将工件依次部署到远程存储库，因此在快照相关性触发器检测到第一个更新的工件时，并非所有工件都可能是最新的。为避免不一致，请在添加此触发器时选中“ <b id="e5934d24">如果当前正在运行的构建可能会产生快照依赖项</b> ，则<b id="e5934d24">不要触发构建”</b>复选框，这将确保在生成快照依赖项的构建仍在运行时不会启动该构建。</p></aside><aside class="note " rel="ConfiguringMavenTriggers-MavenSnapshotDependencyTrigger" id="85de1c03" data-title=""><p id="b1de54ab"><b id="dcda9b2e">快照依赖关系和依赖关系触发器同时用于构建</b>假定构建A依赖快照和触发器依赖关系依赖于构建B。然后，仅当构建B不是包含A的构建链的一部分时，构建B结束后，构建A才会添加到队列中。</p></aside></div><a name="MavenArtifactDependencyTrigger"></a><a name="Maven-Artifact-Dependency-Trigger"></a><div class="chapter"><h2 id="ConfiguringMavenTriggers-MavenArtifactDependencyTrigger">Maven工件依赖触发器</h2><p id="f4d126d1">当校验和更改检测到对依赖项内容有实际修改时，Maven工件依赖项触发器会将构建添加到队列中。</p><p id="7fabf1dc">要添加触发器，请在“ <b id="c2b20ad3">添加新触发器”</b>对话框中指定以下参数：</p><div class="table-wrapper"><table width="100%" id="18f029fe"><thead><tr id="f79f31e9" class="ijRowHead"><th id="cb7435fd"><p id="f9a57be5">参数</p></th><th id="2f660f03"><p id="4a3309a6">描述</p></th></tr></thead><tbody><tr id="1e61c87a" class="ijRowOdd"><td id="a2305265"><p id="6c51c76c">组编号</p></td><td id="83f6d927"><p id="9820461f">指定所需的Maven工件所属的组的标识符。</p></td></tr><tr id="9bd25dd1" class="ijRowEven"><td id="cfbd1bca"><p id="fbda8918">工件ID</p></td><td id="592e5e53"><p id="8fd4407c">指定工件的标识符。</p></td></tr><tr id="c6180a3d" class="ijRowOdd"><td id="29a27653"><p id="a8cd3ba6">版本或版本范围</p></td><td id="b8847f1a"><p id="c03c7c67">指定工件的版本或版本范围。版本范围语法在以下<a href="#Version-Ranges">部分</a>中描述。也可以使用SNAPSHOT版本。</p></td></tr><tr id="08c5e579" class="ijRowEven"><td id="67aae6ed"><p id="ca5b3072">类型</p></td><td id="77f8bfa5"><p id="9dda9063">明确定义指定工件的类型。默认情况下，类型为<code class="code">jar</code> 。</p></td></tr><tr id="5ced187f" class="ijRowOdd"><td id="277e3415"><p id="e70597e3">分类器</p></td><td id="c0e9e1c4"><p id="a648e93b">（可选）指定工件的分类器。</p></td></tr><tr id="21bb00ff" class="ijRowEven"><td id="57a8dc34"><p id="29bbb9a4">Maven存储库URL</p></td><td id="cb3e459e"><p id="82c8558c">指定Maven存储库的URL。请注意，此参数是可选的。如果未指定URL，则：</p><ul class="list _ul"><li class="list__item" id="296e8755"><p>对于Maven项目，存储库URL由POM和服务器端<a href="maven-server-side-settings.html#Maven-Settings-Resolution-on-the-Server-Side">Maven设置确定。</a></p></li><li class="list__item" id="cbe7c22a"><p>对于非Maven项目，资源库URL仅由服务器端<a href="maven-server-side-settings.html#Maven-Settings-Resolution-on-the-Server-Side">Maven设置</a>确定</p></li></ul></td></tr><tr id="cb197e3d" class="ijRowOdd"><td id="15a7e773"><p id="aee343fe">如果当前正在运行的构建可以产生此工件，则不要触发构建</p></td><td id="f2d2f0b6"><p id="8952f735">选择此选项仅在生成可用于此处的工件的构建完成后才触发构建。</p></td></tr></tbody></table></div><a name="AdvancedOptions"></a><a name="Advanced-Options"></a><div class="chapter"><h3 id="ConfiguringMavenTriggers-AdvancedOptions">高级选项</h3><p id="329697e2">从<b id="672d8fb3">TeamCity 9.0开始</b> ，以下高级选项已添加到触发器：</p><div class="table-wrapper"><table width="100%" id="098e5320"><thead><tr id="daeb5340" class="ijRowHead"><th id="48152470"><p id="4fd1e7a6">参数</p></th><th id="1a61c071"><p id="dde05c01">描述</p></th></tr></thead><tbody><tr id="72a596ff" class="ijRowOdd"><td id="ca483bc0"><p id="c61b6762">仓库ID</p></td><td id="3be21164"><p id="c5141321">允许使用有效的Maven设置中的授权</p></td></tr><tr id="2c09984d" class="ijRowEven"><td id="a7d63283"><p id="d1d5fa01">用户设置选择</p></td><td id="21f654c9"><p id="32b03f5b">允许选择有效的设置。与Maven运行程序的<a href="maven.html#User-Settings">用户设置</a>相同。</p></td></tr></tbody></table></div><p id="b4746556">TeamCity确定要检查工件更新的<b id="0fcf5a59">有效存储库</b> ，并在检测到更改时触发构建，如下所示：</p><ul class="list _ul"><li class="list__item" id="36ae749e"><p>如果设置了URL和存储库ID，则会从有效设置中选择身份验证（请参见下文）</p></li><li class="list__item" id="86693993"><p>如果仅设置了URL，则将保留旧的行为：使用了临时存储库ID（“ _tc_temp_remote_repo”）</p></li><li class="list__item" id="1dda4dd9"><p>如果未设置URL（与存储库ID无关），则会根据有效设置在可用的存储库中查找工件。</p></li></ul><p id="e9f5bb10">TeamCity按以下方式确定<b id="5c291b7a">有效设置</b> ：</p><ul class="list _ul"><li class="list__item" id="ddb214b1"><p>在触发设置中，用户可以选择默认，自定义或上载的Maven设置。有关详细信息，请参见<a href="maven-server-side-settings.html">Maven服务器端设置</a> 。</p></li><li class="list__item" id="697648f4"><p>如果没有为触发器配置任何特定设置，则使用<a href="maven.html">Maven</a>构建步骤设置</p></li><li class="list__item" id="3d8365cf"><p>如果未配置触发器的设置，并且没有Maven构建步骤，则<code class="code">default</code>将使用<a href="maven-server-side-settings.html">服务器Maven设置</a> 。</p></li></ul></div><a name="VersionRanges"></a><a name="Version-Ranges"></a><div class="chapter"><h3 id="ConfiguringMavenTriggers-VersionRanges">版本范围</h3><p id="3d973d5f">为了指定版本范围，请使用以下语法，如<a href="http://docs.codehaus.org/display/MAVEN/Dependency+Mediation+and+Conflict+Resolution#DependencyMediationandConflictResolution-DependencyVersionRanges" rel="noopener noreferrer" data-external="true" target="_blank">Maven文档中</a>所<a href="http://docs.codehaus.org/display/MAVEN/Dependency+Mediation+and+Conflict+Resolution#DependencyMediationandConflictResolution-DependencyVersionRanges" rel="noopener noreferrer" data-external="true" target="_blank">建议</a> 。</p><p id="114a61e0">请注意，Maven Artifact Dependency Trigger不仅可以用于固定版本的工件，还可以用于快照，作为Maven Snapshots Dependency Trigger的细粒度替代方案。</p><div class="table-wrapper"><table width="100%" id="edfc6a82"><thead><tr id="0cc12d6d" class="ijRowHead"><th id="fce3619d"><p id="a4f8c2bf">范围</p></th><th id="558629ec"><p id="1c8364b2">含义</p></th></tr></thead><tbody><tr id="9ebf6c60" class="ijRowOdd"><td id="09dd292d"><p id="a2590819"><code class="code">(,1.0]</code></p></td><td id="6d2dcf67"><p id="576f3439">x <= 1.0</p></td></tr><tr id="3afbfc85" class="ijRowEven"><td id="4ca0c4a0"><p id="63f28566"><code class="code">1.0</code></p></td><td id="d85cfa95"><p id="42466e95">1.0的“软”要求（只是一个建议-如果它匹配所有范围，则有助于选择正确的版本）</p></td></tr><tr id="3de79800" class="ijRowOdd"><td id="03378524"><p id="f106777c"><code class="code">[1.0]</code></p></td><td id="5aa62800"><p id="c58bf860">对1.0的严格要求</p></td></tr><tr id="7d86cf4a" class="ijRowEven"><td id="07510577"><p id="73dd3476"><code class="code">[1.2,1.3]</code></p></td><td id="05882d33"><p id="41a5f4ca">1.2 <= x <= 1.3</p></td></tr><tr id="f45e887e" class="ijRowOdd"><td id="0f53290d"><p id="ead3a8e2"><code class="code">[1.0,2.0)</code></p></td><td id="20a58bca"><p id="8adff138">1.0 <= x <2.0</p></td></tr><tr id="27363e88" class="ijRowEven"><td id="aaeb59ae"><p id="2ac2d6c8"><code class="code">[1.5,)</code></p></td><td id="d23e2d10"><p id="6148ed1f">x> = 1.5</p></td></tr><tr id="e19d2cc6" class="ijRowOdd"><td id="dfd7dfac"><p id="4145898f"><code class="code">(,1.0],[1.2,)</code></p></td><td id="0e783709"><p id="657afed6">x <= 1.0或x> = 1.2。多组以逗号分隔</p></td></tr><tr id="b828c19a" class="ijRowEven"><td id="0aec399d"><p id="e12d2446"><code class="code">(,1.1),(1.1,)</code></p></td><td id="d52b6947"><p id="9eda7aca">如果已知不能与此库一起使用，则不包括1.1</p></td></tr><tr id="fa8d8d69" class="ijRowOdd"><td id="16f495d1"><p id="023c0ac6">1.0快照</p></td><td id="bc777394"><p id="33986397">触发器将检查最新快照版本以进行更新</p></td></tr></tbody></table></div><hr id="e2bbf773"></div></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>