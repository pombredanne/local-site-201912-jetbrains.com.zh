<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>预测试（延迟）提交-帮助|帮助团队城市</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Pre-Tested (Delayed) Commit" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/concepts.md|Concepts/pre-tested-delayed-commit.md|Pre-Tested (Delayed) Commit" data-main-title="Pre-Tested (Delayed) Commit" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/pre-tested-delayed-commit.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="pre-tested-delayed-commit.md" data-toc="Pre-Tested (Delayed) Commit">预测试（延迟）提交</h1><p id="4cbe4860">一种防止将有缺陷的代码提交到内部版本中的方法，因此不会影响整个团队的过程。JetBrains TeamCity网页上的<a href="http://www.jetbrains.com/teamcity/features/delayed_commit.html" rel="noopener noreferrer" data-external="true" target="_blank">图表</a>提供了以下描述的TeamCity方法的可视化。</p><p id="70126d04">提交的代码更改首先要经过测试。如果代码通过所有测试，TeamCity可以自动将更改提交到版本控件。从那里开始，所做的更改将自动集成到下一个版本中。如果任何测试失败，则代码不会提交，并通知正在提交的开发人员。</p><p id="4d9f065e">开发人员通过执行<a href="remote-run.html">远程运行来</a>测试他们的更改。<b id="0dfb8940">如果</b>选择了<b id="0dfb8940">成功</b>选项，则<b id="0dfb8940">提交更改</b>时将启用预测试的提交。</p><p id="e7cce388">通过一个<a href="supported-platforms-and-environments.html#IDE-Integration">支持的IDE</a>的插件来启动预测试的提交。对于远程运行，也<a href="https://confluence.jetbrains.com/display/TW/Command+Line+Remote+Run+Tool" rel="noopener noreferrer" data-external="true" target="_blank">可以使用</a>命令行工具。</p><p id="83c5a505">对于Git和Mercurial，推荐的使用<a href="branch-remote-run-trigger.html">分支远程运行触发器</a>方法来运行分支之外的个人构建的方法。</p><a name="Matchingchangesandbuildconfigurations"></a><a name="Matching-changes-and-build-configurations"></a><div class="chapter"><h2 id="Pre-Tested(Delayed)Commit-Matchingchangesandbuildconfigurations">匹配变更和构建配置</h2><p id="d69ce799">要将更改的文件提交给预先测试的提交或远程运行，VCS集成应在IDE中起作用，并且TeamCity应该能够检查文件在提交后是否会影响服务器上的构建配置。</p><p id="a7687082">如果TeamCity无法将更改与构建匹配，则会显示消息“无法将提交的更改应用于构建配置”。</p><p id="afde6570">应该在IDE中正确配置VCS集成，并且TeamCity应该能够将开发人员工作站上的文件与TeamCity服务器上存在的构建配置进行匹配。为了做到这一点，应该在开发人员的工作站和服务器上以相同的方式配置VCS。</p><p id="92632a03">这包括：</p><ul class="list _ul"><li class="list__item" id="d97721ab"><p>用于CVS，TFS和Perforce版本控制系统-使用与版本控制服务器完全相同的URL</p></li><li class="list__item" id="9c0e29ab"><p>对于VSS-使用与VSS数据库完全相同的路径（计算机和路径）</p></li><li class="list__item" id="0641e749"><p>对于Subversion-使用同一服务器（TeamCity与<a href="http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.uuids" rel="noopener noreferrer" data-external="true" target="_blank">服务器UUID</a>匹配）</p></li><li class="list__item" id="29776c13"><p>对于Git-当前已签出的分支应将“远程”设置为TeamCity服务器监视的服务器/分支，并且在与服务器监视的分支的历史记录中应具有公共提交。</p></li></ul><p id="69c441f9">如果在更改文件后选择TeamCity无法找到可以将文件发送到的构建配置，则启动个人构建的选项将不可用。</p></div><a name="GeneralFlowofapre-testedcommit"></a><a name="General-Flow-of-a-pre-tested-commit"></a><div class="chapter"><h2 id="Pre-Tested(Delayed)Commit-GeneralFlowofapre-testedcommit">预测试提交的一般流程</h2><ul class="list _ul"><li class="list__item" id="aafda778"><p>开发人员使用<a href="installing-tools.html">TeamCity IDE插件</a>的“远程运行”对话框来选择要发送到TeamCity的文件。</p></li><li class="list__item" id="9bf3cd80"><p>基于所选文件，将显示适用的构建配置列表。开发人员选择构建配置来测试更改，并为预测试的提交设置选项。</p></li><li class="list__item" id="7ae3c13f"><p>TeamCity IDE插件会生成一个“补丁”-所有选定文件的全部内容，并将其发送到TeamCity服务器。该修补程序也保留在开发人员的计算机上本地。发送更改后，更改将显示在开发人员的<a href="viewing-your-changes.html">更改</a>页面上。开发人员可以继续使用代码，并可以修改发送到预测试提交的文件。</p></li><li class="list__item" id="e23b6410"><p>个人构建像其他排队构建一样被排队和处理。</p></li><li class="list__item" id="55b21a57"><p>当构建开始时，它将像正常构建一样签出最新的资源，然后将开发人员从IDE发送的个人更改套用到整个副本（使用完整的文件内容）。</p></li><li class="list__item" id="304b7049"><p>该版本照常运行</p></li><li class="list__item" id="4ad211b8"><p>在构建结束时，个人更改将从构建的checkout目录恢复，以确保它们不会影响后续构建</p></li><li class="list__item" id="62888afe"><p>TeamCity IDE插件对TeamCity服务器执行ping操作，以检查所有选定的构建配置是否已准备好个人构建。如果构建失败，则IDE中会显示一条通知，该过程结束。</p></li><li class="list__item" id="d3f9c948"><p>如果所有个人构建均成功完成，则IDE插件将显示进度，备份参与个人更改的文件的当前版本（因为自启动预先测试的提交以来可能已经对其进行了修改），然后恢复文件内容从保存的“修补程序”中执行版本控制提交（如果出现诸如VCS冲突之类的错误，则报告错误），并还原刚刚备份的文件，以使工作副本处于最后看到的状态。TeamCity插件窗口中的预测试提交将获得错误或成功标记。</p></li></ul><hr id="ec1696e7"><p id="d23ee3f1"><b id="30f81c1a">也可以看看：</b></p><p id="e0540057"><b id="0fbce3f5">概念</b> ： <a href="remote-run.html">远程运行</a><br><b id="1102103c">在分支上</b> <a href="branch-remote-run-trigger.html">远程运行：在Git和Mercurial上在分支</a> <b id="1102103c">上</b> <a href="branch-remote-run-trigger.html">远程运行构建触发器</a><br><b id="aca922bf">安装工具</b> ： <a href="intellij-platform-plugin.html">IntelliJ平台插件</a> | <a href="eclipse-plugin.html">Eclipse插件</a> | <a href="visual-studio-addin.html">Visual Studio插件</a></p><hr id="d9541c82"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>