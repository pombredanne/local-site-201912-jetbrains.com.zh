<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Git - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Git" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/configuring-vcs-settings.md|Configuring VCS Settings/configuring-vcs-roots.md|Configuring VCS Roots/git.md|Git/ssh-keys-management.md|SSH Keys Management" data-main-title="Git" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/git.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Git" id="git.md">Git</h1><p id="0152d59f">TeamCity supports Git out of the box. Git source control with Azure DevOps Services is supported (see authentication notes <a href="#Authenticating-to-Azure-DevOps-Services">below</a>).</p><p id="30beed3f">This page contains description of the Git-specific fields of the VCS root settings.<br>For common VCS Root properties, see <a href="configuring-vcs-roots.html#Common-VCS-Root-Properties">this section</a>.</p><aside class="note " data-title="" rel="30beed3f" id="d5918f0e"><p id="b715e2f8">Git command line client needs to be installed on the agents if the <a href="vcs-checkout-mode.html#agent-checkout">agent-side checkout</a> is used.</p></aside><p id="fad3d960"><b id="14a7e8b8">Important notes</b>:</p><ul class="list _ul"><li class="list__item" id="87b7b8a0"><p><a href="remote-run.html">Remote Run</a> and <a href="pre-tested-delayed-commit.html">Pre-Tested Commit</a> are supported in the <a href="intellij-platform-plugin.html">IntelliJ IDEA</a> and <a href="eclipse-plugin.html">Eclipse</a> plugins; with the <a href="visual-studio-addin.html">Visual Studio Addin</a> use the <a href="branch-remote-run-trigger.html">Branch Remote Run Trigger</a>.</p></li><li class="list__item" id="19a46b67"><p>Initial Git <a href="build-checkout-directory.html#Checkout-Process">checkout</a> may take significant time (sometimes hours), depending on the size of your project history, because the whole project history is downloaded during the initial checkout.</p></li></ul><p id="13169c3c">On this page:</p><p id="a06af902"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#Git-GeneralSettings">General Settings</a><ul class="list _bullet"><li class="list__item"><a href="#Git-BranchMatchingRules">Branch Matching Rules</a></li><li class="list__item"><a href="#Git-SupportedGitProtocols">Supported Git Protocols</a></li></ul></li><li class="list__item"><a href="#Git-AuthenticationSettings">Authentication Settings</a></li><li class="list__item"><a href="#Git-AuthenticatingtoAzureDevOpsServices">Authenticating to Azure DevOps Services</a><ul class="list _bullet"><li class="list__item"><a href="#Git-PersonalAccessTokens">Personal Access Tokens</a><ul class="list _bullet"><li class="list__item"><a href="#Git-RequiredAccessScope">Required Access Scope</a></li></ul></li><li class="list__item"><a href="#Git-AlternateAuthenticationCredentials">Alternate Authentication Credentials</a></li></ul></li><li class="list__item"><a href="#Git-ServerSettings">Server Settings</a></li><li class="list__item"><a href="#Git-AgentSettings">Agent Settings</a><ul class="list _bullet"><li class="list__item"><a href="#Git-Gitexecutableontheagent">Git executable on the agent</a></li></ul></li><li class="list__item"><a href="#Git-ConfiguringGitGarbageCollectiononServer">Configuring Git Garbage Collection on Server</a></li><li class="list__item"><a href="#Git-GitLFS">Git LFS</a></li><li class="list__item"><a href="#Git-InternalProperties">Internal Properties</a></li><li class="list__item"><a href="#Git-Limitations">Limitations</a></li><li class="list__item"><a href="#Git-KnownIssues">Known Issues</a></li><li class="list__item"><a href="#Git-DevelopmentLinks">Development Links</a></li></ul></p><a name="GeneralSettings"></a><a name="General-Settings"></a><div class="chapter"><h2 id="Git-GeneralSettings">General Settings</h2><div class="table-wrapper"><table width="100%" id="e53ccc21"><thead><tr id="aaf01484" class="ijRowHead"><th width="150" id="6874ca58"><p id="36e0ebd7">Option</p></th><th id="b28ce12f"><p id="399248da">Description</p></th></tr></thead><tbody><tr id="00d3e7ca" class="ijRowOdd"><td id="b89d78b1"><p id="62923ba1">Fetch URL</p></td><td id="2960eee9"><p id="e7065ecb">The URL of the remote Git repository used for fetching data from the repository.</p></td></tr><tr id="ed03fccf" class="ijRowEven"><td id="f3c5be9a"><p id="55de179a">Push URL</p></td><td id="a0c45eec"><p id="666722e0">The URL of the target remote Git repository used for pushing annotated tags created via <a href="vcs-labeling.html">VCS labeling</a> build feature to the remote repository. If blank, the fetch URL is used.</p></td></tr><tr id="14bd5a16" class="ijRowOdd"><td id="e7523e77"><p id="cc9994db">Default branch</p></td><td id="f1c4646c"><a name="defaultBranch"></a><a name="Git-defaultBranch"></a><p id="e6b431ea">Configures <a href="working-with-feature-branches.html#Default-branch">default branch</a>. Parameter references are supported here. Default value is <code class="code">refs/heads/master</code>.</p><aside class="note " data-title="" rel="e6b431ea" id="aa6f3df0"><p id="b549b1c1">You can configure Git-plugin to fetch all heads by <a href="configuring-build-parameters.html#Defining-Build-Parameters-in-Build-Configuration">adding a build configuration parameter</a> <code class="code">teamcity.git.fetchAllHeads=true</code>.</p></aside></td></tr><tr id="9d92cef8" class="ijRowEven"><td id="f5899e1b"><p id="e92f4880">Branch specification</p></td><td id="cb16207c"><p id="be62c448">Lists the patterns for branch names, required for <a href="working-with-feature-branches.html#Configuring-branches">feature branches</a> support. The matched branches are monitored for changes in addition to the default branch. The syntax is similar to checkout rules: <code class="code">+|-:branch_name</code>, where <code class="code">branch_name</code> is specific to the VCS, i.e. <code class="code">refs/heads/</code> in Git (with the optional <code class="code">*</code> placeholder).</p><a name="OR-syntax-tip"></a><aside class="tip sideblock" data-title="" rel="7d9302dd" id="4f41664b"><p id="0bfa15d3">Here, the <i origin="teamcity-help" id="ccb68295">pipe</i> symbol <code class="code">|</code> represents the <b origin="teamcity-help" id="65503489">OR</b> command, as in regular expressions: use <code class="code">+</code> for including, <b origin="teamcity-help" id="3a18cf9b">OR</b> <code class="code">-</code> for excluding.</p></aside></td></tr><tr id="f2d20102" class="ijRowOdd"><td id="fe6a706b"><p id="4d1b98a4">Use tags as branches</p></td><td id="1fd685f4"><p id="5286450c">Allows monitoring / checking out git <a href="vcs-labeling.html">tags</a> as branches making branch specification match tag names as well as branches (for example,<code class="code">+|-:refs/tags/&lt;tag_name&gt;</code>). By default, tags are ignored.</p></td></tr><tr id="7b9cf874" class="ijRowEven"><td id="8268842c"><p id="6cf453ad">Username style</p></td><td id="97accb87"><p id="8f6788b8">Defines a way TeamCity reports username for a VCS change. Changing the username style will affect only newly collected changes. Old changes will continue to be stored with the style that was active at the time of collecting changes.</p></td></tr><tr id="4217770f" class="ijRowOdd"><td id="433c039b"><p id="77886d18">Submodules</p></td><td id="4917306e"><p id="9d54936a">Select whether you want to ignore the submodules, or treat them as a part of the source tree. Submodule repositories should either not require authentication or use the same protocol and accept the same authentication as configured in the VCS root.</p></td></tr><tr id="700c82cf" class="ijRowEven"><td id="e2a8efb7"><p id="59b99cab">Username for tags/merge</p></td><td id="950717f8"><p id="de29542c">A custom username used for <a href="vcs-labeling.html">labeling</a>.</p></td></tr></tbody></table></div><p id="ad67d88b"><a name="branchMatchingRules"></a><a name="Git-branchMatchingRules"></a></p><a name="BranchMatchingRules"></a><a name="Branch-Matching-Rules"></a><div class="chapter"><h3 id="Git-BranchMatchingRules">Branch Matching Rules</h3><ul class="list _ul"><li class="list__item" id="8d9c6e01"><p>If the branch matches a line without patterns, the line is used.</p></li><li class="list__item" id="8cb21934"><p>If the branch matches several lines with patterns, the best matching line is used.</p></li><li class="list__item" id="8e9c6f02"><p>If there are several lines with equal matching, the one below takes precedence.<br>Everything that is matched by the wildcard will be shown as a branch name in the TeamCity interface. For example, <code class="code">+:refs/heads/*</code> will match <code class="code">refs/heads/feature1</code> branch, but in the TeamCity interface you'll see only <code class="code">feature1</code> as a branch name.<br>The short name of the branch is determined as follows:</p></li><li class="list__item" id="195801f5"><p>if the line contains no brackets, then full line is used, if there are no patterns or part of line starting with the first pattern-matched character to the last pattern-matched character.</p></li><li class="list__item" id="6c631f46"><p>if the line contains brackets, then part of the line within brackets is used. When branches are specified here, and if your build configuration has a VCS trigger and a change is found in some branch, TeamCity will trigger a build in this branch.</p></li></ul></div><a name="SupportedGitProtocols"></a><a name="Supported-Git-Protocols"></a><div class="chapter"><h3 id="Git-SupportedGitProtocols">Supported Git Protocols</h3><p id="9f097ea8">The following protocols are supported for Git repository URL:</p><ul class="list _ul"><li class="list__item" id="695122eb"><p>ssh: (for example, <code class="code">ssh://git.somwhere.org/repos/test.git</code>, <code class="code">ssh://git@git.somwhereElse.org/repos/test.git</code>, scp-like syntax: <code class="code">git@git.somwhere.org:repos/test.git</code>)</p></li></ul><aside class="note " data-title="" rel="46f1b50f" id="c2aa3c2a"><p id="0f4b3c0e"><b id="5251e50c">Be careful</b></p><p id="85c76d29">The SCP-like syntax requires a colon after the hostname, while a usual SSH URL does not. This is a common source of errors.</p></aside><ul class="list _ul"><li class="list__item" id="048a6f9c"><p>git: (for example, <a href="git://git.kernel.org/pub/scm/git/git.git" data-external="true" target="_blank" rel="noopener noreferrer">git://git.kernel.org/pub/scm/git/git.git</a>)</p></li><li class="list__item" id="bce048f7"><p>http: (for example, <a href="http://git.somewhere.org/projects/test.git" data-external="true" target="_blank" rel="noopener noreferrer">http://git.somewhere.org/projects/test.git</a>)</p></li><li class="list__item" id="12a666f5"><p>file: (for example, <a href="file:///c:/projects/myproject/.git" data-external="true" target="_blank" rel="noopener noreferrer">file:///c:/projects/myproject/.git</a>)</p></li></ul><aside class="note " data-title="" rel="eef3d70b" id="3e4e4d3b"><p id="2bff021a"><b id="d134445e">Be careful</b></p><p id="c4cd06a5">The SCP-like syntax requires a colon after the hostname, while a usual SSH URL does not. This is a common source of errors.When you run TeamCity as a Windows service, it cannot access mapped network drives and repositories located on them.</p></aside></div></div><a name="AuthenticationSettings"></a><a name="Authentication-Settings"></a><div class="chapter"><h2 id="Git-AuthenticationSettings">Authentication Settings</h2><div class="table-wrapper"><table width="100%" id="59992846"><thead><tr id="8a016325" class="ijRowHead"><th id="2924979b"><p id="3cfbbe87">Authentication Method</p></th><th id="fe0b3136"><p id="0d41f0cb">Description</p></th></tr></thead><tbody><tr id="1d98ed05" class="ijRowOdd"><td id="51237a45"><p id="200bb462">Anonymous</p></td><td id="814ae3ff"><p id="b09631dc">Select this option to clone a repository with anonymous read access.</p></td></tr><tr id="f3726cad" class="ijRowEven"><td id="b852b69d"><p id="031b936f">Password</p></td><td id="064aa006"><a name="passwordAuth"></a><a name="Git-passwordAuth"></a><p id="e7d48084">Specify a valid <b id="0ecd533b">username</b> (if there is no username in the clone URL; the username specified here overrides the username from the URL) and a <b id="a389ad20">password</b> to be used to clone the repository.<br>For the <a href="vcs-checkout-mode.html">agent-side checkout</a>, it is supported <b id="220c9ea3">only if Git 1.7.3+ client</b> is installed on the agent. See <a href="http://youtrack.jetbrains.com/issue/TW-18711" data-external="true" target="_blank" rel="noopener noreferrer">TW-18711</a>.<br>For Git hosted from Team Foundation Server 2013, specify NTLM credentials here.</p><p id="ebcda378">You can use a personal access token instead of a password to authenticate to Azure DevOps Services. Note that TeamCity does not support token authentication to hosted <a href="https://azure.microsoft.com/en-in/services/devops/server/" data-external="true" target="_blank" rel="noopener noreferrer">Azure DevOps Server</a> (formerly, Team Foundation Server) installations.</p></td></tr><tr id="932fe757" class="ijRowOdd"><td id="492c9f87"><p id="907a77a7">Private Key</p></td><td id="5ccf4db5"><p id="cc9dcdd1">Valid only for SSH protocol. A private key must be in the <b id="30eb70b8">OpenSSH format</b>. Select one of the options from the <b id="140433df">Private Key</b> list and specify a valid username (if there is no username in the clone URL; the username specified here overrides the username from the URL).<br>Available <b id="c965d8bc">Private Key</b> options:</p><ul class="list _ul"><li class="list__item" id="ec2f44fd"><p><b id="76c6b19b">Uploaded Key</b> – uses the key(s) uploaded to the project. See <a href="ssh-keys-management.html">SSH Keys Management</a> for details.</p></li><li class="list__item" id="a9f4a144"><p><b id="7c8d1e2d">Default Private key</b> – uses the keys available on the file system in the default locations used by common ssh tools: the mapping specified in <code class="code">&lt;USER_HOME&gt;/.ssh/config</code> if the file exists or the private key file <code class="code">&lt;USER_HOME&gt;/.ssh/id_rsa</code> (the files are required to be present on the server and also on the agent if the <a href="vcs-checkout-mode.html">agent-side checkout</a> is used).</p></li><li class="list__item" id="28f7975b"><p><b id="83f74739">Custom Private Key</b> – supported <b id="cdd7a869">only for <a href="vcs-checkout-mode.html">server-side checkout</a></b>. When this method is used, fill the <b id="d16fc205">Private Key Path</b> field with an absolute path to the private key file on the server machine. If required, specify the passphrase to access your SSH key in the corresponding field.</p></li></ul></td></tr></tbody></table></div><p id="4acba8ed">For all available options to connect to GitHub, see the <a href="http://youtrack.jetbrains.com/issue/TW-16194#comment=27-475793" data-external="true" target="_blank" rel="noopener noreferrer">comment</a>.</p></div><a name="AuthenticatingtoAzureDevOpsServices"></a><a name="Authenticating-to-Azure-DevOps-Services"></a><div class="chapter"><h2 id="Git-AuthenticatingtoAzureDevOpsServices">Authenticating to Azure DevOps Services</h2><p id="21537347">If you use Git source control with Azure DevOps Services, the following options are available to you:</p><a name="azure-authentication"></a><a name="PersonalAccessTokens"></a><a name="Personal-Access-Tokens"></a><div class="chapter"><h3 id="Git-PersonalAccessTokens">Personal Access Tokens</h3><p id="0dfe3004">To use access tokens, you need to create a <a href="https://www.visualstudio.com/en-us/docs/setup-admin/team-services/use-personal-access-tokens-to-authenticate" data-external="true" target="_blank" rel="noopener noreferrer">personal access token</a> in your Azure DevOps account, where you have to set some <b origin="teamcity-help" id="f30c2bbd">Code</b> <a href="#Required-Access-Scope">access scope</a> in your repositories and use it when configuring a VCS root.</p><aside class="note " data-title="" rel="0dfe3004" id="5d3c46b6"><p id="f6713c43">You can authenticate with a personal access token to Azure DevOps Services only. TeamCity does not support token authentication to hosted <a href="https://azure.microsoft.com/en-in/services/devops/server/" data-external="true" target="_blank" rel="noopener noreferrer">Azure DevOps Server</a> (formerly, Team Foundation Server) installations.</p></aside><div class="table-wrapper"><table width="100%" id="995c1956"><thead><tr id="98e94b41" class="ijRowHead"><th id="8289e28c"><p id="aa5e731e">Option</p></th><th id="48817271"><p id="7e953a34">Description</p></th></tr></thead><tbody><tr id="517e8f71" class="ijRowOdd"><td id="adf66fc4"><p id="fdf9318e">Username</p></td><td id="497009b3"><p id="c00e1b4e">Leave blank for TFVC, any value for Git, for example, username</p></td></tr><tr id="59154c7c" class="ijRowEven"><td id="9cec30fb"><p id="2a1a3773">Password</p></td><td id="7f9e0498"><p id="f9b797b1">Enter your personal access token created earlier</p></td></tr></tbody></table></div><a name="RequiredAccessScope"></a><a name="Required-Access-Scope"></a><div class="chapter"><h4 id="Git-RequiredAccessScope">Required Access Scope</h4><div class="table-wrapper"><table width="100%" id="0fe9dc6a"><thead><tr id="24ad1236" class="ijRowHead"><th id="21988817"><p id="1835b2e1">TFS subsystem</p></th><th id="6ef148ad"><p id="f900b7de">Scopes</p></th></tr></thead><tbody><tr id="1ce7b31a" class="ijRowOdd"><td id="fe81ee34"><p id="9386db7f">TFVC</p></td><td id="437e0214"><p id="7733d210">All scopes</p></td></tr><tr id="4c9b7c1c" class="ijRowEven"><td id="8f734e0d"><p id="8ea4d9c8">Git</p></td><td id="9a39106a"><p id="08c407b9">Code (read) / Code (read and write) for versioned settings</p></td></tr><tr id="58033015" class="ijRowOdd"><td id="88681edf"><p id="51729c1b">Work Items</p></td><td id="0d695fa1"><p id="510d7fcd">Work items (read)</p></td></tr><tr id="ab84f429" class="ijRowEven"><td id="dfb6111f"><p id="fdaa1c55">Commit Status</p></td><td id="5f2e1b7c"><p id="b3c47050">Code (status)</p></td></tr></tbody></table></div></div></div><a name="AlternateAuthenticationCredentials"></a><a name="Alternate-Authentication-Credentials"></a><div class="chapter"><h3 id="Git-AlternateAuthenticationCredentials">Alternate Authentication Credentials</h3><p id="33887f6d">To use the login/password pair authentication, you have to enable <a href="https://www.visualstudio.com/en-us/docs/report/analytics/client-authentication-options#create-an-alternate-access-credential" data-external="true" target="_blank" rel="noopener noreferrer">alternate credentials</a> in your Azure DevOps account, where you can set a secondary username and password to use when configuring a VCS root.</p></div></div><a name="ServerSettings"></a><a name="Server-Settings"></a><div class="chapter"><h2 id="Git-ServerSettings">Server Settings</h2><p id="41c67829">These are the settings used in case of the server-side <a href="vcs-checkout-mode.html">checkout</a>.</p><div class="table-wrapper"><table width="100%" id="01805d9f"><thead><tr id="500e4196" class="ijRowHead"><th width="150" id="a88c3095"><p id="e60c7396">Option</p></th><th id="5dd09f30"><p id="06c6ad46">Description</p></th></tr></thead><tbody><tr id="8794c54a" class="ijRowOdd"><td id="d5e96c5b"><a name="serverAutoCRLF"></a><a name="Git-serverAutoCRLF"></a><p id="4c942ff1">Convert line-endings to CRLF</p></td><td id="a4c44acc"><p id="1321f48c">Convert line-endings of all text files to CRLF (works as setting <code class="code">core.autocrlf=true</code> in a repository config). When not selected, no line-endings conversion is performed (works as setting <code class="code">core.autocrlf=false</code>). Affects the server-side checkout only. A change to this property causes a clean checkout.</p></td></tr></tbody></table></div></div><a name="AgentSettings"></a><a name="Agent-Settings"></a><div class="chapter"><h2 id="Git-AgentSettings">Agent Settings</h2><p id="ac6f26da"><a name="agentSettings"></a><a name="Git-agentSettings"></a></p><p id="ce481e31">These are the settings used in case of the agent-side <a href="vcs-checkout-mode.html">checkout</a>.<br>Note that the agent-side checkout has limited support for SSH. The only supported authentication methods are "Default Private Key" and "Uploaded Private Key".<br>If you plan to use the <a href="vcs-checkout-mode.html">agent-side checkout</a>, you need to have Git 1.6.4+ installed on the agents.</p><div class="table-wrapper"><table width="100%" id="74b5e08b"><thead><tr id="0984b757" class="ijRowHead"><th width="150" id="3f42bfad"><p id="22e82dbd">Option</p></th><th id="06959504"><p id="433b3675">Description</p></th></tr></thead><tbody><tr id="1c8b92f2" class="ijRowOdd"><td id="d73c4afc"><p id="962868e8">Path to git</p></td><td id="55d519d6"><p id="b0e0f382">Provide the path to a git executable to be used on the agent. When set to <code class="code">%env.TEAMCITY_GIT_PATH%</code>, the automatically detected git will be used, see <a href="#Git-executable-on-the-agent">Git executable on the agent</a> for details</p></td></tr><tr id="5b15182a" class="ijRowEven"><td id="598c47e4"><p id="7e9c969c">Clean Policy/Clean Files Policy</p></td><td id="529f4050"><p id="b8bc5f1f">Specify here when the <code class="code">git clean</code> command is to run on the agent, and which files are to be removed.</p></td></tr><tr id="05640aee" class="ijRowOdd"><td id="1c02f460"><a name="use-alternates"></a><a name="Git-use-alternates"></a><p id="0f301ba0">Use mirrors</p></td><td id="85220d3e"><p id="f12178a9">When <b id="dbefaf18">enabled</b> (default), TeamCity clones the repository under the agent's <code class="code">system\git</code> directory and uses the mirror as an alternate repository when updating the checkout directory for the build. As a result, this speeds-up clean checkout (because only the working directory is cleaned), and saves disk space (as there is only one clone of the given Git repository on an agent).</p><p id="59d289a5">If you <b id="a8d90395">disable</b> this option, TeamCity will clone the repository directly under the build's working directory, unless the <a href="#use-local-mirrors"><code class="code">teamcity.git.use.local.mirrors</code></a> property is set to <code class="code">true</code>.</p></td></tr></tbody></table></div><aside class="tip sideblock" data-title="" rel="74b5e08b" id="7328237d"><p id="bd5c28ca">To configure a connection from a TeamCity server running behind a proxy to a remote Git repository, see <a href="how-to.html#Configure-TeamCity-to-Use-Proxy-Server-for-Outgoing-Connections">this section</a>.</p></aside><a name="Gitexecutableontheagent"></a><a name="Git-executable-on-the-agent"></a><div class="chapter"><h3 id="Git-Gitexecutableontheagent">Git executable on the agent</h3><p id="cc53777d"><a name="agentGitPath"></a><a name="Git-agentGitPath"></a></p><p id="f47ff50b">TeamCity needs Git command line client version 1.6.4+ on the agent in order to use the agent-side checkout.</p><p id="2e473265">The recommended approach is to ensure that the git client is available in <code class="code">PATH</code> of the TeamCity agent and leave the "Path to git" setting in the VCS root blank.<br>If you only have the git command line on some machines, set "Path to git" setting in the VCS root to the <code class="code">%env.TEAMCITY_GIT_PATH%</code> value.</p><p id="caeee187">Instead of adding Git to the agent's PATH, you can set the <code class="code">TEAMCITY_GIT_PATH</code> environment variable (or <code class="code">env.TEAMCITY_GIT_PATH</code> property in the agent's <a href="build-agent-configuration.html"><code class="code">buildAgent.properties</code></a> file) to the full path to the git executable.</p><p id="00445ac2">If <code class="code">TEAMCITY_GIT_PATH</code> is not defined, the Git agent plugin tries to detect the installed git on the launch of the agent. It first tries to run git from the following locations:</p><ul class="list _ul"><li class="list__item" id="50bf4415">for Windows - it tries to run <code class="code">git.exe</code> at:<ul class="list _ul"><li class="list__item" id="b7076501"><code class="code">C:\Program Files\Git\bin</code></li><li class="list__item" id="27004d7d"><code class="code">C:\Program Files (x86)\Git\bin</code></li><li class="list__item" id="68d1a7ff"><code class="code">C:\cygwin\bin</code></li></ul></li><li class="list__item" id="e877758c">for *nix - it tries to run <code class="code">git</code> at:<ul class="list _ul"><li class="list__item" id="1b54c4a7"><code class="code">/usr/local/bin</code></li><li class="list__item" id="cbbec00f"><code class="code">/usr/bin</code></li><li class="list__item" id="403e5af1"><code class="code">/opt/local/bin</code></li><li class="list__item" id="a0d7c3f9"><code class="code">/opt/bin</code></li></ul></li></ul><p id="a949ed0f">If git is not found in any of these locations, it tries to run the git accessible via the <code class="code">PATH</code> environment variable.<br>If a compatible git (1.6.4+) is found, it is reported in the <code class="code">TEAMCITY_GIT_PATH</code> environment variable. This variable can be used in the <b id="19450763">Path to git</b> field in the <a href="vcs-root.html">VCS root</a> settings. As a result, the configuration with such a VCS root will run only on the agents where git was detected or specified in the agent properties.</p><p id="c6901e87"><a name="Git_gc"></a><a name="Git-Git_gc"></a></p></div></div><a name="ConfiguringGitGarbageCollectiononServer"></a><a name="Configuring-Git-Garbage-Collection-on-Server"></a><div class="chapter"><h2 id="Git-ConfiguringGitGarbageCollectiononServer">Configuring Git Garbage Collection on Server</h2><p id="d725ca96">TeamCity server maintains a local clone for every Git repository used in the VCS roots configured on the server. Since the server performs fetch in those clones many times a day, the clone needs regular optimization to maintain predictable performance. If the Git garbage collection for the clone was not run for a long time, the process of collecting changes may slow down or start to report memory-related errors.TeamCity can automatically run git gc periodically when native Git client can be found on the server. Inability to run Git GC results in a related health report.</p><p id="62213144">To fix the warning / meet automatic git gc requirements, perform the following:</p><ol class="list _decimal"><li class="list__item" id="e515f900"><p>Install a native Git client manually on the TeamCity server.</p></li><li class="list__item" id="640f96d5">Specify path to the Git executable:<ul class="list _ul"><li class="list__item" id="7b48cbb6"><p>add the drectory with the executable to the <code class="code">Path</code> environment variable and restart the server, <i id="81eaa5e5">or</i></p></li><li class="list__item" id="569a8c84"><p>set the full path to the directory in the <code class="code">teamcity.server.git.executable.path</code> <a href="configuring-teamcity-server-startup-properties.html#TeamCity-internal-properties">internal property</a> without the server restart.</p></li></ul></li></ol><p id="6853ae8d">When TeamCity runs Git garbage collection, the details are logged into the <a href="teamcity-server-logs.html"><code class="code">teamcity-cleanup.log</code></a>. If git garbage collection fails, a corresponding warning is displayed.</p><p id="58c8faf8">TeamCity executes Git garbage collection until the total time doesn't exceed 5 hours quota; the quota can be changed using the <code class="code">teamcity.server.git.gc.quota.minutes</code> <a href="configuring-teamcity-server-startup-properties.html#TeamCity-internal-properties">internal property</a>.<br>Git garbage collection is executed every night at 2 a.m., this can be changed by specifying the internal property with a cron expression like this: <code class="code">teamcity.git.cleanupCron=0 0 2 * * ?</code> (restart the server for the property to take effect). If the <code class="code">git gc</code> process works slowly and cannot be completed in the allotted time, check the <code class="code">git-repack</code> configuration in the default Git configuration files (for example, you can increase <code class="code">--window-memory</code> to improve the <code class="code">git gc</code> performance).</p><p id="0f7fb754">If the local Git clones need some kind of manual maintenance, you can find them under <code class="code">&lt;TeamCity Data Directory&gt;/system/caches/git</code> directory. The <code class="code">map</code> file in the directory contains mapping between the repository URL and the subdirectory storing the bare clone of the repository.</p></div><a name="GitLFS"></a><a name="Git-LFS"></a><div class="chapter"><h2 id="Git-GitLFS">Git LFS</h2><p id="a214800c">TeamCity supports Git LFS for agent-side checkout. To use it, install git 1.8.5+ and Git LFS on the build agent machine. Git LFS should be enabled using the <code class="code">git lfs install</code> command (on Windows an elevated command prompt may be needed). More information is available in <a href="https://git-lfs.github.com/" data-external="true" target="_blank" rel="noopener noreferrer">Git LFS documentation</a>.</p><p id="3a70655a"><a name="internalProperties"></a><a name="Git-internalProperties"></a></p></div><a name="InternalProperties"></a><a name="Internal-Properties"></a><div class="chapter"><h2 id="Git-InternalProperties">Internal Properties</h2><p id="3c929f65">For Git VCS it is possible to configure the following <a href="configuring-teamcity-server-startup-properties.html#TeamCity-internal-properties">internal properties</a>:</p><div class="table-wrapper"><table class=" wide" width="100%" id="75badc6b"><thead><tr id="27c8ce80" class="ijRowHead"><th width="300" id="dcbd420f"><p id="793815f2">Property</p></th><th width="100" id="51583db8"><p id="599659ab">Default</p></th><th id="6fe8241f"><p id="754b4aba">Description</p></th></tr></thead><tbody><tr id="3a7e6925" class="ijRowOdd"><td id="8c410ee3"><p id="87063053"><code class="code">teamcity.git.idle.timeout.seconds</code></p></td><td id="e7932a3e"><p id="5b6eaff0">1800</p></td><td id="9fd43324"><p id="b47ab055">The idle timeout for communication with the remote repository. If no data were sent or received during this timeout, the plugin throws a timeout error to prevent hanging of the process forever.</p></td></tr><tr id="bc7765e7" class="ijRowEven"><td id="fd07ab74"><p id="446627b4"><code class="code">teamcity.git.fetch.timeout</code></p></td><td id="c0be8a6c"><p id="598d8110">1800</p></td><td id="38fec9c6"><p id="0312b2a0">(deprecated) Override of <code class="code">teamcity.git.idle.timeout.seconds</code> for git fetch operation</p></td></tr><tr id="37561a25" class="ijRowOdd"><td id="4ca94b1e"><p id="854ddeb0"><code class="code">teamcity.git.fetch.separate.process</code></p></td><td id="effe349b"><p id="54bbbaa9">true</p></td><td id="89d475ee"><p id="29cb7f18">Defines whether TeamCity runs git fetch in a separate process</p></td></tr><tr id="395a105d" class="ijRowEven"><td id="3aff4373"><p id="94b5fa15"><code class="code">teamcity.git.fetch.process.max.memory</code></p></td><td id="aed2cb31"><p id="d4064ccc">512M</p></td><td id="c66e8e79"><p id="e5805cef">The value of the JVM -Xmx parameter for a separate fetch process. You also need to ensure the server machine has enough memory as the memory configured will be used in addition to the main server process and there can be several child processes doing git fetch and each using the configured amount of the memory.</p><aside class="note " data-title="" rel="e5805cef" id="7d991e73"><p id="05be2416">For large repositories requiring heap memory greater than <code class="code">-Xmx1024m</code> for Git fetch, <a href="installing-and-configuring-the-teamcity-server.html#Setting-Up-Memory-settings-for-TeamCity-Server">switching to 64-bit Java</a> may be needed.</p></aside></td></tr><tr id="c519bd17" class="ijRowOdd"><td id="716c780d"><p id="c0ae768f"><code class="code">teamcity.git.monitoring.expiration.timeout.hours</code></p></td><td id="96b220c4"><p id="56ce1f58">24</p></td><td id="dbee9676"></td></tr><tr id="10bd8e0e" class="ijRowEven"><td id="97b23e59"><p id="e173271c"><code class="code">teamcity.server.git.gc.enabled</code></p></td><td id="e02328e6"><p id="c9119bc2">false</p></td><td id="0a07bf50"><p id="7a924de0">Whether TeamCity should run <code class="code">git gc</code> during the server cleanup (native git is used)</p></td></tr><tr id="be63fd81" class="ijRowOdd"><td id="f0f268ef"><p id="a67c9ec8"><code class="code">teamcity.server.git.executable.path</code></p></td><td id="6b9acee8"><p id="c65162f6">git</p></td><td id="2756f696"><p id="43eca89d">The path to the native git executable on the server</p></td></tr><tr id="2cb6ceac" class="ijRowEven"><td id="2564168b"><p id="33040219"><code class="code">teamcity.server.git.gc.quota.minutes</code></p></td><td id="574ee6be"><p id="ab0aac06">60</p></td><td id="c4ec6220"><p id="8b246515">Maximum amount of time to run <code class="code">git gc</code></p></td></tr><tr id="45a2a08a" class="ijRowOdd"><td id="ed46e8a9"><p id="ac488fef"><code class="code">teamcity.git.cleanupCron</code></p></td><td id="bee85a96"><p id="ef9d9f4e">0 0 2 * * ? *</p></td><td id="01464686"><p id="4ce8ed06"><a href="http://quartz-scheduler.org/documentation/quartz-1.x/tutorials/crontrigger" data-external="true" target="_blank" rel="noopener noreferrer">Cron expression</a> for the time of a cleanup in git-plugin, by default - daily at 2a.m.</p></td></tr><tr id="ccd85790" class="ijRowEven"><td id="6fadce1d"><p id="66e02b5a"><code class="code">teamcity.git.stream.file.threshold.mb</code></p></td><td id="73bcd4b6"><p id="2c03dc92">128</p></td><td id="f8cbc976"><p id="23fb9e01">Threshold in megabytes after which JGit uses streams to inflate objects. Increase it if you have large binary files in the repository and see symptoms described in <a href="http://youtrack.jetbrains.com/issue/TW-14947" data-external="true" target="_blank" rel="noopener noreferrer">TW-14947</a></p></td></tr><tr id="c8ae09d3" class="ijRowOdd"><td id="92a92d87"><p id="8e9f4917"><code class="code">teamcity.git.buildPatchInSeparateProcess</code></p></td><td id="52dbcbcb"><p id="437b1812">true</p></td><td id="9b4abe9e"><p id="700e87e6">Git-plugin builds patches in a separate process, set it to false to build patch in the server process. To build patch git-plugin has to read repository files into memory. To not run out of memory git-plugin reads only objects of size smaller than the threshold, for larger objects streams are used and they can be slow (<a href="http://youtrack.jetbrains.com/issue/TW-14947" data-external="true" target="_blank" rel="noopener noreferrer">TW-14947</a>). With patch building in a separate process all objects are read into memory. Patch process uses the memory settings of the separate fetch process.</p></td></tr><tr id="cfb1e1c5" class="ijRowEven"><td id="c002ba5f"><p id="12b398db"><code class="code">teamcity.git.mirror.expiration.timeout.days</code></p></td><td id="c6f4a076"><p id="0cb4ff8f">7</p></td><td id="552d1b5f"><p id="691a7cc2">The number of days after which an unused clone of the repository will be removed from the server machine. The repository is considered unused if there were no TeamCity operations on this repository, like checking for changes or getting the current version. These operations are quite frequent, so 7 days is a reasonably high value.</p></td></tr><tr id="cdfe8b5e" class="ijRowOdd"><td id="d58964a4"><p id="7075766c"><code class="code">teamcity.git.commit.debug.info</code></p></td><td id="e35f677d"><p id="6964bdda">false</p></td><td id="e11cfa4c"><p id="b0086d05">Defines whether to log additional debug info on each found commit</p></td></tr><tr id="79e8b05e" class="ijRowEven"><td id="f8ff96b5"><p id="a729dfa6"><code class="code">teamcity.git.sshProxyType</code></p></td><td id="39259e77"></td><td id="daad2844"><p id="d45f7f3c">Type of ssh proxy, supported values: <code class="code">http</code>, <code class="code">socks4</code>, <code class="code">socks5</code>. Keep in mind that socks4 proxy cannot resolve remote host names, so if you get an UnknownHostException, either switch to socks5 or add an entry for your git server into the hosts file on the TeamCity server machine.</p></td></tr><tr id="079a82a7" class="ijRowOdd"><td id="535f223e"><p id="145d1003"><code class="code">teamcity.git.sshProxyHost</code></p></td><td id="d1b33e8e"></td><td id="e5195c29"><p id="283a0e09">SSH proxy host</p></td></tr><tr id="79080ec8" class="ijRowEven"><td id="440bb2de"><p id="346f1f07"><code class="code">teamcity.git.sshProxyPort</code></p></td><td id="755ade46"></td><td id="9d93a631"><p id="f51c2128">SSH proxy port</p></td></tr><tr id="10fa38f7" class="ijRowOdd"><td id="66c6ef86"><p id="3e5f7d0d"><code class="code">teamcity.git.connectionRetryAttempts</code></p></td><td id="72f68fe1"><p id="56fc66e8">3</p></td><td id="44c838cb"><p id="7d9a665a">Number of attempts to establish connection to the remote host for testing connection and getting a current repository state before admitting a failure</p></td></tr><tr id="1da403ac" class="ijRowEven"><td id="3a7db7c0"><p id="8b94b2d7"><code class="code">teamcity.git.connectionRetryIntervalSeconds</code></p></td><td id="b5efd0a7"><p id="832f8741">4</p></td><td id="a9ab11b3"><p id="0c523211">Interval in seconds between connection attempts</p></td></tr><tr id="e04b67cc" class="ijRowOdd"><td id="df1e9ced"><a name="use-local-mirrors"></a><a name="Git-use-local-mirrors"></a><p id="25bb7bef"><code class="code">teamcity.git.use.local.mirrors</code></p></td><td id="30b52299"><p id="3752d5b9">false</p></td><td id="6bdbac77"><p id="623de429"><i id="91d20069">TeamCity checks the state of this property only if the "<a href="#use-alternates"><i id="41919f93">Use mirrors</i></a>" option is disabled in the VCS root settings.</i></p><p id="0549b2ce">By default, if you disable "<i id="003f68e4">Use mirrors</i>", TeamCity will clone the repository under the build's working directory.<br>Set <code class="code">teamcity.git.use.local.mirrors</code> to <code class="code">true</code> to clone the repository under the agent's <code class="code">system\git</code> directory instead. When running a build, TeamCity will copy the repository from this directory to the build's working directory.</p><aside class="note " data-title="" rel="0549b2ce" id="fede59f5"><p id="57221607">Copying a repository from a directory located on the same machine is faster than always cloning the repository from the source, so we recommend setting <code class="code">teamcity.git.use.local.mirrors</code> to <code class="code">true</code> if you disable the "<i id="68088731">Use mirrors</i>" option.</p></aside></td></tr><tr id="2d92338a" class="ijRowEven"><td id="16d1294d"><p id="c924669d"><code class="code">teamcity.git.use.shallow.clone</code></p></td><td id="7f011ede"><p id="2a25c5ac">false</p></td><td id="5d1c56a5"><p id="692a430d"><i id="b0d30b95">TeamCity checks the state of this property only if the "<i id="fe6499fc">Use mirrors</i>" option is disabled in the VCS root settings and <code class="code">teamcity.git.use.local.mirrors</code> is set to <code class="code">true</code>.</i></p><p id="b0b1b589">If <code class="code">teamcity.git.use.shallow.clone</code> is set to <code class="code">true</code>, TeamCity will only clone the last version of the repository. This is equal to creating a <i id="64c9eacb">shallow</i> clone, which means setting the <a href="https://git-scm.com/docs/git-clone#Documentation/git-clone.txt---depthltdepthgt" data-external="true" target="_blank" rel="noopener noreferrer">depth</a> of the <code class="code">git clone</code> operation to <code class="code">1</code>.</p><p id="5bd64fa3">If you don't need to store any commits, except the last one (for example if you often use disposable cloud instances for running builds), you can optimize the performance of your setup by disabling the "<a href="#use-alternates"><i id="0fb81dcb">Use mirrors</i></a>" option, and setting the internal properties as follows:</p><ul class="list _ul"><li class="list__item" id="e185b817"><code class="code">teamcity.git.use.local.mirrors=true</code></li><li class="list__item" id="99edd27d"><code class="code">teamcity.git.use.shallow.clone=true</code></li></ul><p id="7b524808">In all other cases we recommend leaving the "<i id="93dbd715">Use mirrors</i>" option enabled.</p></td></tr></tbody></table></div><p id="88eb40dc"><a href="build-agent-configuration.html">Agent configuration</a> for Git:</p><div class="table-wrapper"><table class=" wide" width="100%" id="dcf5a174"><thead><tr id="fbf60800" class="ijRowHead"><th width="300" id="dacbfb1e"><p id="d7da02bc">Property</p></th><th id="e75a5baa"><p id="029265bd">Default</p></th><th id="ddc2ac3a"><p id="17dc4d7e">Description</p></th></tr></thead><tbody><tr id="d98b31ab" class="ijRowOdd"><td id="83092cde"><p id="fe59091a"><code class="code">teamcity.git.use.native.ssh</code></p></td><td id="b62204c7"><p id="aebaf2c0">false</p></td><td id="e30c9181"><p id="fbb0f2c0">When checkout on agent: whether TeamCity should use native SSH implementation.</p></td><td id="96255b40"></td></tr><tr id="a5646e7f" class="ijRowEven"><td id="fb178716"><p id="a1408c3b"><code class="code">teamcity.git.idle.timeout.seconds</code></p></td><td id="619cd60b"><p id="aaaf5584">1800</p></td><td id="9ba47c49"><p id="163ac5f9">The idle timeout for the git fetch operation when the agent-side checkout is used. The fetch is terminated if there is no output from the fetch process during this time. Prior to 8.0.4 the default was 600.</p></td></tr></tbody></table></div><p id="45297578"><a name="limitations"></a><a name="Git-limitations"></a></p></div><a name="Limitations"></a><a name="Limitations"></a><div class="chapter"><h2 id="Git-Limitations">Limitations</h2><p id="d1e28b8b">When using checkout on an agent, a limited subset of <a href="vcs-checkout-rules.html">checkout rules</a> is supported. Git-plugin translates some of the checkout rules to the sparse checkout patterns. Only the <b id="e9afa41e">rules which do not remap files are supported</b>:</p><div class="code-block" data-lang="bash">
+:some/dir
-:some/dir/subDir

</div><p id="b4377ff1">An <b id="8a47cdd9">unsupported</b> rule example is  <code class="code">+:some/dir=&gt;some/otherDir</code>.</p></div><a name="KnownIssues"></a><a name="Known-Issues"></a><div class="chapter"><h2 id="Git-KnownIssues">Known Issues</h2><ul class="list _ul"><li class="list__item" id="0194afe6"><p><code class="code">java.lang.OutOfMemoryError</code> while fetch repository. Usually occurs when there are large files in the repository. By default, TeamCity runs fetch in a separate process. To increase memory available to this process, change the teamcity.git.fetch.process.max.memory internal property (see description of this property <a href="#Internal-Properties">above</a>).</p></li><li class="list__item" id="f8d4b514"><p>Teamcity run as a Windows service cannot access a network mapped drives, so you cannot work with git repositories located on such drives. To make this work, run TeamCity using <code class="code">teamcity-server.bat</code>.</p></li><li class="list__item" id="fc008c1a"><p>inflation using streams in JGit prevents <code class="code">OutOfMemoryError</code>, but can be time-consuming (see the related thread at <a href="http://dev.eclipse.org/mhonarc/lists/jgit-dev/msg00687.html" data-external="true" target="_blank" rel="noopener noreferrer">jgit-dev</a> for details and the <a href="http://youtrack.jetbrains.net/issue/TW-14947" data-external="true" target="_blank" rel="noopener noreferrer">TW-14947</a> issue related to the problem). If you meet conditions similar to those described in the issue, try to increase <code class="code">teamcity.git.stream.file.threshold.mb</code>. Additionally, it is recommended to increase the overall amount of memory dedicated for TeamCity to prevent <code class="code">OutOfMemoryError</code>.</p></li></ul></div><a name="DevelopmentLinks"></a><a name="Development-Links"></a><div class="chapter"><h2 id="Git-DevelopmentLinks">Development Links</h2><p id="8eb04567">Git support is implemented as an open-source plugin. For development links, refer to the <a href="https://plugins.jetbrains.com/plugin/8887-git" data-external="true" target="_blank" rel="noopener noreferrer">plugin's page</a>.</p><hr id="645f4005"><p id="90e433db"><b id="472c6c0f">See also:</b></p><p id="6b3917bc"><b id="cc65f3c7">Administrator's Guide</b>: <a href="branch-remote-run-trigger.html">Branch Remote Run Trigger</a></p><hr id="72ccbf06"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>