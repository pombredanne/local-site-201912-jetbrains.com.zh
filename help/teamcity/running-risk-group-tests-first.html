<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Running Risk Group Tests First - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Running Risk Group Tests First" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-unit-testing-and-code-coverage.md|Configuring Unit Testing and Code Coverage/running-risk-group-tests-first.md|Running Risk Group Tests First" data-main-title="Running Risk Group Tests First" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/running-risk-group-tests-first.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Running Risk Group Tests First" id="running-risk-group-tests-first.md">Running Risk Group Tests First</h1><p id="cb307aeb">On this page:</p><p id="92f92bae"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#RunningRiskGroupTestsFirst-ReorderingRiskTestsforJUnitandTestNG">Reordering Risk Tests for JUnit and TestNG</a></li><li class="list__item"><a href="#RunningRiskGroupTestsFirst-ReorderingRiskTestsforNUnit">Reordering Risk Tests for NUnit</a></li></ul></p><p id="db461de7"><a name="testReorderingJUnitAndTestNG"></a><a name="RunningRiskGroupTestsFirst-testReorderingJUnitAndTestNG"></a></p><a name="ReorderingRiskTestsforJUnitandTestNG"></a><a name="Reordering-Risk-Tests-for-JUnit-and-TestNG"></a><div class="chapter"><h2 id="RunningRiskGroupTestsFirst-ReorderingRiskTestsforJUnitandTestNG">Reordering Risk Tests for JUnit and TestNG</h2><p id="68cee6d5">Supported environments:</p><ul class="list _ul"><li class="list__item" id="3c718bfc"><p><a href="ant.html">Ant</a> and <a href="intellij-idea-project.html">IntelliJ IDEA Project</a> runners</p></li><li class="list__item" id="9805f239"><p>JUnit and TestNG frameworks when tests are started with usual JUnit or TestNG tasks</p></li></ul><aside class="tip sideblock" data-title="" rel="b7094dee" id="966ebd1b"><p id="283e9dbf">TeamCity also allows <a href="https://plugins.jetbrains.com/docs/teamcity/risk-tests-reordering-in-custom-test-runner.html" data-external="true" target="_blank" rel="noopener noreferrer">implementing tests reordering feature for a custom build runner</a>.</p></aside><p id="93498152">You can instruct TeamCity to run some tests before others. You can do this on the build runner settings page. Currently there are two groups of tests that TeamCity can run first:</p><ul class="list _ul"><li class="list__item" id="09cb9b02"><p>recently failed tests, i.e. the tests failed in previous finished or running builds as well as tests having high failure rate (a so called blinking tests)</p></li><li class="list__item" id="0507c5f0"><p>new and modified tests, i.e. tests added or modified in changelists included in the running build</p></li></ul><aside class="note " data-title="" rel="27c30576" id="01d9f8d6"><p id="5ba8fc6b">The recently added or modified tests in your <a href="personal-build.html">personal build</a> have the highest priority, and these tests run even before any other reordered test.</p></aside><p id="74bbb54f">TeamCity allows you to enable both of these groups or each one separately.</p><p id="2a804c14">TeamCity operates on test case basis, that is not the individual tests are reordered, but the full test cases. The tests cases are reordered only within a single test execution Ant task, so to maximize the feature effect, use a single test execution task per build.</p><p id="6e28f825">Tests reordering works the following way:</p><a name="JUint"></a><a name="JUint"></a><h4 id="RunningRiskGroupTestsFirst-JUint">JUint</h4><ol class="list _decimal"><li class="list__item" id="5e87b4c3"><p>TeamCity provides tests that should be run first (test classes).</p></li><li class="list__item" id="506a5ea9"><p>When a JUnit task starts, TeamCity checks whether it includes these tests.</p></li><li class="list__item" id="36bb695e"><p>If at least one test is included, TeamCity generates a new fileset containing included tests only and processes it before all other filesets. It also patches other filesets to exclude tests added to the automatically generated fileset.</p></li><li class="list__item" id="92290f76"><p>After that JUnit starts and runs as usual.</p></li></ol><aside class="note " data-title="" rel="95718332" id="9025a8ee"><p id="29b4090f">Some cases when automatic tests reordering will not work:</p><ul class="list _ul"><li class="list__item" id="413fe783"><p>if JUnit suites are created manually in test cases with help of suite() method</p></li><li class="list__item" id="ef0e4ea5"><p>if @RunWith annotation is used in JUnit4 tests</p></li></ul></aside><a name="TestNG"></a><a name="TestNG"></a><h4 id="RunningRiskGroupTestsFirst-TestNG">TestNG</h4><a name="TestNGversionslessthan5.14:"></a><a name="TestNG-versions-less-than-5.14:"></a><h4 id="RunningRiskGroupTestsFirst-TestNGversionslessthan5.14:">TestNG versions less than 5.14:</h4><ol class="list _decimal"><li class="list__item" id="27bb4b4b"><p>TeamCity provides tests that should be run first (test classes).</p></li><li class="list__item" id="2ff02c31"><p>When a TestNG task starts, TeamCity checks whether it includes these tests.</p></li><li class="list__item" id="553027b3"><p>If at least one test is included, TeamCity generates a new xml file with suite containing included tests only and processes it before all other files. It also patches other files to exclude tests added to the automatically generated file.</p></li><li class="list__item" id="2543f9da"><p>After that TestNG starts and runs as usual.</p></li></ol><aside class="note " data-title="" rel="4c2e7579" id="377d462e"><p id="cd647cff">Some cases when automatic tests reordering will not workif &lt;package/&gt; element is used in the TestNG XML suite.</p></aside><a name="TestNGversions5.14ornewer:"></a><a name="TestNG-versions-5.14-or-newer:"></a><h4 id="RunningRiskGroupTestsFirst-TestNGversions5.14ornewer:">TestNG versions 5.14 or newer:</h4><ol class="list _decimal"><li class="list__item" id="0c773dd3"><p>TeamCity provides tests that should be run first (test classes).</p></li><li class="list__item" id="c4f7785d"><p>When a TestNG starts, TeamCity injects custom listener which will reorder tests if needed.</p></li><li class="list__item" id="ba9c56c2"><p>Before starting tests TestNG asks listener to reorder tests execution order list. If some test requires reordering, TeamCity listener moves it to to the start of the list.</p></li><li class="list__item" id="bcf927fe"><p>After that TestNG runs tests in new order.</p></li></ol><aside class="note " data-title="" rel="bdaa3fc1" id="fd50b01a"><p id="cfb51ed1">Some cases when automatic tests reordering will not work:</p><ul class="list _ul"><li class="list__item" id="fe83dcce"><p>if &lt;test/&gt; or &lt;suite/&gt; element in the TestNG XML suite has the <code class="code">preserve-order</code> attribute set to <code class="code">true</code></p></li><li class="list__item" id="42580b04"><p>if TestNG suite file in YAML format</p></li></ul></aside><p id="1d504032"><a name="testReorderingForNUnit"></a><a name="RunningRiskGroupTestsFirst-testReorderingForNUnit"></a></p></div><a name="ReorderingRiskTestsforNUnit"></a><a name="Reordering-Risk-Tests-for-NUnit"></a><div class="chapter"><h2 id="RunningRiskGroupTestsFirst-ReorderingRiskTestsforNUnit">Reordering Risk Tests for NUnit</h2><p id="f0aaf813">Supported build runners:</p><ul class="list _ul"><li class="list__item" id="88580a6a"><p><a href="nant.html">NAnt</a>, <a href="msbuild.html">MSBuild</a>, <a href="nunit.html">NUnit</a>, <a href="visual-studio-2003.html">Visual Studio 2003</a> build runners</p></li><li class="list__item" id="6ea50870"><p>NUnit testing framework</p></li></ul><p id="93d0f569">Tests reordering only supports reordering of recently failed tests.</p><aside class="note " data-title="" rel="93d0f569" id="e68ed68b"><ul class="list _ul"><li class="list__item" id="fe70410f"><p>When the "Run recently failed tests first" option is selected, the <a href="https://github.com/nunit/docs/wiki/Explicit-Attribute" data-external="true" target="_blank" rel="noopener noreferrer">Explicit</a> attribute <b id="961c1574">will not work</b>.</p></li><li class="list__item" id="2d9e4dce"><p>Test reordering is <b id="ac9c62bc">not supported for parametrized NUnit tests.</b></p></li></ul></aside><p id="e58e4b49">If risk tests reordering option is enabled, the feature for NUnit test runner works in the following way:</p><ol class="list _decimal"><li class="list__item" id="22f53bb3"><p>NUnit runs tests from the "risk" group using test name filter.</p></li><li class="list__item" id="da38d758"><p>NUnit runs all other tests using inverse filter.</p></li></ol><aside class="note " data-title="" rel="a9eafe5a" id="f3dfa2e3"><ul class="list _ul"><li class="list__item" id="236b8f2e"><p>Since tests run twice, thus risk test fixtures <i id="0888a106">Set Up</i> and <i id="95a9f40e">Tear Down</i> will be performed twice.</p></li><li class="list__item" id="2a119082"><p>Tests reordering feature applies to an NUnit task. That is, for NAnt and MSBuild runners, tests reordering feature will be initiated as many times as many NUnit tasks you have in your build script.</p></li></ul></aside><hr id="4a0e6908"><p id="b0b007a0"><b id="30676dfd">See also:</b></p><p id="02716460"><b id="133b6b14">Concepts</b>: <a href="build-runner.html">Build Runner</a><br><b id="3caf70d3">Developing TeamCity Plugins</b>: <a href="https://plugins.jetbrains.com/docs/teamcity/risk-tests-reordering-in-custom-test-runner.html" data-external="true" target="_blank" rel="noopener noreferrer">Risk Tests Reordering in Custom Test Runner</a></p><hr id="9ed9975c"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>