<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>先运行风险组测试-帮助|帮助团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Running Risk Group Tests First" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-unit-testing-and-code-coverage.md|Configuring Unit Testing and Code Coverage/running-risk-group-tests-first.md|Running Risk Group Tests First" data-main-title="Running Risk Group Tests First" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/running-risk-group-tests-first.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="running-risk-group-tests-first.md" data-toc="Running Risk Group Tests First">先运行风险组测试</h1><p id="cb307aeb">在此页：</p><p id="92f92bae"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#RunningRiskGroupTestsFirst-ReorderingRiskTestsforJUnitandTestNG">重新排序JUnit和TestNG的风险测试</a></li><li class="list__item"><a href="#RunningRiskGroupTestsFirst-ReorderingRiskTestsforNUnit">重新排序NUnit的风险测试</a></li></ul><p></p><p id="db461de7"><a name="testReorderingJUnitAndTestNG"></a><a name="RunningRiskGroupTestsFirst-testReorderingJUnitAndTestNG"></a></p><a name="ReorderingRiskTestsforJUnitandTestNG"></a><a name="Reordering-Risk-Tests-for-JUnit-and-TestNG"></a><div class="chapter"><h2 id="RunningRiskGroupTestsFirst-ReorderingRiskTestsforJUnitandTestNG">重新排序JUnit和TestNG的风险测试</h2><p id="68cee6d5">支持的环境：</p><ul class="list _ul"><li class="list__item" id="3c718bfc"><p><a href="ant.html">Ant</a>和<a href="intellij-idea-project.html">IntelliJ IDEA项目</a>亚军</p></li><li class="list__item" id="9805f239"><p>使用常规JUnit或TestNG任务启动测试时的JUnit和TestNG框架</p></li></ul><aside class="tip sideblock" rel="b7094dee" id="966ebd1b" data-title=""><p id="283e9dbf">TeamCity还允许<a href="https://plugins.jetbrains.com/docs/teamcity/risk-tests-reordering-in-custom-test-runner.html" rel="noopener noreferrer" data-external="true" target="_blank">为自定义构建运行</a>器<a href="https://plugins.jetbrains.com/docs/teamcity/risk-tests-reordering-in-custom-test-runner.html" rel="noopener noreferrer" data-external="true" target="_blank">实现测试重新排序功能</a> 。</p></aside><p id="93498152">您可以指示TeamCity先进行一些测试。您可以在构建运行器设置页面上执行此操作。当前，TeamCity可以首先运行两组测试：</p><ul class="list _ul"><li class="list__item" id="09cb9b02"><p>最近失败的测试，即在先前完成或运行的构建中失败的测试以及失败率高的测试（所谓的闪烁测试）</p></li><li class="list__item" id="0507c5f0"><p>新的和修改的测试，即在正在运行的版本中包含的变更列表中添加或修改的测试</p></li></ul><aside class="note " rel="27c30576" id="01d9f8d6" data-title=""><p id="5ba8fc6b">在您的<a href="personal-build.html">个人版本中</a>最近添加或修改的测试具有最高优先级，并且这些测试甚至可以在任何其他重新排序的测试之前运行。</p></aside><p id="74bbb54f">TeamCity允许您同时启用这两个组或分别启用每个组。</p><p id="2a804c14">TeamCity基于测试用例进行操作，即不是对单个测试进行重新排序，而是对整个测试用例进行排序。仅在单个测试执行Ant任务中对测试用例进行重新排序，因此，要最大化功能效果，请在每个构建中使用单个测试执行任务。</p><p id="6e28f825">测试重新排序的工作方式如下：</p><a name="JUint"></a><a name="JUint"></a><h4 id="RunningRiskGroupTestsFirst-JUint">君特</h4><ol class="list _decimal"><li class="list__item" id="5e87b4c3"><p>TeamCity提供应首先运行的测试（测试类）。</p></li><li class="list__item" id="506a5ea9"><p>当JUnit任务启动时，TeamCity将检查它是否包括这些测试。</p></li><li class="list__item" id="36bb695e"><p>如果至少包含一个测试，TeamCity将生成一个仅包含所包含测试的新文件集，并在所有其他文件集之前对其进行处理。它还修补其他文件集，以排除添加到自动生成的文件集的测试。</p></li><li class="list__item" id="92290f76"><p>之后，JUnit将启动并照常运行。</p></li></ol><aside class="note " rel="95718332" id="9025a8ee" data-title=""><p id="29b4090f">自动测试重新排序的某些情况不起作用：</p><ul class="list _ul"><li class="list__item" id="413fe783"><p>如果JUnit套件是通过suite（）方法在测试用例中手动创建的</p></li><li class="list__item" id="ef0e4ea5"><p>如果在JUnit4测试中使用@RunWith批注</p></li></ul></aside><a name="TestNG"></a><a name="TestNG"></a><h4 id="RunningRiskGroupTestsFirst-TestNG">测试NG</h4><a name="TestNGversionslessthan5.14:"></a><a name="TestNG-versions-less-than-5.14:"></a><h4 id="RunningRiskGroupTestsFirst-TestNGversionslessthan5.14:">低于5.14的TestNG版本：</h4><ol class="list _decimal"><li class="list__item" id="27bb4b4b"><p>TeamCity提供应首先运行的测试（测试类）。</p></li><li class="list__item" id="2ff02c31"><p>当TestNG任务启动时，TeamCity检查它是否包括这些测试。</p></li><li class="list__item" id="553027b3"><p>如果至少包含一个测试，TeamCity将生成一个新的xml文件，其中包含仅包含所包含测试的套件，并在处理所有其他文件之前对其进行处理。它还修补其他文件，以排除添加到自动生成的文件中的测试。</p></li><li class="list__item" id="2543f9da"><p>之后，TestNG启动并照常运行。</p></li></ol><aside class="note " rel="4c2e7579" id="377d462e" data-title=""><p id="cd647cff">在某些情况下，自动测试重新排序将不起作用<package></package>元素用于TestNG XML套件中。</p></aside><a name="TestNGversions5.14ornewer:"></a><a name="TestNG-versions-5.14-or-newer:"></a><h4 id="RunningRiskGroupTestsFirst-TestNGversions5.14ornewer:">TestNG 5.14或更高版本：</h4><ol class="list _decimal"><li class="list__item" id="0c773dd3"><p>TeamCity提供应首先运行的测试（测试类）。</p></li><li class="list__item" id="c4f7785d"><p>当TestNG启动时，TeamCity将注入自定义侦听器，如果需要，它将对测试进行重新排序。</p></li><li class="list__item" id="ba9c56c2"><p>在开始测试之前，TestNG要求侦听器对测试执行顺序列表进行重新排序。如果某些测试需要重新排序，TeamCity侦听器会将其移至列表的开头。</p></li><li class="list__item" id="bcf927fe"><p>之后，TestNG以新的顺序运行测试。</p></li></ol><aside class="note " rel="bdaa3fc1" id="fd50b01a" data-title=""><p id="cfb51ed1">自动测试重新排序的某些情况不起作用：</p><ul class="list _ul"><li class="list__item" id="fe83dcce"><p>如果<test></test>要么<suite></suite> TestNG XML套件中的元素具有<code class="code">preserve-order</code>属性设置为<code class="code">true</code></p></li><li class="list__item" id="42580b04"><p>如果TestNG套件文件为YAML格式</p></li></ul></aside><p id="1d504032"><a name="testReorderingForNUnit"></a><a name="RunningRiskGroupTestsFirst-testReorderingForNUnit"></a></p></div><a name="ReorderingRiskTestsforNUnit"></a><a name="Reordering-Risk-Tests-for-NUnit"></a><div class="chapter"><h2 id="RunningRiskGroupTestsFirst-ReorderingRiskTestsforNUnit">重新排序NUnit的风险测试</h2><p id="f0aaf813">支持的构建运行器：</p><ul class="list _ul"><li class="list__item" id="88580a6a"><p><a href="nant.html">NAnt</a> ， <a href="msbuild.html">MSBuild</a> ， <a href="nunit.html">NUnit</a> ， <a href="visual-studio-2003.html">Visual Studio 2003</a>构建运行程序</p></li><li class="list__item" id="6ea50870"><p>NUnit测试框架</p></li></ul><p id="93d0f569">测试重新排序仅支持对最近失败的测试进行重新排序。</p><aside class="note " rel="93d0f569" id="e68ed68b" data-title=""><ul class="list _ul"><li class="list__item" id="fe70410f"><p>选择“首先运行最近失败的测试”选项后，“ <a href="https://github.com/nunit/docs/wiki/Explicit-Attribute" rel="noopener noreferrer" data-external="true" target="_blank">显式”</a>属性<b id="961c1574">将不起作用</b> 。</p></li><li class="list__item" id="2d9e4dce"><p><b id="ac9c62bc">参数化的NUnit测试不支持</b>测试重新排序<b id="ac9c62bc">。</b></p></li></ul></aside><p id="e58e4b49">如果启用了风险测试重新排序选项，则NUnit测试运行程序的功能将以下列方式工作：</p><ol class="list _decimal"><li class="list__item" id="22f53bb3"><p>NUnit使用测试名称过滤器运行“风险”组中的测试。</p></li><li class="list__item" id="da38d758"><p>NUnit使用逆滤波器运行所有其他测试。</p></li></ol><aside class="note " rel="a9eafe5a" id="f3dfa2e3" data-title=""><ul class="list _ul"><li class="list__item" id="236b8f2e"><p>由于测试运行两次，因此风险测试装置“ <i id="0888a106">设置”</i>和“ <i id="95a9f40e">拆卸”</i>将执行两次。</p></li><li class="list__item" id="2a119082"><p>测试重新排序功能适用于NUnit任务。也就是说，对于NAnt和MSBuild运行程序，测试重新排序功能的启动次数将与构建脚本中NUnit任务的启动次数相同。</p></li></ul></aside><hr id="4a0e6908"><p id="b0b007a0"><b id="30676dfd">也可以看看：</b></p><p id="02716460"><b id="133b6b14">概念</b> ： <a href="build-runner.html">Build Runner</a><br><b id="3caf70d3">开发TeamCity插件</b> ： <a href="https://plugins.jetbrains.com/docs/teamcity/risk-tests-reordering-in-custom-test-runner.html" rel="noopener noreferrer" data-external="true" target="_blank">自定义测试运行器中的风险测试重新排序</a></p><hr id="9ed9975c"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>