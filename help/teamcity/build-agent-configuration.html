<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Build Agent Configuration - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Build Agent Configuration" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/installation-and-upgrade.md|Installation and Upgrade/installation.md|Installation/setting-up-and-running-additional-build-agents.md|Setting up and Running Additional Build Agents/build-agent-configuration.md|Build Agent Configuration" data-main-title="Build Agent Configuration" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/build-agent-configuration.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Build Agent Configuration" id="build-agent-configuration.md">Build Agent Configuration</h1><p id="93d7adbd">On this page:</p><p id="ba2c8caf"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#BuildAgentConfiguration-GeneralAgentConfiguration">General Agent Configuration</a></li><li class="list__item"><a href="#BuildAgentConfiguration-OptionalProperties">Optional Properties</a></li><li class="list__item"><a href="#BuildAgentConfiguration-SetupAgentbehindProxy">Set up Agent behind Proxy</a></li></ul></p><p id="adde4551">Configuration settings of the build agent are stored in the <code class="code">&lt;TeamCity Agent Home&gt;/conf/buildagent.properties</code> file.</p><a name="GeneralAgentConfiguration"></a><a name="General-Agent-Configuration"></a><div class="chapter"><h2 id="BuildAgentConfiguration-GeneralAgentConfiguration">General Agent Configuration</h2><p id="4fe4773d">The configuration file can store properties that will be published on the server as <b id="c20dfaf8">Agent properties</b> and can participate in the <a href="agent-requirements.html">Agent Requirements</a> expressions. All <a href="predefined-build-parameters.html#Agent-Properties">system and environment properties</a> defined in the file will be passed to every build run on the agent.</p><p id="308a54dc">The file is a <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/util/Properties.html#load(java.io.InputStream)" data-external="true" target="_blank" rel="noopener noreferrer">Java properties</a> file.</p><p id="05b619cf">A quick guide is:</p><ul class="list _ul"><li class="list__item" id="345cfc83"><p>use <code class="code">property_name=value&lt;newline&gt;</code> syntax</p></li><li class="list__item" id="7fbcfb32"><p>use <code class="code">#</code> in the first position of the line for a comment</p></li><li class="list__item" id="5f5134b3"><p>use <code class="code">/</code> instead of <code class="code">\</code> as the path separator. If you need to include <code class="code">\</code>, escape it with another <code class="code">\</code>.</p></li><li class="list__item" id="01831743"><p>whitespaces within a line matter</p></li></ul><p id="f5c85bb5">Example of the file:</p><div class="code-block" data-lang="bash">## The address of the TeamCity server. The same as is used to open the TeamCity web interface in the browser.
## Note that usage of https:// is recommended
serverUrl=http://localhost:8111/

## The unique name of the agent used to identify this agent on the TeamCity server
## Use blank name to let server generate it.
## By default, this name would be created from the build agent's host name
name=Default agent

## Container directory to create default checkout directories for the build configurations.
workDir=../work

## Container directory for the temporary directories.
## Please note that the directory may be cleaned between the builds.
tempDir=../temp
 
## Container directory for agent state files and caches.
## TeamCity agent assumes ownership of the directory and can delete the content inside.
systemDir=../system

 
######################################
#   Optional Agent Properties        #
######################################
## A token which is used to identify this agent on the TeamCity server for agent authorization purposes.
## It is automatically generated and saved back on the first agent connection to the server.
authorizationToken=1234567890abcdefghijklml

</div><aside class="note " data-title="" rel="48f9957d" id="8efd1791"><p id="6acfb4dc">Make sure that the file is writable for the build agent process itself. For example, the file is updated to store its authorization token that is generated on the server-side.</p></aside><p id="71a1ba78">If the <code class="code">name</code> property is not specified, the server will generate a build agent name automatically. By default, this name will be created from the build agent's host name.</p><p id="cf91695d">The file can be edited while the agent is running: the agent detects the change and (upon finishing a running build, if any) restarts automatically  loading the new settings.</p></div><a name="OptionalProperties"></a><a name="Optional-Properties"></a><div class="chapter"><h2 id="BuildAgentConfiguration-OptionalProperties">Optional Properties</h2><p id="60b6d2f6">If the default polling protocol is changed in favor of legacy <a href="setting-up-and-running-additional-build-agents.html#Bidirectional-Communication">bidirectional communication</a> between the server and the agent, the server must be able to open HTTP connections to the agent.</p><p id="01cdb092">The port where the TeamCity build agent starts and where it listens for the incoming data from the server is determined via the <code class="code">ownPort</code> property (9090 by default). If the firewall is configured, make sure that the incoming connections for this port are allowed on the agent computer.</p><div class="code-block" data-lang="bash">ownPort=9090

</div><aside class="tip sideblock" data-title="" rel="c9e6fa38" id="205bbce3"><p id="e4fdeb61">If more than one build agent is hosted on the same machine, different ports must be assigned to them via the <code class="code">ownPort</code> property in the <code class="code">buildAgent.properties</code> file of every agent.</p></aside><p id="6e0c42d7">The IP address used by TeamCity server to connect to the build agent is automatically detected by the server when the agent first connects to TeamCity, unless the ownAddress property is defined. If the machine has several network interfaces, automatic detection may fail and it is recommended to specify the <code class="code">ownAddress</code> property:</p><div class="code-block" data-lang="bash">ownAddress=&lt;own IP address or server-accessible domain name&gt;

</div></div><a name="SetupAgentbehindProxy"></a><a name="Set-up-Agent-behind-Proxy"></a><div class="chapter"><h2 id="BuildAgentConfiguration-SetupAgentbehindProxy">Set up Agent behind Proxy</h2><p id="b507d953">Since TeamCity 2017.1 it is possible to configure a forward proxy server for agent-to-server connections.</p><a name="agent-proxy-server"></a><p id="b553513f">On the TeamCity agent side, specify the proxy to connect to TeamCity server using the following properties in the <a href=""><code class="code">buildAgent.properties</code></a> file:</p><div class="code-block" data-lang="bash">
## The domain name or the IP address of the proxy host and the port
teamcity.http.proxyHost=123.45.678.9
teamcity.http.proxyPort=8080
&nbsp;
## If the proxy requires authentication, specify the login and password
teamcity.http.proxyLogin=login
teamcity.http.proxyPassword=password

</div><p id="a47017e6">Note that the proxy has to be configured not to cache any TeamCity server responses; for example, if you use Squid, add "cache deny all" line to the <code class="code">squid.conf</code> file.</p><hr id="4dd95b1d"><p id="29fac2c6"><b id="ca428656">See also:</b></p><p id="2656be20"><b id="0559e714">Concepts</b>: <a href="build-agent.html">Build Agent</a><br><b id="5be06e1c">Administrator's Guide</b>: <a href="predefined-build-parameters.html">Predefined Build Parameters</a> | <a href="configuring-agent-requirements.html">Configuring Agent Requirements</a> | <a href="configuring-build-parameters.html">Configuring Build Parameters</a></p><hr id="0072f35b"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>