<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>VCS Checkout模式-帮助|帮助团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="VCS Checkout Mode" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/configuring-vcs-settings.md|Configuring VCS Settings/vcs-checkout-mode.md|VCS Checkout Mode" data-main-title="VCS Checkout Mode" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/vcs-checkout-mode.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="vcs-checkout-mode.md" data-toc="VCS Checkout Mode">VCS Checkout模式</h1><p id="e8b27768">构建配置的“ <b id="6484bc76">版本控制设置”</b>页面允许配置如何从VCS检索项目源代码：您可以<a href="configuring-vcs-settings.html#Configuring-Checkout-Options-for-Build-Configuration">附加VCS根目录</a>并配置签出选项。</p><p id="1f60d46d"><i id="5e193631">VCS Checkout模式</i>是一种会影响项目源到达代理的<i id="5e193631">方式</i>的设置。此模式仅影响源签出。当前的修订和更改数据检索逻辑由TeamCity服务器执行，因此TeamCity服务器需要以任何方式访问VCS服务器。</p><p id="f953cbca">根据所使用的版本控制，代理可以要求安装命令行客户端，并且在<code class="code">PATH</code>代理（例如，Perforce，Git，Mercurial）上。</p><p id="0b9a3281">检出模式是在构建配置的“ <b id="f60e103e">版本控制设置”</b>页面上的“ <b id="129eb21c">检出设置”</b>部分（高级设置）中配置的。</p><p id="84a365c4">TeamCity具有以下VCS检出模式：</p><div class="table-wrapper"><table width="100%" id="d2997e8a"><thead><tr id="048dbaf6" class="ijRowHead"><th id="b838e658"><p id="ee8b5e7e">结帐模式</p></th><th id="11ef7ae0"><p id="f10f201b">描述</p></th></tr></thead><tbody><tr id="0a9566d2" class="ijRowOdd"><td id="76ee01bb"><a name="prefer-agent-checkout"></a><a name="VCSCheckoutMode-prefer-agent-checkout"></a><p id="6c539adb">首选在代理上签出文件</p></td><td id="f69612c6"><p id="5838f88c">这是新创建的构建配置的默认设置。升级时，将保留现有构建配置的签出模式设置。</p><p id="746c2f31">启用此设置后，如有可能，TeamCity将使用代理端检出（请参见下面的<i id="2b973a24">“始终在代理上检出文件”</i>模式）。如果无法进行代理端检出，TeamCity将显示相应的<a href="server-health.html">运行状况报告项</a> ，并将使用服务器端检出（请参阅下面的<i id="b1b7f294">“始终在服务器上检出文件”</i>模式）。</p><p id="745c4ab1">在以下情况下，TeamCity会退回到服务器端检出：</p><ul class="list _ul"><li class="list__item" id="fc65fb58"><p>在代理上找不到Git或Mercurial客户端</p></li><li class="list__item" id="4c38945d"><p>Git或Mercurial客户端存在于代理上，但是版本错误</p></li><li class="list__item" id="139ce566"><p>代理无权访问存储库</p></li><li class="list__item" id="5792a27a"><p>如果无法使用与执行实际检出时相同的规则在代理上找到Perforce客户端，或者是否使用了流仓库并且检出规则很复杂（不是=> A）</p></li></ul></td></tr><tr id="f6518818" class="ijRowEven"><td id="37efacda"><a name="server-checkout"></a><a name="VCSCheckoutMode-server-checkout"></a><p id="cae116d3">总是检出服务器上的文件</p></td><td id="ca02ce3b"><p id="c53aee90">在每次构建之前，TeamCity服务器将<a href="build-checkout-directory.html">导出源</a>并将其传递给代理。由于源是导出的而不是检出的，因此没有管理数据存储在代理的文件系统中，并且无法从代理执行版本控制操作（如签入，标记或更新）。TeamCity通过<a href="clean-checkout.html#Enforcing-Clean-Checkout">缓存源</a>并仅从VCS服务器检索必要的更改来优化与VCS服务器的通信。除非执行<a href="clean-checkout.html">干净签出</a> ，否则服务器会将增量补丁发送给代理，以仅更新自给定签出目录中代理上次构建以来更改的文件。</p><aside class="note " rel="c53aee90" id="b9bdd4fc" data-title=""><ul class="list _ul"><li class="list__item" id="a5a56643"><p>服务器端检出简化了管理开销。使用此签出模式，您仅需要在服务器上安装VCS客户端软件（适用于Perforce，Mercurial，TFS，Clearcase，VSS）。也可以仅对服务器打开对VCS储存库的网络访问。因此，如果您想控制谁可以访问源存储库，则服务器端检出通常更为有效。</p></li><li class="list__item" id="b212c53d"><p>在一些情况下，这结帐模式可以降低负载上VCS库产生的，特别是如果<a href="clean-checkout.html">清洁结帐</a>通常执行，由于清洁贴片由服务器缓存。</p></li><li class="list__item" id="bac7ad87"><p>请注意，在服务器检出模式下，管理目录（例如<code class="code">.svn</code> ， <code class="code">CVS</code> ）不在代理上创建。</p></li></ul></aside></td></tr><tr id="cceda4ec" class="ijRowOdd"><td id="0e5679d7"><a name="agent-checkout"></a><a name="VCSCheckoutMode-agent-checkout"></a><p id="490fdb62">始终在代理上签出文件</p></td><td id="96f45225"><p id="5f84529f">构建代理将在构建之前<a href="build-checkout-directory.html">签出源</a> 。代理方结帐释放了更多服务器资源，并提供了访问特定于版本控制的目录的能力（ <code class="code">.svn</code> ， <code class="code">CVS</code> ， <code class="code">.git</code> ）;也就是说，构建脚本可以执行VCS操作（例如，签入版本控制）–在这种情况下，请确保构建脚本使用签入所需的凭据。</p><p id="cb46f460">必须在代理上安装VCS客户端软件（适用于Perforce，Mercurial，Git）。</p><aside class="note " rel="cb46f460" id="a182d80d" data-title=""><ul class="list _ul"><li class="list__item" id="66504066"><p>代理结帐通常在数据传输和VCS服务器通信方面更为有效。代理方结帐会创建必要的管理目录（例如<code class="code">.svn</code> ， <code class="code">CVS</code> ），从而使您可以从内部版本与存储库进行通信（例如，提交更改）。</p></li><li class="list__item" id="15ff8e2c"><p>必须使用代理端检出在每台计算机上配置特定于计算机的设置（例如配置SSL通信）。</p></li><li class="list__item" id="432d1ba4"><p>在大多数情况下，“排除” <a href="vcs-checkout-rules.html">VCS Checkout规则</a>不能提高代理的签出性能，因为代理签出了构建中包含的整个顶级目录，然后删除了被排除的文件。Perforce和Azure DevOps Server（以前称为TFS）是该规则的例外，因为在执行签出之前，将基于签出规则创建特定的客户端映射（Perforce）/工作区（TFS）。由于这些DVCS限制，在代理上使用签出时，Git和Mercurial不支持“排除”签出规则。<br>CVS VCS根目录存在一个<a href="https://youtrack.jetbrains.com/issue/TW-43648" rel="noopener noreferrer" data-external="true" target="_blank">已知问题</a> ，在代理上使用检出时会忽略排除检出规则。</p></li><li class="list__item" id="3cc9dc81"><p>使用代理程序侧签出时，与某些版本控件的集成可以提供其他选项。例如， <a href="subversion.html#Checkout-on-agent-settings">Subversion</a> 。</p></li></ul></aside></td></tr><tr id="2e3084c6" class="ijRowEven"><td id="10cf8df8"><a name="do-not-checkout-files-automatically"></a><a name="VCSCheckoutMode-do-not-checkout-files-automatically"></a><p id="1e07ac33">不自动检出文件</p></td><td id="c3234218"><p id="a78f16ea">TeamCity不会自动<a href="build-checkout-directory.html#Custom-checkout-directory">检出任何源，</a>仍将创建<a href="build-checkout-directory.html#Custom-checkout-directory">默认的构建检出目录，</a>以便您可以使用它通过构建脚本检出源。请注意，只有在对由<a href="predefined-build-parameters.html#Server-Build-Properties"><code class="code">build.vcs.number.*</code></a>属性传递到构建中。</p><p id="eb067de3">除非<a href="build-checkout-directory.html#Automatic-Checkout-Directory-Cleaning">配置</a>了目录有效期限，否则<b id="d31eac74">不会</b>自动清除构建签出目录。</p></td></tr></tbody></table></div><hr id="b9cf8b0f"><p id="fe0a5abe"><b id="f08cf5db">也可以看看：</b></p><p id="4c6425ce"><b id="ad4bc21a">管理员指南</b> ： <a href="vcs-checkout-rules.html">VCS签出规则</a></p><hr id="2a8da688"></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>