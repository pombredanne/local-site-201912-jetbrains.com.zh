<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>VCS Checkout Mode - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="VCS Checkout Mode" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/configuring-vcs-settings.md|Configuring VCS Settings/vcs-checkout-mode.md|VCS Checkout Mode" data-main-title="VCS Checkout Mode" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/vcs-checkout-mode.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="VCS Checkout Mode" id="vcs-checkout-mode.md">VCS Checkout Mode</h1><p id="e8b27768">The <b id="6484bc76">Version Control Settings</b> page of a build configuration allows configuring how project source code is retrieved from VCS: you can <a href="configuring-vcs-settings.html#Configuring-Checkout-Options-for-Build-Configuration">attach a VCS Root</a> and configure checkout options.</p><p id="1f60d46d">The <i id="5e193631">VCS Checkout mode</i> is a setting that affects how project sources reach an agent. This mode affects only sources checkout. The current revision and changes data retrieving logic is executed by the TeamCity server, and thus TeamCity server needs to access the VCS server in any mode.</p><p id="f953cbca">Depending on the version control used, agents can require command line clients installed and available in <code class="code">PATH</code> on the agents (for example, Perforce, Git, Mercurial).</p><p id="0b9a3281">The checkout mode is configured on the build configuration's <b id="f60e103e">Version Control Settings</b> page, in the <b id="129eb21c">Checkout Settings</b> section (advanced settings).</p><p id="84a365c4">TeamCity has the following VCS checkout modes:</p><div class="table-wrapper"><table width="100%" id="d2997e8a"><thead><tr id="048dbaf6" class="ijRowHead"><th id="b838e658"><p id="ee8b5e7e">Checkout mode</p></th><th id="11ef7ae0"><p id="f10f201b">Description</p></th></tr></thead><tbody><tr id="0a9566d2" class="ijRowOdd"><td id="76ee01bb"><a name="prefer-agent-checkout"></a><a name="VCSCheckoutMode-prefer-agent-checkout"></a><p id="6c539adb">Prefer to checkout files on agent</p></td><td id="f69612c6"><p id="5838f88c">This is the default setting for the newly created build configurations. When upgrading, the checkout mode settings for existing build configurations are preserved.</p><p id="746c2f31">With this setting enabled, TeamCity will use the agent-side checkout (see the <i id="2b973a24">"Always checkout files on agent"</i> mode below) if possible. If the agent-side checkout is not possible, TeamCity will display a corresponding <a href="server-health.html">health report item</a> and will use the server-side checkout (see the <i id="b1b7f294">"Always checkout files on server"</i> mode below).</p><p id="745c4ab1">TeamCity falls back to the server-side checkout in the following cases:</p><ul class="list _ul"><li class="list__item" id="fc65fb58"><p>No Git or Mercurial client is found on the agent</p></li><li class="list__item" id="4c38945d"><p>The Git or Mercurial client is present on the agent, but is of the wrong version</p></li><li class="list__item" id="139ce566"><p>The agent has no access to the repository</p></li><li class="list__item" id="5792a27a"><p>If a Perforce client cannot be found on the agent using the same rules as while performing actual checkout or if stream depot is used and the checkout rules are complex (other than. =&gt; A )</p></li></ul></td></tr><tr id="f6518818" class="ijRowEven"><td id="37efacda"><a name="server-checkout"></a><a name="VCSCheckoutMode-server-checkout"></a><p id="cae116d3">Always checkout files on server</p></td><td id="ca02ce3b"><p id="c53aee90">The TeamCity server will <a href="build-checkout-directory.html">export the sources</a> and pass them to an agent before each build. Since the sources are exported rather than checked out, no administrative data is stored in the agent's file system and version control operations (like check-in, label or update) cannot be performed from the agent. TeamCity optimizes communications with the VCS servers by <a href="clean-checkout.html#Enforcing-Clean-Checkout">caching the sources</a> and retrieving from the VCS server only the necessary changes. Unless <a href="clean-checkout.html">clean checkout</a> is performed, the server sends to the agent incremental patches to update only the files changed since the last build on the agent in the given checkout directory.</p><aside class="note " data-title="" rel="c53aee90" id="b9bdd4fc"><ul class="list _ul"><li class="list__item" id="a5a56643"><p>The server side checkout simplifies administration overhead. Using this checkout mode, you need to install VCS client software on the server only (applicable to Perforce, Mercurial, TFS, Clearcase, VSS). Network access to VCS repository can also be opened to the server only. Thus, if you want to control who has access to the source repositories, the server side checkout is usually more effective.</p></li><li class="list__item" id="b212c53d"><p>In some cases this checkout mode can lower the load produced on VCS repositories, especially if <a href="clean-checkout.html">Clean Checkout</a> is performed often, due to the caching of clean patches by the server.</p></li><li class="list__item" id="bac7ad87"><p>Note that in the server checkout mode the administration directories (like <code class="code">.svn</code>, <code class="code">CVS</code>) are not created on the agent.</p></li></ul></aside></td></tr><tr id="cceda4ec" class="ijRowOdd"><td id="0e5679d7"><a name="agent-checkout"></a><a name="VCSCheckoutMode-agent-checkout"></a><p id="490fdb62">Always checkout files on agent</p></td><td id="96f45225"><p id="5f84529f">The build agent will <a href="build-checkout-directory.html">check out the sources</a> before the build. Agent-side checkout frees more server resources and provides the ability to access version control-specific directories (<code class="code">.svn</code>, <code class="code">CVS</code>, <code class="code">.git</code>); that is, the build script can perform VCS operations (for example, check-ins into the version control) â€“ in this case ensure the build script uses credentials necessary for the check-in.</p><p id="cb46f460">VCS client software has to be installed on the agent (applicable to Perforce, Mercurial, Git).</p><aside class="note " data-title="" rel="cb46f460" id="a182d80d"><ul class="list _ul"><li class="list__item" id="66504066"><p>Agent checkout is usually more effective with regard to data transfers and VCS server communications. The agent side checkout creates necessary administration directories (like <code class="code">.svn</code>, <code class="code">CVS</code>), and thus allows you to communicate with the repository from the build (for example, commit changes).</p></li><li class="list__item" id="15ff8e2c"><p>Machine-specific settings (like configuring SSL communications) must be configured on each machine using agent-side checkout.</p></li><li class="list__item" id="432d1ba4"><p>"Exclude" <a href="vcs-checkout-rules.html">VCS Checkout Rules</a> in most cases cannot improve agent checkout performance because an agent checks out the entire top-level directory included into a build, then deletes the files that were excluded. Perforce and Azure DevOps Server (formerly TFS) are exceptions to the rule, because before performing checkout, specific client mapping (Perforce) / workspace (TFS) is created based on checkout rules. "Exclude" checkout rules are not supported for Git and Mercurial when using checkout on an agent due to these DVCS limitations.<br>There is a <a href="https://youtrack.jetbrains.com/issue/TW-43648" data-external="true" target="_blank" rel="noopener noreferrer">known issue</a> with CVS VCS root ignoring exclude checkout rules when using checkout on an agent.</p></li><li class="list__item" id="3cc9dc81"><p>Integration with certain version controls can provide additional options when agent-side checkout is used. For example, <a href="subversion.html#Checkout-on-agent-settings">Subversion</a>.</p></li></ul></aside></td></tr><tr id="2e3084c6" class="ijRowEven"><td id="10cf8df8"><a name="do-not-checkout-files-automatically"></a><a name="VCSCheckoutMode-do-not-checkout-files-automatically"></a><p id="1e07ac33">Do not check out files automatically</p></td><td id="c3234218"><p id="a78f16ea">TeamCity will not check out any sources automatically, the <a href="build-checkout-directory.html#Custom-checkout-directory">default build checkout directory</a> will still be created so that you could use it to check out the sources via a build script. Note that TeamCity will accurately report changes only if the checkout is performed on the revision specified by the <a href="predefined-build-parameters.html#Server-Build-Properties"><code class="code">build.vcs.number.*</code></a> properties passed into the build.</p><p id="eb067de3">The build checkout directory will <b id="d31eac74">not</b> be cleaned automatically, unless the directory expiration period is <a href="build-checkout-directory.html#Automatic-Checkout-Directory-Cleaning">configured</a>.</p></td></tr></tbody></table></div><hr id="b9cf8b0f"><p id="fe0a5abe"><b id="f08cf5db">See also:</b></p><p id="4c6425ce"><b id="ad4bc21a">Administrator's Guide</b>: <a href="vcs-checkout-rules.html">VCS Checkout Rules</a></p><hr id="2a8da688"></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>