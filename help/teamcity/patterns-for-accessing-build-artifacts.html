<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>访问构建工件的模式-帮助|帮助团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Patterns For Accessing Build Artifacts" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/patterns-for-accessing-build-artifacts.md|Patterns For Accessing Build Artifacts" data-main-title="Patterns For Accessing Build Artifacts" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/patterns-for-accessing-build-artifacts.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="patterns-for-accessing-build-artifacts.md" data-toc="Patterns For Accessing Build Artifacts">访问构建工件的模式</h1><aside class="warning " rel="patterns-for-accessing-build-artifacts.md" id="c6e5a4a3" data-title=""><p id="8b435a59">建议使用TeamCity <a href="rest-api.html#Build-Artifacts">REST API</a>从脚本访问工件，因为REST API提供了构建选择工具并允许列出工件。</p></aside><p id="3d25c2fd">保留此部分是为了与早期TeamCity版本<b id="d70ec5ec">向后兼容</b>以及某些特定功能。</p><p id="6b093044">还要检查以下信息：</p><ul class="list _ul"><li class="list__item" id="aa6a93a2"><p>如果您需要访问构建中的工件，请考虑使用TeamCity的内置<a href="dependent-build.html#Artifact-Dependency">工件依赖</a>功能。</p></li><li class="list__item" id="d1a2f49e"><p>您也可以使用<a href="artifact-dependencies.html#Configuring-Artifact-Dependencies-Using-Ant-Build-Script">Ivy</a>依赖管理器从TeamCity下载工件。</p></li><li class="list__item" id="4eefb6b2"><p>对于从TeamCity外部版本下载的工件，请考虑使用<a href="rest-api.html">REST API</a> 。</p></li><li class="list__item" id="a3bffb16"><p>另请参阅有关<a href="accessing-server-by-http.html">通过</a>脚本进行HTTP访问的基本规则的“ <a href="accessing-server-by-http.html">通过HTTP访问服务器”</a> 。</p></li></ul><p id="a4ea1d33"><b id="17f0bdb2">本页内容包括</b> ：</p><p id="21e047b7"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#PatternsForAccessingBuildArtifacts-ObtainingArtifacts">获取工件</a></li><li class="list__item"><a href="#PatternsForAccessingBuildArtifacts-ObtainingArtifactsfromanArchive">从档案中获取工件</a></li><li class="list__item"><a href="#PatternsForAccessingBuildArtifacts-ObtainingArtifactsfromaBuildScript">从构建脚本获取工件</a></li><li class="list__item"><a href="#PatternsForAccessingBuildArtifacts-LinkstotheArtifactsContainingtheTeamCityBuildNumber">链接到包含TeamCity内部版本号的工件</a></li></ul><p></p><a name="ObtainingArtifacts"></a><a name="Obtaining-Artifacts"></a><div class="chapter"><h2 id="PatternsForAccessingBuildArtifacts-ObtainingArtifacts">获取工件</h2><p id="e68bc680"><b id="a5986bea">要下载最新版本（最后完成，成功或固定）的工件</b> ，请使用以下路径：</p><div class="code-block" data-lang="bash">/repository/download/BUILD_TYPE_EXT_ID/.lastFinished/ARTIFACT_PATH /repository/download/BUILD_TYPE_EXT_ID/.lastSuccessful/ARTIFACT_PATH /repository/download/BUILD_TYPE_EXT_ID/.lastPinned/ARTIFACT_PATH</div><p id="3a2add58"><b id="01ebfa7a">要通过<a href="working-with-build-results.html#Internal-Build-ID">构建ID</a>下载工件</b> ，请使用：</p><div class="code-block" data-lang="bash">/ repository / download / BUILD_TYPE_EXT_ID / BUILD_ID：id / ARTIFACT_PATH</div><p id="e8af068c"><b id="1d154728">要按内部版本号下载工件</b> ，请使用：</p><div class="code-block" data-lang="bash">/ repository / download / BUILD_TYPE_EXT_ID / BUILD_NUMBER / ARTIFACT_PATH</div><p id="c04f9185"><b id="bbe1906a">要从具有特定标记的最新版本中下载工件</b> ，请使用：</p><div class="code-block" data-lang="bash">/repository/download/BUILD_TYPE_EXT_ID/BUILD_TAG.tcbuildtag/ARTIFACT_PATH</div><p id="eb007944"><b id="3e051197">要下载.zip存档中的所有工件</b> ，请使用：</p><div class="code-block" data-lang="bash">/ repository / downloadAll / BUILD_TYPE_EXT_ID / BUILD_SPECIFICATION</div><p id="2c6d6d53">哪里</p><ul class="list _ul"><li class="list__item" id="e5add36f"><p><b id="7edc4a0a">BUILD_TYPE_EXT_ID</b>是<a href="configuring-general-settings.html">构建配置ID</a> 。</p></li><li class="list__item" id="94717470"><p><b id="2b5648cb">BUILD_SPECIFICATION</b>可以是<code class="code">.lastFinished</code> ， <code class="code">.lastSuccessful</code>要么<code class="code">.lastPinned</code> ，具体<code class="code">buildNumber</code>或以以下格式生成<a href="working-with-build-results.html#Internal-Build-ID">ID</a> <code class="code">BUILD_ID:id</code> 。</p></li><li class="list__item" id="90c53867"><p><b id="7a6abacb">ARTIFACT_PATH</b>是TeamCity服务器上工件的路径。此路径可以包含一个<code class="code">{build.number}</code>模式（ <code class="code">%7Bbuild.number%7D</code> ），将由TeamCity替换为检索其工件的内部版本号。默认情况下，包含所有工件的归档文件不包含<a href="build-artifact.html#Hidden-Artifacts">隐藏的工件</a> 。要包括它们，请添加“ <code class="code">?showAll=true</code>在相应网址的末尾。要从特定分支的最后完成，最后成功，最后固定或标记的版本中下载工件，请添加“ <code class="code">?branch=<branch_name></code>网址末尾的“”参数。</p></li></ul></div><a name="ObtainingArtifactsfromanArchive"></a><a name="Obtaining-Artifacts-from-an-Archive"></a><div class="chapter"><h2 id="PatternsForAccessingBuildArtifacts-ObtainingArtifactsfromanArchive">从档案中获取工件</h2><p id="e8c740ae">TeamCity允许通过以下URL模式从构建工件目录的存档中获取文件：</p><div class="code-block" data-lang="bash">/ repository / download / BUILD_TYPE_EXT_ID / BUILD_SPECIFICATION / <archive>！/ PATH_WITHIN_ARCHIVE</archive></div><ul class="list _ul"><li class="list__item" id="64a3fb24"><p><b id="ceb4d5eb">BUILD_TYPE_EXT_ID</b>是<a href="configuring-general-settings.html">构建配置ID</a> 。</p></li><li class="list__item" id="407a2c93"><p><b id="4002b0c8">BUILD_SPECIFICATION</b>可以是<code class="code">.lastFinished</code> ， <code class="code">.lastPinned</code> ， <code class="code">.lastSuccessful</code> ，具体<code class="code">buildNumber</code>或以以下格式生成<a href="working-with-build-results.html#Internal-Build-ID">ID</a> <code class="code">BUILD_ID:id</code> 。</p></li><li class="list__item" id="05929ae6"><p><b id="a7634222">PATH_WITHIN_ARCHIVE</b>是TeamCity服务器上zip / 7-zip / jar / tar.gz归档文件中文件的路径。支持以下归档类型（不区分大小写）：</p></li><li class="list__item" id="14d16bc7"><p>。压缩</p></li><li class="list__item" id="fee10388"><p>.7z</p></li><li class="list__item" id="9a7c157e"><p>。罐</p></li><li class="list__item" id="ca20c950"><p>。战争</p></li><li class="list__item" id="78dbe1ee"><p>。耳</p></li><li class="list__item" id="5b9713c6"><p>.nupkg</p></li><li class="list__item" id="1e0e51ef"><p>。坐</p></li><li class="list__item" id="48fc906f"><p>.apk</p></li><li class="list__item" id="1ac56b67"><p>.tar.gz</p></li><li class="list__item" id="1533350b"><p>.tgz</p></li><li class="list__item" id="bbb78922"><p>.tar.gzip</p></li><li class="list__item" id="9f528740"><p>。柏油</p></li></ul></div><a name="ObtainingArtifactsfromaBuildScript"></a><a name="Obtaining-Artifacts-from-a-Build-Script"></a><div class="chapter"><h2 id="PatternsForAccessingBuildArtifacts-ObtainingArtifactsfromaBuildScript">从构建脚本获取工件</h2><p id="48467af8">通常需要使用<b id="7edcdc76">wget之</b>类的工具或其他不支持HTML登录页面的下载器来下载某些构建配置的工件。如果您访问工件存储库，TeamCity要求进行身份验证。</p><p id="cf1cf411"><b id="09a1305b">要使用构建脚本中基于令牌的身份验证正确进行身份验证</b> ，您必须在HTTP标头中传递您的个人<a href="managing-your-user-account.html#Managing-Access-Tokens">访问令牌</a> <code class="code">Authorization: Bearer <token-value></code> 。</p><p id="01a764ce"><b id="d0eb69fa">要使用构建脚本中的基本身份验证正确进行身份验证</b> ，您必须更改网址（添加<code class="code">/httpAuth/</code> URL的前缀）：</p><div class="code-block" data-lang="bash">/ httpAuth /存储库/下载/BUILD_TYPE_EXT_ID/.lastFinished/ARTIFACT_PATH</div><p id="3d048b5e">使用此URL通过URL访问工件需要进行基本身份验证。 <code class="code">/httpAuth/</code>字首。</p><p id="20be13eb">您可以在基本身份验证设置中使用现有的TeamCity用户名和密码，但请考虑使用<code class="code">teamcity.auth.userId</code> / <code class="code">teamcity.auth.password</code>系统属性作为下载工件请求的凭据：这样，TeamCity将有一种方式来记录该构建使用了另一工件的构建，并将其显示在构建的“依赖关系”选项卡上。</p><p id="d2f41d03"><b id="f69767cb">要使用来宾用户登录名下载工件</b> ，可以使用以下两种方法之一：</p><ul class="list _ul"><li class="list__item" id="31ae6976"><p id="90462fcd">使用旧网址而不使用<code class="code">/httpAuth/</code>前缀，但已添加<code class="code">guest=1</code>参数。例如：</p><div class="code-block" data-lang="bash">/repository/download/BUILD_TYPE_EXT_ID/.lastFinished/ARTIFACT_PATH？来宾= 1</div></li><li class="list__item" id="c2623e6f"><p id="a25da6e7">添加<code class="code">/guestAuth</code> URL的前缀，而不是使用<code class="code">guest=1</code>参数。例如：</p><div class="code-block" data-lang="bash">/ guestAuth /存储库/下载/BUILD_TYPE_EXT_ID/.lastFinished/ARTIFACT_PATH</div></li></ul><p id="5b77c08a">在这种情况下，将不会要求您进行身份验证。可以在以下位置找到工件列表<code class="code">/repository/download/BUILD_TYPE_EXT_ID/.lastFinished/teamcity-ivy.xml</code> 。</p></div><a name="LinkstotheArtifactsContainingtheTeamCityBuildNumber"></a><a name="Links-to-the-Artifacts-Containing-the-TeamCity-Build-Number"></a><div class="chapter"><h2 id="PatternsForAccessingBuildArtifacts-LinkstotheArtifactsContainingtheTeamCityBuildNumber">链接到包含TeamCity内部版本号的工件</h2><p id="c16835b3">您可以使用<code class="code">{build.number}</code> （URL中的％7Bbuild.number％7D）作为工件文件名中当前内部版本号的快捷方式。例如：</p><div class="code-block" data-lang="bash">http://teamcity.yourdomain.com/repository/download/MyConfExtId/.lastFinished/TeamCity-%7Bbuild.number%7D.exe</div><hr id="60fd4cb9"><p id="1fccaa2b"><b id="b819cf6c">也可以看看：</b></p><p id="81b1d5e8"><b id="ad36e168">概念</b> ： <a href="build-artifact.html">构建工件</a> | <a href="authentication-modules.html">认证模块</a><br><b id="8d5e4513">管理员指南</b> ： <a href="configuring-dependencies.html">在构建中检索工件</a><br><b id="d3769bf6">扩展TeamCity</b> ： <a href="accessing-server-by-http.html">通过HTTP访问服务器</a></p><hr id="bbff6458"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>