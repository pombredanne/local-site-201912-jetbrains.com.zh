<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>JaCoCo-帮助|团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="JaCoCo" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-unit-testing-and-code-coverage.md|Configuring Unit Testing and Code Coverage/configuring-java-code-coverage.md|Configuring Java Code Coverage/jacoco.md|JaCoCo" data-main-title="JaCoCo" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/jacoco.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="jacoco.md" data-toc="JaCoCo">JaCoCo</h1><p id="7f746542">TeamCity支持<a href="http://www.eclemma.org/jacoco" rel="noopener noreferrer" data-external="true" target="_blank">JaCoCo</a> ，这是一种Java代码覆盖率工具，使您可以测量一系列覆盖率指标和代码复杂性。</p><p id="39036dfc">JaCoCo可用于以下构建工具： <a href="ant.html">Ant</a> ， <a href="intellij-idea-project.html">IntelliJ IDEA Project</a> ， <a href="gradle.html">Gradle</a>和<a href="maven.html">Maven</a> 。</p><p id="3d657460">TeamCity 2019.1提供了三个捆绑版本的JaCoCo：</p><ul class="list _ul"><li class="list__item" id="31d07a58"><p>0.7.5（默认）</p></li><li class="list__item" id="b8d9fdf6"><p>0.8.2</p></li><li class="list__item" id="1f5ad010"><p>0.8.4</p></li></ul><aside class="note " rel="f5dce33e" id="9dd81caf" data-title=""><p id="a60dcf35">为确保正确收集Coverage数据，请确保您的测试在（一个或多个）单独的JVM中运行。</p><ul class="list _ul"><li class="list__item" id="6f63c788"><p>Ant和Intellij Idea项目的运行者：这是<a href="http://testng.org/doc/ant.html" rel="noopener noreferrer" data-external="true" target="_blank">TestNG</a>的默认设置，对于<a href="http://ant.apache.org/manual/Tasks/junit.html" rel="noopener noreferrer" data-external="true" target="_blank">Junit测试任务</a> ，则设置<code class="code">fork=true</code> 。</p></li><li class="list__item" id="250bbc8f"><p>Maven跑步者：套装<code class="code">forkCount</code> <a href="http://maven.apache.org/surefire/maven-surefire-plugin/examples/fork-options-and-parallel-execution.html" rel="noopener noreferrer" data-external="true" target="_blank">高于</a>的值。</p></li><li class="list__item" id="5669d618"><p>GradleRunner：这是<a href="https://gradle.org/docs/current/dsl/org.gradle.api.tasks.testing.Test.html" rel="noopener noreferrer" data-external="true" target="_blank">Gradle测试</a>的默认设置。</p></li></ul></aside><p id="106b489a">在此页：</p><p id="a9fbe8f1"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#JaCoCo-EnablingJaCococoverage">启用JaCoco承保</a></li><li class="list__item"><a href="#JaCoCo-ImportingJaCoCocoveragedatatoTeamCity">将JaCoCo承保范围数据导入TeamCity</a></li></ul><p></p><a name="EnablingJaCococoverage"></a><a name="Enabling-JaCoco-coverage"></a><div class="chapter"><h2 id="JaCoCo-EnablingJaCococoverage">启用JaCoco承保</h2><p id="f4c0c20a">TeamCity支持Java代理覆盖模式，使您无需修改构建脚本或二进制文件即可收集覆盖。无需其他构建步骤-只需在运行测试的构建步骤中选择JaCoCo coverage：</p><ol class="list _decimal"><li class="list__item" id="bf526782"><p>在“ <b id="44e7a7f7">代码覆盖率”</b>部分中，在“ <b id="9ae9a792">选择覆盖率运行器”</b>下拉列表中选择<b id="5054271f">JaCoCo</b>作为覆盖率工具。</p></li><li class="list__item" id="83a9689f"><p>设置覆盖范围选项-请参阅以下可用选项的说明。</p></li></ol><div class="table-wrapper"><table class=" wide" width="100%" id="18e4e9a9"><thead><tr id="c88c0736" class="ijRowHead"><th id="284e0320"><p id="12f75198">选项</p></th><th id="f0636ce4"><p id="7678a7d7">描述</p></th><th id="531d0ad2"><p id="c6936c5a">例</p></th></tr></thead><tbody><tr id="df05c2a2" class="ijRowOdd"><td id="80f452e5"><p id="ff8fcf93"><b id="25789280">类文件目录或jar</b></p></td><td id="7984f40b"><p id="36c4770a">以换行符分隔的一组路径模式，形式为<code class="code">+|-:[path]</code>相对于<a href="build-checkout-directory.html">checkout目录，</a>以扫描要分析的类文件。除非需要覆盖库和测试类文件，否则不必列出它们。</p><a name="OR-syntax-tip"></a><aside class="tip sideblock" rel="a8c4a9db" id="045edc0b" data-title=""><p id="ecbe73f9">在这里， <i id="c4aa0caa" origin="teamcity-help">管道</i>符号<code class="code">|</code>代表<b id="06685278" origin="teamcity-help">OR</b>命令，如正则表达式中一样：use <code class="code">+</code>用于包括， <b id="e4f53a02" origin="teamcity-help">或</b> <code class="code">-</code>排除。</p></aside></td><td id="1ac3a06c"><p id="4b6c0254"><code class="code">+:target/main/java/**</code></p></td></tr><tr id="43a4c3da" class="ijRowEven"><td id="1e67e02b"><p id="424e8d90"><b id="22239b53">仪器分类</b></p></td><td id="fda7e70d"><p id="50802444">用换行符分隔的一组类名模式，形式为<code class="code">+|-:[path]</code> 。允许过滤掉“ <b id="fbb73779">Classfile directorys或jars</b> ”字段中列出的不需要的类。在编译测试类的情况下很有用。</p></td><td id="b808802d"><p id="1bcd8747"><code class="code">+:com.package.core.*</code></p><p id="4680e5c8"><code class="code">-:com.package.*Test*</code></p></td></tr></tbody></table></div><aside class="tip sideblock" rel="18e4e9a9" id="d7856f22" data-title=""><p id="b6c7afa2">默认情况下，在TeamCity中，jacoco.sources属性设置为“。”，这意味着TeamCity将扫描整个checkout目录，包括源的所有子目录。检查您的类文件是否已使用调试信息（包括源文件信息）进行编译，以在报告中以突出显示的源代码查看。</p></aside><p id="1273527b">可以在“构建结果”页面的“ <b id="64b53fd2">概述”</b>选项卡上查看代码覆盖结果；详细的报告显示在专用的<b id="cec288e1">“代码覆盖率”</b>选项卡上。</p></div><a name="ImportingJaCoCocoveragedatatoTeamCity"></a><a name="Importing-JaCoCo-coverage-data-to-TeamCity"></a><div class="chapter"><h2 id="JaCoCo-ImportingJaCoCocoveragedatatoTeamCity">将JaCoCo承保范围数据导入TeamCity</h2><p id="076f6a08">TeamCity可以使用以下格式的<a href="build-script-interaction-with-teamcity.html#Service-Messages">服务消息</a>来解析JaCoCo承保范围数据并生成报告：</p><div class="code-block" data-lang="none">## teamcity [jacocoReport dataPath =' <path to="" jacoco.exec="" file="">']</path></div><div class="table-wrapper"><table class=" wide" width="100%" id="cea34931"><thead><tr id="a236a054" class="ijRowHead"><th id="9c2e4e62"><p id="da904f9f">属性名称</p></th><th id="28ef9e40"><p id="4e4307b7">描述</p></th><th id="1e5c8f52"><p id="b28f7bd5">默认值</p></th><th id="2ca0752f"><p id="01064d65">例</p></th></tr></thead><tbody><tr id="8d8c619d" class="ijRowOdd"><td id="c90ebf94"><p id="dfd6cacd">数据路径</p></td><td id="f3a36517"><p id="eff2972a">相对于checkout目录的空格分隔的一组路径，以读取jacoco数据文件</p></td><td id="a4007b08"></td><td id="4ed4b252"><p id="4c087988"><code class="code">jacocoResults/jacoco.exec jacocoResults/anotherJacocoRun.exec</code></p></td></tr><tr id="1d44d963" class="ijRowEven"><td id="dd9d16fa"><p id="a9060da3">包括</p></td><td id="e7ed6acf"><p id="f039cb09">用空格分隔的一组类名包含模式</p></td><td id="915331b6"><p id="eeaf013e"><code class="code">*</code></p></td><td id="6bda9593"><p id="62e27234"><code class="code">com.package.core.* com.package.api.*</code></p></td></tr><tr id="2955aa48" class="ijRowOdd"><td id="3f08021a"><p id="7a393abf">排除</p></td><td id="f9bc54ed"><p id="980de287">用空格分隔的一组类名排除模式</p></td><td id="e62145cc"></td><td id="9047f0c6"><p id="83df60b2"><code class="code">com.package.test.* .*Test</code></p></td></tr><tr id="8081e0b8" class="ijRowEven"><td id="672b134f"><p id="952ebe35">资料来源</p></td><td id="4514cfd7"><p id="6155fa26">相对于结帐目录的空格分隔的路径集，用于从中读取源。默认情况下不需要列出。</p></td><td id="2c92ba0c"><p id="225509c6"><code class="code">.</code></p></td><td id="3410ae86"><p id="0d43bee6"><code class="code">src</code></p></td></tr><tr id="8c162b08" class="ijRowOdd"><td id="1468d493"><p id="68f283fc">类路径</p></td><td id="1643b74a"><p id="ccd892f6">以空格分隔的一组路径模式，形式为<code class="code">+|-:[path]</code>扫描要分析的类文件。除非需要覆盖库和测试类文件，否则无需列出它们。</p></td><td id="d5750271"><p id="37e85cb9"><code class="code">+:**/*</code></p></td><td id="bb1d9236"><p id="31eebc8b"><code class="code">+:target/main/java/**</code></p></td></tr><tr id="96069d2f" class="ijRowEven"><td id="87120305"><p id="00649fdc">reportDir</p></td><td id="a603e43d"><p id="f49dfc7b">存储临时文件的目录路径。该报告将作为覆盖范围生成<code class="code">.zip</code>在此目录下。检查是否没有相同名称的目录。</p></td><td id="036910d5"><p id="66f18742">代理的临时目录下的随机目录</p></td><td id="9f7b6e08"><p id="b60eae21">jacocoReport</p></td></tr></tbody></table></div><p id="0378c4f7">完整服务消息的示例：</p><div class="code-block" data-lang="none">## teamcity [jacocoReport dataPath ='jacoco.exec'includes ='com.package.core。*'classpath ='classes / lib / some.jar'reportDir ='temp / jacocoReport']</div><hr id="bd7c4204"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>