<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>JaCoCo - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="JaCoCo" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-unit-testing-and-code-coverage.md|Configuring Unit Testing and Code Coverage/configuring-java-code-coverage.md|Configuring Java Code Coverage/jacoco.md|JaCoCo" data-main-title="JaCoCo" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/jacoco.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="JaCoCo" id="jacoco.md">JaCoCo</h1><p id="7f746542">TeamCity supports <a href="http://www.eclemma.org/jacoco" data-external="true" target="_blank" rel="noopener noreferrer">JaCoCo</a>, a Java Code Coverage tool allowing you to measure a wide set of coverage metrics and code complexity.</p><p id="39036dfc">JaCoCo is available for the following build runners: <a href="ant.html">Ant</a>, <a href="intellij-idea-project.html">IntelliJ IDEA Project</a>, <a href="gradle.html">Gradle</a>, and <a href="maven.html">Maven</a>.</p><p id="3d657460">TeamCity 2019.1 offers three bundled versions of JaCoCo:</p><ul class="list _ul"><li class="list__item" id="31d07a58"><p>0.7.5 (default)</p></li><li class="list__item" id="b8d9fdf6"><p>0.8.2</p></li><li class="list__item" id="1f5ad010"><p>0.8.4</p></li></ul><aside class="note " data-title="" rel="f5dce33e" id="9dd81caf"><p id="a60dcf35">To ensure the coverage data is collected properly, make sure your tests run in (one or more) separate JVMs.</p><ul class="list _ul"><li class="list__item" id="6f63c788"><p>Ant and Intellij Idea Project runners: this is the default setting for <a href="http://testng.org/doc/ant.html" data-external="true" target="_blank" rel="noopener noreferrer">TestNG</a>, for <a href="http://ant.apache.org/manual/Tasks/junit.html" data-external="true" target="_blank" rel="noopener noreferrer">Junit test task</a>, set <code class="code">fork=true</code>.</p></li><li class="list__item" id="250bbc8f"><p>Maven runner: set <code class="code">forkCount</code> to a value <a href="http://maven.apache.org/surefire/maven-surefire-plugin/examples/fork-options-and-parallel-execution.html" data-external="true" target="_blank" rel="noopener noreferrer">higher than</a>.</p></li><li class="list__item" id="5669d618"><p>Gradle runner: this is the default setting for <a href="https://gradle.org/docs/current/dsl/org.gradle.api.tasks.testing.Test.html" data-external="true" target="_blank" rel="noopener noreferrer">Gradle tests</a>.</p></li></ul></aside><p id="106b489a">On this page:</p><p id="a9fbe8f1"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#JaCoCo-EnablingJaCococoverage">Enabling JaCoco coverage</a></li><li class="list__item"><a href="#JaCoCo-ImportingJaCoCocoveragedatatoTeamCity">Importing JaCoCo coverage data to TeamCity</a></li></ul></p><a name="EnablingJaCococoverage"></a><a name="Enabling-JaCoco-coverage"></a><div class="chapter"><h2 id="JaCoCo-EnablingJaCococoverage">Enabling JaCoco coverage</h2><p id="f4c0c20a">TeamCity supports the java agent coverage mode allowing you to collect coverage without modifying build scripts or binaries. No additional build steps needed - just choose JaCoCo coverage in a build step which runs tests:</p><ol class="list _decimal"><li class="list__item" id="bf526782"><p>In the <b id="44e7a7f7">Code Coverage</b> section, select <b id="5054271f">JaCoCo</b> as a coverage tool in the <b id="9ae9a792">Choose coverage runner</b> drop-down.</p></li><li class="list__item" id="83a9689f"><p>Set up the coverage options - refer to the description of the available options below.</p></li></ol><div class="table-wrapper"><table class=" wide" width="100%" id="18e4e9a9"><thead><tr id="c88c0736" class="ijRowHead"><th id="284e0320"><p id="12f75198">Option</p></th><th id="f0636ce4"><p id="7678a7d7">Description</p></th><th id="531d0ad2"><p id="c6936c5a">Example</p></th></tr></thead><tbody><tr id="df05c2a2" class="ijRowOdd"><td id="80f452e5"><p id="ff8fcf93"><b id="25789280">Classfile directories or jars</b></p></td><td id="7984f40b"><p id="36c4770a">Newline-delimited set of path patterns in the form of <code class="code">+|-:[path]</code> relative to the <a href="build-checkout-directory.html">checkout directory</a> to scan for classfiles to be analyzed. Libraries and test classfiles don't have to be listed unless their coverage is wanted.</p><a name="OR-syntax-tip"></a><aside class="tip sideblock" data-title="" rel="a8c4a9db" id="045edc0b"><p id="ecbe73f9">Here, the <i origin="teamcity-help" id="c4aa0caa">pipe</i> symbol <code class="code">|</code> represents the <b origin="teamcity-help" id="06685278">OR</b> command, as in regular expressions: use <code class="code">+</code> for including, <b origin="teamcity-help" id="e4f53a02">OR</b> <code class="code">-</code> for excluding.</p></aside></td><td id="1ac3a06c"><p id="4b6c0254"><code class="code">+:target/main/java/**</code></p></td></tr><tr id="43a4c3da" class="ijRowEven"><td id="1e67e02b"><p id="424e8d90"><b id="22239b53">Classes to instrument</b></p></td><td id="fda7e70d"><p id="50802444">Newline-delimited set of classname patterns in the form of <code class="code">+|-:[path]</code>. Allows filtering out unwanted classes listed in "<b id="fbb73779">Classfile directories or jars</b>" field. Useful in case test classes are compiled.</p></td><td id="b808802d"><p id="1bcd8747"><code class="code">+:com.package.core.*</code></p><p id="4680e5c8"><code class="code">-:com.package.*Test*</code></p></td></tr></tbody></table></div><aside class="tip sideblock" data-title="" rel="18e4e9a9" id="d7856f22"><p id="b6c7afa2">By default, in TeamCity the jacoco.sources property is set to ".", which means that TeamCity will scan whole checkout directory including all subdirectories for your sources.Check that your classfiles are compiled with debug information (including the source file info) to see with highlighted source code in the report.</p></aside><p id="1273527b">The code coverage results can be viewed on the <b id="64b53fd2">Overview</b> tab of the Build Results page; detailed report is displayed on the dedicated <b id="cec288e1">Code Coverage</b> tab.</p></div><a name="ImportingJaCoCocoveragedatatoTeamCity"></a><a name="Importing-JaCoCo-coverage-data-to-TeamCity"></a><div class="chapter"><h2 id="JaCoCo-ImportingJaCoCocoveragedatatoTeamCity">Importing JaCoCo coverage data to TeamCity</h2><p id="076f6a08">TeamCity can parse JaCoCo coverage data and generate a report using a <a href="build-script-interaction-with-teamcity.html#Service-Messages">service message</a> of the following format:</p><div class="code-block" data-lang="none">##teamcity[jacocoReport dataPath='&lt;path to jacoco.exec file&gt;']

</div><div class="table-wrapper"><table class=" wide" width="100%" id="cea34931"><thead><tr id="a236a054" class="ijRowHead"><th id="9c2e4e62"><p id="da904f9f">Attribute name</p></th><th id="28ef9e40"><p id="4e4307b7">Description</p></th><th id="1e5c8f52"><p id="b28f7bd5">Default value</p></th><th id="2ca0752f"><p id="01064d65">Example</p></th></tr></thead><tbody><tr id="8d8c619d" class="ijRowOdd"><td id="c90ebf94"><p id="dfd6cacd">dataPath</p></td><td id="f3a36517"><p id="eff2972a">Space-delimited set of paths relative to the checkout directory to read the jacoco data file</p></td><td id="a4007b08"></td><td id="4ed4b252"><p id="4c087988"><code class="code">jacocoResults/jacoco.exec jacocoResults/anotherJacocoRun.exec</code></p></td></tr><tr id="1d44d963" class="ijRowEven"><td id="dd9d16fa"><p id="a9060da3">includes</p></td><td id="e7ed6acf"><p id="f039cb09">Space-delimited set of classname include patterns</p></td><td id="915331b6"><p id="eeaf013e"><code class="code">*</code></p></td><td id="6bda9593"><p id="62e27234"><code class="code">com.package.core.* com.package.api.*</code></p></td></tr><tr id="2955aa48" class="ijRowOdd"><td id="3f08021a"><p id="7a393abf">excludes</p></td><td id="f9bc54ed"><p id="980de287">Space-delimited set of classname exclude patterns</p></td><td id="e62145cc"></td><td id="9047f0c6"><p id="83df60b2"><code class="code">com.package.test.* .*Test</code></p></td></tr><tr id="8081e0b8" class="ijRowEven"><td id="672b134f"><p id="952ebe35">sources</p></td><td id="4514cfd7"><p id="6155fa26">Space-delimited set of paths relative to the checkout directory to read sources from. Does not need to be listed by default.</p></td><td id="2c92ba0c"><p id="225509c6"><code class="code">.</code></p></td><td id="3410ae86"><p id="0d43bee6"><code class="code">src</code></p></td></tr><tr id="8c162b08" class="ijRowOdd"><td id="1468d493"><p id="68f283fc">classpath</p></td><td id="1643b74a"><p id="ccd892f6">Space-delimited set of path patterns in the form of <code class="code">+|-:[path]</code> to scan for classfiles to be analyzed. Libraries and test classfiles do not need to be listed unless their coverage is wanted.</p></td><td id="d5750271"><p id="37e85cb9"><code class="code">+:**/*</code></p></td><td id="bb1d9236"><p id="31eebc8b"><code class="code">+:target/main/java/**</code></p></td></tr><tr id="96069d2f" class="ijRowEven"><td id="87120305"><p id="00649fdc">reportDir</p></td><td id="a603e43d"><p id="f49dfc7b">Path to the directory to store temporary files. The report will be generated as coverage <code class="code">.zip</code> under this directory. Check that there is no existing directory with the same name.</p></td><td id="036910d5"><p id="66f18742">A random directory under Agent's temp directory</p></td><td id="9f7b6e08"><p id="b60eae21">jacocoReport</p></td></tr></tbody></table></div><p id="0378c4f7">An example of a complete service message:</p><div class="code-block" data-lang="none">##teamcity[jacocoReport dataPath='jacoco.exec' includes='com.package.core.*' classpath='classes/lib/some.jar' reportDir='temp/jacocoReport']

</div><hr id="bd7c4204"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>