<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>查看测试和配置问题-帮助|帮助团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Viewing Tests and Configuration Problems" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/user-s-guide.md|User's Guide/viewing-tests-and-configuration-problems.md|Viewing Tests and Configuration Problems" data-main-title="Viewing Tests and Configuration Problems" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/viewing-tests-and-configuration-problems.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="viewing-tests-and-configuration-problems.md" data-toc="Viewing Tests and Configuration Problems">查看测试和配置问题</h1><p id="0c8fedc2">在此页：</p><p id="6f130cb6"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#ViewingTestsandConfigurationProblems-ViewingProblemsonProjectOverviewPage">在项目概述页面上查看问题</a></li><li class="list__item"><a href="#ViewingTestsandConfigurationProblems-UsingCurrentProblemsTab">使用当前问题选项卡</a></li><li class="list__item"><a href="#ViewingTestsandConfigurationProblems-FlakyTests">片状测试</a></li></ul><p></p><a name="ViewingProblemsonProjectOverviewPage"></a><a name="Viewing-Problems-on-Project-Overview-Page"></a><div class="chapter"><h2 id="ViewingTestsandConfigurationProblems-ViewingProblemsonProjectOverviewPage">在项目概述页面上查看问题</h2><p id="2e1e0df5">“ <b id="200493f4">项目概述”</b>页面还显示在构建配置中失败的测试数量以及其他问题。当有问题的构建配置中的数据没有展开时，测试编号下的链接会将您带到“ <b id="60b04d00">当前问题”</b>选项卡（请参阅<a href="#Using-Current-Problems-Tab">下文</a> ）。</p><p id="197a3bca">当您展开构建配置数据时，将出现问题摘要。如果您的浏览器没有足够的水平空间，则会缩短问题的显示时间。</p></div><a name="UsingCurrentProblemsTab"></a><a name="Using-Current-Problems-Tab"></a><div class="chapter"><h2 id="ViewingTestsandConfigurationProblems-UsingCurrentProblemsTab">使用当前问题选项卡</h2><p id="dc4ba13d">要查看项目中有问题的构建配置和测试，请打开“ <b id="ea750cf4">项目主页”</b>页面，然后转到“ <b id="6e572a25">当前问题”</b>选项卡。</p><p id="349ae90f">默认情况下，“ <b id="a2d562ca">当前问题”</b>选项卡显示项目中所有构建配置的数据。要限制显示的数据，请使用“ <i id="52cee785">按构建过滤配置”</i>下拉菜单。</p><p id="0ed3733b">在此页面上，您可以查看项目中的问题，分为以下几组：</p><ul class="list _ul"><li class="list__item" id="3e8ce97f"><p>构建配置问题</p></li><li class="list__item" id="3f6d20d9"><p>测试失败</p></li><li class="list__item" id="18d6c249"><a href="investigating-and-muting-build-failures.html#Muting-Failed-Tests">静音测试失败</a></li><li class="list__item" id="1b7ea417"><p>建立问题</p></li></ul><p id="92abe021">每个部分都是可扩展的，您可以使用向上和向下箭头进一步向下钻取到最小的相关项目<img alt="UpDownArrows。PNG" title="UpDownArrows。PNG" src="/help/img/teamcity/2019.1/UpDownArrows.PNG" id="407ee0a7" width="58" height="21" class="inline-icon-58"> 。</p><p id="e8aa8f77">出现在构建配置问题和构建问题部分中的链接使您可以监视大量有用的数据，例如，您可以导航到构建结果，查看构建日志和更改。单击链接旁边的箭头时，更多选项可用。</p><p id="ba42d258">“失败的测试”和“忽略失败的失败”部分具有分组选项，并允许在单击“测试名称”链接时查看可用的测试堆栈跟踪。您还可以查看测试历史记录，在活动的IDE中打开测试，开始调查特定的测试失败，修复和取消静音测试或开始调查特定的测试失败。</p></div><a name="FlakyTests"></a><a name="Flaky-Tests"></a><div class="chapter"><h2 id="ViewingTestsandConfigurationProblems-FlakyTests">片状测试</h2><p id="4e5bbb08">TeamCity会检测易变的测试，并将其显示在给定项目的专用选项卡上。</p><p id="621c8d00">片状测试是使用相同代码不稳定（可以同时显示通过和失败的结果）的测试。</p><p id="2e249321">片状测试检测基于以下启发式：</p><ol class="list _decimal"><li class="list__item" id="891114c3"><p>高翻转率（频繁的测试状态更改）。TeamCity的变更是测试状态的更改-从“确定”变为“失败”，反之亦然。翻转率是这样的“翻转”与给定测试的调用计数之比，它是针对每个代理，每个构建配置或在特定时间段（默认为7天）中测量的。不断失败的测试虽然失败率为100％，但其翻转率接近于零；每次调用“翻转”的测试的翻转率接近100％。如果翻转率太高，TeamCity将认为测试不稳定。</p></li><li class="list__item" id="0c057eb3"><p>对于具有相同VCS更改的构建配置，不同的测试状态：如果在相同的VCS更改上运行两个具有不同配置的构建，并且这些构建中的测试结果不同，则将测试报告为不稳定。这可能表示环境问题。</p></li><li class="list__item" id="c4ae9cee"><p>如果测试状态在新构建中没有发生任何变化而“翻转”，即，先前成功的测试在未进行更改的构建中失败，或者先前失败的测试在未进行更改的构建中通过，则TeamCity将认为该测试存在问题。</p></li><li class="list__item" id="34e74799"><p>同一构建中多个调用的不同测试状态（不稳定失败）：如果多次调用同一测试并且测试状态发生变化，TeamCity将认为该测试不稳定。<br><a href="http://testng.org/" rel="noopener noreferrer" data-external="true" target="_blank">TestNG</a>单元测试支持此启发式<code class="code">invocationCount</code> [ <a href="http://testng.org/doc/documentation-main.html" rel="noopener noreferrer" data-external="true" target="_blank">1</a> ] [ <a href="http://testng.org/javadocs/org/testng/annotations/Test.html#invocationCount--" rel="noopener noreferrer" data-external="true" target="_blank">2</a> ]大于<code class="code">1</code> 。</p></li></ol><aside class="note " rel="cd2ed83f" id="29a54b11" data-title=""><p id="7632b051">使用TestNG进行参数化测试调用存在一个已知问题：TeamCity依靠Surefire和Failsafe Maven插件来进行测试结果报告，而这些插件会忽略其XML输出中的测试参数。结果，同一构建中的参数化测试调用被错误地视为多个相同的测试调用，并且，如果某些调用失败，则由于“ <i id="b92b3afa">不稳定失败”</i>原因将该测试标记为“ <i id="b92b3afa">不稳定”</i> 。请参阅<a href="https://youtrack.jetbrains.com/issue/TW-48097" rel="noopener noreferrer" data-external="true" target="_blank">相关问题</a> 。</p></aside><p id="82fc54ce">对于<a href="http://junit.org/" rel="noopener noreferrer" data-external="true" target="_blank">http://junit.org/</a>测试，可以将第3方<a href="http://tempusfugitlibrary.org/" rel="noopener noreferrer" data-external="true" target="_blank">tempus-fugit</a>库与<i id="9643aeac">JUnit</i>一起使用。注释一个测试就足够了<code class="code">@Intermittent</code>并使用<code class="code">IntermittentTestRunner</code>测试运行程序，如以下最小示例所示：</p><div class="code-block" data-lang="none">导入org.junit。测试;导入org.junit.runner。RunWith;导入com.google.code.tempusfugit.concurrency。IntermittentTestRunner;导入com.google.code.tempusfugit.concurrency.annotations。间歇性@RunWith（IntermittentTestRunner.class）公共类MultipleViaTempusFugit {@Test @Intermittent（重复= 10）public void test（）{// ...}}</div><p id="27450e3f">如果这样的测试在单个构建中的多次调用中至少剥落一次，则将触发“ <i id="51c61b79">不稳定失败”</i>启发式方法。</p><p id="e4421686">此类测试将显示在专用项目选项卡<b id="f1c7b1f8">Flaky Tests上</b> ，同时还包括测试失败的总数，给定测试的翻转率以及使该测试合格的原因。</p><p id="70ae8828">在构建结果页面上查看失败的测试的扩展堆栈跟踪时，您还可以查看测试是否不稳定。</p><p id="89e01aee"></p><figure><img alt="构建概述中的片状测试" title="构建概述中的片状测试" src="/help/img/teamcity/2019.1/flaky-test.png" id="7d4a8835" width="1311" height="1229"></figure><p></p><p id="8967eba2">与任何失败的测试一样，您可以分配调查以进行片状测试（或多个测试）。对于片状测试，分辨率方法会自动设置为“手动”；否则，一旦测试成功，调查将自动删除，这并不意味着易碎测试已修复。</p><aside class="tip sideblock" rel="8967eba2" id="7c023aa9" data-title=""><p id="241ca19c"><b id="85bafe7b">从TeamCity 2019.1开始</b> ，调查自动分配器可以<a href="investigations-auto-assigner.html#delay-auto-assign">延迟调查的自动分配</a> ，这可以防止在测试不稳定的项目中进行错误的自动分配。</p></aside><p id="641467e4">请注意，如果<a href="working-with-feature-branches.html#Configuring-branches">分支</a>被配置为VCS根，仅针对默认分支检测片状测试。</p><hr id="c80f26cd"><p id="962c8c42"><b id="15340bf9">也可以看看：</b></p><p id="755f8000"><b id="fbdd2e84">概念</b> ： <a href="testing-frameworks.html">测试框架</a><br><b id="154a5b2c">用户指南</b> ： <a href="working-with-build-results.html">处理构建结果</a></p><hr id="bb57b6be"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>