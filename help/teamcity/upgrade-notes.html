<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>升级说明-帮助|团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Upgrade Notes" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/installation-and-upgrade.md|Installation and Upgrade/upgrade-notes.md|Upgrade Notes" data-main-title="Upgrade Notes" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/upgrade-notes.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="upgrade-notes.md" data-toc="Upgrade Notes">升级说明</h1><a name="Changesfrom2019.1.4to2019.1.5"></a><a name="Changes-from-2019.1.4-to-2019.1.5"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2019.1.4to2019.1.5">从2019.1.4到2019.1.5的变化</h2><ul class="list _ul"><li class="list__item" id="5ddcae36"><p>在<a href="https://hub.docker.com/r/jetbrains/teamcity-agent/" rel="noopener noreferrer" data-external="true" target="_blank">TeamCity代理Docker映像中</a> ，Docker已更新至版本19.0.3，而Docker Compose已更新至版本1.24.1。</p></li></ul></div><a name="Changesfrom2019.1.3to2019.1.4"></a><a name="Changes-from-2019.1.3-to-2019.1.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2019.1.3to2019.1.4">从2019.1.3到2019.1.4的更改</h2><ul class="list _ul"><li class="list__item" id="1a29663b"><p>捆绑的Java已更新为OpenJDK 8u222（Docker Windows TeamCity映像除外）。</p></li></ul></div><a name="Changesfrom2019.1.2to2019.1.3"></a><a name="Changes-from-2019.1.2-to-2019.1.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2019.1.2to2019.1.3">从2019.1.2到2019.1.3的更改</h2><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues">已知的问题</h3><ul class="list _ul"><li class="list__item" id="02f2b9f4"><p>使用版本控制的设置时，从VCS导入设置时，构建历史记录可能会丢失。 <a href="https://youtrack.jetbrains.com/issue/TW-62106" rel="noopener noreferrer" data-external="true" target="_blank">细节</a> 。</p></li></ul></div><a name="BundledToolsUpdates"></a><a name="Bundled-Tools-Updates"></a><div class="chapter"><h3 id="UpgradeNotes-BundledToolsUpdates">捆绑工具更新</h3><ul class="list _ul"><li class="list__item" id="20fa7a43"><p>捆绑的ReSharper命令行工具（检查和重复查找器）已升级到版本2019.2.1。</p></li></ul></div></div><a name="Changesfrom2019.1.1to2019.1.2"></a><a name="Changes-from-2019.1.1-to-2019.1.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2019.1.1to2019.1.2">从2019.1.1到2019.1.2的更改</h2><p id="2c7a73ae"><a name="running-builds-node-deprecated"></a><a name="UpgradeNotes-running-builds-node-deprecated"></a></p><ul class="list _ul"><li class="list__item" id="6bbb8ab6"><p><a href="https://confluence.jetbrains.com/display/TCD18/Configuring+Running+Builds+Node" rel="noopener noreferrer" data-external="true" target="_blank">运行构建节点</a>已弃用，而在TeamCity 2019.2中将不再使用。在<a href="multinode-setup.html">多节点设置中</a> ，您可以<a href="configuring-secondary-node.html">配置</a> <i id="f194ff11">“处理由运行构建产生的数据”</i>职责<a href="configuring-secondary-node.html">的辅助节点</a> 。</p></li></ul><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues2">已知的问题</h3><ul class="list _ul"><li class="list__item" id="cc4683fc"><p>使用版本控制的设置时，从VCS导入设置时，构建历史记录可能会丢失。 <a href="https://youtrack.jetbrains.com/issue/TW-62106" rel="noopener noreferrer" data-external="true" target="_blank">细节</a> 。</p></li><li class="list__item" id="6a9639a8"><p>如果您使用.NET核心（“DOTNET”）的步骤在Windows代理，你可以，如果你有喜欢的位置安装在代理.NET核心运行时（未SDK）获得了<i id="22647296">“.NET SDK未找到”</i>错误<code class="code">C:\Program Files (x86)\dotnet</code> 。解决方法是，将<code class="code">env.DOTNET_HOME</code> .NET Core SDK位置的参数。<br>有关详细信息，请参见相关<a href="https://youtrack.jetbrains.com/issue/TW-61413" rel="noopener noreferrer" data-external="true" target="_blank">问题</a> 。</p></li></ul></div></div><a name="Changesfrom2019.1to2019.1.1"></a><a name="Changes-from-2019.1-to-2019.1.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2019.1to2019.1.1">从2019.1到2019.1.1的更改</h2><a name="BundledToolsUpdates"></a><a name="Bundled-Tools-Updates"></a><div class="chapter"><h3 id="UpgradeNotes-BundledToolsUpdates2">捆绑工具更新</h3><ul class="list _ul"><li class="list__item" id="d3bb9c6d"><p>捆绑的IntelliJ IDEA已更新至2019.1.3。</p></li><li class="list__item" id="b1acf9c3"><p>捆绑的ReSharper工具（检查和重复查找器）已升级到2019.1.0-eap08d版本。</p></li></ul></div></div><a name="Changesfrom2018.2.xto2019.1"></a><a name="Changes-from-2018.2.x-to-2019.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2018.2.xto2019.1">从2018.2.x到2019.1的更改</h2><a name="MandatorytagsforAmazoninstances"></a><a name="Mandatory-tags-for-Amazon-instances"></a><div class="chapter"><h3 id="UpgradeNotes-MandatorytagsforAmazoninstances">亚马逊实例的强制标签</h3><p id="41dcc6b6">现在，对于TeamCity运行的所有Amazon实例，标签都是<b id="892ac4e3">必需</b>的，这有助于识别它们。如果您使用与Amazon EC2的集成，请确保在Amazon中添加<a href="https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/ec2-supported-iam-actions-resources.html#supported-iam-actions-tagging" rel="noopener noreferrer" data-external="true" target="_blank">ec2：CreateTags</a>资源级权限。</p></div><a name="Changedbehaviorofreverseddependenciesproperties"></a><a name="Changed-behavior-of-reversed-dependencies-properties"></a><div class="chapter"><h3 id="UpgradeNotes-Changedbehaviorofreverseddependenciesproperties">反向依赖项属性的行为已更改</h3><p id="0278f26a">从2019.1开始， <a href="predefined-build-parameters.html#Overriding-Dependencies-Properties"><code class="code">reverse.dep</code></a>参数已更改，此更改可能会影响您现有的内部版本。在2019.1之前的版本中，当触发构建链时，TeamCity仅考虑了<code class="code">reverse.dep</code>在链的最高版本中指定的参数，即在依赖于所有其他版本的版本中指定的参数。如果链的某些中间构造具有<code class="code">reverse.dep</code>参数，它们被忽略。<br><a href="https://youtrack.jetbrains.com/issue/TW-41341" rel="noopener noreferrer" data-external="true" target="_blank">修复</a>之后，情况不再如此。现在，当触发构建链时，所有<code class="code">reverse.dep</code>将处理在构建链的所有节点中指定的参数。</p></div><a name="Lazyagenttoolloading"></a><a name="Lazy-agent-tool-loading"></a><div class="chapter"><h3 id="UpgradeNotes-Lazyagenttoolloading">延迟代理工具加载</h3><p id="299a32a5"><a href="installing-agent-tools.html">代理工具</a> （位于<code class="code"><agent_installation>/tools</code>现在，将在代理升级之前，而不是在使用相应工具的第一个版本之前将其转移到代理。您可能需要更新构建配置设置，以便TeamCity知道构建所需的工具。<br>在基于代理开始构建之前，TeamCity检查对以下内容的引用<code class="code">teamcity.tool.<tool_ID></code>配置参数以收集构建使用的工具集。如果通过此参数引用了某些工具，则TeamCity将确保在构建逻辑开始执行之前，该工具已存在于代理中。<br>如果您的某些版本在代理上使用工具，则假定其位置位于<code class="code"><agent installation>/tools</code>目录中，此类引用应更改为TeamCity提供的参数引用。像这样的路径<code class="code"><agent_installation>/tools/<tool_ID></code>在TeamCity设置中使用的应更改为<code class="code">%teamcity.tool.<tool_ID>%</code>参数参考。例如， <code class="code">../tools/maven3.4.5/bin/mvn</code>应该替换为<code class="code">%teamcity.tool.maven3.4.5%/bin/mvn</code> 。</p></div><a name="Changed.NETbuildrequirementsinReSharpertools"></a><a name="Changed-.NET-build-requirements-in-ReSharper-tools"></a><div class="chapter"><h3 id="UpgradeNotes-Changed.NETbuildrequirementsinReSharpertools">ReSharper工具中已更改的.NET构建要求</h3><p id="0cd77675">ReSharper工具使用的.NET Framework版本的要求已更改。现在，如果在构建配置中使用2018.2版或更高版本的ReSharper工具（dotCover和ReSharper Inspections）（包括与TeamCity 2019.1捆绑在一起的版本），则构建代理的要求将更改为.NET Framework 4.6.1或更高版本。确保在代理上更新.NET Framework。</p></div><a name="Token-basedauthenticationenabledbydefault"></a><a name="Token-based-authentication-enabled-by-default"></a><div class="chapter"><h3 id="UpgradeNotes-Token-basedauthenticationenabledbydefault">默认启用基于令牌的身份验证</h3><p id="c9724919">在升级到2019.1时，默认情况下将启用基于令牌的身份验证模块，因此您可以生成<a href="managing-your-user-account.html#Managing-Access-Tokens">访问令牌</a>并立即开始使用它们。</p></div><a name="NewCSPheadervalue"></a><a name="New-CSP-header-value"></a><div class="chapter"><h3 id="UpgradeNotes-NewCSPheadervalue">新的CSP标头值</h3><p id="eaabebc4">现在，TeamCity Web UI对<a href="https://content-security-policy.com/" rel="noopener noreferrer" data-external="true" target="_blank">Content-Security-Policy</a> HTTP标头使用了更多限制性值。这提供了额外的安全性，但代价是禁止使用不在TeamCity服务器上托管的Web资源。<br>如果您依赖外部资源（例如，在构建报告标签的内容中或使用尚未更新的插件），则可以在<code class="code">teamcity.web.header.Content-Security-Policy.protectedValue=<full_header_value></code> <a href="configuring-teamcity-server-startup-properties.html#TeamCity-internal-properties">内部财产</a> （和<code class="code">teamcity.web.header.Content-Security-Policy.adminUI.protectedValue</code> “管理”区域中的网页属性）。插件可以使用<a href="http://javadoc.jetbrains.net/teamcity/openapi/current/jetbrains/buildServer/web/ContentSecurityPolicyConfig.html" rel="noopener noreferrer" data-external="true" target="_blank">ContentSecurityPolicyConfig</a>打开API接口添加到配置的值。</p></div><a name="ChangeindotCoverartifacts"></a><a name="Change-in-dotCover-artifacts"></a><div class="chapter"><h3 id="UpgradeNotes-ChangeindotCoverartifacts">dotCover工件的更改</h3><p id="7abfcde0">的<code class="code">dotCover.dcvr</code>默认情况下，不再发布隐藏的工件。现在，它将在构建临时文件夹中创建，并在构建完成时将其删除。<br>如果您使用dotCover并依靠此工件，请指定指向<code class="code">%system.teamcity.build.tempDir%\..\agentTmp\dotNetCoverageResults\dotCover.dcvr</code>在<a href="configuring-general-settings.html#Artifact-Paths">Artifact路径中</a>明确地保存文件。</p></div><a name="BundledToolsUpdates"></a><a name="Bundled-Tools-Updates"></a><div class="chapter"><h3 id="UpgradeNotes-BundledToolsUpdates3">捆绑工具更新</h3><ul class="list _ul"><li class="list__item" id="d7e3ee9d"><p>最新的JaCoCo版本（0.8.4）已添加到TeamCity。</p></li><li class="list__item" id="a2d1e475"><p>捆绑的.NET工具（dotCover和ReSharper CLT）已升级到最新发布的版本2019.1.1。</p></li><li class="list__item" id="e14c3448">全新TeamCity安装中建议的用于外部数据库的JDBC驱动程序已更新至以下版本：<ul class="list _ul"><li class="list__item" id="65df6d1b"><p>MySQL-8.0.16</p></li><li class="list__item" id="6466be11"><p>MSSQL-7.2.2</p></li><li class="list__item" id="e47078c2"><p>PostgreSQL-42.2.5</p></li></ul></li></ul></div><a name="NoteonbetaversionsofPowerShell"></a><a name="Note-on-beta-versions-of-PowerShell"></a><div class="chapter"><h3 id="UpgradeNotes-NoteonbetaversionsofPowerShell">关于PowerShell Beta版本的注意事项</h3><p id="83c69f60">如果您使用的是PowerShell的Beta版本，请确保早于所有版本删除所有Beta版本。 <code class="code">v6.0.0-beta.9</code>在安装任何新发行的PowerShell版本之前。由于PowerShell检测器中的更新，如果安装了旧的beta版本，TeamCity将使用它而不是新发布的版本。</p></div><a name="NoteonusingDockerandWindowsServerwithprocessisolation"></a><a name="Note-on-using-Docker-and-Windows-Server-with-process-isolation"></a><div class="chapter"><h3 id="UpgradeNotes-NoteonusingDockerandWindowsServerwithprocessisolation">关于使用Docker和Windows Server进行进程隔离的注意事项</h3><p id="8e5b1ec4">如果您将Docker映像和Windows Server 2019与进程隔离一起使用，则构建代理可能无法启动（请参阅`` <a href="known-issues.html#" access-is-denie="-or-" access-to-the-path-is-denie="-problem-on-container-start" ="">已知问题''中的</a>更多信息）。要变通解决此问题，授予“完全控制”访问权限到“授权用户”组。</p></div></div><a name="Changesfrom2018.2.3to2018.2.4"></a><a name="Changes-from-2018.2.3-to-2018.2.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2018.2.3to2018.2.4">从2018.2.3到2018.2.4的更改</h2><p id="ef012ac2">TeamCity 2018.2.4中存在与未授权代理页面上显示的数据有关的回归：有关代理授权，启用/禁用评论以及最新活动时间的数据已从页面中删除。此数据显示在座席详细信息页面上。</p><p id="7d9652ce">性能提高后，我们会将数据返回到未经授权的代理页面。</p></div><a name="Changesfrom2018.2.2to2018.2.3"></a><a name="Changes-from-2018.2.2-to-2018.2.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2018.2.2to2018.2.3">从2018.2.2到2018.2.3的更改</h2><p id="6479007e">TeamCity现在提供适用于1803/1809平台的Windows Docker映像。</p><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues3">已知的问题</h3><p id="c737a2cc">如果没有完成的构建，则正在运行的构建不会显示在构建配置页面上。要解决此问题，请停止TeamCity服务器，然后更换<code class="code">TEAMCITY_DIRECTORY/webapps/ROOT/js/ring/bundle.js</code>与<code class="code">bundle.js</code>文件附加<a href="https://youtrack.jetbrains.com/issue/TW-59529#focus=streamItem-27-3327362.0-0" rel="noopener noreferrer" data-external="true" target="_blank">到此问题，</a>然后启动服务器。</p></div></div><a name="Changesfrom2018.2.1to2018.2.2"></a><a name="Changes-from-2018.2.1-to-2018.2.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2018.2.1to2018.2.2">从2018.2.1到2018.2.2的更改</h2><ul class="list _ul"><li class="list__item" id="5e69d7c8"><p>捆绑的Tomcat已更新至版本8.5.3。</p></li><li class="list__item" id="be0baa93"><p>TeamCity代理Docker映像支持.NET Core 2.2</p></li></ul></div><a name="Changesfrom2018.2to2018.2.1"></a><a name="Changes-from-2018.2-to-2018.2.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2018.2to2018.2.1">从2018.2到2018.2.1的更改</h2><p id="da72a6af">没有值得注意的变化</p></div><a name="Changesfrom2018.1.xto2018.2"></a><a name="Changes-from-2018.1.x-to-2018.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2018.1.xto2018.2">从2018.1.x到2018.2的更改</h2><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues4">已知的问题</h3><ul class="list _ul"><li class="list__item" id="0493f3f7"><p>如果升级失败并在MoveCustomDataStorageToDatabaseConverter或MoveRepositoryStateToCustomDataStorageConverter中出现错误，请从<a href="https://youtrack.jetbrains.com/issue/TW-58289#focus=streamItem-27-3207962-0-0" rel="noopener noreferrer" data-external="true" target="_blank">问题中解决</a> 。</p></li><li class="list__item" id="69c90519"><p>如果您使用同一存储库中的Subversion外部组件，则可能会遇到版本检测错误的问题。此问题中描述了解决<a href="https://youtrack.jetbrains.com/issue/TW-58336" rel="noopener noreferrer" data-external="true" target="_blank">此问题的方法</a> 。</p></li><li class="list__item" id="97927e33"><p>如果您在TeamCity启动期间看到以下错误：OutOfMemoryError <code class="code">org.jetbrains.dokka</code>在堆栈跟踪中，设置内部属性<code class="code">teamcity.kotlinConfigsDsl.docsGenerationXmx=768m</code> （如<a href="https://youtrack.jetbrains.com/issue/TW-56408" rel="noopener noreferrer" data-external="true" target="_blank">本期所述</a> ）</p></li></ul></div><a name="BundledToolsUpdates"></a><a name="Bundled-Tools-Updates"></a><div class="chapter"><h3 id="UpgradeNotes-BundledToolsUpdates4">捆绑工具更新</h3><ul class="list _ul"><li class="list__item" id="f15e6b0e"><p>捆绑的.NET工具（dotCover和ReSharper CLT）已升级到最新发布的版本2018.1.4</p></li><li class="list__item" id="3e63331d"><p>TeamCity 2018.2与IntelliJ IDEA 2018.3.1捆绑在一起。IntelliJ IDEA项目运行器使用JPS 2018.3.1</p></li><li class="list__item" id="da66e923"><p>Windows捆绑了OpenJDK <code class="code">.exe</code> TeamCity发行版而不是Oracle Java。</p></li></ul></div><a name="NuGetfeed"></a><a name="NuGet-feed"></a><div class="chapter"><h3 id="UpgradeNotes-NuGetfeed">NuGet提要</h3><p id="8a9b0755">先前用于引用全局NuGet提要的参数已删除。升级后，所有<a href="using-teamcity-as-nuget-feed.html">参数</a>都将转换为<a href="using-teamcity-as-nuget-feed.html">引用Root项目中默认NuGet feed的参数</a> 。</p><p id="d6645430">如果您仍在项目参数中使用已弃用的NuGet提要引用，请按以下方式更新它们：</p><div class="table-wrapper"><table width="100%" id="70a7adbd"><thead><tr id="0d3c3d78" class="ijRowHead"><th id="1cd1c326"><p id="c1a19923">全局供稿名称</p></th><th id="ee8e267f"><p id="66165c71">项目供稿名称</p></th></tr></thead><tbody><tr id="8f835e00" class="ijRowOdd"><td id="9a0e4711"><p id="2252189e">teamcity.nuget.feed.server</p></td><td id="e16da46d"><p id="88a368f8">teamcity.nuget.feed.guestAuth。_Root.default.v2</p></td></tr><tr id="f8ae2ffd" class="ijRowEven"><td id="1d2d9db3"><p id="c2480043">teamcity.nuget.feed.auth.server</p></td><td id="b0a20bb5"><p id="912d7b95">teamcity.nuget.feed.httpAuth。_Root.default.v2</p></td></tr><tr id="2ad5758b" class="ijRowOdd"><td id="25b667fc"><p id="6216a816">system.teamcity.nuget.feed.auth.serverRootUrlBased.server</p></td><td id="fdce9e45"><p id="8f181ca5">teamcity.nuget.feed.httpAuth。_Root.default.v2</p></td></tr></tbody></table></div></div></div><a name="Changesfrom2018.1.4to2018.1.5"></a><a name="Changes-from-2018.1.4-to-2018.1.5"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2018.1.4to2018.1.5">从2018.1.4到2018.1.5的更改</h2><p id="fc9e40f3">没有值得注意的变化</p></div><a name="Changesfrom2018.1.3to2018.1.4"></a><a name="Changes-from-2018.1.3-to-2018.1.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2018.1.3to2018.1.4">从2018.1.3到2018.1.4的更改</h2><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues5">已知的问题</h3><ul class="list _ul"><li class="list__item" id="41f9c1d0"><p>在服务器升级到2018.1.4时运行的内部版本可能会使其内部版本日志和状态被截断，而不会及时报告内部版本失败。构建日志将通过“ __tc_longResponseMarker”文本（ <a href="https://youtrack.jetbrains.com/issue/TW-58266" rel="noopener noreferrer" data-external="true" target="_blank">详细信息</a> ）获得警告。建议升级到此版本之前，请等待直到没有正在运行的内部版本。</p></li></ul></div><a name="Misc"></a><a name="Misc"></a><div class="chapter"><h3 id="UpgradeNotes-Misc">杂项</h3><p id="c5094f90">TeamCity 2018.1.4中不再支持Microsoft Internet Explorer 10。</p></div></div><a name="Changesfrom2018.1.2to2018.1.3"></a><a name="Changes-from-2018.1.2-to-2018.1.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2018.1.2to2018.1.3">从2018.1.2到2018.1.3的更改</h2><a name="BundledToolsUpdates"></a><a name="Bundled-Tools-Updates"></a><div class="chapter"><h3 id="UpgradeNotes-BundledToolsUpdates5">捆绑工具更新</h3><p id="cb5a8c8d">最新的JaCoCo版本（0.8.2）已添加到TeamCity。</p></div><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues6">已知的问题</h3><p id="73dc5eaa">如果您使用JaCoCo覆盖范围并且决定从TeamCity 2018.1.3+降级到TeamCity版本2018.1-2018.1.2，则可能会遇到问题，需要手动修复才能使受影响的配置再次起作用。</p></div></div><a name="Changesfrom2018.1.1to2018.1.2"></a><a name="Changes-from-2018.1.1-to-2018.1.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2018.1.1to2018.1.2">从2018.1.1到2018.1.2的更改</h2><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues7">已知的问题</h3><p id="7386af5d">如果您使用的是<a href="https://plugins.jetbrains.com/plugin/8948-web-hooks-tcwebhooks-" rel="noopener noreferrer" data-external="true" target="_blank">tcWebHooks</a>第三方TeamCity插件，请在升级之前将其更新为最新版本（ <a href="https://youtrack.jetbrains.com/issue/TW-56626" rel="noopener noreferrer" data-external="true" target="_blank">详细信息</a> ）。</p><p id="f1dc0e39">我们提高了识别类似TeamCity退出代码构建问题的准确性。这些构建问题的现有调查和静音将被重置。</p></div><a name="BundledToolsUpdates"></a><a name="Bundled-Tools-Updates"></a><div class="chapter"><h3 id="UpgradeNotes-BundledToolsUpdates6">捆绑工具更新</h3><p id="20b7883e">捆绑的Tomcat已更新至8.5.32版本。</p></div></div><a name="Changesfrom2018.1to2018.1.1"></a><a name="Changes-from-2018.1-to-2018.1.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2018.1to2018.1.1">从2018.1到2018.1.1的更改</h2><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues8">已知的问题</h3><p id="683b4059">如果您要从2018.1升级到2018.1.1，并且想要查看由于问题<a href="https://youtrack.jetbrains.com/issue/TW-55703" rel="noopener noreferrer" data-external="true" target="_blank">TW-55703</a>和<a href="https://youtrack.jetbrains.com/issue/TW-55833" rel="noopener noreferrer" data-external="true" target="_blank">TW-55833</a>而丢失的NuGet软件包，请执行以下操作：</p><ul class="list _ul"><li class="list__item" id="e65db0ec"><p>清理<code class="code">.teamcity/nuget/packages.json</code>构建工件中的文件。考虑使用以下PowerShell脚本：</p></li></ul><div class="code-block" data-lang="bash">> cd“％TeamCityDataDir％system \ artifacts \”> Get-ChildItem -Recurse |哪里对象{$ _。FullName -match'\ .teamcity \\ nuget \\ packages \ .json'} |除去项目</div><ul class="list _ul"><li class="list__item" id="19a22d63"><p>关于<b id="c0a5448a">行政|诊断|缓存</b>页面，重置“buildsMetadata”缓存并等待重新索引完成。要临时提高索引速度，请参阅<a href="https://confluence.jetbrains.com/display/TCD18/Known+Issues#KnownIssues-PackagesindexingisslowinTeamCityNuGetfeed" rel="noopener noreferrer" data-external="true" target="_blank">以下提示</a> 。</p></li></ul></div><a name="DockerImages"></a><a name="Docker-Images"></a><div class="chapter"><h3 id="UpgradeNotes-DockerImages">Docker映像</h3><p id="01e30ed9">自2018.1.1起，TeamCity具有多平台Docker映像，这些映像由Docker Hub中发布的“最新”和版本号标记标记，例如“ jetbrains / teamcity-server”，“ jetbrains / teamcity-server：2018.1.1”。这允许对Linux和Windows <a href="https://youtrack.jetbrains.com/issue/TW-56088" rel="noopener noreferrer" data-external="true" target="_blank">docker</a>容器使用相同的docker映像参考，有关详细信息，请参阅<a href="https://youtrack.jetbrains.com/issue/TW-56088" rel="noopener noreferrer" data-external="true" target="_blank">TW-55061</a> 。</p></div></div><a name="Changesfrom2017.2.xto2018.1"></a><a name="Changes-from-2017.2.x-to-2018.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2017.2.xto2018.1">从2017.2.x到2018.1的更改</h2><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues9">已知的问题</h3><p id="673d3c15">在通过多个构建步骤将NuGet程序包发布到TeamCity NuGet提要中时，只有第一个构建步骤发布的程序包才可见。有关详情，请参阅<a href="https://youtrack.jetbrains.com/issue/TW-55703" rel="noopener noreferrer" data-external="true" target="_blank">TW-55703</a> 。如果您在下载存档中发布的NuGet软件包时遇到问题，请参阅<a href="https://youtrack.jetbrains.com/issue/TW-55833" rel="noopener noreferrer" data-external="true" target="_blank">TW-55833</a> 。</p></div><a name="Stricterrulesforparameternamesusedinparameterreferences"></a><a name="Stricter-rules-for-parameter-names-used-in-parameter-references"></a><div class="chapter"><h3 id="UpgradeNotes-Stricterrulesforparameternamesusedinparameterreferences">参数引用中使用的参数名称的更严格规则</h3><p id="4c98affc">现在，将以更严格的方式验证“构建配置”参数的名称。尽管已经存在的参数应继续起作用，但强烈建议您检查名称并使用拉丁字母而不使用特殊符号。<a href="configuring-build-parameters.html">细节</a></p></div><a name="Userself-registration"></a><a name="User-self-registration"></a><div class="chapter"><h3 id="UpgradeNotes-Userself-registration">用户自我注册</h3><p id="06274099">如果启用了内置身份验证，并且启用了“允许从登录页面进行用户注册”设置，则该设置将在升级时被禁用。如果需要注册，请确保该服务器未对未经授权的用户开放（例如，无法从Internet访问）开放，并通过管理页面顶部或“管理|身份验证”下显示的运行状况项启用设置。 “内置”模块设置。</p></div><a name="BundledToolsUpdate"></a><a name="Bundled-Tools-Update"></a><div class="chapter"><h3 id="UpgradeNotes-BundledToolsUpdate">捆绑工具更新</h3><ul class="list _ul"><li class="list__item" id="f110b855"><p>IntelliJ IDEA项目运行器使用要求Java 1.8为最低版本的JPS 2017.3.4。</p></li><li class="list__item" id="19b72b64"><p>捆绑的ReSharper CLT和dotCover已更新至版本2018.1.2</p></li></ul></div><a name="NuGetfeed"></a><a name="NuGet-feed"></a><div class="chapter"><h3 id="UpgradeNotes-NuGetfeed2">NuGet提要</h3><ul class="list _ul"><li class="list__item" id="1c41b430"><p id="72edab5f">NuGet提要的配置已从服务器级别移至项目级别：现在，每个项目都可以拥有自己的提要。可以添加“ NuGet软件包索引器”构建功能，以构建应对其工件进行索引的配置。</p></li><li class="list__item" id="3df4e2fc"><p id="2436705c">不推荐使用以下与NuGet提要相关的构建参数：</p><ul class="list _ul"><li class="list__item" id="ea9b79ff"><code class="code">teamcity.nuget.feed.auth.server</code></li><li class="list__item" id="407d7b3a"><code class="code">teamcity.nuget.feed.server</code></li><li class="list__item" id="795f8ad3"><code class="code">system.teamcity.nuget.feed.auth.serverRootUrlBased.server</code></li></ul><p id="c604fbf7">现在，您需要从“ <b id="00fff8d0">项目设置”</b>中的<b id="00fff8d0">“</b> <a href="using-teamcity-as-nuget-feed.html">NuGet提要”</a>页面中明确指定URL。</p></li><li class="list__item" id="dc3676d1"><p id="9a7a77af">启用的默认NuGet提要，其中所有已发布的包都可以通过URL访问<code class="code">/app/nuget/v1/FeedService.svc/</code>现在移至Root项目Feed <code class="code">/app/nuget/feed/_Root/default/v2/</code> 。建议在项目中切换到新的URL。</p></li><li class="list__item" id="6e3ed0f7"><p id="93f6ee0f">现在，.nupkg文件在代理端而不是在服务器上建立索引，这可能会稍微增加使用NuGet Feed功能和启用自动包索引的项目的构建时间，或使用NuGet Packages Indexer构建功能的构建的时间。</p></li></ul></div><a name="RESTAPI"></a><a name="REST-API"></a><div class="chapter"><h3 id="UpgradeNotes-RESTAPI">REST API</h3><p id="d6e437ae">REST API使用版本2018.1。以前版本的API仍在/app/rest/2017.2、/app/rest/2017.1（/app/rest/10.0)、app/rest/9.1、/app/rest/9.0、/app/rest/ 8.1，/ app / rest / 7.0，/ app / rest / 6.0网址。建议停止使用以前的API URL，因为我们将在以下版本中删除它们。</p><a name="Filteringbuildsbyagentnames"></a><a name="Filtering-builds-by-agent-names"></a><div class="chapter"><h4 id="UpgradeNotes-Filteringbuildsbyagentnames">按代理名称过滤构建</h4><p id="c056b633">当代理名称包含括号的符号，而不是使用<name>AGENTNAME：，使用“AGENTNAME：（值<value>：）</value></name></p></div><a name="Locatorswith" value:tex="" =""></a><a name="Locators-with-" value:-text="" =""></a><div class="chapter"><h4 id="UpgradeNotes-Locatorswith" value:tex="" ="">具有“值： <text>”的</text>定位符</h4><p id="79f48541"><text>默认情况下 ，使用“值： <text>”定位符（例如，用于匹配属性）且没有“ matchType”维规范的请求将开始使用“等于”匹配。添加“ matchType：包含”以保留旧的行为。<a href="https://youtrack.jetbrains.com/issue/TW-55350" rel="noopener noreferrer" data-external="true" target="_blank">细节</a></text></text></p></div></div><a name="VSSpluginisunbundled"></a><a name="VSS-plugin-is-unbundled"></a><div class="chapter"><h3 id="UpgradeNotes-VSSpluginisunbundled">VSS插件未捆绑</h3><p id="d8c1c4aa">Visual SourceSafe插件不再与TeamCity捆绑在一起，而是可以<a href="https://plugins.jetbrains.com/plugin/10902-vcs-support-vss" rel="noopener noreferrer" data-external="true" target="_blank">单独下载获得</a> 。如果您仍使用此VSS，请联系我们的<a href="https://confluence.jetbrains.com/display/TW/Feedback" rel="noopener noreferrer" data-external="true" target="_blank">支持</a> 。</p></div><a name="Other"></a><a name="Other"></a><div class="chapter"><h3 id="UpgradeNotes-Other">其他</h3><ul class="list _ul"><li class="list__item" id="092ae0c4"><p>提交状态发布者支持Gerrit 2.6+版本。要获得旧版Gerrit的支持，请转到我们的<a href="https://confluence.jetbrains.com/display/TW/Feedback" rel="noopener noreferrer" data-external="true" target="_blank">支持</a> 。</p></li><li class="list__item" id="76c6fef8"><p>从9.1之前的TeamCity版本升级时，如果启动TeamCity 2018.1并升级了代理，但是随后您决定将服务器回滚到以前的TeamCity版本，则代理将无法连接回旧服务器，并且需要手动重新安装。</p></li><li class="list__item" id="5346310a"><p>确保没有阻止从代理到服务器的HTTP请求（例如，对... / app / agents / ...的请求）网址）</p></li><li class="list__item" id="62ecd9d8"><p>从2018.1开始，TeamCity使用带有“ /”而不是“ ::”的完整项目名称作为Project-Subproject的分隔符，无论该位置存在完整的项目名称。</p></li></ul></div></div><a name="Changesfrom2017.2.3to2017.2.4"></a><a name="Changes-from-2017.2.3-to-2017.2.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2017.2.3to2017.2.4">从2017.2.3到2017.2.4的更改</h2><p id="a307c0f9">“检查（.NET）”和“重复查找器（.NET）”构建步骤已重命名为“检查（ReSharper）”和“重复查找器”（ReSharper）。</p></div><a name="Changesfrom2017.2.2to2017.2.3"></a><a name="Changes-from-2017.2.2-to-2017.2.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2017.2.2to2017.2.3">从2017.2.2到2017.2.3的更改</h2><a name="Buildrevisions"></a><a name="Build-revisions"></a><div class="chapter"><h3 id="UpgradeNotes-Buildrevisions">建立修订</h3><p id="449c342b">在所有构建配置中，升级之前运行的构建不会在链中重复使用，而是会重新运行（如果使用分支，则仅影响默认分支上的最后一个构建）。对于像Perforce这样的VCS，这也可能会在首次运行版本中导致干净的签出。该行为类似于VCS根编辑后的行为。</p><p id="1235bb01"><b id="83358937">安全</b></p><p id="0bf30686">升级到2017.2.x版本时（升级到2018.1及更高版本时，请忽略）：建议添加“ <code class="code">teamcity.artifacts.restrictRequestsWithArtifactReferer=true</code> <a href="configuring-teamcity-server-startup-properties.html">内部属性</a>以增强服务器的安全性。</p></div></div><a name="Changesfrom2017.2.1to2017.2.2"></a><a name="Changes-from-2017.2.1-to-2017.2.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2017.2.1to2017.2.2">从2017.2.1到2017.2.2的更改</h2><p id="cdffc3c2"><a name="knownIssues_2017_2_2"></a><a name="UpgradeNotes-knownIssues_2017_2_2"></a></p><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues10">已知的问题</h3><p id="318e0b43">（已修复2017.2.3）如果您使用Artifactory插件并在打开构建步骤设置时收到“无效的RSA公钥”浏览器消息，请应用<a href="https://youtrack.jetbrains.com/issue/TW-53562#comment=27-2698895" rel="noopener noreferrer" data-external="true" target="_blank">解决方法</a> 。</p><p id="5d5907d0">在Windows下，将TeamCity服务器作为服务启动时，不会创建“ logs \ teamcity-winservice.log”文件，并且无处可见服务器启动错误。<a href="https://youtrack.jetbrains.com/issue/TW-54483" rel="noopener noreferrer" data-external="true" target="_blank">细节</a></p></div><a name="IDEPlugins"></a><a name="IDE-Plugins"></a><div class="chapter"><h3 id="UpgradeNotes-IDEPlugins">IDE插件</h3><p id="fe99b509">强烈建议将所有用户的IDE插件更新到最新版本，然后添加<code class="code">teamcity.uploadPersonalPatch.requireAuthorization=true</code> <a href="configuring-teamcity-server-startup-properties.html">内部属性，</a>以增强服务器的安全性。</p></div><a name="PerforceVCSRootexecutablepaths"></a><a name="Perforce-VCS-Root-executable-paths"></a><div class="chapter"><h3 id="UpgradeNotes-PerforceVCSRootexecutablepaths">Perforce VCS Root可执行文件路径</h3><p id="e1fc2646"><b id="12108c88">从TeamCity 2017.2.2开始</b> ，用于指定p4路径的字段仅在代理端有效，以进行代理端检出。</p><p id="d1bc7e4b">对于服务器，p4二进制文件应存在于TeamCity服务器的PATH中（或可以通过<code class="code">teamcity.perforce.customP4Path</code> <a href="configuring-teamcity-server-startup-properties.html">内部财产</a> ）。的<code class="code">teamcity.perforce.p4PathOnServerWhitelist</code> <a href="configuring-teamcity-server-startup-properties.html">internal属性</a>可用于指定允许的p4路径的分号分隔列表。可以在服务器端的VCS Root p4路径参数中设置此列表中的路径（以恢复旧的行为）。</p></div><a name="MercurialVCSRootproperties"></a><a name="Mercurial-VCS-Root-properties"></a><div class="chapter"><h3 id="UpgradeNotes-MercurialVCSRootproperties">Mercurial VCS根属性</h3><p id="0d945cf3"><b id="0756ae10">从TeamCity 2017.2.2开始</b> ，出于安全原因，许多Mercurial VCS根属性更改了其行为。</p><ul class="list _ul"><li class="list__item" id="5bcb8c05"><p>仅当列入<a href="https://confluence.jetbrains.com/display/TCD10/Mercurial#Mercurial-Pathtohgexecutabledetection" rel="noopener noreferrer" data-external="true" target="_blank">白名单时，</a>才在TeamCity服务器上使用“ HG命令路径”</p></li><li class="list__item" id="128fe0a9"><p>如果VCS根目录尚不具备“将存储库复制到”属性，则该属性将被隐藏，并且默认情况下将其忽略。要使TeamCity在所有VCS根目录中显示属性，请添加<code class="code">teamcity.hg.showCustomClonePath=true</code> <a href="configuring-teamcity-server-startup-properties.html">内部财产</a> 。仅当VCS根属性的值包含在VCS根目录指定的白名单中时，该值才会受到尊重<code class="code">teamcity.hg.customClonePathWhitelist</code> <a href="configuring-teamcity-server-startup-properties.html">内部属性</a> ，这是允许使用克隆的目录的分号分隔。使用<code class="code">/path/to/dir/*</code>允许克隆到子目录<code class="code">/path/to/dir</code> 。</p></li><li class="list__item" id="470852f5"><p>服务器上的“ Mercurial config”将被忽略。如果您需要启用某些Mercurial插件，请在global中进行。 <code class="code">hgrc</code>在TeamCity服务器计算机上。</p></li></ul></div></div><a name="Changesfrom2017.2to2017.2.1"></a><a name="Changes-from-2017.2-to-2017.2.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2017.2to2017.2.1">从2017.2到2017.2.1的更改</h2><a name="KotlinDSLchanges"></a><a name="Kotlin-DSL-changes"></a><div class="chapter"><h3 id="UpgradeNotes-KotlinDSLchanges">Kotlin DSL更改</h3><p id="38813a0d">pom.xml中的版本已更新： <code class="code">kotlin.version</code>更新为<code class="code">1.2.0</code> ， <code class="code">teamcity.dsl.version</code>更新为<code class="code">2017.2.1</code> 。对<code class="code">kotlin-stdlib</code>被替换为对<code class="code">kotlin-stdlib-jdk8</code>为了提供对jdk8中可用的其他功能的访问（例如，正则表达式中的命名组）。对已弃用的依赖<code class="code">kotlin-runtime</code>以及对<code class="code">kotlin-compiler-embeddable</code>被丢弃。</p><p id="efc952a1">现在，TeamCity为Kotlin DSL提供了一个父Maven项目，该项目定义了<code class="code">teamcity.dsl.version</code>和<code class="code">kotlin.version</code>属性。有了这样的父项目，您无需在每次TeamCity升级后更新pom.xml。</p><p id="518eb452">应用这些更改的最简单方法是在项目管理区域中运行“以Kotlin格式下载设置”操作，并使用TeamCity服务器生成的zip中的pom.xml。</p></div><a name="BundledJavausedinDockerimages"></a><a name="Bundled-Java-used-in-Docker-images"></a><div class="chapter"><h3 id="UpgradeNotes-BundledJavausedinDockerimages">Docker映像中使用的捆绑Java</h3><p id="809f17eb">Docker映像中使用的捆绑Java已更新为8u151。</p></div></div><a name="Changesfrom2017.1.xto2017.2"></a><a name="Changes-from-2017.1.x-to-2017.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2017.1.xto2017.2">从2017.1.x到2017.2的更改</h2><p id="ed1d170b"><a name="knownIssues_2017_2"></a><a name="UpgradeNotes-knownIssues_2017_2"></a></p><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues11">已知的问题</h3><p id="6c8cb8cf">（固定于2017.2.1）在Java工作模式下的TFS（当计算机上未安装Team Explorer时）报告“ TFS子系统已损坏”错误。有关详细信息，请参阅<a href="https://youtrack.jetbrains.com/issue/TW-52685" rel="noopener noreferrer" data-external="true" target="_blank">TW-52685</a> 。</p><p id="d49a46fb">如果您的TeamCity安装目录包含许多嵌套目录（例如，TeamCity数据目录位于其下），则使用Windows安装程序进行升级可能会花费大量时间。在“提取：Uninstall.exe ...”进度消息之后，可能会出现较长的阶段。如果遇到此漫长的步骤，请等待操作完成（安装程序将icacls.exe实用程序作为嵌套进程运行）。为避免出现此问题，建议将<a href="teamcity-data-directory.html">数据目录</a>移出TeamCity服务器安装<a href="teamcity-data-directory.html">目录</a> 。</p></div><a name="Perforcebranchspecificationchange"></a><a name="Perforce-branch-specification-change"></a><div class="chapter"><h3 id="UpgradeNotes-Perforcebranchspecificationchange">Perforce分支规范更改</h3><p id="70bd5a77">如果您将Perforce流与启用的功能分支一起使用，并且使用的是非默认分支过滤器，则有一项重大更改需要您采取措施。</p><p id="f097c5ca">从TeamCity 2017.2开始，Perforce VCS根目录对Perforce流和TeamCity功能分支规范使用相同的格式。</p><p id="2935171a">在Perforce的VCS Root分支规范中， <code class="code">+:stream_name</code>现在必须替换为<code class="code">+://stream_depot/stream_name</code> 。另外，为了在UI中更好地表示流名称，您可能需要替换默认的分支规范，例如<code class="code">+:*</code>与<code class="code">+://your_stream_depot/*</code> 。</p><p id="fc81d649">此更改是在固定<a href="https://youtrack.jetbrains.com/issue/TW-48038" rel="noopener noreferrer" data-external="true" target="_blank">TW-48038</a>的范围内进行的。</p></div><a name="Serverprocessrestart"></a><a name="Server-process-restart"></a><div class="chapter"><h3 id="UpgradeNotes-Serverprocessrestart">服务器进程重启</h3><p id="0dd9480b">现在，如果服务器进程意外停止或终止，则该进程将自动重新启动。应该使用以下命令停止服务器<code class="code">teamcity-server.bat/sh stop</code>执行正常停止的命令。</p></div><a name="Bundledplugins"></a><a name="Bundled-plugins"></a><div class="chapter"><h3 id="UpgradeNotes-Bundledplugins">捆绑的插件</h3><a name="Dockerintegrationplugin"></a><a name="Docker-integration-plugin"></a><div class="chapter"><h4 id="UpgradeNotes-Dockerintegrationplugin">Docker集成插件</h4><p id="9b99291f">自TeamCity 2017.2.x起捆绑提供Docker集成插件。如果您手动安装了先前版本的插件，请<a href="https://confluence.jetbrains.com/display/TCD10/Installing+Additional+Plugins" rel="noopener noreferrer" data-external="true" target="_blank">删除它</a> 。</p></div><a name=".NETCLIplugin"></a><a name=".NET-CLI-plugin"></a><div class="chapter"><h4 id="UpgradeNotes-.NETCLIplugin">.NET CLI插件</h4><p id="578f2b01">自TeamCity 2017.2.x起捆绑提供.NET CLI（.NET Core）插件。如果您手动安装了先前版本的插件，请<a href="https://confluence.jetbrains.com/display/TCD10/Installing+Additional+Plugins" rel="noopener noreferrer" data-external="true" target="_blank">删除它</a> 。</p><p id="eed6a292">在升级期间，所有现有的.NET Core构建步骤都将转换为.NET CLI步骤，并且现有的.NET Core插件将被禁用。</p><p id="761fab71"><b id="889a4939">注意</b> ： <code class="code">DotNetCore</code>和<code class="code">DotNetCore_Path</code>代理配置参数将更改为<code class="code">DotNetCLI</code>和<code class="code">DotNetCLI_Path</code> ;请考虑根据这些参数更新您的代理要求。</p></div></div><a name="RESTAPI"></a><a name="REST-API"></a><div class="chapter"><h3 id="UpgradeNotes-RESTAPI2">REST API</h3><p id="ba82ff2e">REST API使用版本2017.2。该API的先前版本仍在/app/rest/2017.1（/app/rest/10.0)、app/rest/9.1、/app/rest/9.0、/app/rest/8.1、/app/rest/下可用7.0，/ app / rest / 6.0网址。</p><p id="0de2e8d6"><b id="480b260b">buildType实体</b></p><p id="4c94f40b">现在具有“模板”子元素，而不是“模板”来支持多个模板。</p><p id="ca47d902"><b id="0de1a782">构建实体</b>不再公开布尔值“ running”属性，而是使用值为“ running”的文本“ state”属性。</p></div><a name="WindowsVersionsSupport"></a><a name="Windows-Versions-Support"></a><div class="chapter"><h3 id="UpgradeNotes-WindowsVersionsSupport">Windows版本支持</h3><p id="7e8374b9">Windows XP和Vista不再是TeamCity Server和Agent支持的Windows版本。尽管服务器和代理仍很可能仍可以在这些旧版本上运行，但在开发过程中我们并不针对这些版本。<a href="https://confluence.jetbrains.com/display/TW/Feedback" rel="noopener noreferrer" data-external="true" target="_blank">让我们知道</a>版本支持对您使用TeamCity是否重要，或者您发现系统支持存在任何问题。</p></div><a name="J2EEServlet2.5containerisnolongersupported"></a><a name="J2EE-Servlet-2.5-container-is-no-longer-supported"></a><div class="chapter"><h3 id="UpgradeNotes-J2EEServlet2.5containerisnolongersupported">不再支持J2EE Servlet 2.5容器</h3><p id="9bbf9171">自TeamCity 2017.2。起不支持J2EE Servlet容器2.5版。TeamCity不保证支持实现Servlet 2.5的Tomcat 6.x和Jetty7.x。对于.war发行版（不建议使用.tar.gz发行版），TeamCity支持Apache Tomcat 7 +，J2EE Servlet 3.0+和JSP 2.2+。</p></div><a name="Other"></a><a name="Other"></a><div class="chapter"><h3 id="UpgradeNotes-Other2">其他</h3><ul class="list _ul"><li class="list__item" id="f857f860"><p>捆绑的Tomcat 8.5。限制URL中特殊字符的使用，包括大括号符号（{}）。<a href="https://youtrack.jetbrains.com/issue/TW-51052" rel="noopener noreferrer" data-external="true" target="_blank">细节</a> 。</p></li><li class="list__item" id="42d2b002"><p>TeamCity与基于Intellij的IDE的集成不再支持StarTeam和Visual Source Safe版本控件。</p></li></ul></div></div><a name="Changesfrom2017.1.4to2017.1.5"></a><a name="Changes-from-2017.1.4-to-2017.1.5"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2017.1.4to2017.1.5">从2017.1.4到2017.1.5的更改</h2><p id="647f7cab">捆绑的JetBrains dotCover已更新至版本2017.2</p><p id="7654a019">如果SSH代理构建功能无法使用指定的SSH密钥（在<a href="https://youtrack.jetbrains.com/issue/TW-42707" rel="noopener noreferrer" data-external="true" target="_blank">TW-42707</a>范围内）启动SSH代理，则开始报告构建问题。以前只记录错误，而没有报告为生成问题。结果，升级后，使用无效的SSH代理设置的构建将开始失败。</p></div><a name="Changesfrom2017.1.3to2017.1.4"></a><a name="Changes-from-2017.1.3-to-2017.1.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2017.1.3to2017.1.4">从2017.1.3到2017.1.4的更改</h2><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues12">已知的问题</h3><p id="d0e3fc9f">TFS个人支持列出了TFVC VCS根目录的所有构建配置。有关详细信息，请参见<a href="https://youtrack.jetbrains.com/issue/TW-51497" rel="noopener noreferrer" data-external="true" target="_blank">TW-51497</a> 。</p></div></div><a name="Changesfrom2017.1.2to2017.1.3"></a><a name="Changes-from-2017.1.2-to-2017.1.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2017.1.2to2017.1.3">从2017.1.2到2017.1.3的更改</h2><p id="eb5dea43"><a href="https://youtrack.jetbrains.com/issue/TW-50148" rel="noopener noreferrer" data-external="true" target="_blank">TW-50148</a>已修复，DSL API文档得到了改进。如果需要这些更改以进行本地开发，请将<a href="upgrading-dsl.html">maven依赖项版本</a>更新为2017.1.3。</p><p id="0e33c0e1">现在，TeamCity服务器自动运行“ git gc”以提高git操作的性能。这要求将git客户端安装在服务器上，并通过PATH环境变量作为服务器。如果找不到本地git客户端，则会显示相应的运行状况报告。为了让TeamCity找到git客户端，需要将该客户端安装在服务器计算机上并添加到<code class="code">$PATH</code> （此后需要重新启动服务器）。可以通过以下方式指定git客户端的路径，而无需修改PATH： <code class="code">teamcity.server.git.executable.path</code> <a href="configuring-teamcity-server-startup-properties.html">内部财产</a> 。</p></div><a name="Changesfrom2017.1.1to2017.1.2"></a><a name="Changes-from-2017.1.1-to-2017.1.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2017.1.1to2017.1.2">从2017.1.1到2017.1.2的更改</h2><p id="7b6c1f7d">没有值得注意的变化。</p></div><a name="Changesfrom2017.1to2017.1.1"></a><a name="Changes-from-2017.1-to-2017.1.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2017.1to2017.1.1">从2017.1到2017.1.1的更改</h2><p id="bb7859ba">捆绑的IntelliJ IDEA已更新至2017.1.2</p></div><a name="Changesfrom10.0.xto2017.1"></a><a name="Changes-from-10.0.x-to-2017.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom10.0.xto2017.1">从10.0.x到2017.1的变化</h2><a name="Knownissues"></a><a name="Known-issues"></a><div class="chapter"><h3 id="UpgradeNotes-Knownissues13">已知的问题</h3><p id="10eafdef">编辑云配置文件会取消配置文件代理上的所有构建。有关详细信息，请参阅<a href="https://youtrack.jetbrains.com/issue/TW-49616" rel="noopener noreferrer" data-external="true" target="_blank">TW-49616</a> 。</p></div><a name="TeamCityVersioningChanges"></a><a name="TeamCity-Versioning-Changes"></a><div class="chapter"><h3 id="UpgradeNotes-TeamCityVersioningChanges">TeamCity版本变更</h3><p id="e308abfb">自2017年以来，TeamCity采用了常见的JetBrains版本控制方案，该模式按照以下模式逐年标识版本<year>。 <number of="" the="" feature="" release="" within="" year="">。 <bugfix update="" number="">。当前版本是TeamCity 2017.1，以前称为TeamCity 10.1。</bugfix></number></year></p></div><a name="UpdatesettingsinKotlinDSL"></a><a name="Update-settings-in-Kotlin-DSL"></a><div class="chapter"><h3 id="UpgradeNotes-UpdatesettingsinKotlinDSL">更新Kotlin DSL中的设置</h3><p id="46367841">在此版本中，TeamCity设置格式已更改，并且如果您的设置存储在Kotlin DSL中，则可能需要先<a href="upgrading-dsl.html">更新Kotlin DSL脚本，</a>然后才能继续使用它们。服务器升级后，请检查所有相关的服务器运行状况报告。</p><p id="c0e51c1b"><a name="2017.1-CSRF"></a><a name="UpgradeNotes-2017.1-CSRF"></a></p></div><a name="CSRFProtection:ModifyingGETrequestsandProperProxyconfigurations"></a><a name="CSRF-Protection:-Modifying-GET-requests-and-Proper-Proxy-configurations"></a><div class="chapter"><h3 id="UpgradeNotes-CSRFProtection:ModifyingGETrequestsandProperProxyconfigurations">CSRF保护：修改GET请求和正确的代理配置</h3><p id="db14c76f">TeamCity现在实施<a href="csrf-protection.html">CSRF保护</a>以提高Web UI安全性，并且这引入了一些行为上的变化，这些变化可能会影响您的安装。特别是：</p><ul class="list _ul"><li class="list__item" id="1c9f7830"><p>如果在TeamCity之前使用<b id="95ea3125">反向代理</b> ，则代理不应更改原始的“主机”请求标头（这通常需要配置代理以将主机标头设置为原始请求值）。同样，它不应修改原始请求中存在的“ Origin”和“ Referer”标头。虽然长期以来一直建议使用此设置，但现在对于TeamCity Web UI的运行至关重要。</p></li><li class="list__item" id="8a1001c0"><p>如果您使用对TeamCity执行HTTP <b id="79bbd9dd">GET请求的</b>非捆绑客户端，则某些GET请求（那些会更改服务器状态的请求，例如http：//server/action.html？add2Queue = XXX）将在2017.1停止工作，请更改请求以使用POST而不是GET；</p></li><li class="list__item" id="c0ff0935"><p>通过向请求提供<b id="dde61873">TCSESSIONID</b> cookie来重用身份验证的非浏览器客户端，需要进行更新以提供“ Origin” HTTP标头，该标头的值与发送请求的主机相同。如果检查失败，您将获得HTTP <b id="3bef0653">403响应</b>以及失败检查的详细信息。详细信息也将登录到teamcity-auth.log中。</p></li></ul></div><a name="OldIPRRunner"></a><a name="Old-IPR-Runner"></a><div class="chapter"><h3 id="UpgradeNotes-OldIPRRunner">旧的知识产权亚军</h3><p id="bbcaee47">旧的（TeamCity 6.0）IPR运行者已从TeamCity中删除。自TeamCity 6.0起已不推荐使用此选项，现在不再提供此选项，而现在它已完全消失（相应的构建配置将不再运行）。</p></div><a name="Log4jconfiguration"></a><a name="Log4j-configuration"></a><div class="chapter"><h3 id="UpgradeNotes-Log4jconfiguration">Log4j配置</h3><p id="17ea6e51">建议覆盖服务器的<code class="code">conf\teamcity-server-log4j.xml</code>文件的内容<code class="code">conf\teamcity-server-log4j.xml.dist</code>代表此版本中已更改的默认日志记录配置的文件。如果确实需要自定义日志记录配置，请考虑使用<a href="teamcity-server-logs.html">日志记录预设</a>而不是修改<code class="code">conf\teamcity-server-log4j.xml</code> 。</p><p id="b5eed47d">对于TeamCity代理，建议从同级.dist文件进行相同的覆盖。的<code class="code">conf\teamcity-*-log4j.xml.dist</code>在首次启动升级的TeamCity版本后创建文件。</p></div><a name="Buildsmetadatastorage(NuGetfeed)"></a><a name="Builds-metadata-storage-(NuGet-feed)"></a><div class="chapter"><h3 id="UpgradeNotes-Buildsmetadatastorage(NuGetfeed)">构建元数据存储（NuGet提要）</h3><p id="f91b022f">升级后，将重新创建内部版本元数据存储并重新建立内部版本的索引。结果，在升级之后，TeamCity内部的NuGet提要立即将不包含所有软件包。在重新建立版本的过程中，以下消息可能会出现在<code class="code">teamcity-server.log</code> ：</p><div class="code-block" data-lang="bash">INFO-.index。BuildIndexer（metadata）-将接下来的100个构建加入索引，向左构建：2000，最后一个构建ID：3813 INFO-.index。BuildIndexer（metadata）-将下100个构建用于排队，左构建：1900，最后一个构建ID：3713</div><p id="3fd49e50">“剩余版本数：”表示需要处理的剩余版本数。请注意，TeamCity从最新版本开始重新编制索引，因此所有新的版本都应在较短的时间内显示在TeamCity NuGet提要中。</p><p id="f21e4929">要提高元数据索引编制速度，您可以使用<a href="known-issues.html">以下技巧</a> 。</p></div><a name="RESTAPI"></a><a name="REST-API"></a><div class="chapter"><h3 id="UpgradeNotes-RESTAPI3">REST API</h3><p id="75d7d754">REST API仅有很小的更改，因此该API在<code class="code">app/rest/10.0</code>和<code class="code">/app/rest/2017.1</code>网址。 API版本已更新至2017.1，以反映更改。对于2017.1升级之后开始的构建，构建的节点“ triggeredBy”现在具有“ type”属性的更正确值。特别是，不再使用“ buildType”值，而是使用“ finishBuild”，“ snapshot”等值。</p></div><a name="VisualStudioAdd-infailstoinstallfromTeamCityUI"></a><a name="Visual-Studio-Add-in-fails-to-install-from-TeamCity-UI"></a><div class="chapter"><h3 id="UpgradeNotes-VisualStudioAdd-infailstoinstallfromTeamCityUI">Visual Studio加载项无法从TeamCity UI安装</h3><p id="6303a5a0">作为一种解决方法，可以使用<a href="https://www.jetbrains.com/resharper/download/#section=web-installer" rel="noopener noreferrer" data-external="true" target="_blank">ReSharper Web安装程序</a> 。有关详细信息，请参见<a href="https://youtrack.jetbrains.com/issue/TW-51680" rel="noopener noreferrer" data-external="true" target="_blank">TW-51680</a> 。</p></div></div><a name="Changesfrom10.0.4to10.0.5"></a><a name="Changes-from-10.0.4-to-10.0.5"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom10.0.4to10.0.5">从10.0.4更改为10.0.5</h2><p id="5d1d4228">如果您将TFS与代理端检出一起使用，请注意，由于<a href="https://youtrack.jetbrains.com/issue/TW-48555" rel="noopener noreferrer" data-external="true" target="_blank">TW-48555</a>的修复，TeamCity将不得不重新创建TFS工作区，这可能导致升级后代理上的干净检出。</p></div><a name="Changesfrom10.0.3to10.0.4"></a><a name="Changes-from-10.0.3-to-10.0.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom10.0.3to10.0.4">从10.0.3更改为10.0.4</h2><a name="Precedenceofdep.ID.NAMEparameterreferences"></a><a name="Precedence-of--dep.ID.NAME--parameter-references"></a><div class="chapter"><h3 id="UpgradeNotes-Precedenceofdep.ID.NAMEparameterreferences">％dep的优先级。ID.NAME％参数引用</h3><p id="3c833714">什么时候<code class="code">%dep.ID.NAME%</code>使用参数引用，并且具有ID为“ ID”的同一构建配置有多个依赖路径，因此可以通过（直接或间接）工件依赖项访问不同的构建，引用解析的结果可以使用任何构建而无需任何构建保证优先级。</p><p id="f811fe1d">自10.0.4起<code class="code">dep.</code>参数解析如下：</p><ol class="list _decimal"><li class="list__item" id="4f9133bb"><p>如果存在快照依赖关系，则以相同链为准。</p></li><li class="list__item" id="4d4ca1fd"><p>如果没有快照依赖关系，并且可以通过工件依赖关系访问多个构建，则该构建具有更大的<code class="code">buildId</code>胜。如果单个构建配置中存在多个工件依赖项，则仅考虑第一个。</p></li></ol></div><a name="Updates"></a><a name="Updates"></a><div class="chapter"><h3 id="UpgradeNotes-Updates">更新</h3><p id="cb365096">AWS开发工具包已更新至1.11.66，以支持新的实例类型（r4.4xlarge，f1.16xlarge，t2.2xlarge，t2.xlarge，r4.2xlarge，r4.xlarge，r4.large，r4.16xlarge，r4.8xlarge ，f1.2xlarge）。</p></div></div><a name="Changesfrom10.0.2to10.0.3"></a><a name="Changes-from-10.0.2-to-10.0.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom10.0.2to10.0.3">从10.0.2更改为10.0.3</h2><a name="AmazonEBSOptimizedInstances"></a><a name="Amazon-EBS-Optimized-Instances"></a><div class="chapter"><h3 id="UpgradeNotes-AmazonEBSOptimizedInstances">Amazon EBS优化实例</h3><p id="80e14994">自TeamCity 10.0起默认启用的<a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html" rel="noopener noreferrer" data-external="true" target="_blank">EBS优化</a>行为类似于EC2控制台提供的更改：</p><ol class="list _decimal"><li class="list__item" id="15646d4c"><p>默认情况下，EBS优化已打开<code class="code">c4.*</code> ， <code class="code">m4.*</code>和<code class="code">d2.*</code> （不可配置）。</p></li><li class="list__item" id="5c69373a"><p>默认情况下，任何其他实例类型的EBS优化都是关闭的。</p></li><li class="list__item" id="9bc2da98"><p>可以为支持它的实例打开EBS优化（例如<code class="code">c3.xlarge</code> ），方法是在配置Amazon云配置文件的映像时选中相应的框。</p></li></ol></div><a name="Bundledtoolsupdates"></a><a name="Bundled-tools-updates"></a><div class="chapter"><h3 id="UpgradeNotes-Bundledtoolsupdates">捆绑工具更新</h3><p id="a615e1dc">捆绑的dotCover已更新至版本2016.2.2</p></div></div><a name="Changesfrom10.0.1to10.0.2"></a><a name="Changes-from-10.0.1-to-10.0.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom10.0.1to10.0.2">从10.0.1更改为10.0.2</h2><ul class="list _ul"><li class="list__item" id="64680b8d"><p>为10.0.1提及的已知问题已修复。</p></li><li class="list__item" id="ed5ce56c"><p>捆绑的JetBrains dotCover已更新至版本2016.2。</p></li><li class="list__item" id="bb28ddb6"><p>现在，Jabber集成在SSL连接检查方面<a href="https://youtrack.jetbrains.com/issue/TW-47046" rel="noopener noreferrer" data-external="true" target="_blank">更具限制性</a> 。如果您使用jabber.org发送通知，并且遇到有关SSL证书的问题，则应启用“使用旧版SSL”选项或（更好）将JVM版本更改为至少运行1.8.0_101以运行TeamCity。</p></li><li class="list__item" id="7ad07eda"><p>％dep的优先级。在将多个不同的版本用作依赖项的情况下，ID.NAME％参数的解析无意中更改了。有关详细信息，请参见<a href="https://youtrack.jetbrains.com/issue/TW-47518" rel="noopener noreferrer" data-external="true" target="_blank">TW-47518</a> 。</p></li></ul></div><a name="Changesfrom10.0to10.0.1"></a><a name="Changes-from-10.0-to-10.0.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom10.0to10.0.1">从10.0更改为10.0.1</h2><p id="324a0965">10.0中提到的所有已知问题均已修复。</p><a name="KnownIssues"></a><a name="Known-Issues"></a><div class="chapter"><h3 id="UpgradeNotes-KnownIssues">已知的问题</h3><p id="e22d920c">（已在10.0.2中修复）如果将<a href="installing-agent-tools.html">代理工具</a>安装为< <a href="teamcity-data-directory.html">TeamCity数据目录</a> > /plugins/.tools中的目录，则可以填充TeamCity服务器的临时文件夹。<a href="http://youtrack.jetbrains.net/issue/TW-46648" rel="noopener noreferrer" data-external="true" target="_blank">详细信息和解决方法</a> 。</p></div></div><a name="Changesfrom9.1.xto10.0"></a><a name="Changes-from-9.1.x-to-10.0"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.1.xto10.0">从9.1.x更改为10.0</h2><a name="KnownIssues"></a><a name="Known-Issues"></a><div class="chapter"><h3 id="UpgradeNotes-KnownIssues2">已知的问题</h3><p id="6fd769b9">（这些已知问题已在10.0.1中修复）</p><a name="FailedtocollectTFSchanges-Fromversionxisgreaterthencurrentversiony"></a><a name="Failed-to-collect-TFS-changes---From-version--x--is-greater-then-current-version--y-"></a><div class="chapter"><h4 id="UpgradeNotes-FailedtocollectTFSchanges-Fromversionxisgreaterthencurrentversiony">无法收集TFS更改-版本<x>大于当前版本<y></y></x></h4><p id="7a59f5ea">如果您使用TFS版本控制并收到“错误收集VCS存储库的更改...无法收集TFS更改-从版本x大于当前版本y”错误，请提交新更改以使它出现在受影响的构建配置中，然后安装<a href="https://youtrack.jetbrains.com/issue/TW-46336#comment=27-1534797" rel="noopener noreferrer" data-external="true" target="_blank">更新的插件</a> （相关<a href="https://youtrack.jetbrains.com/issue/TW-46336" rel="noopener noreferrer" data-external="true" target="_blank">问题</a> ）。</p></div><a name="Projectadministratormaynotbeabletore-defineparametersinheritedfromtheparentproject"></a><a name="Project-administrator-may-not-be-able-to-re-define-parameters-inherited-from-the-parent-project"></a><div class="chapter"><h4 id="UpgradeNotes-Projectadministratormaynotbeabletore-defineparametersinheritedfromtheparentproject">项目管理员可能无法重新定义从父项目继承的参数</h4><p id="b88afdc4">有关详细信息和可能的解决方法，请参阅请求<a href="https://youtrack.jetbrains.com/issue/TW-46372" rel="noopener noreferrer" data-external="true" target="_blank">TW-46372</a> 。</p></div><a name="UpgradeformTeamCityversionbefore8.1failswith" canttakeexclusivelockwhendblockisnothel="" =""></a><a name="Upgrade-form-TeamCity-version-before-8.1-fails-with-" can-t-take-exclusive-lock-when-db-lock-is-not-hel="" =""></a><div class="chapter"><h4 id="UpgradeNotes-UpgradeformTeamCityversionbefore8.1failswith" canttakeexclusivelockwhendblockisnothel="" ="">在8.1之前的版本中升级TeamCity版本失败，并显示“未持有数据库锁时无法获取独占锁”</h4><p id="42faff62">有关详细信息和可能的解决方法，请参阅请求<a href="https://youtrack.jetbrains.com/issue/TW-46385" rel="noopener noreferrer" data-external="true" target="_blank">TW-46385</a> 。</p></div><a name="SubversionVCSrootswithsvnssh://protocolcanreport" hostkey(xxx)cannotbeverified="" =""></a><a name="Subversion-VCS-roots-with-svn-ssh://-protocol-can-report-" host-key-(xxx)-can-not-be-verified="" =""></a><div class="chapter"><h4 id="UpgradeNotes-SubversionVCSrootswithsvnssh://protocolcanreport" hostkey(xxx)cannotbeverified="" ="">带有svn + ssh：//协议的Subversion VCS根目录可以报告“无法验证主机密钥（xxx）”。</h4><p id="cc09f5cd">有关详细信息以及具有此修复程序的插件，请参见请求<a href="https://youtrack.jetbrains.com/issue/TW-46489" rel="noopener noreferrer" data-external="true" target="_blank">TW-46385</a></p></div></div><a name="Changesinagentpropertiesreporting.NET4.xruntime"></a><a name="Changes-in-agent-properties-reporting-.NET-4.x-runtime"></a><div class="chapter"><h3 id="UpgradeNotes-Changesinagentpropertiesreporting.NET4.xruntime">报告.NET 4.x运行时的代理属性更改</h3><p id="2e0d524d">每当在代理上安装任何4.x版本的.NET框架时，版本10之前的TeamCity代理便会报告DotNetFramework4.0_ *属性。从TeamCity 10开始，仅在安装4.0运行时（无更新）时才报告DotNetFramework4.0_ *属性。为4.5。*，4.6。*更新相应的DotNetFramework4。报告了N_ *个属性。这种行为上的变化允许更精确的需求定义。</p><p id="cca83450">如果在升级后，您获得了不兼容的代理， <b id="5b56482f">且未满足要求：Exists => DotNetFramework4.0_x86（/ x64）存在</b>消息，请查看构建配置中的明确要求。如果您的版本与任何.NET 4.x运行时兼容（这是最常见的情况），请使用<b id="3cd40ea8">Exists => DotNetFramework4。* _ x86（/ x64）</b>要求。如果您想在.NET 4.5+代理上运行-使用<b id="de0e1399">Exists => DotNetFramework4。（5 | 6）。*</b>要求。</p><p id="49f62b9d">已知某些第三方插件会受到影响。升级时，请确保将<b id="b73c5d55">xUnit</b>插件升级到版本<a href="https://github.com/carlpett/xUnit-TeamCity/releases/tag/1.1.2" rel="noopener noreferrer" data-external="true" target="_blank">1.1.2+</a></p></div><a name="Ignoredteststableoptimization"></a><a name="Ignored-tests-table-optimization"></a><div class="chapter"><h3 id="UpgradeNotes-Ignoredteststableoptimization">忽略测试表优化</h3><p id="7b95b1d2">在升级过程中，TeamCity将优化ignore_tests表中的数据（我们这样做是为了加快TeamCity内置的备份/还原过程）。在极少数情况下，当该表包含数百万行时，表优化过程可能会花费大量时间-可能需要几个小时。在其他数据中，该表包含将构建中的特定测试标记为已忽略的原因。如果有关旧版本的此信息对您不是很重要，则可以使用其他<a href="configuring-teamcity-server-startup-properties.html#JVM-Options">JVM选项</a>启动TeamCity服务器：<code class="code">-Dteamcity.truncateIgnoreReasonConverter.copyReasons=false</code></p><p id="ddeccf27">在这种情况下，TeamCity不会将忽略原因复制到新的优化表中，并且升级过程的这一特定步骤将运行得更快。</p></div><a name="Java8"></a><a name="Java-8"></a><div class="chapter"><h3 id="UpgradeNotes-Java8">Java 8</h3><p id="c8c1b5c8">从TeamCity 10开始，TeamCity服务器<b id="d948f564"><a href="supported-platforms-and-environments.html">需要Java 8</a></b> JRE / JDK（包含在Windows中） <code class="code">.exe</code>分配）。</p><p id="39c3c2d0"><b id="459e6f2b">TeamCity代理</b>当前需要Java 1.6+，但是从下一个TeamCity版本开始， <a href="supported-platforms-and-environments.html">代理上对Java</a>的最低要求将是Java 8（包含在代理的Windows中）。 <code class="code">.exe</code>分配）。建议您现在考虑升级代理Java。</p><p id="655be589"><b id="b07ce29c">Java内存选项更改</b></p><p id="47631053">建议删除“ <code class="code">-XX:MaxPermSize=..."</code> <a href="configuring-teamcity-server-startup-properties.html">的JVM选项</a> <code class="code">TEAMCITY_SERVER_MEM_OPTS</code>环境变量（如果先前已配置）。（这是由于Java 8 <a href="http://javaeesupportpatterns.blogspot.ru/2013/02/java-8-from-permgen-to-metaspace.html" rel="noopener noreferrer" data-external="true" target="_blank">不再使用</a>永久生成（PermGen）的事实）</p></div><a name="Agentrequirementsandartifactdependenciesdisabling"></a><a name="Agent-requirements-and-artifact-dependencies-disabling"></a><div class="chapter"><h3 id="UpgradeNotes-Agentrequirementsandartifactdependenciesdisabling">代理要求和工件依赖项禁用</h3><p id="2ae45af6">现在可以禁用代理要求和工件依赖关系。使用TeamCity 10之前版本的API的TeamCity插件和基于REST API的代码可能会忽略这些设置的禁用状态。</p></div><a name="TFS"></a><a name="TFS"></a><div class="chapter"><h3 id="UpgradeNotes-TFS">TFS</h3><p id="b8657a8c">TeamCity带有跨平台的TFS集成：使用TFS，您不再需要在Windows计算机上安装TeamCity服务器。</p></div><a name="VisualStudioOnlineWorkItemsplugin"></a><a name="Visual-Studio-Online-Work-Items-plugin"></a><div class="chapter"><h3 id="UpgradeNotes-VisualStudioOnlineWorkItemsplugin">Visual Studio在线工作项插件</h3><p id="282aeb46"><b id="2a9976fd">自TeamCity 10.0起，</b> Visual Studio Online Work Items插件已<b id="2a9976fd">过时</b> ，可以安全删除。TeamCity 10.0与<a href="https://confluence.jetbrains.com/display/TCD10/Team+Foundation+Work+Items" rel="noopener noreferrer" data-external="true" target="_blank">Team Foundation Work Items</a>具有内置的集成，该集成支持TFS 2010+和Visual Studio Team Services。升级后，TeamCity将检测到此插件的现有问题跟踪器连接，并将其转换为TFS工作项。</p></div><a name="DefaultCheckoutmodefornewlycreatedbuildconfigurations"></a><a name="Default-Checkout-mode-for-newly-created-build-configurations"></a><div class="chapter"><h3 id="UpgradeNotes-DefaultCheckoutmodefornewlycreatedbuildconfigurations">新创建的构建配置的默认Checkout模式</h3><p id="67976416">创建新的构建配置时，VCS检出模式的默认设置已更改：现在，TeamCity将在构建前检出代理上的源。如果无法进行代理端检出，TeamCity将使用服务器端检出。明确的服务器端或代理端检出仍然存在。新的默认设置仅适用于新创建的构建配置。所有现有的设备将按照之前的配置工作。</p></div><a name="Project-basedAgentManagementPermissions"></a><a name="Project-based-Agent-Management-Permissions"></a><div class="chapter"><h3 id="UpgradeNotes-Project-basedAgentManagementPermissions">基于项目的代理管理权限</h3><p id="534c7812">现在，新的TeamCity安装具有不同的代理管理权限分配：项目管理员角色不包括（全局）代理管理者角色。而是，项目管理员角色具有<a href="role-and-permission.html#Project-level-Agent-Management-Permissions">代理程序项目权限</a> ，该<a href="role-and-permission.html#Project-level-Agent-Management-Permissions">权限</a>允许从仅用户具有项目管理员角色的项目的代理程序池中管理代理程序。</p><p id="fed5f4b9">现有安装不受此更改的影响，以便不更改用户权限。但是，建议检查项目管理员角色，并考虑排除“代理管理器”角色，并添加以下权限：</p><ul class="list _ul"><li class="list__item" id="716bf17f"><p>启用/禁用与项目关联的代理</p></li><li class="list__item" id="0cea5049"><p>启动/停止项目的云代理</p></li><li class="list__item" id="7c741659"><p>更改项目的代理运行配置策略</p></li><li class="list__item" id="35427800"><p>管理项目代理计算机（例如，重新启动，查看代理日志）</p></li><li class="list__item" id="fa9d7b8c"><p>删除项目代理</p></li><li class="list__item" id="14783ea3"><p>授权项目代理</p></li></ul></div><a name="UIChanges"></a><a name="UI-Changes"></a><div class="chapter"><h3 id="UpgradeNotes-UIChanges">使用者介面变更</h3><a name="ServerAdministrationUI"></a><a name="Server-Administration-UI"></a><div class="chapter"><h4 id="UpgradeNotes-ServerAdministrationUI">服务器管理界面</h4><p id="3fcbaf76">新<b id="94ffcef1">政府|工具</b>页面允许设置适当的插件使用的工具。工具会自动分发给所有构建代理，并且可以在相关的运行器中使用。</p></div><a name="NewCreateproject/Createbuildconfigurationbuttons"></a><a name="New-Create-project-/-Create-build-configuration-buttons"></a><div class="chapter"><h4 id="UpgradeNotes-NewCreateproject/Createbuildconfigurationbuttons">新建创建项目/创建构建配置按钮</h4><p id="c1f2f54b">现在，新的“ <b id="7edfa2a2">创建”子项目</b>和“ <b id="af705f9a">创建”构建配置</b>按钮具有一个下拉菜单，您可以从中选择从头开始（手动），从URL还是使用流行的版本控制系统GitHub.com和Bitbucket创建项目。</p></div><a name="NuGet-relatedUI"></a><a name="NuGet-related-UI"></a><div class="chapter"><h4 id="UpgradeNotes-NuGet-relatedUI">NuGet相关的UI</h4><p id="52dd9a2f">NuGet设置页面已删除。可以使用新的“ <b id="44ea2fd7">工具”</b>页面安装NuGet.exe。要将TeamCity设置为NuGet服务器，请转到“ <b id="785a36e7">管理”</b> |“设置”。 <b id="c24f8bc5">NuGet Feed</b>页面。</p></div><a name="Tests-relatedUI"></a><a name="Tests-related-UI"></a><div class="chapter"><h4 id="UpgradeNotes-Tests-relatedUI">与测试相关的UI</h4><p id="87435adf">问题测试选项卡不再可用，并且从当前问题选项卡中删除了查看最近120小时内所有测试失败的链接。</p><p id="ad03a52b">现在，TeamCity可以检测给定项目的专用选项卡上显示的<a href="viewing-tests-and-configuration-problems.html">易碎测试</a> 。</p></div></div><a name="VisualStudioAdd-in"></a><a name="Visual-Studio-Add-in"></a><div class="chapter"><h3 id="UpgradeNotes-VisualStudioAdd-in">Visual Studio加载项</h3><p id="5dcf1506">不再支持TeamCity Visual Studio外接程序的旧版本。不支持Visual Studio 2005和2008。</p><p id="0d258a76">TeamCity Visual Studio加载项<a href="visual-studio-addin.html">作为ReSharper Ultimate的一部分提供</a> 。安装后，将在Visual Studio的RESHARPER菜单下提供TeamCity加载项。</p><p id="e9917907">请注意，安装程序将删除捆绑产品之前的版本：9.0之前的TeamCity和ReSharper版本，3.0之前的dotCover，6.0之前的dotTrace。ReSharper Ultimate不支持Visual Studio版本2005和2008。</p></div><a name="IntelliJIDEACompatibility"></a><a name="IntelliJ-IDEA-Compatibility"></a><div class="chapter"><h3 id="UpgradeNotes-IntelliJIDEACompatibility">IntelliJ IDEA兼容性</h3><p id="30114c73">IntelliJ <a href="https://confluence.jetbrains.com/" rel="noopener noreferrer" data-external="true" target="_blank">Platform Plugin</a>不再支持IntelliJ IDEA 12.1和更早版本以及2013年之前发布的其他基于IntelliJ的产品。</p></div><a name="Snapshotdependenciesbuildsrebuilding"></a><a name="Snapshot-dependencies-builds-rebuilding"></a><div class="chapter"><h3 id="UpgradeNotes-Snapshotdependenciesbuildsrebuilding">快照依赖关系会重建</h3><p id="152a1332">服务器升级后，即使快照依赖项的“如果有合适的选项，则不要运行新的生成”选项设置为“ ON”，则可能会重建用作快照依赖项的生成。这样做是为了解决<a href="https://youtrack.jetbrains.com/issue/TW-43226" rel="noopener noreferrer" data-external="true" target="_blank">问题</a> 。</p></div><a name="Perforce"></a><a name="Perforce"></a><div class="chapter"><h3 id="UpgradeNotes-Perforce">Perforce</h3><p id="876b8678">在基于Stream和基于客户端的Perforce VCS Root的构建中，将强制执行干净签出。</p></div><a name="Subversion"></a><a name="Subversion"></a><div class="chapter"><h3 id="UpgradeNotes-Subversion">颠覆</h3><p id="36beebc0">从TeamCity 10开始，TeamCity默认不接受通过https：//协议使用不可信服务器SSL证书访问的SVN服务器的连接。要启用使用此类证书的访问，您应该将证书导入服务器JVM钥匙串，或启用VCS根选项“ <b id="e322ea9b">接受不受信任的SSL证书</b> ”（在10.0中启用不受信任的SSL证书）（ <a href="https://youtrack.jetbrains.com/issue/TW-45592" rel="noopener noreferrer" data-external="true" target="_blank">问题</a> ）。</p></div><a name="Bundledtoolsupdates"></a><a name="Bundled-tools-updates"></a><div class="chapter"><h3 id="UpgradeNotes-Bundledtoolsupdates2">捆绑工具更新</h3><p id="de6d473e">Ant Runner：捆绑的Ant发行版已从1.9.6升级到1.9.7</p><p id="61b8cea7">.NET dotCover覆盖范围：捆绑的dotCover更新至2016.1</p><p id="9adc8953">ReSharper命令行工具：捆绑的R＃CLT已更新为2016.1</p><p id="a1759e01">Java检查和重复：捆绑的IntelliJ IDEA已更新至2016.2</p></div><a name="GitHubIssueTracker"></a><a name="GitHub-Issue-Tracker"></a><div class="chapter"><h3 id="UpgradeNotes-GitHubIssueTracker">GitHub问题追踪器</h3><p id="400a1673">如果您在TeamCity 10.0之前使用TeamCity-GitHub <a href="https://github.com/milgner/TeamCityGithub" rel="noopener noreferrer" data-external="true" target="_blank">第三方插件</a> ，则可以安全地<a href="installing-additional-plugins.html">删除</a>它：内置的TeamCity集成将检测到与GitHub问题跟踪器的现有连接并自动获取您的设置。</p></div><a name="NuGetSupport"></a><a name="NuGet-Support"></a><div class="chapter"><h3 id="UpgradeNotes-NuGetSupport">NuGet支持</h3><p id="372ff603">配置参数<code class="code">teamcity.tool.NuGet.CommandLine.%NUGET_VERSION%.nupkg</code>没有报道了。的<code class="code">teamcity.tool.NuGet.CommandLine.%NUGET_VERSION%</code>参数应改为引用。</p><p id="2e582f56">例如，代替使用<code class="code">%teamcity.tool.NuGet.CommandLine.DEFAULT.nupkg%</code>参数参考<code class="code">%teamcity.tool.NuGet.CommandLine.DEFAULT%</code>应该使用。</p></div><a name="BuildStatistics"></a><a name="Build-Statistics"></a><div class="chapter"><h3 id="UpgradeNotes-BuildStatistics">建立统计</h3><p id="cb3ab4dc">几个统计值（指标）已被重新设计并重命名：</p><ul class="list _ul"><li class="list__item" id="69f3ef7f"><p><code class="code">BuildCheckoutTime</code>进入<code class="code">buildStageDuration:sourcesUpdate</code></p></li><li class="list__item" id="669b01e5"><p><code class="code">BuildArtifactsPublishingTime</code>进入<code class="code">buildStageDuration:artifactsPublishing</code></p></li><li class="list__item" id="007c7ff8"><p><code class="code">ArtifactsResolvingTime</code>进入<code class="code">buildStageDuration:dependenciesResolving</code></p></li></ul><p id="c5b3b77a">图表定义仍支持旧键。</p></div><a name="RESTAPI"></a><a name="REST-API"></a><div class="chapter"><h3 id="UpgradeNotes-RESTAPI4">REST API</h3><p id="1d2e2c8e">REST API使用版本10.0。该API的先前版本仍然可以在<code class="code">/app/rest/9.1</code> ， <code class="code">/app/rest/9.0</code> ， <code class="code">/app/rest/8.1</code> ， <code class="code">/app/rest/7.0</code> ， <code class="code">/app/rest/6.0</code>网址。</p><p id="5e7e4380">定位器寻址单个项目的请求（先前导致404响应）现在将返回一个空集，作为更一致的方法。例如， <code class="code">.../app/rest/builds?locator=id:<non-existent build id></code> 。REST调试日志记录可能包含有关该情况的更多详细信息的诊断消息。</p><p id="12a5a88c">请求商品集<b id="b0b8fba8">可能不会返回全部/不完整的结果</b> （包括零个或多个商品）并提供<code class="code">nextHref</code>带有链接的子元素，以检索项目的下一个“页面”。否时搜索结果完成<code class="code">nextHref</code>提供了子元素。</p><p id="59f337d2">对项目集的一些要求（例如... <code class="code">/app/rest/vcs-roots</code>和... / <code class="code">app/rest/vcs-root-instances</code> ）在没有定位符（它们用于列出所有项目）的情况下进行查询时，默认情况下将使用分页结果。添加“ <code class="code">count:NNN"</code>定位器尺寸以设置页面大小。</p><p id="dccc824a"><b id="256c4b4e">寻找建物</b> （ <code class="code">.../app/rest/builds/...</code>网址）<br>当执行构建扫描以查找与指定定位符匹配的构建时，出于性能原因，默认情况下，TeamCity将返回部分结果，该结果仅扫描5000个最新构建而受到限制。要处理历史记录的较大部分，请检查<code class="code">nextHref</code>属性返回或设置<code class="code">lookupLimit</code>定位器尺寸较大。<br>以前，除非特别要求从非默认分支进行构建以及取消构建，否则不会返回个人构建和启动失败的构建。现在，默认情况下将返回这些过滤出的内部版本，以用于运行和排队的内部版本查询以及按代理或用户进行过滤时。使用<code class="code">defaultFIlter:true/false</code>定位器维度以显式管理默认过滤。<br>也， <code class="code">number:NNN</code>定位器现在遵循相同的默认逻辑：通过编号仅搜索默认分支中“正常”完成的构建，如果找到，则可以返回多个构建。</p><p id="34fcc8a5"><b id="44f7884b">查找VCS根目录</b> （ <code class="code">.../app/rest/vcsRoots/... URL</code> ）（次要）<br>VCS根定位器具有<code class="code">project</code>和<code class="code">buildType</code>指定使用<code class="code">project</code>作为寻找的背景<code class="code">buildType</code> 。情况已不再如此<code class="code">buildType</code>定位器应该是完整的，可以找到构建配置。</p><p id="0a0f028c"><b id="7104f1b8">构建配置的工件依赖关系</b> （由所返回的实体<code class="code">.../app/rest/buildTypes/...</code>网址）<br>的<code class="code">artifact-dependencies</code>的子元素<code class="code">buildType</code>元素现在使用文本生成的ID而不是数字ID（取决于先前的顺序）。这也会影响对工件依赖项修改的请求。<br>的<code class="code">agent-requirements</code>的子元素<code class="code">buildType</code>元素现在使用生成的ID代替参数名称作为ID。这也会影响对座席需求修改的请求。</p><p id="a29e781a"><b id="b63b8196">编辑代理要求</b> （ <code class="code">.../app/rest/buildTypes/.../artifact-requirements/...</code>网址）<br>以前，在为同一参数添加新的代理要求时，现有的代理要求将被新的代理要求覆盖；现在添加了一个新的。以前，在添加新的座席要求时，参数名称是从<code class="code">id</code>的属性<code class="code">agent-requirement</code>节点。从TeamCity 10开始，参数名称是从“ <code class="code">property-name</code> ”属性。</p><p id="55fa40c5"><b id="890e2949">测试和问题发生</b> （ <code class="code">.../app/rest/testOccurrences</code> ， <code class="code">.../app/rest/problemOccurrences</code>网址）<br>与以前的版本相比，某些查询返回的结果的排序已更改。例如， <code class="code">"../app/rest/testOccurrences?locator=build:(xxx)</code> ”请求现在按在构建中运行的顺序返回测试。<br>以前，测试发生是按新状态然后按名称排序的。问题发生按问题ID排序。<br>另外， <code class="code">build</code>与测试/问题相关的定位器中的维度现在支持多个版本，因此对于通过“ <code class="code">build</code> ”维度，将处理所有构建；之前仅处理了第一个匹配的构建。</p><p id="49e2648d"><b id="6668f1ef">实体</b><br>的<code class="code">property</code>实体过去具有其“自己的”布尔属性，该属性指示相对于从模板/项目继承而言，是否在构建配置中重新定义了参数。现在，该属性已重命名为“ <code class="code">inherited</code> '，并且其值取反。<br>的<code class="code">vcs-root</code>和<code class="code">vcs-root-instance</code>曾经有过<code class="code">status</code>和<code class="code">lastChecked</code>属性。现在，VCS根实例具有<code class="code">status</code>元素（带有<code class="code">current</code>具有的节点<code class="code">status</code>和<code class="code">timestamp</code>属性），并且VCS根目录没有数据，因为在多个VCS根实例的情况下，它会产生不确定的结果。<br>的<code class="code">test</code>实体<code class="code">id</code>成为Sring而不是Long（由于<a href="https://youtrack.jetbrains.com/issue/TW-42028" rel="noopener noreferrer" data-external="true" target="_blank">无法</a>在JavaScript中表示某些Java Long值）</p><p id="f8c0a8e9"><b id="cc0af37b">构建类型和模板</b><br>的<code class="code">settings</code>节点，用于包含所有受支持的设置。现在，仅显示在构建配置或模板中定义的内容。情况也是如此<code class="code">.../app/rest/buldTypes/XXX/settings/*</code>请求：仅显示从默认值更改的值。</p><p id="cde43ce4"><b id="ee491f02">兼容的代理商</b><br>查询兼容代理时，现在仅返回可以实际运行构建的代理。默认情况下，未列出未授权，已断开连接和已禁用的代理。此行为不同于以前的版本，后者存在许多差异。受影响的请求和实体： <code class="code">.../app/rest/agents?locator=compatible:(...)</code> ; <code class="code">../app/rest/agents/.../compatibleBuildTypes</code>和<code class="code">incompatibleBuildTypes</code> ;嵌套节点<code class="code">Agent.compatibleBuildTypes</code> ， <code class="code">QueuedBuild.compatibleAgents</code> ， <code class="code">BuildType.compatibleAgents</code> 。</p></div></div><a name="Changesfrom9.1.6to9.1.7"></a><a name="Changes-from-9.1.6-to-9.1.7"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.1.6to9.1.7">从9.1.6到9.1.7的变化</h2><p id="c4a19ccc">没有值得注意的变化。</p></div><a name="Changesfrom9.1.5to9.1.6"></a><a name="Changes-from-9.1.5-to-9.1.6"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.1.5to9.1.6">从9.1.5到9.1.6的变化</h2><a name="KnownIssues"></a><a name="Known-Issues"></a><h4 id="UpgradeNotes-KnownIssues3">已知的问题</h4><p id="8c600d3b">在Windows XP和Vista上运行的捆绑式dotCover中存在一个<a href="https://youtrack.jetbrains.com/issue/TW-43731" rel="noopener noreferrer" data-external="true" target="_blank">已知问题</a> 。您可以使用此<a href="https://youtrack.jetbrains.com/issue/TW-43731#comment=27-1286417" rel="noopener noreferrer" data-external="true" target="_blank">修复程序</a>或提供的<a href="https://youtrack.jetbrains.com/issue/TW-43731#comment=27-1286522" rel="noopener noreferrer" data-external="true" target="_blank">解决方法</a> 。该问题将在下一个dotCover版本中修复。</p><p id="24009f91"><a href="https://confluence.jetbrains.com/display/TCD9/NuGet+Feed+Credentials" rel="noopener noreferrer" data-external="true" target="_blank">NuGet凭据</a>存在一个<a href="https://youtrack.jetbrains.com/issue/TW-44479" rel="noopener noreferrer" data-external="true" target="_blank">已知问题</a> ，不适用于本地代理上的内部TeamCity NuCet服务器的Authenticated Feed URL。解决方法，而不是使用<code class="code">%teamcity.nuget.feed.auth.server%</code> ，请在构建步骤和构建功能中指定外部服务器URL。</p><a name="NuGet"></a><a name="NuGet"></a><h4 id="UpgradeNotes-NuGet">NuGet</h4><p id="ae909ad3">NuGet 2.8.6之前的版本要求在构建代理上安装.Net Framework 4.0 +，NuGet 2.8.6及更高版本需要.NET 4.5。</p><a name="NUnit"></a><a name="NUnit"></a><h4 id="UpgradeNotes-NUnit">NUnit</h4><p id="cb43194f">从9.1.6版开始，TeamCity不支持NUnit 3 Beta版（在NUnit 3.0.0之前发行）。</p><p id="4c59d8cb"><a href="nunit.html">NUnit</a>运行器的“每个程序集运行一个进程”选项已从NUnit 3设置中删除。在<a href="nunit.html">相应字段中</a>使用所需的<a href="https://github.com/nunit/nunit/wiki/Console-Command-Line" rel="noopener noreferrer" data-external="true" target="_blank">命令行选项</a>配置所需的行为。</p><a name="Bundledtoolsupdates"></a><a name="Bundled-tools-updates"></a><h4 id="UpgradeNotes-Bundledtoolsupdates3">捆绑工具更新</h4><p id="29f4c9d0">捆绑的IntelliJ IDEA已更新至版本143.1945（大致等效于15.0.3，并具有一些其他修复程序）。</p><p id="dfabc053">Maven 3.2.x的捆绑版本已更新至3.2.5。</p><a name="PerformanceMonitor"></a><a name="Performance-Monitor"></a><h4 id="UpgradeNotes-PerformanceMonitor">性能监控器</h4><a name="Noteonpermissions:tomonitorperformanceofabuildagentrunasaWindowsservice,makesuretheuserstartingtheagentismemberofthePerformanceMonitorUsersgroup."></a><a name="Note-on-permissions:-to-monitor-performance-of-a-build-agent-run-as-a-Windows-service,-make-sure-the-user-starting-the-agent-is-member-of-the-Performance-Monitor-Users-group."></a><h4 id="UpgradeNotes-Noteonpermissions:tomonitorperformanceofabuildagentrunasaWindowsservice,makesuretheuserstartingtheagentismemberofthePerformanceMonitorUsersgroup.">权限说明：要监视作为Windows服务运行的构建代理的性能，请确保启动代理的用户是Performance Monitor Users组的成员。</h4></div><a name="Changesfrom9.1.4to9.1.5"></a><a name="Changes-from-9.1.4-to-9.1.5"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.1.4to9.1.5">从9.1.4到9.1.5的变化</h2><a name="KnownIssues"></a><a name="Known-Issues"></a><h4 id="UpgradeNotes-KnownIssues4">已知的问题</h4><p id="89dd5f9a">在Windows XP和Vista上运行的捆绑式dotCover中存在一个<a href="https://youtrack.jetbrains.com/issue/TW-43731" rel="noopener noreferrer" data-external="true" target="_blank">已知问题</a> 。您可以使用此<a href="https://youtrack.jetbrains.com/issue/TW-43731#comment=27-1286417" rel="noopener noreferrer" data-external="true" target="_blank">修复程序</a>或提供的<a href="https://youtrack.jetbrains.com/issue/TW-43731#comment=27-1286522" rel="noopener noreferrer" data-external="true" target="_blank">解决方法</a> 。该问题将在下一个dotCover版本中修复。</p><a name="Producticons"></a><a name="Product-icons"></a><h4 id="UpgradeNotes-Producticons">产品图标</h4><p id="13a17692">JetBrains产品图标将根据<a href="http://blog.jetbrains.com/blog/2015/12/10/the-drive-to-develop/" rel="noopener noreferrer" data-external="true" target="_blank">新的JetBrains品牌</a>进行更新。</p><a name="Git"></a><a name="Git"></a><h4 id="UpgradeNotes-Git">吉特</h4><p id="36f9241f">自TeamCity 9.1.5起， <code class="code">git sparse-checkout</code>默认情况下<a href="https://youtrack.jetbrains.com/issue/TW-43330#comment=27-1229510" rel="noopener noreferrer" data-external="true" target="_blank">处于禁用状态</a> 。要在TeamCity项目中启用它，请添加<code class="code">teamcity.git.useSparseCheckout=true</code>该项目的<a href="https://confluence.jetbrains.com/display/TCD9/Project+and+Agent+Level+Build+Parameters#ProjectandAgentLevelBuildParameters-ProjectLevelBuildParameters" rel="noopener noreferrer" data-external="true" target="_blank">参数</a> 。</p><a name="Gradle:Breakingchangecomparedto9.1.2"></a><a name="Gradle:-Breaking-change-compared-to-9.1.2"></a><h4 id="UpgradeNotes-Gradle:Breakingchangecomparedto9.1.2">摇篮：与9.1.2相比具有重大变化</h4><p id="48a06474">摇篮赛跑者<code class="code">system.*</code> <a href="gradle.html">性能</a> ，在<b id="ffe26337">TeamCity的9.1.2</b>推出，为构建作为摇篮过程的JVM的系统属性定义，不会<b id="82210cc6">因为9.1.5</b>工作。现在，可以在Gradle脚本中将TeamCity系统属性作为Gradle属性进行访问（类似于在<code class="code">gradle.properties</code>文件），并按以下方式引用：</p><p id="20c70175">a）允许作为Groovy标识符的名称（属性名称不包含点）：<code class="code">customUserProperty</code><br>b）名称不允许用作Groovy标识符（属性名称包含点，例如<code class="code">build.vcs.number.1</code> ）：<code class="code">project.ext["build.vcs.number.1"]</code></p><a name="Bundledtoolsupdates"></a><a name="Bundled-tools-updates"></a><h4 id="UpgradeNotes-Bundledtoolsupdates4">捆绑工具更新</h4><p id="355bde84">捆绑的JetBrains IntelliJ IDEA（IDEA检查和重复）已更新至版本15.0.2。</p><a name=".Nettoolsupdates"></a><a name=".Net-tools-updates"></a><h4 id="UpgradeNotes-.Nettoolsupdates">.Net工具更新</h4><p id="a4f4c02a">JetBrains ReSharper命令行工具（.NET检查和重复项）已更新，以匹配ReSharper 10.0.2版本TeamCity Visual Studio插件Web安装程序已更新到ReSharper 10.0.2版本捆绑的JetBrains dotCover已更新到版本10.0.2</p></div><a name="Changesfrom9.1.3to9.1.4"></a><a name="Changes-from-9.1.3-to-9.1.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.1.3to9.1.4">从9.1.3到9.1.4的变化</h2><a name="KnownIssues"></a><a name="Known-Issues"></a><h4 id="UpgradeNotes-KnownIssues5">已知的问题</h4><p id="688cfa25">某些角色/权限配置可能会导致角色加载错误，并且普通用户无法查看项目。在这种情况下，对于以服务器管理员身份登录的用户，服务器管理页面上会显示“ <b id="62a65707">角色间检测到循环引用</b> ”的严重服务器错误。请检查该问题的<a href="https://youtrack.jetbrains.com/issue/TW-43186#comment=27-1211556" rel="noopener noreferrer" data-external="true" target="_blank">解决方法</a> 。</p><p id="7f276e9d"><b id="677f02aa">当Git代理方的结帐</b>可能会发生故障（在<a href="https://youtrack.jetbrains.com/issue/TW-43202" rel="noopener noreferrer" data-external="true" target="_blank">TW-43202</a>处有详细信息） <code class="code">teamcity.git.use.native.ssh=true</code>参数是在构建配置或代理配置中指定的。要解决此问题，请安装Git插件的<a href="https://teamcity.jetbrains.com/viewType.html?buildTypeId=TeamCityPluginsByJetBrains_Git_JetBrainsGitPluginTeamCity91x" rel="noopener noreferrer" data-external="true" target="_blank">＃snapshot-34</a>构建。</p><p id="e894b8df"><b id="5f4bab58">Git代理端检出</b>不适用于git客户端版本1.7.0-1.7.4：检出目录仅包含文件，所有目录均丢失（详细信息在<a href="https://youtrack.jetbrains.com/issue/TW-43330" rel="noopener noreferrer" data-external="true" target="_blank">TW-43330</a> ）。要解决此问题，请添加<code class="code">teamcity.git.useSparseCheckout=false</code> Root TeamCity项目中的参数。</p><a name="TeamCityWindowsbinariessignatures"></a><a name="TeamCity-Windows-binaries-signatures"></a><h4 id="UpgradeNotes-TeamCityWindowsbinariessignatures">TeamCity Windows二进制签名</h4><p id="662194ad">从9.1.4开始，TeamCity Windows二进制文件按照<a href="http://social.technet.microsoft.com/wiki/contents/articles/32288.windows-enforcement-of-authenticode-code-signing-and-timestamping.aspx" rel="noopener noreferrer" data-external="true" target="_blank">Microsoft SHA-2策略</a>使用SHA-2代码签名证书进行签名。这意味着，在Windows XP SP3之前的系统上，可执行文件将不通过代码签名验证。较新的Windows系统要求Microsoft提供相应的安全更新。</p><a name="Bundledtoolsupdates"></a><a name="Bundled-tools-updates"></a><h4 id="UpgradeNotes-Bundledtoolsupdates5">捆绑工具更新</h4><p id="8ed34592">捆绑的Oracle JRE（在Server和Agent.exe安装程序中）已更新至版本1.8.0_66（32位）</p><a name=".Nettoolsupdates"></a><a name=".Net-tools-updates"></a><h4 id="UpgradeNotes-.Nettoolsupdates2">.Net工具更新</h4><p id="f480a8d8">JetBrains ReSharper命令行工具（.NET检查和重复项）已更新，以匹配ReSharper 10.0版本</p><p id="2c07e77d">TeamCity Visual Studio插件Web安装程序已更新到ReSharper 10.0版本</p><p id="38e170fd">捆绑的JetBrains dotCover已更新至版本10.0</p></div><a name="Changesfrom9.1.2to9.1.3"></a><a name="Changes-from-9.1.2-to-9.1.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.1.2to9.1.3">从9.1.2到9.1.3的变化</h2><a name="KnownIssues"></a><a name="Known-Issues"></a><h4 id="UpgradeNotes-KnownIssues6">已知的问题</h4><p id="e5adc8de">捆绑的dotCover 3.2中存在一个<a href="https://youtrack.jetbrains.com/issue/DCVR-7708" rel="noopener noreferrer" data-external="true" target="_blank">已知问题</a> ，可能会导致构建失败，但以下情况除外：“系统。安全。VerificationException：系统。安全。VerificationException：操作可能会破坏运行时的稳定性”。与TeamCity 9.1.4版本捆绑在一起的dotCover 10.0中解决了该问题。</p><p id="9af4293b">捆绑的JVM（服务器Windows安装程序和Agent Windows安装程序）已更新，这导致禁用了用于传出HTTPS连接的SSL RC4芯片组。例如，这使与CloudForge SVN服务器的连接不起作用，并显示“ SSLHandshakeException：收到致命警报：handshake_failure”错误。 （ <a href="https://youtrack.jetbrains.com/issue/TW-42577" rel="noopener noreferrer" data-external="true" target="_blank">详细</a> ）</p><p id="b894e3df">从9.1.1到9.1.2的变化</p><a name="Knownissues"></a><a name="Known-issues"></a><h4 id="UpgradeNotes-Knownissues14">已知的问题</h4><p id="70fe7106">如果命令行运行程序在脚本开头指定了非默认的hashbang，则它可能无法执行自定义脚本： <a href="https://youtrack.jetbrains.com/issue/TW-42498" rel="noopener noreferrer" data-external="true" target="_blank">TW-42498</a></p><p id="0ebb7e43">使用Amazon EC2云集成时，包含构建代理版本9.1.2-9.1.5的AMI映像将出现两次，名称为EC2-i-abcdefgh和EC2-i-abcdefgh-1，消耗2个许可证。要解决此问题，请使用带有代理9.1.6+的AMI映像。如果AMI保持不变，仅将服务器更新到9.1.6不会有帮助。 （ <a href="https://youtrack.jetbrains.com/issue/TW-43992" rel="noopener noreferrer" data-external="true" target="_blank">详细</a> ）</p><a name="Buildstatusicons"></a><a name="Build-status-icons"></a><h4 id="UpgradeNotes-Buildstatusicons">生成状态图标</h4><p id="304935ba">生成状态图标已更新为更“标准”的外观，并且现在更大了。</p><a name="Bundledtoolsupdates"></a><a name="Bundled-tools-updates"></a><h4 id="UpgradeNotes-Bundledtoolsupdates6">捆绑工具更新</h4><p id="fc9853c2">JetBrains ReSharper命令行工具（.NET检查和重复项）已更新，以匹配ReSharper 9.2版本</p><p id="290d231c">TeamCity Visual Studio插件Web安装程序已更新到ReSharper 9.2版本</p><p id="28ab63c9">捆绑的JetBrains dotCover已更新至版本3.2</p><p id="7838bad3">捆绑的Oracle JRE（在服务器和代理.exe安装程序中）已更新至版本1.8.0_60（32位）</p></div><a name="Changesfrom9.1to9.1.1"></a><a name="Changes-from-9.1-to-9.1.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.1to9.1.1">从9.1到9.1.1的变化</h2><p id="bb4d9a91">捆绑的Jacoco覆盖库已更新至版本0.7.5</p><p id="48f641c8">如果在Perforce服务器上禁用了密码身份验证，则具有禁用票证身份验证的Perforce VCS Root将不再运行“ p4登录”操作。<br>即，如果禁用了密码身份验证，则必须在VCS根目录上启用“使用基于滴答的身份验证”选项。<a href="https://youtrack.jetbrains.com/issue/TW-42818" rel="noopener noreferrer" data-external="true" target="_blank">TW-42818</a></p></div><a name="Changesfrom9.0.xto9.1"></a><a name="Changes-from-9.0.x-to-9.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.0.xto9.1">从9.0.x更改为9.1</h2><a name="BundledAnt"></a><a name="Bundled-Ant"></a><h4 id="UpgradeNotes-BundledAnt">捆绑蚂蚁</h4><p id="4ee8235e">捆绑的Ant发行版已从1.8.4升级到1.9.6。请注意，在服务器升级之后，使用捆绑的Ant的Ant构建步骤将使用另一个版本的Ant。Ant 1.9.6至少需要Java 1.5，因此使用Ant并在Java 1.4下运行的构建将停止工作。</p><a name="MSTestrunnerconvertedintoVisualStudioTestsrunner"></a><a name="MSTest-runner-converted-into-Visual-Studio-Tests-runner"></a><h4 id="UpgradeNotes-MSTestrunnerconvertedintoVisualStudioTestsrunner">MSTest运行程序转换为Visual Studio Tests运行程序</h4><p id="74f4d4f1">MSTest运行器与<a href="https://confluence.jetbrains.com/display/TW/VSTest.Console+Runner" rel="noopener noreferrer" data-external="true" target="_blank">VSTest控制台运行器</a> （以前作为单独的插件提供）合并到了<a href="visual-studio-tests.html">Visual Studio Tests运行器中</a> 。请注意，升级到TeamCity 9.1后，MSTest构建步骤将自动转换为Visual Studio Tests运行器步骤，而VSTest步骤保持不变。</p><aside class="note " rel="74f4d4f1" id="468df5cd" data-title=""><p id="646b84b3">如果您使用了<a href="https://confluence.jetbrains.com/display/TW/VSTest.Console+Runner" rel="noopener noreferrer" data-external="true" target="_blank">VSTest.Console运行程序插件</a> ，请确保已安装最新版本（内部版本<b id="a88ee869">32407</b> ）。可以在“ <b id="d9740960">管理” |“</b>查看”中查看插件版本<b id="d9740960">。插件列表</b>页面。该插件的较早版本与TeamCity 9.1 <b id="ff1ba926">不兼容</b> ，并且可能会导致与.NET相关的构建运行器发生故障，并可能与<code class="code">java.lang.NoSuchMethodError: jetbrains.buildServer.runner.NUnit.NUnitVersion.parse(Ljava/lang/String;)</code>建立错误。该插件可以<a href="https://confluence.jetbrains.com/display/TW/VSTest.Console+Runner" rel="noopener noreferrer" data-external="true" target="_blank">从其页面</a>下载。考虑将vstest.console的执行步骤迁移到捆绑的Visual Studio Tests运行程序中。</p></aside><a name="MSTestinstallationagentproperties"></a><a name="MSTest-installation-agent-properties"></a><h4 id="UpgradeNotes-MSTestinstallationagentproperties">MSTest安装代理属性</h4><p id="f05bb03f">TeamCity代理会自动检测已安装的MSTest，并用于公开其中的位置<code class="code">system.MSTest.N.N</code>系统属性。</p><p id="04c3ddc5"><b id="2296edb9">从TeamCity 9.1开始</b> ，这些位置通过<code class="code">teamcity.dotnet.mstest.N.N</code>配置参数。如果您不能轻松更改属性用法，请检查<a href="https://youtrack.jetbrains.com/issue/TW-41845" rel="noopener noreferrer" data-external="true" target="_blank">TW-41845</a> 。</p><a name="Nestedtestreporting"></a><a name="Nested-test-reporting"></a><h4 id="UpgradeNotes-Nestedtestreporting">嵌套测试报告</h4><p id="e97b9b10">以前，TeamCity支持使用<a href="build-script-interaction-with-teamcity.html">服务消息</a>从另一个测试中报告一个测试的情况。现在，在修复<a href="https://youtrack.jetbrains.com/issue/TW-40319" rel="noopener noreferrer" data-external="true" target="_blank">TW-40319之后</a> ，开始另一个测试将以相同的“流程”完成当前启动的测试。要仍然从其他测试中报告测试，则需要在嵌套的测试服务消息中指定另一个<a href="build-script-interaction-with-teamcity.html">flowId</a> 。</p><a name="RESTAPI"></a><a name="REST-API"></a><h4 id="UpgradeNotes-RESTAPI5">REST API</h4><p id="dbfcb035">REST API使用9.1版。以前版本的API仍在<code class="code">/app/rest/9.0</code> ， <code class="code">/app/rest/8.1</code> ， <code class="code">/app/rest/7.0</code> ， <code class="code">/app/rest/6.0</code>网址。</p><p id="6e6028cf"><b id="a4ab42e1">寻找建筑</b><br>摘要（tl; dr）：一些构建过滤规则有细微的变化。最重要的是，当按内部版本ID搜索并且“项目”定位符维度的含义已更改为非递归时，现在可以返回排队的内部版本而不是404。此外，直到指定了“ failedToStart：any”定位器维度之后，现在才包括无法启动失败的构建。</p><p id="2b775b74">细节：<br>受影响的请求：/ app / builds / <locator>...，/ app / builds？locator = <locator>，/ app / buildTypes / <btlocator>/ builds和其他带有构建定位器的对象</btlocator></locator></locator></p><p id="ba299ff7">定位器：id： <number>或taskId：<number></number></number></p><ul class="list _ul"><li class="list__item" id="88096c3e"><p>以前，如果匹配的构建是已排队的构建，则返回404（未找到）</p></li><li class="list__item" id="d8a34f1a"><p>现在返回排队的构建</p></li></ul><p id="9e979d69">定位器：项目： <id>...</id></p><ul class="list _ul"><li class="list__item" id="2059174e"><p>以前，找到了所有属于项目及其子项目的构建配置的构建（递归地）</p></li><li class="list__item" id="831c4de5"><p>现在，仅找到属于指定项目的构建配置的构建。要递归查找构建，请使用“ affectedProject：” <id>。尺寸。这使用法与构建类型定位符一致。</id></p></li></ul><p id="26e26700">定位器：标签：<text></text></p><ul class="list _ul"><li class="list__item" id="51e05268"><p>以前，当<text>使用“：”字符时，该字符用于将整个“ <text>”视为标签名</text></text></p></li><li class="list__item" id="af13d8bf"><p>现在，“ <text>”被解析为嵌套定位器。对于带有“：”字符的标记， <tag>应使用</tag>定位符“ tag：（name :( <tag>））”</tag></text></p></li></ul><p id="338da36f">定位器：<text></text></p><ul class="list _ul"><li class="list__item" id="07d4becb"><p>以前，如果<text>不是数字，则响应为400（错误请求），并带有“ LocatorProcessException：无效的单个值：' <text>'。应该是一个数字。”消息。</text></text></p></li><li class="list__item" id="ee304961"><p>现在，将执行服务器上所有内部版本的内部版本号搜索（不建议在生产服务器上使用）。对于未找到的版本404（未找到），返回响应</p></li></ul><p id="5a112a69">定位器：id： <number>，xxx：yyyy</number></p><ul class="list _ul"><li class="list__item" id="ae77d7a4"><p>以前，通过id“找到了构建<number>，其他维度被忽略</number></p></li><li class="list__item" id="d9e92e6e"><p>现在，如果通过ID找到的版本与其他尺寸不匹配，则响应为404（未找到）</p></li></ul><p id="cf04976c">定位器：代理商：<agentlocator></agentlocator></p><ul class="list _ul"><li class="list__item" id="f77f8708"><p>以前<agentlocator>按原样使用，没有应用任何默认值（包括未经授权的代理，直到明确将其排除）</agentlocator></p></li><li class="list__item" id="ed2923ba"><p>现在<agentlocator>具有与/ app / rest / agents请求中相同的行为：默认情况下，排除未授权的代理</agentlocator></p></li></ul><p id="825a48b2"><b id="836d6a4a">寻找项目</b><br>按名称搜索用于返回404错误的名称的项目是多个项目被匹配。现在将返回找到的第一个项目。</p><p id="8358254f"><b id="1e6fa963">Build的工件</b><br>通过/ app / rest / builds / <locator>/ artifacts / *请求列出构建工件时，已修复了多个错误，这些错误<locator>会导致请求结果的细微变化。如果您依赖响应，请检查新行为。最重要的更改是：</locator></locator></p><ul class="list _ul"><li class="list__item" id="c89d7daa"><p>在没有当前定位符值的情况下搜索通过URL部分指定的初始路径，除非磁盘上没有此类工件，否则它将不会生成404响应。</p></li><li class="list__item" id="3ff78898"><p>默认情况下，存档不被视为目录（没有子元素）。指定“ browseArchives：true”将存档视为目录（在“递归：true”模式下，仅将一级存档视为目录）</p></li></ul><p id="6f94c9ac"><b id="a3ec3e4f">代理商</b><br>系统不知道（已删除）的代理曾经具有ID“ -1”。现在，此类代理不再包括“ id”，“ pool”和其他一些条目。</p><a name="Xcode7Support"></a><a name="Xcode-7-Support"></a><h4 id="UpgradeNotes-Xcode7Support">Xcode 7支持</h4><p id="5f0005c0">增加了对Xcode 7的<a href="xcode-project.html">实验支持</a> 。</p><a name="Issuetrackersintegration"></a><a name="Issue-trackers-integration"></a><h4 id="UpgradeNotes-Issuetrackersintegration">问题跟踪器集成</h4><p id="cd563408">由于API的更改，第三方问题跟踪器集成插件可能与TeamCity 9.1版本不兼容。旧的插件将不起作用，并且将报告“ java.lang。NoSuchMethodError：jetbrains.buildServer.issueTracker。AbstractIssueProviderFactory。 <init>（Ljetbrains / buildServer / issueTracker / IssueFetcher; Ljava / lang / String;）V“中的错误<code class="code">teamcity-server.log</code>登录（在更多的细节<a href="https://youtrack.jetbrains.com/issue/TW-41508" rel="noopener noreferrer" data-external="true" target="_blank">问题</a> ）。如果您发现此类错误，请与<a href="https://plugins.jetbrains.com/teamcity" rel="noopener noreferrer" data-external="true" target="_blank">插件作者</a>联系。如果您是受影响的插件的作者，请参考<a href="https://confluence.jetbrains.com/display/TCD18/Open+API+Changes" rel="noopener noreferrer" data-external="true" target="_blank">Open API Changes中</a>的相关说明。</init></p></div><a name="Changesfrom9.0.4to9.0.5"></a><a name="Changes-from-9.0.4-to-9.0.5"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.0.4to9.0.5">从9.0.4更改为9.0.5</h2><p id="7b2fa51a">没有值得注意的变化。</p></div><a name="Changesfrom9.0.3to9.0.4"></a><a name="Changes-from-9.0.3-to-9.0.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.0.3to9.0.4">从9.0.3到9.0.4的变化</h2><p id="cc8272cf">没有值得注意的变化。</p></div><a name="Changesfrom9.0.2to9.0.3"></a><a name="Changes-from-9.0.2-to-9.0.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.0.2to9.0.3">从9.0.2到9.0.3的变化</h2><p id="86ec15b5">没有值得注意的变化。</p></div><a name="Changesfrom9.0.1to9.0.2"></a><a name="Changes-from-9.0.1-to-9.0.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.0.1to9.0.2">从9.0.1到9.0.2的变化</h2><p id="983cbc64">没有值得注意的变化。</p></div><a name="Changesfrom9.0to9.0.1"></a><a name="Changes-from-9.0-to-9.0.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom9.0to9.0.1">从9.0更改为9.0.1</h2><a name="KnownIssues"></a><a name="Known-Issues"></a><h4 id="UpgradeNotes-KnownIssues7">已知的问题</h4><p id="b9153fc1">如果在TeamCity 9.0中为使用元运行程序的项目启用了版本设置，则在升级时以及提交到VCS根目录后，元运行程序将从服务器中删除。解决方法是将元运行者定义手动提交到设置存储库中。相关问题： <a href="https://youtrack.jetbrains.com/issue/TW-39519" rel="noopener noreferrer" data-external="true" target="_blank">TW-39519</a> 。</p><a name="Oracle10.xJDBCdriverisnotsupportedanymore"></a><a name="Oracle-10.x-JDBC-driver-is-not-supported-anymore"></a><h4 id="UpgradeNotes-Oracle10.xJDBCdriverisnotsupportedanymore">不再支持Oracle 10.x JDBC驱动程序</h4><p id="07aeac1c">由于在Oracle 10.x JDBC驱动程序中缺少对国家字符集（nvarchar）的支持，因此TeamCity 9.0.1将要求将Oracle JDBC驱动程序升级到最新版本。支持的最低版本的Oracle JDBC驱动程序为11.1。</p></div><a name="Changesfrom8.1.xto9.0"></a><a name="Changes-from-8.1.x-to-9.0"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom8.1.xto9.0">从8.1.x更改为9.0</h2><a name="KnownIssues"></a><a name="Known-Issues"></a><h4 id="UpgradeNotes-KnownIssues8">已知的问题</h4><ul class="list _ul"><li class="list__item" id="a681ef20"><p>如果您配置了提及“ .teamcity”目录的自定义工件清理规则，则可以通过清理过程删除构建日志。确保在升级之前已拥有构建日志备份，并使用“ .teamcity”除去所有定制工件清除规则。相关问题： <a href="https://youtrack.jetbrains.com/issue/TW-40042" rel="noopener noreferrer" data-external="true" target="_blank">TW-40042</a> 。此问题已在9.0.3版本中修复。</p></li><li class="list__item" id="929abcbb"><p>如果将Microsoft SQL Server数据库与TeamCity一起使用，则在计划的清除后台运行之后，TeamCity UI页面可以锁定，直到服务器重新启动。有关详细信息，请参阅<a href="https://youtrack.jetbrains.com/issue/TW-39549" rel="noopener noreferrer" data-external="true" target="_blank">TW-39549</a> 。此问题已在9.0.2版本中修复。</p></li><li class="list__item" id="71b0e110"><p>如果您在服务器上使用LDAP身份验证，并且在服务器上进行了大量登录尝试（例如，有一个使用REST的活动脚本），则可能会发生OutOfMemory错误，并需要重新启动服务器。考虑安装带有此<a href="https://youtrack.jetbrains.com/issue/TW-39316" rel="noopener noreferrer" data-external="true" target="_blank">问题</a>修复程序的LDAP插件。此问题已在9.0.1版本中修复。</p></li><li class="list__item" id="c78e2897"><p>如果您有大型Maven项目，则可以看到由于OutOfMemoryError而导致构建失败。这是由于将后端嵌入式Maven更新到3.2.3（具有更大的内存占用空间）引起的。考虑增加Build Agent <a href="https://confluence.jetbrains.com/display/TCD9/Configuring+Build+Agent+Startup+Properties" rel="noopener noreferrer" data-external="true" target="_blank">内存限制</a>相关问题： <a href="https://youtrack.jetbrains.com/issue/TW-41052" rel="noopener noreferrer" data-external="true" target="_blank">TW-41052</a></p></li></ul><a name="UUIDinXMLsettingsfiles"></a><a name="UUID-in-XML-settings-files"></a><h4 id="UpgradeNotes-UUIDinXMLsettingsfiles">XML设置文件中的UUID</h4><p id="b22df1af"><b id="e4f4716f">从TeamCity 9.0开始</b> ，项目，构建配置和VCS根目录的磁盘存储XML设置定义都存储有唯一的非人类可读ID（uuid）。这些ID是自动生成的，并假定为全局唯一。在复制设置文件时，您不仅需要更改/使实体的ID（文件名）和名称（跨兄弟姐妹）唯一，还要从文件中删除其uuid。TeamCity将自动生成新的uuid。</p><a name="Buildlogsstorage"></a><a name="Build-logs-storage"></a><h4 id="UpgradeNotes-Buildlogsstorage">建立日志存储</h4><p id="138c4ad1">以<a href="teamcity-data-directory.html">TeamCity数据目录</a>存储的内部格式构建日志的位置已更改。内部格式的构建日志文件现在存储在隐藏的构建工件下。即，位置已从<code class="code">system/messages/CHyy/xxyy.*</code>至<code class="code">system/artifacts/<PROJECT EXTERNAL ID>/<BUILD CONFIGURATION NAME>/xxyy/.teamcity/logs/buildLog.*</code> 。</p><p id="9a675762">旧的构建日志将在TeamCity服务器启动（ <a href="http://youtrack.jetbrains.com/issue/TW-37362" rel="noopener noreferrer" data-external="true" target="_blank">TW-37362</a> ）上迁移到新位置。为了避免这种迁移， <code class="code">teamcity.skip.logs.migration</code>内部属性应<b id="57c877f5">在</b>服务器启动<b id="57c877f5">之前</b>设置。</p><a name="Buildsre-indexingafterupgrade"></a><a name="Builds-re-indexing-after-upgrade"></a><h4 id="UpgradeNotes-Buildsre-indexingafterupgrade">升级后建立重新索引</h4><p id="a4cba889">在从9.0之前的版本升级后启动的第一台服务器上，该服务器将为所有版本重新编制索引，以实现版本搜索功能和NuGet feed。在编制索引期间，某些版本将无法在搜索结果和NuGet提要中使用。服务器在索引编制期间也可能会以性能较低的方式表现。 <code class="code">teamcity-server.log</code>有相应的日志记录。在完成索引编制时，日志中有“ BuildIndexer（搜索）-完成重新索引构建”和“ BuildIndexer（元数据）-完成重新索引构建”行。</p><a name="Integrationwithissuetrackers"></a><a name="Integration-with-issue-trackers"></a><h4 id="UpgradeNotes-Integrationwithissuetrackers">与问题跟踪器集成</h4><p id="0b343d86"><b id="d035a75a">从TeamCity 9.0开始</b> ，问题跟踪器是在项目级别配置的，而不是全局服务器范围的配置。在服务器升级时，所有现有的问题跟踪程序集成都移至“根”项目，这使得服务器上的所有项目仍可以访问它们。</p><a name="WebSocketconnectionsandproxyservers"></a><a name="WebSocket-connections-and-proxy-servers"></a><h4 id="UpgradeNotes-WebSocketconnectionsandproxyservers">WebSocket连接和代理服务器</h4><p id="f51ae1c4"><b id="f0de4a11">从9.0开始</b> ，TeamCity尝试在浏览器和服务器之间建立WebSocket连接以更新UI。如果在TeamCity Web UI的前面有一个代理服务器（如nginx），请确保已正确<a href="how-to.html#Set-Up-TeamCity-behind-a-Proxy-Server">配置</a>代理以支持WebSocket连接。</p><p id="a3bd312e">如果代理配置错误或不支持WebSocket协议，将为TeamCity系统管理员显示服务器运行状况项。在这种情况下，TeamCity将像以前一样对UI更新使用普通的旧轮询。</p><a name="RESTAPI"></a><a name="REST-API"></a><h4 id="UpgradeNotes-RESTAPI6">REST API</h4><p id="0f30dfaf">REST API使用9.0版。以前版本的API仍在<code class="code">/app/rest/8.1</code> ， <code class="code">/app/rest/7.0</code> ， <code class="code">/app/rest/6.0</code>网址。</p><ul class="list _ul"><li class="list__item" id="b2e39e09"><p>换豆： <code class="code">webLink</code>属性重命名为<code class="code">webUrl</code>匹配其他豆类（ <a href="http://youtrack.jetbrains.com/issue/TW-34398" rel="noopener noreferrer" data-external="true" target="_blank">TW-34398</a> ）。</p></li><li class="list__item" id="f6f03d9b"><p>表示某些Bean中的空集合的子元素不再包含在响应中（以前被包含为XML中的空标签）。</p></li><li class="list__item" id="bca78e2b"><p>构建<code class="code">changes</code>元素默认情况下不包含“ count”属性（出于性能原因），仍然可以通过提供fields参数来包括count：“ fields = $ long，changes（count，href）”</p></li><li class="list__item" id="1c0c9214"><p>的<code class="code">/app/rest/agents</code>现在，默认情况下，请求会返回所有授权代理（还包括未授权连接的代理）</p></li><li class="list__item" id="67d3ccaa"><p>排队的版本现在具有<code class="code">id</code>属性而不是<code class="code">taskId</code>属性（自TeamCity 9.0起，新版本的属性相同）</p></li></ul><p id="12303ad1"><b id="5649ecf7">构建与标签相关的更改</b><br>的<code class="code">/app/rest/builds/<buildLocator>/tags</code>构建请求现在返回另一个XML： <code class="code"><tags count="1"><tag name="TAG"/></tags></code>代替<code class="code"><tags><tag>TAG</tag></tags></code> 。<br>这同样适用于<code class="code">/app/rest/buildTypes/<buildTypeLocator>/<buildTypeLocator>/buildTags</code>请求。<br>结构上的相同更改也适用于构建的实体嵌套“标签”元素。</p><p id="08c01275">要创建标签，有一种旧方法可以将纯文本标签名称发布到<code class="code">app/rest/builds/<buildLocator>/tags</code>网址。<br>将POST或PUT XML或JSON请求发送到URL时，将使用新的XML格式（ <code class="code"><tag name="TAG"/></tags></code>代替<code class="code"><tag>TAG</tag></code> ）。</p><a name="Handlingtestswiththesamenamewithinabuild"></a><a name="Handling-tests-with-the-same-name-within-a-build"></a><h4 id="UpgradeNotes-Handlingtestswiththesamenamewithinabuild">处理内部版本中具有相同名称的测试</h4><p id="74607163">在TeamCity 9.0中，在同一内部版本中具有相同名称的多个测试被视为具有调用计数的单个测试。如果这些测试运行中的任何一个失败，则将整个测试视为构建失败。相关问题是<a href="https://youtrack.jetbrains.com/issue/TW-24212" rel="noopener noreferrer" data-external="true" target="_blank">TW-24212</a> 。</p><p id="4581c011">此更改会导致构建中的测试编号计数器下降，该构建对于同一测试有多次运行。如果您的构建失败情况依赖于构建中的测试编号，则此更改可能会影响您。</p><p id="4cae562b">如果您需要将测试视为单独的测试，请考虑使用不同的名称在测试套件中运行它们，或者更改测试/运行逻辑以更改TeamCity中显示的完整测试名称。</p><a name="Database-relatedchanges"></a><a name="Database-related-changes"></a><h4 id="UpgradeNotes-Database-relatedchanges">与数据库相关的更改</h4><p id="ffe9855c">TeamCity使用的MS SQL数据库现在支持文本字段的国家字符集（nchar，nvarchar，nclob类型）。建议使用Microsoft本机JDBC驱动程序，因为jTDS JDBC驱动程序不支持nchar和nvarchar字符。如果您仍然使用jTDS，请进行<a href="setting-up-an-external-database.html">迁移</a> 。</p><p id="2ee17e33">升级并进入正常工作状态后，TeamCity启动后台进程，以将条目从vcs_changes数据库表移至vcs_change表。此过程是透明的，您可以照常继续使用服务器。它对服务器性能的影响可以忽略不计，并且唯一受影响的逻辑是项目导入功能（建议仅与过程完成后进行的备份一起使用）。可以在服务器管理的“备份”部分中看到该过程的进度，以及“ TeamCity当前正在优化数据库中与VCS相关的数据以提高备份/还原性能”的消息。<br>另一个重要的事情是，数据复制增加了原始数据库存储的大小。<br>如果这是您遇到的问题（例如，可能是具有已设置数据库大小限制的Microsoft SQL Server数据库），则建议确保数据库大小限制是升级之前当前大小的两倍。在VCS更改迁移过程完成后，可以执行特定于数据库的过程来缩小存储以匹配实际存储的数据。</p><a name="VCSRoot-relatedchanges"></a><a name="VCS-Root-related-changes"></a><h4 id="UpgradeNotes-VCSRoot-relatedchanges">VCS根相关的更改</h4><p id="3a33fbf5">Git和Mercurial VCS根不再提供为新的VCS根在服务器上指定自定义克隆路径的功能。如果需要此功能，请将以下内部属性设置为<code class="code">true</code>对于git和mercurial分别： <code class="code">teamcity.git.showCustomClonePath</code> ， <code class="code">teamcity.hg.showCustomClonePath</code> 。</p><a name="VisualStudioAddin"></a><a name="Visual-Studio-Addin"></a><h4 id="UpgradeNotes-VisualStudioAddin">Visual Studio插件</h4><p id="02df581d">作为<a href="https://www.jetbrains.com/dotnet/" rel="noopener noreferrer" data-external="true" target="_blank">ReSharper Ultimate</a>的一部分安装的TeamCity加载项将删除捆绑软件之前的产品版本：9.0之前的TeamCity和ReSharper版本，3.0之前的dotCover，6.0之前的dotTrace。</p><p id="4b97a270">此外，它不会使用8.1版本提供的设置。从TeamCity服务器下载的传统加载项仍可以使用先前版本中的设置。</p><a name="Other"></a><a name="Other"></a><h4 id="UpgradeNotes-Other3">其他</h4><p id="0358038f">通过Java Web Start安装软件包安装TeamCity代理不再可用。</p></div><a name="Changesfrom8.1.1to8.1.4"></a><a name="Changes-from-8.1.1-to-8.1.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom8.1.1to8.1.4">从8.1.1到8.1.4的变化</h2><p id="e49b2ca0">没有值得注意的变化。</p></div><a name="Changesfrom8.1to8.1.1"></a><a name="Changes-from-8.1-to-8.1.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom8.1to8.1.1">从8.1到8.1.1的变化</h2><a name="CommandLineRunner"></a><a name="Command-Line-Runner"></a><h4 id="UpgradeNotes-CommandLineRunner">命令行运行器</h4><p id="60f4a027">8.1中引入的行为更改（请参见<a href="#Known-issue-with-Command-Line-Runner">下文</a> ）已得到修复。使用TeamCity 8.1创建/更改的使用“带有参数的可执行文件”选项的命令行运行程序可以显示升级行为的变化。推荐的方法是在命令行运行程序中切换到“自定义脚本”选项，而不是“带有参数的可执行文件”。</p><a name="SeparatedownloadforVSTest.Consolerunner"></a><a name="Separate-download-for-VSTest.Console-runner"></a><h4 id="UpgradeNotes-SeparatedownloadforVSTest.Consolerunner">VSTest.Console运行程序的单独下载</h4><p id="09417071">VSTest控制台运行程序不再与TeamCity捆绑在一起，可以作为单独的插件使用。有关下载的详细信息，请参见<a href="https://confluence.jetbrains.com/display/TW/VSTest.Console+Runner" rel="noopener noreferrer" data-external="true" target="_blank">插件页面</a></p></div><a name="Changesfrom8.0.6to8.1"></a><a name="Changes-from-8.0.6-to-8.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom8.0.6to8.1">从8.0.6到8.1的变化</h2><a name="KnownissuewithcreatingMSSQLdatabasewithintegratedsecurity"></a><a name="Known-issue-with-creating-MS-SQL-database-with-integrated-security"></a><h4 id="UpgradeNotes-KnownissuewithcreatingMSSQLdatabasewithintegratedsecurity">创建具有集成安全性的MS SQL数据库的已知问题</h4><p id="a3b91843">重新安装TeamCity并使用数据库设置UI创建具有集成安全性的MS SQL数据库时，您可能会收到错误消息。我们计划在下一个错误修复中解决它，同时使用以下解决方法：</p><ol class="list _decimal"><li class="list__item" id="687338f9"><p>收到错误后，停止TeamCity服务器。</p></li><li class="list__item" id="259dd30e"><p>启动TeamCity服务器。</p></li><li class="list__item" id="b0034e0d"><p>在数据库配置屏幕上，填写所需的信息。<b id="058959fb">不要使用“刷新”按钮。</b> 确保指定的信息正确。</p></li><li class="list__item" id="ee1c6f0a"><p>继续配置步骤。</p></li></ol><p id="56127ab1">如果由于某种原因上述解决方法不能解决问题，请执行以下操作：</p><ol class="list _decimal"><li class="list__item" id="32c644d5"><p>启动TeamCity服务器，批准新的数据库创建，使用登录名和密码配置MS SQL访问，而没有<a href="setting-up-an-external-database.html">集成的安全性</a> 。</p></li><li class="list__item" id="123635f4"><p>确保TeamCity正常工作。</p></li><li class="list__item" id="9bfb21cd"><p>停止TeamCity服务器。</p></li><li class="list__item" id="1eea38f6"><p>修改“ <a href="setting-up-an-external-database.html">设置外部数据库</a>文件”：配置MS SQL连接字符串以使用集成安全性，并删除登录名和密码。</p></li><li class="list__item" id="043c886c"><p>再次启动TeamCity服务器。</p></li></ol><a name="KnownissuewithVSTest.Consolerunner"></a><a name="Known-issue-with-VSTest.Console-runner"></a><h4 id="UpgradeNotes-KnownissuewithVSTest.Consolerunner">VSTest.Console运行程序的已知问题</h4><p id="72c48bec">首次出现在TeamCity 8.1中的新“ VSTest.Console”运行器处于试验状态，因此不建议在生产中使用。默认情况下，它不会出现在TeamCity 8.1.x中（将作为单独下载提供）。</p><a name="KnownissuewithPowerShellrunner"></a><a name="Known-issue-with-PowerShell-runner"></a><h4 id="UpgradeNotes-KnownissuewithPowerShellrunner">PowerShell运行程序的已知问题</h4><p id="ca2f389e">PowerShell运行程序插件在8.1中已损坏。已提供修复程序，请按照<a href="http://youtrack.jetbrains.com/issue/TW-21554#comment=27-676676" rel="noopener noreferrer" data-external="true" target="_blank">问题评论中的</a>说明进行操作。</p><a name="KnownissuewithCommandLineRunner"></a><a name="Known-issue-with-Command-Line-Runner"></a><h4 id="UpgradeNotes-KnownissuewithCommandLineRunner">命令行运行程序的已知问题</h4><p id="8c53a4c6">命令行运行程序使用“带参数的可执行文件”选项可以处理引号（“）和百分号（％），其方式与之前的TeamCity版本不同（请参阅<a href="http://youtrack.jetbrains.com/issue/TW-35087" rel="noopener noreferrer" data-external="true" target="_blank">问题的</a>详细信息）。要切换回以前的（8.0）行为，可以在构建配置或项目中指定command.line.run.as.script = false配置参数。该问题已在8.1.1中修复。<br>推荐的方法是在命令行运行程序中切换到“自定义脚本”选项，而不是“带有参数的可执行文件”。</p><a name="MemorySettings"></a><a name="Memory-Settings"></a><h4 id="UpgradeNotes-MemorySettings">记忆体设定</h4><p id="5513c351">如果尚未<a href="installing-and-configuring-the-teamcity-server.html">切换到64位JVM</a>并使用<code class="code">-Xmx1300</code>服务器的内存设置以及服务器正在Windows上运行，请考虑将该设置减小为<code class="code">-Xmx1200</code>否则，您可能会遇到“本地内存分配（malloc）失败”的JVM崩溃。有关详细信息，请参见<a href="installing-and-configuring-the-teamcity-server.html">推荐的内存设置</a> 。</p><a name="Actionsmenu"></a><a name="Actions-menu"></a><h4 id="UpgradeNotes-Actionsmenu">动作菜单</h4><p id="2532a2e7">一些操作已移至页面右上方“运行”按钮附近的“操作”按钮下。<br>其中包括：构建的“更改”选项卡上的“标记此构建源”，<br>在构建配置设置管理页面上，“暂停”，“复制”，“移动”，“删除”，“与模板关联”，“提取模板”，“提取Meta-Runner”，<br>在“ <b id="333e2b31">项目设置”</b>管理页面上，“复制”，“移动”，“删除”，“存档”，“批量编辑ID”。</p><a name="CreateMavenbuildconfigurationisnotavailablebydefault"></a><a name="Create-Maven-build-configuration-is-not-available-by-default"></a><h4 id="UpgradeNotes-CreateMavenbuildconfigurationisnotavailablebydefault">默认情况下，创建Maven构建配置不可用</h4><p id="d4c81fa5">操作“创建Maven构建配置”不再可用。从URL创建项目和从URL页面创建VCS根目录涵盖了其大部分功能。</p><a name="triggeredByparameterfromGroovyPlugplugin"></a><a name="triggeredBy-parameter-from-GroovyPlug-plugin"></a><h4 id="UpgradeNotes-triggeredByparameterfromGroovyPlugplugin">GroovyPlug插件的TriggerBy参数</h4><p id="3598f99c">的<code class="code">build.triggeredBy</code>和<code class="code">build.triggeredBy.username</code>通过所提供的配置参数<a href="https://confluence.jetbrains.com/display/TW/Groovy+plug" rel="noopener noreferrer" data-external="true" target="_blank">的插件</a>现在由插件添加是<a href="predefined-build-parameters.html">可</a>分别没有下teamcity.build.triggeredBy和teamcity.build.triggeredBy.username名称插件。如果使用了插件的参数，请考虑迁移到设置中的后一组参数。</p><a name="SharedResourcesbuildfeature"></a><a name="Shared-Resources-build-feature"></a><h4 id="UpgradeNotes-SharedResourcesbuildfeature">共享资源构建功能</h4><p id="44f31cae">如果构建使用自定义值锁定资源的所有值，则这些值将作为锁定值提供在构建参数中。对应问题： <a href="http://youtrack.jetbrains.com/issue/TW-29779" rel="noopener noreferrer" data-external="true" target="_blank">TW-29779</a></p><a name="TeamCityDiskSpaceWatcher"></a><a name="TeamCity-Disk-Space-Watcher"></a><h4 id="UpgradeNotes-TeamCityDiskSpaceWatcher">TeamCity磁盘空间监视程序</h4><p id="fc51053b">以下<a href="configuring-teamcity-server-startup-properties.html">内部属性</a>定义TeamCity服务器计算机上的可用磁盘空间阈值：</p><ul class="list _ul"><li class="list__item" id="9f79372f"><p><code class="code">teamcity.diskSpaceWatcher.threshold</code>默认设置为500 Mb会在TeamCity Web UI的所有页面上显示警告。</p></li><li class="list__item" id="5d30e174"><p><code class="code">teamcity.pauseBuildQueue.diskSpace.threshold</code>默认设置为50 Mb会暂停构建队列。的<code class="code">teamcity.diskSpaceWatcher.softThreshold</code>属性已删除。</p></li></ul><a name="PowerShell"></a><a name="PowerShell"></a><h4 id="UpgradeNotes-PowerShell">电源外壳</h4><p id="efcc2824">现在，PowerShell插件使用在UI中指定的版本作为<code class="code">-Version</code>执行脚本时的命令行参数。对应问题： <a href="http://youtrack.jetbrains.com/issue/TW-33472" rel="noopener noreferrer" data-external="true" target="_blank">TW-33472</a></p><a name="RESTAPI"></a><a name="REST-API"></a><h4 id="UpgradeNotes-RESTAPI7">REST API</h4><p id="ef0c9993">该API的最新版本未更改，尽管下面详细介绍了API的更改，但仍为“ 8.0”。如果您觉得这对REST API的使用带来不便，请在相应的<a href="http://youtrack.jetbrains.com/issue/TW-35227" rel="noopener noreferrer" data-external="true" target="_blank">问题中</a>发表评论。</p><p id="1c8d2c21">现在，在REST API请求的响应中返回的实体可能会排除具有空/默认值的属性/元素。这与具有“假”值和空集合的布尔字段有关。推荐的方法是确保客户端代码将“ false”作为不存在的布尔属性/元素的值。</p><p id="2d28f1ef">现在，buildType节点的“ projectName”包含完整的项目名称（带有父项目的名称），而不是项目的简称。</p><p id="afaf8a45">在内部版本列表中，“内部版本”节点不再包含“ startDate”属性。它已成为元素而不是属性，以匹配完整的构建数据表示形式。如果您的REST API使用受到影响，请检查<a href="http://youtrack.jetbrains.com/issue/TW-35032#comment=27-704059" rel="noopener noreferrer" data-external="true" target="_blank">一种</a>在请求构建列表中获取该元素<a href="http://youtrack.jetbrains.com/issue/TW-35032#comment=27-704059" rel="noopener noreferrer" data-external="true" target="_blank">的方法</a> 。</p><p id="b1e1e86c">请求/ app / rest / buildTypes / XXX / parameters / YYY和/ app / rest / projects / XXX / parameters / YYY现在支持“文本/纯文本”和“应用程序/ xml”响应。要获得纯文本响应（这是8.1之前唯一支持的方式），您将需要向请求提供“ Accept：text / plain”标头。</p><p id="d8654c8c">VCS根的密码属性现在包含在响应中，只是没有值。</p><p id="a14d4445">CCTray格式的XML（ <code class="code">app/rest/cctray/projects.xml</code> ）现在不包括暂停的构建配置。</p><p id="d5acbc25">回应实验要求<code class="code">/app/rest/buildTypes/XXX/investigations</code>更改了格式，并增加了其他字段来涵盖测试和问题调查。有内部财产<code class="code">rest.beans.buildTypeInvestigationCompatibility</code>包括已删除的子项目。如果您需要使用内部资源，请通过<a href="https://confluence.jetbrains.com/display/TW/Feedback" rel="noopener noreferrer" data-external="true" target="_blank">支持电子邮件</a>告知我们。</p><a name="Eclipseplugin"></a><a name="Eclipse-plugin"></a><h4 id="UpgradeNotes-Eclipseplugin">Eclipse插件</h4><p id="47eb8fa0">不再支持Subversion 1.4-1.6。现在仅支持Subversion 1.7-1.8工作副本格式。</p></div><a name="Changesfrom8.0.5to8.0.6"></a><a name="Changes-from-8.0.5-to-8.0.6"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom8.0.5to8.0.6">从8.0.5更改为8.0.6</h2><p id="08b34447">没有值得注意的变化。</p></div><a name="Changesfrom8.0.4to8.0.5"></a><a name="Changes-from-8.0.4-to-8.0.5"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom8.0.4to8.0.5">从8.0.4更改为8.0.5</h2><p id="901352c1">没有值得注意的变化。</p></div><a name="Changesfrom8.0.3to8.0.4"></a><a name="Changes-from-8.0.3-to-8.0.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom8.0.3to8.0.4">从8.0.3更改为8.0.4</h2><a name="FirstCleanup"></a><a name="First-Cleanup"></a><h4 id="UpgradeNotes-FirstCleanup">第一次清理</h4><p id="7a349d8a">如果服务器上有许多构建，则服务器升级后的“第一次清理”可能要花一些时间，然后再花一些时间。接下来的清理工作将比以前的版本快一些。</p></div><a name="Changesfrom8.0to8.0.3"></a><a name="Changes-from-8.0-to-8.0.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom8.0to8.0.3">从8.0更改为8.0.3</h2><p id="bac14a04">没有值得注意的变化。</p></div><a name="Changesfrom7.1.xto8.0"></a><a name="Changes-from-7.1.x-to-8.0"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom7.1.xto8.0">从7.1.x更改为8.0</h2><a name="ProjectandBuildConfigurationIDs"></a><a name="Project-and-Build-Configuration-IDs"></a><h4 id="UpgradeNotes-ProjectandBuildConfigurationIDs">项目和构建配置ID</h4><p id="06a5b516">此版本引入了项目和构建配置的用户可分配ID。现在至少在以下情况中使用此新ID代替内部ID（projectN和btNNN）：</p><ul class="list _ul"><li class="list__item" id="93ea6fd6"><p>网页的URL和工件下载</p></li><li class="list__item" id="e5e4a493"><p>在REST API中</p></li><li class="list__item" id="66810b70"><p>项目ID也用在服务器上的目录名称下<code class="code"><TeamCity Data Directory>\system\artifacts</code>而不是TeamCity 8.0之前使用的项目名称</p></li></ul><p id="1e791f8b">如果您使用了上述任何一种方法，请确认您是否受到更改的影响。<br>在<a href="identifier.html">Identifier上</a>了解有关ID的更多信息。</p><p id="d266c4bc">升级后，所有项目都会根据其名称自动获得ID。<br>构建配置ID设置为等于内部（btNNN）ID，以后可以通过“ <b id="dd7170f5">重新生成ID”</b>或“ <b id="00cd91dd">批量编辑ID”</b>操作从管理UI进行更改。</p><p id="414036ca">请注意，项目和构建配置的名称在服务器范围内不再是唯一的（仅在直接父项目中是唯一的），并且可以包含任何符号，如果您在目录或文件名中使用这些符号，则这些符号可能是相关的。</p><a name="Projectsettingsformatondisk"></a><a name="Project-settings-format-on-disk"></a><h4 id="UpgradeNotes-Projectsettingsformatondisk">磁盘上的项目设置格式</h4><p id="d504e588">项目设置存储在磁盘上的格式下<code class="code"><</code> <a href="teamcity-data-directory.html"><code class="code">TeamCity Data Directory</code></a> <code class="code">>/config</code>已经变了。<br>如果您使用任何工具来阅读或更新<code class="code">project-config.xml</code>文件，则需要更新工具。建议使用REST API或TeamCity开放API（Java）进行更改，以使工具不受格式更改的影响很大。</p><a name="BuildConfigurationtemplates"></a><a name="Build-Configuration-templates"></a><h4 id="UpgradeNotes-BuildConfigurationtemplates">构建配置模板</h4><p id="fcd8f9ef">在8.0版中，构建配置模板支持项目层次结构，TeamCity使用新规则：</p><ul class="list _ul"><li class="list__item" id="2c11d7b5"><p>TeamCity管理UI仅将模板的使用限制为当前项目及其父级的模板。复制项目或构建配置时，将自动复制不属于目标项目或其父项之一的模板。</p></li><li class="list__item" id="19d09767"><p>如果模板不属于当前项目或其父项之一，则TeamCity不再允许将构建配置附加到模板。</p></li><li class="list__item" id="18eec223"><p>在8.0版之前，可以从一个项目的构建配置中提取模板到不相关的项目，也可以将一个项目中的构建配置与另一个项目中的模板相关联。升级到TC 8.0后，此类模板将在当前项目中不可访问。要重用无关项目中的构建配置模板，建议手动将其移到公共父项目（如果希望它们在全球范围内可用，则移到Root项目中）。</p></li></ul><a name="JVM-originatedagentparameters(os.archandothers)"></a><a name="JVM-originated-agent-parameters-(os.arch-and-others)"></a><h4 id="UpgradeNotes-JVM-originatedagentparameters(os.archandothers)">JVM起源的代理程序参数（os.arch和其他）</h4><p id="ffdde23c">代理不再报告来自代理JVM的系统属性： <code class="code">system.os.arch, system.os.name, system.os.version, system.user.home, system.user.name, system.user.timezone, system.user.language, system.user.country, system.user.variant, system.path.separator, system.file.encoding, system.file.separator</code> ）。现在，所有上述参数都将作为配置参数报告给<code class="code">teamcity.agent.jvm.</code>前缀代替。如果使用了任何参数，请确保将其更新为新值。</p><a name="IntelliJIDEAprojectrunner"></a><a name="IntelliJ-IDEA-project-runner"></a><h4 id="UpgradeNotes-IntelliJIDEAprojectrunner">IntelliJ IDEA项目运行器</h4><p id="b724f07c">IntelliJ IDEA项目运行程序现在使用IntelliJ IDEA的外部make工具来构建项目。由于此工具需要Java 1.6才能运行，因此IntelliJ IDEA项目运行程序现在也（至少）也需要Java 1.6。</p><a name="Clean-upforbuildconfigurationswithfeaturebranches"></a><a name="Clean-up-for-build-configurations-with-feature-branches"></a><h4 id="UpgradeNotes-Clean-upforbuildconfigurationswithfeaturebranches">清理带有功能分支的构建配置</h4><p id="790b7a7b">现在，具有功能分支的构建配置按分支处理清理规则，与以前的版本相比，清理规则可以导致清理期间保留的构建数量更多。查看<a href="clean-up.html">详细信息</a> 。</p><a name="TeamFoundationServerintegration"></a><a name="Team-Foundation-Server-integration"></a><h4 id="UpgradeNotes-TeamFoundationServerintegration">Team Foundation Server集成</h4><p id="6011b1f6">对于TFS操作，TFS现在更喜欢Team Explorer 2012而不是Team Explorer 2010（如果已安装）</p><a name="CompatibilitywithYouTrack"></a><a name="Compatibility-with-YouTrack"></a><h4 id="UpgradeNotes-CompatibilitywithYouTrack">与YouTrack的兼容性</h4><p id="08a110f4">如果您使用JetBrains YouTrack并使用其TeamCity集成功能，请注意，只有YouTrack版本4.2.4和更高版本与TeamCity 8.0兼容。<br>如果您需要早期版本的YouTrack才能与TeamCity 8.0一起使用，请<a href="https://confluence.jetbrains.com/display/TW/Feedback" rel="noopener noreferrer" data-external="true" target="_blank">告知我们</a> 。</p><a name="RESTAPI"></a><a name="REST-API"></a><h4 id="UpgradeNotes-RESTAPI8">REST API</h4><p id="1b2feb3c"><b id="ccaedeab">外部ID</b> API中有与项目/构建类型/模板的新外部ID相关的更改以及其他更改。<br>仍在“ /app/rest/7.0”URL下提供与TeamCity 7.1兼容的旧API。</p><p id="ad02ff6d">如果您将URL与带有“ id”的定位符一起用于项目，请构建配置或模板（例如<code class="code">.../app/rest/projects/id:XXX</code>要么<code class="code">.../app/rest/buildTypes/id:XXX</code> ），请将定位器更新为以下之一：</p><ul class="list _ul"><li class="list__item" id="ef55229e"><p>（推荐）“ id：EXTERNAL_ID”（您可以在网络用户界面网址中或通过请求获取外部ID<code class="code">.../app/rest/projects/internalId:OLD\_ID/id</code></p></li><li class="list__item" id="44e67e81"><p>只需“ ANY_ID”即可通过其内部，外部ID或名称查找该实体（请谨慎使用：您可以找到比预期更多的实体）</p></li><li class="list__item" id="c6304721"><p>“ internalId：INTERNAL_ID”可通过内部ID查找实体您还可以使用“ /app/rest/7.0/”URL前缀而不是“ / app / rest /”来与7.0 REST API版本一起使用，该REST API仍使用内部除完成构建触发器属性外的ID。</p></li></ul><p id="26a784bd">另外，可以设置内部属性<code class="code">rest.compatibility.allowExternalIdAsInternal=true</code>打开兼容模式，以便id：xxx定位符也将通过内部id搜索。请注意，它将在TeamCity的将来版本中删除，不建议使用。</p><p id="3f71185f"><b id="52683bc4">其他变化</b><br>请求构建“ ... / builds / <locator>/ ...”和“ ... / builds？locator = <locator>“”不再默认返回个人版本和已取消的版本。要包括这些内容，请确保在定位符上添加“，personal：any，canceled：any”。</locator></locator></p><p id="60022b65">构建实体的“ relatedIssues”元素不再包含相关问题的完整列表。它仅具有“ href”属性，该属性的值可用于通过单独的请求获取相关问题。<br>还有一个内部属性“ rest.beans.build.inlineRelatedIssues”可以设置为<code class="code">true</code>返回“ relatedIssues”节点以实现兼容性。有关详细信息，请参见<a href="http://youtrack.jetbrains.com/issue/TW-20025" rel="noopener noreferrer" data-external="true" target="_blank">TW-20025</a> 。另外，“ ... / builds / xxx / related-issues” URL重命名为“ ... / builds / xxx / relatedIssues”。</p><p id="0d086687">从快照和工件依赖项节点中删除了“ source_buildTypeId”属性。而是在“ source-buildType”子元素中添加对构建类型的引用。<br>“ source_buildTypeId”属性仍支持创建依赖关系，但已弃用。有一个内部属性“ rest.compatibility.includeSourceBuildTypeInDependencyProperties”可以设置为<code class="code">true</code>包括“ source_buildTypeId”属性。</p><p id="20176620">在8.0版中，VCS根支持项目层次结构：</p><ul class="list _ul"><li class="list__item" id="e3e6c98e"><p>创建VCS根目录时， <code class="code">project</code>元素应该总是现在提供。元素支持<code class="code">locator</code>属性以指定项目。</p></li><li class="list__item" id="23b9fef2"><p>的<code class="code">shared</code>属性从VCS根目录中删除：升级后，此类VCS根目录将附加到根项目（具有“ _Root” ID）并在全球范围内可用。</p></li><li class="list__item" id="9cf6ab37"><p>复制项目和构建配置时， <code class="code">shareVCSRoots</code>属性不再存在。要使VCS根目录可用于项目和构建配置，请将其移至父/根项目，然后继续进行复制。</p></li></ul><p id="d3489263">建议创建与组织/设置共享结构相对应的项目层次结构，并将VCS根目录移到大多数嵌套的伞式项目中。然后，可以在项目中为用户授予“创建/删除VCS根目录”角色，以便能够编辑VCS根目录。请注意，只有在具有“编辑项目”权限的项目中使用VCS根目录时，用户才能编辑VCS根目录。</p><p id="1df06afb">构建配置模板节点中的“模板”属性重命名为“ templateFlag”。</p><p id="e82aaa13">/ users / <locator>/ roles和/ userGroups / <locator>/ roles的</locator></locator> PUT <locator><locator>现在按原样接受角色列表，并替换现有角色，而不是接受单个规则并将其添加。</locator></locator></p><p id="a0229059">许多以前不返回任何内容的PUT和POST请求现在返回创建的实体。</p><a name="OpenAPIchanges"></a><a name="Open-API-changes"></a><h4 id="UpgradeNotes-OpenAPIchanges">开放式API变更</h4><p id="fc060fd1">查看<a href="https://confluence.jetbrains.com/display/TCD18/Open+API+Changes" rel="noopener noreferrer" data-external="true" target="_blank">详情</a></p><a name="SharedResourcesplugin"></a><a name="Shared-Resources-plugin"></a><h4 id="UpgradeNotes-SharedResourcesplugin">共享资源插件</h4><p id="6013d673">如果您将<a href="https://confluence.jetbrains.com/display/TW/TeamCity+Shared+Resources" rel="noopener noreferrer" data-external="true" target="_blank">共享资源插件</a>与TeamCity 7.1.x一起使用，请确保将其捆绑在一起以将其删除。请参阅<a href="https://confluence.jetbrains.com/display/TW/TeamCity+Shared+Resources" rel="noopener noreferrer" data-external="true" target="_blank">升级说明</a> 。</p><a name="QueueManagerplugin"></a><a name="Queue-Manager-plugin"></a><h4 id="UpgradeNotes-QueueManagerplugin">队列管理器插件</h4><p id="e56996d7">如果您使用了<a href="https://confluence.jetbrains.com/display/TW/TeamCity+Queue+Manager" rel="noopener noreferrer" data-external="true" target="_blank">QueueManager插件</a> ，请确保将其捆绑在一起将其删除。请参阅<a href="https://confluence.jetbrains.com/display/TW/TeamCity+Queue+Manager" rel="noopener noreferrer" data-external="true" target="_blank">升级说明</a></p><a name="BundledMaven"></a><a name="Bundled-Maven"></a><h4 id="UpgradeNotes-BundledMaven">捆绑的Maven</h4><p id="bda1e2bb">与TeamCity捆绑在一起的Maven已升级到版本3.0.5。</p><a name="HTTPSconnectionsfromagentstoserver"></a><a name="HTTPS-connections-from-agents-to-server"></a><h4 id="UpgradeNotes-HTTPSconnectionsfromagentstoserver">代理到服务器的HTTPS连接</h4><p id="5c15be1c">如果您的代理通过HTTPS协议连接到TeamCity服务器，并且在升级后，代理将无法连接，并显示以下错误消息：javax.net.ssl。SSLHandshakeException：收到致命警报：handshake_failure</p><p id="454f1198">那么您应该更改Tomcat SSL连接器配置，即将以下属性添加到SSL连接器并重新启动TeamCity服务器：sslEnabledProtocols =“ TLSv1，SSLv3，SSLv2Hello”</p><p id="934d2524">仅当服务器在Java 1.7下运行时，该问题才会显现。</p><p id="bf827938">也可以看看：</p><ul class="list _ul"><li class="list__item" id="8126e181"><a href="http://mail-archives.apache.org/mod_mbox/tomcat-users/201302.mbox/%3C512559F7.4080001@gmail.com%3E" rel="noopener noreferrer" data-external="true" target="_blank">http://mail-archives.apache.org/mod_mbox/tomcat-users/201302.mbox/%3C512559F7.4080001@gmail.com%3E</a></li><li class="list__item" id="36674bb8"><a href="http://youtrack.jetbrains.com/issue/TW-30221#comment=27-561843" rel="noopener noreferrer" data-external="true" target="_blank">http://youtrack.jetbrains.com/issue/TW-30221#comment=27-561843</a></li></ul></div><a name="Changesfrom7.1.4to7.1.5"></a><a name="Changes-from-7.1.4-to-7.1.5"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom7.1.4to7.1.5">从7.1.4到7.1.5的变化</h2><p id="d6d10144"><b id="483e331a">teamcity.build.branch</b>参数语义已更改，请参阅<a href="http://youtrack.jetbrains.com/issue/TW-23699#comment=27-448002" rel="noopener noreferrer" data-external="true" target="_blank">http://youtrack.jetbrains.com/issue/TW-23699#comment=27-448002</a></p></div><a name="Changesfrom7.1.3to7.1.4"></a><a name="Changes-from-7.1.3-to-7.1.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom7.1.3to7.1.4">从7.1.3到7.1.4的变化</h2><p id="c9d27099">没有值得注意的变化。</p></div><a name="Changesfrom7.1.2to7.1.3"></a><a name="Changes-from-7.1.2-to-7.1.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom7.1.2to7.1.3">从7.1.2到7.1.3的变化</h2><p id="8a5c779a">没有值得注意的变化。</p><p id="ece419ce">请在我们的问题跟踪器中查看该版本的<a href="http://youtrack.jetbrains.com/issues/TW?q=Affected+versions%3A+{Faradi+7.1.3+%2824266%29}+tag%3Aregression" rel="noopener noreferrer" data-external="true" target="_blank">已知回归</a>的最新列表。</p></div><a name="Changesfrom7.1.1to7.1.2"></a><a name="Changes-from-7.1.1-to-7.1.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom7.1.1to7.1.2">从7.1.1到7.1.2的变化</h2><p id="b20d7180"><b id="8fc55d0e">HG服务器端检出的可能问题</b><br>7.1.2版本存在一个已知问题： <a href="http://youtrack.jetbrains.com/issue/TW-24405" rel="noopener noreferrer" data-external="true" target="_blank">TW-24405</a> ，当Mercurial存储库使用服务器端检出，标记或查看文件内容时可以重现。如果您遇到错误消息“中止：目标'hg1'不为空”，请安装该问题附带的补丁。</p><p id="bea21fe1"><b id="9d555946">其他已知问题</b><br>另请在我们的问题跟踪器中查看该版本的<a href="http://youtrack.jetbrains.com/issues/TW?q=Affected+versions%3A+{Faradi+7.1.2+%2824170%29}+tag%3Aregression" rel="noopener noreferrer" data-external="true" target="_blank">已知回归</a>列表。</p></div><a name="Changesfrom7.1to7.1.1"></a><a name="Changes-from-7.1-to-7.1.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom7.1to7.1.1">从7.1更改为7.1.1</h2><p id="7b884b05">没有值得注意的变化。</p></div><a name="Changesfrom7.0.xto7.1"></a><a name="Changes-from-7.0.x-to-7.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom7.0.xto7.1">从7.0.x更改为7.1</h2><p id="83fb7a7e"><b id="c5217c6f">Windows服务配置</b><br>从7.1版开始，TeamCity为TeamCity服务器使用其自己的服务包装解决方案，而不是先前版本中的默认Tomcat解决方案。这将更改TeamCity服务的配置方式（数据目录和服务器启动选项，包括内存设置），并使服务和控制台启动之间保持统一。<br>请参考有关配置服务器启动属性的更新<a href="configuring-teamcity-server-startup-properties.html">部分</a> 。</p><p id="4a7b7065">代理Windows服务开始使用OS提供的环境变量。一旦代理服务器（和JVM）成为x86进程，代理将报告x86环境变量。所做的更改可能会影响您的CPU位检查。有关如何通过报告的环境变量检查机器是否支持x64的信息，请参见<a href="http://blogs.msdn.com/b/david.wang/archive/2006/03/26/howto-detect-process-bitness.aspx" rel="noopener noreferrer" data-external="true" target="_blank">MSDN博客</a> 。</p><p id="c95ede2c"><b id="a48e0058">与Windows安装程序一起安装时，TeamCity数据目录的默认位置</b><br>这仅与使用Windows安装程序进行的全新TeamCity安装有关。如果您升级现有安装，则会保留现有设置。<br>Windows安装程序现在使用<code class="code">%ALLUSERSPROFILE%JetBrains\TeamCity</code>位置作为<a href="teamcity-data-directory.html">TeamCity数据目录的</a>默认位置。在TeamCity 7.0和以前的版本中<code class="code">%USERPROFILE%.BuildServer</code> 。</p><p id="0fca9626"><b id="ac3dfe93">Windows域登录模块</b><br>当TeamCity服务器在Windows下运行并且使用Windows域用户身份验证时，TeamCity现在使用另一个库（Waffle）与Windows域进行通信。在Linux下，行为不变：使用jCIFS库。</p><p id="03ec5876">除非您在ntlm-config.properties文件中为jCIFS库指定了特定设置，否则安装不会受到影响。<br>如果升级后使用Windows用户名/密码登录TeamCity时遇到任何问题，请<a href="https://confluence.jetbrains.com/display/TW/Feedback" rel="noopener noreferrer" data-external="true" target="_blank">向我们</a>提供详细信息。同时，您可以切换到使用旧的jCIFS库。为此，添加<code class="code">teamcity.ntlm.use.jcifs=true</code>进入<a href="configuring-teamcity-server-startup-properties.html">内部属性文件</a> 。<br>请注意，在以后的TeamCity版本中可以使用jCIFS库方法，因此如果不使用该属性，则不建议使用属性规范。</p><p id="e1fd84f5"><b id="1239a4de">Git和Mercurial的结帐目录更改</b><br>具有Git或Mercurial VCS根目录并使用默认检出目录的构建配置将在升级时执行干净检出。干净签出将通过更改默认签出目录名称来触发。进一步的构建将更积极地重用checkout目录（所有使用不同分支但使用相同VCS根的构建将使用相同目录）。这会影响代理和服务器端的检出。</p><p id="ff229610"><b id="211a5daf">Perforce代理结帐工作区名称更改</b><br>服务器升级后，使用Perforce代理端检出的构建配置将执行干净检出。这与自动生成的Perforce工作空间的名称更改有关。</p><p id="dae43d13"><b id="da06a6ec">SVN版本格式</b><br>对于更改，在外部存储库中检测到，SVN修订版具有格式<code class="code">NNN_MMM:EXTUUID_CHANGEDATE</code> ，在哪里<code class="code">NNN</code> -修订主存储库， <code class="code">MMM</code> -修订外部存储库， <code class="code">EXTUUID</code> -外部存储库的UUID， <code class="code">CHANGEDATE</code> -更改时间戳。此更改可能会影响以某种方式使用上次构建更改的修订版的插件/ REST api客户端。</p><p id="d94edd67"><b id="94a119f1">Eclipse IDE插件兼容性</b><br>从TeamCity 7.1开始，TeamCity Eclipse插件不再支持Eclipse 3.3（Europa）版本。现在支持Eclipse 3.8和Eclipse 4.2（Juno）。</p><p id="55ba56bd"><b id="6c8c8d28">将Microsoft SQL Server用作外部数据库时的默认架构</b><br>从7.1版开始，TeamCity仅可用于单个数据库架构，这与以前的版本不同，TeamCity可与数据库服务器的任何架构中的表一起使用。</p><p id="751b81eb">现在，与TeamCity相关的表应该位于数据库模式中，该数据库模式被TeamCity用于连接数据库的数据库用户设置为默认表。</p><p id="09a7ecd0">此更改可能需要重新配置数据库，以为TeamCity服务器用于连接数据库的用户设置默认架构。</p><p id="705ee72e">在执行升级之前，请检查所有与TeamCity相关的表都位于默认用户的架构中。 （例如， <a href="http://blog.sqlauthority.com/2009/06/17/sql-server-list-schema-name-and-table-name-for-database/" rel="noopener noreferrer" data-external="true" target="_blank">使用</a> “ sys.tables”视图）</p><p id="69727ef2">如果未正确设置默认用户的架构，TeamCity可以报告“ TeamCity数据库为空或不存在。如果继续，将在新的TeamCity首次启动时创建一个新数据库。”消息。</p><p id="13a38326">要更改用户的默认架构，请使用“ <a href="http://msdn.microsoft.com/en-us/library/ms176060.aspx" rel="noopener noreferrer" data-external="true" target="_blank">alter user</a> ” SQL命令。</p><p id="ca116279">有关默认架构的描述，请参见<a href="http://msdn.microsoft.com/en-us/library/ms190387.aspx" rel="noopener noreferrer" data-external="true" target="_blank">相应文档中</a>的“默认架构”部分。</p><p id="4fa23add"><b id="3f700ff6">开放式API变更</b><br>查看<a href="https://confluence.jetbrains.com/display/TCD18/Open+API+Changes" rel="noopener noreferrer" data-external="true" target="_blank">详情</a></p></div><a name="Changesfrom7.0.1to7.0.4"></a><a name="Changes-from-7.0.1-to-7.0.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom7.0.1to7.0.4">从7.0.1更改为7.0.4</h2><p id="a557ddc2">没有值得注意的变化。</p></div><a name="Changesfrom7.0to7.0.1"></a><a name="Changes-from-7.0-to-7.0.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom7.0to7.0.1">从7.0更改为7.0.1</h2><p id="06f17ad6"><b id="12548dd5">HTML报告选项卡URL更改</b><br>如果您将直接链接用于构建级别或项目级别的<a href="including-third-party-reports-in-the-build-results.html">报告标签</a> ，请更新链接，因为它们在升级后会<a href="http://youtrack.jetbrains.com/issue/TW-20462#comment=27-302397" rel="noopener noreferrer" data-external="true" target="_blank">更改</a> 。必须进行更改以使功能更可靠。</p></div><a name="Changesfrom6.5.xto7.0"></a><a name="Changes-from-6.5.x-to-7.0"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.5.xto7.0">从6.5.x更改为7.0</h2><p id="2be0006c"><b id="64ef339b">（已知问题）内部版本可能会挂起或为NUnit和其他.Net测试运行程序产生内存错误</b><br>受影响的有：.Net测试运行程序（NUnit，MSTest，MSpec）以及TeamCity NUnit控制台启动器。<br>当测试程序集的路径具有多个深层路径而没有通配符（“ *”）时重现。</p><p id="8d4d9b00">可见的结果：“正在启动...之后，生成挂起或失败并显示OutOfMemoryException错误JetBrains。BuildServer。NUnitLauncher.exe”链接在构建日志中。</p><p id="b901a78f">该问题（ <a href="http://youtrack.jetbrains.com/issue/TW-20482" rel="noopener noreferrer" data-external="true" target="_blank">TW-20482</a> ）已修复，并且此修复程序将包含在下一发行版中。<br>补丁与修复是<a href="http://youtrack.jetbrains.com/issue/TW-20482#comment=27-302393" rel="noopener noreferrer" data-external="true" target="_blank">可用的</a> 。</p><p id="68a6f831"><b id="b3bc2d4d">Ant Runner的最低支持项目JDK</b><br>从此版本开始，Ant <b id="f724510b">运行程序</b>在<b id="f724510b">运行时</b>构建部分中至少需要JDK 1.4（以前是1.3）。这意味着如果您的项目使用JDK 1.3进行编译或测试，则将无法使用TeamCity Ant运行程序。对于需要JDK 1.3的项目，您可以改用命令行运行程序，并配置“ XML报告处理”构建功能来分析测试报告。</p><p id="3fe05891"><b id="4e04e696">服务器和代理程序支持的Java</b><br>从此版本开始，以下要求</p><ul class="list _ul"><li class="list__item" id="b4665133"><p>TeamCity <b id="913f0ab5">服务器</b>应在JRE 1.6或更高版本（以前为1.5）上运行。TeamCity .exe发行版已与适当的Java捆绑在一起。确定为.tar.gz或的.war TeamCity的分布，你可能需要安装和配置服务器<a href="installing-and-configuring-the-teamcity-server.html">manualy</a> 。</p></li><li class="list__item" id="f32b7c2c"><p>TeamCity <b id="14cf698e">代理</b>应在JRE 1.6或更高版本（之前为1.5）上运行。Agent .exe发行版已与适当的Java捆绑在一起。如果您使用.zip代理分发版或在TeamCity 5.0或更早版本中安装了TeamCity代理，则可能需要<a href="setting-up-and-running-additional-build-agents.html">手动步骤</a> 。如果您运行TeamCity 6.5.x，请检查现有TeamCity服务器的“代理”页面：如果任何已连接的代理运行的JDK低于1.6，该页面将显示黄色警告。</p></li></ul><aside class="note " rel="77204bff" id="5dcb9379" data-title=""><p id="9ea3f0ae">如果您的任何代理在低于1.6的JDK版本下运行，则代理将无法升级，并且将在服务器升级上停止运行。您将需要通过安装JDK 1.6并确保代理将<a href="setting-up-and-running-additional-build-agents.html">使用它</a>来手动恢复它们。</p></aside><p id="a0f4502d"><b id="16bcc142">项目/模板参数覆盖</b><br>在TeamCity 7.0中，项目参数比模板中定义的参数具有更高的优先级，即，如果项目中有一个具有相同名称和值的参数，并且同一项目的模板中具有相同名称和不同值的参数，则该项目中的值将会被使用。在TeamCity 6.5中不是这样，并且在模板属于另一个项目时已<a href="http://youtrack.jetbrains.com/issue/TW-17247" rel="noopener noreferrer" data-external="true" target="_blank">更改</a>为更加灵活。与往常一样，构建配置参数具有最高优先级。</p><p id="fd0cbd8f"><a name="no-sybase-support"></a><a name="UpgradeNotes-no-sybase-support"></a></p><p id="b5843125"><b id="100e95ee">不再支持Sybase</b><br>从此版本开始，对Sybase的支持将外部数据库转换回“实验”状态。<br>做出此决定的原因是，似乎该数据库似乎没有与TeamCity一起积极使用，而要支持该数据库则需要TeamCity团队付出巨大的努力，否则可以直接用于改进产品的更重要领域。<br>尽管仍然<a href="https://confluence.jetbrains.com/display/TCD65/Setting+up+an+External+Database" rel="noopener noreferrer" data-external="true" target="_blank">有可能</a> ，但我们不建议您将Sybase用作外部数据库，并且我们不打算为与Sybase相关的问题提供支持。<br>请考虑使用其他<a href="supported-platforms-and-environments.html">受支持的数据库之一</a> 。如果使用Sybase，请在升级TeamCity之前迁移到另一个数据库。</p><p id="109d6acb"><b id="061866d1">REST API更改</b></p><ul class="list _ul"><li class="list__item" id="17c20426"><p>几个对象具有其他属性和子元素（例如BuildType，VcsRoot）。请检查您的解析代码是否仍然有效。 <i id="f01b3a43">/ buildTypes /</i>路径：BuildType对象有利于<i id="97980aee">步骤</i>收集和<i id="1a38bd3d">/ <locator>/步骤/</locator></i>路径的下降runParameters字段（以及<i id="8c08d3a6">/ <locator>/ runParameters</locator></i>路径被丢弃）。</p></li><li class="list__item" id="6d345af9"><p><a href="http://youtrack.jetbrains.net/issue/TW-17478" rel="noopener noreferrer" data-external="true" target="_blank">修复了</a>一个<a href="http://youtrack.jetbrains.net/issue/TW-17478" rel="noopener noreferrer" data-external="true" target="_blank">错误</a> ，该<a href="http://youtrack.jetbrains.net/issue/TW-17478" rel="noopener noreferrer" data-external="true" target="_blank">错误</a>导致某些资源导致单元素数组的非数组JSON表示。请检查您的代码是否受到影响。</p></li><li class="list__item" id="e788ee33"><p>在构建对象中，“ dependency-build”元素重命名为“ snapshot-dependencies”，修订/修订/ vcs-root重命名为“修订/修订/ vcs-root-intance”（并且它现在指向已解析的VCS根实例），修订/修订/显示版本重命名为“版本”。</p></li><li class="list__item" id="a82b25a1"><p>在buildType对象中，“ vcs-root”元素重命名为“ vcs-root-entries”</p></li></ul><p id="aa273fe5">REST API的旧版本可通过以下途径获得<code class="code">/app/rest/6.0/...</code> TeamCity 7.0中的URL。请更新您的REST使用代码，因为TeamCity的未来版本可能会放弃对6.0协议的支持。</p><p id="218099cd"><b id="7a7f18a8">支持的Tomcat的最低版本</b><br>如果您使用TeamCity .war发行版，请注意，不再支持Tomcat 5.5。请将Tomcat更新到6.0.27或更高版本（建议使用Tomcat 7）。</p><p id="0a21a5a5"><b id="d1b15f8f">斯瓦布拉</b></p><p id="6ad882d5">不再支持swabra.handle.exe.path和handle.exe.path配置参数，以提供代理上Sysinternals handle.exe的路径。有关详细信息，请参见<a href="build-files-cleaner-swabra.html">插件页面</a> 。</p><p id="d5b09ee3"><b id="2389edf2">开放式API变更</b></p><p id="bceacf23"><b id="6754eed9">jetbrains.buildServer.messages.serviceMessages</b>包中的类，例如<b id="49badf06">jetbrains.buildServer.messages.serviceMessages。BuildStatus</b>不再依赖<b id="547812c9">jetbrains.buildServer.messages。状态</b>类。要使您的代码与TeamCity <b id="fc9773af">6.0-7.0兼容，可以使用<b id="fc9773af">jetbrains.buildServer.messages.serviceMessages。ServiceMessage＃asString</b>方法，例如：</b></p><div class="code-block" data-lang="bash"><b id="fc9773af">ServiceMessage.asString（“ buildStatus”，新的HashMap <string, string="">（）{{put（“ text”，“发现错误”）; put（“ status”，“ FAILURE”）;}}）;</string,></b></div><p id="a3aa9a47"><b id="fc9773af">另请参见<a href="https://confluence.jetbrains.com/display/TCD18/Open+API+Changes" rel="noopener noreferrer" data-external="true" target="_blank">Open API更改</a></b></p></div><b id="fc9773af"><a name="Changesfrom6.5.4to6.5.6"></a><a name="Changes-from-6.5.4-to-6.5.6"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.5.4to6.5.6">从6.5.4更改为6.5.6</h2><p id="f0c75e6d">没有值得注意的变化</p></div><a name="Changesfrom6.5.4to6.5.5"></a><a name="Changes-from-6.5.4-to-6.5.5"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.5.4to6.5.5">从6.5.4更改为6.5.5</h2><p id="170d831f">（6.5.6中的已知问题infex）.NET Duplicates查找程序可能会停止工作，该修补程序可用，请参阅此评论：http: <a href="http://youtrack.jetbrains.net/issue/TW-18784#comment=27-261174" rel="noopener noreferrer" data-external="true" target="_blank">//youtrack.jetbrains.net/issue/TW-18784#comment=27-261174</a></p></div><a name="Changesfrom6.5.3to6.5.4"></a><a name="Changes-from-6.5.3-to-6.5.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.5.3to6.5.4">从6.5.3更改为6.5.4</h2><p id="d40ca9d4">没有值得注意的变化</p></div><a name="Changesfrom6.5.3to6.5.4"></a><a name="Changes-from-6.5.3-to-6.5.4"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.5.3to6.5.42">从6.5.3更改为6.5.4</h2><p id="5343f34a">没有值得注意的变化</p></div><a name="Changesfrom6.5.2to6.5.3"></a><a name="Changes-from-6.5.2-to-6.5.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.5.2to6.5.3">从6.5.2到6.5.3的变化</h2><p id="020533b7">没有值得注意的变化</p></div><a name="Changesfrom6.5.1to6.5.2"></a><a name="Changes-from-6.5.1-to-6.5.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.5.1to6.5.2">从6.5.1到6.5.2的变化</h2><p id="9365953c"><b id="1a0d17a0">Maven跑步者</b><br>MAVEN_OPTS的使用再次更改。希望是6.5.x迭代中的最后一次。 （请参阅<a href="http://youtrack.jetbrains.net/issue/TW-17393" rel="noopener noreferrer" data-external="true" target="_blank">http://youtrack.jetbrains.net/issue/TW-17393</a> ）<br>现在，TeamCity的行为如下：</p><ol class="list _decimal"><li class="list__item" id="e13b27a3"><p>如果设置了MAVEN_OPTS，TeamCity将从MAVEN_OPTS中获取JVM参数。</p></li><li class="list__item" id="14bc373e"><p>如果运行程序设置中提供了“ JVM命令行参数”，那么将使用它们代替MAVEN_OPTS，并且将<b id="72523a64">MAVEN_OPTS覆盖此值，以将其传播到嵌套的Maven执行中</b> 。</p></li></ol><p id="1df6af52">那些升级到6.5之后的人遇到了不使用MAVEN_OPTS的问题，并且不得不将其值复制到“ JVM命令行参数”以使其生成正常工作，而现在无需更改其配置。构建将以与6.5或6.5.1相同的方式工作。</p></div><a name="Changesfrom6.5to6.5.1"></a><a name="Changes-from-6.5-to-6.5.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.5to6.5.1">从6.5更改为6.5.1</h2><p id="d3870370"><b id="daeb16b9">（已解决的已知问题）在Oracle下升级时间长且清理速度慢</b></p></div><a name="Changesfrom6.0.xto6.5"></a><a name="Changes-from-6.0.x-to-6.5"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.0.xto6.5">从6.0.x更改为6.5</h2><p id="13e568af"><b id="95420840">（已知问题）Oracle下升级时间长且清理速度慢</b><br>在第一个升级的服务器上启动时，数据库结构将转换，如果您使用Oracle外部数据库（ <a href="http://youtrack.jetbrains.net/issue/TW-17094" rel="noopener noreferrer" data-external="true" target="_blank">TW-17094</a> ），这可能需要很长时间（在大型数据库上需要数小时）。这已在6.5.1中修复。</p><p id="02b2e174"><b id="7d2fdc4c">代理JVM升级</b><br>在这个版本的TeamCity中，我们添加了代理程序使用的JVM的半自动升级。如果代理上安装了Java 1.6，并且代理本身仍在Java 1.5下运行，TeamCity将要求将代理切换到Java 1.6。您所需要做的就是检查检测到的Java路径是否正确并确认此切换，其余操作应自动完成。该操作是针对每个代理的，您必须针对每个代理分别进行操作。请注意，我们建议您切换到Java 1.6，因为TeamCity有时将与Java 1.5不兼容。确保新选择的Java进程具有相同的防火墙规则（即，打开了端口9090以接受来自服务器的连接）</p><p id="c52bf75d"><b id="550510bb">IntelliJ IDEA覆盖率数据</b><br>与TeamCity 6.5捆绑在一起的IntelliJ IDEA覆盖引擎生成的覆盖数据只能在IntelliJ IDEA 10.5+中加载。由于覆盖率数据格式的更改，较旧版本的IntelliJ IDEA无法从服务器加载覆盖率。</p><p id="37103a34"><b id="2a1b3f50">不支持IntelliJ IDEA 8</b><br>IntelliJ IDEA插件不再支持IntelliJ IDEA 8。</p><p id="c75a66fe"><b id="4b98bb5e">不支持的MySQL版本</b><br>由于MySQL 5.1.x中的<a href="http://youtrack.jetbrains.net/issue/TW-16508#comment=27-219601" rel="noopener noreferrer" data-external="true" target="_blank">错误</a> ，TeamCity不再支持5.1-5.1.48范围内的MySQL版本。如果检测到不受支持的MySQL版本，TeamCity将不会以适当的消息开头。请将您的MySQL服务器升级到5.1.49版或更高版本。</p><p id="62a7e72b"><b id="65b0390e">显示完成构建属性</b><br>现在，完成的构建将在“参数”选项卡上显示在构建中使用的所有属性。这可能会暴露其他内部版本（给定内部版本用作工件或快照依赖项的那些参数）的名称和参数值。请确保您的环境可以接受。您还可以管理具有“查看构建运行时参数和数据”权限的选项卡的用户，这些权限默认情况下被分配为“项目开发人员”角色。</p><p id="9af510e6"><b id="beea8d18">PowerShell运行程序捆绑在一起</b><br>如果您手动安装了<a href="https://confluence.jetbrains.com/display/TW/PowerShell" rel="noopener noreferrer" data-external="true" target="_blank">PowerShell插件</a> ，请从表格中删除<code class="code">.BuildServer/plugins</code>作为一个新版本，现在与TeamCity捆绑在一起。</p><p id="338babf7"><b id="718487b6">更改设置位置</b></p><ul class="list _ul"><li class="list__item" id="978078f9"><p>XML测试报告设置从运行器设置移至专用的<a href="adding-build-features.html">构建功能</a> 。</p></li><li class="list__item" id="71924a3c"><p>具有快照依赖关系的构建中的“最后完成的构建”工件依赖关系将自动转换为专用的“来自同一链的构建”源构建设置。</p></li></ul><p id="c09ee292"><b id="c53b5ef7">责任重命名为调查</b><br>分配给失败的构建配置或测试的职责现在称为调查。这仅是术语更改，以使操作更中立。<br>如果您对TeamCity调查分配活动有任何电子邮件处理规则，请检查是否需要更新以使用新的文本模式。</p><p id="55d74167"><b id="9d5eba2c">REST API更改</b><br>几个对象获得了附加的属性和子元素（例如，在构建中引用“ startDate”，在更改中引用“个人”）。请检查您的解析代码是否仍然有效。</p><p id="a8bee27c"><b id="b6d2db48">清理非默认签出目录</b><br>在以前的版本中，如果您使用绝对路径显式指定了build <a href="build-checkout-directory.html">checkout目录</a> ，TeamCity将不会清除目录的内容以释放磁盘上的空间。<br>这已不再是这种情况。<br>因此，如果您为checkout目录指定了绝对路径，并且需要该目录存在于其他构建或机器环境的代理上，请设置<code class="code">system.teamcity.build.checkoutDir.expireHours</code> <a href="build-checkout-directory.html">属性设置</a>为“从不”，然后重新运行构建。请考虑到不建议使用<a href="build-checkout-directory.html">自定义结帐目录</a> 。</p><p id="f75c00f3">如果您使用<a href="build-checkout-directory.html">system.teamcity.build.checkoutDir.expireHours</a>属性之一，并且将其设置为“ never”以防止自动删除checkout目录，则在TeamCity升级后，该目录可能会被删除一次。升级后（在上一次构建之后的8天内）在构建配置中运行一次构建将确保该目录保留“受保护”行为，并且不会被TeamCity自动删除。</p><p id="2b29e504"><b id="e3f7fa77">可用磁盘空间</b><br>此版本在UI中公开了“ <a href="free-disk-space.html">可用磁盘空间”功能</a> ，该<a href="free-disk-space.html">功能</a>以前只能通过设置构建配置属性来使用。<br>尽管旧的属性仍然可以使用并且具有优先权，但强烈建议删除它们，然后通过“磁盘空间”构建功能指定值。将来的TeamCity版本可能会停止考虑手动指定的属性。</p><p id="efef5b22"><b id="ffdeae47">命令行运行器</b><br><code class="code">@echo off</code>将关闭命令回显的命令添加到“自定义脚本”运行程序参数提供的脚本中。要启用命令回显，请添加<code class="code">@echo on</code>脚本。</p><p id="c9566a52"><b id="9f7b4b94">Windows托盘通知程序</b><br>您将需要通过卸载并重新安装来升级Windows托盘通知程序。不幸的是，由于Windows Tray Notifier的旧版本中的问题，自动升级将不起作用。</p><p id="a5b7dee3"><b id="97bd519a">Maven跑步者</b></p><ul class="list _ul"><li class="list__item" id="ceabc734"><p>在早期的TeamCity版本中，Maven是通过调用'mvn'Shell脚本执行的。您可以在MAVEN_OPTS和UI中指定一些参数。 Maven构建运行程序通过将这两个连接起来创建了自己的MAVEN_OPT（ <code class="code">%MAVEN\_OPTS%+jvmArgs</code> ）。在这种情况下，如果两次指定某个参数-在MAVEN_OPTS和UI中，则只有MAVEN_OPTS中指定的参数有效。从TeamCity 6.5开始，Maven运行程序直接形成Java命令。尽管此方法解决了许多不同的问题，但它也意味着MAVEN_OPTS不再有效，并且所有JVM命令行参数都应在构建运行程序设置中指定，而不是在MAVEN_OPTS中指定。</p></li><li class="list__item" id="7ab3af95"><p>那些必须手动为Maven版本设置surefire XML报告的用户可以在TeamCity 6.0.x中构建，因为如果没有报告测试，现在可以忘记这一点。自TeamCity 6.5起，firefire测试将由release：prepare或release：perform自动运行。因此，请不要忘记在构建配置设置中关闭surefire XML报告，以避免重复报告！</p></li></ul><p id="7bef970c"><b id="32264b8d">电子邮件发送设置</b><br>请检查升级后的电子邮件发送设置是否正常工作（通过“管理”>“服务器配置”>“电子邮件通知程序”上的“测试连接”）。如果不需要身份验证，请确保登录名和密码字段为空。如果SMTP服务器不希望收到身份验证请求，则非空白字段可能会导致电子邮件发送错误。</p><p id="a1b67e91"><b id="edd45389">XML报表处理</b><br>来自Ant JUnit XML报告的测试可以报告两次（请参阅<a href="http://youtrack.jetbrains.net/issue/TW-19058" rel="noopener noreferrer" data-external="true" target="_blank">TW-19058</a> ），因为我们不再自动忽略TESTS-xxx.xml报告。<br>要解决此问题，请避免使用* .xml掩码，并指定更具体的规则（例如TEST-*。xml或类似内容），这些规则将不匹配名称以“ TESTS-”开头的报告</p><p id="fc483c0d"><b id="892ebe11">开放式API变更</b><br>几种返回类型在TeamCity开放API中有所更改，因此插件可能需要针对新的TeamCity版本重新编译才能继续工作。<br>此外，不建议使用某些API，并且在更高版本中将不再使用。建议更新插件以不使用不推荐使用的API。<br>另请参见<a href="https://confluence.jetbrains.com/display/TCD18/Open+API+Changes" rel="noopener noreferrer" data-external="true" target="_blank">Open API更改</a></p></div><a name="Changesfrom6.0.2to6.0.3"></a><a name="Changes-from-6.0.2-to-6.0.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.0.2to6.0.3">从6.0.2更改为6.0.3</h2><p id="065f31f9">没有值得注意的变化</p></div><a name="Changesfrom6.0.1to6.0.2"></a><a name="Changes-from-6.0.1-to-6.0.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.0.1to6.0.2">从6.0.1更改为6.0.2</h2><p id="b12fbcc0"><b id="ae0ce95c">Maven和XML测试报告在代理上加载CPU</b><br>如果您使用Maven或XML测试报告器，并且您的构建占用大量CPU，则可能会发现重要的<a href="http://youtrack.jetbrains.net/issue/TW-15335" rel="noopener noreferrer" data-external="true" target="_blank">已知问题</a> 。修补程序可用，已在以下更新中修复。</p></div><a name="Changesfrom6.0to6.0.1"></a><a name="Changes-from-6.0-to-6.0.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom6.0to6.0.1">从6.0更改为6.0.1</h2><p id="874a09b2">没有值得注意的变化</p></div><a name="Changesfrom5.1.xto6.0"></a><a name="Changes-from-5.1.x-to-6.0"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom5.1.xto6.0">从5.1.x更改为6.0</h2><p id="fc937a24"><b id="2be15678">Visual Studio加载项和Perforce</b><br>启用Perforce后，TeamCity 6.0 VS加载项中存在严重错误。这可能会导致Visual Studio挂起并崩溃。固定的加载项版本<a href="ftp://ftp.intellij.net/pub/.teamcity/TW-14765/vsAddinInstaller.zip" rel="noopener noreferrer" data-external="true" target="_blank">可用</a> 。 （相关<a href="http://youtrack.jetbrains.net/issue/TW-14765" rel="noopener noreferrer" data-external="true" target="_blank">问题</a> ）。该问题已在TeamCity 6.0.1中修复。</p><p id="e0586404"><b id="4ba1b3a2">TFS代理结帐</b><br>代理上的TFS结帐可能会拒绝处理错误。补丁可用，请参阅<a href="http://youtrack.jetbrains.net/issue/TW-14804#comment=27-185725" rel="noopener noreferrer" data-external="true" target="_blank">注释</a> 。相关<a href="http://youtrack.jetbrains.net/issue/TW-14804" rel="noopener noreferrer" data-external="true" target="_blank">问题</a> 。该问题已在TeamCity 6.0.1中修复。</p><p id="b14dfeea"><b id="25407f69">更改优先级时出错</b><br>更改优先级类别的优先级编号时，您可能会遇到浏览器错误。相关<a href="http://youtrack.jetbrains.net/issue/TW-14816" rel="noopener noreferrer" data-external="true" target="_blank">问题中</a>提供了补丁。该问题已在TeamCity 6.0.1中修复。</p><p id="5b5c9bb4"><b id="d28b48d7">IntelliJ IDEA兼容性</b><br>IntelliJ IDEA的TeamCity插件不再支持IntelliJ IDEA 6和7。</p><p id="b97cffff">另外，如果您打算升级到IntelliJ IDEA X（或其他JetBrains IDE），请查看此<a href="known-issues.html">已知问题</a> 。</p><p id="d6df1597"><b id="b5f8ab87">构建失败通知</b><br>TeamCity 6.0区分运行构建脚本时发生的构建失败和准备构建时发生的失败。在后一种情况下发生的错误称为“无法启动”错误，默认情况下从Web UI隐藏（请参阅“构建配置”页面上的“显示已取消且无法启动构建”选项）。</p><p id="f7593c31">从TeamCity 6.0开始，有一个单独的通知规则“无法启动构建”，适用于“无法启动”构建。其余所有构建失败通知均与构建脚本相关的失败有关。</p><p id="bd01a100">请注意，在升级时，所有具有“构建失败”通知的用户将自动获得“构建失败开始”选项，以保留旧的行为。</p><p id="38e26d6c"><b id="f341ac9b">属性变更</b><br><code class="code">teamcity.build.workingDir</code>属性应不再用于非流浪者设置。为了向后兼容，该属性在非运行者设置中受支持，并解析到第一个定义的构建步骤的工作目录中。</p><p id="35855b17"><b id="6b62783b">捆绑了Swabra和Build Queue Priorities插件</b><br>如果您以前已经安装了插件，请删除它们（通常是表格<code class="code">.BuildServer/plugins</code> ），然后再开始升级TeamCity版本。</p><p id="1ec654e9"><b id="f499f826">Maven跑步者</b><br>Maven运行器的代理部分不再支持1.5版之前的Java。请确保在Maven运行程序设置中指定1.6+ JVM或确保JAVA_HOME指向此类JVM。</p><p id="5ca4f2d1"><b id="2d585134">NUnit和MSTest测试</b><br>如果您在TeamCity UI中配置了NUnit或MSTest测试（sln和MSBuild运行器），则将从运行器中提取设置并将其转换为对应类型的新运行器。</p><p id="a37fb846">请注意，测试启动的实现已更改，并且这影响了相对路径的使用：在TeamCity 6.0中，工作目录和所有UI指定的通配符都是基于构建的<a href="build-checkout-directory.html">checkout目录</a>解析的，而它们以前是基于包含.sln的目录解析的文件。简单的设置在TeamCity升级时进行转换，但是您可能需要验证跑步者是否包含适当的设置。</p><p id="71a85c52"><b id="079b1ed1">生成配置属性中的“％”转义</b><br>现在，在“构建配置”设置中定义的值中的两个百分号（%%）被视为单个百分号的转义符。您现有的设置会在升级时进行转换，以保留以前版本中的功能。但是，您可能需要查看设置，以解决与“％”符号相关的意外问题。</p><p id="9401fa03"><b id="e7d8bb17">.Net Framework属性报告为配置参数</b><br>在先前的TeamCity版本中，已安装的.Net Frameworks，Visual Studios和Mono被报告为构建代理的系统属性。<br>这使属性在构建脚本中可用。为了减少推送到构建脚本中的特定于TeamCity的属性，现在通过配置参数（即，不带“ system。”前缀）报告这些值，并且默认情况下在构建脚本中不提供这些值。它们仍通过以前的名称通过％-references在Build Configuration设置中使用，只是没有“ system”。字首。</p><p id="2e036db4"><b id="a56bf541">不建议使用Ipr运行程序，而建议使用IntelliJ IDEA项目运行程序</b><br>IntelliJ IDEA项目的运行器被完全重写。它没有命名为“ IntelliJ IDEA Project”运行程序。先前可用的Ipr运行程序也被保留，但被标记为已弃用，并将在TeamCity的其他主要版本之一中删除。强烈建议将您现有的构建配置迁移到新运行程序。<br>请注意，新运行程序使用不同的方法运行测试：您需要在IntelliJ IDEA中创建一个共享的运行配置，并在运行程序设置中引用它。</p><p id="108fec67"><b id="301cc2da">清理检查和重复数据</b><br>从6.0版本开始，“检查和重复”报告将在从历史记录中清除构建时清除，而不是从以前清除构建的工件时清除。</p><p id="8d60e400"><b id="a73345de">检查和重复跑步者需要Java 1.6</b><br>现在，“检查”和“重复（Java）”运行程序需要Java JDK 1.6。请确保在相关代理上安装了Java 1.6，并检查运行程序的“ JDK主路径”设置中是否指定了Java 1.6。</p><p id="2afc5d40"><b id="51739a70">XML报告验证</b><br>如果构建运行器的“ XML报告处理”部分的设置无效，则升级后可能会发现报告“必须指定报告路径”的构建配置报告。在这种情况下，请转至跑步者设置并更正配置。 （相关<a href="http://youtrack.jetbrains.net/issue/TW-14821" rel="noopener noreferrer" data-external="true" target="_blank">问题</a> ）</p><p id="f4fa56eb"><b id="ba0c4ad7">开放式API变更</b><br>请参阅中的“ <a href="https://confluence.jetbrains.com/display/TCD18/Open+API+Changes" rel="noopener noreferrer" data-external="true" target="_blank">打开API更改</a>几个jar”。 <code class="code">devPackage</code>被重新排序，一些移至<code class="code">runtime</code>子目录。请更新您的插件项目以适应这些更改。</p><p id="d81b5eb6"><b id="2db2044d">REST API更改</b><br>几个对象具有其他属性和子元素。请检查您的解析代码是否仍然有效。</p><p id="5336e423"><b id="7680b8d1">Perforce Clean Checkout</b><br>服务器升级后，所有使用Perforce checkout的版本都将执行干净的checkout。请注意，这可能会在升级后的最初几个小时对服务器造成高负载，并且当许多构建处于“传输源”阶段时，服务器可能无响应。</p></div><a name="Changesfrom5.1.2to5.1.3"></a><a name="Changes-from-5.1.2-to-5.1.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom5.1.2to5.1.3">从5.1.2到5.1.3的变化</h2><p id="e2d5cb05"><b id="f0ac768e">命令行运行程序中可执行文件的路径</b><br>该<a href="http://youtrack.jetbrains.net/issue/TW-11840" rel="noopener noreferrer" data-external="true" target="_blank">错误</a>已完全修复。其行为与5.1之前的版本中的行为相同。</p></div><a name="Changesfrom5.1.1to5.1.2"></a><a name="Changes-from-5.1.1-to-5.1.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom5.1.1to5.1.2">从5.1.1到5.1.2的变化</h2><p id="dd5bb099">Jabber通知发送错误再次在Web UI中显示给管理员（这些消息在5.1.1中已禁用）。如果您不使用Jabber通知，请在Jabber设置服务器设置页面上暂停Jabber通知程序。</p></div><a name="Changesfrom5.1to5.1.1"></a><a name="Changes-from-5.1-to-5.1.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom5.1to5.1.1">从5.1到5.1.1的变化</h2><p id="1e92ca61"><b id="0391e51f">命令行运行程序中可执行文件的路径</b><br>该<a href="http://youtrack.jetbrains.net/issue/TW-11840" rel="noopener noreferrer" data-external="true" target="_blank">错误</a>已部分修复。行为与5.1之前的版本相同，除了指定工作目录并在checkout和work目录中都包含脚本的情况外。使用工作目录中的脚本。</p><p id="d6d7c71b"><b id="2a120c90">解决方案运行程序和MSBuild运行程序中脚本文件的路径</b><br>该<a href="http://youtrack.jetbrains.net/issue/TW-11854" rel="noopener noreferrer" data-external="true" target="_blank">错误</a>是固定的。其行为与5.1之前的版本中的行为相同。</p></div><a name="Changesfrom5.0.3to5.1"></a><a name="Changes-from-5.0.3-to-5.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom5.0.3to5.1">从5.0.3更改为5.1</h2><aside class="tip sideblock" rel="UpgradeNotes-Changesfrom5.0.3to5.1" id="8c2df241" data-title=""><p id="db837627">如果您打算从3.1.x版本升级到5.1，则需要在其中修改一些dtd文件<code class="code"><TeamCity Data Directory>/config</code>升级之前，请阅读更多问题： <a href="http://youtrack.jetbrains.net/issue/TW-11813#comment=27-148589" rel="noopener noreferrer" data-external="true" target="_blank">TW-11813</a></p></aside><aside class="tip sideblock" rel="UpgradeNotes-Changesfrom5.0.3to5.1" id="39406a18" data-title=""><p id="8a335870">NCover 3支持可能不起作用。见<a href="http://youtrack.jetbrains.net/issue/TW-11680#comment=27-148573" rel="noopener noreferrer" data-external="true" target="_blank">TW-11680</a></p></aside><p id="88fe6e9f"><b id="ddae259e">通知模板更改</b><br>从5.1开始，TeamCity使用<a href="customizing-notifications.html">新的模板引擎</a> （Freemarker）生成通知消息。提供了新的默认模板，并且在升级之前对模板进行的自定义不再有效。</p><p id="7ba593ee">如果您在升级之前自定义了通知模板，请查看新的通知模板并在必要时对其进行更改。旧的通知模板已复制到<code class="code"><TeamCity Data Directory>/config/_trash/_notifications</code>目录。希望您会喜欢新的模板和新的扩展自定义功能。</p><p id="7a641bc3"><b id="4eee5233">外部数据库驱动程序位置</b><br>现在可以将JDBC驱动程序放入<code class="code"><TeamCity Data Directory>/lib/jdbc</code>目录而不是<code class="code">WEB-INF/lib</code> 。建议使用新位置。有关详细信息，请参见<a href="setting-up-an-external-database.html">设置外部数据库</a> 。</p><p id="ddd5b99d">PostgresSQL jdbc驱动程序不再与TeamCity安装软件包捆绑在一起，您将需要在升级时<a href="setting-up-an-external-database.html">自行安装</a> 。</p><p id="b2613b35"><b id="db08b0dc">数据库连接属性</b><br>数据库连接属性模板文件已更改其名称，并放置在<code class="code">database.<database-type>.properties.dist</code>下文件<code class="code"><TeamCity Data Directory>/config</code>目录。它们遵循<a href="teamcity-data-directory.html">.dist文件约定</a> 。</p><p id="56857415">建议您检查一下<code class="code">database.properties</code>通过将其与数据库的新模板文件进行比较来删除该文件，并删除所有未专门定制的选项。</p><p id="97b7c89e"><b id="8bd22061">默认内存选项更改</b><br>我们更改了PermGen内存空间的默认<a href="installing-and-configuring-the-teamcity-server.html">内存选项</a> ，如果您有<code class="code">-Xmx</code> JVM选项更改为大约1.3G，并且在32位JVM上运行，服务器可能无法启动，并显示以下消息：<code class="code">Error occurred during initialization of VM Could not reserve enough space for object heap Could not create the Java virtual machine.</code></p><p id="561be5aa">在这种情况下，请考虑：</p><ul class="list _ul"><li class="list__item" id="1f1bb881"><p>切换到64位JVM。请考虑<a href="installing-and-configuring-the-teamcity-server.html">注意</a> 。</p></li><li class="list__item" id="fe55eddb"><p>通过减少PermGen内存<code class="code">-XX:MaxPermSize</code> <a href="configuring-teamcity-server-startup-properties.html">JVM选项</a> （以前的默认值为120m）</p></li><li class="list__item" id="b60f4ffd"><p>通过减少堆内存<code class="code">-Xmx</code> <a href="configuring-teamcity-server-startup-properties.html">JVM选项</a></p></li></ul><p id="8e70a6ef"><b id="8c77a1ea">保险柜插件已捆绑</b><br>在此版本中，我们捆绑了<a href="https://confluence.jetbrains.com/display/TW/Vault" rel="noopener noreferrer" data-external="true" target="_blank">SourceGear Vault VCS插件</a> （具有实验状态）。请确保从卸载插件。BuildServer / plugins（只需删除插件的zip）（如果之前已安装）。</p><p id="dea40bca"><b id="4f5109c1">命令行运行程序中可执行文件</b>的路径引入了一个<a href="http://youtrack.jetbrains.net/issue/TW-11840" rel="noopener noreferrer" data-external="true" target="_blank">错误</a> ，如果在运行程序中指定了工作目录，则需要更改可执行文件的路径。该错误在5.1.1中已部分修复，在5.1.3中已完全修复。</p><p id="020f5ac8"><b id="9debb5a8">解决方案运行程序和MSBuild运行程序中脚本文件的路径</b><br>引入了一个<a href="http://youtrack.jetbrains.net/issue/TW-11854" rel="noopener noreferrer" data-external="true" target="_blank">错误</a> ，如果在运行程序中指定了工作目录，则该<a href="http://youtrack.jetbrains.net/issue/TW-11854" rel="noopener noreferrer" data-external="true" target="_blank">错误</a>需要更改脚本的路径。该错误已在5.1.1中修复。</p><p id="6c9df851"><b id="fe432da1">开放式API变更</b><br>请参阅<a href="https://confluence.jetbrains.com/display/TCD18/Open+API+Changes" rel="noopener noreferrer" data-external="true" target="_blank">开放式API更改</a></p></div><a name="Changesfrom5.0.2to5.0.3"></a><a name="Changes-from-5.0.2-to-5.0.3"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom5.0.2to5.0.3">从5.0.2更改为5.0.3</h2><p id="37105768">没有值得注意的变化。</p><aside class="tip sideblock" rel="37105768" id="b00f2838" data-title=""><p id="f52e1dd0">.NET重复查找器存在一个已知问题： <a href="http://youtrack.jetbrains.net/issue/TW-11320" rel="noopener noreferrer" data-external="true" target="_blank">TW-11320</a><br>请使用问题附带的补丁。</p></aside></div><a name="Changesfrom5.0.1to5.0.2"></a><a name="Changes-from-5.0.1-to-5.0.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom5.0.1to5.0.2">从5.0.1更改为5.0.2</h2><p id="07da55e7"><b id="ce9d44e1">外部变更查看者</b><br>的<code class="code">relativePath</code>变量现在被替换为<i id="1238a35d">没有</i>签出规则的文件的相对路径。可以通过访问先前的值<code class="code">relativeAgentPath</code> 。有关更多信息，请访问<a href="http://jetbrains.net/tracker/issue/TW-10801" rel="noopener noreferrer" data-external="true" target="_blank">TW-10801</a> 。</p></div><a name="Changesfrom5.0to5.0.1"></a><a name="Changes-from-5.0-to-5.0.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom5.0to5.0.1">从5.0更改为5.0.1</h2><p id="39962168">没有值得注意的变化。</p></div><a name="Changesfrom4.5.6to5.0"></a><a name="Changes-from-4.5.6-to-5.0"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom4.5.6to5.0">从4.5.6更改为5.0</h2><p id="f9aeb44c"><b id="81487bbb">5.0之前的企业服务器许可证和代理许可证需要升级</b><br>对于5.0版，我们宣布了对升级政策的更改：升级到5.0版不是免费的。自5.0以来购买的每个许可证（服务器和代理）都可以与购买许可证后一年内发布的任何TeamCity版本一起使用。请在官方网站的“ <a href="http://www.jetbrains.com/teamcity/buy/index.jsp" rel="noopener noreferrer" data-external="true" target="_blank">许可和升级”</a>部分中查看详细信息。</p><p id="e2909d3e"><b id="04225205">捆绑的插件</b><br>如果您使用的是现在捆绑在5.0中的独立插件，请不要忘记从中删除这些插件<code class="code">.BuildServer/plugins</code>目录。新捆绑的插件是：</p><ul class="list _ul"><li class="list__item" id="56e359bc"><p>水银</p></li><li class="list__item" id="73bbf061"><p>Git（JetBrains）</p></li><li class="list__item" id="f40dd4e2"><p>REST API（之前与YouTrack一起提供）</p></li></ul><p id="1efef334"><b id="705c65e3">其他插件</b><br>如果您使用TeamCity未捆绑的任何插件，请确保您使用的是最新版本，并且与5.0版本兼容。例如，您将需要最新版本的<a href="https://confluence.jetbrains.com/display/TW/Groovy+plug" rel="noopener noreferrer" data-external="true" target="_blank">Groovy插件</a>和其他提供属性的扩展。5.0之前的通知程序插件可能不支持每次测试和作业职责通知。</p><p id="fba5855c"><b id="33ddcb1f">过时的属性</b><br>删除了系统属性“ build.number.format”和环境变量“ BUILD_NUMBER_FORMAT”。如果您需要在内部版本中使用内部版本号格式（让我们知道原因），则可以将内部版本号格式定义为<code class="code">%system.<property name>%</code>并<property name="">在构建配置中</property>定义<property name="">系统属性（然后将其传递给构建）。</property></p><p id="6d952410"><b id="2feee089">Oracle数据库</b><br>如果将TeamCity与Oracle数据库一起使用，则应向TeamCity Oracle用户添加附加特权。为此，以SYS用户身份登录到Oracle并执行</p><div class="code-block" data-lang="bash">将dbms_lock上的执行授予<teamcity_user>;</teamcity_user></div><p id="f416cee7"><b id="1fcb3183">PostgreSQL数据库</b><br>TeamCity 5.0支持PostrgeSQL版本8.3+。<br>因此，如果PostgreSQL服务器的版本低于8.3，则需要对其进行升级。</p><p id="00995fba"><b id="8169c972">开放API的更改</b>请参阅<a href="https://confluence.jetbrains.com/display/TCD18/Open+API+Changes" rel="noopener noreferrer" data-external="true" target="_blank">开放API的更改</a></p></div><a name="Changesfrom4.5.2to4.5.6"></a><a name="Changes-from-4.5.2-to-4.5.6"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom4.5.2to4.5.6">从4.5.2更改为4.5.6</h2><p id="a447b434">没有值得注意的变化。</p></div><a name="Changesfrom4.5.1to4.5.2"></a><a name="Changes-from-4.5.1-to-4.5.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom4.5.1to4.5.2">从4.5.1到4.5.2的变化</h2><p id="bc2450ad">这是4.5.2版本中的Rake运行程序的一个关键问题。有关详细信息和修补程序，请参阅<a href="http://jetbrains.net/tracker/issue2/TW-8485" rel="noopener noreferrer" data-external="true" target="_blank">TW-8485</a> 。</p></div><a name="Changesfrom4.5.0to4.5.1"></a><a name="Changes-from-4.5.0-to-4.5.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom4.5.0to4.5.1">从4.5.0到4.5.1的变化</h2><p id="6fc77b51">没有值得注意的变化。</p></div><a name="Changesfrom4.0.2to4.5"></a><a name="Changes-from-4.0.2-to-4.5"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom4.0.2to4.5">从4.0.2更改为4.5</h2><p id="b0dc927c"><b id="e428ba6a">默认用户角色</b><br>为新用户默认分配的角色将移至“所有用户”组，并将有效地授予已在TeamCity中注册的所有用户。</p><p id="8c8e833e"><b id="b2909c38">服务器重新启动期间运行构建</b><br>请确保在服务器升级期间没有正在运行的内部版本。如果在服务器重新启动期间运行了某些构建，并且这些构建已经过测试，则这些构建将被取消并重新添加到构建队列中（ <a href="http://jetbrains.net/tracker/issue/TW-7476" rel="noopener noreferrer" data-external="true" target="_blank">TW-7476</a> ）。</p><p id="05e3d6ba"><b id="f7b27259">LDAP设置重命名</b><br>如果您已配置LDAP集成，则在首次启动新服务器时将自动转换一些设置。重命名的设置为：</p><ul class="list _ul"><li class="list__item" id="acf517ac"><p><code class="code">formatDN</code> —重命名为<code class="code">teamcity.auth.formatDN</code></p></li><li class="list__item" id="58e0e949"><p><code class="code">loginFilter</code> —重命名为<code class="code">teamcity.auth.loginFilter</code></p></li></ul></div><a name="Changesfrom4.0.1to4.0.2"></a><a name="Changes-from-4.0.1-to-4.0.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom4.0.1to4.0.2">从4.0.1更改为4.0.2</h2><p id="dbb65dca"><b id="caf48f31">第一次清理时间增加</b><br>更新之后的第一次服务器清理可能会花费更多时间。进一步的清理应该恢复到通常的时间。在第一次清除期间，将清除与已删除的构建配置关联的数据。由于TeamCity版本4.0和4.0.1中存在错误，因此之前并未对其进行清理。</p></div><a name="Changesfrom4.0to4.0.1"></a><a name="Changes-from-4.0-to-4.0.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom4.0to4.0.1">从4.0更改为4.0.1</h2><p id="d0ed0602"><b id="5c80cc97">“ importData”服务消息参数id</b>参数重命名为<b id="5d913d3f">type</b> ， <b id="c37b21be">文件</b>重命名为<b id="0a2025f4">path</b> 。此更改是向后兼容的。有关新语法的示例，请参见<a href="fxcop.html">使用服务消息</a>部分。</p></div><a name="Changesfrom3.1.2to4.0"></a><a name="Changes-from-3.1.2-to-4.0"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom3.1.2to4.0">从3.1.2更改为4.0</h2><p id="969f2efb"><b id="88771c9a">初始启动时间</b><br>在TeamCity新版本的第一个开始时，将升级数据库结构。此过程可能会增加服务器启动时间。第一次启动可能比常规启动最多花费20分钟。此时间取决于构建历史记录的大小，构建中的平均测试次数以及服务器硬件。</p><p id="0061e831"><b id="20aacdce">升级后将强制用户重新登录</b><br>升级后，所有用户将自动注销，并且需要在其浏览器中重新登录TeamCity Web UI。自升级以来首次登录后，“ <b id="f6e7a231">记住我”</b>功能将照常运行。</p><p id="bafbbfab"><b id="87e7dfda">以前的IntelliJ IDEA版本支持</b><br>此版本中的IntelliJ IDEA插件不再与IntelliJ IDEA 6.x版本兼容。支持的IDEA版本是7.0.3和8.0。</p><p id="e29b1472"><b id="41609604">在构建中使用VCS修订版</b><br><code class="code">build.vcs.number.N</code>系统属性被替换为<code class="code">build.vcs.number.<escaped VCS root name></code>属性（或仅<code class="code">build.vcs.number</code>如果只有一个根）。如果您使用了构建脚本中的属性，则应手动更新用法或打开兼容模式。构建配置设置中对属性的引用会自动更新。相应的环境变量也已受到影响。<a href="configuring-build-parameters.html">阅读更多</a> 。</p><p id="8f8d2270"><b id="daa5e435">测试套件</b><br>由于TeamCity开始处理测试套件，因此定义了套件名称的测试将被视为新测试（因此，这些测试的测试历史记录可以从头开始。）</p><p id="883377bd"><b id="8209ffe4">工件依赖模式</b><br>神器依赖项模式现在支持<a href="https://confluence.jetbrains.com/display/TCD4/Wildcards" rel="noopener noreferrer" data-external="true" target="_blank">类似Ant的通配符</a> 。<br>如果您依靠<code class="code">""</code>模式以匹配目录名称，请调整您的模式以使用<code class="code">"/"</code>而不是单身<code class="code">"*"</code> 。<br>如果您依靠<code class="code">""</code>模式仅下载不带扩展名的文件，请更新您的模式以使用<code class="code">"."</code>为了那个原因。</p><p id="02cb55cc"><b id="4ab7aa97">在Ivy的帮助下下载工件</b><br>如果您在Ivy任务的帮助下从构建脚本（如Ant build.xml）下载了工件，则应修改ivyconf.xml文件并从中删除除“集成”之外的所有状态。您可以从以下页面获取ivyconf.xml文件作为参考： <a href="http://www.jetbrains.net/confluence/display/TCD4/Configuring+Dependencies" rel="noopener noreferrer" data-external="true" target="_blank">http</a> : <a href="http://www.jetbrains.net/confluence/display/TCD4/Configuring+Dependencies" rel="noopener noreferrer" data-external="true" target="_blank">//www.jetbrains.net/confluence/display/TCD4/Configuring+Dependencies</a></p><p id="ec0b1679"><b id="87eb74e4">浏览器缓存（IE）</b><br>要强制Internet Explorer使用更新的图标（即用于“运行”按钮），您可能需要强制重新加载页面（Ctrl + Shift + R）或删除“ Internet临时文件”。</p></div><a name="Changesfrom3.1.1to3.1.2"></a><a name="Changes-from-3.1.1-to-3.1.2"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom3.1.1to3.1.2">从3.1.1更改为3.1.2</h2><p id="a203db93">没有值得注意的变化。</p></div><a name="Changesfrom3.1to3.1.1"></a><a name="Changes-from-3.1-to-3.1.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom3.1to3.1.1">从3.1到3.1.1的变化</h2><p id="a5aac28d">没有值得注意的变化。</p></div><a name="Changesfrom3.0.1to3.1"></a><a name="Changes-from-3.0.1-to-3.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom3.0.1to3.1">从3.0.1更改为3.1</h2><p id="1d8976c6"><b id="bb9124db">来宾用户和代理详细信息</b></p><p id="6716c932">从3.1版开始，Guest用户无权访问代理详细信息页面。这样做是为了减少暴露有关代理环境的潜在敏感信息。在企业版中，可以在“ <b id="05d471da">用户和组”</b>页面上编辑来宾用户的角色<b id="05d471da">，</b>以提供所需的权限级别。</p><p id="58ed5ce5"><b id="850975a5">StarTeam支持</b></p><p id="a6ad67f2"><b id="50390314">使用中的工作文件夹</b></p><p id="c8064c77">从3.1版开始，当从StarTeam存储库中检出文件时，TeamCity会基于工作文件夹名称构建目录结构，而不仅仅是像早期版本那样建立文件夹名称。因此，如果您对TeamCity使用3.0版中的StarTeam文件夹的方式感到满意，请确保工作文件夹的名称等于相应的文件夹名称（默认情况下是这样）。</p><p id="36e837cd">还要注意，尽管StarTeam允许使用绝对路径作为工作文件夹，但TeamCity仅支持相对路径，而不会检测到绝对路径。因此，请小心并检查您的配置。</p><p id="5414e6b5"><b id="97a093f5">StarTeam URL解析器已修复</b></p><p id="ca5503a5">在3.0版中，用户必须遵循错误的URL方案。就像<i id="960b86fc">starteam：// server：49201 / project / view / rootFolder / subfolder / ...一样</i> ，当用户尝试引用非默认视图时它不起作用。在版本3.1中，使用了本地StarTeam URL解析器。这意味着您现在不必在URL中指定根文件夹，并且上一个示例应类似于<i id="2050488d">starteam：// server：49201 / project / view / subfolder /...。</i></p></div><a name="Changesfrom3.0to3.0.1"></a><a name="Changes-from-3.0-to-3.0.1"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom3.0to3.0.1">从3.0更改为3.0.1</h2><p id="71fdf28a"><b id="a7e34536">Linux代理升级</b></p><ul class="list _ul"><li class="list__item" id="af105029"><p>由于Linux下代理升级的问题，代理升级后，代理辅助启动器进程可能一直处于运行状态。3.0.1及更高版本解决了该问题。为了摆脱过时的运行过程，自动升级代理后，请停止代理（通过<code class="code">agent.sh kill</code>命令）并杀死所有正在运行的<code class="code">java jetbrains.buildServer.agent.Launcher</code>处理并再次启动代理。</p></li></ul></div><a name="Changesfrom2.xto3.0"></a><a name="Changes-from-2.x-to-3.0"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom2.xto3.0">从2.x更改为3.0</h2><p id="83f49d26"><b id="bcf7b885">不兼容的更改</b></p><p id="84cd0bc2">请注意，TeamCity 3.0引入了一些与TeamCity 2.x不兼容的更改：</p><ul class="list _ul"><li class="list__item" id="f8ad1141"><p><b id="ee7159bc">将build.working.dir</b>系统属性重命名为<b id="890c77c9">teamcity.build.checkoutDir</b> 。如果您在构建脚本中使用该属性，请更新脚本。</p></li><li class="list__item" id="d1911e8b"><p><code class="code">runAll.bat</code>脚本现在接受一个必需的参数： <b id="96799a5e">开始</b>以启动服务器和代理， <b id="c742079d">停止</b>以停止服务器和代理。</p></li><li class="list__item" id="11161b90"><p>在Windows下， <code class="code">agent.bat</code>脚本现在接受一个必需的参数： <b id="d176f45e">启动</b>以启动代理， <b id="b205d1b7">停止</b>以停止代理。请注意，在这种情况下，代理将仅在其变为空闲（不运行任何构建）后才停止。要强制立即停止代理，请使用<code class="code">agent.bat stop force</code> Windows和Linux均可用的命令（ <code class="code">agent.sh stop force</code> ）。在Linux下，您也可以使用<code class="code">agent.sh stop kill</code>命令停止代理不响应<code class="code">agent.sh stop force</code> 。</p></li></ul><p id="de427557"><b id="6cb32444">建立工作目录</b></p><p id="e0182817">由于TeamCity 3.0引入了基于每个构建配置而不是每个项目配置VCS根的功能，因此，现在已在代理中签出构建配置源的默认目录已生成名称。如果您需要了解构建配置使用的目录，可以参考<code class="code"><agent home>/work/directory.map</code>该文件列出了构建配置及其使用的目录。另请参阅<a href="build-checkout-directory.html">构建结帐目录</a></p><p id="9a4d9ee6"><b id="0b3ce95a">从TeamCity 1.x / 2.x / 3.x Professional升级到3.x Enterprise时的用户角色</b></p><p id="3ecf18db">首次从TeamCity 1.x / 2.x / 3.x Professional升级到3.x Enterprise时，默认情况下会为TeamCity的帐户分配以下<a href="role-and-permission.html">角色</a> ：</p><ul class="list _ul"><li class="list__item" id="bbe3fb8c"><p><i id="21988b0e">管理员</i>成为系统管理员</p></li><li class="list__item" id="50074ae7"><p><i id="e78948b6">用户</i>成为所有项目的项目开发人员</p></li><li class="list__item" id="cc9d6712"><p><i id="4869d057">来宾</i>帐户能够查看所有项目</p></li><li class="list__item" id="7d4b46a4"><p>所有项目的<i id="c61304a0">默认用户</i>角色均设置为Project Developer</p></li></ul></div><a name="Changesfrom1.xto2.0"></a><a name="Changes-from-1.x-to-2.0"></a><div class="chapter"><h2 id="UpgradeNotes-Changesfrom1.xto2.0">从1.x更改为2.0</h2><p id="3182bf0b"><b id="8bd5616e">数据库设置移动</b><br>从中移动数据库设置<code class="code"><TeamCity installation folder>/ROOT/WEB-INF/buildServerSpring.xml</code>归档到<code class="code">database.properties</code>位于TeamCity配置数据目录（ <code class="code"><TeamCity Data Directory>/config</code> ）。</p><p id="0dfe14d0">继承.NET检查和重复项</p><aside class="tip sideblock" rel="0dfe14d0" id="b9a34097" data-title=""><p id="c53c90f7">如果您在TeamCity 10.0之前使用TeamCity-GitHub <a href="https://github.com/milgner/TeamCityGithub" rel="noopener noreferrer" data-external="true" target="_blank">第三方插件</a> ，则可以安全地<a href="installing-additional-plugins.html">删除</a>它：内置的TeamCity集成将检测到与GitHub问题跟踪器的现有连接并自动获取您的设置。</p></aside><p id="5c984be8"><code class="code">teamcity.TruncateIgnoreReasonConverter.copyReasons</code> ：</p><div class="code-block" data-lang="bash">收集VCS存储库的更改时出错...无法收集TFS更改-从版本x大于当前版本y</div><p id="6a8decaa">先前版本中引入的<a href="https://youtrack.jetbrains.com/issue/TW-46648" rel="noopener noreferrer" data-external="true" target="_blank">带有临时工具文件夹</a>的<a href="https://youtrack.jetbrains.com/issue/TW-46648" rel="noopener noreferrer" data-external="true" target="_blank">错误</a>已得到修复。</p><hr id="66f224f1"><p id="98686e1b"><b id="bafe0bd2">也可以看看：</b></p><p id="026cfd3b"><b id="e505b947">管理员指南</b> ： <a href="licensing-policy.html">许可策略</a></p><hr id="fb88b566"></div></b></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>