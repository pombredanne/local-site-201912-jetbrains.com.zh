<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>将TeamCity与VCS托管服务集成-帮助|帮助团队城市</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Integrating TeamCity with VCS Hosting Services" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/integrating-teamcity-with-other-tools.md|Integrating TeamCity with Other Tools/integrating-teamcity-with-vcs-hosting-services.md|Integrating TeamCity with VCS Hosting Services" data-main-title="Integrating TeamCity with VCS Hosting Services" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/integrating-teamcity-with-vcs-hosting-services.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="integrating-teamcity-with-vcs-hosting-services.md" data-toc="Integrating TeamCity with VCS Hosting Services">将TeamCity与VCS托管服务集成</h1><p id="2b4304ca">如果您在<a href="https://github.com/" rel="noopener noreferrer" data-external="true" target="_blank">GitHub</a> ， <a href="https://enterprise.github.com/" rel="noopener noreferrer" data-external="true" target="_blank">GitHub Enterprise</a> ， <a href="https://bitbucket.org/" rel="noopener noreferrer" data-external="true" target="_blank">Bitbucket Cloud</a> ， <a href="https://about.gitlab.com/" rel="noopener noreferrer" data-external="true" target="_blank">GitLab.com</a>或<a href="https://about.gitlab.com/install/ce-or-ee/" rel="noopener noreferrer" data-external="true" target="_blank">GitLab CE / EE中</a>拥有组织帐户，则可以将TeamCity连接到这些源代码托管服务，从而使组织用户更容易创建新项目<a href="https://confluence.jetbrains.com/display/TCD10/Git" rel="noopener noreferrer" data-external="true" target="_blank">Git</a>或<a href="https://confluence.jetbrains.com/display/TCD10/Mercurial" rel="noopener noreferrer" data-external="true" target="_blank">Mercurial</a> VCS根目录， <a href="https://confluence.jetbrains.com/display/TCD10/GitHub" rel="noopener noreferrer" data-external="true" target="_blank">GitHub</a>或<a href="https://confluence.jetbrains.com/display/TCD10/Bitbucket" rel="noopener noreferrer" data-external="true" target="_blank">Bitbucket</a>问题跟踪器，现已提供开箱即用的支持。</p><p id="8beb16a9">还可以将TeamCity连接到<a href="https://visualstudio.microsoft.com/team-services/" rel="noopener noreferrer" data-external="true" target="_blank">Azure DevOps Services，</a>从而使使用VSTS存储库或问题跟踪器的项目的设置非常简单。</p><p id="97e8289e">在此页：</p><p id="ae526757"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#IntegratingTeamCitywithVCSHostingServices-ConfiguringConnections">配置连接</a><ul class="list _bullet"><li class="list__item"><a href="#IntegratingTeamCitywithVCSHostingServices-ConnectingtoGitHub">连接到GitHub</a></li><li class="list__item"><a href="#IntegratingTeamCitywithVCSHostingServices-ConnectingtoBitbucket">连接到Bitbucket</a></li><li class="list__item"><a href="#IntegratingTeamCitywithVCSHostingServices-ConnectingtoGitLab">连接到GitLab</a></li><li class="list__item"><a href="#IntegratingTeamCitywithVCSHostingServices-ConnectingtoAzureDevOpsServices">连接到Azure DevOps服务</a></li></ul></li><li class="list__item"><a href="#IntegratingTeamCitywithVCSHostingServices-CreatingEntitiesfromURLinTeamCity">通过TeamCity中的URL创建实体</a></li></ul><p></p><a name="ConfiguringConnections"></a><a name="Configuring-Connections"></a><div class="chapter"><h2 id="IntegratingTeamCitywithVCSHostingServices-ConfiguringConnections">配置连接</h2><p id="0ac7ccc7">连接是在项目级别创建的，在当前项目及其所有子项目中都可以访问已配置的连接。如果您使用GitHub或Bitbucket Cloud等全球VCS托管服务，则为Root项目配置单个连接是有意义的。或者，您的组织管理员可以在此处创建一个父项目并配置到GitHub的连接，然后用户将在TeamCity Web UI中看到GitHub存储库URL的列表，这将使子项目的设置更为简单。</p><p id="f1c7cf04">在“ <b id="c7d8b6c4">项目管理” |“</b>配置”中配置连接<b id="c7d8b6c4">。连接</b>页面。</p><p id="39fd9e94"></p><figure><img alt="添加GitHub连接" title="添加GitHub连接" src="/help/img/teamcity/2019.1/projectConnections.png" id="4ed54f93" width="700" height="609"></figure><p></p><p id="841ffba0">您需要使用TeamCity提供的信息在VCS托管服务中注册TeamCity应用程序，在TeamCity表单中输入该服务提供的访问详细信息，然后从TeamCity登录到VCS托管服务以授权VCS中的TeamCity应用程序。请参阅下面的详细信息。</p><a name="ConnectingtoGitHub"></a><a name="Connecting-to-GitHub"></a><div class="chapter"><h3 id="IntegratingTeamCitywithVCSHostingServices-ConnectingtoGitHub">连接到GitHub</h3><p id="5a796fff">您需要配置与GitHub存储库的连接，以便<a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">从URL</a>创建<a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">项目，从URL</a>创建<a href="guess-settings-from-repository-url.html">VCS根目录</a> ，创建<a href="git.html">Git</a> VCS根目录或创建<a href="github.html">GitHub</a>问题跟踪器。</p><p id="f24f4b66">要配置GitHub连接：</p><ol class="list _decimal"><li class="list__item" id="60afe17e"><p>在<b id="aa8834be">项目管理中|</b>单击<b id="aa8834be">连接</b> ，单击<b id="a198018e">添加连接</b> 。</p></li><li class="list__item" id="36daf7d5"><p>选择<i id="4f202f2d">GitHub</i>作为连接类型。打开的页面提供了在GitHub服务中注册TeamCity应用程序时要使用的参数。</p></li><li class="list__item" id="fca40a19">单击<i id="c1f7355c">注册应用程序</i>链接。GitHub页面打开。<br>您需要在GitHub中将TeamCity注册为<a href="https://developer.github.com/v3/oauth/" rel="noopener noreferrer" data-external="true" target="_blank">OAuth应用程序</a> 。<br>在您的GitHub帐户中执行以下步骤：<ul class="list _ul"><li class="list__item" id="df15bee1"><p>登录您的GitHub帐户。在“注册新的OAuth应用程序”页面上，指定名称和可选说明，TeamCity提供的主页URL和回调URL。</p></li><li class="list__item" id="e6a12a7e"><p>单击<b id="67d6ba4d">注册应用程序</b> 。该页面将更新为TeamCity应用程序的客户端ID和客户端机密信息。</p></li></ul></li><li class="list__item" id="a4f199e1"><p>继续在TeamCity中配置连接：在打开的“添加连接”页面上，指定客户端ID和客户端密码。</p></li><li class="list__item" id="24acb384"><p>保存连接设置。</p></li><li class="list__item" id="3bb5d8c4"><p>连接已配置，现在可以在可以指定存储库URL的多个位置激活一个小的GitHub图标： <a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">从URL创建项目，从URL</a> <a href="guess-settings-from-repository-url.html">创建VCS根</a> ，创建<a href="git.html">Git</a> VCS根，创建<a href="github.html">GitHub</a>问题跟踪器。单击该图标，登录GitHub并授权TeamCity。授权的应用程序将被授予对私有存储库的完全控制权，并且“ <i id="768ea705">写入存储库”挂钩</i>权限。</p></li></ol></div><a name="ConnectingtoBitbucket"></a><a name="Connecting-to-Bitbucket"></a><div class="chapter"><h3 id="IntegratingTeamCitywithVCSHostingServices-ConnectingtoBitbucket">连接到Bitbucket</h3><p id="9a48ce20">您需要配置到公共Bitbucket存储库的连接，才能<a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">从URL</a>创建<a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">项目，从URL</a>创建<a href="guess-settings-from-repository-url.html">VCS根目录</a> ，创建<a href="mercurial.html">Mercurial</a> VCS根目录或创建<a href="bitbucket-cloud.html">Bitbucket</a>问题跟踪器。</p><p id="3957ead3">要配置Bitbucket连接：</p><ol class="list _decimal"><li class="list__item" id="e13fbb39"><p>在<b id="9dab3f59">项目管理中|</b>单击<b id="9dab3f59">连接</b> ，单击<b id="7ce29617">添加连接</b> 。</p></li><li class="list__item" id="96270262">选择“ <i id="74f5041d">Bitbucket”</i>作为连接类型。<br>打开的页面提供了在Bitbucket Cloud上注册OAuth使用方时要使用的参数。单击<i id="183940a7">注册应用程序</i>链接。<br>您需要在Bitbucket Cloud上创建<a href="https://confluence.atlassian.com/bitbucket/oauth-on-bitbucket-cloud-238027431.html#OAuthonBitbucketCloud-Createaconsumer" rel="noopener noreferrer" data-external="true" target="_blank">OAuth使用者</a> 。在您的Bitbucket帐户中执行以下步骤：<ol class="list _decimal"><li class="list__item" id="793a7ff9"><p>登录您的Bitbucket帐户，单击您的头像，然后从菜单中选择<b id="378c40b3">Bitbucket设置</b> 。出现“帐户”页面。</p></li><li class="list__item" id="b291a807"><p>从菜单栏中单击<b id="ab05f757">OAuth</b> 。在“ <b id="a4181f0d">添加OAuth使用方”</b>页面上，指定名称和可选说明，回调URL以及TeamCity提供的URL。</p></li><li class="list__item" id="a89e429b"><p>指定一组权限：TeamCity要求对您的帐户和存储库具有“ <i id="8fb820ac">读取</i> ”访问权限。</p></li><li class="list__item" id="d4f71fff"><p>保存设置。</p></li><li class="list__item" id="573a018d"><p>在打开的页面上的“ <b id="3e6c9395">OAth使用者”</b>部分中，单击TeamCity应用程序的名称以显示密钥和机密。</p></li></ol></li><li class="list__item" id="ba716b31"><p>继续在TeamCity中配置连接：在打开的“ <b id="c990a5b3">添加连接”</b>页面上，指定密钥和机密。</p></li><li class="list__item" id="f3760560"><p>保存连接设置。</p></li><li class="list__item" id="9d70d99a"><p>配置了连接后，现在可以在可以指定存储库URL的多个位置激活一个小的Bitbucket图标： <a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">从URL创建项目，从URL</a> <a href="guess-settings-from-repository-url.html">创建VCS根目录</a> ，创建<a href="mercurial.html">Mercurial</a> VCS根目录，创建<a href="bitbucket-cloud.html">Bitbucket</a>问题跟踪器。单击该图标，登录到Bitbucket并授权TeamCity。TeamCity将被授予访问您的公共存储库的权限。对于<b id="d35310ba">私有</b>存储库，您仍然必须登录Bitbucket，因为它不提供未过期的访问令牌。请参阅<a href="https://bitbucket.org/site/master/issues/11774/application-specific-passwords-or-tokens" rel="noopener noreferrer" data-external="true" target="_blank">相关讨论</a> 。</p></li></ol></div><a name="ConnectingtoGitLab"></a><a name="Connecting-to-GitLab"></a><div class="chapter"><h3 id="IntegratingTeamCitywithVCSHostingServices-ConnectingtoGitLab">连接到GitLab</h3><p id="aaabdad3">您需要配置与公共GitLab存储库的连接，才能<a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">从URL</a>创建<a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">项目</a>或<a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">从URL</a>创建<a href="guess-settings-from-repository-url.html">VCS根目录</a> 。</p><p id="c3f92929">要在TeamCity中配置GitLab连接：</p><ol class="list _decimal"><li class="list__item" id="c0453fe5"><p>在<b id="090528cf">项目管理中|</b>单击<b id="090528cf">连接</b> ，单击<b id="6b92f137">添加连接</b> 。</p></li><li class="list__item" id="e64e20d4"><p>选择<i id="70c64469">GitLab.com</i>或<i id="ccfd9707">GitLab CE / EE</i>作为连接类型。</p></li><li class="list__item" id="41863560"><p>TeamCity将显示在GitLab中注册OAuth应用程序所需的<i id="26fe19e3">重定向URL</i> 。<br>要注册该应用程序，请遵循<a href="https://docs.gitlab.com/ee/integration/oauth_provider.html" rel="noopener noreferrer" data-external="true" target="_blank">以下说明</a> 。将TeamCity <i id="daa773d6">重定向URL</i>作为<i id="b1c81fc0">重定向URI</i>插入，然后选择<code class="code">api</code> <a href="https://docs.gitlab.com/ee/integration/oauth_provider.html#authorized-applications" rel="noopener noreferrer" data-external="true" target="_blank">范围</a> 。保存您的应用程序，并复制GitLab生成的<b id="5d4e5a69">密码</b>和<b id="1aa569d5">应用程序ID</b> 。</p></li><li class="list__item" id="344f20a4">准备就绪后，请返回在TeamCity中配置连接并填写以下字段：<ul class="list _ul"><li class="list__item" id="03ce6135"><i id="dae41c22">申请编号</i></li><li class="list__item" id="1cb1b149"><i id="b7c4ae35">秘密</i></li><li class="list__item" id="4e6357dc"><p><i id="7e610518">服务器网址</i> （仅适用于GitLab CE / EE）</p></li></ul></li><li class="list__item" id="44b69b90"><p>保存连接设置。</p></li><li class="list__item" id="b62b34db"><p>连接已配置，现在可以在可以指定存储库URL的几个地方激活一个小的GitLab图标： <a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">从URL创建项目，从URL</a> <a href="guess-settings-from-repository-url.html">创建VCS根目录</a> 。单击该图标，登录到GitLab，并授权TeamCity。TeamCity将被授予访问您的存储库的权限。</p></li></ol><aside class="note " rel="562ee6aa" id="a6cd3854" data-title=""><p id="52fdead7">为GitLab创建VCS根URL时，请注意TeamCity不会从根URL中提取凭证，因此您需要手动指定用户名和密码。</p></aside></div><a name="ConnectingtoAzureDevOpsServices"></a><a name="Connecting-to-Azure-DevOps-Services"></a><div class="chapter"><h3 id="IntegratingTeamCitywithVCSHostingServices-ConnectingtoAzureDevOpsServices">连接到Azure DevOps服务</h3><p id="ca84f092">您可以配置与Azure DevOps Services（或Azure DevOps Server，以前称为Team Foundation Server）的连接，以<a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">从URL</a>创建<a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">项目，从URL</a>创建<a href="guess-settings-from-repository-url.html">VCS根目录</a> ，创建<a href="team-foundation-server.html">TFS</a> VCS根目录，或创建<a href="team-foundation-work-items.html">Team Foundation Work Items</a>跟踪器。</p><p id="31390f83">若要配置到Azure DevOps Services的连接，请按照下列步骤操作：</p><ol class="list _decimal"><li class="list__item" id="47f5ecd4"><p>在<b id="7dbd22c3">项目管理中|</b>单击<b id="7dbd22c3">连接</b> ，单击<b id="a005ee71">添加连接</b> 。</p></li><li class="list__item" id="ec87acc7"><p>选择“ <i id="28ae96b5">Azure DevOps Services”</i>作为连接类型。<br>打开的页面提供了将TeamCity连接到Azure DevOps Services时要使用的参数。</p></li><li class="list__item" id="0a73c0e4"><p>登录到您的Azure DevOps Services帐户，以按照<a href="https://www.visualstudio.com/en-us/docs/setup-admin/team-services/use-personal-access-tokens-to-authenticate" rel="noopener noreferrer" data-external="true" target="_blank">Microsoft文档</a>中的<a href="https://www.visualstudio.com/en-us/docs/setup-admin/team-services/use-personal-access-tokens-to-authenticate" rel="noopener noreferrer" data-external="true" target="_blank">说明</a>创建具有<i id="9a42f87a">所有作用域</i>的个人访问令牌。</p></li><li class="list__item" id="a7a5684f">继续在TeamCity中配置连接：在打开的“ <b id="7b9b2c26">添加连接”</b>页面上，指定<ul class="list _ul"><li class="list__item" id="047351e8"><p>中的服务器网址<code class="code">https://{account}.visualstudio.com</code>格式或您的Team Foundation Server Web门户格式为<code class="code">https://{server}:8080/tfs/</code></p></li><li class="list__item" id="d92a89ff"><p>您的个人访问令牌</p></li></ul></li><li class="list__item" id="cfb3f30c"><p>保存连接设置。</p></li><li class="list__item" id="08ccf628"><p>配置了连接后，现在可以在可以指定存储库URL的多个位置中使用一个小的Azure DevOps Services图标： <a href="creating-and-editing-projects.html#Creating-project-pointing-to-repository-URL">从URL创建项目，从URL</a> <a href="guess-settings-from-repository-url.html">创建VCS根目录</a> ，创建<a href="team-foundation-server.html">TFS</a> VCS根目录，创建<a href="team-foundation-work-items.html">Team Foundation Work Items</a>跟踪器。单击该图标，登录到Azure DevOps Services并授权TeamCity。TeamCity将被授予对您可用的所有资源的完全访问权限。<br><b id="f310bb35">从TeamCity 2017.2 EAP1开始</b> ，在为TFS / VSTS中托管的Git存储库配置Commit Status Publisher时，如果配置了VSTS项目连接，则可以自动填写个人访问令牌。</p></li></ol><aside class="tip sideblock" rel="a71e5374" id="2ef83f30" data-title=""><p id="171d54b6">可以配置多个VSTS连接。在这种情况下，服务器URL将显示在VSTS图标旁边，以区分使用中的服务器。</p></aside></div></div><a name="CreatingEntitiesfromURLinTeamCity"></a><a name="Creating-Entities-from-URL-in-TeamCity"></a><div class="chapter"><h2 id="IntegratingTeamCitywithVCSHostingServices-CreatingEntitiesfromURLinTeamCity">通过TeamCity中的URL创建实体</h2><p id="9a5cbd48">现在，通过TeamCity中的URL创建实体非常容易：单击GitHub，Bitbucket，GitLab或VSTS图标后，将显示当前用户可用的存储库列表（请注意，只有公共Bitbucket存储库可通过配置的连接使用）：</p><p id="5894a485"></p><figure><img alt="可用的Bitbucket存储库" title="可用的Bitbucket存储库" src="/help/img/teamcity/2019.1/ProjectConnectionBitbucket.png" id="c9151a6c" width="587" height="351"></figure><p></p><p id="706b88e4">您可以选择URL并继续进行配置。</p><hr id="753834f7"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>