<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>TeamCity数据备份-帮助|帮助团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="TeamCity Data Backup" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/teamcity-configuration-and-maintenance.md|TeamCity Configuration and Maintenance/teamcity-data-backup.md|TeamCity Data Backup/creating-backup-from-teamcity-web-ui.md|Creating Backup from TeamCity Web UI/creating-backup-via-maintaindb-command-line-tool.md|Creating Backup via maintainDB command-line tool/manual-backup-and-restore.md|Manual Backup and Restore/backing-up-build-agent-s-data.md|Backing up Build Agent's Data/restoring-teamcity-data-from-backup.md|Restoring TeamCity Data from Backup" data-main-title="TeamCity Data Backup" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/teamcity-data-backup.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="teamcity-data-backup.md" data-toc="TeamCity Data Backup">TeamCity数据备份</h1><p id="2ff85e9e">TeamCity提供了几种备份数据的方式：</p><ul class="list _ul"><li class="list__item" id="6ca3e319"><p><a href="creating-backup-from-teamcity-web-ui.html">从Web UI备份</a> ： <a href="creating-backup-from-teamcity-web-ui.html">Web UI中的</a>一项操作（也可以通过<a href="rest-api.html#Data-Backup">REST API</a>触发）在服务器运行时创建备份。建议用于定期维护备份。适用于备份数据的一些限制（请参阅下面的<a href="#Backing-up-Data">相关部分</a> ）。此选项在维护屏幕的升级中也可用-在TeamCity服务器的较新版本的首次启动时。</p></li><li class="list__item" id="6c53bb03"><p><a href="creating-backup-via-maintaindb-command-line-tool.html">通过maintainDB命令行工具进行备份</a> ：与通过UI相同。要包含所有数据，请在服务器<a href="creating-backup-via-maintaindb-command-line-tool.html#Performing-TeamCity-Data-Backup-with-maintainDB-Utility">停止</a>时使用该工具。</p></li><li class="list__item" id="fb7ad64a"><p><a href="manual-backup-and-restore.html">手动备份</a> ：如果要手动管理备份过程，则非常适合。</p></li><li class="list__item" id="846dae9a"><p>您可能只需要<a href="backing-up-build-agent-s-data.html">备份构建代理的数据</a> 。</p></li></ul><p id="a8cab9d2"><b id="73cc6dcf"><a href="restoring-teamcity-data-from-backup.html">从备份还原数据</a></b>是使用<code class="code">maintainDB</code>工具。</p><aside class="note " rel="a8cab9d2" id="7314b6b1" data-title=""><p id="4f1ff23f">我们强烈建议您在升级之前备份TeamCity数据。请注意，TeamCity服务器<b id="515e0842">不支持降级</b> 。</p></aside><a name="BackingupData"></a><a name="Backing-up-Data"></a><div class="chapter"><h2 id="TeamCityDataBackup-BackingupData">备份资料</h2><p id="ee6145db">TeamCity <b id="38b33791">允许备份</b>以下数据：</p><ul class="list _ul"><li class="list__item" id="df4826c2"><a href="manual-backup-and-restore.html#Database-Data">数据存储在数据库中</a></li><li class="list__item" id="603ae8cb"><p>服务器设置，项目设置和构建配置（所有存储在<code class="code"><</code> <a href="teamcity-data-directory.html"><code class="code">TeamCity Data Directory</code></a> <code class="code">>/config</code> ）</p></li><li class="list__item" id="cb7c9339"><p>自定义插件（安装在<code class="code"><</code> <a href="teamcity-data-directory.html"><code class="code">TeamCity Data Directory</code></a> <code class="code">>\plugins</code> ）和数据库驱动程序（来自<code class="code"><</code> <a href="teamcity-data-directory.html"><code class="code">TeamCity Data Directory</code></a> <code class="code">>/lib</code>目录）</p></li><li class="list__item" id="9e090900"><p>补充数据：设置历史记录，触发器状态，插件数据等（所有<code class="code"><</code> <a href="teamcity-data-directory.html"><code class="code">TeamCity Data Directory</code></a> <code class="code">>/system/pluginData</code>目录）</p></li><li class="list__item" id="1337d10f"><p>构建日志</p></li><li class="list__item" id="92a4c421"><p>个人改变</p></li></ul><p id="b31b5513">在使用<a href="creating-backup-from-teamcity-web-ui.html">TeamCity Web UI</a>时，可以使用备份作用域选项来配置要备份的数据，也可以通过<a href="creating-backup-from-teamcity-web-ui.html">keepDB</a> <a href="creating-backup-via-maintaindb-command-line-tool.html">命令行工具的</a>其他参数来配置。</p><p id="dfec397e">以下数据<b id="c3f3b73e">不包括</b>在备份中：</p><ul class="list _ul"><li class="list__item" id="ef3d2cef"><p><b id="08e8287c">生成工件</b> （由于其大小）。这些包括显式的构建工件和存储覆盖率报告的内部工件，完成构建参数，设置摘要等。如果您需要构建工件，也请手动备份<a href="teamcity-configuration-and-maintenance.html">工件目录</a>的内容。</p></li></ul><ul class="list _ul"><li class="list__item" id="b1947197"><p>用于从UI进行备份： <b id="2357ef5e">运行build和build queue state</b> 。如果要备份这些文件，请在TeamCity服务器未运行时使用命令行maintenanceDB <a href="creating-backup-via-maintaindb-command-line-tool.html">工具</a> 。</p></li><li class="list__item" id="5b9c764b"><p>下的TeamCity应用程序手册自定义项<code class="code"><</code> <a href="teamcity-home-directory.html"><code class="code">TeamCity Home</code></a> <code class="code">></code> ，包括存储在其中的已用服务器端口号<code class="code"><</code> <a href="teamcity-home-directory.html"><code class="code">TeamCity Home</code></a> <code class="code">>/conf/server.xml</code>文件。</p></li><li class="list__item" id="2abc15c8"><p>TeamCity应用程序日志（它们也位于<code class="code"><</code> <a href="teamcity-home-directory.html"><code class="code">TeamCity Home</code></a> <code class="code">>/logs</code> ）</p></li><li class="list__item" id="53d39048"><p>下的任何手动创建的文件<code class="code"><</code> <a href="teamcity-data-directory.html"><code class="code">TeamCity Data Directory</code></a> <code class="code">></code>不属于前面提到的项目。</p></li></ul><p id="819a347f"><b id="6e7d892d">推荐的方法</b>是执行“ <a href="manual-backup-and-restore.html">手动备份和还原”</a>下所述的备份过程<a href="manual-backup-and-restore.html">，</a>或者以“基本”级别定期（例如，通过<a href="rest-api.html#Data-Backup">REST API</a>自动）从<a href="creating-backup-from-teamcity-web-ui.html">Web UI</a>运行备份-这将确保备份除以下以外的所有重要数据构建工件并构建日志。</p><p id="17500255">可以通过在以下位置复制文件来手动备份构建工件和日志（如有必要） <code class="code">.BuildServer/system/artifacts</code> （低于TeamCity 9.0 in <code class="code">.BuildServer/system/messages</code> ）。</p><ul class="list _ul"><li class="list__item" id="b134cbbd"><p>有关详细信息，请参见<a href="teamcity-data-directory.html#artifacts">TeamCity数据目录</a> 。</p></li><li class="list__item" id="c2e3bb69"><p>如果选择了日志进行备份，TeamCity将在服务器上当前指定的<a href="build-artifact.html">所有工件目录中</a>搜索它们。</p></li></ul><p id="540aadd9">请注意，对于大型量产的TeamCity安装，从数据库导出数据或从数据库导入数据可能不是最佳解决方案，通过复制维护数据库备份可能是更好的选择。例如，请参见MySQL数据库的相应<a href="http://dev.mysql.com/doc/refman/5.0/en/replication.html" rel="noopener noreferrer" data-external="true" target="_blank">文档</a> 。</p><hr id="44a6c4a8"><p id="59b12664"><b id="8d8cbe67">也可以看看：</b></p><p id="5a344e0b"><b id="b28fa776">安装和升级</b> ： <a href="upgrade.html">升级</a></p><hr id="6503b1b7"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>