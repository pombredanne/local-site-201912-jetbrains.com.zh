<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>NTLM HTTP身份验证-帮助|帮助团队城市</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="NTLM HTTP Authentication" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/teamcity-configuration-and-maintenance.md|TeamCity Configuration and Maintenance/configuring-authentication-settings.md|Configuring Authentication Settings/ntlm-http-authentication.md|NTLM HTTP Authentication" data-main-title="NTLM HTTP Authentication" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/ntlm-http-authentication.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="ntlm-http-authentication.md" data-toc="NTLM HTTP Authentication">NTLM HTTP身份验证</h1><p id="c01dbf7e">当使用支持NTLM的浏览器/客户端以及通过NTLMv1，NTLMv1，NTLMv2和Kerberos逻辑协商HTTP身份验证的浏览器/客户端时，TeamCity NTLM HTTP身份验证功能采用了集成Windows身份验证，并允许透明/ SSO登录到TeamCity Web UI。当TeamCity服务器在Windows操作系统下运行时，支持身份验证。通常，它允许用户使用其NT域帐户登录TeamCity服务器Web UI，而无需手动输入凭据。</p><a name="Configuration"></a><a name="Configuration"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-Configuration">组态</h2><p id="0ee924a2"><b id="47d7b4c5">NTLM HTTP</b>模块在“ <b id="9e8154c4">管理” |“</b>配置”中进行配置。在“HTTP认证模块”部分<b id="9e8154c4">验证</b>页面。</p><aside class="tip sideblock" rel="0ee924a2" id="59c37fa5" data-title=""><p id="00660f8b">有关配置身份验证的信息，请直接在<code class="code"><TeamCity Data Directory&gt;/config/auth\-config.xml</code> ，请参考<a href="https://confluence.jetbrains.com/display/TCD8/NTLM+HTTP+Authentication" rel="noopener noreferrer" data-external="true" target="_blank">以前的文档版本</a> 。</p></aside><p id="b0a49801">一旦TeamCity用户名与Windows域用户名相同或在用户配置文件中指定了Windows域用户名，就可以使用任何登录模块启用NTLM登录。</p><aside class="note " rel="b0a49801" id="6da92cee" data-title=""><p id="b927078b">仅<b id="fd09cd3c">Windows</b>机器上安装的TeamCity服务器支持NTLM HTTP身份验证。如果您在其他平台上需要它，请随时<a href="mailto:teamcity-support@jetbrains.com" data-external="true">与我们联系</a>以获取详细信息。</p></aside></div><a name="Requirements"></a><a name="Requirements"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-Requirements">要求</h2><ol class="list _decimal"><li class="list__item" id="3238f8ff"><p>身份验证用户应使用要用于身份验证的域帐户登录到客户端工作站。</p></li><li class="list__item" id="526bc271"><p>用户的Web浏览器应支持NTLM HTTP身份验证（TeamCity服务器URL应为“受信任的站点”，等等）</p></li></ol></div><a name="EnablingNTLMHTTPAuthentication"></a><a name="Enabling-NTLM-HTTP-Authentication"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-EnablingNTLMHTTPAuthentication">启用NTLM HTTP身份验证</h2><p id="94e31e60">配置NTLM HTTP身份验证模块后，用户将在登录屏幕上看到一个链接，单击该链接将强制浏览器发送域身份验证数据。</p><p id="4f0a66b5">您可以通过在“强制协议”设置中指定协议来强制服务器宣布NTLM HTTP身份验证。这将使服务器为对TeamCity Web UI的任何请求请求域身份验证。如果用户的浏览器在域环境中运行，则当前用户将自动登录。如果没有，浏览器将弹出一个对话框，询问域凭据。</p><p id="3502137b">如果没有此属性，则仅当客户端显式启动NTLM HTTP身份验证时（例如，单击登录页面上的“使用NT域帐户登录”链接），NTLM HTTP身份验证才能工作，并且在通常情况下，未经身份验证的用户将被简单地重定向到TeamCity登录名页。</p><p id="6b4c6bb7">默认情况下，TeamCity服务器仅对Windows用户强制执行NTLM HTTP身份验证。如果要为所有用户启用它，请设置以下<a href="configuring-teamcity-server-startup-properties.html">内部属性</a> ：</p><div class="code-block" data-lang="none">teamcity.ntlm.ignore.user.agent = true</div><a name="NTLMloginURLs"></a><a name="NTLM-login-URLs"></a><div class="chapter"><h3 id="NTLMHTTPAuthentication-NTLMloginURLs">NTLM登录URL</h3><p id="00772604">还有两种方法可以强制对某个连接进行NTLM身份验证（无需设置<code class="code">forceProtocols</code>这种情况下的属性）：</p><ul class="list _ul"><li class="list__item" id="d278e52b"><p>发送请求给<code class="code"><Your TeamCity server URL>/ntlmLogin.html</code>然后TeamCity将启动NTLM身份验证并将您重定向到概述页面。</p></li><li class="list__item" id="9405d13e"><p>发送请求给<code class="code"><Your TeamCity server URL>/ntlmAuth/<path></code>并且TeamCity将启动NTLM身份验证并显示<path>页面（不带重定向）。</path></p></li></ul></div></div><a name="UsingNTLMHTTPAuthenticationModulewithLDAPAuthentication"></a><a name="Using-NTLM-HTTP-Authentication-Module-with-LDAP-Authentication"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-UsingNTLMHTTPAuthenticationModulewithLDAPAuthentication">将NTLM HTTP身份验证模块与LDAP身份验证一起使用</h2><p id="32ce5e5c">使用LDAP身份验证时，可以拒绝某些用户的登录。NTLM HTTP身份验证模块（以及Windows域凭据身份验证模块）不具有这种功能，因此即使不允许他们通过LDAP登录，某些用户也可以使用Windows域帐户登录。要解决此问题，您应该启用<code class="code">Allow creating new users on the first login</code>相应身份验证模块的选项。</p><p id="fad869be">设置此属性后，用户只有在TeamCity中已经有一个现有帐户（即，如果他/她早先已经通过LDAP登录到TeamCity）且具有TeamCity用户名的情况下，才能通过其NT域帐户登录。等于Windows域用户名或在用户配置文件页面上指定的自定义NT域用户名。</p></div><a name="Configuringclient"></a><a name="Configuring-client"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-Configuringclient">配置客户端</h2><p id="526448b5">根据您的环境，您可能需要配置客户端以使NTLM身份验证起作用。</p><a name="InternetExplorer"></a><a name="Internet-Explorer"></a><h4 id="NTLMHTTPAuthentication-InternetExplorer">IE浏览器</h4><ol class="list _decimal"><li class="list__item" id="f521b547"><p>开启<b id="550726d2">工具| Internet选项</b> 。</p></li><li class="list__item" id="f72bbf9b"><p>在“ <b id="b537e5f9">高级”</b>选项卡上，确保选项“ <b id="416a3bb0">安全性” |“安全性”。</b>选中<b id="416a3bb0">启用集成Windows身份验证</b> 。</p></li><li class="list__item" id="07110ab3"><p>在“ <b id="8b1bbbaa">安全性”</b>选项卡上，选择“ <b id="c3312c80">本地Intranet”。网站|</b>单击<b id="c3312c80">高级，</b>然后将TeamCity服务器URL添加到列表中。</p></li></ol><a name="GoogleChrome"></a><a name="Google-Chrome"></a><h4 id="NTLMHTTPAuthentication-GoogleChrome">谷歌浏览器</h4><p id="3e97e823">在Windows上，Chrome通常使用IE的行为，请<a href="http://dev.chromium.org/developers/design-documents/http-authentication" rel="noopener noreferrer" data-external="true" target="_blank">在此处</a>查看更多信息。</p><a name="MozillaFirefox"></a><a name="Mozilla-Firefox"></a><h4 id="NTLMHTTPAuthentication-MozillaFirefox">火狐浏览器</h4><ol class="list _decimal"><li class="list__item" id="ac25b224"><p>类型<code class="code">about:config</code>在浏览器的地址栏中。</p></li><li class="list__item" id="4ebe1280"><p>将您的TeamCity服务器URL添加到<a href="http://kb.mozillazine.org/Network.automatic-ntlm-auth.trusted-uris" rel="noopener noreferrer" data-external="true" target="_blank">network.automatic-ntlm-auth.trusted-uris</a>属性。</p></li></ol></div><a name="Troubleshooting"></a><a name="Troubleshooting"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-Troubleshooting">故障排除</h2><p id="48e79149">有用的网址：</p><ul class="list _ul"><li class="list__item" id="bbda9690"><a href="http://waffle.codeplex.com/wikipage?title=Frequently Asked Questions" rel="noopener noreferrer" data-external="true" target="_blank">http://waffle.codeplex.com/wikipage?title=经常％20Asked％20问题</a></li><li class="list__item" id="0c0a31b2"><a href="http://waffle.codeplex.com/discussions/254748" rel="noopener noreferrer" data-external="true" target="_blank">http://waffle.codeplex.com/discussions/254748</a></li><li class="list__item" id="7c0615f2"><a href="http://waffle.codeplex.com/wikipage?title=Troubleshooting Negotiate&referringTitle=Documentation" rel="noopener noreferrer" data-external="true" target="_blank">http://waffle.codeplex.com/wikipage?title=故障排除％20Negotiate＆referringTitle =文档</a></li></ul><hr id="0cbd17ef"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>