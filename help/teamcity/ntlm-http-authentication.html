<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>NTLM HTTP Authentication - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="NTLM HTTP Authentication" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/teamcity-configuration-and-maintenance.md|TeamCity Configuration and Maintenance/configuring-authentication-settings.md|Configuring Authentication Settings/ntlm-http-authentication.md|NTLM HTTP Authentication" data-main-title="NTLM HTTP Authentication" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/ntlm-http-authentication.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="NTLM HTTP Authentication" id="ntlm-http-authentication.md">NTLM HTTP Authentication</h1><p id="c01dbf7e">The TeamCity NTLM HTTP authentication feature employs Integrated Windows Authentication and allows transparent/SSO login to the TeamCity web UI when using browsers/clients supporting NTLM and Negotiate HTTP authentications with NTLMv1, NTLMv1, NTLMv2 and Kerberos logic. The authentication is supported when the TeamCity server runs under Windows OS. Generally, it allows users to log in to the TeamCity server web UI using their NT domain account without the need to enter credentials manually.</p><a name="Configuration"></a><a name="Configuration"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-Configuration">Configuration</h2><p id="0ee924a2">The <b id="47d7b4c5">NTLM HTTP</b> module is configured on the <b id="9e8154c4">Administration | Authentication</b> page under the "HTTP authentication modules" section.</p><aside class="tip sideblock" data-title="" rel="0ee924a2" id="59c37fa5"><p id="00660f8b">For information on configuring authentication the settings directly in the <code class="code">&lt;TeamCity Data Directory&amp;gt;/config/auth\-config.xml</code>, refer to the <a href="https://confluence.jetbrains.com/display/TCD8/NTLM+HTTP+Authentication" data-external="true" target="_blank" rel="noopener noreferrer">previous documentation version</a>.</p></aside><p id="b0a49801">You can enable NTLM login with any login module once the TeamCity username is the same as the Windows domain username or the Windows domain username is specified on the user profile.</p><aside class="note " data-title="" rel="b0a49801" id="6da92cee"><p id="b927078b">NTLM HTTP authentication is supported only for TeamCity servers installed on <b id="fd09cd3c">Windows</b> machines. If you need it under other platforms, feel free to <a href="mailto:teamcity-support@jetbrains.com" data-external="true">contact us</a> with details as to why.</p></aside></div><a name="Requirements"></a><a name="Requirements"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-Requirements">Requirements</h2><ol class="list _decimal"><li class="list__item" id="3238f8ff"><p>The authenticating user should be logged in to the client workstation with the domain account that is to be used for the authentication.</p></li><li class="list__item" id="526bc271"><p>The user's web browser should support NTLM HTTP authentication (the TeamCity server URL should be a "trusted site", etc.)</p></li></ol></div><a name="EnablingNTLMHTTPAuthentication"></a><a name="Enabling-NTLM-HTTP-Authentication"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-EnablingNTLMHTTPAuthentication">Enabling NTLM HTTP Authentication</h2><p id="94e31e60">After the NTLM HTTP authentication module is configured, users will see a link on the login screen which, when clicked, will force the browser to send the domain authentication data.</p><p id="4f0a66b5">You can force the server to announce NTLM HTTP authentication by specifying protocols in the "Force protocols" setting. This will make the server request domain authentication for any request to the TeamCity web UI. If the user's browser is run in the domain environment, the current user will be logged in automatically. If not, the browser will pop up a dialog asking for domain credentials.</p><p id="3502137b">Without this attribute, NTLM HTTP authentication will work only if the client explicitly initiates it (e.g. clicks the "Login using NT domain account" link on the login page), and in the usual case an unauthenticated user will be simply redirected to the TeamCity login page.</p><p id="6b4c6bb7">The TeamCity server forces NTLM HTTP authentication only for Windows users by default. If you want to enable it for all users, set the following <a href="configuring-teamcity-server-startup-properties.html">internal property</a>:</p><div class="code-block" data-lang="none">teamcity.ntlm.ignore.user.agent=true

</div><a name="NTLMloginURLs"></a><a name="NTLM-login-URLs"></a><div class="chapter"><h3 id="NTLMHTTPAuthentication-NTLMloginURLs">NTLM login URLs</h3><p id="00772604">There are two more ways to force NTLM authentication for a certain connection (there is no need to set the <code class="code">forceProtocols</code> attribute for this case):</p><ul class="list _ul"><li class="list__item" id="d278e52b"><p>Send request to <code class="code">&lt;Your TeamCity server URL&gt;/ntlmLogin.html</code> and TeamCity will initiate NTLM authentication and redirect you to the overview page.</p></li><li class="list__item" id="9405d13e"><p>Send request to <code class="code">&lt;Your TeamCity server URL&gt;/ntlmAuth/&lt;path&gt;</code> and TeamCity will initiate NTLM authentication and show you the &lt;path&gt; page (without redirect).</p></li></ul></div></div><a name="UsingNTLMHTTPAuthenticationModulewithLDAPAuthentication"></a><a name="Using-NTLM-HTTP-Authentication-Module-with-LDAP-Authentication"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-UsingNTLMHTTPAuthenticationModulewithLDAPAuthentication">Using NTLM HTTP Authentication Module with LDAP Authentication</h2><p id="32ce5e5c">When using LDAP authentication, it is possible to deny login for some users. The NTLM HTTP authentication module (as well as the Windows domain credentials authentication module) does not have such functionality, so it can be possible for some users to log in using Windows domain account even if they are not allowed to log in via LDAP. To solve this problem, you should enable the <code class="code">Allow creating new users on the first login</code> option for the corresponding authentication module.</p><p id="fad869be">With this property set, a user will be able to log in via their NT domain account only if he/she already has an existing account in TeamCity (i.e. if he/she has already logged into TeamCity earlier via LDAP) with a TeamCity username which equals the Windows domain username or a custom NT domain username specified on the user's profile page.</p></div><a name="Configuringclient"></a><a name="Configuring-client"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-Configuringclient">Configuring client</h2><p id="526448b5">Depending on your environment, you may need to configure your client to make NTLM authentication work.</p><a name="InternetExplorer"></a><a name="Internet-Explorer"></a><h4 id="NTLMHTTPAuthentication-InternetExplorer">Internet Explorer</h4><ol class="list _decimal"><li class="list__item" id="f521b547"><p>Open <b id="550726d2">Tools | Internet Options</b>.</p></li><li class="list__item" id="f72bbf9b"><p>On the <b id="b537e5f9">Advanced</b> tab make sure the option <b id="416a3bb0">Security | Enable Integrated Windows Authentication</b> is checked.</p></li><li class="list__item" id="07110ab3"><p>On the <b id="8b1bbbaa">Security</b> tab select <b id="c3312c80">Local Intranet | Sites | Advanced</b> and add your TeamCity server URL to the list.</p></li></ol><a name="GoogleChrome"></a><a name="Google-Chrome"></a><h4 id="NTLMHTTPAuthentication-GoogleChrome">Google Chrome</h4><p id="3e97e823">On Windows, Chrome normally uses IE's behaviour, see more information <a href="http://dev.chromium.org/developers/design-documents/http-authentication" data-external="true" target="_blank" rel="noopener noreferrer">here</a>.</p><a name="MozillaFirefox"></a><a name="Mozilla-Firefox"></a><h4 id="NTLMHTTPAuthentication-MozillaFirefox">Mozilla Firefox</h4><ol class="list _decimal"><li class="list__item" id="ac25b224"><p>Type <code class="code">about:config</code> in the browser's address bar.</p></li><li class="list__item" id="4ebe1280"><p>Add your TeamCity server URL to the <a href="http://kb.mozillazine.org/Network.automatic-ntlm-auth.trusted-uris" data-external="true" target="_blank" rel="noopener noreferrer">network.automatic-ntlm-auth.trusted-uris</a> property.</p></li></ol></div><a name="Troubleshooting"></a><a name="Troubleshooting"></a><div class="chapter"><h2 id="NTLMHTTPAuthentication-Troubleshooting">Troubleshooting</h2><p id="48e79149">Helpful links:</p><ul class="list _ul"><li class="list__item" id="bbda9690"><a href="http://waffle.codeplex.com/wikipage?title=Frequently%20Asked%20Questions" data-external="true" target="_blank" rel="noopener noreferrer">http://waffle.codeplex.com/wikipage?title=Frequently%20Asked%20Questions</a></li><li class="list__item" id="0c0a31b2"><a href="http://waffle.codeplex.com/discussions/254748" data-external="true" target="_blank" rel="noopener noreferrer">http://waffle.codeplex.com/discussions/254748</a></li><li class="list__item" id="7c0615f2"><a href="http://waffle.codeplex.com/wikipage?title=Troubleshooting%20Negotiate&amp;referringTitle=Documentation" data-external="true" target="_blank" rel="noopener noreferrer">http://waffle.codeplex.com/wikipage?title=Troubleshooting%20Negotiate&amp;referringTitle=Documentation</a></li></ul><hr id="0cbd17ef"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>