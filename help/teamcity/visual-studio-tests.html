<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Visual Studio Tests - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Visual Studio Tests" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-build-steps.md|Configuring Build Steps/visual-studio-tests.md|Visual Studio Tests" data-main-title="Visual Studio Tests" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/visual-studio-tests.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Visual Studio Tests" id="visual-studio-tests.md">Visual Studio Tests</h1><p id="2e1095f3">The Visual Studio Tests runner integrates functionality of the MSTest framework and <a href="https://plugins.jetbrains.com/plugin/9056-vstest-console-runner" data-external="true" target="_blank" rel="noopener noreferrer">VSTest console runner</a>. Support for both frameworks enables TeamCity to execute tests and automatically import their test results.</p><p id="35e7d0a5">The Visual Studio Test Runner requires Visual Studio Test Agent or Microsoft Visual Studio installed on the build agent.</p><p id="97eac7cc">On this page:</p><p id="e651a058"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#VisualStudioTests-VisualStudioTestsrunnersettings">Visual Studio Tests runner settings</a><ul class="list _bullet"><li class="list__item"><a href="#VisualStudioTests-VSTestSettings">VSTest Settings</a><ul class="list _bullet"><li class="list__item"><a href="#VisualStudioTests-Customtestlogger">Custom test logger</a></li></ul></li><li class="list__item"><a href="#VisualStudioTests-MSTestsettings">MSTest settings</a></li></ul></li></ul></p><a name="VisualStudioTestsrunnersettings"></a><a name="Visual-Studio-Tests-runner-settings"></a><div class="chapter"><h2 id="VisualStudioTests-VisualStudioTestsrunnersettings">Visual Studio Tests runner settings</h2><div class="table-wrapper"><table width="100%" id="d765294c"><thead><tr id="c7155d6f" class="ijRowHead"><th id="ffb7337d"><p id="1494e4f1">Option</p></th><th id="203ce42c"><p id="67d53b8d">Description</p></th></tr></thead><tbody><tr id="7d6a6abf" class="ijRowOdd"><td id="0fa88bb6"><p id="a4053f11">Test engine type</p></td><td id="c0c37eab"><p id="3e41fc14">Select the tool used to run tests: VSTest or MSTest.</p></td></tr><tr id="1cc25d0d" class="ijRowEven"><td id="69951580"><p id="e4251844">Test engine version</p></td><td id="84a86dc0"><p id="6b659d08">Select the version of the tool from the drop-down. By default, the available VSTest and MSTest installations are autodetected by TeamCity:</p><ul class="list _ul"><li class="list__item" id="dbfdabaf"><p>MSTest versions 2005-2017 are supported</p></li><li class="list__item" id="73d5653a"><p>VSTest versions 2012-2017 are supported</p></li></ul><p id="8c82bc09">You can specify a custom path to the test runner here as well. TeamCity parameters are supported.</p><aside class="tip sideblock" data-title="" rel="8c82bc09" id="d3bb4d35"><p id="22522c23">You can specify the <a href="configuring-build-parameters.html#Defining-Build-Parameters-in-Build-Configuration">agent property</a> <code class="code">teamcity.dotnet.vstest.VS_VERSION.install.dir</code> pointing to a VSTest distribution path and use it here, where <code class="code">VS_VERSION</code> can be 11.0, 12.0, 14.0, 15.0, or 16.0. The property will have priority over registry values.</p></aside></td></tr><tr id="2e7c5d34" class="ijRowOdd"><td id="a1b01e02"><p id="6a283f72">Test file names</p></td><td id="549af372"><p id="9a7a3c74">This field is <b id="5f8448f0">mandatory for VSTest</b> and optional for MSTest.<br>Specify the new-line separated list of paths to assemblies to run tests on in the included assemblies list. Exclude assemblies from the test run by specifying paths to them in the corresponding field. <a href="wildcards.html">Wildcards</a> are supported.<br>Paths to the assemblies must be relative to the <a href="build-checkout-directory.html">build checkout directory</a>.</p></td></tr><tr id="44fdb58e" class="ijRowEven"><td id="e7ceffad"><p id="e53d5c2c">Run configuration file</p></td><td id="388470ac"><p id="6d107f50">(Optional) Specify the typical <code class="code">.runsettings</code> file for <a href="https://msdn.microsoft.com/library/jj155796.aspx" data-external="true" target="_blank" rel="noopener noreferrer">VSTest</a> or <code class="code">.testsettings</code> file for <a href="https://msdn.microsoft.com/library/ms182489.aspx#testsettings" data-external="true" target="_blank" rel="noopener noreferrer">MSTtest</a>. You can use the file browser <img alt="VCS-browserIcon.png" title="VCS-browserIcon.png" src="/help/img/teamcity/2019.1/VCS-browserIcon.png" id="068e8285" width="26" height="27" class="inline-icon-26">.</p></td></tr><tr id="ebcedb50" class="ijRowOdd"><td id="2ad63b3a"><p id="5e4a6e50">Additional command line parameters</p></td><td id="2565d780"><p id="812b99fa">Enter additional command line parameters for the selected test engine.<br>Note that tests run with MSTest are <b id="177eb221">not</b> reported on-the-fly.<br>The Microsoft Developer Network lists the available options for <a href="https://msdn.microsoft.com/en-us/library/jj155796.aspx" data-external="true" target="_blank" rel="noopener noreferrer">VSTest</a> and <a href="http://msdn.microsoft.com/en-us/library/ms182489(VS.80).aspx" data-external="true" target="_blank" rel="noopener noreferrer">MSTest</a>.</p></td></tr></tbody></table></div><p id="ed6a889c">The rest of settings will vary depending on the engine to run tests with:</p><ul class="list _ul"><li class="list__item" id="ef12ca9e"><a href="#VSTest-Settings">VSTest Settings</a></li><li class="list__item" id="a9881021"><a href="#MSTest-settings">MSTest Settings</a></li></ul><a name="VSTestSettings"></a><a name="VSTest-Settings"></a><div class="chapter"><h3 id="VisualStudioTests-VSTestSettings">VSTest Settings</h3><div class="table-wrapper"><table width="100%" id="1299296a"><thead><tr id="6ec9ca52" class="ijRowHead"><th id="9130ab46"><p id="89284f9f">Option</p></th><th id="180b2f0a"><p id="000f9ddd">Description</p></th></tr></thead><tbody><tr id="d6b0db58" class="ijRowOdd"><td id="7f751816"><p id="320019d9">Target platform</p></td><td id="d952796d"><p id="eb54d931">Select the platform bitness. Note that specifying x64 target platform will force the <code class="code">vstest.console</code> process to be run in the isolated mode</p></td></tr><tr id="36628bb5" class="ijRowEven"><td id="48dd130c"><p id="6ecdeda0">Framework</p></td><td id="483ee061"><p id="b267e315">If the default is specified, vstest.console will select the target framework automatically. You can also choose the .NET platform manually using the drop-down.</p></td></tr><tr id="269fb4f0" class="ijRowOdd"><td id="a43ed2c4"><p id="dbb608bf">Test names</p></td><td id="f6d3c972"><p id="07177667">(optional) Of all tests discovered in the included assemblies, only the tests with the names matching the provided values will be run. For multiple values, use new line.</p><p id="6588c687">If the field is empty, all tests will be run. See details in the <a href="https://msdn.microsoft.com/en-us/library/jj155800.aspx" data-external="true" target="_blank" rel="noopener noreferrer">Microsoft documentation</a>. Cannot be used with the option below.</p></td></tr><tr id="562f55a9" class="ijRowEven"><td id="536158dc"><p id="e7509710">Test case filter</p></td><td id="87eabccd"><p id="f4b035b3">Run tests that match the given expression. See details in the <a href="https://msdn.microsoft.com/en-us/library/jj155800.aspx" data-external="true" target="_blank" rel="noopener noreferrer">Microsoft documentation</a>. Cannot be used with the option above.</p></td></tr><tr id="fb0ef69e" class="ijRowOdd"><td id="ee380f57"><p id="29fa7275">Run in isolation</p></td><td id="cbd44271"><p id="f58bf24c">Run the tests in an isolated process</p></td></tr><tr id="e5540108" class="ijRowEven"><td id="293524ac"><p id="230d367e">Use real-time test reporting</p></td><td id="307cbf85"><ul class="list _ul"><li class="list__item" id="3e4969f4"><p>If this checkbox is selected, a custom TeamCity test logger will be used for real-time reporting. See the <a href="#Custom-test-logger">next section</a> for details.</p></li><li class="list__item" id="ba21d120"><p>If not selected, VSTest will report tests to TeamCity after the run (the discovery of custom logger will not be attempted).</p></li></ul><aside class="note " data-title="" rel="3f84d20f" id="33e982e7"><p id="003b5fd7">When using this option, it is recommended to check the number of tests in the produced <code class="code">trx</code> file against the build log. In case of incosistencies, switch to the custom logger.</p></aside></td></tr></tbody></table></div><a name="Customtestlogger"></a><a name="Custom-test-logger"></a><div class="chapter"><h4 id="VisualStudioTests-Customtestlogger">Custom test logger</h4><p id="f84d7007"><code class="code">VSTest.Console</code> supports custom loggers, i.e. libraries that can handle events that occur when tests are being executed.<br>TeamCity 9.0+ has a custom logger that provides real-time test reporting.<br>The logger must be installed manually on the agent machine, as it requires dlls to be copied to the <code class="code">Extensions</code> folder of the VSTest.Console. No agent restart is needed when the custom logger is installed.</p><p id="5518b93f"><b id="fa1dc9c6">To install the custom logger</b>:</p><p id="e3d8e677">1. Download the <a href="http://teamcity.jetbrains.com/guestAuth/app/rest/builds/buildType:TeamCityPluginsByJetBrains_TeamCityVSTestTestAdapter_Build,pinned:true,status:SUCCESS,branch:master,tags:release/artifacts/content/TeamCity.VSTest.TestLogger.zip" data-external="true" target="_blank" rel="noopener noreferrer">custom logger</a>.</p><p id="19f4b238">2. Extract the contents of the downloaded archive on the agent machine to the following path:</p><ul class="list _ul"><li class="list__item" id="866afa9d"><p>for VisualStudio 2019 update:</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES(x86)\Microsoft Visual Studio\2019&lt;Edition&gt;\Common7\IDE\Extensions\TestPlatform\Extensions

</div><ul class="list _ul"><li class="list__item" id="ac44859f"><p>for VisualStudio 2017 update 5 onwards:</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES(x86)\Microsoft Visual Studio\2017&lt;Edition&gt;\Common7\IDE\Extensions\TestPlatform\Extensions

</div><ul class="list _ul"><li class="list__item" id="d663031e"><p>for VisualStudio 2017 up to update 4:</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES(x86)\Microsoft Visual Studio\2017&lt;Edition&gt;\Common7\IDE\CommonExtensions\Microsoft\TestWindow\Extensions

</div><ul class="list _ul"><li class="list__item" id="70f2160f"><p>for VisualStudio 2015:</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES\Microsoft Visual Studio 14.0\Common7\IDE\CommonExtensions\Microsoft\TestWindow\Extensions

</div><ul class="list _ul"><li class="list__item" id="a473644d"><p>for VisualStudio 2013:</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES\Microsoft Visual Studio 12.0\Common7\IDE\CommonExtensions\Microsoft\TestWindow\Extensions

</div><ul class="list _ul"><li class="list__item" id="b2614e8c"><p>for VisualStudio 2012:</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES\Microsoft Visual Studio 11.0\Common7\IDE\CommonExtensions\Microsoft\TestWindow\Extensions

</div><p id="6ba51405">3. Check that the custom logger was installed correctly by executing <code class="code">vstest.console.exe /ListLoggers</code> in the console on the agent machine. If the logger was installed correctly, you will see the logger with FriendlyName <code class="code">TeamCity</code> listed:</p><div class="code-block" data-lang="bash">VSTest.TeamCityLogger.TeamCityLogger
Uri: logger://TeamCityLogger
FriendlyName: TeamCity{info}

</div></div></div><a name="MSTestsettings"></a><a name="MSTest-settings"></a><div class="chapter"><h3 id="VisualStudioTests-MSTestsettings">MSTest settings</h3><div class="table-wrapper"><table width="100%" id="eb702e4e"><thead><tr id="34555bc2" class="ijRowHead"><th id="6582d9bf"><p id="2a769c4a">Option</p></th><th id="ecb066d2"><p id="3bf0734e">Description</p></th></tr></thead><tbody><tr id="3e363ad4" class="ijRowOdd"><td id="9b346e4a"><p id="7a67f68e">MSTest metadata</p></td><td id="7ad8abf1"><p id="d0f80b25">Enter a value for <code class="code">/testmetadata:file</code> argument. See details in the <a href="https://msdn.microsoft.com/en-us/library/ms182489(VS.80).aspx#testmetadata" data-external="true" target="_blank" rel="noopener noreferrer">Microsoft documentation</a></p></td></tr><tr id="e5d5a67e" class="ijRowEven"><td id="467cf6d4"><p id="2239637b">Testlist from metadata to run</p></td><td id="700271e0"><p id="19532c90">Edit the Testlist. Every line will be translated into <code class="code">/testlist:line</code> argument. See details in the <a href="https://msdn.microsoft.com/en-us/library/ms182489(VS.80).aspx#testlist" data-external="true" target="_blank" rel="noopener noreferrer">Microsoft documentation</a>.</p></td></tr><tr id="553a275b" class="ijRowOdd"><td id="ef74240c"><p id="1a40296e">Test</p></td><td id="b0513f24"><p id="cc9bb7e6">Names of individual tests to run. This option will be translated into the series of <code class="code">/test:</code> arguments. See details in the <a href="https://msdn.microsoft.com/en-us/library/ms182489(VS.80).aspx#test" data-external="true" target="_blank" rel="noopener noreferrer">Microsoft documentation</a>.</p></td></tr><tr id="a4d869f3" class="ijRowEven"><td id="723cbd44"><p id="4c0fd194">Unique</p></td><td id="af5ef248"><p id="7550bf1d">Run the test only if one unique match is found for any specified test in test section</p></td></tr><tr id="a700c2b3" class="ijRowOdd"><td id="6ecc4d45"><p id="efd8150f">Results file</p></td><td id="4bb5bf68"><p id="9a7ae9a3">Enter a value for the <code class="code">/resultsfile:file_name</code> command-line argument. Parameter references are supported. It <b id="4bcc3491">is recommended to leave the field blank</b> to generate a temporary <code class="code">\*.trx</code> file in the build temporary directory. Note that the directory may be cleaned between the builds.</p><p id="8abe18d4">To save the test run results to a named non-default file, enter a value for the <code class="code">/resultsfile:file_name</code> command-line argument.</p><ul class="list _ul"><li class="list__item" id="01bef156"><p>If the path specified is relative, it will be relative to the build checkout directory. If the specified file already exists in the checkout directory, the build agent will attempt to delete the file. If the agent fails to delete it, the build will fail.<br>To create a <code class="code">*.trx</code> report in the build temporary directory, use <code class="code">%system.teamcity.build.tempDir%.</code></p></li></ul><aside class="note " data-title="" rel="f2275bb4" id="a11e18c4"><p id="4d00339d">If you need to generate your results file in the checkout directory, consider adding the <a href="build-files-cleaner-swabra.html">Swabra</a> build feature to your configuration.</p></aside><ul class="list _ul"><li class="list__item" id="b18d4963"><p>If the path specified is absolute, it will be used "as is".</p></li></ul></td></tr></tbody></table></div><hr id="9fcaf728"></div></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>