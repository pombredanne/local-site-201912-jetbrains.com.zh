<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Visual Studio测试-帮助|帮助团队城市</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Visual Studio Tests" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-build-steps.md|Configuring Build Steps/visual-studio-tests.md|Visual Studio Tests" data-main-title="Visual Studio Tests" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/visual-studio-tests.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="visual-studio-tests.md" data-toc="Visual Studio Tests">Visual Studio测试</h1><p id="2e1095f3">Visual Studio Tests运行程序集成了MSTest框架和<a href="https://plugins.jetbrains.com/plugin/9056-vstest-console-runner" rel="noopener noreferrer" data-external="true" target="_blank">VSTest控制台</a>运行程序的功能。对这两个框架的支持使TeamCity能够执行测试并自动导入其测试结果。</p><p id="35e7d0a5">Visual Studio Test Runner需要在生成代理上安装Visual Studio测试代理或Microsoft Visual Studio。</p><p id="97eac7cc">在此页：</p><p id="e651a058"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#VisualStudioTests-VisualStudioTestsrunnersettings">Visual Studio测试运行程序设置</a><ul class="list _bullet"><li class="list__item"><a href="#VisualStudioTests-VSTestSettings">VSTest设置</a><ul class="list _bullet"><li class="list__item"><a href="#VisualStudioTests-Customtestlogger">定制测试记录仪</a></li></ul></li><li class="list__item"><a href="#VisualStudioTests-MSTestsettings">MSTest设置</a></li></ul></li></ul><p></p><a name="VisualStudioTestsrunnersettings"></a><a name="Visual-Studio-Tests-runner-settings"></a><div class="chapter"><h2 id="VisualStudioTests-VisualStudioTestsrunnersettings">Visual Studio测试运行程序设置</h2><div class="table-wrapper"><table width="100%" id="d765294c"><thead><tr id="c7155d6f" class="ijRowHead"><th id="ffb7337d"><p id="1494e4f1">选项</p></th><th id="203ce42c"><p id="67d53b8d">描述</p></th></tr></thead><tbody><tr id="7d6a6abf" class="ijRowOdd"><td id="0fa88bb6"><p id="a4053f11">测试引擎类型</p></td><td id="c0c37eab"><p id="3e41fc14">选择用于运行测试的工具：VSTest或MSTest。</p></td></tr><tr id="1cc25d0d" class="ijRowEven"><td id="69951580"><p id="e4251844">测试引擎版本</p></td><td id="84a86dc0"><p id="6b659d08">从下拉列表中选择工具的版本。默认情况下，TeamCity自动检测可用的VSTest和MSTest安装：</p><ul class="list _ul"><li class="list__item" id="dbfdabaf"><p>支持MSTest 2005-2017版</p></li><li class="list__item" id="73d5653a"><p>支持VSTest版本2012-2017</p></li></ul><p id="8c82bc09">您也可以在此处指定测试运行器的自定义路径。支持TeamCity参数。</p><aside class="tip sideblock" rel="8c82bc09" id="d3bb4d35" data-title=""><p id="22522c23">您可以指定<a href="configuring-build-parameters.html#Defining-Build-Parameters-in-Build-Configuration">代理属性</a> <code class="code">teamcity.dotnet.vstest.VS_VERSION.install.dir</code>指向VSTest分发路径并在此处使用<code class="code">VS_VERSION</code>可以是11.0、12.0、14.0、15.0或16.0。该属性将优先于注册表值。</p></aside></td></tr><tr id="2e7c5d34" class="ijRowOdd"><td id="a1b01e02"><p id="6a283f72">测试文件名</p></td><td id="549af372"><p id="9a7a3c74">该字段<b id="5f8448f0">对于VSTest</b>是<b id="5f8448f0">必填</b>字段，对于MSTest是可选字段。<br>在要包含的程序集列表中指定要运行测试的程序集路径的换行符列表。通过在相应字段中指定程序集的路径，将它们从测试运行中排除。支持<a href="wildcards.html">通配符</a> 。<br>程序集的路径必须相对于<a href="build-checkout-directory.html">build checkout目录</a> 。</p></td></tr><tr id="44fdb58e" class="ijRowEven"><td id="e7ceffad"><p id="e53d5c2c">运行配置文件</p></td><td id="388470ac"><p id="6d107f50">（可选）指定典型值<code class="code">.runsettings</code> <a href="https://msdn.microsoft.com/library/jj155796.aspx" rel="noopener noreferrer" data-external="true" target="_blank">VSTest的</a>文件或<code class="code">.testsettings</code> <a href="https://msdn.microsoft.com/library/ms182489.aspx#testsettings" rel="noopener noreferrer" data-external="true" target="_blank">MSTtest的</a>文件。您可以使用文件浏览器<img alt="VCS-browserIcon.png" title="VCS-browserIcon.png" src="/help/img/teamcity/2019.1/VCS-browserIcon.png" id="068e8285" width="26" height="27" class="inline-icon-26"> 。</p></td></tr><tr id="ebcedb50" class="ijRowOdd"><td id="2ad63b3a"><p id="5e4a6e50">附加命令行参数</p></td><td id="2565d780"><p id="812b99fa">输入所选测试引擎的其他命令行参数。<br>请注意， <b id="177eb221">不会</b>即时报告使用MSTest运行的测试。<br>Microsoft开发人员网络列出了<a href="https://msdn.microsoft.com/en-us/library/jj155796.aspx" rel="noopener noreferrer" data-external="true" target="_blank">VSTest</a>和<a href="http://msdn.microsoft.com/en-us/library/ms182489(VS.80).aspx" rel="noopener noreferrer" data-external="true" target="_blank">MSTest</a>的可用选项。</p></td></tr></tbody></table></div><p id="ed6a889c">其余设置将根据运行以下测试的引擎而有所不同：</p><ul class="list _ul"><li class="list__item" id="ef12ca9e"><a href="#VSTest-Settings">VSTest设置</a></li><li class="list__item" id="a9881021"><a href="#MSTest-settings">MSTest设置</a></li></ul><a name="VSTestSettings"></a><a name="VSTest-Settings"></a><div class="chapter"><h3 id="VisualStudioTests-VSTestSettings">VSTest设置</h3><div class="table-wrapper"><table width="100%" id="1299296a"><thead><tr id="6ec9ca52" class="ijRowHead"><th id="9130ab46"><p id="89284f9f">选项</p></th><th id="180b2f0a"><p id="000f9ddd">描述</p></th></tr></thead><tbody><tr id="d6b0db58" class="ijRowOdd"><td id="7f751816"><p id="320019d9">目标平台</p></td><td id="d952796d"><p id="eb54d931">选择平台位数。请注意，指定x64目标平台将强制<code class="code">vstest.console</code>进程以隔离模式运行</p></td></tr><tr id="36628bb5" class="ijRowEven"><td id="48dd130c"><p id="6ecdeda0">构架</p></td><td id="483ee061"><p id="b267e315">如果指定了默认值，则vstest.console将自动选择目标框架。您也可以使用下拉菜单手动选择.NET平台。</p></td></tr><tr id="269fb4f0" class="ijRowOdd"><td id="a43ed2c4"><p id="dbb608bf">测试名称</p></td><td id="f6d3c972"><p id="07177667">（可选）在包含的程序集中发现的所有测试中，只有名称与提供的值匹配的测试才会运行。对于多个值，请使用换行符。</p><p id="6588c687">如果该字段为空，则将运行所有测试。请参阅<a href="https://msdn.microsoft.com/en-us/library/jj155800.aspx" rel="noopener noreferrer" data-external="true" target="_blank">Microsoft文档中的</a>详细信息。不能与以下选项一起使用。</p></td></tr><tr id="562f55a9" class="ijRowEven"><td id="536158dc"><p id="e7509710">测试用例过滤器</p></td><td id="87eabccd"><p id="f4b035b3">运行与给定表达式匹配的测试。请参阅<a href="https://msdn.microsoft.com/en-us/library/jj155800.aspx" rel="noopener noreferrer" data-external="true" target="_blank">Microsoft文档中的</a>详细信息。不能与以上选项一起使用。</p></td></tr><tr id="fb0ef69e" class="ijRowOdd"><td id="ee380f57"><p id="29fa7275">孤立运行</p></td><td id="cbd44271"><p id="f58bf24c">在隔离的过程中运行测试</p></td></tr><tr id="e5540108" class="ijRowEven"><td id="293524ac"><p id="230d367e">使用实时测试报告</p></td><td id="307cbf85"><ul class="list _ul"><li class="list__item" id="3e4969f4"><p>如果选中此复选框，则将使用自定义的TeamCity测试记录器进行实时报告。有关详细信息，请参见<a href="#Custom-test-logger">下一部分</a> 。</p></li><li class="list__item" id="ba21d120"><p>如果未选择，VSTest将在运行后向TeamCity报告测试（将不会尝试发现自定义记录器）。</p></li></ul><aside class="note " rel="3f84d20f" id="33e982e7" data-title=""><p id="003b5fd7">使用此选项时，建议检查生产的测试数量<code class="code">trx</code>生成日志中的文件。如果出现混乱，请切换到自定义记录器。</p></aside></td></tr></tbody></table></div><a name="Customtestlogger"></a><a name="Custom-test-logger"></a><div class="chapter"><h4 id="VisualStudioTests-Customtestlogger">定制测试记录仪</h4><p id="f84d7007"><code class="code">VSTest.Console</code>支持自定义记录器，即可以处理执行测试时发生的事件的库。<br>TeamCity 9.0+具有自定义记录器，可提供实时测试报告。<br>记录器必须手动安装在代理计算机上，因为它需要将dll复制到<code class="code">Extensions</code> VSTest.Console的文件夹。安装自定义记录器后，无需重新启动代理。</p><p id="5518b93f"><b id="fa1dc9c6">要安装自定义记录器</b> ：</p><p id="e3d8e677">1。下载<a href="http://teamcity.jetbrains.com/guestAuth/app/rest/builds/buildType:TeamCityPluginsByJetBrains_TeamCityVSTestTestAdapter_Build,pinned:true,status:SUCCESS,branch:master,tags:release/artifacts/content/TeamCity.VSTest.TestLogger.zip" rel="noopener noreferrer" data-external="true" target="_blank">自定义记录器</a> 。</p><p id="19f4b238">2。将代理计算机上已下载的归档文件的内容提取到以下路径：</p><ul class="list _ul"><li class="list__item" id="866afa9d"><p>对于VisualStudio 2019更新：</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES（x86）\ Microsoft Visual Studio \ 2019 <edition>\ Common7 \ IDE \ Extensions \ TestPlatform \ Extensions</edition></div><ul class="list _ul"><li class="list__item" id="ac44859f"><p>对于Visual Studio 2017 Update 5及更高版本：</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES（x86）\ Microsoft Visual Studio \ 2017 <edition>\ Common7 \ IDE \ Extensions \ TestPlatform \ Extensions</edition></div><ul class="list _ul"><li class="list__item" id="d663031e"><p>适用于Visual Studio 2017更新4：</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES（x86）\ Microsoft Visual Studio \ 2017 <edition>\ Common7 \ IDE \ CommonExtensions \ Microsoft \ TestWindow \ Extensions</edition></div><ul class="list _ul"><li class="list__item" id="70f2160f"><p>对于VisualStudio 2015：</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES \ Microsoft Visual Studio 14.0 \ Common7 \ IDE \ CommonExtensions \ Microsoft \ TestWindow \ Extensions</div><ul class="list _ul"><li class="list__item" id="a473644d"><p>对于VisualStudio 2013：</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES \ Microsoft Visual Studio 12.0 \ Common7 \ IDE \ CommonExtensions \ Microsoft \ TestWindow \ Extensions</div><ul class="list _ul"><li class="list__item" id="b2614e8c"><p>对于VisualStudio 2012：</p></li></ul><div class="code-block" data-lang="none">PROGRAM_FILES \ Microsoft Visual Studio 11.0 \ Common7 \ IDE \ CommonExtensions \ Microsoft \ TestWindow \ Extensions</div><p id="6ba51405">3。通过执行以下命令检查自定义记录器是否正确安装<code class="code">vstest.console.exe /ListLoggers</code>在代理计算机上的控制台中。如果记录仪安装正确，您将看到带有FriendlyName的记录仪<code class="code">TeamCity</code>列出：</p><div class="code-block" data-lang="bash">VSTest.TeamCityLogger。TeamCityLogger Uri：logger：// TeamCityLogger FriendlyName：TeamCity {info}</div></div></div><a name="MSTestsettings"></a><a name="MSTest-settings"></a><div class="chapter"><h3 id="VisualStudioTests-MSTestsettings">MSTest设置</h3><div class="table-wrapper"><table width="100%" id="eb702e4e"><thead><tr id="34555bc2" class="ijRowHead"><th id="6582d9bf"><p id="2a769c4a">选项</p></th><th id="ecb066d2"><p id="3bf0734e">描述</p></th></tr></thead><tbody><tr id="3e363ad4" class="ijRowOdd"><td id="9b346e4a"><p id="7a67f68e">MSTest元数据</p></td><td id="7ad8abf1"><p id="d0f80b25">输入一个值<code class="code">/testmetadata:file</code>论点。请参阅<a href="https://msdn.microsoft.com/en-us/library/ms182489(VS.80).aspx#testmetadata" rel="noopener noreferrer" data-external="true" target="_blank">Microsoft文档中的</a>详细信息</p></td></tr><tr id="e5d5a67e" class="ijRowEven"><td id="467cf6d4"><p id="2239637b">从元数据开始运行的测试列表</p></td><td id="700271e0"><p id="19532c90">编辑测试列表。每行将被翻译成<code class="code">/testlist:line</code>论点。请参阅<a href="https://msdn.microsoft.com/en-us/library/ms182489(VS.80).aspx#testlist" rel="noopener noreferrer" data-external="true" target="_blank">Microsoft文档中的</a>详细信息。</p></td></tr><tr id="553a275b" class="ijRowOdd"><td id="ef74240c"><p id="1a40296e">测试</p></td><td id="b0513f24"><p id="cc9bb7e6">要运行的各个测试的名称。此选项将翻译为<code class="code">/test:</code>论点。请参阅<a href="https://msdn.microsoft.com/en-us/library/ms182489(VS.80).aspx#test" rel="noopener noreferrer" data-external="true" target="_blank">Microsoft文档中的</a>详细信息。</p></td></tr><tr id="a4d869f3" class="ijRowEven"><td id="723cbd44"><p id="4c0fd194">独特</p></td><td id="af5ef248"><p id="7550bf1d">仅在测试部分中为任何指定测试找到唯一匹配项时才运行测试</p></td></tr><tr id="a700c2b3" class="ijRowOdd"><td id="6ecc4d45"><p id="efd8150f">结果文件</p></td><td id="4bb5bf68"><p id="9a7ae9a3">输入一个值<code class="code">/resultsfile:file_name</code>命令行参数。支持参数引用。<b id="4bcc3491">建议将该字段留空</b>以生成临时<code class="code">\*.trx</code>文件放在构建临时目录中。请注意，可能在两次构建之间清除目录。</p><p id="8abe18d4">要将测试运行结果保存到命名的非默认文件中，请为<code class="code">/resultsfile:file_name</code>命令行参数。</p><ul class="list _ul"><li class="list__item" id="01bef156"><p>如果指定的路径是相对路径，则它将相对于build checkout目录。如果指定的文件已经存在于checkout目录中，则构建代理将尝试删除该文件。如果代理无法删除它，则构建将失败。<br>创建一个<code class="code">*.trx</code>在构建临时目录中报告，使用<code class="code">%system.teamcity.build.tempDir%.</code></p></li></ul><aside class="note " rel="f2275bb4" id="a11e18c4" data-title=""><p id="4d00339d">如果您需要在checkout目录中生成结果文件，请考虑将<a href="build-files-cleaner-swabra.html">Swabra</a>构建功能添加到您的配置中。</p></aside><ul class="list _ul"><li class="list__item" id="b18d4963"><p>如果指定的路径是绝对路径，则将“按原样”使用。</p></li></ul></td></tr></tbody></table></div><hr id="9fcaf728"></div></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>