<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Projects Import - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Projects Import" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/teamcity-configuration-and-maintenance.md|TeamCity Configuration and Maintenance/projects-import.md|Projects Import" data-main-title="Projects Import" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/projects-import.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Projects Import" id="projects-import.md">Projects Import</h1><p id="2e25c6bb">On this page:</p><p id="1947af16"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#ProjectsImport-ProjectsImportorServerMove">Projects Import or Server Move</a></li><li class="list__item"><a href="#ProjectsImport-Importingprojects">Importing projects</a><ul class="list _bullet"><li class="list__item"><a href="#ProjectsImport-Selectingprojectsforimport">Selecting projects for import</a></li><li class="list__item"><a href="#ProjectsImport-Definingimportscope">Defining import scope</a></li><li class="list__item"><a href="#ProjectsImport-Configurationfilesimport">Configuration files import</a></li><li class="list__item"><a href="#ProjectsImport-Importingusersandgroups">Importing users and groups</a></li><li class="list__item"><a href="#ProjectsImport-Conflicts">Conflicts</a></li></ul></li><li class="list__item"><a href="#ProjectsImport-Datanotincludedintoimport">Data not included into import</a></li><li class="list__item"><a href="#ProjectsImport-Movingartifactsandlogs">Moving artifacts and logs</a></li><li class="list__item"><a href="#ProjectsImport-ViewingImportResults">Viewing Import Results</a></li></ul></p><p id="fd6c4e9f">You can import projects with all their data and user accounts from a backup file to an existing TeamCity server, i.e. to add projects from one server to the target server that is normally used.</p><a name="ProjectsImportorServerMove"></a><a name="Projects-Import-or-Server-Move"></a><div class="chapter"><h2 id="ProjectsImport-ProjectsImportorServerMove">Projects Import or Server Move</h2><p id="a285e38c">Projects Import should be used only when some projects need to be added to an existing server containing some other projects, i.e. when you need to merge two servers into a single one. That is because the import is a disruptive operation and <a href="#Data-not-included-into-import">not all data is imported</a>.<br>If you need to move all the server data to a different machine, use <a href="how-to.html#Move-TeamCity-Installation-to-a-New-Machine">server move</a>.</p></div><a name="Importingprojects"></a><a name="Importing-projects"></a><div class="chapter"><h2 id="ProjectsImport-Importingprojects">Importing projects</h2><p id="6d5b0320">On the source TeamCity server:</p><ul class="list _ul"><li class="list__item" id="cee3aa04"><p><a href="creating-backup-from-teamcity-web-ui.html">Create a usual backup</a> file containing the projects to be imported (note that the <b id="8aba064d"><a href="upgrade.html#Upgrading-TeamCity-Server">major and minor versions</a> of the source and target TeamCity servers have to be the same</b>)</p></li></ul><p id="de5e0229">On the target TeamCity server:</p><ul class="list _ul"><li class="list__item" id="90e62f73"><p>Go to the <b id="3fd6687b">Server Administration</b> area and select <b id="ce6e6c2a">Project Import</b> on the left. Upload your project settings and follow the wizard. When the import finishes, TeamCity will display the results.</p></li></ul><aside class="warning " data-title="" rel="4fcb69dc" id="4617436e"><p id="9624664f">To complete the import, you need to copy the artifacts from the old server to the new one by running the <a href="#Moving-artifacts-and-logs">provided scripts</a>: check details in the import log.</p></aside><aside class="tip sideblock" data-title="" rel="ProjectsImport-Importingprojects" id="74b21aae"><p id="3c21b342">Projects import functionality does not support external artifacts storage. If you use external artifacts storage, you will need to move the externally stored artifacts manually to new locations using the build ids mapping generated during the import. Contact <a href="https://confluence.jetbrains.com/display/TW/Feedback" data-external="true" target="_blank" rel="noopener noreferrer">TeamCity support</a> for details.</p></aside><a name="Selectingprojectsforimport"></a><a name="Selecting-projects-for-import"></a><div class="chapter"><h3 id="ProjectsImport-Selectingprojectsforimport">Selecting projects for import</h3><p id="6b61df48">After selecting a backup file, you need to specify which projects will be imported.</p><p id="8cf362e9">TeamCity will analyze the selected projects to see if they will be imported, merged or skipped.</p><ul class="list _ul"><li class="list__item" id="05393739"><p>The project will be <b id="56443772">imported</b> if it is new for the target server. All its entities (Build Configurations, Templates, Builds, etc) and their data will be created on the target server.</p></li><li class="list__item" id="cfe8754a"><p>The project will be <b id="3e49af71">merged</b> if the same project already exists on the target server (if the source and target project have the same <a href="identifier.html#Universally-Unique-IDs">UUID</a> and <a href="identifier.html#External-IDs">external ID</a>).<br>During merging the existing entities will remain intact and only the entities new for the target will be imported with the related data.<br>The data for the existing entities will not be imported or merged: new data will not be added to the existing entities (for example, changes will not added to an existing VCS root), the existing files will not be changed (for example, if the same template exists on both servers with different settings, the target file will be preserved).<br>It means, for example, that you cannot import missing builds to the existing build configuration. If you need to add the missing data to the existing entities, for example, import new builds into an already imported build configuration, then you should remove this build configuration using the UI and re-import its project.</p></li><li class="list__item" id="efb24648"><p>The project will be <b id="1279a832">skipped</b> if a <a href="#Conflicts">conflict</a> occurs: either the project's <a href="identifier.html">UUID</a> is new but its <a href="identifier.html#External-IDs">external ID</a> already exists on the target; or if the source and target projects have the same <a href="identifier.html#Universally-Unique-IDs">UUID</a> but different <a href="identifier.html#External-IDs">external IDs</a>.</p></li></ul></div><a name="Definingimportscope"></a><a name="Defining-import-scope"></a><div class="chapter"><h3 id="ProjectsImport-Definingimportscope">Defining import scope</h3><p id="c56b24d9">You can select the import scope: choose among project settings, builds and changes history, and user accounts or import all of them. Since an imported project can also use settings from its parent, TeamCity will also import all the vcs roots, templates, meta-runners and other project-related settings for parent projects. If the same project already exists on the target server, the existing objects will not be overwritten.</p></div><a name="Configurationfilesimport"></a><a name="Configuration-files-import"></a><div class="chapter"><h3 id="ProjectsImport-Configurationfilesimport">Configuration files import</h3><p id="560b2986">For each imported or merged project, the configuration files are imported to the <a href="teamcity-data-directory.html">Data Directory</a> on the target server, provided they are new for the target. The existing files will not be changed.</p><p id="be301a42">The following files are imported:</p><ul class="list _ul"><li class="list__item" id="162085d0"><p>Configuration xml files for the Project with its Build Configurations, Templates, and VCS Roots as well as its subprojects.</p></li><li class="list__item" id="71155975"><p>All files from the &lt;<a href="teamcity-data-directory.html">TeamCity Data Directory</a>&gt;/plugins directory.</p></li><li class="list__item" id="f21843e8"><p>Build Numbers files for the newly added build configurations.</p></li></ul></div><a name="Importingusersandgroups"></a><a name="Importing-users-and-groups"></a><div class="chapter"><h3 id="ProjectsImport-Importingusersandgroups">Importing users and groups</h3><p id="186e9835">When users are selected for import, TeamCity will analyze the usernames to see if users will be <b id="52473662">imported</b> or <b id="7580ea35">merged</b>.</p><p id="fcd1b1f6">TeamCity users must have unique usernames.</p><ul class="list _ul"><li class="list__item" id="df69102e"><p id="f8cf4716">A user account whose username is new for the target server will be <b id="f1666025">imported</b>. Such users appear on the target server in a separate group marked <i id="ed852cce">Imported &lt;Import Date Time&gt;</i>. All the related data (personal builds, changes, test mutes and investigations) will be created on the target server. The <a href="managing-your-user-account.html">user account settings</a> (roles, permissions, VCS names, notification settings, and so on: system-wide settings as well as the settings related to the imported projects) are preserved during import.</p></li><li class="list__item" id="99b36174"><p id="eedf34b6">User accounts with the same username on the source and the target servers can be <b id="640009ce">merged</b>. During merging the existing data will remain intact and only the data new for the target will be added: all the new user-related data (personal builds, changes, test mutes and investigations) and the <a href="managing-your-user-account.html">user account settings</a> (roles, permissions, VCS names, notification settings, and so on: system-wide settings as well as the settings related to the imported projects) will be added to the user on the target server.<br>(!) Merging may cause a problem if the same username belongs to different users on the source and the target server: during import the user information will be merged anyway.<br><b id="72f8f6e0">Note</b> that the scope of user permissions on the target may change after import, for example:</p><ul class="list _ul"><li class="list__item" id="32926e73"><p>if a user has the system administrator role on the source, this role will be added to the user on the target after import,</p></li><li class="list__item" id="bd14b554"><p>if a user has several roles in several projects on the source, only the new roles for the projects within the import scope will be added on the target.</p></li></ul><p id="3d289819"><b id="158dbe6c">The Project Import</b> page | <b id="b09b1446">Import scope</b> section | <b id="5439aad9">Users</b> will display the number of conflicts and you can view them and decide is you want to merge them.</p><p id="51621d24">TeamCity will show users with the same username and different emails on both servers, as well as the number of users with the same username and the same email. Email verification <a href="enabling-email-verification.html">can be enabled</a> for the server,  and the users with the same username and email are compared based on their email verification.  You can view the conflicts information and choose whether to merge the users found. The options are active if users with verified emails are present either on the source or the target TeamCity server, or both.</p></li></ul><p id="b81b4a63">Import of user groups works the same way: new groups are imported, while the existing groups can be merged.</p><p id="33d20b84">If a <a href="#Conflicts">conflict</a> occurs (the groups exists on both the source and the target, but the group roles are different), after import the group on the target server may get additional roles. As a result, a member of this group on the target will get additional roles and permissions as well.</p><p id="49913a62">The <b id="218f924c">Project Import</b> page | <b id="7fa34ecd">Import scope</b> section | <b id="f8ac0596">Groups</b> will display how many conflicting groups are found. You can view all the groups that have the same group key and decide if you want to merge them. Note that <a href="user-group.html#&#34;All-Users&#34;-Group">"All Users" group</a> is always listed as a conflicting one because it is a default group on all TeamCity servers.</p></div><a name="Conflicts"></a><a name="Conflicts"></a><div class="chapter"><h3 id="ProjectsImport-Conflicts">Conflicts</h3><p id="fe599b8c">TeamCity does not import entities from the backup file if they conflict with some entity on the target server. Before import, TeamCity analyzes the backup file and displays all detected conflicts on the <b id="e2fe509c">Import Scope</b> configuration page.</p><p id="7b31b6d2">It is <b id="1f6757c4">highly recommended to resolve all conflicts</b> before proceeding with the import, as unresolved conflicts may result in unpredictable behavior after the import, for example:</p><ul class="list _ul"><li class="list__item" id="b8211c95"><p>Critical errors can be shown if, for example, some VCS Root was skipped, but a Build Configuration depending on it was imported.</p></li><li class="list__item" id="93a452e4"><p>Imported Build Configurations may refer to the wrong Template if there was an unresolved conflict of <a href="identifier.html#External-IDs">external IDs</a> between the templates from the source and target servers.</p></li></ul><p id="8cb7b301">If the conflicts have not been resolved before importing, you can find the conflicting files in the <code class="code">conflictingFiles</code> directory under the import results logs.</p></div></div><a name="Datanotincludedintoimport"></a><a name="Data-not-included-into-import"></a><div class="chapter"><h2 id="ProjectsImport-Datanotincludedintoimport">Data not included into import</h2><p id="007fa02c">There is a number of limitations regarding the import:</p><ul class="list _ul"><li class="list__item" id="06d64b93"><p>Agents and agent pools are not imported (<a href="https://youtrack.jetbrains.com/issue/TW-39797" data-external="true" target="_blank" rel="noopener noreferrer">TW-39797</a>).</p></li><li class="list__item" id="9c778e51"><p>Settings are merged on "by file" basis. This means that new files are added but no settings files are merged. For example, if a project being imported already exists on the target server, its parameters, project features, and plugin settings will not be merged.</p></li><li class="list__item" id="81180878"><p>If you use the "Store secure values (like passwords or API tokens) outside of VCS" option for version settings, then the credentials will not be imported for the projects already existing on the server.</p></li><li class="list__item" id="0d1e70cb"><p>Audit records are imported only if users are selected in the scope.</p></li><li class="list__item" id="111e26fe"><p>Running builds and the build queue are not included in the backup and not imported.</p></li><li class="list__item" id="92b3bec9"><p>Internal ids (like ids of the builds) are not preserved during import. This means that URLs to the build results pages from the old server will appear broken even if redirected to the new server as build ids change on importing.</p></li><li class="list__item" id="9b2a0582"><p>The backup files do not contain artifacts and logs (build logs are stored under build artifacts), so these are not imported automatically, but TeamCity provides scripts to move them <a href="#Moving-artifacts-and-logs">manually</a>.</p></li><li class="list__item" id="4c0ed8dc"><p>Global server settings (authentication schemes, custom roles, and so on) are not imported.</p></li></ul><aside class="note " data-title="" rel="0589f882" id="62047943"><p id="11789c64">Importing projects may take significant time.There can be only one import process per server.</p></aside></div><a name="Movingartifactsandlogs"></a><a name="Moving-artifacts-and-logs"></a><div class="chapter"><h2 id="ProjectsImport-Movingartifactsandlogs">Moving artifacts and logs</h2><p id="353ddcf9">Although artifacts and logs are not imported right from the backup file, you can copy/move them from the source to the target server using the <code class="code">.bat</code> and <code class="code">.sh</code> scripts from the <code class="code">projectsImport-&lt;date&gt;</code> directory under TeamCity logs. These scripts accept the source and target data directories via the command line; the scripts accept the source and target <a href="build-artifact.html">artifact directories</a>. The rest is done automatically. The scripts can be executed while the server is running.</p><p id="c2eaf045">It may take some time for TeamCity to display the imported build artifacts.</p></div><a name="ViewingImportResults"></a><a name="Viewing-Import-Results"></a><div class="chapter"><h2 id="ProjectsImport-ViewingImportResults">Viewing Import Results</h2><p id="5ff323ff">Each import process creates the <code class="code">projectsImport-&lt;date&gt;</code> directory under the TeamCity logs allowing you to view the import results.</p><p id="f8eaa56f">The directory contains the following:</p><ul class="list _ul"><li class="list__item" id="e1c1143d"><p>conflicting files folder, containing all data which has been merged</p></li><li class="list__item" id="67db6a3c"><p>mappings, containing mapping of the fields in the source and target databases</p></li><li class="list__item" id="9d98a443"><p>scripts for copying artifacts and logs (see the section <a href="#Moving-artifacts-and-logs">above</a>)</p></li><li class="list__item" id="708338c5"><p>import report, listing import results including the information on the data which has not been imported (if any)</p></li></ul><hr id="dc93cee1"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>