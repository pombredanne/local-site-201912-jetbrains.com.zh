<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>VCS标签-帮助|团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="VCS Labeling" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/adding-build-features.md|Adding Build Features/vcs-labeling.md|VCS Labeling" data-main-title="VCS Labeling" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/vcs-labeling.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="vcs-labeling.md" data-toc="VCS Labeling">VCS标签</h1><p id="032c7d43">TeamCity可以在版本控制中（自动或手动）标记（标记）特定内部版本的源。应用的标签列表及其应用状态显示在构建结果页面的“ <a href="working-with-build-results.html#Changes">更改”选项卡</a>上。</p><p id="b7ed0925">在此页：</p><p id="effb4283"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#VCSLabeling-AutomaticVCSlabeling">自动VCS标记</a></li><li class="list__item"><a href="#VCSLabeling-ManualVCSlabeling">手动VCS标签</a></li><li class="list__item"><a href="#VCSLabeling-SubversionLabelingRules">颠覆标签规则</a></li><li class="list__item"><a href="#VCSLabeling-LabelingRuleExamples">标签规则示例</a></li></ul><p></p><a name="AutomaticVCSlabeling"></a><a name="Automatic-VCS-labeling"></a><div class="chapter"><h2 id="VCSLabeling-AutomaticVCSlabeling">自动VCS标记</h2><p id="798704ee">您可以设置TeamCity来根据构建状态自动标记构建的来源。该过程在构建完成之后在后台进行，并且不会影响构建状态，这意味着标记失败不是标准的<a href="subscribing-to-notifications.html#Which-Events-Will-Trigger-Notifications">通知事件</a> 。但是，订阅了<a href="subscribing-to-notifications.html#Which-Events-Will-Trigger-Notifications">有关</a>当前构建配置的<a href="subscribing-to-notifications.html#Which-Events-Will-Trigger-Notifications">构建失败的通知</a>的用户将收到有关标签失败的通知。</p><p id="9f04183a">标记期间遇到的任何错误都将在构建结果页面的“ <a href="working-with-build-results.html#Changes">更改”选项卡</a>上报告。</p><p id="97ffd1df">标签被配置用于构建配置/模板。</p><p id="9ae3ead7">在“构建配置”设置的“ <a href="adding-build-features.html">构建功能”页面</a>上配置了自动VCS标签。</p><p id="159960d7">要配置自动标记，您需要指定要标记的根目录和标记模式。如果您已为构建配置<a href="working-with-feature-branches.html">配置</a>了<a href="working-with-feature-branches.html">分支</a> ，则可以从<a href="branch-filter.html">选择的分支中</a>标记构建。</p><p id="f2ff5bed">您可以完全覆盖从模板继承的标签设置。您还可以将不同的标签应用于不同的VCS根目录。</p><aside class="note " rel="f2ff5bed" id="9c5eaa8d" data-title=""><p id="50fcc10e">标记使用为VCS根指定的凭据，并且需要对源存储库的写访问。</p></aside><p id="5860c5da">请注意，如果您更改构建配置的VCS设置，它们将仅用于新构建中的标记。</p><p id="364d89d3">“移动”标签（例如，不同版本的同名标签， <code class="code">SNAPSHOT</code> ）目前仅支持CVS。</p><p id="970d8ad7">有关使用Teamcity VCS标签功能自动创建标签的示例，请参阅此外部<a href="http://laurentkempe.com/2010/06/03/Build-and-Deployment-automation-VCS-Root-and-Labeling-in-TeamCity/" rel="noopener noreferrer" data-external="true" target="_blank">发布</a> 。</p></div><a name="ManualVCSlabeling"></a><a name="Manual-VCS-labeling"></a><div class="chapter"><h2 id="VCSLabeling-ManualVCSlabeling">手动VCS标签</h2><p id="58b50227">手动标记源：</p><p id="b692bf90">导航到<a href="working-with-build-results.html">构建结果</a>页面，单击<b id="2537d76f">操作</b> ，然后从下拉列表中选择<b id="ebef206a">标记此构建源</b> 。</p><p id="2405126f">手动标记使用实际的VCS设置进行构建。</p><p id="cf3e5025"><a name="SubversionLabelingRules"></a><a name="VCSLabeling-SubversionLabelingRules"></a></p></div><a name="SubversionLabelingRules"></a><a name="Subversion-Labeling-Rules"></a><div class="chapter"><h2 id="VCSLabeling-SubversionLabelingRules">颠覆标签规则</h2><p id="b43d987c">要标记Subversion VCS根目录，需要进行附加配置-定义SVN存储库结构的<a href="subversion.html#Labeling-settings">标记规则</a> 。</p><p id="522deb3d">标签规则以以下格式指定为换行符分隔的规则：</p><div class="code-block" data-lang="none">TrunkOrBranchRepositoryPath => tagDirectoryRepositoryPath</div><p id="b9ed6a67">存储库路径可以是相对路径，也可以是绝对路径（从<code class="code">/</code> ）。绝对路径是从SVN信息库根目录（您的信息库中最顶层的目录）解析的，相对路径是从TeamCity VCS根目录解析的。</p><p id="e6c8df4d">创建标签时，源位于<code class="code">TrunkOrBranchRepositoryPath</code>将被放入<code class="code">tagDirectoryRepositoryPath/tagName</code>目录，在哪里<code class="code">tagName</code>是由构建配置的标签模式定义的标签名称。<br>如果没有匹配的来源<code class="code">TrunkOrBranchRepositoryPath</code> ，将不会创建标签。<br>的<code class="code">tagDirectoryRepositoryPath</code>路径必须已经存在于存储库中。<br>如果<code class="code">tagDirectoryRepositoryPath</code>目录已经包含具有当前标签名称的子目录，标签过程将失败，并且旧标签目录不会被删除或受影响。</p><p id="74cb589c">例如，有一个带有URL的VCS根目录<code class="code">svn://address/root/project</code>哪里<code class="code">svn://address/root</code>是存储库的根，存储库具有以下结构：</p><div class="code-block" data-lang="none">-project --trunk --branch1 --branch2 --tags</div><p id="241aeb50">在这种情况下，标签规则应为：</p><div class="code-block" data-lang="none">/ project / trunk => / project / tags / project / branch1 => / project / tags / project / branch2 => / project / tags</div></div><a name="LabelingRuleExamples"></a><a name="Labeling-Rule-Examples"></a><div class="chapter"><h2 id="VCSLabeling-LabelingRuleExamples">标签规则示例</h2><p id="60d21226">您可以在标记规则和标记模式中使用变量替换。请参阅在不同配置中使用的VCS根目录中的标签规则示例：</p><div class="code-block" data-lang="none">/ projects /％projectName％/ trunk => / projects /％projectName％/ tags</div><p id="a485ec36">这将需要您设置<code class="code">%projectName%</code>构建配置设置中的<a href="configuring-build-parameters.html">配置参数</a> 。</p><p id="926b561a">默认情况下，TeamCity将标签名称附加到指定目标路径的末尾。如果要使用其他目录结构，并将标签放在目标路径的中间，则可以使用以下语法：</p><div class="code-block" data-lang="none">/ project / trunk => /tagged_configurations/%%system.build.label%%/project / modules / module1 / trunk => /tagged_configurations/%%system.build.label%%/module1 / modules / module2 / trunk => /tagged_configurations/%%system.build.label%%/module2</div><p id="c44cb4fd">从而， <code class="code">%%system.build.label%%</code>将替换为标签名称（请注意<code class="code">%%</code>一开始就签收-这很重要）。</p><hr id="4ca99934"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>