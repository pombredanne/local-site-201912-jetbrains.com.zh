<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>SSH Keys Management - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="SSH Keys Management" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/configuring-vcs-settings.md|Configuring VCS Settings/configuring-vcs-roots.md|Configuring VCS Roots/git.md|Git/ssh-keys-management.md|SSH Keys Management" data-main-title="SSH Keys Management" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/ssh-keys-management.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="SSH Keys Management" id="ssh-keys-management.md">SSH Keys Management</h1><p id="a535ff1d">You can upload an SSH private key into a project via the TeamCity web interface and then use it in VCS roots configuration or in <a href="ssh-agent.html">SSH Agent</a> build feature.</p><p id="7fc2c5f5">On this page:</p><p id="7b7c90e4"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#SSHKeysManagement-SupportedKeyFormat">Supported Key Format</a></li><li class="list__item"><a href="#SSHKeysManagement-UploadingSSHKeytoTeamCityServer">Uploading SSH Key to TeamCity Server</a></li><li class="list__item"><a href="#SSHKeysManagement-SSHKeyUsage">SSH Key Usage</a></li></ul></p><a name="SupportedKeyFormat"></a><a name="Supported-Key-Format"></a><div class="chapter"><h2 id="SSHKeysManagement-SupportedKeyFormat">Supported Key Format</h2><p id="e1eb42b9">TeamCity supports keys in the <b id="458286df">PEM format only</b>. If your private key uses a different format, it has to be converted to PEM. For example, the Putty private key format (<code class="code">*.ppk</code>) not supported by TeamCity can be converted to the PEM format using <a href="https://www.puttygen.com/" data-external="true" target="_blank" rel="noopener noreferrer">PuTTY Key Generator</a>: use the menu  <b id="10ca19d7">Conversions</b>  | <b id="4ccc3e35">Export OpenSSH key</b>.</p><aside class="tip sideblock" data-title="" rel="e1eb42b9" id="89538553"><p id="3e8a27e5">Recent versions of OpenSSH no longer generate keys in PEM format by default. Unfortunately the new OpenSSH format is not yet supported by TeamCity (see <a href="https://youtrack.jetbrains.com/issue/TW-53615" data-external="true" target="_blank" rel="noopener noreferrer">TW-53615</a>). Use the following command to generate TeamCity compatible keys: <code class="code">ssh-keygen -t rsa -m PEM</code>.</p></aside></div><a name="UploadingSSHKeytoTeamCityServer"></a><a name="Uploading-SSH-Key-to-TeamCity-Server"></a><div class="chapter"><h2 id="SSHKeysManagement-UploadingSSHKeytoTeamCityServer">Uploading SSH Key to TeamCity Server</h2><ol class="list _decimal"><li class="list__item" id="c8cee73b"><p>Go to the <b id="dae12216">Administration</b> | <b id="1088262f">&lt;ProjectName&gt;</b> page.</p></li><li class="list__item" id="fb713d6a"><p>On the left of the page, in <b id="95c10fa0">Project Settings</b>, click <b id="26ab2ef6">SSH Keys</b>.</p></li><li class="list__item" id="ffbd251e"><p>On the page that opens, click <b id="31af8432">Upload SSH Key</b>.</p></li><li class="list__item" id="30449437"><p>In the dialog that opens, select a private key usually stored in <code class="code">&lt;USER_HOME&gt;/.ssh/id_rsa</code> or <code class="code">&lt;USER_HOME&gt;/.ssh/id_dsa</code>.</p></li></ol><p id="f0014717">When you upload an SSH key for the project, it is stored in &lt;<a href="teamcity-data-directory.html">TeamCity Data Directory</a>&gt;/config/projects/&lt;project&gt;/pluginData/ssh_keys. TeamCity tracks this folder and is able to pick up new keys on the fly. The key will be available in the current project and its subprojects.</p><aside class="note " data-title="" rel="f0014717" id="890ada29"><p id="4d090351">The access to the <a href="teamcity-data-directory.html">TeamCity Data Directory</a> must be kept secure, as the keys are stored in an unmodified/unencrypted form on the file system.</p></aside><p id="9d707b14">Once the key is uploaded, a VCS root can be configured to use this uploaded key.</p></div><a name="SSHKeyUsage"></a><a name="SSH-Key-Usage"></a><div class="chapter"><h2 id="SSHKeysManagement-SSHKeyUsage">SSH Key Usage</h2><p id="0c2d166d">See <a href="ssh-agent.html">SSH Agent</a> for usage from within the build scripts.</p><p id="91d24f22">The uploaded key can be used in a VCS root. SSH key is used on the server and is also passed to the agent in case <a href="vcs-checkout-mode.html#agent-checkout">agent-side checkout</a> is configured.</p><p id="f0264940">During the build with agent-side checkout, the Git plugin downloads the key from the server to the agent. It temporarily saves the key on the agent's file system and removes it after <code class="code">git fetch/clone</code> is completed.</p><aside class="note " data-title="" rel="f0264940" id="80158c1c"><p id="e51baba0">The key is removed for security reasons: for example, the tests executed by the build can leave some malicious code that will access the build agent file system and acquire the key. However, tests cannot get the key directly since it is removed by the time they are running. It makes it harder but not impossible to steal the key. Therefore, the agent must also be secure.</p></aside><p id="014a2c38">To transfer the key from the server to the agent, TeamCity encrypts it with a DES symmetric cipher. For a more secure way, configure an <a href="using-https-to-access-teamcity-server.html">HTTPS connection between agents and the server</a>.</p><hr id="ca3556bd"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>