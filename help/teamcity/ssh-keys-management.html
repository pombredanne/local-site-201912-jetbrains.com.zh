<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>SSH密钥管理-帮助|团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="SSH Keys Management" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/configuring-vcs-settings.md|Configuring VCS Settings/configuring-vcs-roots.md|Configuring VCS Roots/git.md|Git/ssh-keys-management.md|SSH Keys Management" data-main-title="SSH Keys Management" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/ssh-keys-management.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="ssh-keys-management.md" data-toc="SSH Keys Management">SSH密钥管理</h1><p id="a535ff1d">您可以通过TeamCity Web界面将SSH私钥上载到项目中，然后在VCS根目录配置或<a href="ssh-agent.html">SSH代理</a>构建功能中使用它。</p><p id="7fc2c5f5">在此页：</p><p id="7b7c90e4"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#SSHKeysManagement-SupportedKeyFormat">支持的密钥格式</a></li><li class="list__item"><a href="#SSHKeysManagement-UploadingSSHKeytoTeamCityServer">将SSH密钥上传到TeamCity服务器</a></li><li class="list__item"><a href="#SSHKeysManagement-SSHKeyUsage">SSH密钥用法</a></li></ul><p></p><a name="SupportedKeyFormat"></a><a name="Supported-Key-Format"></a><div class="chapter"><h2 id="SSHKeysManagement-SupportedKeyFormat">支持的密钥格式</h2><p id="e1eb42b9">TeamCity仅支持<b id="458286df">PEM格式的</b>密钥。如果您的私钥使用其他格式，则必须将其转换为PEM。例如，Putty私钥格式（ <code class="code">*.ppk</code>可以使用<a href="https://www.puttygen.com/" rel="noopener noreferrer" data-external="true" target="_blank">PuTTY Key Generator</a>将TeamCity不支持的）转换为PEM格式：使用菜单<b id="10ca19d7">Conversions</b> | <b id="4ccc3e35">导出OpenSSH密钥</b> 。</p><aside class="tip sideblock" rel="e1eb42b9" id="89538553" data-title=""><p id="3e8a27e5">默认情况下，最新版本的OpenSSH不再生成PEM格式的密钥。不幸的是，TeamCity还不支持新的OpenSSH格式（请参阅<a href="https://youtrack.jetbrains.com/issue/TW-53615" rel="noopener noreferrer" data-external="true" target="_blank">TW-53615</a> ）。使用以下命令来生成TeamCity兼容密钥： <code class="code">ssh-keygen -t rsa -m PEM</code> 。</p></aside></div><a name="UploadingSSHKeytoTeamCityServer"></a><a name="Uploading-SSH-Key-to-TeamCity-Server"></a><div class="chapter"><h2 id="SSHKeysManagement-UploadingSSHKeytoTeamCityServer">将SSH密钥上传到TeamCity服务器</h2><ol class="list _decimal"><li class="list__item" id="c8cee73b"><p>转到<b id="dae12216">管理</b> | <b id="1088262f"><projectname></projectname></b>页。</p></li><li class="list__item" id="fb713d6a"><p>在页面左侧的“ <b id="95c10fa0">项目设置”中</b> ，单击“ <b id="26ab2ef6">SSH密钥”</b> 。</p></li><li class="list__item" id="ffbd251e"><p>在打开的页面上，点击<b id="31af8432">上传SSH密钥</b> 。</p></li><li class="list__item" id="30449437"><p>在打开的对话框中，选择一个通常存储在其中的私钥<code class="code"><USER_HOME>/.ssh/id_rsa</code>要么<code class="code"><USER_HOME>/.ssh/id_dsa</code> 。</p></li></ol><p id="f0014717">当您上载该项目的SSH密钥时，它存储在< <a href="teamcity-data-directory.html">TeamCity数据目录</a> > / config / projects / <project>/ pluginData / ssh_keys中。TeamCity会跟踪此文件夹，并能够即时获取新密钥。该密钥将在当前项目及其子项目中可用。</project></p><aside class="note " rel="f0014717" id="890ada29" data-title=""><p id="4d090351">由于密钥以未经修改/未加密的形式存储在文件系统上，因此必须确保对<a href="teamcity-data-directory.html">TeamCity数据目录</a>的访问安全。</p></aside><p id="9d707b14">密钥上传后，可以将VCS根配置为使用此上传密钥。</p></div><a name="SSHKeyUsage"></a><a name="SSH-Key-Usage"></a><div class="chapter"><h2 id="SSHKeysManagement-SSHKeyUsage">SSH密钥用法</h2><p id="0c2d166d">有关构建脚本中的用法，请参见<a href="ssh-agent.html">SSH代理</a> 。</p><p id="91d24f22">可以在VCS根目录中使用上载的密钥。SSH密钥在服务器上使用，并且在配置了<a href="vcs-checkout-mode.html#agent-checkout">代理端检出的</a>情况下也传递给代理。</p><p id="f0264940">在使用代理端检出的构建过程中，Git插件将密钥从服务器下载到代理。它将密钥临时保存在代理的文件系统上，并在之后将其删除<code class="code">git fetch/clone</code>完成了。</p><aside class="note " rel="f0264940" id="80158c1c" data-title=""><p id="e51baba0">出于安全原因删除了密钥：例如，由构建执行的测试可能会留下一些恶意代码，这些恶意代码将访问构建代理文件系统并获取密钥。但是，测试无法直接获取该密钥，因为它会在运行时被删除。这使窃取密钥变得更加困难，但并非并非不可能。因此，代理也必须是安全的。</p></aside><p id="014a2c38">要将密钥从服务器传输到代理，TeamCity使用DES对称密码对其进行加密。为了更安全， <a href="using-https-to-access-teamcity-server.html">在代理和服务器之间</a>配置<a href="using-https-to-access-teamcity-server.html">HTTPS连接</a> 。</p><hr id="ca3556bd"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>