<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>检查-帮助|团队城市</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Inspections" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-build-steps.md|Configuring Build Steps/inspections.md|Inspections" data-main-title="Inspections" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/inspections.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="inspections.md" data-toc="Inspections">视察</h1><p id="31d25dc3"><b id="645a800c">检查（IntelliJ IDEA）</b>生成运行器旨在为您的项目基于<a href="/help/idea/2016.3/code-inspection.html" rel="noopener noreferrer" data-external="true" target="_blank">IntelliJ IDEA检查</a>运行代码分析。<b id="35bc4624">从TeamCity 2017.1开始</b> ，除了捆绑版本外，还可以安装其他版本的JetBrains IntelliJ Inspections and Duplicates Engine和/或使用<b id="a8c10b6a"><a href="installing-agent-tools.html">管理|</a></b>更改默认值<b id="a8c10b6a"><a href="installing-agent-tools.html">。工具</a></b>页面。</p><p id="215ac0b9">IntelliJ IDEA的代码分析引擎能够检查Java，JavaScript，HTML，XML和其他代码，并允许您：</p><ul class="list _ul"><li class="list__item" id="182b64c7"><p>查找可能的错误</p></li><li class="list__item" id="be9869cc"><p>找到“死”代码</p></li><li class="list__item" id="42d4a4b5"><p>检测性能问题</p></li><li class="list__item" id="7efad888"><p>改善代码结构和可维护性</p></li><li class="list__item" id="c9a87d36"><p>确保代码符合准则，标准和规范</p></li></ul><p id="03eb03bd">有关更多详细信息，请参阅<a href="http://www.jetbrains.com/idea/documentation/inspections.jsp" rel="noopener noreferrer" data-external="true" target="_blank">IntelliJ IDEA文档</a> 。</p><aside class="note " rel="03eb03bd" id="618b9f86" data-title=""><p id="4c01d39c">要运行项目检查，您必须具有IntelliJ IDEA项目目录（ <code class="code">.idea</code> ）或项目文件（ <code class="code">.ipr</code> ）签入您的版本控制中。<br>请注意，检查不会报告编译错误，因此最好在同一版本中运行编译步骤。</p></aside><aside class="note " rel="inspections.md" id="4ff82c44" data-title=""><p id="488513d2"><b id="cf35fa12">Maven项目</b></p><p id="81deddf4">跑步者还支持Maven2或更高版本：使用<code class="code">pom.xml</code> ，您需要按照<a href="/help/idea/2016.3/code-inspection.html#profiles" rel="noopener noreferrer" data-external="true" target="_blank">IntelliJ IDEA文档中的说明</a>在IntelliJ IDEA中打开它并配置检查配置<a href="/help/idea/2016.3/code-inspection.html#profiles" rel="noopener noreferrer" data-external="true" target="_blank">文件</a> 。IntelliJ IDEA会将您的检查配置文件保存在<a href="/help/idea/2016.3/project-and-ide-settings.html#d1962322e174" rel="noopener noreferrer" data-external="true" target="_blank">相应的文件夹中</a> 。确保已将其签入版本控件。然后在配置此运行器时指定检查配置文件的路径。</p><p id="ecba149c">执行是一个好主意<code class="code">mvn install</code>作为检查步骤之前的步骤，以便成功解决具有依赖性的项目。</p></aside><p id="1effe524">本页包含有关以下<b id="5c61157a">检查（IntelliJ IDEA）</b>生成运行器字段的参考信息：</p><p id="3352b155"></p><ul class="list" data-skip-index="skip"></ul><p></p><a name="IntelliJIDEAProjectSettings"></a><a name="IntelliJ-IDEA-Project-Settings"></a><h3 id="Inspections-IntelliJIDEAProjectSettings">IntelliJ IDEA项目设置</h3><div class="table-wrapper"><table width="100%" id="397e36db"><thead><tr id="1e3550d6" class="ijRowHead"><th id="5e773a98"><p id="24e3699b">选项</p></th><th id="662a78ba"><p id="c387593d">描述</p></th></tr></thead><tbody><tr id="4855f513" class="ijRowOdd"><td id="da1aa697"><p id="fc7d8c41">项目文件类型</p></td><td id="44156e2e"><p id="6ed54d61">为了能够在代码上运行IntelliJ IDEA检查，TeamCity需要IntelliJ IDEA项目文件\目录Maven。 <code class="code">pom.xml</code>或摇篮<code class="code">build.gradle</code>在这里指定。</p></td></tr><tr id="acda1514" class="ijRowEven"><td id="bc2bd8e6"><p id="f128a8ee">项目路径</p></td><td id="877ac77d"><p id="6dcfa5cd">根据在<b id="8790d115">项目文件类型中</b>选择的<b id="8790d115">项目类型</b> ，在此处指定：</p><ul class="list _ul"><li class="list__item" id="c95ac63b"><p><b id="360adfda">对于IntelliJ IDEA项目</b> ：项目文件（.ipr）的路径或项目目录的路径，即包含以下内容的项目的根目录<code class="code">.idea</code>夹）。</p></li><li class="list__item" id="c8e93425"><p><b id="7f85397b">对于Maven项目</b> ： <code class="code">pom.xml</code>文件。</p></li><li class="list__item" id="bad0375c"><p><b id="7f1d71b0">对于Gradle项目</b> ： <code class="code">.gradle</code>要么<code class="code">.gradle.kts</code>文件。<br>该构建跑步者需要此信息来了解项目的结构。</p></li></ul><aside class="tip sideblock" rel="0ee94f3c" id="a8316bad" data-title=""><p id="58031638">指定的路径应相对于checkout目录。</p></aside></td></tr><tr id="f3d55abf" class="ijRowOdd"><td id="451821bc"><p id="e5173655">检测全局库和基于模块的JDK <code class="code">*.iml</code>档案</p></td><td id="ec0a4d34"><p id="434926c8"><i id="3c109424">如果您使用IntelliJ IDEA项目来运行检查，则此选项可用。</i> 在IntelliJ IDEA中，模块设置存储在<code class="code">*.iml</code>文件，因此，如果选中此选项，则保存时将自动扫描所有模块文件以查找对全局库和模块JDK的引用。这有助于确保将正确解析所有引用。</p><aside class="warning " rel="434926c8" id="055fdb99" data-title=""><p id="ad3d3475">选择此选项时，打开和保存构建运行器设置的过程可能会很耗时，因为它涉及加载和解析所有项目模块文件。</p></aside></td></tr><tr id="b242eb1e" class="ijRowEven"><td id="53b8af91"><p id="30f27084">检查/修复项目</p></td><td id="1c5f4ffa"><p id="a99c8bfa"><i id="3ecdfbaa">如果您使用IntelliJ IDEA项目来运行检查，则此选项可用。</i> 单击此按钮可以重新分析IntelliJ IDEA项目，并直接从项目（例如JDK列表）导入构建设置。</p><aside class="note " rel="a99c8bfa" id="0dd11c21" data-title=""><p id="8a0aadcf">如果您在IntelliJ IDEA中更新项目设置（例如，添加新的jdks，库），请记住通过单击<b id="cef9c2f5">Check / Reparse Project</b>来更新构建运行器设置。</p></aside></td></tr><tr id="9f57cac7" class="ijRowOdd"><td id="61e9317a"><p id="466f3bbc">工作目录</p></td><td id="87d16ee4"><p id="ab1531d6">如果<a href="build-working-directory.html">构建工作目录</a>与<a href="build-checkout-directory.html">Build Checkout目录</a>不同，请输入路径。</p><p id="af4ca74f">可选，指定是否不同于签出目录。</p></td></tr></tbody></table></div><a name="UnresolvedProjectModulesandPathVariables"></a><a name="Unresolved-Project-Modules-and-Path-Variables"></a><h3 id="Inspections-UnresolvedProjectModulesandPathVariables">未解决的项目模块和路径变量</h3><p id="dcb92628">当IntelliJ IDEA模块文件（ <code class="code">.iml</code> ）从IntelliJ IDEA项目文件引用：</p><ul class="list _ul"><li class="list__item" id="6f65fabd"><p>找不到</p></li><li class="list__item" id="bf40311c"><p>允许您输入IPR文件中使用的路径变量的值。</p></li></ul><p id="0426789a">要刷新此部分中的值，请单击<b id="ccb0ef14">检查/重新分析项目</b> 。</p><div class="table-wrapper"><table width="100%" id="c8706d3b"><thead><tr id="8938dc50" class="ijRowHead"><th id="2e21346f"><p id="490e3f43">选项</p></th><th id="c7d95179"><p id="27fc5a53">描述</p></th></tr></thead><tbody><tr id="2872b926" class="ijRowOdd"><td id="9d985280"><p id="4feaca89"><path_variable_name></path_variable_name></p></td><td id="d27fd689"><p id="fe95fab2">如果项目文件包含路径宏（在IntelliJ IDEA的“设置”对话框的“路径变量”对话框中定义），则会出现此字段。在“ <b id="7efb57be">将值设置为字段”中</b> ，指定要在不同构建代理上使用的项目资源的路径。</p></td></tr></tbody></table></div><a name="ProjectSDKs"></a><a name="Project-SDKs"></a><h3 id="Inspections-ProjectSDKs">项目SDK</h3><p id="fc5bdb7b">本节提供了在项目中检测到的SDK的列表。</p><div class="table-wrapper"><table class="  _layout-fixed" width="100%" id="bd5999c1"><thead><tr id="be49f9a8" class="ijRowHead"><th id="1c784d2c"><p id="7bf1f330">选项</p></th><th id="648321e7"><p id="eed99d0b">描述</p></th></tr></thead><tbody><tr id="8bbe76c2" class="ijRowOdd"><td id="c422cc75"><p id="d7af1186">JDK主页</p></td><td id="50ae218b"><p id="eeba2ff7">使用此字段为项目指定JDK主页。</p><aside class="note " rel="eeba2ff7" id="d476d6e6" data-title=""><p id="10048df8">与<b id="582a3eb0">Ipr运行程序</b>一起构建时，将使用此JDK编译相应的IDEA模块的源。对于“ <b id="21c51ff9">检查</b>和<b id="f5bc49a8">重复查找器”</b>内部版本，此JDK将在内部用于解析项目中使用的Java API。<br>要运行构建过程，请在<code class="code">JAVA_HOME</code>将使用环境变量。</p></aside></td></tr><tr id="821f8605" class="ijRowEven"><td id="a00398bc"><p id="68104b6e">JDK Jar文件模式</p></td><td id="e6b74c6c"><p id="26b8ac38">单击此链接打开一个文本区域，您可以在其中为项目JDK的jar文件定义模板。使用Ant规则定义jar文件模式。缺省值用于Linux和Windows操作系统：</p><div class="code-block" data-lang="none">jre / lib / *。jar</div><p id="82de59f0">对于Mac OS X，使用以下几行：</p><div class="code-block" data-lang="none">lib / *。jar ../classes/*.jar</div></td></tr><tr id="78804bb9" class="ijRowOdd"><td id="33872607"><p id="1a7cbbbe">IDEA首页</p></td><td id="fd361313"><p id="fbe61dcc">如果您的项目使用IDEA JDK，请指定IDEA主目录的位置</p></td></tr><tr id="3b9f4a91" class="ijRowEven"><td id="b7f3f43c"><p id="8b56867c">IDEA Jar文件模式</p></td><td id="2f2205e7"><p id="0d79eee9">单击此链接打开一个文本区域，您可以在其中定义IDEA JDK的jar文件的模板。</p></td></tr></tbody></table></div><aside class="note " rel="bd5999c1" id="076bb8be" data-title=""><p id="02a2ea57">您可以在定义值时使用对外部属性的引用，例如<code class="code">%system.idea_home%</code>要么<code class="code">%env.JDK_1_3%</code> 。这将增加对相应属性的<a href="agent-requirements.html">要求</a> 。</p></aside><a name="java-param"></a><a name="JavaParameters"></a><a name="Java-Parameters"></a><h3 id="Ant-JavaParameters">Java参数</h3><div class="table-wrapper"><table class="  _layout-fixed" width="100%" id="b68eaa47"><thead><tr id="a2cc38ba" class="ijRowHead"><th id="a42a2d7c"><p id="27b3da69">选项</p></th><th id="d63b4e39"><p id="c742b8b2">描述</p></th></tr></thead><tbody><tr id="6ce7de6b" class="ijRowOdd"><td id="654c43ef"><p id="2f089771">JDK</p></td><td id="1db519e2"><p id="22d9e005">选择一个JDK。 <a href="predefined-build-parameters.html#Defining-Java-related-Environment-Variables">本节</a>详细介绍了可用的选项。默认是<code class="code">JAVA_HOME</code>环境变量或代理程序自己的Java。</p></td></tr><tr id="73743b5b" class="ijRowEven"><td id="99884445"><p id="91889fca">JDK主页路径</p></td><td id="7e532803"><p id="80ac7f0e"><i id="5a7156cb" origin="teamcity-help"><custom>上面选择</custom>时，此选项可用<custom>。</custom></i> 使用此字段可以指定用于运行构建的自定义JDK的路径。如果该字段为空，则从<code class="code">JAVA_HOME</code>代理计算机上的环境变量，或来自<code class="code">env.JAVA_HOME</code>在<a href="build-agent-configuration.html">构建代理配置</a>文件中指定的属性（ <code class="code">buildAgent.properties</code> ）。如果未指定这些值，TeamCity将使用构建代理进程本身的Java主页。</p></td></tr><tr id="ed11a6e5" class="ijRowOdd"><td id="04f0e7de"><p id="52a1d4a3">JVM命令行参数</p></td><td id="18718765"><p id="5becc22d">您可以指定此类JVM命令行参数，例如<i id="0a1a13b3" origin="teamcity-help">最大堆大小</i>或启用<i id="9db18194" origin="teamcity-help">远程调试的</i>参数。这些值由用于运行构建的JVM传递。<br>例：</p><div class="code-block" data-lang="bash">-Xmx512m -Xms256m</div></td></tr></tbody></table></div><a name="InspectionParameters"></a><a name="Inspection-Parameters"></a><h3 id="Inspections-InspectionParameters">检验参数</h3><p id="d8333c6e">在基于IntelliJ IDEA的IDE中，报告的代码检查由<a href="http://www.jetbrains.com/idea/webhelp/code-inspection.html#d559109e437" rel="noopener noreferrer" data-external="true" target="_blank">检查配置文件配置</a> 。<br>在TeamCity中运行检查时，可以指定要使用的检查配置文件：首先，您需要在基于IntelliJ IDEA的IDE中配置检查配置文件，然后在TeamCity中指定检查配置文件。</p><p id="41ffc7c2">准备检验配置文件时，请遵循以下规则：</p><ul class="list _ul"><li class="list__item" id="698cf24e"><p>如果您的检查配置文件使用范围，请确保范围是共享的；</p></li><li class="list__item" id="156b1cc6"><p>锁定配置文件（这确保TeamCity将不会运行TeamCity中存在但未在IDEA安装中启用的检查）；</p></li><li class="list__item" id="23194b97"><p>确保配置文件没有默认IntelliJ IDEA Ultimate发行版中未包含的插件提供的检查（否则，TeamCity将忽略它们）；</p></li><li class="list__item" id="19651649"><p>为了获得最佳结果，请在IntelliJ IDEA中编辑与TeamCity使用的版本相同的检查配置文件（可以在检查构建日志中查找）。</p></li></ul><p id="f33e0958">选择检查配置文件的逻辑如下：</p><ul class="list _ul"><li class="list__item" id="3c6bd831"><p>如果指定了检查配置文件的路径，则将从文件中加载该配置文件。如果加载失败，则检查运行程序也将失败。</p></li><li class="list__item" id="b6f266ce"><p>如果指定了检查配置文件的名称，则会在项目的共享配置文件中搜索该配置文件。如果没有此类配置文件，则检查运行器将失败。</p></li><li class="list__item" id="5563910f"><p>如果未指定名称或路径，则使用项目的默认配置文件。</p></li></ul><div class="table-wrapper"><table width="100%" id="b9830294"><thead><tr id="13e0638d" class="ijRowHead"><th id="8cdef387"><p id="8c804fcd">选项</p></th><th id="d44aa110"><p id="07703472">描述</p></th></tr></thead><tbody><tr id="c4a0c3e7" class="ijRowOdd"><td id="fcefeb19"><p id="48a1ff74">检查配置文件路径</p></td><td id="2fdd58b9"><p id="20d53b11">使用此文本字段来指定相对于项目根目录的检查配置文件的路径。仅当您不想使用“检查配置文件名称”中指定的共享项目配置文件时，才使用此字段。</p></td></tr><tr id="ab4b2c82" class="ijRowEven"><td id="efe6813f"><p id="e2cbca55">检验资料名称</p></td><td id="2d6665d3"><p id="cefdee4c">输入所需的共享项目配置文件的名称。如果该字段保留为空白并且未指定配置文件路径，则将使用默认项目配置文件。</p></td></tr><tr id="6eaf628a" class="ijRowOdd"><td id="993008d1"><p id="2f772818">包含/排除模式：</p></td><td id="abfe205f"><p id="85d0a331">可选，指定以限制要在其上运行检查的源范围。</p></td></tr></tbody></table></div><p id="efd7a9fb">包含/排除模式是用换行符分隔的规则集，其形式为：</p><div class="code-block" data-lang="none">[+：|-：]模式</div><p id="7b13fadc">模式必须满足以下规则：</p><ul class="list _ul"><li class="list__item" id="25d59d8a"><p>必须以任一结尾<code class="code">**</code>要么<code class="code">*</code> （这实际上将模式限制在目录级别，而它们不支持文件级别的模式）；</p></li><li class="list__item" id="400ba02c"><p>对模块的引用可以包括为<code class="code">[<IDEA_module_name>]/<path_within_module></code> 。如果配置了Maven项目，则可以使用Maven模块的artifactId作为<code class="code"><IDEA_module_name></code> ;</p></li><li class="list__item" id="644faa2d"><p>配置的路径被视为IDEA项目模块内容根中的相对路径。也就是说，路径应相对于模块的根目录。</p></li></ul><p id="762c8ed1">关于模式处理的一些注意事项：</p><ul class="list _ul"><li class="list__item" id="9000e09e"><p>排除优先于包括</p></li><li class="list__item" id="5a7159f2"><p>如果指定了包含模式，则仅包含与这些模式匹配的目录，所有其他目录将被排除</p></li><li class="list__item" id="47284241"><p>包含模式有一个特殊的行为（由于潜在的限制）：它包含指定的目录以及所有直接位于指定目录之上的目录中的文件。</p></li></ul><p id="f958ef4e">例：</p><div class="code-block" data-lang="none">+：testData /表/ **-：testData / **-：testdata / **-：[testData] / **</div><aside class="tip sideblock" rel="895b9f8b" id="73331000" data-title=""><p id="6d251454">为了正确报告文件路径，应在IDEA项目中将项目和所有模块的“对项目/模块文件目录外部资源的引用”选项设置为“相对”。</p></aside><p id="84ca15c2">为了运行Maven检查，要确保将正确的Java用于项目JDK，请定义<code class="code">env.JAVA_HOME</code>指向要用作项目JDK的JDK的配置参数。</p><a name="GettingthesameresultsinIntelliJIDEAandTeamCityInspectionsBuild"></a><a name="Getting-the-same-results-in-IntelliJ-IDEA-and-TeamCity-Inspections-Build"></a><h3 id="Inspections-GettingthesameresultsinIntelliJIDEAandTeamCityInspectionsBuild">在IntelliJ IDEA和TeamCity Inspections Build中获得相同的结果</h3><p id="3f65cf6c">IntelliJ IDEA和TeamCity Java代码检查报告的代码检查取决于许多因素。您需要确保在IntelliJ IDEA和内部版本中设置相同，才能获得相同的报告。相关设置包括：</p><ul class="list _ul"><li class="list__item" id="eb69e540"><p>IntelliJ IDEA和TeamCity构建中使用的<a href="#Inspection-Parameters">检查配置文件</a> ；</p></li><li class="list__item" id="3178a8b0"><p>特定于环境的项目依赖项（文件不在版本控制中，依此类推）；</p></li><li class="list__item" id="c1cb6136"><p>IDE级别的设置，例如定义的SDK，路径变量等；</p></li><li class="list__item" id="b693a37a"><p>生成的文件：如果在IntelliJ IDEA中处理项目时存在，则应存在于TeamCity代理中；</p></li><li class="list__item" id="1d131b9f"><p>IntelliJ IDEA版本。建议使用与TeamCity构建中相同的IntelliJ IDEA版本。TeamCity捆绑了IntelliJ IDEA的安装。该版本写在“检查”构建日志中。</p></li><li class="list__item" id="d8eadf4a"><p>项目依赖的IntelliJ IDEA插件的集合和版本。</p></li></ul><hr id="61dc143f"></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>