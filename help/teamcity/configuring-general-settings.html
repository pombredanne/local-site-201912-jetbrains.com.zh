<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');</script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>配置常规设置-帮助|团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Configuring General Settings" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-general-settings.md|Configuring General Settings" data-main-title="Configuring General Settings" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/configuring-general-settings.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="configuring-general-settings.md" data-toc="Configuring General Settings">配置常规设置</h1><p id="795154b2">创建构建配置时，请指定以下设置：</p><div class="table-wrapper"><table width="100%" id="2076f76b"><thead><tr id="09d64c95" class="ijRowHead"><th id="d3582f7c"><a name="Setting"></a><a name="Setting"></a><h4 id="ConfiguringGeneralSettings-Setting">设置</h4></th><th id="b1768470"><a name="Description"></a><a name="Description"></a><h4 id="ConfiguringGeneralSettings-Description">描述</h4></th></tr></thead><tbody><tr id="f5979e65" class="ijRowOdd"><td id="7696c4ab"><a name="Name"></a><a name="Name"></a><h4 id="ConfiguringGeneralSettings-Name">名称</h4></td><td id="b175f426"><p id="060c0186">配置名称</p></td></tr><tr id="fac953ef" class="ijRowEven"><td id="12509a8a"><a name="BuildConfigurationID"></a><a name="Build-Configuration-ID"></a><h4 id="ConfiguringGeneralSettings-BuildConfigurationID">构建配置ID</h4></td><td id="4934abc4"><p id="a71eefdb">根据构建配置名称自动生成的系统中所有构建配置和模板上的唯一配置<a href="identifier.html">ID</a> ，也可以手动设置。<br>确保为构建配置提供全局唯一的ID，并为其添加项目ID的前缀。<br>创建构建配置后，可以更改其ID，强烈建议对ID标记为Web UI的链接和使用该ID的<a href="rest-api.html">REST API</a>进行相应的更改。</p></td></tr><tr id="17a28ee8" class="ijRowOdd"><td id="5167bb59"><a name="Description"></a><a name="Description"></a><h4 id="ConfiguringGeneralSettings-Description2">描述</h4></td><td id="c55e5ec5"><p id="697b5262">构建配置的可选描述。</p></td></tr><tr id="efe87c3f" class="ijRowEven"><td id="a0d18c53"><a name="BuildNumberFormat"></a><a name="Build-Number-Format"></a><h4 id="ConfiguringGeneralSettings-BuildNumberFormat">内部编号格式</h4></td><td id="e0c01cc7"><p id="915970e7">在构建开始时已解析并分配给<a href="#Build-Number-Format">内部版本号</a>的模式。</p></td></tr><tr id="12b6b25f" class="ijRowOdd"><td id="8e93ee4f"><a name="BuildCounter"></a><a name="Build-Counter"></a><h4 id="ConfiguringGeneralSettings-BuildCounter">建造柜台</h4></td><td id="735972ea"><p id="1ee3b16e">指定要在内部编号中使用的计数器。每个构建将构建计数器增加1。使用“ <i id="7f82ec29">重置”</i>链接将计数器值恢复为1。</p></td></tr><tr id="b93c7267" class="ijRowEven"><td id="494cf781"><a name="publish-artifacts"></a><a name="ConfiguringGeneralSettings-publish-artifacts"></a><a name="PublishArtifacts"></a><a name="Publish-Artifacts"></a><h4 id="ConfiguringGeneralSettings-PublishArtifacts">发布工件</h4></td><td id="48cfd735"><p id="9c059278">选择何时发布工件：</p><ul class="list _ul"><li class="list__item" id="9320a68d"><p>“ <i id="e6c461fd">即使构建失败</i> ”（默认）：如果先前的所有步骤都已成功完成或未成功，则在构建的最后一步发布工件。</p></li><li class="list__item" id="7e268414"><p>“ <i id="af2b5f86">仅当构建状态为成功时</i> ”：如果先前的所有步骤均已成功完成，则在构建的最后一步发布工件。在发布构件之前，TeamCity检查服务器上的当前构建状态。</p></li><li class="list__item" id="c6a545e8"><p>“ <i id="f0aa18c8">始终，即使发出了build stop命令</i> ”：发布所有构建的工件，即使是中断构建的工件（例如， <code class="code">stop</code>命令发出或在超时后（在构建失败条件中指定）。</p></li></ul><p id="232118a3">此设置不影响在<a href="build-script-interaction-with-teamcity.html#Publishing-Artifacts-while-the-Build-is-Still-in-Progress">构建脚本中</a>配置的工件发布。</p><aside class="note " rel="232118a3" id="6dd38db3" data-title=""><p id="6035f9e7">如果<code class="code">stop</code>在工件发布期间发出命令，无论选择哪个选项，都会停止发布操作。</p></aside></td></tr><tr id="13ec35e3" class="ijRowOdd"><td id="56baf532"><p id="1a6d750f"><a href="#Artifact-Paths">神器路径</a></p></td><td id="7b014e94"><p id="50258e46">用于定义构建工件的模式。运行第一个构建后，您可以浏览代理<a href="build-checkout-directory.html">检出目录</a>以配置工件路径。</p></td></tr><tr id="e2d9ed6d" class="ijRowEven"><td id="84bdef94"><p id="f5293aae"><a href="#Build-Options">构建选项</a></p></td><td id="0e0db4d2"><p id="8d69ab06">指定此构建配置的其他选项。</p><ul class="list _ul"><li class="list__item" id="597940a8"><a href="#Hanging-Build-Detection">吊装检测</a></li><li class="list__item" id="fac67b63"><a href="#Allow-Triggering-Personal-Builds">允许触发个人构建</a></li><li class="list__item" id="63443b31"><a href="#Enable-Status-Widget">启用状态小部件</a><ul class="list _ul"><li class="list__item" id="5f9ac74c"><a href="#HTML-Status-Widget">HTML状态小部件</a></li></ul></li><li class="list__item" id="2f708433"><a href="#Limit-Number-of-Simultaneously-Running-Builds">限制同时运行的内部版本数</a></li></ul></td></tr></tbody></table></div><a name="BuildNumberFormat"></a><a name="Build-Number-Format"></a><h3 id="ConfiguringGeneralSettings-BuildNumberFormat2">内部编号格式</h3><p id="1b23b228">在<b id="5bd7494c">内部版本号格式</b>字段中，您可以指定一个模式，该模式在开始<a href="build-number.html">构建时</a>便会解析并分配给<a href="build-number.html">内部版本号</a> 。</p><p id="54bc966a">模式中支持以下替换：</p><div class="table-wrapper"><table width="100%" id="35ac28c5"><thead><tr id="e2fed840" class="ijRowHead"><th id="11018d4f"><p id="04497910">图案</p></th><th id="5d03514d"><p id="cd4e6bcf">描述</p></th></tr></thead><tbody><tr id="074b8d8f" class="ijRowOdd"><td id="4533df37"><p id="3372b380"><code class="code">%build.counter%</code></p></td><td id="f1460d1d"><p id="b8c3981b">每个构建配置唯一的构建计数器。它由TeamCity维护，并将在每次新的构建开始时解析为下一个整数值。计数器的当前值可以在“ <a href="#Build-Counter">构建计数器”</a>字段中进行编辑。</p></td></tr><tr id="e05d7c66" class="ijRowEven"><td id="8058517e"><p id="f86bbc09"><code class="code">%build.vcs.number.<VCS_root_name>%</code></p></td><td id="381c3aeb"><p id="e7978627">用于构建VCS根目录的修订版本<code class="code"><VCS_root_name></code>名称。<a href="predefined-build-parameters.html">阅读更多</a>关于该物业。</p></td></tr><tr id="d798f722" class="ijRowOdd"><td id="fc01c86b"><p id="3521474d"><code class="code">%property.name%</code></p></td><td id="b294989a"><p id="63299cad">具有相应名称的build属性的值。支持所有<a href="predefined-build-parameters.html">预定义的构建参数</a> （包括<a href="predefined-build-parameters.html#Configuration-Parameters">仅供参考的服务器属性</a> ）。</p></td></tr></tbody></table></div><aside class="tip sideblock" rel="35ac28c5" id="9f02717b" data-title=""><p id="05e3f6df"><b id="9e9ece83">内部版本号格式示例：</b></p><p id="038afe04"><code class="code">1.0.%build.counter%.%build.vcs.number.My_Project_svn%</code></p></aside><p id="ea9e39c3">尽管不是必需的，但仍然强烈建议确保内部版本号是唯一的。请在内部版本号中包含内部版本计数器，请勿将内部版本计数器重置为较小的值。也可以从构建脚本中更改内部版本号。有关详细信息，请参阅<a href="build-script-interaction-with-teamcity.html#Reporting-Build-Number">与TeamCity的构建脚本交互</a> 。</p><a name="ArtifactPaths"></a><a name="Artifact-Paths"></a><h3 id="ConfiguringGeneralSettings-ArtifactPaths">神器路径</h3><p id="43db4c15"><a href="build-artifact.html">构建工件</a>是由<a href="build-artifact.html">构建生成</a>的文件，存储在TeamCity服务器上，可以从TeamCity Web UI下载或用作其他构建的工件依赖项。在构建配置的“ <b id="cbc85a1a">常规设置”</b>页面上，可以为代理上的文件指定模式，该模式将在构建后上载到服务器。</p><p id="7187e4b3">如果您已经在代理上完成构建，则可以使用checkout目录浏览器<img alt="chechoutdirBrowser.png" title="chechoutdirBrowser.png" src="/help/img/teamcity/2019.1/chechoutdirBrowser.png" id="e5025b1a" width="22" height="24" class="inline-icon-22"> （列出代理上的检出目录内容），然后从树中选择工件。TeamCity将把它们的路径放入输入字段。</p><p id="2f855363"><b id="f43bdadf">Artifact Paths</b>字段支持相对<b id="f43bdadf">路径</b> （相对于构建结帐目录）和绝对路径。建议使用相对路径。您可以指定确切的文件路径或模式，每行一个或用逗号分隔。模式支持“ <code class="code">*</code> “和” <code class="code">**</code>通配符（请参见下文）。每行可以采用以下形式<code class="code">[+:]source [=> target]</code>包括和<code class="code">-:source [=> target]</code>排除要发布为构建工件的文件或目录。方括号内的零件是可选的。规则按右部分分组，并按出现顺序应用：</p><div class="code-block" data-lang="bash">+：** / * =>目标目录-：** / folder1 =>目标目录</div><p id="c1f34763">将告诉TeamCity将除folder1以外的所有文件发布到<code class="code">target_directory</code> 。</p><p id="cd8cc412">行格式说明：</p><div class="code-block" data-lang="bash">file_name | directory_name |通配符[=> target_directory | target_archive]</div><p id="0bda4d43">请注意，尽管源部分支持绝对路径，但是建议使用相对于<a href="build-checkout-directory.html">build checkout目录的</a>路径。</p><ul class="list _ul"><li class="list__item" id="35197d7f"><p><code class="code">file_name</code> —发布文件。该名称应相对于<a href="build-checkout-directory.html">Build Checkout目录</a> 。</p></li><li class="list__item" id="0613ce52"><p><code class="code">directory_name</code> —发布指定目录中的所有文件和子目录。目录名称应该是相对于<a href="build-checkout-directory.html">Build Checkout Directory</a>的路径。将发布文件，并保留指定目录下的目录结构（目录本身将不包括在内）。</p></li><li class="list__item" id="1e524737"><p><code class="code">wildcard</code> —发布与<a href="wildcards.html">类似Ant的通配符</a>模式匹配的文件（仅“ <code class="code">*</code> “和” <code class="code">**</code> “支持通配符）。通配符应表示相对于构建签出目录的路径。将发布文件，保留通配符匹配的目录的结构（不会创建与“静态”文本匹配的目录）。也就是说，TeamCity将创建从模式中首次出现通配符开始的目录。</p></li><li class="list__item" id="d538c56d"><p>您可以在工件规范中使用<a href="configuring-build-parameters.html">构建参数</a> 。例如使用<code class="code">mylib-%system.build.number%.zip</code>引用名称中带有内部版本号的文件。</p></li></ul><p id="13f096b7">可选部分以<code class="code">=></code>符号和后跟目标目录名称可用于将文件发布到指定的目标目录中。如果省略目标目录，那么文件将发布在构建工件的根目录中。您可以使用 ” <code class="code">.</code> “（点）作为对构建签出目录的引用。<br>目标路径不能是绝对路径。非相对路径将在生成过程中产生错误。</p><ul class="list _ul"><li class="list__item" id="b5d758a7"><p><code class="code">target_directory</code> —（可选）结果生成的构件中的目录，该目录将包含由模式左半部分确定的文件。</p></li><li class="list__item" id="f064c3b3"><p><code class="code">target_archive</code> —（可选）TeamCity通过打包在模式左侧确定的构建工件来创建存档的路径。TeamCity将模式的正确部分视为<code class="code">target\_archive</code>只要它以<a href="patterns-for-accessing-build-artifacts.html#Obtaining-Artifacts-from-an-Archive">受支持的存档扩展名</a>结尾，即<code class="code">.zip</code> ， <code class="code">.7z</code> ， <code class="code">.jar</code> ， <code class="code">.tar.gz</code> ， 要么<code class="code">.tgz</code> 。</p></li></ul><a name="Examples:"></a><a name="Examples:"></a><h4 id="ConfiguringGeneralSettings-Examples:">例子：</h4><ul class="list _ul"><li class="list__item" id="e068baab"><p><code class="code">install.zip</code> —在构建工件中发布名为install.zip的文件</p></li><li class="list__item" id="a6fd215e"><p><code class="code">dist</code> —发布dist目录的内容</p></li><li class="list__item" id="4f4f1f16"><p><code class="code">target/*.jar</code> —在目标目录中发布所有jar文件</p></li><li class="list__item" id="32a805a9"><p><code class="code">target/**/*.txt=> docs</code> —发布在目标目录及其子目录中找到的所有txt文件。这些文件将在docs目录下的构建工件中提供。</p></li><li class="list__item" id="293d7ff7"><p><code class="code">reports => reports, distrib/idea*.zip</code> —将报告目录发布为与报告和文件匹配的目录<code class="code">idea*.zip</code>来自<code class="code">distrib</code>目录进入工件根目录。</p></li><li class="list__item" id="e9a25409"><p>如果需要，可以使用zip存档内的相对路径：<code class="code">results\result1\Dir1\Dir2 => archive.zip!results/result1/Dir1</code></p></li><li class="list__item" id="29e4822e">相同的target_archive名称可以多次使用，例如：<ul class="list _ul"><li class="list__item" id="051a5d8d"><code class="code">+:*/*.html => report.zip</code></li><li class="list__item" id="057fdd72"><code class="code">+:*/*.css => report.zip!/css/</code></li><li class="list__item" id="99d1f817"><code class="code">-:*/*.txt => report.zip</code></li></ul></li></ul><p id="5b1ac32f"><a name="buildOptions"></a><a name="ConfiguringGeneralSettings-buildOptions"></a></p><a name="BuildOptions"></a><a name="Build-Options"></a><h3 id="ConfiguringGeneralSettings-BuildOptions">构建选项</h3><p id="189c9542">以下选项可用于构建配置：</p><a name="HangingBuildDetection"></a><a name="Hanging-Build-Detection"></a><h4 id="ConfiguringGeneralSettings-HangingBuildDetection">吊装检测</h4><p id="931740ca">选择“ <b id="5567acac">启用挂起的构建检测”</b>选项以检测可能“挂起”的构建。如果某个构建的运行时间大大超过了估计的<b id="d121e224">平均运行时间，</b>并且自超出估计以来该构建未发送任何消息，则该构建被视为“挂起”。为了正确检测挂起的构建，TeamCity必须基于多个构建来估计平均构建运行时间。因此，如果您有新的构建配置，则可能需要运行几次构建后才启用此功能，以便TeamCity有足够的信息来估计平均运行时间。</p><a name="AllowTriggeringPersonalBuilds"></a><a name="Allow-Triggering-Personal-Builds"></a><h4 id="ConfiguringGeneralSettings-AllowTriggeringPersonalBuilds">允许触发个人构建</h4><p id="3cdfe5c3">您可以通过取消选中“ <b id="09a65dba">允许触发个人版本”</b>选项来限制运行<a href="personal-build.html">个人版本</a> （默认情况下处于启用状态）。</p><a name="EnableStatusWidget"></a><a name="Enable-Status-Widget"></a><h4 id="ConfiguringGeneralSettings-EnableStatusWidget">启用状态小部件</h4><p id="f83787b9">通过此选项，可以在构建配置中检索上次构建的状态和基本详细信息，而无需任何用户身份验证。请注意，这还允许获取构建配置中任何特定构建的状态（但是，无法列出构建，并且除了构建状态（ <code class="code">success/failure/internal error/cancelled</code> ）可用）。</p><p id="cde8f13a">可以通过下面描述的HTML状态小部件或在<a href="rest-api.html#Build-Status-Icon">REST API</a>的帮助下通过单个图标来检索状态。</p><a name="HTMLStatusWidget"></a><a name="HTML-Status-Widget"></a><h4 id="ConfiguringGeneralSettings-HTMLStatusWidget">HTML状态小部件</h4><p id="761027c0">此功能使您可以在公司的网站，Wiki，Confluence或任何其他网页上获得当前项目状态的概述。<b id="90026d63">启用“启用状态窗口小部件”</b>选项后，HTML片段可以包含在外部网页中，并显示当前的构建配置状态。对于单独的<a href="rest-api.html#Build-Status-Icon">构建状态图标</a> ，请检查<a href="rest-api.html#Build-Status-Icon">REST构建状态图标</a> 。</p><p id="e87cdedf">状态小部件提供以下构建过程信息：</p><ul class="list _ul"><li class="list__item" id="830f12f3"><p>最新的生成结果，</p></li><li class="list__item" id="74183c5e"><p>内部版本号</p></li><li class="list__item" id="4d0c055a"><p>建置状态，</p></li><li class="list__item" id="e51311b8"><p>链接到最新的构建工件。状态窗口小部件不需要用户登录TeamCity。</p></li></ul><p id="01372412">启用该功能后，您需要在网页源代码中包含以下代码片段：</p><ul class="list _ul"><li class="list__item" id="4a053077"><p id="ca5e605c">将此代码示例添加到<code class="code"><head></code>部分（或添加<code class="code">withCss=true</code>参数<i id="2a52f198">externalStatus.html</i> ）：</p><div class="code-block" data-lang="bash"><style type="text/css"></style>
</div></li><li class="list__item" id="1fafd1b6"><p id="d56e80fb">将此代码示例插入要显示构建配置状态的位置：</p><div class="code-block" data-lang="bash"><script type="text/javascript" src="javascript:void(0);">
</script>

</div></li><li class="list__item" id="9d72ef11"><p id="f05532c2">如果您更喜欢使用纯HTML而不是javascript，请省略<b id="fdbb17ef">js = 1</b>参数，并使用iframe代替脚本：</p><div class="code-block" data-lang="bash"><iframe src="javascript:void(0);"></iframe>
</div></li><li class="list__item" id="36b4d7c0"><p id="375ec1f7">如果您想包含默认CSS样式而不修改<code class="code"><head></code>部分中，添加<b id="e1b2f393">withCss = true</b>参数要提供有关特定构建配置的最新状态信息，请根据需要在URL中多次使用以下参数：</p><div class="code-block" data-lang="bash">＆buildTypeId = <external id="" build="" configuration="">

</external></div></li></ul><p id="41b9e36b">通过替换也可以显示所有项目构建配置的状态<code class="code">"&buildTypeId=<external build configuration ID>"</code>与<code class="code">"&projectId=<external project ID>"</code> 。您可以选择这些参数的组合以显示所需的项目并在网页上构建配置。</p><p id="a8ca1384">您还可以下载并自定义<code class="code">externalStatus.css</code>文件（例如，您可以通过使用禁用某些列<code class="code">display: none</code> ;查看中的评论<code class="code">externalStatus.css</code> ）。但是在这种情况下，您必须<i id="e5ff37de">不要</i>包括<b id="62c992a1">withCss = true</b>参数，而应明确提供CSS样式，最好在<code class="code"><head></code>部分。</p><p id="173db697">启用状态窗口小部件还允许未登录的用户获取构建配置的RSS feed。</p><a name="LimitNumberofSimultaneouslyRunningBuilds"></a><a name="Limit-Number-of-Simultaneously-Running-Builds"></a><h4 id="ConfiguringGeneralSettings-LimitNumberofSimultaneouslyRunningBuilds">限制同时运行的内部版本数</h4><p id="68302219">指定可以在所有代理上同时运行的相同配置的内部版本数。当所有代理都忙于单个项目的构建时，此选项有助于避免这种情况。输入0以允许无限数量的构建同时运行。</p><hr id="35767fef"><p id="f5841fa3"><b id="50e0870b">也可以看看：</b></p><p id="e4763ff4"><b id="399e444a">概念</b> ： <a href="build-configuration.html">构建配置</a></p><hr id="be5d9c60"></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>