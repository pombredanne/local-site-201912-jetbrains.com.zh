<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Team Foundation Server-帮助|帮助团队城市</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Team Foundation Server" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/configuring-vcs-settings.md|Configuring VCS Settings/configuring-vcs-roots.md|Configuring VCS Roots/team-foundation-server.md|Team Foundation Server" data-main-title="Team Foundation Server" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/team-foundation-server.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="team-foundation-server.md" data-toc="Team Foundation Server">Team Foundation服务器</h1><aside class="note " rel="team-foundation-server.md" id="3f2f3175" data-title=""><p id="48f6af5c">在2019年，Team Foundation Server已重命名为Azure DevOps Server。此页面的内容适用于Azure DevOps服务器。</p></aside><p id="b4a95399">本页包含设置<a href="vcs-root.html">VCS根目录</a>以连接到Microsoft Team Foundation Server版本控制时可用的字段和选项的说明。</p><p id="853d9176"><a href="configuring-vcs-roots.html#Common-VCS-Root-Properties">此处</a>介绍<a href="configuring-vcs-roots.html#Common-VCS-Root-Properties">了</a>常见的VCS根属性。</p><p id="5afd765c">连接到Azure DevOps Git存储库时，选择<a href="git.html">Git</a>作为VCS的类型。</p><aside class="tip sideblock" rel="5afd765c" id="f8bd33bc" data-title=""><p id="3bd5b750">TeamCity还可以从资源库URL <a href="guess-settings-from-repository-url.html">自动配置项目/ VCS根目录</a> 。如果您配置了TFVC根目录，TeamCity还将建议配置<a href="team-foundation-work-items.html">Team Foundation Work Items</a> 。</p></aside><p id="e2cbf1ff">在此页：</p><p id="0ff75551"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#TeamFoundationServer-Cross-PlatformTFSIntegration">跨平台TFS集成</a></li><li class="list__item"><a href="#TeamFoundationServer-TFSSettings">TFS设置</a></li><li class="list__item"><a href="#TeamFoundationServer-Agent-SideCheckout">代理方结帐</a></li><li class="list__item"><a href="#TeamFoundationServer-AuthenticationNotes">验证说明</a><ul class="list _bullet"><li class="list__item"><a href="#TeamFoundationServer-PersonalAccessTokens">个人访问令牌</a><ul class="list _bullet"><li class="list__item"><a href="#TeamFoundationServer-RequiredAccessScope">所需的访问范围</a></li></ul></li><li class="list__item"><a href="#TeamFoundationServer-AlternateAuthenticationCredentials">备用身份验证凭证</a></li><li class="list__item"><a href="#TeamFoundationServer-NTLM/KerberosonLinuxandmacOS">Linux和macOS上的NTLM / Kerberos</a></li></ul></li><li class="list__item"><a href="#TeamFoundationServer-TeamFoundationProxyConfiguration">Team Foundation代理配置</a></li><li class="list__item"><a href="#TeamFoundationServer-HTTPProxyServerConfiguration">HTTP代理服务器配置</a><ul class="list _bullet"><li class="list__item"><a href="#TeamFoundationServer-Default.NETWorkingMode">默认.NET工作模式</a></li><li class="list__item"><a href="#TeamFoundationServer-Cross-PlatformWorkingMode">跨平台工作模式</a></li></ul></li></ul><p></p><a name="Cross-PlatformTFSIntegration"></a><a name="Cross-Platform-TFS-Integration"></a><div class="chapter"><h2 id="TeamFoundationServer-Cross-PlatformTFSIntegration">跨平台TFS集成</h2><p id="5d78c925">TeamCity具有<a href="https://blog.jetbrains.com/teamcity/2015/12/teamcity-cross-platform-tfs-support/" rel="noopener noreferrer" data-external="true" target="_blank">跨平台的TFS集成</a> ，可在Linux，macOS和Windows平台上运行。在不安装其他软件的情况下，TeamCity服务器和生成代理可以与Team Foundation Servers 2012或更高版本以及Azure DevOps Services进行交互。</p><p id="7b8c3188">内置的TFS插件可以在两种模式下工作：默认和跨平台。工作模式取决于Team Explorer的可用性（默认模式）：如果不存在，则插件将从默认模式退回到跨平台模式。</p><p id="5fc89c46">当检测到Team Explorer版本时，TeamCity将检查<a href="https://msdn.microsoft.com/en-us/library/yf1d93sz.aspx" rel="noopener noreferrer" data-external="true" target="_blank">.NET GAC</a>和以下路径：</p><ul class="list _ul"><li class="list__item" id="468841f0"><code class="code">Windows x86: %CommonProgramFiles%Microsoft Shared\Team Foundation Server\%version_number%</code></li><li class="list__item" id="3e033cd7"><code class="code">Windows x64: %CommonProgramFiles(x86)%Microsoft Shared\Team Foundation Server\%version_number%</code></li></ul><p id="522739e9">要在TeamCity上实施跨平台模式，请设置<code class="code">teamcity.tfs.mode=java</code> <a href="configuring-teamcity-server-startup-properties.html#TeamCity-internal-properties">内部属性</a>或<a href="configuring-build-parameters.html">构建配置参数</a> 。</p></div><a name="TFSSettings"></a><a name="TFS-Settings"></a><div class="chapter"><h2 id="TeamFoundationServer-TFSSettings">TFS设置</h2><div class="table-wrapper"><table width="100%" id="d194fe0a"><thead><tr id="3e3e5341" class="ijRowHead"><th id="8bfa06b4"><p id="40244139">选项</p></th><th id="31ef27a8"><p id="54beff1c">描述</p></th></tr></thead><tbody><tr id="a6ae1926" class="ijRowOdd"><td id="dd57bcd3"><p id="ccc36eb1">网址</p></td><td id="c3ec5fac"><p id="1d26b251">以下格式的Team Foundation Server URL：</p><ul class="list _ul"><li class="list__item" id="77b8f9ba"><p>TFS 2010+：<code class="code">http[s]://<host>:<port>/tfs/<collection></code></p></li><li class="list__item" id="d72652e3"><p>TFS 2005/2008：<code class="code">http[s]://<host>:<port></code></p></li><li class="list__item" id="71634298"><p>Azure DevOps：<code class="code">https://dev.azure.com/<organization></code></p></li><li class="list__item" id="d0983087"><p>VSTS：<code class="code">https://<accountname>.visualstudio.com</code></p></li></ul></td></tr><tr id="d43e8562" class="ijRowEven"><td id="36d1cfcd"><p id="e8eb4ed3">根</p></td><td id="c4fea43f"><p id="7b75180b">使用以下格式指定根：<code class="code">$<project name><project_catalog></code></p></td></tr><tr id="fd3f98dc" class="ijRowOdd"><td id="eb8d42f5"><p id="9803ef67">用户名</p></td><td id="3ad23857"><p id="100a13c0">指定一个用户来访问Team Foundation Server。这可以是用户名或<code class="code">DOMAIN\UserName</code>串。<br>使用空白使TFS选择用于运行TeamCity Server（或用于代理方结帐的代理）的用户帐户。</p></td></tr><tr id="a5dd4d48" class="ijRowEven"><td id="b179971d"><p id="15e2f117">密码</p></td><td id="81d4c76e"><p id="39d8ba30">输入上面输入的用户密码</p></td></tr></tbody></table></div><p id="28331d4e">了解有关<a href="#Authentication-Notes">Azure DevOps中的</a>身份验证的更多信息。</p></div><a name="Agent-SideCheckout"></a><a name="Agent-Side-Checkout"></a><div class="chapter"><h2 id="TeamFoundationServer-Agent-SideCheckout">代理方结帐</h2><p id="02a30f0b">Windows以及Linux和Mac代理计算机上都支持<a href="vcs-checkout-mode.html#agent-checkout">代理方</a>结帐。</p><p id="4ad494ab">TeamCity为使用的每个<a href="build-checkout-directory.html">结帐目录</a>自动创建一个TFS工作区。工作空间是代表VCS根设置中指定的用户帐户创建的。</p><p id="8164b2cc">默认情况下，创建的TFS工作空间使用TFS服务器设置中定义的位置。您可以通过<a href="configuring-build-parameters.html">构建配置参数</a>强制TeamCity使用特定的工作区位置<code class="code">teamcity.tfs.workspace.location</code>调成<code class="code">local</code>要么<code class="code">server</code> 。</p><p id="bb8dd520">创建的TFS工作区会根据通过配置的超时自动删除。 <code class="code">teamcity.tfs.workspace.idleTime</code> <a href="build-agent-configuration.html">构建代理程序属性</a>设置为默认值1209600秒（2周）。</p><div class="table-wrapper"><table width="100%" id="cc7985a7"><thead><tr id="1f8bab72" class="ijRowHead"><th id="26cef2f0"><p id="030ef3e2">选项</p></th><th id="8d8a382b"><p id="853f4db6">描述</p></th></tr></thead><tbody><tr id="a43c2d4c" class="ijRowOdd"><td id="33c7922d"><p id="3dfa7fdb">强制覆盖所有文件</p></td><td id="bc0d96ec"><p id="0c609c46">启用该选项后，TeamCity将调用TFS更新工作空间，重写所有文件。</p></td></tr></tbody></table></div><p id="5537e3b3">通常，不需要为每个构建都进行强制更新。但是，如果您怀疑TeamCity没有从存储库中获取最新版本，则可以使用此选项。</p><aside class="note " rel="5537e3b3" id="0d29913f" data-title=""><p id="8b310e31">TFS不允许在映射到同一目录的计算机上有多个工作空间。如果发生这种情况，TeamCity TFS代理端检出将尝试删除相交的工作区，以创建一个与指定的VCS根目录和检出规则匹配的新工作区。</p><p id="89b48391">请注意，它可能无法删除其他用户创建的工作空间，在这种情况下，您需要手动删除此类工作空间。</p><p id="6a978ed0">建议使用以下格式的签出规则来区分本地映射：</p><ul class="list _ul"><li class="list__item" id="7a55c2aa"><code class="code">$/root1 => /root1</code></li><li class="list__item" id="7a6c223e"><code class="code">$/root2 => /root2</code></li></ul></aside></div><a name="AuthenticationNotes"></a><a name="Authentication-Notes"></a><div class="chapter"><h2 id="TeamFoundationServer-AuthenticationNotes">验证说明</h2><p id="132ce6c7"><a name="azure-devops"></a><a name="TeamFoundationServer-azure-devops"></a></p><p id="222d3bac"><a name="VisualStudioOnline"></a><a name="TeamFoundationServer-VisualStudioOnline"></a></p><p id="fa70d3ab"><a name="vsts"></a><a name="TeamFoundationServer-vsts"></a></p><p id="bfc336da"><a name="teamFoundationServerLive"></a><a name="TeamFoundationServer-teamFoundationServerLive"></a></p><p id="341bfd03">Azure DevOps中提供了以下身份验证选项。</p><a name="azure-authentication"></a><a name="PersonalAccessTokens"></a><a name="Personal-Access-Tokens"></a><div class="chapter"><h3 id="TeamFoundationServer-PersonalAccessTokens">个人访问令牌</h3><p id="4037beab">若要使用访问令牌，您需要在Azure DevOps帐户中创建<a href="https://www.visualstudio.com/en-us/docs/setup-admin/team-services/use-personal-access-tokens-to-authenticate" rel="noopener noreferrer" data-external="true" target="_blank">个人访问令牌</a> ，您必须在其中在存储库中设置一些<b id="07daaa1d">代码</b> <a href="#Required-Access-Scope">访问范围</a> ，并在配置VCS根目录时使用它。</p><aside class="note " rel="4037beab" id="c886b522" data-title=""><p id="1ab28995">您只能使用个人访问令牌对Azure DevOps Services进行身份验证。TeamCity不支持对托管的<a href="https://azure.microsoft.com/en-in/services/devops/server/" rel="noopener noreferrer" data-external="true" target="_blank">Azure DevOps Server</a> （以前称为Team Foundation Server）安装的令牌身份验证。</p></aside><div class="table-wrapper"><table width="100%" id="d7bc54ca"><thead><tr id="7a71716a" class="ijRowHead"><th id="fc20285c"><p id="d68aebd3">选项</p></th><th id="17bff133"><p id="706b1d5d">描述</p></th></tr></thead><tbody><tr id="8e5d7120" class="ijRowOdd"><td id="cec3884f"><p id="0e83c4b1">用户名</p></td><td id="f9eb2f4d"><p id="4551c5c2">TFVC保留空白，Git保留任何值，例如username</p></td></tr><tr id="c0dc3102" class="ijRowEven"><td id="61a2c3ff"><p id="44ebd1c2">密码</p></td><td id="4a1a837e"><p id="40d22aa9">输入您之前创建的个人访问令牌</p></td></tr></tbody></table></div><a name="RequiredAccessScope"></a><a name="Required-Access-Scope"></a><div class="chapter"><h4 id="TeamFoundationServer-RequiredAccessScope">所需的访问范围</h4><div class="table-wrapper"><table width="100%" id="b49ca343"><thead><tr id="43bc31c8" class="ijRowHead"><th id="426d00a3"><p id="c3cf9829">TFS子系统</p></th><th id="b1d93d92"><p id="25d119bc">范围</p></th></tr></thead><tbody><tr id="047e0f8c" class="ijRowOdd"><td id="f730b130"><p id="c14fa5b8">TFVC</p></td><td id="112eb265"><p id="b4355962">所有范围</p></td></tr><tr id="d9ad90a7" class="ijRowEven"><td id="0f17f7cb"><p id="b1fea7fa">吉特</p></td><td id="c592d641"><p id="97675934">版本设置的代码（读取）/代码（读取和写入）</p></td></tr><tr id="04433cf6" class="ijRowOdd"><td id="5a2a44fd"><p id="7baf5d37">工作项目</p></td><td id="dc413390"><p id="f1ae4d15">工作项目（已读）</p></td></tr><tr id="0b36f412" class="ijRowEven"><td id="7b02ad83"><p id="f686977c">提交状态</p></td><td id="21540ca8"><p id="95f47345">代码（状态）</p></td></tr></tbody></table></div></div></div><a name="AlternateAuthenticationCredentials"></a><a name="Alternate-Authentication-Credentials"></a><div class="chapter"><h3 id="TeamFoundationServer-AlternateAuthenticationCredentials">备用身份验证凭证</h3><p id="208f10ae">若要使用登录名/密码对身份验证，必须在Azure DevOps帐户中启用<a href="https://www.visualstudio.com/en-us/docs/report/analytics/client-authentication-options#create-an-alternate-access-credential" rel="noopener noreferrer" data-external="true" target="_blank">备用凭据</a> ，您可以在其中设置在配置VCS根目录时使用的辅助用户名和密码。</p></div><a name="NTLM/KerberosonLinuxandmacOS"></a><a name="NTLM/Kerberos-on-Linux-and-macOS"></a><div class="chapter"><h3 id="TeamFoundationServer-NTLM/KerberosonLinuxandmacOS">Linux和macOS上的NTLM / Kerberos</h3><p id="e97258fe">要使用此身份验证方法，请检查您的计算机是否包含Kerberos库以及身份验证是否已正确配置。如果遇到任何问题，请检查<a href="https://msdn.microsoft.com/en-us/library/gg475929(v=vs.120).aspx#Anchor_3" rel="noopener noreferrer" data-external="true" target="_blank">Microsoft文档中</a>描述的步骤。</p></div></div><a name="TeamFoundationProxyConfiguration"></a><a name="Team-Foundation-Proxy-Configuration"></a><div class="chapter"><h2 id="TeamFoundationServer-TeamFoundationProxyConfiguration">Team Foundation代理配置</h2><p id="030ed522">要启用<a href="https://www.visualstudio.com/en-us/docs/setup-admin/tfs/install/install-proxy-setup-remote" rel="noopener noreferrer" data-external="true" target="_blank">Team Foundation Proxy的使用</a> ，请定义<code class="code">TFSPROXY</code>运行TeamCity服务器或代理并重新启动它们以应用更改的用户帐户的环境变量。</p><p id="ace9d95d">例：</p><div class="code-block" data-lang="none">TFSPROXY = https：// tfs-proxy：8081</div></div><a name="HTTPProxyServerConfiguration"></a><a name="HTTP-Proxy-Server-Configuration"></a><div class="chapter"><h2 id="TeamFoundationServer-HTTPProxyServerConfiguration">HTTP代理服务器配置</h2><a name="Default.NETWorkingMode"></a><a name="Default-.NET-Working-Mode"></a><div class="chapter"><h3 id="TeamFoundationServer-Default.NETWorkingMode">默认.NET工作模式</h3><p id="7bda5b4b">为了与TFS服务器进行交互，将使用为运行TeamCity服务器或代理的用户帐户指定的代理服务器设置。</p></div><a name="Cross-PlatformWorkingMode"></a><a name="Cross-Platform-Working-Mode"></a><div class="chapter"><h3 id="TeamFoundationServer-Cross-PlatformWorkingMode">跨平台工作模式</h3><p id="1560619f">在TFS集成中将使用为TeamCity服务器或代理指定的默认Java代理服务器设置。在TeamCity服务器上，可以使用<a href="configuring-teamcity-server-startup-properties.html">内部属性或Java选项</a> 。在TeamCity代理上，可以使用<a href="build-agent-configuration.html">构建代理配置</a>或<a href="configuring-build-agent-startup-properties.html">Java选项</a> 。TeamCity-TFS集成支持以下选项：</p><div class="code-block" data-lang="none">http.proxyHost http.proxyPort http.nonProxyHosts https.proxyHost https.proxyPort http.proxyUser http.proxyPassword</div><hr id="e9825be8"></div></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>