<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>触发自定义生成-帮助|帮助团队城市</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Triggering a Custom Build" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/triggering-a-custom-build.md|Triggering a Custom Build" data-main-title="Triggering a Custom Build" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/triggering-a-custom-build.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="triggering-a-custom-build.md" data-toc="Triggering a Custom Build">触发自定义构建</h1><p id="e4082fcb">构建配置通常<a href="configuring-build-triggers.html">会</a>配置<a href="configuring-build-triggers.html">构建触发器</a> ，该<a href="configuring-build-triggers.html">触发器会</a>在每次满足条件（例如计划时间或检测VCS更改等）时自动启动新构建。</p><p id="71596aa5">除了自动触发构建之外，TeamCity还允许您在需要时手动运行构建，并通过添加属性，使用特定更改，在特定代理上运行构建等来自定义此构建。</p><p id="dcd7796d">在此页：</p><p id="907251a4"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#TriggeringaCustomBuild-RunCustomBuilddialog">运行自定义构建对话框</a><ul class="list _bullet"><li class="list__item"><a href="#TriggeringaCustomBuild-GeneralOptions">常规选项</a></li><li class="list__item"><a href="#TriggeringaCustomBuild-Dependencies">依存关系</a></li><li class="list__item"><a href="#TriggeringaCustomBuild-Changes">变化</a></li><li class="list__item"><a href="#TriggeringaCustomBuild-Includechanges">包括变更</a></li><li class="list__item"><a href="#TriggeringaCustomBuild-Buildbranch">建立分支</a></li><li class="list__item"><a href="#TriggeringaCustomBuild-Usesettings">使用设定</a></li><li class="list__item"><a href="#TriggeringaCustomBuild-Parameters">参量</a></li><li class="list__item"><a href="#TriggeringaCustomBuild-CommentandTags">评论和标签</a></li></ul></li><li class="list__item"><a href="#TriggeringaCustomBuild-PromotingBuild">推进建设</a></li></ul><p></p><p id="43917add">有几种方法可以在TeamCity中启动自定义版本：</p><ul class="list _ul"><li class="list__item" id="41fe2110"><p>单击“ <b id="5bb5df6f">运行”</b>按钮上的省略号，然后在“ <b id="12428854">运行自定义构建”</b>对话框中指定选项， <a href="#General-Options">如下所述</a> 。</p></li><li class="list__item" id="263c4a56"><p>要使用特定的改变运行自定义生成，打开构建结果页面上，转到<a href="working-with-build-results.html#Changes">更改</a>选项卡，展开所需的改变，单击<b id="c5f346af">运行构建这种变化</b> ，并与进行<a href="#General-Options">选择</a>在<b id="d310e699">运行自定义生成</b>对话框。</p></li><li class="list__item" id="f0ab679b"><p>使用对TeamCity的<a href="accessing-server-by-http.html">HTTP请求</a>或<a href="rest-api.html#Triggering-a-Build">REST API请求</a>来触发构建。</p></li><li class="list__item" id="5c53af49"><p>促进构建-请参见<a href="#Promoting-Build">下文</a> 。</p></li></ul><a name="RunCustomBuilddialog"></a><a name="Run-Custom-Build-dialog"></a><div class="chapter"><h2 id="TriggeringaCustomBuild-RunCustomBuilddialog">运行自定义构建对话框</h2><a name="GeneralOptions"></a><a name="General-Options"></a><div class="chapter"><h3 id="TriggeringaCustomBuild-GeneralOptions">常规选项</h3><p id="1c0c956c">从下拉列表中选择要在其上运行构建的代理。请注意，对于列表中的每个代理，TeamCity将显示其当前状态，并估计如果该代理当前正在运行构建，则代理何时将变为空闲状态。除了可以在列表中的特定代理上运行构建之外，还可以使用以下选项之一：</p><ul class="list _ul"><li class="list__item" id="e2b4a0cb"><p><b id="a9234f51">最快的空闲代理</b> ： <i id="e5db6a1b">默认选项</i> ;如果选择，TeamCity将基于计算的估算值自动选择一个代理来运行构建。</p></li><li class="list__item" id="18113738"><p><b id="f34ad22d"><a certain="">池中</a>最快的代理</b> ：如果选中，TeamCity将在指定池中的代理上运行构建</p></li><li class="list__item" id="04953e62"><p>如果配置了<a href="teamcity-integration-with-cloud-solutions.html">云集成，</a>则可以选择从<b id="4b307781">某个云映像</b>在代理上运行构建。如果不存在这种类型的可用云代理，TeamCity也将尝试启动一个新的云代理。</p></li><li class="list__item" id="f447d04b"><b id="4f1e177a">运行构建<a specified="">代理</a></b></li><li class="list__item" id="53fa28e9"><b id="89f8731a">所有已启用的兼容代理</b> ：使用此选项可在所有已启用并与构建配置兼容的代理上同时运行构建。在以下情况下，此选项可能很有用：<ul class="list _ul"><li class="list__item" id="393f1957"><p>运行用于代理维护目的的构建（例如，您可以创建配置以检查环境升级/更新后代理是否正常运行）。</p></li><li class="list__item" id="b224e55c"><p>在不同平台上运行构建（例如，您可以设置配置，并为其指定许多安装了不同环境的兼容构建代理）。</p></li></ul></li></ul><p id="b0922688">在<b id="3032c3fd">常规</b>选项上，您还可以指定是否</p><ul class="list _ul"><li class="list__item" id="b5e2ff75"><p>此特定版本将作为<a href="personal-build.html">个人</a>运行</p></li><li class="list__item" id="c1116875"><p>这个特定的构建将放在<a href="build-queue.html">构建队列</a>的顶部</p></li><li class="list__item" id="cfeaafb4">在此构建之前，将清除<a href="build-checkout-directory.html">构建签出目录</a>中的所有文件。<ul class="list _ul"><li class="list__item" id="bb8f052d"><p><b id="be9da11b">从TeamCity 2017.1开始</b> ，如果配置了快照依赖关系，则可以将此选项应用于快照依赖关系。在这种情况下，构建链的所有构建都将被强制使用干净签出。该选项还可以重新构建所有依赖项（除非通过此对话框提供了自定义依赖项，或者计划触发器促进了构建）。</p></li></ul></li></ul></div><a name="Dependencies"></a><a name="Dependencies"></a><div class="chapter"><h3 id="TriggeringaCustomBuild-Dependencies">依存关系</h3><p id="78221dfc"><i id="76a2d4b0">此选项卡仅适用于依赖于其他版本的版本</i> 。<br>您可以强制重建所有依赖项，并选择将采用其工件的特定构建。默认情况下，显示最近的20个构建。要将下拉列表中显示的内部版本数增加到50，请使用<code class="code">teamcity.runCustomBuild.buildsLimit=50</code> <a href="configuring-teamcity-server-startup-properties.html#TeamCity-internal-properties">内部财产</a> 。</p></div><a name="Changes"></a><a name="Changes"></a><div class="chapter"><h3 id="TriggeringaCustomBuild-Changes">变化</h3><p id="a9f69334"><i id="9ee98c4c">仅当您有权访问构建配置的VCS根目录时，此选项卡才可用。</i><br>该选项卡允许您指定要包含在构建中的特定更改。</p><p id="896c9e46">该版本将使用更改的修订版签出源。也就是说，直到选定的所有更改都将包含在构建中。<br>请注意，TeamCity仅显示先前为当前构建配置VCS根目录检测到的更改。如果在发生更改后将VCS根目录从构建配置中分离出来，则无法在此类更改上运行构建。显示的更改数量有限。如果需要在其上运行构建的TeamCity中有较早的更改，则可以在更改日志中找到该更改，并<b id="87064988">通过此更改</b>操作使用“ <b id="87064988">运行构建”</b> 。</p></div><a name="Includechanges"></a><a name="Include-changes"></a><div class="chapter"><h3 id="TriggeringaCustomBuild-Includechanges">包括变更</h3><p id="61b50637"><b id="1aa3f383">包含更改</b>下拉列表允许您选择连接到配置的VCS根目录中的更改以在其上运行构建。</p><ul class="list _ul"><li class="list__item" id="c09053b6"><p><b id="96baf84a">开始构建时的最新更改</b> ：TeamCity将自动包括当前可用的所有更改。</p></li><li class="list__item" id="49e215e2"><p><last change="" to="" include="">：当您在下拉列表中选择一个更改时，TeamCity将使用所选更改及其之前进行的所有更改来运行构建。运行的更改早于最新可用版本的<a href="history-build.html">生成</a>将标记为“ <a href="history-build.html">历史记录生成”</a> 。</last></p></li></ul></div><a name="Buildbranch"></a><a name="Build-branch"></a><div class="chapter"><h3 id="TriggeringaCustomBuild-Buildbranch">建立分支</h3><p id="d1d3b165">如果您在构建配置中（或此构建配置的快照依赖项中）具有分支，则可以使用<b id="d487b870">Build分支</b>下拉列表，该下拉列表允许选择要用于自定义构建的分支。</p></div><a name="Usesettings"></a><a name="Use-settings"></a><div class="chapter"><h3 id="TriggeringaCustomBuild-Usesettings">使用设定</h3><p id="418e358c">如果您的项目启用了<a href="storing-project-settings-in-version-control.html">版本控制设置</a> ，则可以告诉TeamCity运行构建：</p><ul class="list _ul"><li class="list__item" id="7fac6ed8"><p>使用为项目定义的设置，服务器上的当前设置或VCS中的设置</p></li><li class="list__item" id="4e9fbd97"><p>当前在服务器上定义的项目设置</p></li><li class="list__item" id="9126743d"><p>从为该版本计算的VCS修订版中加载的设置。</p></li></ul><p id="b7703067">如果在上述<a href="#Include-changes">步骤中</a>选择了更改，则将加载与所选更改相对应的项目设置的修订。</p><p id="a834cb74">要定义要采用的设置，请使用“ <i id="f85d22e1">使用设置”</i>下拉菜单中的相应选项之一（此处的选项将覆盖<a href="storing-project-settings-in-version-control.html#Defining-Settings-to-Apply-to-Builds">项目级设置</a> ）。</p></div><a name="Parameters"></a><a name="Parameters"></a><div class="chapter"><h3 id="TriggeringaCustomBuild-Parameters">参量</h3><aside class="note " rel="TriggeringaCustomBuild-Parameters" id="22ed8712" data-title=""><p id="0d721855">仅当您有权更改构建配置的系统属性和环境变量时，这些设置才可用。</p></aside><p id="be1ac65c">此选项卡允许添加，编辑和删除新的参数/属性/变量，或重新定义其<a href="predefined-build-parameters.html">预定义值</a> 。<br>添加/编辑/删除属性和变量时，请注意以下几点：</p><ul class="list _ul"><li class="list__item" id="299e234f"><p>对于预定义的属性/变量，只有值是可编辑的。</p></li><li class="list__item" id="fcd9017c"><p>只能删除新添加的属性/变量。您不能删除预定义的属性。</p></li><li class="list__item" id="ad794293"><p>每个参数值不得超过16,000个字符。</p></li></ul></div><a name="CommentandTags"></a><a name="Comment-and-Tags"></a><div class="chapter"><h3 id="TriggeringaCustomBuild-CommentandTags">评论和标签</h3><p id="d98852e5">向构建中添加可选注释以及一个或多个<a href="build-tag.html">标签</a> 。您还可以通过选中本节中的相应框，将自定义版本添加到<a href="favorite-build.html">收藏夹</a> 。</p><aside class="note " rel="d98852e5" id="80476620" data-title=""><p id="2ed4bf44">更大的内部版本号并不意味着最近的更改，并且内部版本历史记录中的最后一个版本也不能反映最新项目源的状态：内部版本历史记录中的内部版本是按其开始时间而不是它们所包含的更改进行排序的。</p></aside></div></div><a name="PromotingBuild"></a><a name="Promoting-Build"></a><div class="chapter"><h2 id="TriggeringaCustomBuild-PromotingBuild">推进建设</h2><p id="6600eca3">构建升级是指使用覆盖的<a href="dependent-build.html">工件或快照依赖关系</a>触发自定义构建，即，手动启动已配置依赖关系的构建，但使用与依赖关系中指定的构建不同的构建。</p><p id="c42881e2">要促进构建，请打开依赖项构建的构建结果页面，然后单击“ <b id="a67b3f85">操作” |“操作”。推广</b> 。</p><p id="bcbc2634">例如，您的构建配置A被配置为从配置B的上一次成功构建中获取工件，但是您想要使用配置B的另一构建（而不是上次成功的构建）工件来运行配置A的构建，因此您促进早期的B版本。<br>构建升级仅影响从属构建的单次运行。单击<b id="e9a09fc6">Promote后</b> ，将使用指定构建工件的依赖构建配置的构建排队。除非您使用其他升级，否则从属构建配置的任何其他运行都将使用配置的构件（最后成功，最后固定等）。</p><p id="a7f4435e">有关更多详细信息，请参见<a href="http://blog.jetbrains.com/teamcity/2012/04/teamcity-build-dependencies-2/" rel="noopener noreferrer" data-external="true" target="_blank">相关博客文章</a> 。</p><hr id="09311f74"><p id="16ac1676"><b id="e55c7342">也可以看看：</b></p><p id="a368c142"><b id="d240ecc7">概念</b> ： <a href="build-queue.html">构建队列</a> | <a href="dependent-build.html">依赖构建</a> <a href="personal-build.html">个人打造</a><br><b id="ac6b434f">管理员指南</b> ： <a href="configuring-build-triggers.html">配置构建触发器</a></p><hr id="a2c15472"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>