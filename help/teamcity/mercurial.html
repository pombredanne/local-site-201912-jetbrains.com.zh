<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Mercurial-帮助|团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Mercurial" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/configuring-vcs-settings.md|Configuring VCS Settings/configuring-vcs-roots.md|Configuring VCS Roots/mercurial.md|Mercurial" data-main-title="Mercurial" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/mercurial.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="mercurial.md" data-toc="Mercurial">水银</h1><p id="e1aa4b7c">TeamCity使用典型的Mercurial命令行客户端：hg命令。支持Mercurial 1.5.2+。</p><aside class="note " rel="e1aa4b7c" id="e38466d4" data-title=""><p id="a0f28c04">Mercurial将安装在服务器计算机上，如果使用了<a href="vcs-checkout-mode.html#agent-checkout">代理程序侧签出</a> ，则将安装在代理程序上。</p></aside><p id="0c3a5b9c">注意：</p><ul class="list _ul"><li class="list__item" id="8d5bc47a"><p>不支持从IDE <b id="c05b47b3">远程运行</b> 。请改为使用“ <a href="branch-remote-run-trigger.html">分支远程运行触发器”</a> 。</p></li><li class="list__item" id="9c858834"><p>不支持代理方结帐的结帐规则，但<code class="code">.=><target_dir></code>规则。有关常见的VCS根属性，请参阅<a href="configuring-vcs-roots.html#Common-VCS-Root-Properties">本节</a> 。以下部分包含针对Mercurial的字段和选项的描述。</p></li></ul><p id="ce5487e9">TeamCity开箱即用地支持Mercurial。</p><p id="951a3845">在此页：</p><p id="e7a81b70"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#Mercurial-GeneralSettings">通用设置</a><ul class="list _bullet"><li class="list__item"><a href="#Mercurial-Pathtohgexecutabledetection">HG可执行文件检测的路径</a></li></ul></li><li class="list__item"><a href="#Mercurial-AgentSettings">代理设定</a></li><li class="list__item"><a href="#Mercurial-InternalProperties">内部性质</a></li></ul><p></p><a name="GeneralSettings"></a><a name="General-Settings"></a><div class="chapter"><h2 id="Mercurial-GeneralSettings">通用设置</h2><div class="table-wrapper"><table width="100%" id="f0da3ea3"><thead><tr id="80006d0c" class="ijRowHead"><th id="a231246b"><p id="c158912b">选项</p></th><th id="c3822c78"><p id="a35d6732">描述</p></th></tr></thead><tbody><tr id="0260564b" class="ijRowOdd"><td id="89c9f89b"><p id="b8898656">从中拉取更改</p></td><td id="b031c14a"><p id="f05c45fe">您的主机的URL。</p></td></tr><tr id="9293c7c2" class="ijRowEven"><td id="0b146ad8"><p id="4f2ee5b6">默认分支</p></td><td id="1aeb521e"><p id="611ddde9">设置为默认分支，该默认分支在没有分支规范或找不到分支规范的分支时使用。请注意，此处支持参数引用。</p></td></tr><tr id="9151dc3b" class="ijRowOdd"><td id="f5bb53ca"><p id="71da018f">分支规格</p></td><td id="5099f05b"><p id="a0ce7def">在此区域中，列出要监视更改的所有分支。语法类似于结帐规则： <code class="code">+|-:branch_name</code> ，在哪里<code class="code">branch_name</code>特定于VCS（带有可选<code class="code">*</code>占位符）。请注意，只允许使用一个星号，并且每个规则都必须以新行开头。书签也可以在分支和分支规范字段中使用。如果书签的名称与常规分支相同，则以常规分支为准。更多相关<a href="http://blog.jetbrains.com/teamcity/2013/04/mercurial-bookmarks/" rel="noopener noreferrer" data-external="true" target="_blank">TeamCity博客文章</a> 。</p><aside class="note " rel="a0ce7def" id="386bce59" data-title=""><p id="a88a1023">书签支持需要在TeamCity服务器上安装Mercurial 2.4。</p></aside></td></tr><tr id="6300f9f9" class="ijRowEven"><td id="83b76bde"><p id="96273c4c">将标签用作分支</p></td><td id="dd5b188d"><p id="2e4447bc">允许您在分支规范中使用标签。默认情况下，标签将被忽略。</p></td><td id="108220bd"></td></tr><tr id="9f3a7c40" class="ijRowOdd"><td id="3bd339b6"><p id="2b54b3b7">检测子仓库变更</p></td><td id="98a72093"><p id="4acec4df">默认情况下，不监视子存储库的更改。</p></td></tr><tr id="78a8c8bc" class="ijRowEven"><td id="ebbc5283"><p id="e2aeb66b">标签/合并的用户名</p></td><td id="75baeae3"><p id="9cfe1a41">用于标记的自定义用户名</p></td></tr><tr id="57fa1c01" class="ijRowOdd"><td id="9e5e4134"><p id="626e6ad9">使用未压缩的传输</p></td><td id="8c0badf8"><p id="1fd3fb0d">对于LAN中的存储库，未压缩的传输速度更快。</p></td></tr><tr id="e8db4dc8" class="ijRowEven"><td id="4fa002a4"><p id="50faf7ec">HG命令路径</p></td><td id="addc6ec7"><p id="73e9505c">hg可执行文件的路径。仅当列入白名单时，才在TeamCity服务器上使用。请参阅<a href="#Path-to-hg-executable-detection">下文</a> 。</p></td></tr></tbody></table></div><a name="Pathtohgexecutabledetection"></a><a name="Path-to-hg-executable-detection"></a><div class="chapter"><h3 id="Mercurial-Pathtohgexecutabledetection">HG可执行文件检测的路径</h3><p id="221b7f9a">启动代理后，hg插件会检测到代理计算机上安装的Mercurial。</p><p id="8f84b7fd">该插件尝试运行<code class="code">hg version</code>命令使用由指定的路径<code class="code">teamcity.hg.agent.path</code>参数。您可以在< <a href="agent-home-directory.html">代理主目录</a> > \ conf \ buildAgent.properties中更改此参数。</p><p id="60fb8484">如果未设置此参数，则插件使用<code class="code">hg</code>作为命令的路径，假设它位于$ PATH中。如果命令已成功执行且mercurial具有适当的版本（1.5.2+），则hg-plugin将在<code class="code">teamcity.hg.agent.path</code>参数。</p><p id="0e340969">在构建期间，该插件使用VCS根设置的<i id="486cd69e">HG命令路径</i>字段中指定的hg。要使用检测到的汞，将<code class="code">%teamcity.hg.agent.path%</code>在这个领域里。具有此类设置的配置将仅在报告到hg路径的代理上运行。</p><p id="5cdec330">插件的服务器端检查<code class="code">teamcity.hg.customServerHgPathWhitelist</code> <a href="configuring-teamcity-server-startup-properties.html">内部财产</a> 。该属性包含<code class="code">;</code> -允许在服务器上使用的汞路径的分隔列表。如果VCS根目录中指定的路径在白名单中，则将在服务器上使用该路径。如果不是，则在<code class="code">teamcity.hg.server.path</code> <a href="configuring-teamcity-server-startup-properties.html">内部属性</a>被使用。如果未设置此属性，TeamCity服务器将使用<code class="code">hg</code>来自<code class="code">$PATH</code> 。</p></div></div><a name="AgentSettings"></a><a name="Agent-Settings"></a><div class="chapter"><h2 id="Mercurial-AgentSettings">代理设定</h2><p id="ffaf8e93">这些是在代理端检出（ <a href="vcs-checkout-mode.html#prefer-agent-checkout">默认模式</a> ）的<a href="vcs-checkout-mode.html#prefer-agent-checkout">情况下</a>使用的设置，这要求在所有代理上都安装Mercurial。</p><div class="table-wrapper"><table class="  _layout-fixed" width="100%" id="6f2e0cb8"><thead><tr id="d5653364" class="ijRowHead"><th id="bba9badc"><p id="45b1a32f">选项</p></th><th id="75f68384"><p id="fbbe981b">描述</p></th></tr></thead><tbody><tr id="6cadbeb4" class="ijRowOdd"><td id="aba3271a"><p id="6a7f1acb">Mercurial配置</p></td><td id="faca8047"><p id="b06e6099">指定在代理方结帐期间要应用于存储库的Mercurial配置选项，例如，输入以下内容以启用<code class="code">largefiles</code>延期：</p><div class="code-block" data-lang="none">[扩展名]`largefiles =</div><p id="fc3f967c">配置格式描述<a href="http://www.selenic.com/mercurial/hgrc.5.html" rel="noopener noreferrer" data-external="true" target="_blank">这里</a> 。</p><p id="d3038c6f">在2017.2.2之前的版本中，TeamCity服务器上也使用了此选项。由于安全原因，此功能已被禁用。</p></td></tr><tr id="498dcd81" class="ijRowEven"><td id="0ccc7555"><p id="ccd59da4">清除设定</p></td><td id="39244906"><p id="845dd087">定义是否<a href="https://www.mercurial-scm.org/wiki/PurgeExtension" rel="noopener noreferrer" data-external="true" target="_blank">清除</a>当前存储库中未被Mercurial跟踪的<a href="https://www.mercurial-scm.org/wiki/PurgeExtension" rel="noopener noreferrer" data-external="true" target="_blank">文件</a>和目录。您可以选择仅删除未知文件和空目录，也可以删除忽略的文件。保留添加的文件和（未修改或已修改）跟踪的文件。</p></td></tr><tr id="e649852a" class="ijRowOdd"><td id="35139943"><p id="3fe5f563">使用镜子</p></td><td id="30b5ce0c"><p id="95e10a83">启用后，TeamCity首先创建本地代理镜像（在代理的<code class="code">system/mercurial</code>目录），然后从此本地镜像克隆到工作目录。由于仅清除构建工作目录，因此该选项可加快清除签出的速度。另外，如果在多个构建配置中使用单个根，则克隆会更快。</p></td></tr></tbody></table></div></div><a name="InternalProperties"></a><a name="Internal-Properties"></a><div class="chapter"><h2 id="Mercurial-InternalProperties">内部性质</h2><p id="4c2ef5a3">本节介绍了与hg相关的<a href="configuring-teamcity-server-startup-properties.html">内部属性</a> 。您可以根据需要修改默认值以调整Mercurial设置。</p><p id="1ff2951f">服务器端<a href="configuring-teamcity-server-startup-properties.html">内部属性</a> ：</p><div class="table-wrapper"><table class=" wide" width="100%" id="94626e5d"><thead><tr id="e229413a" class="ijRowHead"><th id="5b869182"><p id="7e5bcc9b">属性</p></th><th id="a281f3d3"><p id="02ae5714">默认</p></th><th id="18848674"><p id="408b65f8">描述</p></th></tr></thead><tbody><tr id="7aa03946" class="ijRowOdd"><td id="a75805b3"><p id="a8ddf618"><code class="code">teamcity.hg.pull.timeout.seconds</code></p></td><td id="e1977d29"><p id="df22b011">3600</p></td><td id="a31831f0"><p id="443899d9">拉操作运行的最长时间（以秒为单位）</p></td></tr><tr id="a9dd2203" class="ijRowEven"><td id="714aaeb5"><p id="2565c915"><code class="code">teamcity.hg.server.path</code></p></td><td id="d9fc64ee"><p id="3f66f608">汞</p></td><td id="7e08a327"><p id="0165c4ce">服务器<a href="#Path-to-hg-executable-detection">上hg可执行文件的路径</a> （有关详细信息，请参见<a href="#Path-to-hg-executable-detection">hg可执行文件检测路径</a> ）。</p></td></tr><tr id="02c0e2c7" class="ijRowOdd"><td id="8bf8d584"><p id="2c64fb5c"><code class="code">teamcity.hg.customServerHgPathWhitelist</code></p></td><td id="120a6d0c"></td><td id="9624fe88"><p id="c81a8c72"><code class="code">;</code>分隔的允许在TeamCity服务器计算机上使用的hg可执行文件的路径列表</p></td></tr></tbody></table></div><p id="5e50eee1">Mercurial的<a href="build-agent-configuration.html">代理配置</a> ：</p><div class="table-wrapper"><table class=" wide" width="100%" id="4872c87b"><thead><tr id="9eec76d4" class="ijRowHead"><th id="fe5fe53f"><p id="46145892">属性</p></th><th id="42b52aa9"><p id="93a90e8c">默认</p></th><th id="40573f65"><p id="6c33a29b">描述</p></th><th id="9d3eb3b0"></th></tr></thead><tbody><tr id="b1975c59" class="ijRowOdd"><td id="05feb8f4"><p id="e05b875e"><code class="code">teamcity.hg.pull.timeout.seconds</code></p></td><td id="ca9e406e"><p id="d4110370">3600</p></td><td id="0dba3a3d"><p id="ac8d3be6">拉操作运行的最长时间（以秒为单位）</p></td></tr><tr id="9b71de2f" class="ijRowEven"><td id="19f24b91"><p id="ad0a85ae"><code class="code">teamcity.hg.agent.path</code></p></td><td id="d06e89b6"><p id="9f20f353">汞</p></td><td id="0e01e22a"><p id="8020097a">代理上的hg可执行文件<a href="#Path-to-hg-executable-detection">路径</a> （有关详细信息，请参见<a href="#Path-to-hg-executable-detection">hg可执行文件检测路径</a> ）。</p></td></tr></tbody></table></div><hr id="33673e5b"><p id="269f6ee3"><b id="ddb33740">也可以看看：</b></p><p id="d781d808"><b id="1e4c506e">管理员指南</b> ： <a href="branch-remote-run-trigger.html">分支远程运行触发器</a></p><hr id="56147351"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>