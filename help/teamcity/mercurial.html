<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Mercurial - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Mercurial" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/configuring-vcs-settings.md|Configuring VCS Settings/configuring-vcs-roots.md|Configuring VCS Roots/mercurial.md|Mercurial" data-main-title="Mercurial" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/mercurial.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Mercurial" id="mercurial.md">Mercurial</h1><p id="e1aa4b7c">TeamCity uses the typical Mercurial command line client: hg command. Mercurial 1.5.2+ is supported.</p><aside class="note " data-title="" rel="e1aa4b7c" id="e38466d4"><p id="a0f28c04">Mercurial is to be installed on the server machine and, if the <a href="vcs-checkout-mode.html#agent-checkout">agent-side checkout</a> is used, on the agents.</p></aside><p id="0c3a5b9c">Note that:</p><ul class="list _ul"><li class="list__item" id="8d5bc47a"><p><b id="c05b47b3">Remote Run</b> from IDE is not supported. Please use <a href="branch-remote-run-trigger.html">Branch Remote Run Trigger</a> instead.</p></li><li class="list__item" id="9c858834"><p>Checkout rules for agent-side checkout are not supported except for the <code class="code">.=&gt;&lt;target_dir&gt;</code> rule.For common VCS Root properties, see <a href="configuring-vcs-roots.html#Common-VCS-Root-Properties">this section</a>. The section below contains the description of Mercurial-specific fields and options.</p></li></ul><p id="ce5487e9">TeamCity supports Mercurial out of the box.</p><p id="951a3845">On this page:</p><p id="e7a81b70"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#Mercurial-GeneralSettings">General Settings</a><ul class="list _bullet"><li class="list__item"><a href="#Mercurial-Pathtohgexecutabledetection">Path to hg executable detection</a></li></ul></li><li class="list__item"><a href="#Mercurial-AgentSettings">Agent Settings</a></li><li class="list__item"><a href="#Mercurial-InternalProperties">Internal Properties</a></li></ul></p><a name="GeneralSettings"></a><a name="General-Settings"></a><div class="chapter"><h2 id="Mercurial-GeneralSettings">General Settings</h2><div class="table-wrapper"><table width="100%" id="f0da3ea3"><thead><tr id="80006d0c" class="ijRowHead"><th id="a231246b"><p id="c158912b">Option</p></th><th id="c3822c78"><p id="a35d6732">Description</p></th></tr></thead><tbody><tr id="0260564b" class="ijRowOdd"><td id="89c9f89b"><p id="b8898656">Pull changes from</p></td><td id="b031c14a"><p id="f05c45fe">The URL of your hosting.</p></td></tr><tr id="9293c7c2" class="ijRowEven"><td id="0b146ad8"><p id="4f2ee5b6">Default branch</p></td><td id="1aeb521e"><p id="611ddde9">Set to the default branch which used in the absence of branch specification or when the branch of the branch specification cannot be found. Note that parameter references are supported here.</p></td></tr><tr id="9151dc3b" class="ijRowOdd"><td id="f5bb53ca"><p id="71da018f">Branch specification</p></td><td id="5099f05b"><p id="a0ce7def">In this area list all the branches you want to be monitored for changes. The syntax is similar to checkout rules: <code class="code">+|-:branch_name</code>, where <code class="code">branch_name</code> is specific to the VCS (with the optional <code class="code">*</code> placeholder). Note that only one asterisk is allowed and each rule has to start with a new line.  Bookmarks can also be used in the branch and branch specification fields. If a bookmark has the same name as a regular branch, a regular branch wins. More in the related <a href="http://blog.jetbrains.com/teamcity/2013/04/mercurial-bookmarks/" data-external="true" target="_blank" rel="noopener noreferrer">TeamCity blogpost</a>.</p><aside class="note " data-title="" rel="a0ce7def" id="386bce59"><p id="a88a1023">Bookmarks support requires Mercurial 2.4 installed on the TeamCity server.</p></aside></td></tr><tr id="6300f9f9" class="ijRowEven"><td id="83b76bde"><p id="96273c4c">Use tags as branches</p></td><td id="dd5b188d"><p id="2e4447bc">Allows you to use tags in branch specification. By default, tags are ignored.</p></td><td id="108220bd"></td></tr><tr id="9f3a7c40" class="ijRowOdd"><td id="3bd339b6"><p id="2b54b3b7">Detect subrepo changes</p></td><td id="98a72093"><p id="4acec4df">By default, subrepositories are not monitored for changes.</p></td></tr><tr id="78a8c8bc" class="ijRowEven"><td id="ebbc5283"><p id="e2aeb66b">Username for tags/merge</p></td><td id="75baeae3"><p id="9cfe1a41">A custom username used for labeling</p></td></tr><tr id="57fa1c01" class="ijRowOdd"><td id="9e5e4134"><p id="626e6ad9">Use uncompressed transfer</p></td><td id="8c0badf8"><p id="1fd3fb0d">Uncompressed transfer is faster for repositories in the LAN.</p></td></tr><tr id="e8db4dc8" class="ijRowEven"><td id="4fa002a4"><p id="50faf7ec">HG command path</p></td><td id="addc6ec7"><p id="73e9505c">The path to the hg executable. Used on TeamCity server only if included into whitelist. See more <a href="#Path-to-hg-executable-detection">below</a>.</p></td></tr></tbody></table></div><a name="Pathtohgexecutabledetection"></a><a name="Path-to-hg-executable-detection"></a><div class="chapter"><h3 id="Mercurial-Pathtohgexecutabledetection">Path to hg executable detection</h3><p id="221b7f9a">When an agent starts, the hg-plugin detects Mercurial installed on the agent machine.</p><p id="8f84b7fd">The plugin tries to run the <code class="code">hg version</code> command using the path specified by the <code class="code">teamcity.hg.agent.path</code> parameter. You can change this parameter in &lt;<a href="agent-home-directory.html">Agent Home Directory</a>&gt;\conf\buildAgent.properties.</p><p id="60fb8484">If this parameter is not set, the plugin uses <code class="code">hg</code> as a path to the command, assuming it is somewhere in the $PATH. If the command is executed successfully and mercurial has an appropriate version (1.5.2+), then the hg-plugin reports the path to hg in the <code class="code">teamcity.hg.agent.path</code> parameter.</p><p id="0e340969">During the build, the plugin uses the hg specified in the <i id="486cd69e">HG command path</i> field of a VCS root settings. To use the detected hg, put <code class="code">%teamcity.hg.agent.path%</code> in this field. Configurations with such settings will be run only on agents which report the path to hg.</p><p id="5cdec330">The server side of the plugin checks the value of the <code class="code">teamcity.hg.customServerHgPathWhitelist</code> <a href="configuring-teamcity-server-startup-properties.html">internal property</a>. The property contains the <code class="code">;</code>-separated list of allowed hg paths to use on the server.  If the path specified in VCS root is in whitelist, then it is used on the server. If not, the path specified in the <code class="code">teamcity.hg.server.path</code> <a href="configuring-teamcity-server-startup-properties.html">internal property</a> is used. If this property is not set, TeamCity server uses <code class="code">hg</code> from the <code class="code">$PATH</code>.</p></div></div><a name="AgentSettings"></a><a name="Agent-Settings"></a><div class="chapter"><h2 id="Mercurial-AgentSettings">Agent Settings</h2><p id="ffaf8e93">These are the settings used in case of the agent-side checkout (<a href="vcs-checkout-mode.html#prefer-agent-checkout">default mode</a>), which requires Mercurial installed on all agents.</p><div class="table-wrapper"><table class="  _layout-fixed" width="100%" id="6f2e0cb8"><thead><tr id="d5653364" class="ijRowHead"><th id="bba9badc"><p id="45b1a32f">Option</p></th><th id="75f68384"><p id="fbbe981b">Description</p></th></tr></thead><tbody><tr id="6cadbeb4" class="ijRowOdd"><td id="aba3271a"><p id="6a7f1acb">Mercurial config</p></td><td id="faca8047"><p id="b06e6099">Specify the Mercurial configuration options to be applied to the repository during agent-side checkout, for example, enter the following to enable the <code class="code">largefiles</code> extension:</p><div class="code-block" data-lang="none">[extensions] 
`largefiles =

</div><p id="fc3f967c">The configuration format is described <a href="http://www.selenic.com/mercurial/hgrc.5.html" data-external="true" target="_blank" rel="noopener noreferrer">here</a>.</p><p id="d3038c6f">Before 2017.2.2 this option was also used on TeamCity server. This was disabled for security reasons.</p></td></tr><tr id="498dcd81" class="ijRowEven"><td id="0ccc7555"><p id="ccd59da4">Purge settings</p></td><td id="39244906"><p id="845dd087">Defines whether to <a href="https://www.mercurial-scm.org/wiki/PurgeExtension" data-external="true" target="_blank" rel="noopener noreferrer">purge files</a> and directories not being tracked by Mercurial in the current repository. You can choose to remove only unknown files and empty directories, or to remove ignored files as well. Added files and (unmodified or modified) tracked files are preserved.</p></td></tr><tr id="e649852a" class="ijRowOdd"><td id="35139943"><p id="3fe5f563">Use mirrors</p></td><td id="30b5ce0c"><p id="95e10a83">When enabled, TeamCity creates a local agent mirror first (under agent's <code class="code">system/mercurial</code> directory) and then clones to the working directory from this local mirror. This option speeds up clean checkout, because only the build working directory is cleaned. Also, if a single root is used in several build configurations, a clone will be faster.</p></td></tr></tbody></table></div></div><a name="InternalProperties"></a><a name="Internal-Properties"></a><div class="chapter"><h2 id="Mercurial-InternalProperties">Internal Properties</h2><p id="4c2ef5a3">This section describes hg-related <a href="configuring-teamcity-server-startup-properties.html">internal properties</a>. You can modify the defaults to adjust the Mercurial settings as needed.</p><p id="1ff2951f">Server-side <a href="configuring-teamcity-server-startup-properties.html">internal properties</a>:</p><div class="table-wrapper"><table class=" wide" width="100%" id="94626e5d"><thead><tr id="e229413a" class="ijRowHead"><th id="5b869182"><p id="7e5bcc9b">Property</p></th><th id="a281f3d3"><p id="02ae5714">Default</p></th><th id="18848674"><p id="408b65f8">Description</p></th></tr></thead><tbody><tr id="7aa03946" class="ijRowOdd"><td id="a75805b3"><p id="a8ddf618"><code class="code">teamcity.hg.pull.timeout.seconds</code></p></td><td id="e1977d29"><p id="df22b011">3600</p></td><td id="a31831f0"><p id="443899d9">Maximum time in seconds for pull operation to run</p></td></tr><tr id="a9dd2203" class="ijRowEven"><td id="714aaeb5"><p id="2565c915"><code class="code">teamcity.hg.server.path</code></p></td><td id="d9fc64ee"><p id="3f66f608">hg</p></td><td id="7e08a327"><p id="0165c4ce">Path to the hg executable on the server (see <a href="#Path-to-hg-executable-detection">Path to hg executable detection</a> for the details).</p></td></tr><tr id="02c0e2c7" class="ijRowOdd"><td id="8bf8d584"><p id="2c64fb5c"><code class="code">teamcity.hg.customServerHgPathWhitelist</code></p></td><td id="120a6d0c"></td><td id="9624fe88"><p id="c81a8c72"><code class="code">;</code>-separated list of allowed paths to hg executable to use on TeamCity server machine</p></td></tr></tbody></table></div><p id="5e50eee1"><a href="build-agent-configuration.html">Agent configuration</a> for Mercurial:</p><div class="table-wrapper"><table class=" wide" width="100%" id="4872c87b"><thead><tr id="9eec76d4" class="ijRowHead"><th id="fe5fe53f"><p id="46145892">Property</p></th><th id="42b52aa9"><p id="93a90e8c">Default</p></th><th id="40573f65"><p id="6c33a29b">Description</p></th><th id="9d3eb3b0"></th></tr></thead><tbody><tr id="b1975c59" class="ijRowOdd"><td id="05feb8f4"><p id="e05b875e"><code class="code">teamcity.hg.pull.timeout.seconds</code></p></td><td id="ca9e406e"><p id="d4110370">3600</p></td><td id="0dba3a3d"><p id="ac8d3be6">Maximum time in seconds for pull operation to run</p></td></tr><tr id="9b71de2f" class="ijRowEven"><td id="19f24b91"><p id="ad0a85ae"><code class="code">teamcity.hg.agent.path</code></p></td><td id="d06e89b6"><p id="9f20f353">hg</p></td><td id="0e01e22a"><p id="8020097a">Path to hg executable on the agent (see <a href="#Path-to-hg-executable-detection">Path to hg executable detection</a> for the details).</p></td></tr></tbody></table></div><hr id="33673e5b"><p id="269f6ee3"><b id="ddb33740">See also:</b></p><p id="d781d808"><b id="1e4c506e">Administrator's Guide</b>: <a href="branch-remote-run-trigger.html">Branch Remote Run Trigger</a></p><hr id="56147351"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>