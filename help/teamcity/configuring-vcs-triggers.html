<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Configuring VCS Triggers - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Configuring VCS Triggers" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-build-triggers.md|Configuring Build Triggers/configuring-vcs-triggers.md|Configuring VCS Triggers" data-main-title="Configuring VCS Triggers" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/configuring-vcs-triggers.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Configuring VCS Triggers" id="configuring-vcs-triggers.md">Configuring VCS Triggers</h1><p id="202241bd">VCS triggers automatically start a new build each time TeamCity detects new changes in the configured <a href="vcs-root.html">VCS roots</a> and displays the change in the pending changes. Only one VCS trigger can be added to a build configuration.</p><p id="27422449">A new VCS trigger with the default settings triggers a build once there are pending changes in the build configuration: the version control is polled for changes according to the <a href="configuring-vcs-roots.html#Common-VCS-Root-Properties">checking for changes interval</a> of a VCS root honoring a <a href="configuring-vcs-post-commit-hooks-for-teamcity.html">VCS commit hook</a> if configured. Only the changes matched by the <a href="vcs-checkout-rules.html">checkout rules</a> are displayed as pending and thus are processed by the trigger. If several check-ins are made within short time frame and discovered by TeamCity together, only <b id="0f86493b">one build will be triggered</b>.</p><p id="e325c9c0">After the last change is detected, a <a href="#Quiet-Period-Settings">quiet period</a> can be configured to wait for some time without changes before the build is queued.</p><p id="14e57902">The global default value for both options is 60 seconds and can be configured for the server on the <b id="e2d69f28">Administration | Global Settings</b> page.</p><p id="84e0b2a8">You can adjust a VCS trigger to your needs using the options described below:</p><p id="8a988d68"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#ConfiguringVCSTriggers-Triggerabuildonchangesinsnapshotdependencies">Trigger a build on changes in snapshot dependencies</a></li><li class="list__item"><a href="#ConfiguringVCSTriggers-Per-check-inTriggering">Per-check-in Triggering</a><ul class="list _bullet"><li class="list__item"><a href="#ConfiguringVCSTriggers-QuietPeriodSettings">Quiet Period Settings</a></li><li class="list__item"><a href="#ConfiguringVCSTriggers-BuildQueueOptimizationSettings">Build Queue Optimization Settings</a></li></ul></li><li class="list__item"><a href="#ConfiguringVCSTriggers-VCSTriggerRules">VCS Trigger Rules</a><ul class="list _bullet"><li class="list__item"><a href="#ConfiguringVCSTriggers-GeneralSyntax">General Syntax</a><ul class="list _bullet"><li class="list__item"><a href="#ConfiguringVCSTriggers-TriggerRulesExamples">Trigger Rules Examples</a></li></ul></li><li class="list__item"><a href="#ConfiguringVCSTriggers-BranchFilter">Branch Filter</a></li><li class="list__item"><a href="#ConfiguringVCSTriggers-TriggerRulesandBranchFilterCombined">Trigger Rules and Branch Filter Combined</a></li><li class="list__item"><a href="#ConfiguringVCSTriggers-TriggeringaBuildonBranchMerge">Triggering a Build on Branch Merge</a></li></ul></li></ul></p><a name="Triggerabuildonchangesinsnapshotdependencies"></a><a name="Trigger-a-build-on-changes-in-snapshot-dependencies"></a><div class="chapter"><h2 id="ConfiguringVCSTriggers-Triggerabuildonchangesinsnapshotdependencies">Trigger a build on changes in snapshot dependencies</h2><p id="3ee48f37">If you have a <a href="build-chain.html">build chain</a> (i.e. a number of builds interconnected by <a href="dependent-build.html#Snapshot-Dependency">snapshot dependencies</a>),  the triggers are to be configured in the final build in the chain. This is <i id="eb4f5f47">pack setup</i> in the image below.</p><a name="trigger-on-ssdep-chngs"></a><p id="ed8f216b">The VCS build trigger has another <a href="#Trigger-a-build-on-changes-in-snapshot-dependencies">option</a> that alters triggering behavior for a build chain. With this options enabled, the whole build chain will be triggered even if changes are detected in dependencies, not in the final build.</p><p id="030364b2">Let's take a build chain from the example: <code class="code">pack setup</code> – depends on – <code class="code">tests</code> – depends on – <code class="code">compile</code>.</p><p id="a9186f07"><figure><img alt="compile test pack" title="compile test pack" src="/help/img/teamcity/2019.1/compile-test-pack.png" id="8428d778" width="300" height="161"></figure></p><p id="dbd73bd2">With the VCS Trigger set up in the <code class="code">pack setup</code> configuration,  the whole build chain is usually triggered when TeamCity detects changes in <code class="code">pack setup</code>; changes in <code class="code">compile</code> will trigger <code class="code">compile</code> only and not the whole chain. If you want the whole chain to be triggered on a VCS change in <code class="code">compile</code>, add a VCS trigger with the "<i origin="teamcity-help" id="c892b5aa">Trigger on changes in snapshot dependencies</i>" <a href="#Trigger-a-build-on-changes-in-snapshot-dependencies">option</a> enabled to the final build configuration of the chain, <code class="code">pack setup</code>. This will not change the order in which builds are executed, but will only trigger the whole build chain, if there is a change in any of snapshot dependencies. In this setup, no VCS triggers are required for the <code class="code">compile</code> or <code class="code">tests</code> build configuration.</p><p id="23d51e4e">If triggering rules are specified (described <a href="#VCS-Trigger-Rules">below</a>), they are applied to all the changes (including changes from snapshot dependencies) and only the changes matching the rules trigger the build chain.</p><p id="390be20c">See also details at the <a href="build-dependencies-setup.html">Build Dependencies</a> page.</p></div><a name="Per-check-inTriggering"></a><a name="Per-check-in-Triggering"></a><div class="chapter"><h2 id="ConfiguringVCSTriggers-Per-check-inTriggering">Per-check-in Triggering</h2><p id="c676ca33">When this option is <b id="4b313ac2">not</b> enabled, several check-ins by different committers can be made; and once they are detected, TeamCity will add only one build to the queue with all of these changes.</p><p id="64bbe4a9">If you have fast builds and enough build agents, you can make TeamCity launch a new build <b id="c893b197">for each check-in</b> ensuring that no other changes get into the same build.<br>To do that, select the <b id="e1786db5">Trigger a build on each check-in</b> option. If you select the <b id="7720fb6d">Include several check-ins in build if they are from the same committer</b> option, and TeamCity will detect a number of pending changes, it will group them by user and start builds having single user changes only.</p><p id="38ad63cb">This helps to figure out whose change broke a build or caused a new test failure, should such issue arise.</p><p id="3b1c517e"><a name="quietPeriod"></a><a name="ConfiguringVCSTriggers-quietPeriod"></a></p><a name="QuietPeriodSettings"></a><a name="Quiet-Period-Settings"></a><div class="chapter"><h3 id="ConfiguringVCSTriggers-QuietPeriodSettings">Quiet Period Settings</h3><p id="5893348d">By specifying the quiet period you can ensure the build is not triggered in the middle of non-atomic check-ins consisting of several VCS check-ins.</p><p id="32b2f5e4">A <b id="47321b72">quiet period</b> is a period (in seconds) that TeamCity maintains between the moment the last VCS change is detected and a build is added into the queue. If new VCS change is detected in the Build Configuration within the period, the period starts over from the new change detection time. The build is added into the queue only if there were no new VCS changes detected within the quiet period.</p><p id="14b1ebf0">Note that the actual quiet period will not be less than the maximum <a href="configuring-vcs-roots.html#Common-VCS-Root-Properties">checking for changes interval</a> among the VCS roots of a build configuration, as TeamCity must ensure that changes were collected at least once during the quiet period.</p><p id="a816a4d7">The quiet period can be set to the default value (60 seconds, can be changed globally at the <b id="9d65e907">Administration</b> | <b id="693cde14">Global Settings</b> page) or to a custom value for a build configuration.</p><aside class="note " data-title="" rel="a816a4d7" id="a41b65e3"><p id="7257e8c6">Note that when a build is triggered by a trigger with the VCS quiet period set, the build is put into the queue with fixed VCS revisions. This ensures the build will be started with only the specific changes included. Under certain circumstances this build can later become a <a href="history-build.html">History Build</a>.</p></aside><a name="queue-optimization"></a></div><a name="BuildQueueOptimizationSettings"></a><a name="Build-Queue-Optimization-Settings"></a><div class="chapter"><h3 id="ConfiguringVCSTriggers-BuildQueueOptimizationSettings">Build Queue Optimization Settings</h3><p id="0eebe660">By default, TeamCity <a href="build-queue.html#Build-Queue-Optimization-by-TeamCity">optimizes the build queue</a>: already queued build can be replaced with an already started build or a more recent queued build. You can disable this default behavior by unchecking the corresponding box.</p><p id="dcb41878"><a name="buildTriggerRules"></a><a name="ConfiguringVCSTriggers-buildTriggerRules"></a></p></div></div><a name="VCSTriggerRules"></a><a name="VCS-Trigger-Rules"></a><div class="chapter"><h2 id="ConfiguringVCSTriggers-VCSTriggerRules">VCS Trigger Rules</h2><a name="vcs-trigger-rules"></a><p id="7a054657">If no trigger rules are specified, a build is triggered upon any change detected for the build configuration. You can control what changes are detected by changing the VCS root settings and specifying <a href="vcs-checkout-rules.html">Checkout Rules</a>.</p><p id="bedd7d2c">To limit the changes that trigger the build, use the VCS trigger rules. You can add these rules manually in the text area (one per line), or use the <b id="ac98377d">Add new rule</b> option to generate them.</p><p id="84f63c26"><figure><img alt="Adding trigger rule" title="Adding trigger rule" src="/help/img/teamcity/2019.1/addRule.png" id="3dd5ded0" width="450" height="610"></figure></p><p id="9456a3a4">Each rule is ether an "include" (starts with "<code class="code">+</code>") or an "exclude" (starts with "<code class="code">-</code>").</p><a name="GeneralSyntax"></a><a name="General-Syntax"></a><div class="chapter"><h3 id="ConfiguringVCSTriggers-GeneralSyntax">General Syntax</h3><a name="general-syntax"></a><p id="430aa31f">The general syntax for a single rule is:</p><div class="code-block" data-lang="bash">
+|-[:[user=VCS_username;][root=VCS_root_id;][comment=VCS_comment_regexp]]:Ant_like_wildcard

</div><a name="OR-syntax-tip"></a><aside class="tip sideblock" data-title="" rel="ConfiguringVCSTriggers-GeneralSyntax" id="a7124550"><p id="25beb1bb">Here, the <i origin="teamcity-help" id="ee451e9e">pipe</i> symbol <code class="code">|</code> represents the <b origin="teamcity-help" id="14e8d8fc">OR</b> command, as in regular expressions: use <code class="code">+</code> for including, <b origin="teamcity-help" id="a61e888f">OR</b> <code class="code">-</code> for excluding.</p></aside><p id="7d1397b2">where:</p><ul class="list _ul"><li class="list__item" id="3f6cb96f"><p><b id="ed1d66a4">Ant_like_wildcard</b>: A <a href="wildcards.html">wildcard</a> to match the changed file path. Only <code class="code">*</code> and <code class="code">**</code> patterns are supported, the <code class="code">?</code> pattern is <b id="0a021620">not</b> supported. The file paths in the rule can be relative (not started with <code class="code">/</code> or <code class="code">\</code>) to match resulting paths on the agent or absolute (started with <code class="code">/</code>) to match VCS paths relative to a VCS root. For each file in a change the most specific rule is found (the rule matching the longest file path). The build is triggered if there is at least one file with a matching "include" rule or a file with no matching "exclude" rules.</p></li><li class="list__item" id="0e939e7c"><p><b id="0c94d117"><a href="managing-users-and-user-groups.html">VCS_username</a></b>: if specified, limits the rule only to the changes made by a user with the corresponding <a href="managing-users-and-user-groups.html#VCS-Usernames">VCS username </a>.</p></li><li class="list__item" id="2e2717be"><p><b id="aafd6965">VCS_root_id</b>: if specified, limits the rule only to the changes from the corresponding VCS root.</p></li><li class="list__item" id="62696433"><p><b id="8f722cf9">VCS_comment_regexp</b>: if specified, limits the rule only to the changes that contain specified text in the VCS comment. Use the <a href="http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#sum" data-external="true" target="_blank" rel="noopener noreferrer">Java Regular Expression</a> pattern for matching the text in a comment (see examples below). The rule matches if the comment text contains a matched text portion; to match the entire text, include the <code class="code">^</code> and <code class="code">$</code> special characters.</p></li></ul><aside class="tip sideblock" data-title="" rel="eaa68593" id="41b6b067"><p id="c8b3e3e6">When specifying the rules, note that as soon as you enter any <code class="code">+</code> rule, TeamCity will change the implicit default from "include all" to "exclude all".<br>To include all the files, use <code class="code">+:.</code> rule.</p><p id="c584f014">Also, rules are sorted according to path specificity. If you have an explicit inclusion rule for <code class="code">/some/path</code>, and exclusion rule <code class="code">-:user=some_user:.</code> for all paths, commits to the <code class="code">/some/path</code> from <code class="code">some_user</code> will be <b id="0781f06d">included</b> unless you add a specific exclusion rule for this user and this path at once, like <code class="code">-:user=some_user:/some/path/**</code></p></aside><a name="TriggerRulesExamples"></a><a name="Trigger-Rules-Examples"></a><div class="chapter"><h4 id="ConfiguringVCSTriggers-TriggerRulesExamples">Trigger Rules Examples</h4><a name="trigger-rules-examples"></a><div class="table-wrapper"><table width="100%" id="a4d1ad69"><thead><tr id="dd178121" class="ijRowHead"><th width="200" id="0c4a3d0a"><p id="074817d1">Example</p></th><th id="96d82f19"><p id="c0544ac4">Description</p></th></tr></thead><tbody><tr id="da3a104f" class="ijRowOdd"><td id="f4e8f676"><p id="10416ac7"><code class="code">+:.</code></p></td><td id="84501068"><p id="dae55d8d">Includes all files</p></td></tr><tr id="6a68abe2" class="ijRowEven"><td id="df32f210"><p id="6d1bfcb8"><code class="code">-:**.html</code></p></td><td id="dded774d"><p id="6e5e5735">Excludes all <code class="code">.html</code> files from triggering a build.</p></td></tr><tr id="165265b2" class="ijRowOdd"><td id="f8811655"><p id="a3e671f5"><code class="code">-:user=techwriter;root=InternalSVN:/misc/doc/*.xml</code></p></td><td id="54efc7bb"><p id="0c6066e0">Excludes builds being triggered by <code class="code">.xml</code> files checked in by the <a href="managing-users-and-user-groups.html#VCS-Usernames">VCS user</a> "techwriter" to the <code class="code">misc/doc</code> directory of the VCS root named <i id="c0b64163">Internal SVN</i> (as defined in the VCS Settings). Note that the path is absolute (starts with "/"), thus the file path is matched from the VCS root.</p></td></tr><tr id="5feb6bfc" class="ijRowEven"><td id="113819a3"><p id="73bec0d7"><code class="code">-:lib/**</code></p></td><td id="0b59a574"><p id="4696acc5">Prevents the build from triggering by updates to the <code class="code">lib</code> directory of the build sources (as it appears on the agent). Note that the path is relative, so all files placed into the directory (by processing VCS root <a href="vcs-checkout-rules.html">checkout rules</a>) will not cause the build to be triggered.</p></td></tr><tr id="1d5b070f" class="ijRowOdd"><td id="3012a634"><p id="79ad46ff"><code class="code">-:comment=minor:**</code></p></td><td id="7d13aae4"><p id="18cc3835">Prevents the build from triggering, if the changes check contains the word "minor" in the comment.</p></td></tr><tr id="5b49dcf0" class="ijRowEven"><td id="a536adf7"><p id="6999a3ca"><code class="code">-:comment=^oops$:**</code></p></td><td id="1d428abf"><p id="ab839e43">No triggering if the comment consists of the word "oops" only (according to <a href="http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#sum" data-external="true" target="_blank" rel="noopener noreferrer">Java Regular Expression</a> principles <code class="code">^</code> and <code class="code">$</code> in pattern stand for string beginning and ending).</p></td></tr></tbody></table></div></div></div><a name="BranchFilter"></a><a name="Branch-Filter"></a><div class="chapter"><h3 id="ConfiguringVCSTriggers-BranchFilter">Branch Filter</h3><p id="9009d108">Read more in <a href="branch-filter.html">Branch Filter</a>.</p></div><a name="TriggerRulesandBranchFilterCombined"></a><a name="Trigger-Rules-and-Branch-Filter-Combined"></a><div class="chapter"><h3 id="ConfiguringVCSTriggers-TriggerRulesandBranchFilterCombined">Trigger Rules and Branch Filter Combined</h3><p id="dfd745f5">Trigger rules and branch filter are combined by <b id="97aa36bf">AND</b>, which means that the build is triggered <b id="e9076c0e">only when both conditions are satisfied</b>.</p><p id="e9fef7ee">For example, if you specify a comment text in the trigger rules field and provide the branch specification, the build will be triggered only if a commit has the special text and is also in a branch matched by branch filter.</p></div><a name="TriggeringaBuildonBranchMerge"></a><a name="Triggering-a-Build-on-Branch-Merge"></a><div class="chapter"><h3 id="ConfiguringVCSTriggers-TriggeringaBuildonBranchMerge">Triggering a Build on Branch Merge</h3><p id="56f2b670">The VCS trigger is fully aware of branches and will trigger a build once a check-in is detected in a branch.</p><p id="b46db370">When changes are merged / fast-forwarded from one branch to another, strictly speaking there are no actual changes in the code. By default, the VCS trigger behaves in the following way:</p><ul class="list _ul"><li class="list__item" id="830f853f"><p>When merging/fast forwarding of two non-default branches: the changes in a build are calculated with regard to previous builds in the same branch, so if there is a build on same commit in a different branch, the trigger will start a build in another branch pointing to the same commit.</p></li><li class="list__item" id="fe636057"><p>If the default branch is one of the branches in the merging/fast-forwarding, the changes are always calculated against the default branch, if there is a build on same revision in the default branch, TeamCity will not run a new build on the same revision.</p></li></ul><hr id="78b9d62d"></div></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>