<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>建立链-帮助|团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Build Chain" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/concepts.md|Concepts/build-chain.md|Build Chain" data-main-title="Build Chain" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/build-chain.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="build-chain.md" data-toc="Build Chain">建立链</h1><p id="d3b7bea5">在此页：</p><p id="f0929a49"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#BuildChain-CommonUseCase">常见用例</a></li><li class="list__item"><a href="#BuildChain-ConfiguringBuildChains">配置构建链</a></li><li class="list__item"><a href="#BuildChain-Stopping/RemovingFromQueueBuildsfromBuildChain">从构建链中停止/从队列构建中删除</a></li><li class="list__item"><a href="#BuildChain-DisablingRevisionsSynchronizationBetweenChainParts">禁用链零件之间的修订同步</a></li><li class="list__item"><a href="#BuildChain-BuildChainsVisualRepresentation">构建链视觉表示</a><ul class="list _bullet"><li class="list__item"><a href="#BuildChain-Dependenciespageofbuildconfigurationsettings">构建配置设置的依赖项页面</a></li><li class="list__item"><a href="#BuildChain-BuildChainstabofProjectHomeandBuildConfigurationHomepages">项目主页和构建配置主页的“构建链”选项卡</a></li><li class="list__item"><a href="#BuildChain-Dependenciestabofbuildresultspage">构建结果页面的“依赖项”选项卡</a></li></ul></li></ul><p></p><p id="d0d75ede"><i id="7e5d6125">构建链</i>是由<a href="dependent-build.html#Snapshot-Dependency">快照依赖项</a>相互连接的一系列构建。有时，构建链称为“管道”。与启用了修订同步的快照相关性链接的构建链的各个部分使用源的相同快照。</p><a name="CommonUseCase"></a><a name="Common-Use-Case"></a><div class="chapter"><h2 id="BuildChain-CommonUseCase">常见用例</h2><p id="6ef91bdb">指定构建链的最常见用例是在不同平台上运行项目的相同测试套件。例如，在<i id="3aaf7bcd">构建发行版</i>之前，您要确保测试可以在不同的平台和环境下正确运行。为此，您可以指示TeamCity运行测试，然后先运行集成版本，然后再发布版本。</p><p id="a0f54e37">让我们详细了解构建链机制的工作原理。触发<i id="875a0436">发行</i>版本配置的依赖版本时，TeamCity执行以下操作：</p><ol class="list _decimal"><li class="list__item" id="48464ea4"><p>解决<i id="43063de7">发布</i>构建配置快照所依赖的所有构建配置链。</p></li><li class="list__item" id="f67c4cf6"><p>检查所有相关构建配置的更改，并在构建链中的第一个构建进入构建队列时将其同步。</p></li><li class="list__item" id="93b869e6"><p>将需要进行特定修订的所有构建版本添加到构建队列中。</p></li></ol></div><a name="ConfiguringBuildChains"></a><a name="Configuring-Build-Chains"></a><div class="chapter"><h2 id="BuildChain-ConfiguringBuildChains">配置构建链</h2><p id="012f0017"><b id="9f2063c2">要在构建配置中指定依赖项</b> ：</p><ol class="list _decimal"><li class="list__item" id="ad29cf09"><p>在<b id="c4354433">Build Configuration Settings</b>页面上，选择<b id="c0cc9618">Dependencies</b> 。</p></li><li class="list__item" id="b3406451"><p>在“ <b id="c829ec1b">依赖关系”</b>页面上，单击“ <b id="39eeea65">添加新快照依赖关系”</b>链接。</p></li></ol><p id="8bea7b44">有关详细信息和示例，另请参阅<a href="build-dependencies-setup.html">Build Dependencies Setup</a> 。</p></div><a name="Stopping/RemovingFromQueueBuildsfromBuildChain"></a><a name="Stopping/Removing-From-Queue-Builds-from-Build-Chain"></a><div class="chapter"><h2 id="BuildChain-Stopping/RemovingFromQueueBuildsfromBuildChain">从构建链中停止/从队列构建中删除</h2><p id="7c2ed37d">如果正在停止或从构建队列中删除的构建是构建链的一部分，则注释字段下方将显示一条消息：“ <i id="1b7a2742">此构建是构建链的一部分</i> ”。</p><p id="db40cf2c">如果构建链中还有其他正在运行或排队的部分（例如，其他正在运行的构建或排队的构建，它们与该操作下的构建相关联），则这些构建将在下面的“ <i id="ede63675">停止其他部分</i> ”标签下列出。</p><p id="747c0045">如果用户具有停止列表中构建的访问权限，则该复选框旁边会出现一个复选框。如果停止当前构建肯定会导致列表中的构建失败（例如，如果列出的构建取决于停止的原始构建），则默认情况下会选中此复选框。</p><p id="ece11e18">如果用户无权从列表中停止构建，则该复选框不可见。</p><p id="97a11aba">选中该复选框会将所选构建标记为从队列中停止/删除。</p><p id="9ea362cc">如果用户无权查看作为构建链一部分的构建，则该构建对用户完全不可见。如果至少有一个这样的内部版本，则会显示警告：“ <i id="9b1216e7">您无权访问其所有部分</i> ”。条带显示在消息“ <i id="a582d9f0">此构建是构建链的一部分</i> ”的正下方。</p><p id="9db9d92f">如果当前用户无法查看构建链的所有其他部分，我们将显示带有警告的黄色条纹：“ <i id="f9021d84">您无权查看其其他部分</i> ”。</p><p id="7e394421">如果构建链没有正在运行或排队的构建（即构建链的所有其他部分都已完成），则不会显示其他信息。</p></div><a name="DisablingRevisionsSynchronizationBetweenChainParts"></a><a name="Disabling-Revisions-Synchronization-Between-Chain-Parts"></a><div class="chapter"><h2 id="BuildChain-DisablingRevisionsSynchronizationBetweenChainParts">禁用链零件之间的修订同步</h2><p id="4d48722c"><b id="3c041dda">从TeamCity 2019.1开始</b> ，您可以在<b id="3c041dda">升级</b>构建时针对构建配置的快照依赖项<a href="snapshot-dependencies.html#enforce-rev-sync">禁用修订同步</a> 。<br>如果将构建从链第1部分升级到链第2部分，并且第2部分的第一个构建配置禁用了此选项，则此选项有效。在这种情况下，TeamCity可以在第1部分和第2部分中使用不同的源版本进行构建。请参阅<a href="build-dependencies-setup.html#Turned-off-Enforced-Revisions-Synchronization">Build Dependencies Setup中</a>的构建设置示例。</p><p id="f734c5f5">当您需要运行依赖的构建而不将其代码修订版与其依赖（在链中的先前构建）同步时，这很有用。<br>例如，您可以将较旧的构建升级为<a href="deployment-build-configuration.html">部署构建配置</a> ，然后将使用最新的部署脚本来运行此构建。在负载/接受测试中，当您将测试存储在版本控制系统中并经常更改它们以测试系统时，无需完全重建应用程序；相反，您可以从测试阶段直接获取链。</p></div><a name="BuildChainsVisualRepresentation"></a><a name="Build-Chains-Visual-Representation"></a><div class="chapter"><h2 id="BuildChain-BuildChainsVisualRepresentation">构建链视觉表示</h2><p id="71ed7f8a">基本上，每个构建链都是有<a href="http://en.wikipedia.org/wiki/Directed_acyclic_graph" rel="noopener noreferrer" data-external="true" target="_blank">向无环图</a> ，即它不能具有循环。</p><p id="acc4eab5">构建链在TeamCity Web UI的不同位置可见：</p><ul class="list _ul"><li class="list__item" id="1cd92898"><a href="#Dependencies-page-of-build-configuration-settings">构建配置设置的依赖项页面</a></li><li class="list__item" id="891d888e"><a href="#Build-Chains-tab-of-Project-Home-and-Build-Configuration-Home-pages">项目主页和构建配置主页的“构建链”选项卡</a></li></ul><a name="Dependenciespageofbuildconfigurationsettings"></a><a name="Dependencies-page-of-build-configuration-settings"></a><div class="chapter"><h3 id="BuildChain-Dependenciespageofbuildconfigurationsettings">构建配置设置的依赖项页面</h3><p id="c07eb85a">如果构建配置是构建链的一部分，则相应的信息将显示在“ <b id="9d82e8e9">构建配置” |“设置”中。依存关系|快照依赖项</b> 。单击构建链链接可在单独的窗口中打开构建链及其配置的预览。预览显示了链的构建。配置了自动触发的版本会用以下图标标记： <img alt="v.png" title="v.png" src="/help/img/teamcity/2019.1/v.png" id="df9426d5" width="17" height="18" class="inline-icon-17"> 。</p><p id="9fd17dd2"></p><figure><img alt="快照依赖项预览" title="快照依赖项预览" src="/help/img/teamcity/2019.1/snapshotDepPreview.png" id="0622cafe" width="1550" height="613"></figure><p></p><aside class="note " rel="9fd17dd2" id="7c9be94e" data-title=""><p id="e93c4e31">如果链中的构建配置使用功能分支，则分支的<a href="working-with-feature-branches.html#Logical-branch-name">逻辑名称</a>也将在链图上表示为构建标签。请注意，这些名称<a href="working-with-feature-branches.html#Dependencies">可能与</a>实际用于构建的VCS根目录<a href="working-with-feature-branches.html#Dependencies">有所不同</a> ：如果某个构建使用默认分支但依赖于一个使用非默认分支的构建，则依赖项构建的标签将反映这一点。例如，如果版本A使用默认分支“ master”，但依赖于版本B使用分支“ v1.1”，则两个版本都将标记为“ v1.1”。</p></aside></div><a name="BuildChainstabofProjectHomeandBuildConfigurationHomepages"></a><a name="Build-Chains-tab-of-Project-Home-and-Build-Configuration-Home-pages"></a><div class="chapter"><h3 id="BuildChain-BuildChainstabofProjectHomeandBuildConfigurationHomepages">项目主页和构建配置主页的“构建链”选项卡</h3><p id="bc8aa0fe">您可以在项目和构建配置页面上查看构建链：配置快照依赖项时，每个页面都有一个“ <b id="2af77392">构建链”</b>选项卡。</p><p id="a1590b56">该选项卡显示包含该项目或此构建配置的构建链的列表，并具有过滤功能。请注意，对构建链进行了排序，以便最后完成构建的构建链显示在列表的顶部。</p><p id="9d3e46b7">饼图图标显示作为链的一部分的构建的状态比例。将鼠标悬停在饼图上时，将显示详细信息：</p><p id="838fb8ee"></p><figure><img alt="崩溃的构建链" title="崩溃的构建链" src="/help/img/teamcity/2019.1/buildChainsCollapsed.png" id="97195cc3" width="1573" height="509"></figure><p></p><p id="aeee5550">扩展链时，还将提供以下信息：</p><ul class="list _ul"><li class="list__item" id="69fc20eb"><p>此构建链的所有构建均包括</p></li><li class="list__item" id="72244929"><p>这些构建的状态：未触发，处于队列中，正在运行或已完成及其详细信息</p></li><li class="list__item" id="692b3f6f"><p>链按实际执行的顺序显示构建，即，最先开始的构建在左侧。</p></li></ul><p id="80fb5605">单击链中的内部版本会突出显示所选内部版本及其所有直接依赖项。这一页：</p><ul class="list _ul"><li class="list__item" id="080b3c71"><p>提供链的紧凑表示：如果多个顶级构建触发了相同的从属构建链，TeamCity将显示一个包含多个顶级构建的构建链。</p></li><li class="list__item" id="e0877a84"><p>还有其他显示选项：“按项目分组”和“隐藏详细信息”。</p></li><li class="list__item" id="121866ad"><p>在构建链中选择某个构建时，可传递地突出显示所有下游/上游构建。</p></li></ul><p id="e38577c5">在此页面上，您还可以：</p><ul class="list _ul"><li class="list__item" id="919e20e5"><p>如果还有“未触发”的构建，则继续执行链。单击“ <b id="31271b94">运行”</b>按钮，将在链修订版上开始一个新构建，并与该链中的构建关联。</p></li><li class="list__item" id="1a73cea4"><p>请点击<img alt="custom_build（1）.png" title="custom_build（1）.png" src="/help/img/teamcity/2019.1/custom_build_1.png" id="07485c9a" width="14" height="14" class="inline-icon-14">打开带有预选构建链修订的<a href="triggering-a-custom-build.html">自定义构建对话框</a> 。如果您要在链中重新运行某些构建，则可以使用此操作。</p></li></ul></div><a name="Dependenciestabofbuildresultspage"></a><a name="Dependencies-tab-of-build-results-page"></a><div class="chapter"><h3 id="BuildChain-Dependenciestabofbuildresultspage">构建结果页面的“依赖项”选项卡</h3><p id="c8e95c9f">如果配置了依赖关系，则可以在构建结果页面的“ <b id="bc39d32d">依赖关系”</b>选项卡上查看其详细信息。此选项卡还显示间接依赖关系，例如，如果构建A依赖于构建B，而构建B依赖于构建C和D，则这些构建C和D是构建A的间接依赖关系。<br>该选项卡还显示链构建下载并交付的工件。它还允许对构建进行分组/取消分组，并突出显示从以前的链（ <a href="snapshot-dependencies.html#Suitable-Builds">合适的构建</a> ）重复使用的<a href="snapshot-dependencies.html#Suitable-Builds">构建</a> 。</p><hr id="0636a6f8"><p id="43e32467"><b id="4a3fa826">也可以看看：</b></p><p id="b98b5991"><b id="d07ba6e5">概念</b> ： <a href="dependent-build.html">依赖构建</a><br><b id="a30b8d58">管理员指南</b> ： <a href="configuring-dependencies.html">配置依赖项</a> | <a href="build-dependencies-setup.html">构建依赖项设置</a></p><hr id="a9d2d95d"></div></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>