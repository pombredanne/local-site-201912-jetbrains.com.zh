<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Build Script Interaction with TeamCity - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Build Script Interaction with TeamCity" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/extending-teamcity.md|Extending TeamCity/build-script-interaction-with-teamcity.md|Build Script Interaction with TeamCity" data-main-title="Build Script Interaction with TeamCity" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/build-script-interaction-with-teamcity.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Build Script Interaction with TeamCity" id="build-script-interaction-with-teamcity.md">Build Script Interaction with TeamCity</h1><p id="a091b556">On this page:</p><p id="adec2a4d"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ServiceMessages">Service Messages</a><ul class="list _bullet"><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Servicemessagesformats">Service messages formats</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Escapedvalues">Escaped values</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-CommonProperties">Common Properties</a><ul class="list _bullet"><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-MessageCreationTimestamp">Message Creation Timestamp</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-MessageFlowId">Message FlowId</a></li></ul></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ReportingMessagesForBuildLog">Reporting Messages For Build Log</a><ul class="list _bullet"><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-BlocksofServiceMessages">Blocks of Service Messages</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ReportingCompilationMessages">Reporting Compilation Messages</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ReportingTests">Reporting Tests</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Supportedtestservicemessages">Supported test service messages</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Nestedtestreporting">Nested test reporting</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Interpretingtestnames">Interpreting test names</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Reportingadditionaltestdata">Reporting additional test data</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Reporting.NETCodeCoverageResults">Reporting .NET Code Coverage Results</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ReportingInspections">Reporting Inspections</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Inspectiontype">Inspection type</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Inspectioninstance">Inspection instance</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Example">Example</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-PublishingArtifactswhiletheBuildisStillinProgress">Publishing Artifacts while the Build is Still in Progress</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ReportingBuildProgress">Reporting Build Progress</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ReportingBuildProblems">Reporting Build Problems</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ReportingBuildStatus">Reporting Build Status</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ReportingBuildNumber">Reporting Build Number</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-AddingorChangingaBuildParameter">Adding or Changing a Build Parameter</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ReportingBuildStatistics">Reporting Build Statistics</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-DisablingServiceMessagesProcessing">Disabling Service Messages Processing</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ImportingXMLReports">Importing XML Reports</a></li></ul></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Cancelingbuildviaservicemessage">Canceling build via service message</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-LibrariesreportingresultsviaTeamCityServiceMessages">Libraries reporting results via TeamCity Service Messages</a></li></ul></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-teamcity-info.xml">teamcity-info.xml</a><ul class="list _bullet"><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ModifyingtheBuildStatus">Modifying the Build Status</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-ReportingCustomStatistics">Reporting Custom Statistics</a><ul class="list _bullet"><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Providingdatausingtheteamcity-info.xmlfile">Providing data using the teamcity-info.xml file</a></li><li class="list__item"><a href="#BuildScriptInteractionwithTeamCity-Describingcustomcharts">Describing custom charts</a></li></ul></li></ul></li></ul></p><p id="53636d5b">If TeamCity doesn't support your testing framework or build runner out of the box, you can still avail yourself of many TeamCity benefits by customizing your build scripts to interact with the TeamCity server. This makes a wide range of features available to any team regardless of their testing frameworks and runners. Some of these features include displaying real-time test results and customized statistics, changing the build status, and publishing artifacts before the build is finished. The build script interaction can be implemented by means of:</p><ul class="list _ul"><li class="list__item" id="e89de66f"><p>service messages in the build script</p></li><li class="list__item" id="f361b24b"><p><code class="code">teamcity-info.xml</code> file (obsolete approach, consider using service messages instead)</p></li></ul><aside class="tip sideblock" data-title="" rel="d2446546" id="ccd5170d"><p id="6eb2ca04">If you use MSBuild build runner, you can use <a href="msbuild-service-tasks.html">MSBuild Service Tasks</a>.</p></aside><a name="ServiceMessages"></a><a name="Service-Messages"></a><div class="chapter"><h2 id="BuildScriptInteractionwithTeamCity-ServiceMessages">Service Messages</h2><p id="5910c6cb">Service messages are specially constructed pieces of text that are used to pass commands/information about the build from the build script to the TeamCity server.</p><p id="ed5b7ac0">To be processed by TeamCity, <b id="c7147b51">they need to be written to the standard output stream of the build, i.e. printed or echoed from a build step</b>. It is recommended to output a single service message per line (i.e. divide messages with newline symbol(s))</p><p id="4a04dac6">Examples:</p><p id="af1c1ede">Windows</p><div class="code-block" data-lang="bash">echo ##teamcity[&lt;messageName&gt; 'value']

</div><p id="686624f9">Linux</p><div class="code-block" data-lang="bash">echo "##teamcity[&lt;messageName&gt; 'value']"

</div><p id="10342b98">PowerShell script</p><div class="code-block" data-lang="bash">Write-Host "##teamcity[&lt;messageName&gt; 'value']"

</div><p id="5b9c0952">A single service message cannot contain a newline character inside it, it cannot span across multiple lines.</p><a name="Servicemessagesformats"></a><a name="Service-messages-formats"></a><div class="chapter"><h3 id="BuildScriptInteractionwithTeamCity-Servicemessagesformats">Service messages formats</h3><p id="bc572f4f">Service messages support two formats:</p><ul class="list _ul"><li class="list__item" id="77c68585"><p id="d97ab6b6">Single-attribute message:</p><div class="code-block" data-lang="bash">##teamcity[&lt;messageName&gt; 'value']

</div></li><li class="list__item" id="7002b134"><p id="a76737f5">Multiple-attribute message:</p><div class="code-block" data-lang="bash">##teamcity[&lt;messageName&gt; name1='value1' name2='value2']

</div><p id="a858c4d4">Multiple attributes message can more formally be described as:</p><div class="code-block" data-lang="bash">##teamcity[messageNameWSPpropertyNameOWSP=OWSP'value'WSPpropertyName_IDOWSP=OWSP'value'...OWSP]

</div></li></ul><p id="e4d74554">where:</p><ul class="list _ul"><li class="list__item" id="c2746792"><p><b id="51936767">messageName</b> is a name of the message. See below for supported messages. The message name should be a valid Java id (only alpha-numeric characters and "-", starting with an alpha character)</p></li><li class="list__item" id="6e988301"><p><b id="e942d3cf">propertyName</b> is a name of the message attribute. Should be a valid Java id.</p></li><li class="list__item" id="52d9c0fc"><p><b id="d1909a05">value</b> is a value of the attribute. Should be an <i id="65b4f160">escaped</i> value (see below).</p></li><li class="list__item" id="02a1539c"><p><b id="be311b63">WSP</b> is a required whitespace(s): space or tab character (\t)</p></li><li class="list__item" id="b32cd99d"><p><b id="a0f2543b">OWSP</b> is an optional whitespace(s)</p></li><li class="list__item" id="93c47471"><p><b id="dead261a">...</b> is any number of <code class="code">WSPpropertyNameOWSP=OWSP'value'</code> blocks</p></li></ul></div><a name="Escapedvalues"></a><a name="Escaped-values"></a><div class="chapter"><h3 id="BuildScriptInteractionwithTeamCity-Escapedvalues">Escaped values</h3><p id="2f5bbb16">For escaped values, TeamCity uses a vertical bar "|" as an escape character. In order to have certain characters properly interpreted by the TeamCity server, they must be preceded by a vertical bar. For example, the following message:</p><div class="code-block" data-lang="bash">##teamcity[testStarted name='foo|'s test']

</div><p id="39c2098b">will be displayed in TeamCity as 'foo's test'. Refer to the table of the escaped values below.</p><div class="table-wrapper"><table width="100%" id="930bcf43"><thead><tr id="2025c24a" class="ijRowHead"><th id="70a07c1d"><p id="4965ec37">Character</p></th><th id="ca935c50"><p id="aa82a4ff">Escape as</p></th></tr></thead><tbody><tr id="1eb5c119" class="ijRowOdd"><td id="c5651078"><p id="0b7f17ad">' (apostrophe)</p></td><td id="91c487d1"><p id="c10a4377">|'</p></td></tr><tr id="0e93395f" class="ijRowEven"><td id="f22624ff"><p id="5fa54cea">\n (line feed)</p></td><td id="a1b6c2d0"><p id="2925c1e4">|n</p></td></tr><tr id="e13ea2e0" class="ijRowOdd"><td id="5cf48957"><p id="fa026af3">\r (carriage return)</p></td><td id="1cd3356a"><p id="f4f63b0e">|r</p></td></tr><tr id="826d4c32" class="ijRowEven"><td id="b69f60a9"><p id="64c763a5">\uNNNN (unicode symbol with code 0xNNNN)</p></td><td id="d941757d"><p id="e35ec65c">|0xNNNN</p></td></tr><tr id="9e025f3a" class="ijRowOdd"><td id="4016e5c7"><p id="063327c3">| (vertical bar)</p></td><td id="969e85f5"><p id="33dc136a">||</p></td></tr><tr id="a9d99f40" class="ijRowEven"><td id="0dbad916"><p id="d764d5c4">[ (opening bracket)</p></td><td id="d1afd95e"><p id="3403411a">|[</p></td></tr><tr id="ada18dc7" class="ijRowOdd"><td id="9c1d428f"><p id="2337772a">] (closing bracket)</p></td><td id="1dcce9d9"><p id="b80d4859">|]</p></td></tr></tbody></table></div></div><a name="CommonProperties"></a><a name="Common-Properties"></a><div class="chapter"><h3 id="BuildScriptInteractionwithTeamCity-CommonProperties">Common Properties</h3><p id="04831694">Any "message and multiple attribute" message supports the following list of optional attributes: <code class="code">timestamp</code>, <code class="code">flowId</code>. In the following examples <code class="code">&lt;messageName&gt;</code> is the name of the specific service message.</p><a name="MessageCreationTimestamp"></a><a name="Message-Creation-Timestamp"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-MessageCreationTimestamp">Message Creation Timestamp</h4><div class="code-block" data-lang="bash">##teamcity[&lt;messageName&gt; timestamp='timestamp' ...]

</div><p id="39dda35b">The timestamp format is <code class="code">yyyy-MM-dd'T'HH:mm:ss.SSSZ</code> or <code class="code">yyyy-MM-dd'T'HH:mm:ss.SSS</code> according to <a href="http://docs.oracle.com/javase/1.5.0/docs/api/java/text/SimpleDateFormat.html" data-external="true" target="_blank" rel="noopener noreferrer">Java SimpleDateFormat syntax</a>.</p><p id="dc2dfcd4">Example:</p><div class="code-block" data-lang="bash">##teamcity[&lt;messageName&gt; timestamp='2008-09-03T14:02:34.487+0400' ...]
##teamcity[&lt;messageName&gt; timestamp='2008-09-03T14:02:34.487' ...]

</div><p id="81997c6e">For .NET <a href="https://msdn.microsoft.com/en-us/library/az4se3k1(v=vs.110).aspx" data-external="true" target="_blank" rel="noopener noreferrer">DateTimeOffset</a>, a code like this</p><div class="code-block" data-lang="none">var date = DateTimeOffset.Now;
var timestamp = $"{date:yyyy-MM-dd'T'HH:mm:ss.fff}{date.Offset.Ticks:+;-;}{date.Offset:hhmm}";

</div><p id="55e1fad6">will result in</p><div class="code-block" data-lang="bash">##teamcity[&lt;messageName&gt; timestamp='2008-09-03T14:02:34.487+0400' ...]

</div></div><a name="MessageFlowId"></a><a name="Message-FlowId"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-MessageFlowId">Message FlowId</h4><p id="5413b402">The flowId is a unique identifier of the messages flow in a build. Flow tracking is necessary, for example, to distinguish separate processes running in parallel. The identifier is a string that should be unique in the scope of individual build.</p><div class="code-block" data-lang="bash">##teamcity[&lt;messageName&gt; flowId='flowId' ...]

</div></div></div><a name="ReportingMessagesForBuildLog"></a><a name="Reporting-Messages-For-Build-Log"></a><div class="chapter"><h3 id="BuildScriptInteractionwithTeamCity-ReportingMessagesForBuildLog">Reporting Messages For Build Log</h3><p id="ae62560d">You can report messages for a build log in the following way:</p><div class="code-block" data-lang="bash">##teamcity[message text='&lt;message text&gt;' errorDetails='&lt;error details&gt;' status='&lt;status value&gt;']

</div><p id="ae9c329f">where:</p><ul class="list _ul"><li class="list__item" id="51c34be7"><p>The <code class="code">status</code> attribute may take following values: <code class="code">NORMAL</code>, <code class="code">WARNING</code>, <code class="code">FAILURE</code>, <code class="code">ERROR</code>. The default value is <code class="code">NORMAL</code>.</p></li><li class="list__item" id="3f0031cc"><p>The <code class="code">errorDetails</code> attribute is used only if <code class="code">status</code> is <code class="code">ERROR</code>, in other cases it is ignored.This message fails the build in case its status is <code class="code">ERROR</code> and "Fail build if an error message is logged by build runner" box is checked on the <a href="build-failure-conditions.html">Build Failure Conditions</a> page of a build configuration. For example:</p></li></ul><div class="code-block" data-lang="bash">##teamcity[message text='Exception text' errorDetails='stack trace' status='ERROR']

</div><a name="BlocksofServiceMessages"></a><a name="Blocks-of-Service-Messages"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-BlocksofServiceMessages">Blocks of Service Messages</h4><p id="97d2cf4a">Blocks are used to group several messages in the build log.</p><p id="31587ff1">Block opening:</p><p id="fe9de031">The <code class="code">blockOpened</code> system message allows the <code class="code">name</code> attribute, you can also add a description to the <code class="code">blockOpened</code> message:</p><div class="code-block" data-lang="bash"> ##teamcity[blockOpened name='&lt;blockName&gt;' description='&lt;this is the description of blockName&gt;']

</div><p id="c2b0052f">Block closing:</p><div class="code-block" data-lang="bash"> ##teamcity[blockClosed name='&lt;blockName&gt;']

</div><aside class="note " data-title="" rel="6e341375" id="ba0b350b"><p id="96428b4c">Note that when you close the block, all inner blocks are closed automatically.</p></aside></div><a name="ReportingCompilationMessages"></a><a name="Reporting-Compilation-Messages"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-ReportingCompilationMessages">Reporting Compilation Messages</h4><div class="code-block" data-lang="bash">##teamcity[compilationStarted compiler='&lt;compiler name&gt;']
...
##teamcity[message text='compiler output']
##teamcity[message text='compiler output']
##teamcity[message text='compiler error' status='ERROR']
...
##teamcity[compilationFinished compiler='&lt;compiler name&gt;']

</div><p id="9f94157d">where:</p><ul class="list _ul"><li class="list__item" id="37eaec92"><p><code class="code">compiler name</code> is an arbitrary name of the compiler performing compilation, eg. javac, groovyc and so on. Currently it is used as a block name in the build log.</p></li><li class="list__item" id="69fe9605"><p>any message with status <code class="code">ERROR</code> reported between <code class="code">compilationStarted</code> and <code class="code">compilationFinished</code> will be treated as a compilation error.</p></li></ul></div><a name="ReportingTests"></a><a name="Reporting-Tests"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-ReportingTests">Reporting Tests</h4><p id="f2871f3d">To use the TeamCity on-the-fly test reporting, a testing framework needs dedicated support for this feature to work (alternatively, <a href="xml-report-processing.html">XML Report Processing</a> can be used). If TeamCity doesn't support your testing framework natively, it is possible to modify your build script to report test runs to the TeamCity server using service messages. This makes it possible to display test results in real-time, make test information available on the <a href="working-with-build-results.html#All-Tests">Tests tab of the Build Results page</a>.</p></div><a name="Supportedtestservicemessages"></a><a name="Supported-test-service-messages"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-Supportedtestservicemessages">Supported test service messages</h4><p id="49808a97"><b id="47eacc1a">Test suite messages:</b> Test suites are used to group tests. TeamCity displays tests grouped by suites on the <a href="working-with-build-results.html#All-Tests">Tests tab of the Build Results page</a> and in other places.</p><div class="code-block" data-lang="bash">##teamcity[testSuiteStarted name='suiteName']
&lt;individual test messages go here&gt;
##teamcity[testSuiteFinished name='suiteName']

</div><p id="7a2e8f31">All the individual test messages are to appear between <code class="code">testSuiteStarted</code> and <code class="code">testSuiteFinished</code> (in that order) with the same <code class="code">name</code> attributes.</p></div><a name="Nestedtestreporting"></a><a name="Nested-test-reporting"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-Nestedtestreporting">Nested test reporting</h4><p id="cb482088"><b id="fcfe8b22">Prior to TeamCity 9.1</b>, one test could have been reported from within another test (see the example at the end of this section). In the later versions, starting another test finishes the currently started test in the same "flow". To still report tests from within other tests, you will need to specify another <a href="#Message-FlowId">flowId</a> in the nested test service messages.</p><p id="e68f3506"><b id="e088926d">Test start/stop messages:</b></p><div class="code-block" data-lang="bash">##teamcity[testStarted name='testName' captureStandardOutput='&lt;true/false&gt;']
&lt;here go all the test service messages with the same name&gt;
##teamcity[testFinished name='testName' duration='&lt;test_duration_in_milliseconds&gt;']

</div><p id="1c10d3e7">Indicates that the test "<i id="51b0bf21">testName</i>" was run. If the <code class="code">testFailed</code> message is not present, the test is regarded successful, where</p><ul class="list _ul"><li class="list__item" id="fd6d3c6e"><p><b id="a1f61f5f">duration</b> (optional numeric attribute) - sets the test duration in milliseconds (should be an integer) to be reported in TeamCity UI. If omitted, the test duration will be calculated from the messages timestamps. If the timestamps are missing, from the actual time the messages were received on the server.</p></li><li class="list__item" id="bf269b10"><p><b id="ecce59c5">captureStandardOutput</b> (optional boolean attribute) - if <code class="code">true</code>, all the standard output (and standard error) messages received between <code class="code">testStarted</code> and <code class="code">testFinished</code> messages will be considered test output. The default value is <code class="code">false</code> and assumes usage of <code class="code">testStdOut</code> and <code class="code">testStdErr</code> service messages to report the test output.</p></li></ul><aside class="note " data-title="" rel="8b2361cc" id="caefba13"><p id="8f46425a">All the other test messages (except for <code class="code">testIgnored</code>) with the same <code class="code">name</code> attribute should appear between the <code class="code">testStarted</code> and <code class="code">testFinished</code> messages (in that order).</p><p id="bf9044e4">If using Ant's <i id="8ff6b670">echo</i> task to output the messages, make sure to include <i id="e67ff672">flowId</i> attribute with the same value in all the messages related to the same test/test suite as otherwise they <a href="http://jetbrains.net/tracker/issue/TW-5059" data-external="true" target="_blank" rel="noopener noreferrer">will not be processed correctly</a>.</p></aside><p id="75f04bb9">It is highly recommended to ensure that the pair of <code class="code">test suite</code> + <code class="code">test name</code> is unique within the build. For advanced TeamCity test-related features to work, test names should not deviate from one build to another (a single test must be reported under the same name in every build). Include absolute paths in the reported test names is <b id="6fd6a406">strongly discouraged</b>.</p><p id="93793a20"><b id="a5f71d36">Ignored tests:</b></p><div class="code-block" data-lang="bash">##teamcity[testIgnored name='testName' message='ignore comment']

</div><p id="e05cd2cd">Indicates that the test "<code class="code">testName</code>" is present but was not run (was ignored) by the testing framework. As an exception, the <code class="code">testIgnored</code> message can be reported without the matching <code class="code">testStarted</code> and <code class="code">testFinished</code> messages.</p><p id="b3dc6327"><b id="4232f243">Test output:</b></p><div class="code-block" data-lang="bash">##teamcity[testStarted name='className.testName']
##teamcity[testStdOut name='className.testName' out='text']
##teamcity[testStdErr name='className.testName' out='error text']
##teamcity[testFinished name='className.testName' duration='50']

</div><p id="6b49a690">The <code class="code">testStdOut</code> and <code class="code">testStdErr</code> service messages report the test's standard and error output to be displayed in the TeamCity UI. There must be only one <code class="code">testStdOut</code> and one <code class="code">testStdErr</code> message per test. An alternative but a less reliable approach is to use the <code class="code">captureStandardOutput</code> attribute of the <code class="code">testStarted</code> message.</p><p id="721c8bf1"><b id="06ad3122">Test result:</b></p><div class="code-block" data-lang="bash">##teamcity[testStarted name='MyTest.test1']
##teamcity[testFailed name='MyTest.test1' message='failure message' details='message and stack trace']
##teamcity[testFinished name='MyTest.test1']

##teamcity[testStarted name='MyTest.test2']
##teamcity[testFailed type='comparisonFailure' name='MyTest.test2' message='failure message' details='message and stack trace' expected='expected value' actual='actual value']
##teamcity[testFinished name='MyTest.test2']

</div><p id="a903a0ef">Indicates that the "<i id="9cae59a6">testname</i>" test failed. Only one <code class="code">testFailed</code> message can appear for a given test name.</p><ul class="list _ul"><li class="list__item" id="2d6ba55c"><p><code class="code">message</code> contains the textual representation of the error</p></li><li class="list__item" id="15a2e695"><p><code class="code">details</code> contains detailed information on the test failure, typically a message and an exception stacktrace.</p></li><li class="list__item" id="cdfae898"><p><code class="code">actual</code> and <code class="code">expected</code> attributes can only be used together with <code class="code">type='comparisonFailure'</code> to report comparison failure. The values will be used when opening the test in the IDE.</p></li></ul><p id="9255aaea">Here is a longer example of test reporting with service messages:</p><div class="code-block" data-lang="bash">##teamcity[testSuiteStarted name='suiteName']
##teamcity[testSuiteStarted name='nestedSuiteName']
##teamcity[testStarted name='package_or_namespace.ClassName.TestName']
##teamcity[testFailed name='package_or_namespace.ClassName.TestName' message='The number should be 20000' details='junit.framework.AssertionFailedError: expected:&lt;20000&gt; but was:&lt;10000&gt;|n|r    at junit.framework.Assert.fail(Assert.java:47)|n|r    at junit.framework.Assert.failNotEquals(Assert.java:280)|n|r...']
##teamcity[testFinished name='package_or_namespace.ClassName.TestName']
##teamcity[testSuiteFinished name='nestedSuiteName']
##teamcity[testSuiteFinished name='suiteName']

</div></div><a name="Interpretingtestnames"></a><a name="Interpreting-test-names"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-Interpretingtestnames">Interpreting test names</h4><p id="a224199e">A full test name can have a form of: <code class="code">&lt;suite name&gt;:&lt;package/namespace name&gt;.&lt;class name&gt;.&lt;test method&gt;(&lt;test parameters&gt;)</code>,</p><p id="4e31e56b">where &lt;class name&gt; and &lt;test method&gt; can have no dots in the names. Only &lt;test method&gt; is a mandatory part of a full test name.</p><p id="1a08752b">The full test name is used to compare tests between consequent builds or match tests across different build configurations.</p><p id="67c91a79">An example of a full test name is</p><div class="code-block" data-lang="none">Integration Tests: Backend: org.jetbrains.teamcity.LoginPageController.testBadPassword("incorrect password", false)
 
// in the example above, 
// suite name = "Integration Tests: Backend"
// package = org.jetbrains.teamcity
// class name = LoginPageController
// test method = testBadPassword
// test parameters = ("incorrect password", false)

</div><p id="f5e4a981">The <a href="working-with-build-results.html#Tests">Tests tab of the Build Results page</a> allows grouping by suites, packages/namespaces, classes, and tests. Usually the attribute values are provides as they are reported by your test framework and TeamCity is able to interpret test names correctly.</p><p id="120db23a">If a test cannot be parsed in the form above, TeamCity still tries to extract &lt;suite name&gt; from the full test name for the filtering on the Tests tab, and treats everything after the suite a non-parsable test name.</p></div><a name="Reportingadditionaltestdata"></a><a name="Reporting-additional-test-data"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-Reportingadditionaltestdata">Reporting additional test data</h4><p id="5db1289e"><b id="0efff748">Since TeamCity 2018.2</b>, it is possible to attach extra information to the tests using a <code class="code">testMetadata</code> service message. More details are available on a <a href="reporting-test-metadata.html">separate page</a>.</p></div><a name="Reporting.NETCodeCoverageResults"></a><a name="Reporting-.NET-Code-Coverage-Results"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-Reporting.NETCodeCoverageResults">Reporting .NET Code Coverage Results</h4><p id="64937d6c">You can configure .NET coverage processing by means of service messages. To learn more, refer to <a href="manually-configuring-reporting-coverage.html">Manually Configuring Reporting Coverage</a> page.</p></div><a name="ReportingInspections"></a><a name="Reporting-Inspections"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-ReportingInspections">Reporting Inspections</h4><p id="49737a8b">You can report inspections from a custom tool to TeamCity using the service messages described below.</p><p id="7a62bcac">Among other uses, the number of inspections can be used as a build metric to <a href="build-failure-conditions.html#Fail-build-on-metric-change">fail a build on</a>.</p></div><a name="Inspectiontype"></a><a name="Inspection-type"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-Inspectiontype">Inspection type</h4><p id="cb6f78f8">Each specific warning or an error in code (inspection instance) has an inspection type – the unique description of the conducted inspection, which can be reported via</p><div class="code-block" data-lang="bash">##teamcity[inspectionType id='&lt;id&gt;' name='&lt;name&gt;' description='&lt;description&gt;' category='&lt;category&gt;']

</div><p id="e5a82621">where all the attributes are required and can have either numeric or textual values</p><ul class="list _ul"><li class="list__item" id="ffc1801b"><p><code class="code">id</code> - (mandatory) limited by 255 characters</p></li><li class="list__item" id="63f6f2f9"><p><code class="code">name</code> - (mandatory) limited by 255 characters</p></li><li class="list__item" id="106c552d"><p><code class="code">category</code> - (mandatory) limited by 255 characters. The <code class="code">category</code> attribute examples are "Style violations" and "Calling contracts".</p></li><li class="list__item" id="dd6cd15a"><p><code class="code">description</code> - (mandatory) limited by 4000 characters. The description can also be in HTML. For example,</p></li></ul><div class="code-block" data-lang="markup">&lt;html&gt;
&lt;body&gt;
Reports unnecessary local variables, which add nothing to the comprehensibility of a method. Variables caught include local variables which are immediately returned, local variables that are immediately assigned to another variable and then not used, and local variables which always have the same value as another
local variable or parameter.
&lt;!-- tooltip end --&gt;
&lt;p&gt;
Use the first checkbox below to have this inspection ignore variables which are immediately returned or thrown. Some coding styles suggest using such variables for clarity and ease of debugging.
&lt;p&gt;
Use the second checkbox below to have this inspection ignore variables which are annotated.
&lt;p&gt;
&lt;/body&gt;
&lt;/html&gt;

</div></div><a name="Inspectioninstance"></a><a name="Inspection-instance"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-Inspectioninstance">Inspection instance</h4><p id="42ed4d16">Reports a specific defect, warning, error message. Includes location, description, and various optional and custom attributes.</p><div class="code-block" data-lang="bash">##teamcity[inspection typeId='&lt;inspection type identity&gt;' message='&lt;instance description&gt;' file='&lt;file path&gt;' line='&lt;line&gt;' additional attribute='&lt;additional attribute&gt;']

</div><p id="e556e3c0">where all the attributes can have either numeric or textual values:</p><ul class="list _ul"><li class="list__item" id="6f244616"><p><code class="code">typeId</code> - (mandatory), reference to the <code class="code">inspectionType.id</code> described <a href="#Inspection-type">above</a> limited by 255 characters</p></li><li class="list__item" id="afb419cf"><p><code class="code">message</code> - (optional) current instance description limited by 4000 characters</p></li><li class="list__item" id="5f48f1ed"><p><code class="code">file</code> - (mandatory) file path limited by 4000 characters. The path can be absolute or relative to the <a href="build-checkout-directory.html">checkout directory</a></p></li><li class="list__item" id="c3d36be0"><p><code class="code">line</code> - (optional) line of the file, integer</p></li><li class="list__item" id="29eb3715"><p><code class="code">additional attribute</code> - can be any attribute, <code class="code">SEVERITY</code> is often used here, with one of the following values (mind the upper case): <code class="code">INFO</code>, <code class="code">ERROR</code>, <code class="code">WARNING</code>, <code class="code">WEAK WARNING</code></p></li></ul></div><a name="Example"></a><a name="Example"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-Example">Example</h4><div class="code-block" data-lang="bash">##teamcity[inspectionType id='UnnecessaryLocalVariable' name='Redundant local variable' description='&lt;html&gt;&lt;body&gt;Reports unnecessary local variables...&lt;/body&gt;
&lt;/html&gt;' category='Data flow issues']
##teamcity[inspection typeId='UnnecessaryLocalVariable' message='Local variable &lt;code&gt;i&lt;/code&gt; is redundant' file='src/Test.java' line='19' SEVERITY='WARNING']

</div></div><a name="PublishingArtifactswhiletheBuildisStillinProgress"></a><a name="Publishing-Artifacts-while-the-Build-is-Still-in-Progress"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-PublishingArtifactswhiletheBuildisStillinProgress">Publishing Artifacts while the Build is Still in Progress</h4><p id="edd8ae82">You can publish the build artifacts while the build is still running, immediately after the artifacts are built.</p><p id="35f3f652">To do this, you need to output the following line:</p><div class="code-block" data-lang="bash">##teamcity[publishArtifacts '&lt;path&gt;']

</div><p id="012af72c">The <code class="code">&lt;path&gt;</code> has to adhere to the same rules as the <a href="configuring-general-settings.html#Artifact-Paths">Build Artifact specification</a> of the Build Configuration settings. The files matching the <code class="code">&lt;path&gt;</code> will be uploaded and visible as the artifacts of the running build.</p><p id="2b0cdeda">The message should be printed after all the files are ready and no file is locked for reading.</p><p id="ef87664d">Artifacts are uploaded in the background, which can take time. Make sure the matching files are not deleted till the end of the build (for example, you can put them in a directory that is cleaned on the next build start, in a <a href="how-to.html#Make-Temporary-Build-Files-Erased-between-the-Builds">temp directory</a>, or use <a href="build-files-cleaner-swabra.html">Swabra</a> to clean them after the build).</p><aside class="note " data-title="" rel="ef87664d" id="a0fbd64b"><p id="4cfc8751">The process of publishing artifacts can affect the build because it consumes network traffic and some disk/CPU resources (should be pretty negligible for not large files/directories).</p></aside><p id="43dac763">Artifacts that are specified in the build configuration setting will be published as usual.</p></div><a name="ReportingBuildProgress"></a><a name="Reporting-Build-Progress"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-ReportingBuildProgress">Reporting Build Progress</h4><p id="1ef4ecdd">You can use special progress messages to mark long-running parts in a build script. These messages will be shown on the projects dashboard for the corresponding build and on the <a href="working-with-build-results.html">Build Results page</a>.</p><p id="38a29157">To log a single progress message, use:</p><div class="code-block" data-lang="bash">##teamcity[progressMessage '&lt;message&gt;']

</div><p id="6171e6c7">This progress message will be shown until another progress message occurs or until the next target starts (in case of Ant builds).</p><p id="0a8b1670">If you wish to show a progress message for a part of a build only, use:</p><div class="code-block" data-lang="bash">##teamcity[progressStart '&lt;message&gt;']
...some build activity...
##teamcity[progressFinish '&lt;message&gt;']

</div><aside class="note " data-title="" rel="deaff1b6" id="948a3ac2"><p id="5a5dace8">The same message should be used for both <code class="code">progressStart</code> and <code class="code">progressFinish</code>. This allows nesting progress blocks. Also note that in case of Ant builds, progress messages will be replaced if an Ant target starts.</p></aside></div><a name="ReportingBuildProblems"></a><a name="Reporting-Build-Problems"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-ReportingBuildProblems">Reporting Build Problems</h4><p id="a03c41aa">To fail a build directly from the build script, a build problem must be reported. Build problems appear on the <a href="working-with-build-results.html">Build Results</a> page and also affect the build status text. To add a build problem to a build, use:</p><div class="code-block" data-lang="bash">##teamcity[buildProblem description='&lt;description&gt;' identity='&lt;identity&gt;']

</div><p id="3a8ec47f">where:</p><ul class="list _ul"><li class="list__item" id="a0d34316"><p><code class="code">description</code> (mandatory): a human-readable plain text describing the build problem. By default, the <code class="code">description</code> appears in the build status text and in the list of build's problems. The text is limited to 4000 symbols, and will be truncated if the limit is exceeded.</p></li><li class="list__item" id="5df22eaa"><p><code class="code">identity</code> (optional): a unique problem ID. Different problems must have different identity, same problems – same identity, which should not change throughout builds if the same problem, for example, the same compilation error occurs. It must be a valid Java ID up to 60 characters. If omitted, the <code class="code">identity</code> is calculated based on the <code class="code">description</code> text.</p></li></ul></div><a name="ReportingBuildStatus"></a><a name="Reporting-Build-Status"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-ReportingBuildStatus">Reporting Build Status</h4><p id="00787556">TeamCity allows changing the <b id="b6a0b53d">build status text</b> from the build script. Unlike <a href="#Reporting-Build-Progress">progress messages</a>, this change persists even after a build has finished.<br>You can also change the build status of a failing build to <code class="code">SUCCESS</code>.</p><aside class="tip sideblock" data-title="" rel="00787556" id="84541b84"><p id="99250007">Prior to TeamCity 7.1, this service message could be also used for changing the build status to <code class="code">FAILURE</code>. In the later TeamCity versions, the <a href="#Reporting-Build-Problems"><code class="code">buildProblem</code></a> service message must be used for that.</p></aside><p id="5cffe6dc">To set the status and/or change the text of the build status (for example, note the number of failed tests if the test framework is not supported by TeamCity), use the <code class="code">buildStatus</code> message with the following format:</p><div class="code-block" data-lang="bash">##teamcity[buildStatus status='&lt;status_value&gt;' text='{build.status.text} and some aftertext']

</div><p id="2444ecf7">where:</p><ul class="list _ul"><li class="list__item" id="bbf8cae9"><p><code class="code">status</code> (optional): use the <code class="code">SUCCESS</code> value to change the build status to <i id="4efbdd45">Success</i>.</p></li><li class="list__item" id="f079f2b4"><p><code class="code">text</code> (mandatory): set the new build status text.<br>Optionally, the text can use the <code class="code">{build.status.text}</code> substitution pattern, which represents the status calculated by TeamCity automatically using passed test count, compilation messages, and so on.<br>The status set will be presented while the build is running and will also affect the final build results.</p></li></ul></div><a name="ReportingBuildNumber"></a><a name="Reporting-Build-Number"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-ReportingBuildNumber">Reporting Build Number</h4><p id="13c4b009">To set a custom build number directly, specify a <code class="code">buildNumber</code> message using the following format:</p><div class="code-block" data-lang="bash">##teamcity[buildNumber '&lt;new build number&gt;']

</div><p id="d6f3dad6">In the &lt;new build number&gt; value, you can use the <code class="code">{build.number}</code> substitution to use the current build number automatically generated by TeamCity. For example:</p><div class="code-block" data-lang="bash">##teamcity[buildNumber '1.2.3_{build.number}-ent']

</div></div><a name="AddingorChangingaBuildParameter"></a><a name="Adding-or-Changing-a-Build-Parameter"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-AddingorChangingaBuildParameter">Adding or Changing a Build Parameter</h4><p id="3577943e">By using a dedicated service message in your build script, you can dynamically update build parameters of the build right from a build step (the parameters need to be defined in the <a href="configuring-build-parameters.html">Parameters section</a> of the build configuration). The changed build parameters will be available in the build steps following the modifying one. They will also be available as build parameters and can be used in the dependent builds via <a href="predefined-build-parameters.html#Dependencies-Properties"><code class="code">%dep.*% parameter references</code></a>, for example:</p><div class="code-block" data-lang="bash">##teamcity[setParameter name='ddd' value='fff']

</div><p id="5b70296f">When specifying a build parameter's name, mind the prefix:</p><ul class="list _ul"><li class="list__item" id="84793124"><p><b id="36039edd">system</b> for system properties.</p></li><li class="list__item" id="6a4020f4"><p><b id="c55ff0a8">env</b> for environment variables.</p></li><li class="list__item" id="e682e17c"><p>no prefix for configuration parameter.</p></li></ul><p id="6920471c"><a href="configuring-build-parameters.html">Read more</a> about build parameters and their prefixes.</p></div><a name="ReportingBuildStatistics"></a><a name="Reporting-Build-Statistics"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-ReportingBuildStatistics">Reporting Build Statistics</h4><p id="95b1c1a1">In TeamCity, it is possible to configure a build script to report statistical data and then display the charts based on the data. Refer to the <a href="customizing-statistics-charts.html#Modifying-Pre-defined-Project-level-Charts">Customizing Statistics Charts</a> page for a guide to displaying the charts on the web UI. This section describes how to report the statistical data from the build script via service messages. You can publish the build statics values in two ways:</p><ul class="list _ul"><li class="list__item" id="1f9d8820"><p>Using a service message in a build script directly</p></li><li class="list__item" id="6828d8fd"><p><a href="#Providing-data-using-the-teamcity-info.xml-file">Providing data using the teamcity-info.xml file</a><br>To report build statistics using service messages: Specify a '<code class="code">buildStatisticValue</code>' service message with the following format for each statistics value you want to report:</p></li></ul><div class="code-block" data-lang="bash">##teamcity[buildStatisticValue key='&lt;valueTypeKey&gt;' value='&lt;value&gt;']

</div><p id="bdff3b90">where</p><ul class="list _ul"><li class="list__item" id="a29d3880"><p>The <code class="code">key</code> should not be equal to any of <a href="custom-chart.html#Default-Statistics-Values-Provided-by-TeamCity">predefined keys</a>.</p></li><li class="list__item" id="6ebd5f46"><p>The <code class="code">value</code> should be a positive/negative integer of up to 13 digits; float values with up to 6 decimal places are also supported.</p></li></ul></div><a name="DisablingServiceMessagesProcessing"></a><a name="Disabling-Service-Messages-Processing"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-DisablingServiceMessagesProcessing">Disabling Service Messages Processing</h4><p id="29fbd8ff">If you need for some reason to disable searching for service messages in the output, you can disable the service messages search with the messages:</p><div class="code-block" data-lang="bash">##teamcity[enableServiceMessages]
##teamcity[disableServiceMessages]

</div><p id="70abf87d">Any messages that appear between these two are not parsed as service messages and are effectively ignored. For server-side processing of service messages, enable/disable service messages also supports the flowId attribute and will ignore only the messages with the same flowId.</p></div><a name="ImportingXMLReports"></a><a name="Importing-XML-Reports"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-ImportingXMLReports">Importing XML Reports</h4><p id="651007fd">In addition to the <a href="xml-report-processing.html">UI Build Feature</a>, XML reporting can be configured from within the build script with the help of the <code class="code">importData</code> service message. Also, the message supports importing of the previously collected code coverage and code inspection/duplicates reports.</p><p id="0dc4d70e">The service message format is:</p><div class="code-block" data-lang="bash">##teamcity[importData type='typeID' path='&lt;path to the xml file&gt;']

</div><aside class="note " data-title="" rel="721b2060" id="77c88b62"><p id="e6041a80">To be processed, report XML files (or a directory) must be located in the checkout directory, and the path must be relative to <a href="build-checkout-directory.html">this directory</a>.</p></aside><p id="ffe6b1b1">where <code class="code">typeID</code> can be one of the following (see also <a href="xml-report-processing.html">XML Report Processing</a>):</p><div class="table-wrapper"><table width="100%" id="3dda69c5"><thead><tr id="9da0d823" class="ijRowHead"><th id="5b754bfe"><p id="4f7648c4">typeID</p></th><th id="4babfc9c"><p id="4331b729">Description</p></th></tr></thead><tbody><tr id="67931159" class="ijRowOdd"><td colspan="2" id="ef79d11c"><p id="166c355d"><b id="4ca0bf73">Testing frameworks</b></p></td></tr><tr id="4d00ed10" class="ijRowEven"><td id="fa6fde8f"><p id="b900eaec"><code class="code">junit</code></p></td><td id="d19b4b45"><p id="4814c554">JUnit Ant task XML reports</p></td></tr><tr id="f9465f83" class="ijRowOdd"><td id="643e61f6"><p id="7a550227"><code class="code">surefire</code></p></td><td id="9222aecd"><p id="bda3b904">Maven Surefire XML reports</p></td></tr><tr id="7a728ad6" class="ijRowEven"><td id="08d0952e"><p id="e6cc1fa1"><code class="code">nunit</code></p></td><td id="3e654d23"><p id="f8f3d4c5">NUnit-Console XML reports</p></td></tr><tr id="480c4976" class="ijRowOdd"><td id="5dfb4328"><p id="faf7e2d2"><code class="code">mstest</code></p></td><td id="56be87af"><p id="28b38965">MSTest XML reports</p></td></tr><tr id="23718e13" class="ijRowEven"><td id="e8f31d83"><p id="dd9a1d40"><code class="code">vstest</code></p></td><td id="b2b0cbcc"><p id="a6b96008">VSTest XML reports</p></td></tr><tr id="3053af81" class="ijRowOdd"><td id="042103cc"><p id="2c9f3283"><code class="code">gtest</code></p></td><td id="40f9316c"><p id="c213c5ef">Google Test XML reports</p></td></tr><tr id="b7b5f784" class="ijRowEven"><td colspan="2" id="672256fe"><p id="2113efe6"><b id="059ed2dc">Code inspection</b></p></td></tr><tr id="0eb61c6b" class="ijRowOdd"><td id="0c6fbbbd"><p id="10827ccc"><code class="code">intellij-inspections</code></p></td><td id="e5fd577a"><p id="70b8daa6"><b id="61c1204b">Since TeamCity 2017.1</b>, IntelliJ IDEA inspection results</p></td></tr><tr id="7d0d57f0" class="ijRowEven"><td id="ae0e65de"><p id="9fd6cbf3"><code class="code">checkstyle</code></p></td><td id="cd4fc0de"><p id="6e47c816">Checkstyle inspections XML reports</p></td></tr><tr id="93ad554a" class="ijRowOdd"><td id="f52e9f48"><p id="31c4519c"><code class="code">findBugs</code> 2)</p></td><td id="bf7c9fe1"><p id="5acb8f23">FindBugs inspections XML reports</p></td></tr><tr id="c1ac64e8" class="ijRowEven"><td id="4f5de791"><p id="23384500"><code class="code">jslint</code></p></td><td id="3c36b6e6"><p id="35cc2655">JSLint XML reports</p></td></tr><tr id="c3f4bcbb" class="ijRowOdd"><td id="8e8197fc"><p id="df3205f2"><code class="code">ReSharperInspectCode</code> 1)</p></td><td id="20360d0a"><p id="7e1c40b3">ReSharper <code class="code">inspectCode.exe</code> XML reports</p></td></tr><tr id="36ef3c93" class="ijRowEven"><td id="e171d6d7"><p id="86e7088d"><code class="code">FxCop</code>1</p></td><td id="51a84d6e"><p id="1767dfb0">FxCop inspection XML reports</p></td></tr><tr id="ca6b2969" class="ijRowOdd"><td id="7c149364"><p id="486e1c92"><code class="code">pmd</code></p></td><td id="fea4c882"><p id="ec5db5e2">PMD inspections XML reports</p></td></tr><tr id="6ffc1e5e" class="ijRowEven"><td colspan="2" id="c4aee87a"><p id="038ba75e"><b id="07ff70f9">Code duplication</b></p></td></tr><tr id="4118ae18" class="ijRowOdd"><td id="a03f7207"><p id="cc922f3c"><code class="code">pmdCpd</code></p></td><td id="7e5578f2"><p id="0f40c9d2">PMD Copy/Paste Detector (CPD) XML reports</p></td></tr><tr id="06f5bf1f" class="ijRowEven"><td id="c087f052"><p id="d17e156f"><code class="code">DotNetDupFinder</code> 1)</p></td><td id="b3741318"><p id="b80fa78d">ReSharper <code class="code">dupfinder.exe</code> XML reports</p></td></tr><tr id="e370d962" class="ijRowOdd"><td colspan="2" id="d7af8f5a"><p id="81215203"><b id="a865cbdd">Code coverage</b></p></td></tr><tr id="ae9f672d" class="ijRowEven"><td id="49562b30"><p id="4f1afb0f"><code class="code">dotNetCoverage</code> 1) 3)</p></td><td id="148d9f34"><p id="5068248b">XML reports generated by dotcover, partcover, ncover or ncover3</p></td></tr></tbody></table></div><p id="2a162449">Notes:</p><ol class="list _decimal"><li class="list__item" id="bb1c7139"><p>Only supports a specific file in the <code class="code">path</code> attribute.</p></li><li class="list__item" id="0421099a"><p>Also requires the <code class="code">findBugsHome</code> attribute specified pointing to the home directory of the installed FindBugs tool.</p></li><li class="list__item" id="aae2797a"><p>Also requires the <code class="code">tool='&lt;tool name&gt;'</code> service message attribute, where the <code class="code">&lt;tool name&gt;</code> is either <code class="code">dotcover</code>, <code class="code">partcover</code>, <code class="code">ncover</code> or <code class="code">ncover3</code>.</p></li></ol><p id="e9b9ccc7">If not specially noted, the report types support Ant-like wildcards in the <code class="code">path</code> attribute.</p><ul class="list _ul"><li class="list__item" id="5a329870"><p id="3dbd414e"><code class="code">verbose='true'</code> attribute will enable detailed logging into the build log.</p></li><li class="list__item" id="142328df"><p id="137e5b0f"><code class="code">parseOutOfDate='true'</code> attribute will process all the files matching the path. By default, only those updated during the build (determined by last modification timestamp) are processed. If any not matching reports are found, the "report skipped as out-of-date" message appears in the build log.</p></li><li class="list__item" id="189c74e0"><p id="e10a0885"><code class="code">whenNoDataPublished=&lt;action&gt;</code> (where &lt;action&gt; is one of the following: <code class="code">info</code> (default), <code class="code">nothing</code>, <code class="code">warning</code>, <code class="code">error</code>) will change output level if no reports matching the path specified were found.</p></li><li class="list__item" id="71b0049e"><p id="b9f8c2ab">(<b id="b54fbc6b">deprecated, use <a href="build-failure-conditions.html">Build Failure Conditions</a> instead</b>)<br><code class="code">findBugs</code>, <code class="code">pmd</code> or <code class="code">checkstyle</code> importData messages also take optional <code class="code">errorLimit</code> and <code class="code">warningLimit</code> attributes specifying errors and warnings limits, exceeding which will cause the build failure.</p></li></ul><aside class="note " data-title="" rel="70bccee1" id="c0bb69a6"><p id="36109392">After the <code class="code">importData</code> message is received, TeamCity agent starts to monitor the specified paths on the disk and imports matching report files in the background as soon as the files appear on disk.The parsing only occurs within the build step in which the messages were received. On the step finish, the agent ensures all the present reports are processed before beginning the next step. This behavior is different from that of <a href="xml-report-processing.html">XML Report Processing</a> build feature, which completes files parsing only at the end of the build.Ensure the report files are available after the generation process ends (the files are not deleted, nor overwritten by the build script)</p></aside><p id="506f4a30">To initiate monitoring of several directories or parse several types of the report, send the corresponding service messages one after another.</p><aside class="note " data-title="" rel="506f4a30" id="e2c20949"><p id="f390e25a">Only several reports of different types can be included in a build. Processing reports of several inspections or duplicates tools in a single build is not supported. See the <a href="http://youtrack.jetbrains.com/issue/TW-14260" data-external="true" target="_blank" rel="noopener noreferrer">related feature request</a>.</p></aside></div></div><a name="Cancelingbuildviaservicemessage"></a><a name="Canceling-build-via-service-message"></a><div class="chapter"><h3 id="BuildScriptInteractionwithTeamCity-Cancelingbuildviaservicemessage">Canceling build via service message</h3><p id="90758a52">If you need to cancel a build from a script, for example, if a build cannot proceed normally due to the environment, or a build should be canceled form a subprocess, you can use the following service message:</p><div class="code-block" data-lang="bash">echo ##teamcity[buildStop comment='canceling comment' readdToQueue='true']

</div><p id="e69accf8">If required, you can re-add the build to the queue after canceling it.</p></div><a name="LibrariesreportingresultsviaTeamCityServiceMessages"></a><a name="Libraries-reporting-results-via-TeamCity-Service-Messages"></a><div class="chapter"><h3 id="BuildScriptInteractionwithTeamCity-LibrariesreportingresultsviaTeamCityServiceMessages">Libraries reporting results via TeamCity Service Messages</h3><p id="42a611e4">Several platform-specific libraries from JetBrains and external sources are able to report the results  via TeamCity Service messages.</p><ul class="list _ul"><li class="list__item" id="89179e1e"><p><a href="https://github.com/JetBrains/TeamCity.ServiceMessages" data-external="true" target="_blank" rel="noopener noreferrer">Service messages .NET library</a> - .NET library for generating (and parsing) TeamCity service messages from .NET applications. See a <a href="http://blog.jetbrains.com/teamcity/2011/10/teamcity-service-messages-library-for-net/" data-external="true" target="_blank" rel="noopener noreferrer">related blog post</a>.</p></li><li class="list__item" id="0c148d25"><p><a href="https://github.com/WilliamDoman/Jasmine2.0TeamCityReporter" data-external="true" target="_blank" rel="noopener noreferrer">Jasmine 2.0 TeamCity reporter</a> - support for emitting TeamCity service messages from Jasmine 2.0 reporter</p></li><li class="list__item" id="f83791c4"><p><a href="http://search.cpan.org/~thaljef/TAP-Formatter-TeamCity-0.04/" data-external="true" target="_blank" rel="noopener noreferrer">Perl TAP Formatter</a> - formatter for Perl to transform TAP messages to TeamCity service messages</p></li><li class="list__item" id="0d66dbfc"><p><a href="https://github.com/sebastianbergmann/phpunit/blob/9e86c85be3302eb125f15037ae6f496f62750a93/ChangeLog-5.0.md#500---2015-10-02" data-external="true" target="_blank" rel="noopener noreferrer">PHPUnit 5.0</a> - supports TeamCity service messages for tests. For earlier PHPUnit versions, the following external libraries can be used: <a href="https://github.com/realweb-team/deploytools" data-external="true" target="_blank" rel="noopener noreferrer">PHPUnit Listener 1</a>, <a href="https://github.com/maartenba/phpunit-runner-teamcity" data-external="true" target="_blank" rel="noopener noreferrer">PHPUnit Listener 2</a> - listeners which can be plugged via PHPUnit's<code class="code">suite.xml</code> to produce TeamCity service messages for tests.</p></li><li class="list__item" id="4afeff6a"><p><a href="https://pypi.python.org/pypi/teamcity-messages" data-external="true" target="_blank" rel="noopener noreferrer">Python Unit Test Reporting to TeamCity</a> - the package that automatically reports unit tests to the TeamCity server via service messages (when run under TeamCity and provided the testing code is adapted to use it).</p></li><li class="list__item" id="2be7c3d8"><p><a href="https://github.com/visionmedia/mocha" data-external="true" target="_blank" rel="noopener noreferrer">Mocha</a> - on-the-fly reporting via service messages for Mocha JavaScript testing framework. See the related <a href="http://richarddingwall.name/2012/06/17/running-mocha-browser-tests-in-teamcity/" data-external="true" target="_blank" rel="noopener noreferrer">post</a> with instructions.</p></li><li class="list__item" id="e49e1499"><p><a href="https://github.com/karma-runner/karma" data-external="true" target="_blank" rel="noopener noreferrer">Karma</a> - support in the JavaScript testing tool to report tests progress into TeamCity using TeamCity service messages</p></li></ul></div></div><a name="teamcity-info.xml"></a><a name="teamcity-info.xml"></a><div class="chapter"><h2 id="BuildScriptInteractionwithTeamCity-teamcity-info.xml">teamcity-info.xml</h2><p id="9abf32ed">As an obsolete approach, it is also possible to have the build script collect information, generate an XML file called <code class="code">teamcity-info.xml</code> in the root build directory. When the build finishes, this file will automatically be uploaded as a build artifact and processed by the TeamCity server.</p><p id="320a22de">Note that this approach <b id="77cf4157">can be discontinued</b> in the future TeamCity versions, so service messages approach is recommended instead. In case service messages does not work for you, let us know the details and describe the case via <a href="https://confluence.jetbrains.com/display/TW/Feedback" data-external="true" target="_blank" rel="noopener noreferrer">email</a>.</p><a name="ModifyingtheBuildStatus"></a><a name="Modifying-the-Build-Status"></a><div class="chapter"><h3 id="BuildScriptInteractionwithTeamCity-ModifyingtheBuildStatus">Modifying the Build Status</h3><p id="d64f525f">TeamCity has the ability to change the build status directly from the build script. You can set the status (build failure or success) and change the text of the build status (for example, note the number of failed tests if the test framework is not supported by TeamCity).</p><p id="6acaebaa"><a href="https://confluence.jetbrains.com/download/attachments/113084407/teamcity-info.xsd?version=1&amp;modificationDate=1271791190000&amp;api=v2" data-external="true" target="_blank" rel="noopener noreferrer">XML schema for teamcity-info.xml</a></p><p id="938432bd">It is possible to set the following information for the build:</p><p id="8a6f69e0"><b id="91e523aa">Build number</b> — Sets the new number for the finished build. You can reference the TeamCity-provided build number using {<code class="code">build.number</code>}.</p><p id="5c3d17fb"><b id="9f75fc18">Build status</b> — Change the build status. Supported values are "FAILURE" and "SUCCESS".</p><p id="7d94f5b4"><b id="9b7a9f86">Status text</b> — Modify the text of build status. You can replace the TeamCity-provided status text or add a custom part before or after the standard text. Supported <code class="code">action</code> values are "append", "prepend" and "replace".</p><p id="ed861a62">Example <code class="code">teamcity-info.xml</code> file:</p><div class="code-block" data-lang="markup">&lt;build number="1.0.{build.number}"&gt;
   &lt;statusInfo status="FAILURE"&gt; &lt;!-- or SUCCESS --&gt;
      &lt;text action="append"&gt; fitnesse: 45&lt;/text&gt;
      &lt;text action="append"&gt; coverage: 54%&lt;/text&gt;
   &lt;/statusInfo&gt;
&lt;/build&gt;

</div><aside class="note " data-title="" rel="62d1d859" id="ed5e5d91"><p id="7a7096aa">It is up to you to figure out how to retrieve test results that are not supported by TeamCity and accurately add them to the <code class="code">teamcity-info.xml</code> file.</p></aside></div><a name="ReportingCustomStatistics"></a><a name="Reporting-Custom-Statistics"></a><div class="chapter"><h3 id="BuildScriptInteractionwithTeamCity-ReportingCustomStatistics">Reporting Custom Statistics</h3><p id="8e3148a8">It is possible to provide <a href="customizing-statistics-charts.html">custom charts</a> in TeamCity. Your build can provide data for such graphs using <code class="code">teamcity-info.xml</code> file.</p><a name="Providingdatausingtheteamcity-info.xmlfile"></a><a name="Providing-data-using-the-teamcity-info.xml-file"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-Providingdatausingtheteamcity-info.xmlfile">Providing data using the teamcity-info.xml file</h4><p id="ef9366f9">This file should be created by the build in the root directory of the build. You can publish multiple statistics (see the details on the data format below) and create separate charts for each set of values.</p><p id="f2a144ec">The <code class="code">teamcity-info.xml</code> file is to contain the code in the following format (you can combine various data in the <code class="code">teamcity-info.xml</code> file):</p><div class="code-block" data-lang="markup">&lt;build&gt;
   &lt;statisticValue key="chart1Key" value="342"/&gt;
   &lt;statisticValue key="chart2Key" value="53"/&gt;
&lt;/build&gt;

</div><p id="c93a57dc">The <code class="code">key</code> should not be equal to any of <a href="customizing-statistics-charts.html#Modifying-Pre-defined-Project-level-Charts">predefined keys</a>. The <code class="code">value</code> should be a positive/negative integer of up to 13 digits. Float values with up to 6 decimal places are supported.</p><p id="e880c377">The key here relates to the key of the <b id="8198ac9b">valueType</b> tag used when describing the chart.</p></div><a name="Describingcustomcharts"></a><a name="Describing-custom-charts"></a><div class="chapter"><h4 id="BuildScriptInteractionwithTeamCity-Describingcustomcharts">Describing custom charts</h4><p id="0d834f8e">See <a href="customizing-statistics-charts.html">Customizing Statistics Charts</a> page for detailed description.</p><hr id="c6a82d96"></div></div></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>