<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>MSTest Support - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="MSTest Support" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-unit-testing-and-code-coverage.md|Configuring Unit Testing and Code Coverage/net-testing-frameworks-support.md|.NET Testing Frameworks Support/mstest-support.md|MSTest Support" data-main-title="MSTest Support" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/mstest-support.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="MSTest Support" id="mstest-support.md">MSTest Support</h1><aside class="note " data-title="" rel="mstest-support.md" id="227e6008"><p id="a0bd1198">The MSTest runner is merged into the <a href="visual-studio-tests.html">Visual Studio Tests</a> runner.</p></aside><p id="ebd7611c">TeamCity provides support for MSTest 2005-2015 testing framework via parsing of the MSTest results file (<code class="code">.trx</code> file). The appropriate Microsoft Visual Studio edition installed on the build agent is required.</p><p id="9fad8a04">Due to specifics of MSTest tool, TeamCity does <b id="da5c759f">not</b> support on-the-fly test reporting for MSTest. All test results are imported <b id="f09aea99">after</b> the tests run has finished.</p><p id="b7ee5920">There are two ways to report test results to TeamCity:</p><ul class="list _ul"><li class="list__item" id="3a225ff2"><p>Add the <a href="visual-studio-tests.html">Visual Studio Tests</a> runner as one of your build steps.</p></li><li class="list__item" id="274d725c"><p>Configure <a href="xml-report-processing.html">XML Report Processing</a> via build feature or via <a href="build-script-interaction-with-teamcity.html#Service-Messages">service message</a> to parse the <code class="code">.trx</code> reports that are produced by your build procedure.</p></li></ul><p id="9e3a87bc">The easiest way to set up MSTest tests reporting in TeamCity is to add the <a href="visual-studio-tests.html">Visual Studio Tests</a> build runner as one of the steps to your build configuration and specify there all required parameters.</p><p id="8605f32c">If the tests are already run within your build script and MSTest generates <code class="code">.trx</code> reports, you can configure <a href="build-script-interaction-with-teamcity.html#Service-Messages">service messages</a> to parse the reports.</p><a name="AutodetectionofMSTest"></a><a name="Autodetection-of-MSTest"></a><div class="chapter"><h2 id="MSTestSupport-AutodetectionofMSTest">Autodetection of MSTest</h2><p id="a151ce6f"><b id="590fafb9">Prior to TeamCity 9.1</b> the MSTest location was reported as system properties: <code class="code">%system.MSTest.8.0%</code>, <code class="code">%system.MSTest.9.0%</code>, <code class="code">%system.MSTest.10.0%</code>, <code class="code">%system.MSTest.11.0%</code>, <code class="code">%system.MSTest.12.0%</code>, <code class="code">%system.MSTest.14.0%</code> that referred to MSTest <code class="code">2008</code>, <code class="code">2010</code>, <code class="code">2012</code>, <code class="code">2013</code>, <code class="code">2015</code> correspondingly.</p><p id="dce65b60"><b id="5fc7725a">Since TeamCity 9.1</b> system parameters of the <code class="code">%system.MSTest.xx.yy%</code> format were changed to configuration parameters of the <code class="code">%teamcity.dotnet.mstest.xx.yy%</code> format.</p><p id="61bb6b3e">If system properties are required for the build, the <a href="https://youtrack.jetbrains.com/issue/TW-41845" data-external="true" target="_blank" rel="noopener noreferrer">mstest-legacy-provider</a> plugin can be used.</p><p id="709972aa">TeamCity auto-detects MSTest based on the registry values that describe the Visual Studio installation path. If Visual Studio is installed in a non-standard location, or the registry key is corrupted, or the TeamCity agent has no access to the VisualStudio directory, TeamCity may not be able to detect MSTest. In this case, the corresponding configuration parameter of the <code class="code">%teamcity.dotnet.mstest.xx.yy%</code> format must be added to the build manually. It should contain the full path including the <code class="code">MSTest.exe</code> executable, for example, the default path for MSTest 2013 is <code class="code">C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\IDE\MSTest.exe</code>.</p><hr id="a72671af"><p id="7683b217"><b id="f09d9f78">See also:</b></p><p id="d4413831"><b id="0d9ae072">Concepts</b>: <a href="testing-frameworks.html">Testing Frameworks</a><br><b id="d65214d7">Administrator's Guide</b>: <a href="nunit-support.html">NUnit Support</a></p><hr id="8ad75826"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>