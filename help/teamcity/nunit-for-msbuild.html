<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>NUnit for MSBuild - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="NUnit for MSBuild" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-unit-testing-and-code-coverage.md|Configuring Unit Testing and Code Coverage/net-testing-frameworks-support.md|.NET Testing Frameworks Support/nunit-support.md|NUnit Support/nunit-for-msbuild.md|NUnit for MSBuild" data-main-title="NUnit for MSBuild" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/nunit-for-msbuild.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="NUnit for MSBuild" id="nunit-for-msbuild.md">NUnit for MSBuild</h1><p id="b03a6712">This page describes how to use NUnit from MS build.</p><ul class="list _ul"><li class="list__item" id="be417515"><p>for <b id="986e9ebc">NUnit prior to 3.0</b> see <a href="#Working-with-NUnit-Task-in-MSBuild-Build">Working with TeamCity-provided NUnit task</a></p></li><li class="list__item" id="e478a43b"><p>for <b id="ae6b2b61">NUnit 3.0 and above</b> see <a href="#Working-with-NUnit-3.0">Working with NUnit 3.0</a></p></li></ul><a name="WorkingwithNUnitTaskinMSBuildBuild"></a><a name="Working-with-NUnit-Task-in-MSBuild-Build"></a><div class="chapter"><h2 id="NUnitforMSBuild-WorkingwithNUnitTaskinMSBuildBuild">Working with NUnit Task in MSBuild Build</h2><p id="35b260e6">The information in this section is applicable if you are using <b id="1a88ac56">NUnit prior to version 3.0</b>. For later versions, refer to the <a href="#Working-with-NUnit-3.0">section below</a>.</p><p id="909f6fdc">This section assumes that you already have an MSBuild build script with a configured <code class="code">NUnit</code> task in it, and want TeamCity to track test reports without making any changes to the existing build script. Otherwise, consider adding <a href="nunit.html">NUnit build runner</a> as one of the steps for your build configuration.</p><a name="UsingNUnitTeamCitytaskinMSBuildBuildScript"></a><a name="Using-NUnitTeamCity-task-in-MSBuild-Build-Script"></a><div class="chapter"><h3 id="NUnitforMSBuild-UsingNUnitTeamCitytaskinMSBuildBuildScript">Using NUnitTeamCity task in MSBuild Build Script</h3><p id="9cc3046b">TeamCity provides a custom <code class="code">NUnitTeamCity</code> task compatible with the <code class="code">NUnit</code> task from <a href="http://msbuildtasks.tigris.org/" data-external="true" target="_blank" rel="noopener noreferrer">MSBuild Community tasks</a> project. If you provide the <code class="code">NUnitTeamCity</code> task in your build script, TeamCity will launch its own test runner based on the options specified within the task. Thus, you do not need to have any NUnit runner, because TeamCity will run the tests.</p><p id="bb091203">In order to correctly use the <code class="code">NUnitTeamCity</code> task, perform the following steps:</p><ol class="list _decimal"><li class="list__item" id="ebbec700"><p>Make sure the <code class="code">teamcity_dotnet_nunitlauncher</code> system property is accessible on build agents. Build agents running Windows should automatically detect these properties as environment variables. If you need to set them manually, see defining <a href="project-and-agent-level-build-parameters.html#Agent-Level-Build-Parameters">agent-specific</a> properties for more information.</p></li><li class="list__item" id="e2a30afb"><p>Configure your MSBuild build script with the <code class="code">NUnitTeamCity</code> task using the following syntax:<div class="code-block" data-lang="markup">&lt;UsingTask TaskName="NUnitTeamCity" AssemblyFile="$(teamcity_dotnet_nunitlauncher_msbuild_task)" /&gt;

&lt;NUnitTeamCity Assemblies="@(assemblies_to_test)" /&gt;

</div></p></li></ol><p id="ecde033c">The <code class="code">NUnitTeamCity</code> task supports the following attributes:</p><div class="table-wrapper"><table width="100%" id="7156d1be"><thead><tr id="930f19c0" class="ijRowHead"><th width="200" id="8db399ff"><p id="364421b5">Property</p></th><th id="ed9842b4"><p id="6fa9958c">Description</p></th></tr></thead><tbody><tr id="19c55547" class="ijRowOdd"><td id="ffc10097"><p id="8b16b03c"><code class="code">Platform</code></p></td><td id="fa2fe6c5"><p id="cf2321d6">Execution mode on a x64 machine. Supported values are: <b id="318ef710">x86</b>, <b id="4855d467">x64</b>, and <b id="163127e9">ANY</b>.</p></td></tr><tr id="7b5dc14a" class="ijRowEven"><td id="7a57357d"><p id="905f288d"><code class="code">RuntimeVersion</code></p></td><td id="c413ea80"><p id="6f5999fa">.NET Framework to use: <b id="c7967528">v1.1</b>, <b id="50f6a6b3">v2.0</b>, <b id="146a005c">v4.0</b>, <b id="16c780a0">ANY</b>. By default, the MSBuild runtime is used. Default is <b id="193bf69a">v2.0</b> for MSBuild 2.0 and 3.5. For MSBuild 4.0 the default value is <b id="3bdac802">v4.0</b>.</p></td></tr><tr id="001a6be5" class="ijRowOdd"><td id="b1d81035"><p id="d6e2e1eb"><code class="code">IncludeCategory</code></p></td><td id="541b5ebe"><p id="8ffa4c81">As used in the <code class="code">NUnit</code> task from <a href="http://msbuildtasks.tigris.org/" data-external="true" target="_blank" rel="noopener noreferrer">MSBuild Community tasks</a> project.</p></td></tr><tr id="7248dd62" class="ijRowEven"><td id="21301c27"><p id="b0d84ce9"><code class="code">ExcludeCategory</code></p></td><td id="d139116f"><p id="80d235f2">As used in the <code class="code">NUnit</code> task from <a href="http://msbuildtasks.tigris.org/" data-external="true" target="_blank" rel="noopener noreferrer">MSBuild Community tasks</a> project.</p></td></tr><tr id="3fe91d50" class="ijRowOdd"><td id="a4065b47"><p id="579a97db"><code class="code">NUnitVersion</code></p></td><td id="22a6b791"><p id="e8e09dbf">Version of NUnit to be used to run the tests. Supported NUnit versions: <b id="52e73611">2.2.10</b>, <b id="d9669488">2.4.1</b>, <b id="427553db">2.4.6</b>, <b id="72b1f041">2.4.7</b>, <b id="cfb378e6">2.4.8</b>, <b id="ea62051f">2.5.0</b>, <b id="29febc6b">2.5.2</b>, <b id="9da62e20">2.5.3</b>, <b id="21c4832d">2.5.4</b>, <b id="3792b922">2.5.5</b>, <b id="95edc374">2.5.6</b>, <b id="ca941792">2.5.7</b>, <b id="af0067b9">2.5.8</b>, <b id="97875fba">2.5.9</b>, <b id="0a510b44">2.5.10</b>, <b id="749fd1f0">2.6.0</b>, <b id="91e609be">2.6.1</b>,<b id="9d65b8fa">2.6.2</b>, <b id="05c11690">2.6.3</b>. For example, <code class="code">NUnit-2.2.10</code>.</p><p id="cdfefe53">To use NUnit 3.0 and above, see the <a href="#Working-with-NUnit-3.0">section below</a>.</p></td></tr><tr id="ea0d70ae" class="ijRowEven"><td id="294e3d20"><p id="de0d1a5b"><code class="code">Addins</code></p></td><td id="5fb82fd5"><p id="842228b4">List of third-party NUnit addins to be used. For more information on using NUnit addins, refer to the <a href="nunit-addins-support.html">NUnit Addins Support</a> page.</p></td></tr><tr id="bbb48c2b" class="ijRowOdd"><td id="bad87667"><p id="3f8e91af"><code class="code">HaltIfTestFailed</code></p></td><td id="43503853"><p id="e5c5339b"><b id="971cff63">True</b> to fail task, if any test fails.</p></td></tr><tr id="324d613c" class="ijRowEven"><td id="3664d34f"><p id="32b71d46"><code class="code">Assemblies</code></p></td><td id="22a8fd67"><p id="7ed9cbcd">List of assemblies to run tests with.</p></td></tr><tr id="74574e63" class="ijRowOdd"><td id="070e6b52"><p id="ebaf4859"><code class="code">RunProcessPerAssembly</code></p></td><td id="ecfb781f"><p id="a0113d0c">Set <b id="b5585e33">true</b>, if you want to run each assembly in a new process.</p></td></tr></tbody></table></div><p id="ed1aa333">The custom TeamCity <code class="code">NUnit</code> task also supports additional attributes. For the list of available attributes refer to <a href="#Using-NUnitTeamCity-task-in-MSBuild-Build-Script">this section</a>.</p><p id="0a91ffab">If you need the TeamCity test runner to support third-party NUnit addins, refer to the <a href="nunit-addins-support.html">NUnit Addins Support</a> section for the details.</p><p id="5f5c6271">Example (part of the MSBuild build script):</p><div class="code-block" data-lang="markup">&lt;Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003"&gt;
  &lt;UsingTask TaskName="NUnitTeamCity" AssemblyFile="$(teamcity_dotnet_nunitlauncher_msbuild_task)"/&gt;
 
  &lt;Target Name="SayHello"&gt;
     &lt;NUnitTeamCity Assemblies="!!!*put here item group of assemblies to run tests on*!!!"/&gt;
  &lt;/Target&gt;
&lt;/Project&gt;

</div><p id="39f5da63"><b id="f614801f">Important notes</b></p><ul class="list _ul"><li class="list__item" id="4b3b64b8"><p>Be sure to replace "<code class="code">.</code>" with "<code class="code">_</code>" when <a href="configuring-build-parameters.html#Using-Build-Parameters-in-the-Build-Scripts">using System Properties</a> in MSBuild scripts. For example, use <code class="code">teamcity_dotnet_nunitlauncher_msbuild_task</code> instead of <code class="code">teamcity.dotnet.nunitlauncher.msbuild.task</code>.</p></li><li class="list__item" id="7663794e"><p>TeamCity also provides <a href="visual-studio-sln.html">Visual Studio Solution Runner</a> for solution files of Microsoft Visual Studio 2005 and above. It allows you to use MSBuild-style wildcards for the assemblies to run unit tests on.</p></li></ul></div><a name="Examples"></a><a name="Examples"></a><div class="chapter"><h3 id="NUnitforMSBuild-Examples">Examples</h3><p id="238979fe">Run NUnit tests using specific NUnit runner version:</p><div class="code-block" data-lang="markup">&lt;Target Name="build_01"&gt;
     &lt;!-- start tests for NUnit-2.2.10 --&gt;
     &lt;NUnitTeamCity Assemblies="@(TestAssembly)" NUnitVersion="NUnit-2.2.10"/&gt;
 
     &lt;!-- start tests for NUnit-2.4.6 --&gt;
     &lt;NUnitTeamCity Assemblies="@(TestAssembly)" NUnitVersion="NUnit-2.4.8"/&gt;
  &lt;/Target&gt;

</div><p id="d1779a0e">Run NUnit tests with custom addins with NUnit 2.4.6:</p><div class="code-block" data-lang="markup">&lt;Target Name="build"&gt;
     &lt;NUnitTeamCity Assemblies="@(TestAssembly)" Addins="NUnitExtension.RowTest.AddIn.dll" NUnitVersion="NUnit-2.4.6"/&gt;
  &lt;/Target&gt;

</div><p id="e049e04a">Run NUnit tests with custom addins with NUnit 2.4.6 <b id="039aca43">in per-assembly mode:</b></p><div class="code-block" data-lang="markup">&lt;Target Name="build"&gt;
     &lt;NUnitTeamCity Assemblies="@(TestAssembly)" Addins="NUnitExtension.RowTest.AddIn.dll" NUnitVersion="NUnit-2.4.6" RunProcessPerAssembly="True"/&gt;
&lt;/Target&gt;

</div><p id="a8cb36d2">To make a TeamCity independent build script, consider the following trick:</p><div class="code-block" data-lang="markup">&lt;NUnitTeamCity ... Condition=" '$(TEAMCITY_VERSION)' != '' "/&gt;

</div><p id="5c549637">The MSBuild property <code class="code">TEAMCITY_VERSION</code> is added to msbuild when started from TeamCity.</p></div></div><a name="WorkingwithNUnit3.0"></a><a name="Working-with-NUnit-3.0"></a><div class="chapter"><h2 id="NUnitforMSBuild-WorkingwithNUnit3.0">Working with NUnit 3.0</h2><p id="c456f4e1">The information in this section is applicable if you are using NUnit 3.0 and above. For earlier versions of NUnit, refer to the <a href="#Working-with-NUnit-Task-in-MSBuild-Build">section above</a>.</p><p id="c1336175">Starting from version 3.0, NUnit supports TeamCity natively, so there is no need to use a special task for MSBuild as it was done for the <a href="#Working-with-NUnit-Task-in-MSBuild-Build">earlier NUnit versions</a>. The simplest way is to run the NUnit console via the standard <a href="https://msdn.microsoft.com/en-us/library/x8zx72cd.aspx" data-external="true" target="_blank" rel="noopener noreferrer">Exec task</a>. For example:</p><a name="msbuild-examples-nunit"></a><div class="code-block" data-lang="bash">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Project ToolsVersion="14.0" DefaultTargets="RunTests" xmlns="http://schemas.microsoft.com/developer/msbuild/2003"&gt;
&nbsp;&lt;Target Name="RunTests"&gt;
&nbsp;&nbsp;&lt;Exec IgnoreExitCode="True" Command="nunit3-console.exe Tests.dll"&gt;
&nbsp;&lt;Output TaskParameter="ExitCode" ItemName="exitCode" /&gt;
&nbsp;&nbsp;&lt;/Exec&gt;
&nbsp;&lt;Error Text="Error while running tests" Condition="@(exitCode) &amp;lt; 0" /&gt;
&nbsp;&nbsp;&lt;/Target&gt;
&lt;/Project&gt;

</div><p id="95686222">The NUnit console returns the number of failed tests as the positive exit code and, in case of the NUnit test infrastructure failure, as the negative exit code.</p><p id="201d2b79">TeamCity controls the test execution progress, but the NUnit infrastructure exceptions may not allow TeamCity to collect the required information. That is why the <code class="code">IgnoreExitCode="True"</code> attribute needs to be set, which will ignore the positive exit codes and will not interrupt the build due to several failed tests. The <a href="https://msdn.microsoft.com/en-us/library/8b08t3s4.aspx" data-external="true" target="_blank" rel="noopener noreferrer">Error</a> task will stop the build in case of the test infrastructure errors for the negative exit codes.</p><p id="5a1f172f"><figure><img alt="Build step: MSBuild" title="Build step: MSBuild" src="/help/img/teamcity/2019.1/nunit-msbuild.png" id="ff434f33" width="830" height="1149"></figure></p><p id="af69275e">Besides the project file, you can define the MSBuild version and target platform, use profiles and other settings.</p><aside class="note " data-title="" rel="af69275e" id="3a9836f8"><p id="a12b0a28">The MSBuild runner option <a href="msbuild.html#General-Build-Runner-Options">Reduce test failure feedback time</a> <b id="80628f66">will not work</b> out of the box in this case. To use this feature, configure the <a href="nunit.html">NUnit</a> build step.</p></aside><p id="617d9685"><a href="getting-started-with-nunit.html">Getting Started with NUnit</a> contains details and more examples.</p><hr id="e208fd64"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>