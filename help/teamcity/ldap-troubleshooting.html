<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>LDAP故障排除-帮助|团队城市</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="LDAP Troubleshooting" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/teamcity-configuration-and-maintenance.md|TeamCity Configuration and Maintenance/configuring-authentication-settings.md|Configuring Authentication Settings/ldap-integration.md|LDAP Integration/ldap-troubleshooting.md|LDAP Troubleshooting" data-main-title="LDAP Troubleshooting" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/ldap-troubleshooting.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="ldap-troubleshooting.md" data-toc="LDAP Troubleshooting">LDAP故障排除</h1><p id="d519f088"><b id="9978e524">一般建议</b> ：如果您在LDAP配置方面遇到问题，请打开调试日志记录（请参阅<a href="reporting-issues.html">报告问题</a> ）。</p><p id="1ef7ee5e">在此页：</p><p id="45f176e6"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#LDAPTroubleshooting-CannotauthenticateusingLDAP">无法使用LDAP进行身份验证</a></li><li class="list__item"><a href="#LDAPTroubleshooting-UsersinLDAParestoredindifferentbranches,sotheteamcity.auth.formatDNpropertycantbeapplied.Howcantheusersloginwiththeirusernames?">LDAP中的用户存储在不同的分支中，因此无法应用teamcity.auth.formatDN属性。用户如何使用他们的用户名登录？</a></li></ul><p></p><a name="CannotauthenticateusingLDAP"></a><a name="Cannot-authenticate-using-LDAP"></a><div class="chapter"><h2 id="LDAPTroubleshooting-CannotauthenticateusingLDAP">无法使用LDAP进行身份验证</h2><p id="4985e1ad">检查<code class="code">teamcity-ldap.log</code>文件。对于每次失败的登录尝试，都应指定一个原因。最常见的是：</p><ul class="list _ul"><li class="list__item" id="1938db8c"><p>登录过滤器与输入的登录名不匹配（“ <i id="9fda8c2c">用户输入的登录名与teamcity.auth.loginFilter = ...不匹配，正在中止</i> ”）</p></li><li class="list__item" id="644bfea6"><p>LDAP服务器使用“无效的凭据”消息拒绝登录（“ <i id="9eb9856a">由于身份验证错误，无法登录用户'...'。原因：无效的凭据（[LDAP：错误代码49-80090308：LdapErr：DSID-0C090334，注释：AcceptSecurityContext错误，数据525，vece ^ @]）</i> “）</p></li></ul><p id="9823551e">第一个原因意味着该登录名不能与某个过滤器匹配，因此无法用于登录。例如，默认情况下，您无法使用<code class="code">DOMAIN\username</code> -过滤器禁止<code class="code">/</code> ， <code class="code">\</code>和<code class="code">@</code>符号。见<code class="code">teamcity.auth.loginFilter</code>属性。</p><p id="3faa0d3a">第二个错误可能是由多种原因引起的，例如：</p><ul class="list _ul"><li class="list__item" id="bf97b2fa"><p>您正在尝试使用用户名登录，但是LDAP服务器仅接受完整的DN。<br>如果所有用户都存储在一个LDAP分支中，请使用<code class="code">teamcity.auth.formatDN</code>属性。否则，请参见以下部分。</p></li><li class="list__item" id="8867dcbd"><p>从日志中检查您的DN和实际的主体，可能是拼写错误或未转义的序列。尝试使用另一个LDAP工具以该主体登录。</p></li><li class="list__item" id="770ef747"><p>尝试更改安全级别（ <code class="code">java.naming.security.authentication</code> ）：可以是“简单”，“强”或“无”。</p></li></ul></div><a name="UsersinLDAParestoredindifferentbranches,sotheteamcity.auth.formatDNpropertycantbeapplied.Howcantheusersloginwiththeirusernames?"></a><a name="Users-in-LDAP-are-stored-in-different-branches,-so-the-teamcity.auth.formatDN-property-can-t-be-applied.-How-can-the-users-login-with-their-usernames?"></a><div class="chapter"><h2 id="LDAPTroubleshooting-UsersinLDAParestoredindifferentbranches,sotheteamcity.auth.formatDNpropertycantbeapplied.Howcantheusersloginwiththeirusernames?">LDAP中的用户存储在不同的分支中，因此无法应用teamcity.auth.formatDN属性。用户如何使用他们的用户名登录？</h2><p id="9910c0a4">从5.0版开始提供此功能。您应指定查找用户的方式（ <code class="code">teamcity.users.login.filter</code> ），例如通过用户名或电子邮件。在每次登录时，TeamCity在登录<i id="d86d9894">之前都会</i>在LDAP中找到用户，获取用户DN，然后执行绑定。因此，您还必须定义TeamCity的凭据才能执行搜索操作（ <code class="code">java.naming.security.principal</code>和<code class="code">java.naming.security.credentials</code> ）。</p><hr id="ce0653e3"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>