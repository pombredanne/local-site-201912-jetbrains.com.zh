<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>LDAP Troubleshooting - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="LDAP Troubleshooting" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/teamcity-configuration-and-maintenance.md|TeamCity Configuration and Maintenance/configuring-authentication-settings.md|Configuring Authentication Settings/ldap-integration.md|LDAP Integration/ldap-troubleshooting.md|LDAP Troubleshooting" data-main-title="LDAP Troubleshooting" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/ldap-troubleshooting.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="LDAP Troubleshooting" id="ldap-troubleshooting.md">LDAP Troubleshooting</h1><p id="d519f088"><b id="9978e524">General advice</b>: if you experience problems with LDAP configuration, turn on the debug logging (see <a href="reporting-issues.html">Reporting Issues</a>).</p><p id="1ef7ee5e">On this page:</p><p id="45f176e6"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#LDAPTroubleshooting-CannotauthenticateusingLDAP">Cannot authenticate using LDAP</a></li><li class="list__item"><a href="#LDAPTroubleshooting-UsersinLDAParestoredindifferentbranches,sotheteamcity.auth.formatDNpropertycantbeapplied.Howcantheusersloginwiththeirusernames?">Users in LDAP are stored in different branches, so the teamcity.auth.formatDN property can't be applied. How can the users login with their usernames?</a></li></ul></p><a name="CannotauthenticateusingLDAP"></a><a name="Cannot-authenticate-using-LDAP"></a><div class="chapter"><h2 id="LDAPTroubleshooting-CannotauthenticateusingLDAP">Cannot authenticate using LDAP</h2><p id="4985e1ad">Check the <code class="code">teamcity-ldap.log</code> file. For each unsuccessful login attempt there should be a reason specified. Most commonly these are:</p><ul class="list _ul"><li class="list__item" id="1938db8c"><p>The login filter doesn't match the entered login ("<i id="9fda8c2c">User-entered login does not match teamcity.auth.loginFilter=..., aborting</i>")</p></li><li class="list__item" id="644bfea6"><p>The LDAP server rejected login with the "Invalid credentials" message ("<i id="9eb9856a">Failed to login user '...' due to authentication error. Cause: Invalid credentials ([LDAP: error code 49 - 80090308: LdapErr: DSID-0C090334, comment: AcceptSecurityContext error, data 525, vece^@])</i>")</p></li></ul><p id="9823551e">The first reason means that the login can't be used for signing in because it doesn't match a certain filter. For example, by default you can't login with <code class="code">DOMAIN\username</code> - the filter forbids <code class="code">/</code>, <code class="code">\</code> and <code class="code">@</code> symbols. See the <code class="code">teamcity.auth.loginFilter</code> property.</p><p id="3faa0d3a">The second error can be caused by various things, for example:</p><ul class="list _ul"><li class="list__item" id="bf97b2fa"><p>You are trying to login with your username, but LDAP server accepts only full DNs.<br>If all users are stored in one LDAP branch, use the <code class="code">teamcity.auth.formatDN</code> property. Otherwise, see the section below.</p></li><li class="list__item" id="8867dcbd"><p>Check your DN and the actual principal from the logs, probably there is a typo or an unescaped sequence. Try to log in with this principal using another LDAP tool.</p></li><li class="list__item" id="770ef747"><p>Try changing the security level (<code class="code">java.naming.security.authentication</code>): it can be "simple", "strong" or "none".</p></li></ul></div><a name="UsersinLDAParestoredindifferentbranches,sotheteamcity.auth.formatDNpropertycantbeapplied.Howcantheusersloginwiththeirusernames?"></a><a name="Users-in-LDAP-are-stored-in-different-branches,-so-the-teamcity.auth.formatDN-property-can-t-be-applied.-How-can-the-users-login-with-their-usernames?"></a><div class="chapter"><h2 id="LDAPTroubleshooting-UsersinLDAParestoredindifferentbranches,sotheteamcity.auth.formatDNpropertycantbeapplied.Howcantheusersloginwiththeirusernames?">Users in LDAP are stored in different branches, so the teamcity.auth.formatDN property can't be applied. How can the users login with their usernames?</h2><p id="9910c0a4">This feature is available from version 5.0. You should specify how you want to find the user (<code class="code">teamcity.users.login.filter</code>), for example, by the username or email. On each login TeamCity finds the user in LDAP <i id="d86d9894">before</i> logging in, fetches the user DN and then performs the bind. Thus, you must also define the credentials for TeamCity to perform search operations (<code class="code">java.naming.security.principal</code> and <code class="code">java.naming.security.credentials</code>).</p><hr id="ce0653e3"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>