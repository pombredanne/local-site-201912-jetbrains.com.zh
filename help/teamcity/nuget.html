<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>NuGet-帮助|团队城市</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="NuGet" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/nuget.md|NuGet/using-teamcity-as-nuget-feed.md|Using TeamCity as NuGet Feed" data-main-title="NuGet" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/nuget.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="nuget.md" data-toc="NuGet">NuGet</h1><p id="28f2c06a">在此页：</p><p id="d9104754"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#NuGet-IntegrationCapabilities">整合能力</a></li><li class="list__item"><a href="#NuGet-TypicalUsageScenarios">典型使用场景</a></li><li class="list__item"><a href="#NuGet-InstallingNuGettoTeamCityagents">将NuGet安装到TeamCity代理</a></li><li class="list__item"><a href="#NuGet-NuGetPackagesCacheClean-uponAgents">NuGet软件包对代理的缓存清理</a></li><li class="list__item"><a href="#NuGet-AuthenticationinprivateNuGetFeeds">私人NuGet Feed中的身份验证</a></li><li class="list__item"><a href="#NuGet-ProxyConfiguration">代理配置</a></li></ul><p></p><a name="IntegrationCapabilities"></a><a name="Integration-Capabilities"></a><div class="chapter"><h2 id="NuGet-IntegrationCapabilities">整合能力</h2><p id="a21655ea">TeamCity与<a href="https://github.com/nuget/home" rel="noopener noreferrer" data-external="true" target="_blank">NuGet</a>软件包管理器集成，并且在<a href="#Installing-NuGet-to-TeamCity-agents">安装NuGet</a>时提供以下功能：</p><ul class="list _ul"><li class="list__item" id="84315410"><p><a href="using-teamcity-as-nuget-feed.html">私有NuGet提要</a>基于构建的已发布工件。</p></li><li class="list__item" id="09e88787">当代理上安装了<a href="http://www.mono-project.com/docs/getting-started/install/" rel="noopener noreferrer" data-external="true" target="_blank">Mono</a>时，将在Windows OS以及Linux和MacOS的版本中使用一组NuGet运行程序。<ul class="list _ul"><li class="list__item" id="4555e291"><p><a href="nuget-installer.html">NuGet Installer</a>构建运行<a href="nuget-installer.html">程序</a> ，用于安装和更新NuGet软件包。</p></li><li class="list__item" id="1ff7d414"><p><a href="nuget-pack.html">NuGet Pack</a>构建运行器，用于构建NuGet软件包。</p></li><li class="list__item" id="e3dd03d5"><p><a href="nuget-publish.html">NuGet Publish</a>构建运行器，它将程序包发布到您选择的提要中。</p></li></ul></li><li class="list__item" id="8c47c32e"><p><a href="nuget-dependency-trigger.html">NuGet依赖关系</a>触发器，它允许在NuGet feed更新上触发构建。</p></li></ul><aside class="note " rel="e6cfb4c6" id="17612647" data-title=""><p id="6fd03f4c"><b id="be506d4a">支持的操作系统</b></p><p id="8db35075">默认情况下，运行Windows操作系统的构建代理支持NuGet构建运行程序。当代理上安装了<a href="http://www.mono-project.com/docs/getting-started/install/" rel="noopener noreferrer" data-external="true" target="_blank">Mono</a>时，将支持Linux和macOS（仅支持Mono 4.4.2+上的NuGet 3.3+）。</p></aside><aside class="note " rel="NuGet-IntegrationCapabilities" id="dd9dbc06" data-title=""><ul class="list _ul"><li class="list__item" id="80bd281b">根据NuGet.exe版本，NuGet构建运行程序需要在代理计算机上安装的.NET Framework上具有适当的版本：<ul class="list _ul"><li class="list__item" id="f492f9ba"><p>NuGet 2.8.6+版本需要.NET 4.5+</p></li><li class="list__item" id="a291f3ea"><p><2.8.6的NuGet版本需要.NET 4.0。</p></li></ul></li><li class="list__item" id="1e12de4e"><p>要使用经过身份验证的Feed中的程序包，请参阅<a href="nuget-feed-credentials.html">NuGet Feed Credentials</a>构建功能。</p></li></ul></aside></div><a name="TypicalUsageScenarios"></a><a name="Typical-Usage-Scenarios"></a><div class="chapter"><h2 id="NuGet-TypicalUsageScenarios">典型使用场景</h2><ul class="list _ul"><li class="list__item" id="313f0316"><p>要从公共提要中安装软件包，请添加<a href="nuget-installer.html">NuGet Installer</a>构建步骤。</p></li><li class="list__item" id="38994779"><p>要创建包并将其发布到公共提要，请添加<a href="nuget-pack.html">NuGet Pack</a>和<a href="nuget-publish.html">NuGet Publish</a>构建步骤。</p></li><li class="list__item" id="9dfd615f"><p>要创建一个程序包并将其发布到内部TeamCity NuGet服务器，请启用TeamCity作为NuGet服务器（请参见<a href="using-teamcity-as-nuget-feed.html">专用页面</a> ），使用<a href="nuget-pack.html">NuGet Pack</a>构建步骤和<a href="nuget-publish.html">NuGet Publish</a>构建步骤。</p></li><li class="list__item" id="8123d418"><p>要在更新NuGet软件包时触发新的构建，请使用<a href="nuget-dependency-trigger.html">NuGet依赖关系触发器</a> 。</p></li></ul></div><a name="InstallingNuGettoTeamCityagents"></a><a name="Installing-NuGet-to-TeamCity-agents"></a><div class="chapter"><h2 id="NuGet-InstallingNuGettoTeamCityagents">将NuGet安装到TeamCity代理</h2><p id="032c2980">NuGet触发器和与NuGet相关的构建运行器需要在服务器上配置的NuGet命令行二进制文件。配置完成后，它们会自动分发给代理。可以安装多个版本，可以将您选择的版本设置为默认版本。</p><aside class="tip sideblock" rel="032c2980" id="79076f9d" data-title=""><p id="dc87132b">建议使用NuGet的发行版本。</p></aside><p id="6739f77a">安装<code class="code">NuGet.exe</code>在TeamCity上：</p><ol class="list _decimal"><li class="list__item" id="7d76050f"><p>转到<b id="dab71d06">管理|工具</b>标签。</p></li><li class="list__item" id="d91ca270"><p>单击<b id="30d51e68">安装工具，然后选择NuGet.exe</b> 。</p></li><li class="list__item" id="42063e98">选择您是要从公共供稿中下载（默认）NuGet，还是要上传自己的包含以下内容的NuGet包： <code class="code">NuGet.exe</code> 。<ul class="list _ul"><li class="list__item" id="8ba28c75"><p>如果选择了<b id="0a04152f">下载</b>单选按钮，请指定要在所有构建代理上安装的NuGet版本。</p></li><li class="list__item" id="e83a1f58"><p>如果选择了上<b id="a579a09d">载</b>单选按钮，请指定您自己的NuGet软件包。</p></li></ul></li><li class="list__item" id="c27ca3fb"><p>使用相关复选框，指定此NuGet版本是否为默认版本。</p></li><li class="list__item" id="907f4f2a"><p>单击“ <b id="e04722a9">添加”</b>以安装所选的NuGet版本。</p></li></ol><aside class="tip sideblock" rel="b5f5b8b6" id="0718535c" data-title=""><p id="8f6c0000">在代理上安装NuGet会导致代理升级。</p></aside></div><a name="NuGetPackagesCacheClean-uponAgents"></a><a name="NuGet-Packages-Cache-Clean-up-on-Agents"></a><div class="chapter"><h2 id="NuGet-NuGetPackagesCacheClean-uponAgents">NuGet软件包对代理的缓存清理</h2><p id="fe948bae">NuGet使用多个本地缓存来避免下载已安装的软件包，并提供脱机支持。如果代理程序空间不足，TeamCity将尝试清除代理程序上的NuGet包缓存。</p><p id="f4d6d64c">以下目录中的缓存将被清除：</p><ul class="list _ul"><li class="list__item" id="586ece47"><p><code class="code">%%NUGET_PACKAGES%% environment variable</code> （必须是绝对路径）</p></li><li class="list__item" id="1887457f"><code class="code">%%LOCALAPPDATA%%NuGet\Cache</code></li><li class="list__item" id="cb7824fc"><code class="code">%%LOCALAPPDATA%%NuGet\v3-cache</code></li><li class="list__item" id="4045dde6"><code class="code">%%user.home%.nuget\packages</code></li></ul></div><a name="AuthenticationinprivateNuGetFeeds"></a><a name="Authentication-in-private-NuGet-Feeds"></a><div class="chapter"><h2 id="NuGet-AuthenticationinprivateNuGetFeeds">私人NuGet Feed中的身份验证</h2><p id="53b9dcfc">您可以在<a href="using-teamcity-as-nuget-feed.html">内置的NuGet提要</a>或<a href="nuget-feed-credentials.html">NuGet提要凭证</a>构建功能中指定的提要中使用身份验证。凭据提供程序将自动验证对这些提要的请求。</p><p id="cd833b04">API支持：</p><ul class="list _ul"><li class="list__item" id="bca24d54"><b id="d2595672">NuGet安装程序/ NuGet发布运行程序</b><ul class="list _ul"><li class="list__item" id="2b7726fd"><p><b id="1d408e83">v3</b> ： <b id="4d4a6224">自TeamCity 2018.2开始</b>受支持，需要NuGet 4.8+（Windows），NuGet 4.9+在Mono上</p></li><li class="list__item" id="b70dde30"><p><b id="77f0206c">v1 / v2</b> ：最低要求是NuGet 2.0+，建议使用NuGet 3.5+</p></li></ul></li><li class="list__item" id="a33ca85d"><b id="ab1b1448">.NET CLI</b><ul class="list _ul"><li class="list__item" id="243ce8b1"><p><b id="bfe59218">v3</b> ：要求.NET CLI 2.1.500</p></li><li class="list__item" id="cb2bd5cd"><p><b id="e42b3e8e">v1 / v2</b> ：不支持</p></li></ul></li></ul></div><a name="ProxyConfiguration"></a><a name="Proxy-Configuration"></a><div class="chapter"><h2 id="NuGet-ProxyConfiguration">代理配置</h2><p id="c43304b6">NuGet命令行客户端通过以下方式支持代理服务器配置<code class="code">NuGet.config</code>文件参数或环境变量。有关更多详细信息，请参见<a href="https://docs.microsoft.com/en-us/nuget/schema/nuget-config-file#config-section" rel="noopener noreferrer" data-external="true" target="_blank">NuGet文档</a> 。</p><hr id="49585586"><p id="1ca7b113"><b id="90174233">也可以看看：</b></p><p id="de649982"><b id="03ac8739">管理员指南</b> ： <a href="nuget-installer.html">NuGet安装程序</a> | <a href="nuget-publish.html">NuGet发布</a> | <a href="nuget-pack.html">NuGet包</a> | <a href="nuget-dependency-trigger.html">NuGet依赖触发器</a></p><hr id="62b06d81"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>