<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Working with Meta-Runner - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Working with Meta-Runner" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/configuring-build-steps.md|Configuring Build Steps/working-with-meta-runner.md|Working with Meta-Runner" data-main-title="Working with Meta-Runner" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/working-with-meta-runner.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Working with Meta-Runner" id="working-with-meta-runner.md">Working with Meta-Runner</h1><p id="36e440c4">A <i id="d75631dd">Meta-Runner</i> allows you to extract build steps, requirements and parameters from a build configuration and create a <a href="build-runner.html">build runner</a> out of them. This build runner can then be used as any other build runner in a build step of any other build configuration or template.</p><p id="5fbbfc18">Basically, a meta-runner is a set of build steps from one build configuration that you can reuse in another; it is an xml definition containing build steps, requirements and parameters that you can utilize in xml definitions of other build configurations. TeamCity allows extracting meta-runners using the web UI.</p><p id="56a6c7dd">With a meta-runner, you can easily reuse existing runners, create new runners for typical tasks (for example, publish to FTP, delete directory), you can simplify your build configuration and decrease a number of build steps.</p><p id="599acc30">All meta-runners are stored on a project level, so they are available within this project and its subprojects only, and are not visible outside. If a meta-runner is stored on the <b id="3d0158c1">&lt;Root project&gt;</b> level, it is available globally (in all projects).</p><p id="52506e63">You can use the existing meta-runners from the TeamCity Meta-Runners Power Pack or create your own meta-runner.</p><p id="b9a0afd0">On this page:</p><p id="4d0ce4b4"><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#WorkingwithMeta-Runner-UsingMeta-RunnersPowerPack">Using Meta-Runners Power Pack</a></li><li class="list__item"><a href="#WorkingwithMeta-Runner-InstallingMeta-Runner">Installing Meta-Runner</a></li><li class="list__item"><a href="#WorkingwithMeta-Runner-CreatingMeta-Runner">Creating Meta-Runner</a></li><li class="list__item"><a href="#WorkingwithMeta-Runner-CreatingYourOwnMeta-RunnerfromUI">Creating Your Own Meta-Runner from UI</a><ul class="list _bullet"><li class="list__item"><a href="#WorkingwithMeta-Runner-PreparingBuildConfiguration">Preparing Build Configuration</a></li><li class="list__item"><a href="#WorkingwithMeta-Runner-VerifyingBuildConfigurationWorksProperly">Verifying Build Configuration Works Properly</a></li><li class="list__item"><a href="#WorkingwithMeta-Runner-ExtractingandUsingMeta-Runner">Extracting and Using Meta-Runner</a></li></ul></li><li class="list__item"><a href="#WorkingwithMeta-Runner-CreatingMeta-RunnerfromXMLDefinitionofBuildConfiguration">Creating Meta-Runner from XML Definition of Build Configuration</a></li><li class="list__item"><a href="#WorkingwithMeta-Runner-CreatingBuildConfigurationfromMeta-Runner">Creating Build Configuration from Meta-Runner</a></li></ul></p><a name="UsingMeta-RunnersPowerPack"></a><a name="Using-Meta-Runners-Power-Pack"></a><div class="chapter"><h2 id="WorkingwithMeta-Runner-UsingMeta-RunnersPowerPack">Using Meta-Runners Power Pack</h2><p id="30e344a5"><a href="https://github.com/jetbrains/meta-runner-power-pack" data-external="true" target="_blank" rel="noopener noreferrer">Meta-runners Power Pack for TeamCity</a> available on GitHub is a collection of meta-runners for various tasks like downloading a file, triggering a build, tagging a build, changing a build status, running PHP tasks, and so on.</p><p id="9c171f9e">Each file called <code class="code">*MRPP_\&lt;some text\&gt;.xml*</code> contains a definition of a single Meta-runner. Download the required meta-runner (or copy its definition to a file) and install it as described in the section below.</p></div><a name="InstallingMeta-Runner"></a><a name="Installing-Meta-Runner"></a><div class="chapter"><h2 id="WorkingwithMeta-Runner-InstallingMeta-Runner">Installing Meta-Runner</h2><p id="c37f06aa">You can install a meta-runner using the TeamCity web UI. Alternatively, you can do it directly via the file system.</p><ul class="list _ul"><li class="list__item" id="7b1b16eb"><p>to install a Meta-runner via the Web UI, go to the Project Settings page, select Meta-Runners from the list of settings on the left, click <b id="d337cb5c">Upload Meta-Runner</b> and select the Meta-runner definition file. Save you changes.</p></li><li class="list__item" id="6e6a2ada"><p>to install a Meta-runner directly to the file system,take the Meta-runner definition file and put it into the <code class="code">&lt;</code><a href="teamcity-data-directory.html"><code class="code">TeamCity Data Directory</code></a><code class="code">\config\projects\&lt;project ID&gt;\pluginData\metaRunners</code> directory,where <code class="code">&lt;project ID&gt;</code> is the identifier of a project where you want to place the Meta-runner.<br>If the <code class="code">metaRunners</code> directory does not exist, it should be created. Once you place the file on the disk, TeamCity will detect it and load this Meta-runner; no server restart is required.</p></li></ul><p id="253853f2">If the Meta-runner is loaded successfully, you will see it listed on the Meta-Runners page for the project; if you have appropriate permissions, you can modify the definition directly in the TeamCity UI.</p><p id="eb934866">The runner is now available in the list of build runners on the build configuration Build Steps page and is represented as a native TeamCity runner with a convenient UI.</p><p id="1625ff52">A Meta-runner placed into a project will be available to all its subprojects and build configurations. To make a Meta-runner available to all projects, place it in the Root project.</p></div><a name="CreatingMeta-Runner"></a><a name="Creating-Meta-Runner"></a><div class="chapter"><h2 id="WorkingwithMeta-Runner-CreatingMeta-Runner">Creating Meta-Runner</h2><p id="08eccf2a">You can create a build configuration via the TeamCity web UI and extract a meta-runner from it or use the xml definition of an existing build configuration as a meta-runner.</p></div><a name="CreatingYourOwnMeta-RunnerfromUI"></a><a name="Creating-Your-Own-Meta-Runner-from-UI"></a><div class="chapter"><h2 id="WorkingwithMeta-Runner-CreatingYourOwnMeta-RunnerfromUI">Creating Your Own Meta-Runner from UI</h2><p id="11073c8b">Let us consider an example of creating a meta-runner.</p><p id="b98945de">To create a meta-runner, follow these steps (described below in more detail):</p><ol class="list _decimal"><li class="list__item" id="cf106f43"><p>Prepare a <a href="#Preparing-Build-Configuration">build configuration to test the build steps we are going to use in our meta-runner</a>.</p></li><li class="list__item" id="0e933834"><p><a href="#Verifying-Build-Configuration-Works-Properly">Make sure the build configuration is working</a>.</p></li><li class="list__item" id="0299276f"><p><a href="#Extracting-and-Using-Meta-Runner">Extract a meta-runner to the desired project</a>.</p></li></ol><p id="b1de6573">In this example, we will create a meta-runner to publish some artifacts to TeamCity with the help of corresponding <a href="build-script-interaction-with-teamcity.html#Publishing-Artifacts-while-the-Build-is-Still-in-Progress">service message</a>.</p><p id="690fda44">Usually artifacts configured in a build configuration are published when the build finishes. However, sometimes for long builds with multiple build steps we need artifacts faster. In this example, we will create a runner which can be inserted between any build steps and can be configured to publish artifacts produced by previous steps.</p><a name="PreparingBuildConfiguration"></a><a name="Preparing-Build-Configuration"></a><div class="chapter"><h3 id="WorkingwithMeta-Runner-PreparingBuildConfiguration">Preparing Build Configuration</h3><p id="bec11164">The first step is to prepare a build configuration which will work the same way as the meta-runner we would like to produce. Let us use the configuration with a single Ant build step: Ant can be executed on any platform where the TeamCity agent runs; besides, Ant runner in TeamCity supports build.xml specified right in the runner settings. This is important because our build configuration must be self-contained, it cannot take build.xml from the version control repository. So in our case the Ant step settings will look like this:</p><p id="f57c01f4"><figure><img alt="Adding Ant build step" title="Adding Ant build step" src="/help/img/teamcity/2019.1/ant-build-step.png" id="227f90d0" width="1323" height="1814"></figure></p><p id="e23f7bd6">where <code class="code">artifact.paths</code> is a system property. We need to add it on the <b id="ed2296e0">Parameters</b> tab of the build configuration settings:</p><p id="293ee26a"><figure><img alt="Paths to artifacts in Build Parameters" title="Paths to artifacts in Build Parameters" src="/help/img/teamcity/2019.1/paths-to-artifacts-parameter.png" id="db315f38" width="1224" height="1112"></figure></p><p id="39c14062">Note that each parameter can have a specification where we can provide the label, description, type of control and specify validation conditions. Before version 8.0 this specification was used by the custom build dialog only. Now this specification is used by a meta-runner too.</p><aside class="tip sideblock" data-title="" rel="39c14062" id="e0cf0386"><p id="f1514592">Here the Ant build step is used just as an example. In the initial build configuration, you can use any of the available build runners (e.g. MSBuild, .Net process, etc.) and configure the settings, define the parameters for this build step. When you extract a meta-runner from this build configuration, all the settings defined in the build step, and all the build parameters will be added to the meta-runner.</p></aside></div><a name="VerifyingBuildConfigurationWorksProperly"></a><a name="Verifying-Build-Configuration-Works-Properly"></a><div class="chapter"><h3 id="WorkingwithMeta-Runner-VerifyingBuildConfigurationWorksProperly">Verifying Build Configuration Works Properly</h3><p id="5de73189">Once the build steps and parameters are defined, we need to make sure our build configuration works by running a couple of builds through the custom build dialog:</p><p id="33661887"><figure><img alt="Running a custom build with paths to artifacts" title="Running a custom build with paths to artifacts" src="/help/img/teamcity/2019.1/cutom-build-with-paths-to-artifacts.png" id="d5912268" width="752" height="1230"></figure></p></div><a name="ExtractingandUsingMeta-Runner"></a><a name="Extracting-and-Using-Meta-Runner"></a><div class="chapter"><h3 id="WorkingwithMeta-Runner-ExtractingandUsingMeta-Runner">Extracting and Using Meta-Runner</h3><p id="7532f312">If the build configuration works properly, we can create a meta-runner using the <b id="62cfdd9a">Actions</b> button in the top right-hand corner, <b id="bb4e1dc2">Extract meta-runner</b> option:</p><p id="efabf112"><figure><img alt="Extract Meta-Runner" title="Extract Meta-Runner" src="/help/img/teamcity/2019.1/extract-meta-runner.png" id="3a084714" width="650" height="841"></figure></p><p id="c735ee8c">The <b id="bc978d33">Extract Meta-Runner</b> dialog requires specifying the project where the meta-runner will be created. A meta-runner created in a project will be available in this project and all its subprojects. In our case the <b id="0af1279f">&lt;Root project&gt;</b> is selected, so the meta-runner will be available in all projects.</p><p id="101b6cdd">We also need to provide the name, description and an ID for the meta-runner: the name and description will be shown in the web interface, an ID is required to distinguish this meta-runner from others.</p><p id="ed7ca9eb">Upon clicking the <b id="bc1c574f">Extract</b> button, TeamCity will take definitions of all build steps and parameters in this build configuration and create a build runner out of them.</p><aside class="tip sideblock" data-title="" rel="ed7ca9eb" id="aae5741f"><p id="eb3cb804">Besides build steps and parameters, a meta-runner can also have requirements: if requirements are defined in the build configuration, they will be extracted to the meta-runner automatically. Requirements can be useful if the tools used by meta-runner are available on specific platforms only.</p></aside><p id="e7f970a6">Once the meta-runner is extracted, it becomes available in the build runners selector and can be used in any build step just like any other build runner:</p><p id="cd6eaa6d"><figure><img alt="Publish Artifacts build step" title="Publish Artifacts build step" src="/help/img/teamcity/2019.1/meta-runner-build-step.png" id="b9e6a259" width="827" height="923"></figure></p><p id="2014abfa">The current meta-runner usages can be seen at the project <b id="d0cba23b">Meta-Runners</b> page:</p><p id="425dcbea"><figure><img alt="Meta-Runners" title="Meta-Runners" src="/help/img/teamcity/2019.1/meta-runners.png" id="85e266da" width="1418" height="934"></figure></p><p id="7a82b947">When a meta-runner is extracted, all steps will be extracted. If you need to reorder parameters or make some quick fixes in the runner script, you can edit its raw xml definition in the web browser: go to the <b id="324959ca">Project Administration</b> | <b id="a838ceb4">Meta-Runners</b> and use the <b id="99c6d913">Edit</b> option next to the meta-runner. The parameters will be shown in the same order as <code class="code">&lt;param&gt;</code> elements in the xml definition. Definitions of meta-runners are stored in the <code class="code">&lt;</code><a href="teamcity-data-directory.html"><code class="code">TeamCity Data Directory</code></a><code class="code">\config\projects\&lt;project ID&gt;\pluginData\metaRunners</code> folder.</p></div></div><a name="CreatingMeta-RunnerfromXMLDefinitionofBuildConfiguration"></a><a name="Creating-Meta-Runner-from-XML-Definition-of-Build-Configuration"></a><div class="chapter"><h2 id="WorkingwithMeta-Runner-CreatingMeta-RunnerfromXMLDefinitionofBuildConfiguration">Creating Meta-Runner from XML Definition of Build Configuration</h2><p id="315a7560">Alternatively, you can use the xml definition of an existing build configuration as a meta-runner. To do it, save the definition of this build configuration to a file named as follows: &lt;runner id&gt;.xml, where &lt;runner id&gt; is the <a href="identifier.html">ID</a> of this build runner. Install the meta-runner as described <a href="#Installing-Meta-Runner">above</a>.</p><p id="b5c190ea">Since a meta-runner looks and works like any other runner, it is also possible to create another meta-runner on the basis of an existing meta-runner.</p></div><a name="CreatingBuildConfigurationfromMeta-Runner"></a><a name="Creating-Build-Configuration-from-Meta-Runner"></a><div class="chapter"><h2 id="WorkingwithMeta-Runner-CreatingBuildConfigurationfromMeta-Runner">Creating Build Configuration from Meta-Runner</h2><p id="d35f50c2">If you need to fix a meta-runner and test your fix, you can create a build configuration from a meta-runner, can change its steps, adjust parameters and requirements, check how it works, and then use the <b id="15b3b164">Extract meta-runner</b> action to apply the changes to the existing meta-runner with the same ID.</p><hr id="8e0ab05e"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>