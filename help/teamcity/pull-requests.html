<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>Pull Requests - Help | TeamCity</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body data-id="Pull Requests" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/administrator-s-guide.md|Administrator's Guide/managing-projects-and-build-configurations.md|Managing Projects and Build Configurations/creating-and-editing-build-configurations.md|Creating and Editing Build Configurations/adding-build-features.md|Adding Build Features/pull-requests.md|Pull Requests" data-main-title="Pull Requests" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/pull-requests.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search TeamCity Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Pull Requests" id="pull-requests.md">Pull Requests</h1><p id="34a4d3ac">The <i id="75db9328">Pull Requests</i> build feature lets you automatically load pull request (or <i id="8582a3ad">merge requests</i> in case of GitLab) information and run builds on pull request branches of the following VCS (Version Control Systems) hosting services:</p><ul class="list _ul"><li class="list__item" id="1eb62c89"><a href="#GitHub-Pull-Requests">GitHub</a></li><li class="list__item" id="0e9f61c3"><a href="#Bitbucket-Server-Pull-Requests">Bitbucket Server</a></li><li class="list__item" id="037835ad"><a href="#GitLab-Merge-Requests">GitLab</a></li></ul><p id="6617039b">The feature extends the original branch specification of the VCS roots, attached to the current build configuration, to include pull requests that match the specified filtering criteria. It monitors and triggers builds only on <code class="code">head</code> branches (such as <code class="code">refs/pull/*/head</code>).<br>After a build is run on a pull request, TeamCity provides additional details for the pull request branch on the Build Overview page.</p><p id="c0f1f41d"><figure><img alt="Pull request details" title="Pull request details" src="/help/img/teamcity/2019.1/pr-info.png" id="60d409e4" width="923" height="525"></figure></p><aside class="note " data-title="" rel="c0f1f41d" id="24522c43"><p id="72c30aed">The branch specification of the VCS root <b id="e4a5bd0c">must not</b> contain patterns matching pull request branches.</p></aside><p id="43d9845a">When adding this build feature, you need to specify a VCS root and select a VCS hosting type.</p><p id="3c9df0d0">The build feature parameters depend on the selected VCS hosting type.</p><aside class="tip sideblock" data-title="" rel="3c9df0d0" id="1130a0a8"><p id="afc9946f">For requests from GitHub and GitLab, you can set up TeamCity to automatically run a build on each request and merge the request if the build is successful.<br>To achieve this, enable and configure the Pull Requests and <a href="automatic-merge.html">Automatic Merge</a> build features.</p></aside><p id="8df86660">See the <a href="#Workflow-example-for-the-Pull-Requests-build-feature">example</a> on how to set up TeamCity to run builds on pull requests.</p><a name="VCS-specificsettings"></a><a name="VCS-specific-settings"></a><div class="chapter"><h2 id="PullRequests-VCS-specificsettings">VCS-specific settings</h2><a name="GitHubPullRequests"></a><a name="GitHub-Pull-Requests"></a><div class="chapter"><h3 id="PullRequests-GitHubPullRequests">GitHub Pull Requests</h3><p id="ef93b07a">TeamCity supports <a href="https://github.com/" data-external="true" target="_blank" rel="noopener noreferrer">GitHub</a> and <a href="https://github.com/enterprise" data-external="true" target="_blank" rel="noopener noreferrer">GitHub Enterprise</a>.</p><p id="2b5cf0f3">The following parameters are available for the GitHub hosting type:</p><div class="table-wrapper"><table class=" wide" width="100%" id="47b20a33"><thead><tr id="1e2aa335" class="ijRowHead"><th width="150" id="fa5ef336"><p id="f561c357">Parameter</p></th><th width="150" id="c6385fba"><p id="6234ac35">Option</p></th><th id="82730a27"><p id="ddfc0a6c">Description</p></th></tr></thead><tbody><tr id="0cab4e57" class="ijRowOdd"><td id="6bf6c041"><p id="39729b3a">Authentication Type</p></td><td id="3b593d50"><p id="6253dc16">Use VCS root credentials</p></td><td id="4dffed90"><p id="9a6851b7">TeamCity will try to extract username/password credentials or a personal access token/<code class="code">x-oauth-basic</code> from the VCS root settings if the VCS root uses HTTP(S) fetch URL.</p><p id="da8852a3">This option will not work if the VCS root employs anonymous authentication or SSH.</p><p id="20ab9205">For a GitHub Enterprise repository, only the personal access token/<code class="code">x-oauth-basic</code> pair will work.</p></td></tr><tr id="970418df" class="ijRowEven"><td id="8a6ddfc5"></td><td id="a0ee0df8"><p id="d5088653">Access token</p></td><td id="90f9c398"><p id="dbd23b89">The '<i id="4c2c7695">Token</i>' field appears.</p><p id="a9d0eb84">Use a personal access token or obtain a token through an OAuth connection. It must have either the <code class="code">public_repo</code> (for public repisotories) or <code class="code">repo</code> (for private repositories) scope.</p></td></tr><tr id="f1d4510c" class="ijRowOdd"><td id="f428226d"><p id="e13bbd0f">By authors</p><aside class="note " data-title="" rel="e13bbd0f" id="09c66213"><p id="70c42b67">The filter applies to public repositories only.</p></aside></td><td id="299ce124"><p id="b107e01c">Members of the same organization</p></td><td id="9a295bf4"><p id="6dafd23c">Only detects pull requests submitted by <a href="https://help.github.com/en/articles/about-organization-membership" data-external="true" target="_blank" rel="noopener noreferrer">members of the same organization</a> in GitHub.</p></td></tr><tr id="1552bd1c" class="ijRowEven"><td id="5f0a0221"></td><td id="195cb4d9"><p id="4ce50c78">Members and external collaborators</p></td><td id="fdf540fa"><p id="93fe14fe">Only detects pull requests submitted by members of the same organization and <a href="https://help.github.com/en/articles/adding-outside-collaborators-to-repositories-in-your-organization" data-external="true" target="_blank" rel="noopener noreferrer">external collaborators</a> in GitHub.</p></td></tr><tr id="ec2c0d41" class="ijRowOdd"><td id="66069727"></td><td id="34036292"><p id="d16821ae">Everybody</p></td><td id="160cd4ef"><p id="5ccaa809">Detects all pull requests. Be aware that selecting this option may allow arbitrary users to execute malicious code on your build agents.</p></td></tr><tr id="c7923abf" class="ijRowEven"><td id="38c2e7b1"><p id="622b0913">By target branch</p></td><td id="14417112"></td><td id="9cb9a361"><p id="889e586a">Specify the name of the target branch. If left blank, no filters apply.</p></td></tr><tr id="dd1a79f1" class="ijRowOdd"><td id="b3b1ce33"><p id="718bdd3c">Server URL</p></td><td id="915cc70d"></td><td id="c971408a"><p id="779f7118">Specify a GitHub URL for connection.</p><p id="bea97ca3">If left blank, the URL will be extracted from the VCS root fetch URL.</p></td></tr></tbody></table></div></div><a name="BitbucketServerPullRequests"></a><a name="Bitbucket-Server-Pull-Requests"></a><div class="chapter"><h3 id="PullRequests-BitbucketServerPullRequests">Bitbucket Server Pull Requests</h3><p id="ceba9138">The following parameters are available for the <a href="https://www.atlassian.com/software/bitbucket/enterprise/data-center" data-external="true" target="_blank" rel="noopener noreferrer">Bitbucket Server</a> hosting type:</p><div class="table-wrapper"><table class=" wide" width="100%" id="84596c0c"><thead><tr id="2eacb8e3" class="ijRowHead"><th width="150" id="12bdf8a1"><p id="05e89ab6">Parameter</p></th><th width="150" id="174e2af8"><p id="c3a2f8b4">Options</p></th><th id="e97247d1"><p id="2bbd380c">Description</p></th></tr></thead><tbody><tr id="f8f943aa" class="ijRowOdd"><td id="fad357bf"><p id="537c691a">Authentication Type</p></td><td id="20f5965b"><p id="d0f06775">Use VCS root credentials</p></td><td id="d6564ec5"><p id="34c267c4">TeamCity will try to extract username/password credentials from the VCS root settings if the VCS root uses HTTP(S) fetch URL.</p><p id="65cfb525">This option will not work if the VCS root employs anonymous authentication.</p></td></tr><tr id="c56e0eee" class="ijRowEven"><td id="a1740fda"></td><td id="4d5a6757"><p id="8c16ffad">Username/password</p></td><td id="184b8f83"><p id="6778af6e">The '<i id="c658cb1f">Username</i>' and '<i id="b0b41881">Password</i>' fields appear.</p><p id="c31f3440">Specify a username and password for connection to Bitbucket Server.</p></td></tr><tr id="7c72482b" class="ijRowOdd"><td id="a7b70976"><p id="60fcd521">By target branch</p></td><td id="f97a13e7"></td><td id="d853d016"><p id="37f85fa0">Specify the name of the target branch. If left blank, no filters apply.</p></td></tr><tr id="51eaea76" class="ijRowEven"><td id="71ce2784"><p id="333789e8">Server URL</p></td><td id="8c23bf74"></td><td id="435f9062"><p id="830e9f24">Specify a Bitbucket URL for connection.</p><p id="14206438">If left blank, the URL will be extracted from the VCS root fetch URL.</p></td></tr></tbody></table></div></div><a name="GitLabMergeRequests"></a><a name="GitLab-Merge-Requests"></a><div class="chapter"><h3 id="PullRequests-GitLabMergeRequests">GitLab Merge Requests</h3><p id="96c7e1a6">TeamCity processes GitLab <a href="https://docs.gitlab.com/ee/user/project/merge_requests/index.html" data-external="true" target="_blank" rel="noopener noreferrer">merge requests</a> similarly to how it processes pull requests in other hosting services. Currently, TeamCity detects only merge requests submitted after this build feature is enabled.</p><p id="998c7522">The following parameters are available for the <a href="https://gitlab.com/" data-external="true" target="_blank" rel="noopener noreferrer">GitLab</a> hosting type:</p><div class="table-wrapper"><table width="100%" id="b1fd42a5"><thead><tr id="6972a136" class="ijRowHead"><th width="150" id="6a6772a8"><p id="73cd2f68">Parameter</p></th><th id="1f634ddb"><p id="40f07ba3">Description</p></th></tr></thead><tbody><tr id="95164209" class="ijRowOdd"><td id="c1745ac1"><p id="5061b146">Access token</p></td><td id="349996a5"><p id="7ad1994c">Use a personal access token for connection. The token must have the <code class="code">api</code> scope.</p></td></tr><tr id="feb56412" class="ijRowEven"><td id="2e0f8520"><p id="98e2d30e">By target branch</p></td><td id="05998e48"><p id="8db17454">Specify the name of the target branch. If left blank, no filters apply.</p></td></tr><tr id="b881776b" class="ijRowOdd"><td id="e61be5b1"><p id="a08730cd">Server URL</p></td><td id="67171d09"><p id="94748147">Specify a GitLab URL for connection.</p><p id="a96e78fe">If left blank, the URL will be extracted from the VCS root fetch URL.</p></td></tr></tbody></table></div></div></div><a name="PullRequestsworkflowexample"></a><a name="Pull-Requests-workflow-example"></a><div class="chapter"><h2 id="PullRequests-PullRequestsworkflowexample">Pull Requests workflow example</h2><p id="e7b95ad9">Let's say you have the following environment set up:</p><ul class="list _ul"><li class="list__item" id="c5c99a44"><p>public GitHub repository <code class="code">web-app</code> with the default branch <code class="code">master</code></p></li><li class="list__item" id="7aadd372">TeamCity project<ul class="list _ul"><li class="list__item" id="6cf6012d"><p>build configuration <code class="code">web-app</code> that uses files from the <code class="code">web-app</code> repository to build a web application</p></li></ul></li></ul><p id="cd963c69">The members of your <a href="https://help.github.com/en/articles/about-organizations" data-external="true" target="_blank" rel="noopener noreferrer">organization</a> propose changes to the sources by sending pull requests to the <code class="code">master</code> branch, and you want these changes to be automatically built and tested in TeamCity before you merge them.<br>TeamCity can detect each pull request sent to the <code class="code">master</code> branch and build the web application based on the updated sources.</p><aside class="note " data-title="" rel="cd963c69" id="f5cf3637"><p id="0e21ae3d">The <code class="code">web-app</code> build configuration must have a VCS trigger enabled.</p></aside><p id="57641192">To configure the described pipeline for the <code class="code">web-app</code> build configuration in TeamCity:</p><ol class="list _decimal"><li class="list__item" id="6e84f872"><b id="5488bafd">Add a <a href="vcs-root.html">VCS root</a> to the build configuration</b>:<ul class="list _ul"><li class="list__item" id="51921065"><p>Go to <b id="07b63816">Build Configuration Settings | Version Control Settings</b> and click <b id="a3e46660">Attach VCS root</b>.</p></li><li class="list__item" id="576c5308">Configure the root parameters:<ul class="list _ul"><li class="list__item" id="d28ec7a4"><p><b id="5a3f5839">Type of VCS</b>: <i id="7fc88749">Git</i></p></li><li class="list__item" id="c841c44a"><p><b id="e4824554">VCS root name</b>: <i id="f7d14884">&lt;unique_root_name&gt;</i></p></li><li class="list__item" id="350d3b7a"><p><b id="bfc28c01">Fetch URL</b>: <i id="d3d295e4">&lt;GitHub_repository_URL&gt;</i></p></li><li class="list__item" id="343c175c"><p><b id="742a79d2">Default branch</b>: the branch to be monitored; by default, <i id="5f0098f7"><code class="code">refs/heads/master</code></i> (read more <a href="working-with-feature-branches.html">about feature branches</a>)</p></li><li class="list__item" id="f09698db"><p><b id="de1a3c9f">Branch specification</b>: a filter for additional branches to be monitored (for example, <i id="e02c4657"><code class="code">+:refs/heads/*</code></i>)</p></li><li class="list__item" id="1ea2ba5e"><p><b id="f121e00e">Authentication parameters</b> of the GitHub user that has access rights to the <code class="code">web-app</code> repository</p></li></ul></li><li class="list__item" id="3ed02361"><p>Test the connection and, if successful, click <b id="56cb32a6">Create</b>.</p></li></ul></li><li class="list__item" id="e973fe50"><b id="7152f171">Add the <i id="f35104c3">Pull Requests</i> <a href="adding-build-features.html">build feature</a> to the build configuration</b>:<ul class="list _ul"><li class="list__item" id="219169ae"><p>Go to <b id="2f5fb064">Build Configuration Settings | Build Features</b> and click <b id="4f2eb73c">Add build feature</b>.</p></li><li class="list__item" id="4d40df87">Configure the feature parameters:<ul class="list _ul"><li class="list__item" id="97ddf2e5"><p><b id="c68b3c16">VCS Root</b>: the VCS root created at Step 1</p></li><li class="list__item" id="5de89737"><p><b id="bc26595a">VCS hosting type</b>: <i id="5e2d7f49">GitHub</i></p></li><li class="list__item" id="e3bc8659"><p><b id="daf0be9b">Authentication type</b>: <i id="f65ee282">Use VCS root credentials</i>, or select <i id="654c99a3">Access token</i> to use a GitHub token instead</p></li><li class="list__item" id="621ecb33"><b id="324e09ba">Pull Requests filtering</b>:<ul class="list _ul"><li class="list__item" id="abf2a49d"><p><b id="b616e1f4">By authors</b>: <i id="9560ed73">Members of the same organization</i></p></li><li class="list__item" id="c0d2c106"><p><b id="792d78d9">By target branch</b>: leave blank to apply no filters and monitor all new pull requests in the repository, or explicitly specify the target branch (in this example, <i id="b862f9c5"><code class="code">master</code></i>)</p></li></ul></li></ul></li><li class="list__item" id="1506859f"><p>Test the connection and, if successful, click <b id="f4bc6b31">Save</b>.</p></li></ul></li></ol><p id="5bbde2a7">That's it! Now, when a member of your GitHub organization sends a pull request to the <code class="code">master</code> branch, TeamCity acts as follows:</p><ol class="list _decimal"><li class="list__item" id="f0252852"><p>Detects the pull request sent to the <code class="code">master</code> branch.</p></li><li class="list__item" id="b0744177"><p>Runs the <code class="code">web-app</code> build configuration: collects sources, builds and tests the app according to your predefined build steps.</p></li><li class="list__item" id="ab1f1400"><p>Displays information about the processed pull request on the build configuration <b id="fd05d9e5">Overview</b> page. You can instantly see the pull request status (1) and refresh the information about its state (2).</p></li></ol><p id="4efcadd2"><figure><img alt="Pull Request information in Build Overview" title="Pull Request information in Build Overview" src="/help/img/teamcity/2019.1/PullRequestOverviewInfo.png" id="28f2c030" width="500" height="552"></figure></p><p id="6f67a118"><b id="a2d5c95e">Pro Tip</b></p><p id="2e389d64">You can automate your setup further, so TeamCity:</p><ul class="list _ul"><li class="list__item" id="042ebe9f"><p>sends a build status back to GitHub after the build finishes, with the <a href="commit-status-publisher.html">Commit Status Publisher</a> build feature</p></li><li class="list__item" id="67ff431a"><p>merges the pull request in GitHub if the build finishes successfully, with the <a href="automatic-merge.html">Automatic Merge</a> build feature</p></li></ul><hr id="1b6fe79b"><p id="62b5a8a1"><b id="17b651b3">See also</b>:</p><p id="fa7c00e2"><b id="1800a21d">TeamCity Blog</b>: <a href="https://blog.jetbrains.com/teamcity/2019/08/building-github-pull-requests-with-teamcity/" data-external="true" target="_blank" rel="noopener noreferrer">Building GitHub pull requests with TeamCity</a></p><hr id="6de39aca"></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>