<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v2/analytics.js"></script><title>报告问题-帮助|团队城市</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v2/app.css"></head><body  data-id="Reporting Issues" data-breadcrumbs="teamcity-documentation.md|TeamCity Documentation/troubleshooting.md|Troubleshooting/reporting-issues.md|Reporting Issues" data-main-title="Reporting Issues" data-edit-url="https://github.com/JetBrains/teamcity-documentation/edit/2019.1/topics/reporting-issues.md"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索TeamCity帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>TeamCity 2019.1帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="reporting-issues.md" data-toc="Reporting Issues">报告问题</h1><p id="a6386da7">如果您在运行TeamCity时遇到问题，并认为它们与软件有关，请<a href="troubleshooting.html">与我们联系</a>并提供问题的详细说明。</p><p id="8f6b7f31">要解决问题，我们可能需要有关您系统的各种信息以及各种日志。以下部分说明了如何针对不同问题收集此类信息。</p><p id="0075ade6">在这个部分：</p><p id="7e3814f0"></p><ul class="list" data-skip-index="skip"><li class="list__item"><a href="#ReportingIssues-BestPracticesWhenReportingIssues">报告问题的最佳做法</a></li><li class="list__item"><a href="#ReportingIssues-Slowness,HangingsandLowPerformance">缓慢，绞死和性能低下</a><ul class="list _bullet"><li class="list__item"><a href="#ReportingIssues-ServerThreadDump">服务器线程转储</a></li><li class="list__item"><a href="#ReportingIssues-CollectingCPUProfilingDataonServer">在服务器上收集CPU分析数据</a></li><li class="list__item"><a href="#ReportingIssues-AgentThreadDump">代理线程转储</a></li><li class="list__item"><a href="#ReportingIssues-TakingThreadDump">进行线程转储</a><ul class="list _bullet"><li class="list__item"><a href="#ReportingIssues-UnderWindows">在Windows下</a></li><li class="list__item"><a href="#ReportingIssues-UnderLinux">在Linux下</a></li></ul></li><li class="list__item"><a href="#ReportingIssues-Database-relatedSlowdowns">与数据库有关的减速</a><ul class="list _bullet"><li class="list__item"><a href="#ReportingIssues-MySQL">的MySQL</a></li></ul></li></ul></li><li class="list__item"><a href="#ReportingIssues-OutOfMemoryProblems">内存不足问题</a></li><li class="list__item"><a href="#ReportingIssues-" toomanyopenfile="error" ="">“打开的文件太多”错误</a></li><li class="list__item"><a href="#ReportingIssues-Agentdoesnotconnecttotheserver">代理未连接到服务器</a></li><li class="list__item"><a href="#ReportingIssues-Loggingevents">记录事件</a><ul class="list _bullet"><li class="list__item"><a href="#ReportingIssues-VersionControldebuglogging">版本控制调试日志记录</a><ul class="list _bullet"><li class="list__item"><a href="#ReportingIssues-Subversiondebuglogging">Subversion调试日志记录</a></li><li class="list__item"><a href="#ReportingIssues-ClearCase">ClearCase</a></li></ul></li></ul></li><li class="list__item"><a href="#ReportingIssues-PatchApplicationProblems">补丁申请问题</a></li><li class="list__item"><a href="#ReportingIssues-Loggingfor.NETRunners">记录.NET运行程序</a></li><li class="list__item"><a href="#ReportingIssues-RemoteRunProblems">远程运行问题</a></li><li class="list__item"><a href="#ReportingIssues-LogginginIntelliJIDEA/Platform-basedIDEs">登录IntelliJ IDEA /基于平台的IDE</a><ul class="list _bullet"><li class="list__item"><a href="#ReportingIssues-OpeninIDEFunctionalityLogging">在IDE中打开功能日志</a></li><li class="list__item"><a href="#ReportingIssues-NoSuitableBuildConfigurationsFoundforRemoteRun">找不到适用于远程运行的合适的构建配置</a></li></ul></li><li class="list__item"><a href="#ReportingIssues-LogginginTeamCityEclipseplugin">登录TeamCity Eclipse插件</a></li><li class="list__item"><a href="#ReportingIssues-TeamCityVisualStudioAddinissues">TeamCity Visual Studio插件问题</a><ul class="list _bullet"><li class="list__item"><a href="#ReportingIssues-TeamCityAddinlogging">TeamCity插件日志记录</a></li><li class="list__item"><a href="#ReportingIssues-VisualStudiologging">Visual Studio日志记录</a></li></ul></li><li class="list__item"><a href="#ReportingIssues-dotCoverIssues">dotCover问题</a></li><li class="list__item"><a href="#ReportingIssues-JVMCrashes">JVM崩溃</a></li><li class="list__item"><a href="#ReportingIssues-BuildLogIssues">生成日志问题</a></li><li class="list__item"><a href="#ReportingIssues-IntelliJIDEAInspections">IntelliJ IDEA检查</a></li><li class="list__item"><a href="#ReportingIssues-UploadingLargeDataArchives">上载大数据档案</a></li></ul><p></p><a name="BestPracticesWhenReportingIssues"></a><a name="Best-Practices-When-Reporting-Issues"></a><div class="chapter"><h2 id="ReportingIssues-BestPracticesWhenReportingIssues">报告问题的最佳做法</h2><p id="909ba08a">遵循这些准则将确保及时响应并有效解决问题。查看<a href="https://confluence.jetbrains.com/display/TW/Feedback" rel="noopener noreferrer" data-external="true" target="_blank">反馈</a>以找到与我们联系的适当方式。</p><aside class="note " rel="909ba08a" id="814504a7" data-title=""><ul class="list _ul"><li class="list__item" id="0d44c612"><p>如果您的构建逻辑有问题，请确保它是与TeamCity有关的问题（即，没有TeamCity不会<a href="common-problems.html#Build-works-locally-but-fails-or-misbehaves-in-TeamCity">在同一环境中重现</a>问题），并提供调查的详细信息</p></li><li class="list__item" id="cc92a79e"><p>请注意正在使用的<b id="8b8aa66c">TeamCity版本</b> ，包括内部版本号（可以在页脚和teamcity-server.log中找到）。考虑检查问题是否在最新的TeamCity版本中仍然相关；</p></li><li class="list__item" id="d50c20ca"><p>更新您以前在该主题上发布的帖子，而不是创建新帖子，如果您仍然创建重复项，请确保记下与您已创建或找到的同一主题有关的所有以前发布；</p></li><li class="list__item" id="fda04f41"><p>每次提交时发布一个问题，首先发布最重要的问题，或者发布多个其他问题（如果它们与之相关）；</p></li><li class="list__item" id="99d25f55"><p>注意问题的发生方式（第一次，重复发生），之前如何缓解，最近的环境是否发生变化；</p></li><li class="list__item" id="1a342cd1"><p>明确：记下确切时间，错误消息等；</p></li><li class="list__item" id="aa112268"><p>描述预期和实际行为；</p></li><li class="list__item" id="0dfbeaae"><p>详细说明在TeamCity中配置的相关设置（包括屏幕截图，设置文件，实际值， <a href="rest-api.html">REST API</a>实体表示）；</p></li><li class="list__item" id="60a5935a"><p>包括TeamCity UI的相关<b id="387d9655">屏幕截图</b> （在捕获中始终包括整个页面和浏览器URL）；</p></li><li class="list__item" id="283d24aa"><p>将相关的短信作为文本（而不是图像）包括在内，并包含所有详细信息；</p></li><li class="list__item" id="205091a0"><p>在报告构建过程问题时，请尝试在不具有TeamCity的情况下在相同环境中的代理计算机上<a href="common-problems.html#Build-works-locally-but-fails-or-misbehaves-in-TeamCity">重现</a>它们，并让我们知道结果；</p></li><li class="list__item" id="0d132831"><p>不要将大部分文本数据（超过10Kb）包含在电子邮件文本中，而应将其附加到文件中；</p></li><li class="list__item" id="c9256a7d"><p>使用TeamCity <b id="c030e13b">服务器日志</b>附加/ <a href="#Uploading-Large-Data-Archives">上传</a>存档（请参阅<a href="teamcity-server-logs.html">details</a> ，理想情况下是整个<server home="">\ logs目录，其中包含所有目录。如果不切实际，则所有文件将在发布时间前后或更晚更新）；如果与构建时或代理行为有关，请附加整个<agent home="">\ logs目录；</agent></server></p></li><li class="list__item" id="45fc4161"><p>如果特定的构建受到影响，则包括构建日志（通过专用链接从构建结果的“构建日志”选项卡下载）；</p></li><li class="list__item" id="5f696310"><p>对于性能/缓慢/延迟问题，请在问题发生期间进行一组（在整个发布时间内分布10多个）服务器或代理<a href="#Server-Thread-Dump">线程转储</a> ，并确保将包含<a href="#Server-Thread-Dump">相关数据</a>的转储发送给我们；</p></li><li class="list__item" id="eb973183"><p>发送大小大于500Kb或三个以上的文件时，请将它们打包到一个存档中；</p></li><li class="list__item" id="9f92d944"><p>替换/屏蔽日志中的数据时，请注意使用的替换模式；</p></li><li class="list__item" id="01748ea4"><p>请注意，在TeamCity服务器之前是否安装了防病毒软件以及是否有网络代理或反向代理；</p></li><li class="list__item" id="2e836a4e"><p>如果相关，请注意操作系统，任何手动安装的组件（如Java）的版本，使用的TeamCity发行版（.exe，.tar.gz）</p></li><li class="list__item" id="be4aa550"><p>注意任何自定义/非标准环境设置；</p></li><li class="list__item" id="8fc24163"><p>列出所有已安装的非捆绑插件；</p></li><li class="list__item" id="1352ad92"><p>如果有的话，请注意先前对TeamCity数据目录或数据库的手动修改；</p></li><li class="list__item" id="72d42647"><p>在提出改进或功能或要求设置建议时，请详细说明<i id="e9279a84">为什么</i>需要该功能以及要实现的<b id="f12f2f01">原始目标</b>是什么。也欢迎您提供有关<i id="dc1c5126">如何</i>查看该功能的建议；</p></li><li class="list__item" id="e2054435"><p>请查看以下部分以了解常见情况以及要收集并发送给我们的特定信息。</p></li></ul></aside></div><a name="Slowness,HangingsandLowPerformance"></a><a name="Slowness,-Hangings-and-Low-Performance"></a><div class="chapter"><h2 id="ReportingIssues-Slowness,HangingsandLowPerformance">缓慢，绞死和性能低下</h2><p id="5682c3a7">如果TeamCity的运行速度比您预期的要慢，请使用以下注释查找运行缓慢的流程，如果该流程是TeamCity的流程，请向我们发送所有相关详细信息。</p><a name="DetermineWhichProcessIsSlow"></a><a name="Determine-Which-Process-Is-Slow"></a><h4 id="ReportingIssues-DetermineWhichProcessIsSlow">确定哪个进程慢</h4><p id="f01f4ce9">如果您遇到TeamCity Web UI响应缓慢，检查更改过程，服务器端源检出，较长的清除时间或其他缓慢的服务器活动，则您的目标应该是安装TeamCity服务器的计算机。<br>如果问题仅与单个构建有关，则需要调查正在运行该构建的TeamCity代理计算机和服务器。</p><p id="4c736c7e">调查系统资源（CPU，内存，IO）的负载。如果负载很高，请确定导致负载的过程。如果不是与TeamCity相关的过程，则可能需要在TeamCity范围之外进行寻址。此外，还要检查一般的速度下降原因，例如防病毒软件，维护时间等。</p><p id="b358aedc">如果是TeamCity服务器正在加载CPU / IO或没有大量的CPU / IO负载并且除TeamCity之外其他一切都运行良好，则需要进一步研究。</p><p id="bea012ab">检查计算机上是否有任何诸如防病毒<a href="known-issues.html#Conflicting-Software">软件之</a>类的<a href="known-issues.html#Conflicting-Software">冲突软件</a> ，然后禁用/卸载它。</p><p id="c21ba941">检查TeamCity使用的数据库和TeamCity Data Directory的文件存储是否没有性能问题。</p><p id="ca506135">如果您安装了大量TeamCity，请首先检查您的<a href="installing-and-configuring-the-teamcity-server.html#Setting-Up-Memory-settings-for-TeamCity-Server">内存设置</a> 。</p><a name="CollectData"></a><a name="Collect-Data"></a><h4 id="ReportingIssues-CollectData">收集数据</h4><p id="465abe23">在慢速操作期间，以5到10秒的间隔进行慢速进程的多个线程转储（请参阅下面的线程转储方法）。如果继续缓慢，请进行更多次线程转储（例如，在几分钟内执行3-5次），然后在一段时间（例如10分钟）后重复一次，同时进程仍在缓慢进行。</p><p id="a7491e53">然后， <a href="https://confluence.jetbrains.com/display/TW/Feedback" rel="noopener noreferrer" data-external="true" target="_blank">将</a>有关问题的详细说明与线程转储和涵盖该问题的完整服务器（或代理） <a href="#Logging-events">日志</a>一起<a href="https://confluence.jetbrains.com/display/TW/Feedback" rel="noopener noreferrer" data-external="true" target="_blank">发送给</a>我们。除非出于某种原因而不希望这样做，否则首选方式是将问题提交到我们的<a href="http://youtrack.jetbrains.com/issues/TW" rel="noopener noreferrer" data-external="true" target="_blank">问题跟踪器，</a>并通过支持电子邮件告知我们。请提供调查的所有相关详细信息，包括CPU / IO负载信息，什么是慢速行为，什么不是慢速行为，注意受影响的URL，可见效果等。对于大量数据，请使用<a href="#Uploading-Large-Data-Archives">我们的文件上传</a>服务与我们共享档案。</p><a name="ServerThreadDump"></a><a name="Server-Thread-Dump"></a><div class="chapter"><h3 id="ReportingIssues-ServerThreadDump">服务器线程转储</h3><p id="9237b239">当服务器上的操作缓慢时，请采取一组分布在缓慢时间内的服务器线程转储（10+）。TeamCity在超慢操作时自动保存线程转储，因此可能已经在其中保存了一些<code class="code">logs/threadDumps-<date></code>目录。建议您将服务器全部内容的存档发送给我们。 <code class="code"><</code> <a href="teamcity-home-directory.html"><code class="code">TeamCity Home</code></a> <code class="code">>/logs/threadDumps-<date></code>所有最近日期的目录。</p><p id="ecff66a5">建议你从Web UI中的TeamCity服务器的线程转储如果挂是本地的，你仍然可以打开TeamCity的<b id="47795ae7">管理</b>页面：进入<b id="4709df06">管理</b> | <b id="64b28d88">服务器管理</b> | <b id="19bf32b1">在诊断</b>页面上，点击<b id="e080bef0">保存线程转储</b>按钮，将转储保存在<code class="code"><</code> <a href="teamcity-home-directory.html"><code class="code">TeamCity Home</code></a> <code class="code">>/logs/threadDumps-<date></code>目录（以后可以从“服务器日志”下载文件）。如果服务器已完全启动，但Web UI没有响应，请使用TeamCity服务器的实际URL尝试<a href="http://YOUR_TEAMCITY_SERVER_URL/admin/diagnostic.html?actionName=threadDump&save=false" rel="noopener noreferrer" data-external="true" target="_blank">直接URL</a> 。</p><p id="e9f83d64">如果无法访问UI（或服务器尚未完全启动），则可以使用<a href="#Taking-Thread-Dump">下面</a>介绍的方法手动进行服务器线程转储。</p><p id="bf82d087">您也可以调整<code class="code">teamcity.diagnostics.requestTime.threshold.ms=30000</code> <a href="configuring-teamcity-server-startup-properties.html#TeamCity-internal-properties">内部属性</a>以更改超时，之后将在<code class="code">threadDumps-<date></code>每当有用户发起的Web请求花费的时间超过超时时间时，TeamCity日志下的目录。</p></div><a name="CollectingCPUProfilingDataonServer"></a><a name="Collecting-CPU-Profiling-Data-on-Server"></a><div class="chapter"><h3 id="ReportingIssues-CollectingCPUProfilingDataonServer">在服务器上收集CPU分析数据</h3><p id="096eb94e">如果您遇到服务器性能下降的情况，并且TeamCity服务器进程产生大量的CPU负载，请获取CPU配置文件快照，并将其与您正在执行的操作以及系统设置的详细说明一起发送给我们。您可以通过安装<a href="https://plugins.jetbrains.com/plugin/8979-server-profiling" rel="noopener noreferrer" data-external="true" target="_blank">服务器配置文件插件</a>并按照插件页面上的说明获取CPU配置文件和内存快照。</p><p id="c65cb349">以下是从CPU性能分析中获得最佳结果的一些提示：</p><ul class="list _ul"><li class="list__item" id="9a833b46"><p>启动服务器后，请等待一段时间以使其“热身”。根据TeamCity存储的数据量，这可能需要5到20分钟。</p></li><li class="list__item" id="10b5d982"><p>当服务器上发现CPU使用率增加时，请尝试指出导致加载的操作。</p></li><li class="list__item" id="bb4044ff"><p>启动CPU分析，并重复几次该操作（5-10）。</p></li><li class="list__item" id="7bf89182"><p>捕获快照。</p></li><li class="list__item" id="6346aac4"><p>存档快照并将其发送给我们，包括导致CPU负载的操作说明。</p></li></ul></div><a name="AgentThreadDump"></a><a name="Agent-Thread-Dump"></a><div class="chapter"><h3 id="ReportingIssues-AgentThreadDump">代理线程转储</h3><p id="9a523b58">建议您从Web UI中进行代理线程转储：转到“代理”页面的“ <b id="88d8b854">代理摘要”</b>选项卡，然后使用“ <b id="eb9838c9">在代理上转储线程”</b>操作。</p><p id="38eea9a4">如果无法访问UI，则可以使用<a href="#Taking-Thread-Dump">下面</a>介绍的方法手动使用转储线程。请注意，TeamCity代理包含两个<code class="code">java</code>流程：启动器和代理本身。该代理由启动器触发。通常，您将对代理（嵌套）过程感兴趣，而不对启动器感兴趣。</p></div><a name="TakingThreadDump"></a><a name="Taking-Thread-Dump"></a><div class="chapter"><h3 id="ReportingIssues-TakingThreadDump">进行线程转储</h3><p id="abf6dd22">如果您无法从TeamCity Web UI进行线程转储，这些功能将有所帮助。</p><p id="c663f316">进行线程转储：</p><a name="UnderWindows"></a><a name="Under-Windows"></a><div class="chapter"><h4 id="ReportingIssues-UnderWindows">在Windows下</h4><p id="174a4c39">您有几种选择：</p><ul class="list _ul"><li class="list__item" id="347b78b2"><p>要在服务器从控制台运行时进行服务器线程转储，请在控制台窗口中按<b id="90c8dd15">Ctrl + Break</b> （在某些键盘上为Ctrl + Pause）（这不适用于代理，因为其控制台属于启动程序进程）。如果服务器作为服务运行，请尝试通过在控制台中以与服务中配置相同的方式登录并执行日志来从控制台运行它<code class="code"><TeamCity server home>\bin\teamcity-server.bat run</code>命令。另一种方法是找出TeamCity服务器进程的进程ID（它是带有“ org.apache.catalina.startup”的最顶级“ java”过程。在命令行末尾使用Bootstrap start”，并使用以下方法：</p></li><li class="list__item" id="329e6455"><p>跑<code class="code">jstack <pid_of_java_process></code>在该进程用于Java安装的bin目录中（可以在进程命令行中查找Java主页。如果安装中没有jstack实用程序，则可能需要通过java -version命令获取Java版本，下载相同版本的完整JDK，然后在其中使用“ jstack”实用程序形式。您可能还需要提供<code class="code">-F</code>标记命令。</p></li><li class="list__item" id="4c87f6a1"><p>使用TeamCity捆绑的代理线程转储工具（可以在代理的插件中找到）。运行命令：</p></li></ul><div class="code-block" data-lang="bash">
<teamcity agent="">\ plugins \ stacktraces插件\ bin \ x86 \ JetBrains。TeamCity。进样器<pid_of_java_process>

</pid_of_java_process></teamcity></div><p id="13376a5b">请注意，如果挂起进程作为服务运行，则线程转储工具必须从具有提升权限的控制台（使用“以管理员身份运行”）运行。如果该服务在系统帐户下运行，则可能还需要通过<a href="http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx" rel="noopener noreferrer" data-external="true" target="_blank">PsExec.exe</a>启动线程转储工具。 <code class="code">-s <path to the tool>\<tool> <options></code> 。在普通用户下运行服务时，将工具调用包装在“ <code class="code">PsExec.exe -u <user> -p <password> <path to the tool>\<tool> <options></code>可能也有帮助。</p><p id="384103f9">如果以上两种方法均不适用于作为服务<a href="installing-and-configuring-the-teamcity-server.html#Starting-TeamCity-server">运行的服务器</a> ，请尝试从控制台而不是作为服务<a href="installing-and-configuring-the-teamcity-server.html#Starting-TeamCity-server">运行服务器</a> 。这样，可以使用第一个（Ctrl + Break）选项。</p></div><a name="UnderLinux"></a><a name="Under-Linux"></a><div class="chapter"><h4 id="ReportingIssues-UnderLinux">在Linux下</h4><ul class="list _ul"><li class="list__item" id="4b55e592"><p>跑<code class="code">jstack <pid_of_java_process></code> （使用该过程所使用的Java安装中的jstack）或<code class="code">kill -3 <pid_of_java_process></code> 。在后一种情况下，输出将出现在<code class="code"><</code> <a href="teamcity-home-directory.html"><code class="code">TeamCity Home</code></a> <code class="code">>logs/catalina.out</code>要么<code class="code"><</code> <a href="agent-home-directory.html"><code class="code">TeamCity agent home</code></a> <code class="code">>/logs/error.log</code> 。</p></li></ul><p id="654e5a55">另请参见上面的“ <a href="#Determine-Which-Process-Is-Slow">服务器性能”</a>部分。</p></div></div><a name="Database-relatedSlowdowns"></a><a name="Database-related-Slowdowns"></a><div class="chapter"><h3 id="ReportingIssues-Database-relatedSlowdowns">与数据库有关的减速</h3><p id="71062722">服务器运行缓慢时，请检查问题是否由数据库操作引起。建议使用特定于数据库的工具。</p><p id="144dbc59">您也可以使用<code class="code">debug-sql</code>服务器<a href="teamcity-server-logs.html#Logging-related-Diagnostics-UI">日志预设</a> 。启用后，所有耗时1秒以上的查询都会登录到<code class="code">teamcity-sql.log</code>文件。可以通过设置时间来更改时间<code class="code">teamcity.sqlLog.slowQuery.threshold</code> <a href="configuring-teamcity-server-startup-properties.html#TeamCity-internal-properties">内部财产</a> 。该值应以毫秒为单位设置，默认情况下为1000。</p><a name="MySQL"></a><a name="MySQL"></a><div class="chapter"><h4 id="ReportingIssues-MySQL">的MySQL</h4><p id="2fbb7413">与服务器线程转储一起，确保附加了<code class="code">show processlist;</code>在MySQL控制台中执行的SQL命令。与线程转储一样，如果发生缓慢，则多次执行命令并向我们发送输出是有意义的。另外，可以设置MySQL以记录执行中的更改所引起的长时间查询的日志<code class="code">my.ini</code> ：</p><div class="code-block" data-lang="bash">[mysqld] ...日志慢查询long_query_time = 15</div><p id="8614d442">日志也可以发送给我们进行分析。</p></div></div></div><a name="OutOfMemoryProblems"></a><a name="OutOfMemory-Problems"></a><div class="chapter"><h2 id="ReportingIssues-OutOfMemoryProblems">内存不足问题</h2><p id="ddd1b540">如果您遇到TeamCity消耗过多内存或日志中出现“ OutOfMemoryError” /“ Java堆空间”错误的问题，请执行以下操作：</p><ul class="list _ul"><li class="list__item" id="f660db62"><p>确定哪个过程遇到错误（实际的构建过程，TeamCity服务器或TeamCity代理）。您可以使用“ <b id="6a8f83c3">管理” |</b> “ <b id="6a8f83c3">管理” |</b> “图表”跟踪TeamCity的内存和CPU使用情况<b id="6a8f83c3">。服务器管理|</b> TeamCity Web UI的“ <b id="6a8f83c3">诊断”</b>页面。</p></li><li class="list__item" id="72d1b6f3"><p>如果是服务器的罪魁祸首，请检查是否已将内存设置从默认设置增加到了可以在生产环境中使用服务器（请参阅<a href="installing-and-configuring-the-teamcity-server.html#Setting-Up-Memory-settings-for-TeamCity-Server">参考资料部分</a> ）。</p></li><li class="list__item" id="d8439982"><p>如果应归咎于构建过程，请在构建运行器中设置“ JVM命令行参数”设置。增加价值<code class="code">-Xmx</code> JVM选项：例如， <code class="code">-Xmx1200m</code> 。请注意，Java Inspections构建可能特别需要增加<code class="code">-Xmx</code>值。</p></li><li class="list__item" id="a434b4b8">如果应归咎于TeamCity服务器，而增加内存大小无济于事，请报告此情况，以供我们调查。为此，尽管服务器的内存消耗很高，但是<a href="#Taking-Thread-Dump">如上所述</a> ，请进行几个服务器线程转储，获取内存转储（请参见下文），以及所有服务器日志，包括<code class="code">threadDumps-*</code>子目录，将结果存档，然后<a href="#Uploading-Large-Data-Archives">将其发送</a>给我们进行进一步分析。确保<code class="code">-Xmx</code>设置小于8Gb之前获得转储：<ul class="list _ul"><li class="list__item" id="37e9b589"><p id="35d771a5">如果内存转储（ <code class="code">hprof</code>文件）自动创建， <code class="code">java\_xxx.hprof</code>在进程启动目录（< <a href="teamcity-home-directory.html">TeamCity Home</a> > / bin或< <a href="agent-home-directory.html">TeamCity Agent home</a> > / bin`）中创建文件；</p></li><li class="list__item" id="3f6145a4"><p id="79848887">对于服务器，还可以在内存使用量达到峰值时手动进行内存转储。转到<b id="36bddb07">管理|服务器管理|</b>在TeamCity Web UI的“ <b id="36bddb07">诊断”</b>页面上，然后单击<b id="bb158a3c">转储内存快照</b> 。</p></li><li class="list__item" id="1e46fa58"><p id="48802022">手动进行内存转储的另一种方法是使用<code class="code">jmap</code>完整JVM安装的标准JVM命令行实用程序，该版本与该进程使用的Java版本相同。示例命令行是：</p><div class="code-block" data-lang="bash">jmap -dump：file = <file_on_disk_to_save_dump_into>.hprof <pid_of_the_process>
</pid_of_the_process></file_on_disk_to_save_dump_into></div></li></ul></li></ul><p id="9c77e067">请参阅如何更改<a href="configuring-teamcity-server-startup-properties.html#JVM-Options">服务器</a>和<a href="configuring-build-agent-startup-properties.html#Agent-Properties">代理的</a> JVM选项。</p></div><a name="" toomanyopenfile="error" =""></a><a name="" too-many-open-file="-error" =""></a><div class="chapter"><h2 id="ReportingIssues-" toomanyopenfile="error" ="">“打开的文件太多”错误</h2><ol class="list _decimal"><li class="list__item" id="180fa6f0"><p>确定发生在什么计算机上</p></li><li class="list__item" id="a89bc616"><p>确定打开大量文件的过程和文件列表（在Linux上使用<code class="code">lsof</code> ，在Windows上，您可以使用<a href="http://technet.microsoft.com/en-us/sysinternals/bb896655" rel="noopener noreferrer" data-external="true" target="_blank">handle</a>或<a href="http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx" rel="noopener noreferrer" data-external="true" target="_blank">TCPView</a>列出套接字）</p></li><li class="list__item" id="283702ca"><p>如果数量少于数千，请检查操作系统和文件句柄的进程限制（在Linux上使用<code class="code">ulimit -n</code> ），并在必要时增加它们。请注意，对于像TeamCity这样的服务器应用程序，每个进程的默认Linux 1024句柄太小了。将数字增加到至少16000。更改后检查实际的流程限制，因为操作系统中有用于全局和每个会话限制的设置（例如，请参见<a href="http://stackoverflow.com/questions/13988780/too-many-open-files-ulimit-already-changed" rel="noopener noreferrer" data-external="true" target="_blank">帖子</a> ）</p></li></ol><p id="eb63c2d3">如果文件数量很大并且看上去可疑，并且锁定过程是TeamCity的锁定过程（没有运行其他Web应用程序的TeamCity代理或服务器），则在问题仍然存在的情况下，使用以下方法多次获取打开的句柄列表：间隔几分钟，并将结果与相关详细信息一起发送给我们进行调查。</p><p id="313a386a">请注意，在调查之后，您很可能需要重新启动机器并出现错误，以恢复应用程序的正常功能。</p></div><a name="Agentdoesnotconnecttotheserver"></a><a name="Agent-does-not-connect-to-the-server"></a><div class="chapter"><h2 id="ReportingIssues-Agentdoesnotconnecttotheserver">代理未连接到服务器</h2><p id="13e948f9">请参考<a href="common-problems.html#Started-Build-Agent-is-not-available-on-the-server-to-run-builds">常见问题</a></p></div><a name="Loggingevents"></a><a name="Logging-events"></a><div class="chapter"><h2 id="ReportingIssues-Loggingevents">记录事件</h2><p id="08f60119">TeamCity服务器和代理创建的日志可用于调查问题。</p><aside class="note " rel="08f60119" id="4d18803f" data-title=""><p id="6932ede3">在重现该问题之前，有必要为TeamCity类启用“ DEBUG”日志级别。在服务器端，转到<b id="c0ded3a1">管理</b> | <b id="6fe80ca8">服务器管理</b> | <b id="6cc79eb8">在“诊断”</b>页面上，选择日志记录预设（ <code class="code">debug-all</code> ， <code class="code">debug-vcs</code>等）。之后，DEBUG消息将转到<code class="code">teamcity-*.log</code>文件（ <a href="teamcity-server-logs.html">了解更多</a> ）。</p></aside><p id="3ca1133f">有关详细信息，请参阅相应的部分：</p><ul class="list _ul"><li class="list__item" id="8c6dd787"><a href="teamcity-server-logs.html">TeamCity服务器日志</a></li><li class="list__item" id="229597c3"><a href="viewing-build-agent-logs.html">查看构建代理日志</a></li></ul><a name="VersionControldebuglogging"></a><a name="Version-Control-debug-logging"></a><div class="chapter"><h3 id="ReportingIssues-VersionControldebuglogging">版本控制调试日志记录</h3><aside class="note " rel="ReportingIssues-VersionControldebuglogging" id="e0467c26" data-title=""><p id="e7f22202">要在服务器端启用VCS日志记录，请在管理Web UI中将<a href="teamcity-server-logs.html">日志记录预设切换</a>为“ debug-vcs”，然后检索<code class="code">logs/teamcity-vcs.log</code>日志文件。</p></aside><p id="19947a98">大多数VCS操作都发生在TeamCity服务器上，但是如果您使用<a href="vcs-checkout-mode.html#agent-checkout">代理端检出</a> ，则VCS检出将发生在构建代理上。</p><p id="444b0be0">对于代理和服务器，您可以在以下位置手动更改Log4j配置： <code class="code"><</code> <a href="teamcity-home-directory.html"><code class="code">TeamCity Home</code></a> <code class="code">>/conf/teamcity-server-log4j.xml</code>要么<code class="code"><</code> <a href="agent-home-directory.html"><code class="code">BuildAgent home</code></a> <code class="code">>/conf/teamcity-agent-log4j.xml</code>文件包含以下片段：</p><div class="code-block" data-lang="bash">
<category name="jetbrains.buildServer.VCS" additivity="false">
    <appender-ref ref="ROLL.VCS"></appender-ref>
    <appender-ref ref="CONSOLE-ERROR"></appender-ref>
    <priority value="DEBUG"></priority>
</category>
 
<category name="jetbrains.buildServer.buildTriggers.vcs" additivity="false">
    <appender-ref ref="ROLL.VCS"></appender-ref>
    <appender-ref ref="CONSOLE-ERROR"></appender-ref>
    <priority value="DEBUG"></priority>
</category>

</div><p id="98b14c1d">请务必更新<code class="code"><appender name="ROLL.VCS"></code>节点以增加要存储的文件数：</p><div class="code-block" data-lang="bash">
    <param name="maxBackupIndex" value="30">

</div><p id="8631b4d0">如果特定版本控件有单独的日志记录选项，则将在下面进行描述。</p><a name="Subversiondebuglogging"></a><a name="Subversion-debug-logging"></a><div class="chapter"><h4 id="ReportingIssues-Subversiondebuglogging">Subversion调试日志记录</h4><aside class="note " rel="ReportingIssues-Subversiondebuglogging" id="cefeaf95" data-title=""><p id="87c60d93">要在服务器端启用SVN日志记录，请在管理Web UI <a href="teamcity-server-logs.html">中将日志记录预设切换</a>为“ debug-SVN”，然后检索<code class="code">logs/teamcity-vcs.log</code>和<code class="code">logs/teamcity-svn.log</code>文件。</p></aside><p id="1724c13a">代理程序端日志记录还需要一种替代的手动方法。</p><p id="782e871e">首先， <a href="#Version-Control-debug-logging">如上所述</a> ，启用常规VCS调试日志记录。</p><p id="d82032b8">取消注释与SVN相关的部分（ <code class="code">SVN.LOG</code>附加器和<code class="code">javasvn.output</code>服务器和代理上的Log4j配置文件的“类别”）（如果使用了<a href="vcs-checkout-mode.html#agent-checkout">代理端检出</a> ）。日志将保存到<code class="code">logs/teamcity-svn.log</code>文件。通用VCS日志也应取自<code class="code">logs/teamcity-vcs.log</code></p></div><a name="ClearCase"></a><a name="ClearCase"></a><div class="chapter"><h4 id="ReportingIssues-ClearCase">ClearCase</h4><p id="f0eac822">取消注释与Clearcase相关的行<code class="code"><</code> <a href="teamcity-home-directory.html"><code class="code">TeamCity Home</code></a> <code class="code">>/conf/teamcity-server-log4j.xml</code>文件。日志将保存到<code class="code">logs/teamcity-clearcase.log</code>目录。</p></div></div></div><a name="PatchApplicationProblems"></a><a name="Patch-Application-Problems"></a><div class="chapter"><h2 id="ReportingIssues-PatchApplicationProblems">补丁申请问题</h2><p id="c54a88be">如果使用<a href="vcs-checkout-mode.html#server-checkout">服务器端检出</a> ，则可以通过以下方式检索从服务器传递到代理的“补丁”：</p><ul class="list _ul"><li class="list__item" id="aebca244"><p>添加属性<code class="code">system.agent.save.patch=true</code>到构建配置。</p></li><li class="list__item" id="fa29f58a"><p>触发构建。构建日志和代理日志将包含“补丁已保存到文件$ {file.name}”行。获取文件并提供问题描述。</p></li></ul></div><a name="Loggingfor.NETRunners"></a><a name="Logging-for-.NET-Runners"></a><div class="chapter"><h2 id="ReportingIssues-Loggingfor.NETRunners">记录.NET运行程序</h2><p id="eee43eaf">若要调查<a href="supported-platforms-and-environments.html#Supported-.NET-platform-build-runners">与.NET相关的运行</a>程序的进程启动问题，请按如下所述启用调试。然后，详细信息将被打印到构建日志中。建议不要长时间放置调试日志，并在调查后恢复设置。</p><p id="d310d3a7">另一种启用日志记录的方法如下：添加<code class="code">teamcity.agent.dotnet.debug=true</code> <a href="configuring-build-parameters.html">配置参数</a>在构建配置中或在代理上，然后运行构建。</p><ol class="list _decimal"><li class="list__item" id="f5a33fd5"><p>打开<code class="code"><</code> <a href="agent-home-directory.html"><code class="code">agent home</code></a> <code class="code">>/plugins/dotnetPlugin/bin</code>夹。</p></li><li class="list__item" id="69a2d9d5"><p>制作以下内容的备份副本<code class="code">teamcity-log4net.xml</code></p></li><li class="list__item" id="9dad462b"><p>更换<code class="code">teamcity-log4net.xml</code>与内容<code class="code">teamcity-log4net-debug.xml</code></p></li></ol><aside class="note " rel="7770fa4d" id="ce8a6d38" data-title=""><p id="b324dee3">创建调试日志后，建议回滚更改。的变化<code class="code">teamcity-log4net.xml</code>将在构建代理自动升级中删除。</p></aside></div><a name="RemoteRunProblems"></a><a name="Remote-Run-Problems"></a><div class="chapter"><h2 id="ReportingIssues-RemoteRunProblems">远程运行问题</h2><p id="fbdc745d">可以从服务器检索从IDE发送到<a href="remote-run.html">远程运行</a>的服务器的更改。 <code class="code">.BuildServer/system/changes</code>目录。找到<code class="code"><change_number>.changes</code>与您的更改相对应的文件（您可以选择可用的最新编号，或从网络UI推断更改的URL）。该文件包含二进制格式的补丁。请发送问题说明。</p></div><a name="LogginginIntelliJIDEA/Platform-basedIDEs"></a><a name="Logging-in-IntelliJ-IDEA/Platform-based-IDEs"></a><div class="chapter"><h2 id="ReportingIssues-LogginginIntelliJIDEA/Platform-basedIDEs">登录IntelliJ IDEA /基于平台的IDE</h2><p id="71b4947b">要为基于<a href="intellij-platform-plugin.html">IntelliJ Platform的IDE插件</a>启用调试日志记录，请将以下片段包括到的Log4j配置中。 <code class="code"><IDE home>/bin/log.xml</code>文件：</p><div class="code-block" data-lang="bash">
<appender name="TC-FILE" class="org.apache.log4j.RollingFileAppender">
  <param name="MaxFileSize" value="10Mb">
  <param name="MaxBackupIndex" value="10">
  <param name="file" value="$LOG_DIR$/idea-teamcity.log">
  <layout class="org.apache.log4j.PatternLayout">
    <param name="ConversionPattern" value="%d [%7r] %6p - %30.30c - %m \n">
  </layout>
</appender>
 
<appender name="TC-XMLRPC-FILE" class="org.apache.log4j.RollingFileAppender">
  <param name="MaxFileSize" value="10Mb">
  <param name="MaxBackupIndex" value="10">
  <param name="file" value="$LOG_DIR$/idea-teamcity-xmlrpc.log">
  <layout class="org.apache.log4j.PatternLayout">
    <param name="ConversionPattern" value="%d [%7r] %6p - %30.30c - %m \n">
  </layout>
</appender>
 
<category name="jetbrains.buildServer.XMLRPC" additivity="false">
  <priority value="DEBUG"></priority>
  <appender-ref ref="TC-XMLRPC-FILE"></appender-ref>
</category>
 
<category name="jetbrains.buildServer" additivity="false">
  <priority value="DEBUG"></priority>
  <appender-ref ref="TC-FILE"></appender-ref>
</category>

</div><p id="f31de437">更改此文件后，重新启动IDE。 TeamCity插件调试日志保存到<code class="code">idea-teamcity\*</code>文件，并将显示在<a href="http://www.jetbrains.com/idea/webhelp/project-and-ide-settings.html#d1270417e197" rel="noopener noreferrer" data-external="true" target="_blank">IDE设置</a>的日志目录中（ <code class="code"><IDE settings/Data Directory>/system/log</code>目录）。</p><a name="OpeninIDEFunctionalityLogging"></a><a name="Open-in-IDE-Functionality-Logging"></a><div class="chapter"><h3 id="ReportingIssues-OpeninIDEFunctionalityLogging">在IDE中打开功能日志</h3><p id="0aa8e1fd">（适用于IntelliJ IDEA和Eclipse）在启动IDE之前添加以下JVM选项：<br><code class="code">-Dteamcity.activation.debug=true</code></p><p id="e4cd6696">与<b id="49579264">IDE中打开</b>功能相关的日志记录将显示在IDE <i id="19b60225">控制台中</i> 。</p></div><a name="NoSuitableBuildConfigurationsFoundforRemoteRun"></a><a name="No-Suitable-Build-Configurations-Found-for-Remote-Run"></a><div class="chapter"><h3 id="ReportingIssues-NoSuitableBuildConfigurationsFoundforRemoteRun">找不到适用于远程运行的合适的构建配置</h3><p id="0c59d230">首先，检查<a href="http://www.jetbrains.com/idea/webhelp/configuring-general-vcs-settings.html" rel="noopener noreferrer" data-external="true" target="_blank">IDEA</a>中的<a href="configuring-vcs-settings.html">VCS设置是否</a>与TeamCity中的<a href="configuring-vcs-settings.html">VCS设置</a>相对应。如果没有，请进行更改，这样可以解决问题。</p><p id="43f0f078">其次，请检查您希望适合IDEA项目的构建配置是否具有<a href="vcs-checkout-mode.html#server-checkout">服务器端VCS签出模式</a>或<a href="vcs-checkout-mode.html#agent-checkout">代理程序端签出</a>以及非手动VCS签出模式（无法通过手动签出模式，因为TeamCity必须在完成VCS签出后应用该修补程序，但它不知道或管理执行该补丁的时间。</p><p id="b59ee96f">如果设置相同，并且您没有使用手动签出模式，但是存在问题，请执行以下操作：</p><ul class="list _ul"><li class="list__item" id="4f359b24"><p>向我们提供您的IDEA VCS设置和TeamCity VCS设置（对于您希望适合IDEA项目的构建配置）</p></li><li class="list__item" id="9afb31ce"><p>启用TeamCity IntelliJ插件的调试日志（请参见<a href="#Logging-in-IntelliJ-IDEA/Platform-based-IDEs">上文</a> ）</p></li><li class="list__item" id="9ea5ca05"><p>启用TeamCity服务器调试日志（请参见<a href="#Logging-events">上文</a> ）</p></li><li class="list__item" id="1ddffe78"><p>在<a href="intellij-platform-plugin.html">TeamCity IntelliJ插件中</a> ，尝试启动远程运行构建</p></li><li class="list__item" id="08b0f32b"><p>向我们提供来自TeamCity IntelliJ插件和TeamCity服务器的调试日志。</p></li></ul></div></div><a name="LogginginTeamCityEclipseplugin"></a><a name="Logging-in-TeamCity-Eclipse-plugin"></a><div class="chapter"><h2 id="ReportingIssues-LogginginTeamCityEclipseplugin">登录TeamCity Eclipse插件</h2><p id="db0c7d73">要启用<a href="eclipse-plugin.html">插件的</a>跟踪，请使用<code class="code">-debug <filename></code>命令行参数。的<code class="code"><filename></code>参数的一部分应该是包含键值对的属性文件。每个属性的名称均与插件模块相对应，其值为<code class="code">true</code> （启用调试）或<code class="code">false</code> 。这是启用最常见跟踪选项的示例：</p><div class="code-block" data-lang="bash">jetbrains.teamcity.core / debug =真jetbrains.teamcity.core / debug / communications =假jetbrains.teamcity.core / debug / ui =真jetbrains.teamcity.core / debug / vcs =真jetbrains.teamcity.core / debug / vcs / detail = true jetbrains.teamcity.core / debug / parser = true jetbrains.teamcity.core / debug / platform = true jetbrains.teamcity.core / debug / teamcity = true jetbrains.teamcity.core / perfomance / vcs = true jetbrains .teamcity.core / perfomance / teamcity = true</div><p id="6496ab99">阅读有关Eclipse调试模式的更多信息， <a href="http://www.eclipse.org/eclipse/platform-core/documents/3.1/debug.html" rel="noopener noreferrer" data-external="true" target="_blank">收集</a>有关<a href="http://www.eclipse.org/eclipse/platform-core/documents/3.1/debug.html" rel="noopener noreferrer" data-external="true" target="_blank">您的插件</a>和内置Eclipse帮助的信息。</p></div><a name="TeamCityVisualStudioAddinissues"></a><a name="TeamCity-Visual-Studio-Addin-issues"></a><div class="chapter"><h2 id="ReportingIssues-TeamCityVisualStudioAddinissues">TeamCity Visual Studio插件问题</h2><a name="TeamCityAddinlogging"></a><a name="TeamCity-Addin-logging"></a><div class="chapter"><h3 id="ReportingIssues-TeamCityAddinlogging">TeamCity插件日志记录</h3><p id="dfc7427f">要从TeamCity <a href="visual-studio-addin.html">Visual Studio插件</a>捕获日志：</p><ol class="list _decimal"><li class="list__item" id="78d13dc1"><p id="8c3a20ae">找到Visual Studio安装目录（在下面的示例中） <code class="code">c:\Program Files (x86)\Microsoft Visual Studio\2017\Common7\IDE</code> ）</p></li><li class="list__item" id="25806870"><p id="0db84c8a">运行Microsoft Visual Studio可执行文件（ <code class="code">INSTALLATION_DIRECTORY\Common7\IDE\devenv.exe</code> ），并使用与ReSharper相关的命令行参数：</p><ul class="list _ul"><li class="list__item" id="3d6fbe0d"><p>对于<a href="https://www.jetbrains.com/dotnet/" rel="noopener noreferrer" data-external="true" target="_blank">ReSharper Ultimate的</a> TeamCity VS加载项，请使用<code class="code">/ReSharper.LogFile <PATH_TO_FILE></code>和<code class="code">/ReSharper.LogLevel <Normal|Verbose|Trace></code>开关</p><div class="code-block" data-lang="bash">c：\ Program Files（x86）\ Microsoft Visual Studio \ 2017 \ Common7 \ IDE> devenv.exe / ReSharper。日志文件C：\ Users \ jetbrains \ Desktop \ vs.log / ReSharper。LogLevel详细</div><p></p></li><li class="list__item" id="3a12c543"><p>对于旧版的TeamCity VS加载项，请使用<code class="code">/TeamCity.LogFile <PATH_TO_FILE></code>和<code class="code">/TeamCity.LogLevel <Normal|Verbose|Trace></code>开关</p></li></ul></li></ol></div><a name="VisualStudiologging"></a><a name="Visual-Studio-logging"></a><div class="chapter"><h3 id="ReportingIssues-VisualStudiologging">Visual Studio日志记录</h3><p id="ac4c1835">若要解决常见的Visual Studio，请运行Microsoft Visual Studio可执行文件<code class="code">INSTALLATION_DIRECTORY\Common7\IDE\devenv.exe</code>与<code class="code">/</code> <a href="http://msdn.microsoft.com/en-us/library/ms241272.aspx" rel="noopener noreferrer" data-external="true" target="_blank">记录</a>命令行切换并将结果日志文件发送给我们。</p></div></div><a name="dotCoverIssues"></a><a name="dotCover-Issues"></a><div class="chapter"><h2 id="ReportingIssues-dotCoverIssues">dotCover问题</h2><p id="d37bb639">要收集<a href="jetbrains-dotcover.html">JetBrains dotCover</a>生成的其他日志，请添加<code class="code">teamcity.agent.dotCover.log</code>构建配置的<a href="configuring-build-parameters.html">配置参数</a> ，并具有代理上空目录的路径。所有dotCover日志文件将放置在此处，TeamCity将发布压缩日志作为隐藏的构建工件<code class="code">.teamcity/.NETCoverage/dotCoverLogs.zip</code> 。</p></div><a name="JVMCrashes"></a><a name="JVM-Crashes"></a><div class="chapter"><h2 id="ReportingIssues-JVMCrashes">JVM崩溃</h2><p id="ec06c2c6">在极少数情况下，TeamCity服务器或代理进程意外终止而没有明显原因，这可能是由Java运行时崩溃引起的。如果发生这种情况，JVM会定期创建一个名为<code class="code">hs_err_pid*.log</code>在进程的工作目录中。工作目录通常是<code class="code"><</code> <a href="teamcity-home-directory.html"><code class="code">TeamCity server</code></a> <code class="code">></code>要么<a href="agent-home-directory.html"><code class="code">agent home</code></a> <code class="code">>/bin</code> 。<br>在Windows下作为服务运行时，可以像其他<code class="code">C:\Windows\SysWOW64</code> 。您也可以在磁盘中搜索名称中带有“ hs_err_pid”的最新文件。另请参阅本<a href="http://www.oracle.com/technetwork/java/javase/felog-138657.html" rel="noopener noreferrer" data-external="true" target="_blank">文档中</a>的相关“致命错误日志”部分。</p><p id="69a6c4d5">请将此文件发送给我们进行调查，并考虑将<a href="installing-and-configuring-the-teamcity-server.html#Java-Installation">服务器</a> （或<a href="setting-up-and-running-additional-build-agents.html#Configuring-Java">代理</a> ）的JVM更新到可用的最新版本。</p><p id="82536821">如果您得到“没有足够的内存，Java运行时环境将无法继续。崩溃或崩溃报告文件中的本机内存分配（malloc）无法分配...“消息，请确保<a href="installing-and-configuring-the-teamcity-server.html#Using-64-bit-Java-to-Run-TeamCity-Server">切换到64位JVM</a>或减少<code class="code">-Xmx</code>在下面设置<code class="code">1024m</code> ，请参阅“ <a href="installing-and-configuring-the-teamcity-server.html#Setting-Up-Memory-settings-for-TeamCity-Server">内存配置”部分</a>中的详细信息。</p></div><a name="BuildLogIssues"></a><a name="Build-Log-Issues"></a><div class="chapter"><h2 id="ReportingIssues-BuildLogIssues">生成日志问题</h2><p id="322b77a3">在调查与构建日志有关的问题时，我们可能需要TeamCity存储的原始二进制构建日志。可以通过Web UI从“构建日志”构建的选项卡中下载它：选择“详细”日志详细信息，并使用右上角的“原始消息文件”链接。</p></div><a name="IntelliJIDEAInspections"></a><a name="IntelliJ-IDEA-Inspections"></a><div class="chapter"><h2 id="ReportingIssues-IntelliJIDEAInspections">IntelliJ IDEA检查</h2><p id="c63c0ff7">TeamCity构建的检查结果可能与IntelliJ IDEA中本地运行的检查不匹配。</p><p id="d9a405e3">为了帮助我们调查检查问题，请执行以下操作：</p><ol class="list _decimal"><li class="list__item" id="8b7ca363"><p>加<code class="code">system.teamcity.dont.delete.temp.result.dir=true</code> <a href="configuring-build-parameters.html">配置参数</a></p></li><li class="list__item" id="9d84b273"><p>加<code class="code">%system.teamcity.build.tempDir%/inspection*result/** => inspections-reports-data-%build.number%.zip</code> <a href="configuring-general-settings.html#Artifact-Paths">工件路径</a>规则</p></li><li class="list__item" id="5c45b43e"><p>加<code class="code">%system.teamcity.build.tempDir%/idea-logs/** => inspections-reports-idea-logs-%build.number%.zip</code> <a href="configuring-general-settings.html#Artifact-Paths">工件路径</a>规则</p></li><li class="list__item" id="2f48a45c"><p>加<code class="code">-Didea.log.path=%system.teamcity.build.tempDir%/idea-logs/</code>跑步者的<a href="inspections.html#Java-Parameters">JVM命令行参数</a>字段。</p></li><li class="list__item" id="387021f5"><p>运行一个新版本。</p></li><li class="list__item" id="596c35d9"><p>发送给我们<code class="code">inspections-reports-*.zip</code>文件。</p></li></ol></div><a name="UploadingLargeDataArchives"></a><a name="Uploading-Large-Data-Archives"></a><div class="chapter"><h2 id="ReportingIssues-UploadingLargeDataArchives">上载大数据档案</h2><p id="b4e642de">大小小于10 MB的文件可以直接附加到<a href="http://youtrack.jetbrains.net/issues/TW" rel="noopener noreferrer" data-external="true" target="_blank">跟踪器问题中</a> （如果您不希望附件公开访问，请将附件的可见性限制为“ teamcity-developers”用户组）。<br>您也可以通过电子邮件： <a href="mailto:teamcity-support@jetbrains.com" data-external="true">teamcity-support@jetbrains.com</a>或通过<a href="https://teamcity-support.jetbrains.com/hc/en-us/requests/new?ticket_form_id=66621" rel="noopener noreferrer" data-external="true" target="_blank">在线表单</a> （最大20 MB）发送小文件（最大2 MB）。在附加之前，请不要忘记提及您的TeamCity版本和环境并存档文件。</p><p id="4bd5716a"><b id="8d6562f1">的FTP</b></p><p id="ea6aaa67">如果文件超过10 MB，则可以将存档文件上传到<a href="ftp://ftp.intellij.net/.uploads" rel="noopener noreferrer" data-external="true" target="_blank">ftp://ftp.intellij.net/.uploads，</a>并让我们知道确切的文件名。如果您在尝试上传时收到拒绝权限错误，请重命名该文件。可以在FTP上看不到文件列表是可以的。<br>FTP接受标准的匿名凭据：用户名：“匿名”，密码：“ <your email="">”。<br>除了通常的未加密连接外，还支持TLS连接。</your></p><p id="6d1c918e">如果出现访问问题，超时错误等，请尝试使用被动FTP模式。</p><p id="0bdb7dee"><b id="8fce5711">HTTP</b></p><p id="6d516ae0">您可以通过<a href="https://uploads.services.jetbrains.com/" rel="noopener noreferrer" data-external="true" target="_blank">https://uploads.services.jetbrains.com/</a>表单上传文件，并让我们知道确切的文件名。</p><p id="7562884c">如果您无法一次性上传大文件，请尝试将文件拆分为多个部分，然后分别上传。</p><hr id="aee3ccb1"><p id="9ee3615a"><br></p><p id="25de7d37"><br></p><p id="5faaa84d"><br></p><p id="47b5c0c1"><br></p><p id="e5bd7059"><br></p><p id="885463f4"><br></p><p id="c54800a1"><br></p><p id="48a5d23b"><br></p><p id="bbd96561"><br></p><p id="b5ab1fcd"><br></p></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v2/app.js"></script></body></html>