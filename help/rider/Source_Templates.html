<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>源模板-帮助| JetBrains骑士</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Source_Templates" data-breadcrumbs="Creating_and_Editing_Code.xml|Create and Edit Code/Templates_Rider.xml|Using Templates to Create Code/Templates__Index.xml|.NET-Specific Templates/Source_Templates.xml|Source Templates" data-main-title="Source Templates" data-disqus-id="Source_Templates_rdr"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索JetBrains Rider帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>JetBrains Rider 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="visual_studio" data-group="primary">视觉工作室</option><option value="resharper" data-group="primary">锐化器</option><option value="_default" data-group="primary">默认（IntelliJ IDEA）</option><option value="visual_studio_osx" data-group="secondary">Visual Studio（macOS）</option><option value="resharper_osx" data-group="secondary">ReSharper（macOS）</option><option value="mac_os_x_10.5_" data-group="secondary">Mac OS X 10.5+（IntelliJ IDEA）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Source_Templates.xml" data-toc="Source_Templates">源模板</h1>    <a name="note_net_templates"></a>        <aside class="prompt" rel="Source_Templates.xml" id="18c35f63" data-type="note" data-title="">            <p id="97736bff">本页介绍.NET语言的模板。Web特定模板中描述了可在HTML，JavaScript，TypeScript等中使用的<a href="Templates_Web.html">Web特定模板</a> 。</p>        </aside>        <p id="834f8cf8">传统上，模板或代码段是在源代码之外存储和管理的。这是有道理的，因为通常模板可以帮助您快速生成一些通用的样板代码。为此，JetBrains Rider提供了许多预定义的<a href="Templates__Applying_Templates__Creating_Source_Code_Using_Live_Templates.html">实时模板</a> ， <a href="Templates__Applying_Templates__Surrounding_Code_Fragments_with_Templates.html">环绕声模板</a>和<a href="Templates__Applying_Templates__Creating_Files_from_Templates.html">文件模板</a> 。您也可以<a href="Templates__Creating_and_Editing_Templates.html">创建自己</a>的这些类型<a href="Templates__Creating_and_Editing_Templates.html">的模板</a> 。</p>    <p id="90ecb5a8">但是，您可能需要生成一些仅与当前项目或解决方案相关的可重复代码。JetBrains Rider允许您使用“ <span class="emphasis">源模板”</span>简化此类任务。</p>    <div class="chapter"><h2 id="how-it-works" data-toc="Source_Templates#how-it-works">怎么运行的</h2>        <p id="eb1a42fe">与传统模板相反，可以在项目代码中的任何地方创建源模板作为<a href="https://msdn.microsoft.com/en-us//library/bb383977.aspx" rel="noopener noreferrer" data-external="true" target="_blank">扩展方法</a> 。您可以为项目的某些特定类型或任何标准类型定义它们。您甚至可以通过将其创建为扩展模板的方法来使源模板可用于所有类型<code class="code">object</code> 。</p>        <p id="f0440da0">一旦定义了模板，它就会在<a href="Auto-Completing_Code.html">代码完成列表中</a>用于相应类型的对象及其继承者。当您在列表中选择模板时，JetBrains Rider将模板方法主体中的代码插入您的代码中。</p>        <p id="886d8984">这是一个示例，它说明了源模板的最简单应用。我们的模板<code class="code">forEach</code> ，将可用于所有通用集合-由参数定义<code class="code">this IEnumerable<T> x</code> 。它将插入迭代该集合的代码，如方法主体中所指定。我们可以在项目的任何静态类中定义模板。JetBrains Rider会将其识别为模板<code class="code">[SourceTemplate]</code>属性：</p>        <div class="code-block" data-lang="csharp">公共静态类Foo {[SourceTemplate]公共静态void forEach <t>（此IEnumerable <t>x）{foreach（x中的var i）{// $ $ END $}}}</t></t></div>        <p id="557ac497">要部署此模板，我们现在可以对任何集合对象使用<a href="Coding_Assistance_Code_Completion_Auto.html">自动完成</a>功能：</p>        <figure><img alt="完成列表中的源模板" title="完成列表中的源模板" src="/help/img/dotnet/2019.2/sourceTemplatesExample.png" id="6ced6f9f" width="360" height="152"></figure>        <p id="2a36a953">当您选择模板项目时，对象将被替换为模板文本：</p>        <div class="code-block" data-lang="csharp">公共测试（IEnumerable <string>枚举）{foreach（变量中的var i）{}}</string></div>        <p id="21d743cd">请注意<code class="code">//$ $END$</code>模板定义中的comment只是用于<a href="Templates__Template_Basics__Template_Variables.html#predefined">定义应用模板</a>后的插入符号位置的<a href="Templates__Template_Basics__Template_Variables.html#predefined">预定义模板参数</a> 。您可以在模板中<a href="#params">使用其他参数</a> ，以使模板更加灵活。</p>    </div>    <div class="chapter"><h2 id="why-use-source-templates" data-toc="Source_Templates#why-use-source-templates">为什么使用源模板</h2>        <p id="2f4f63a8">如上所述，对于要在当前项目或解决方案中重用的代码块，源模板最有用。以下几点说明了源模板相对于传统模板的优势：</p>        <ul class="list _ul"><li class="list__item" id="f0a5de08"><p>要使用源模板，您无需切换到任何地方-所有内容都在编辑器中。</p></li><li class="list__item" id="cca3508e"><p>模板是强类型的，这意味着您只能在相关对象上调用它们。</p></li><li class="list__item" id="401ca48f"><p>只要编译模板定义，就可以确保模板代码没有错误。</p></li><li class="list__item" id="d6d8a7df"><p>在创建和编辑源模板时，您最喜欢的JetBrains Rider功能可随时使用： <a href="Design_time_Inspection.html">代码检查</a> ， <a href="Navigation_and_Search__Index.html">导航功能</a> ， <a href="Auto-Completing_Code.html">代码完成</a> ，仅举几例。</p></li></ul>    </div>    <div class="chapter"><h2 id="creating" data-toc="Source_Templates#creating">创建源模板</h2>        <p id="9ad7d5f1">对于源模板的定义，您可以创建一个新类或使用保留扩展方法的现有静态类。</p>        <div class="chapter"><h3 id="template-method-and-its-body">模板方法及其主体</h3>            <p id="36082737">源模板必须是公共扩展方法，并且必须具有<code class="code">[SourceTemplate]</code>属性。该属性在<code class="code">JetBrains.Annotations</code>命名空间，以及<code class="code">[NotNull]</code> ， <code class="code">[CanBeNull]</code>和其他<a href="Code_Analysis__Code_Annotations.html">代码注释属性</a> 。因此，要定义源模板方法，应<a href="Code_Analysis__Annotations_in_Source_Code.html#enabling">在项目中启用JetBrains Rider代码注释支持</a> 。</p>            <p id="01d5275d">在模板主体中，您可以编写执行所需操作的代码。通常，它对调用方对象执行某些操作，但这不是必需的。</p>            <p id="40672fef">您可能还需要使用一些无法在模板方法中编译的代码。例如，您可能要使用调用方对象名称来生成局部变量的名称。在这种情况下，请将以下代码放在以“ $”符号开头的行或块注释中：</p>            <div class="code-block" data-lang="csharp">[SourceTemplate] public static void Bar（此实体实体）{/ * $ var $ entity $ Id =实体。GetId（）;; DoSomething（$ entity $ Id）; * /}</div>        </div>        <div class="chapter"><h3 id="params">参数和宏</h3>            <p id="98c3a292">在源模板中，可以使用<a href="Templates__Template_Basics__Template_Variables.html">参数</a> amd <a href="Templates__Template_Basics__Template_Macros.html">macros</a> 。根据要用于参数的宏，可以在指定和使用参数的几种方式之间进行选择。</p>            <ul class="list _ul"><li class="list__item" id="39208284">                    <p id="d5f1d62e">您可以通过向模板方法添加新参数来创建模板参数。默认情况下，它将作为可编辑参数运行，也就是说，当您应用模板时，它将在<a href="Reference__Hot_Spot_Session.html">热点会话</a>期间获得焦点。如果要为此参数定义宏，则需要添加<code class="code">[Macro]</code>属性，如下例所示。</p>                    <ul class="list _ul"><li class="list__item" id="cba02cdc"><p>该属性的“表达式”属性定义应使用哪个宏。您可以指定一个<a href="Template_Macros.html">可用的模板宏</a> 。</p></li><li class="list__item" id="3ee9e53f"><p>“可编辑”属性可以选择指定在应用模板时用户是否能够编辑参数。默认情况下，所有用户定义的参数都是可编辑的。价值<code class="code">-1</code>使参数不可编辑。<br>如果在模板中多次使用相同的参数，则应用模板时只有一次出现可编辑；其他事件将同步更改。如有必要，可以通过在“可编辑”属性中指定从零开始的索引来定义哪个事件变为可编辑的。</p></li></ul>                    <div class="code-block" data-lang="csharp">[SourceTemplate]公共静态无效newGuid（此对象obj，[Macro（Expression =“ guid（）”，Editable = -1）]字符串newguid）{控制台。WriteLine（newguid）; }</div>                </li><li class="list__item" id="4e5e3bf5">                    <p id="aba86505">您可以将模板方法中的任何局部变量转换为模板参数。为此，您需要添加<code class="code">[Macro]</code>属性定义为模板方法定义，并在其方法中指定变量名称<code class="code">Target</code>属性。例如：</p>                    <div class="code-block" data-lang="csharp">[SourceTemplate] [Macro（Target =“ item”，Expression =“ suggestVariableName（）”）] public static void forEach <t>（此IEnumerable <t>集合）{foreach（集合中的</t></t>变量<t><t>项）{// $ $ END $}}</t></t></div>                </li><li class="list__item" id="f9847569">                    <p id="4759573b">您可以像使用其他JetBrains Rider模板一样使用<a href="Templates__Template_Basics__Template_Variables.html#predefined">预定义参数</a>以及所有用户定义参数，将参数标识符包装在两个'$'符号之间<code class="code">$param_name$</code> 。</p>                    <p id="f77693d3">您可以在字符串文字中使用用户定义的模板参数，例如：</p>                    <div class="code-block" data-lang="csharp">安慰。WriteLine（“随机GUID：$ newguid $”）;</div>                    <p id="264509f5">要在字符串文字之外使用模板参数，您需要将其放在以“ $”符号开头的特殊模板注释中： <code class="code">//$ $param_name$</code> 。要么<code class="code">/*$ $param_name$ */</code> 。例如：</p>                    <div class="code-block" data-lang="csharp">[SourceTemplate] [宏（目标=“ newguid”，表达式=“ guid（）”，可编辑= -1）] public static void newGuid（this object obj）{// $ var guid =“ $ newguid $”;安慰。WriteLine（“随机GUID：$ newguid $”）; }</div>                    <p id="b036ad87">调用方对象以及作为方法参数和局部变量创建的模板参数可以在特殊模板注释中使用带“ $”符号和不带“ $”符号的情况。</p>                </li></ul>        </div>    </div>    <div class="chapter"><h2 id="applying" data-toc="Source_Templates#applying">应用源模板</h2>        <p id="a7a4f0e1">要应用您的源模板，请首先确保该模板在范围内。也就是说，您位于相同的名称空间中，或者显式导入了模板的名称空间。到您的代码中。</p>                        <section class="procedure-steps"><h3 id="6d1f8427">从源模板创建代码片段</h3><ol class="list _decimal"><li class="list__item" id="72a77d09"><p>将插入符设置在您想要将模板部署到的位置。</p></li><li class="list__item" id="44303e87"><p>键入您要为其部署模板的对象，然后键入一个点，然后开始键入模板的名称或其<a href="Navigation_and_Search__CamelHumps.html">CamelHumps</a>缩写。</p></li><li class="list__item" id="c925ecc7"><p>在完成列表中选择模板，然后单击它或按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Enter</span></kbd> 。</p></li><li class="list__item" id="65d18b5a"><p>调用者对象，点和您键入的模板名称的一部分将替换为模板主体。</p></li><li class="list__item" id="974854d3">如果模板具有<a href="Templates__Template_Basics__Template_Variables.html#editable">可编辑的参数</a> （即，需要用户输入），JetBrains Rider将在编辑器中部署一个<a href="Reference__Hot_Spot_Session.html">热点会话</a> ，并将输入位置设置为第一个参数。然后，您可以执行以下操作： <a name="hot_spot_list"></a>        <ul class="list _ul"><li class="list__item" id="572b960c"><p>如果JetBrains Rider建议使用当前参数的一些值，请使用<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Up</span></kbd>和<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Down</span></kbd>箭头键浏览建议值列表，或仅键入所需值。</p></li><li class="list__item" id="bd9bcccb"><p>按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Tab</span></kbd>要么<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Enter</span></kbd>接受该值并移至下一个参数的输入位置。如果这是最后一个参数，则热点会话完成，并且脱字符号移动到为该会话定义的结束位置。</p></li><li class="list__item" id="39791f86"><p>按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Shift+Tab</span></kbd>将输入焦点移至上一个参数的输入位置。</p></li><li class="list__item" id="f74ba7b2"><p>按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Esc</span></kbd>退出热点会话。在这种情况下，所有会话参数都将使用默认值初始化。</p></li></ul>            </li></ol></section>    </div>                <div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Postfix_Templates.html">Postfix模板</a> <a class="navigation-links__next" href="Templates_Web.html">Web特定模板</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>