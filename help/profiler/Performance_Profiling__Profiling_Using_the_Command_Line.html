<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Working with dotTrace Command-Line Profiler - Help | dotTrace</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Performance_Profiling__Profiling_Using_the_Command_Line" data-article-props="&#xA;                {&#xA;                &#xA;            &#34;seeAlso&#34;:{&#xA;                                             &#xA;                &#34;&#34;: [&#xA;                &#xA;                ],                                 &#xA;                &#34;Concepts&#34;: [&#xA;                &#xA;        {&#34;href&#34;:&#34;Profiling_Guidelines__Launching_and_Controlling_the_Profiling_Process.html&#34;,&#34;title&#34;:&#34;Controlling Profiling Session&#34;}&#xA;        {&#34;href&#34;:&#34;Profiling_Guidelines__Profiling_Different_Kinds_of_Applications.html&#34;,&#34;title&#34;:&#34;Application Options&#34;}&#xA;                ]&#xA;            }&#xA;        &#xA;                }&#xA;            " data-disqus-id="Performance_Profiling__Profiling_Using_the_Command_Line_dt"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search dotTrace Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>dotTrace 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="secondary" value="rs">ReSharper 2.x/IntelliJ IDEA</option><option data-group="primary" value="vs">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Performance_Profiling__Profiling_Using_the_Command_Line" id="Performance_Profiling__Profiling_Using_the_Command_Line.xml">Working with dotTrace Command-Line Profiler</h1>    <p id="297d021d">        Sometimes it is necessary to automate the process of gathering performance snapshots, for example, if you        want to make profiling a part of your continuous integration builds        (for example, this can be a build step that performs profiling of your integration tests).        For this purpose, dotTrace comes bundled        with a couple of command-line tools (located in the dotTrace installation directory):    </p>    <ul class="list _ul"><li class="list__item" id="f5e82c72"><p>            <span class="filepath">ConsoleProfiler.exe</span>:            <a href="#console_profiler">profiles applications</a>            and takes performance snapshots.        </p></li><li class="list__item" id="4ae9f85c"><p>            <span class="filepath">Reporter.exe</span>:            <a href="#reporter">analyzes a snapshot</a>            or            <a href="#diff_report">compares a pair of snapshots</a>            and            <a href="#perf_report">generates an XML report</a>            with performance data.        </p></li></ul>    <p id="081255af">        The tools are also distributed as a separate <a href="https://www.jetbrains.com/profiler/download/" data-external="true" target="_blank" rel="noopener noreferrer">zip archive</a>*        and as a        <a href="https://www.nuget.org/packages/JetBrains.dotTrace.CommandLineTools/" data-external="true" target="_blank" rel="noopener noreferrer">NuGet package</a>.        Note that the tools are free of charge and do not require any license keys.    </p>    <aside class="note " data-title="" rel="081255af" id="79a6dac3">        <p id="9ef3a963">            * If your domain policy is to treat the files downloaded from the Internet as unsafe,            unblock the zip archive using the <span class="control">Unblock</span> button            in file properties.        </p>    </aside>    <div class="chapter"><h2 id="console_profiler" data-toc="Performance_Profiling__Profiling_Using_the_Command_Line#console_profiler">Profiling applications using the ConsoleProfiler.exe tool</h2>        <section class="procedure-steps"><h3 id="225440af">To profile an application using the command-line tool</h3><div id="94fb28ff">                <p id="468569d1">                    Depending on your profiling scenario, run <span class="filepath">ConsoleProfiler.exe</span> with the options you need.                For example:                </p>                <ul class="list _ul"><li class="list__item" id="d9d2b1a7"><p>                        To run and profile a standalone application                        <span class="filepath">App.exe</span>                        using the Timeline profiling type:                        <div class="code-block" data-lang="bash">
ConsoleProfiler.exe start --save-to=c:\Snapshots\snapshot.dtt
    --profiling-type=Timeline c:\MyApp\App.exe
    </div>                    </p></li><li class="list__item" id="0c723aed"><p>                        To run and profile a standalone application                        <span class="filepath">App.exe</span> (using the default Sampling profiling type)                        and control the session using the <a href="Profiling_Guidelines__Advanced_Profiling_Using_dotTrace_API.html">profiling API</a>:                        <div class="code-block" data-lang="bash">
                            ConsoleProfiler.exe start --save-to=c:\Snapshots\snapshot.dtp
                            c:\MyApp\App.exe --use-api
    </div>                    </p></li><li class="list__item" id="2a83cf91"><p>                        To attach to a running application with <code class="code">PID=1234</code> and profile it using                        the sampling profiling type:                        <div class="code-block" data-lang="bash">ConsoleProfiler.exe attach 1234 --save-to=c:\Snapshots\snapshot.dtp</div>                    </p></li><li class="list__item" id="75307057"><p>                        To see the full list of available options, run the tool without any arguments:                        <div class="code-block" data-lang="bash">ConsoleProfiler.exe</div>                    </p></li></ul>            </div></section>        <p id="f6b77ebc">            After the profiled application finishes working, the <span class="control">ConsoleProfiler.exe</span> tool will            automatically            save a performance snapshot.        </p>        <aside class="note " data-title="" rel="f6b77ebc" id="cefa1e82">            <p id="bebbdd77">                Snapshots are saved in the raw format. For the Sampling profiling type, specify                <code class="code">.dtp</code> as a snapshot file extension. For Timeline, specify <code class="code">.dtt</code>.            </p>        </aside>        <div class="chapter"><h3 id="c2f18ef9">ConsoleProfiler.exe exit code</h3>            <p id="e94a3862">By default, if the tool finishes its work successfully, its exit code is                <code class="code">0</code>. This may be inconvenient in some cases. For example, if you run the tool on a CI server,                you may need to get the exit code of the profiled application (for example, a unit test runner).                To make <span class="filepath">ConsoleProfiler.exe</span> return the exit code of the                profiling target, use the <code class="code">--propagate-exit-code</code> argument.            </p>            <p id="c2763682">For example:                <div class="code-block" data-lang="bash">
ConsoleProfiler.exe start --save-to=c:\Snapshots\snapshot.dtp
    --profiling-type=Sampling c:\MyApp\App.exe --propagate-exit-code
    </div>            </p>        </div>        <div class="chapter"><h3 id="dd1979f1">(Optional) Configuring profiling using an XML file</h3>            <p id="1afdaf54">                In the                <a href="#console_profiler">section above</a>, we have provided the profiling configuration                (profiling target, profiling method, and so on)                as the <span class="filepath">ConsoleProfiler.exe</span> arguments. If for some reason, you do not want to configure                a session this way, you can provide the configuration in an XML file.            </p>            <p id="7ec6b82c">                To simplify file creation, you can use                the <span class="filepath">Configuration2Xml32.exe</span> (and the 64-bit version <span class="filepath">Configuration2Xml64.exe</span>)                tool.                This tool allows you to create the XML configuration file using the familiar user interface of the dotTrace Home                window.            </p>            <section class="procedure-steps"><h3 id="42634563">To create or modify a configuration file using Configuration2Xml</h3><ol class="list _decimal"><li class="list__item" id="5a93e0ba"><p>Run the <span class="filepath">Configuration2Xml32.exe</span> or <span class="filepath">Configuration2Xml64.exe</span> tool which is                    located in the dotTrace installation directory (by default,                    <span class="filepath">C:\Users\[username]\AppData\Local\JetBrains\Installations\dotTrace[N]</span>).                </p></li><li class="list__item" id="c4869632"><p>                    To create a new profiling configuration, select the <span data-skip-index="skip" class="menupath">Create New Config</span> menu.                    <br>                    To modify an existing profiling configuration, select <span data-skip-index="skip" class="menupath">Open Config</span>.                </p></li><li class="list__item" id="6a24efa5"><p>Specify profiling options as                    <a href="Configuring_Profiling_Session.html">you normally do</a>                    in the dotTrace Home window.                </p></li><li class="list__item" id="5c4be017"><p>Click <span class="control">Save</span> and specify the filename and path for the configuration file.                </p></li><li class="list__item" id="c9a76fe0"><p>Click <span class="control">Save</span>.                </p></li></ol></section>            <section class="procedure-steps"><h3 id="baa16d0e">To run the profiling session configured via an XML file</h3><div id="7d37c5ef">                    <p id="7bcaf0e5">                        Run the following command                        in the command line:                        <div class="code-block" data-lang="bash">ConsoleProfiler.exe xmlfile &lt;path_to_config&gt; --save-to=&lt;path_to_snapshot&gt;</div>                        where                        <br>                        <code class="code">&lt;path_to_config&gt;</code>                        - path to the XML configuration file.                        <br>                        <code class="code">&lt;path_to_snapshot&gt;</code>                        - path to the resulting snapshot file. Note that you can specify                        either the full path (including the snapshot filename) or only the path to the directory                        (without                        the filename. In the latter case, the snapshot file will get a random name.                    </p>                    <p id="888aad73">For example:</p>                    <p id="34659cb8">                        <div class="code-block" data-lang="bash">ConsoleProfiler.exe xmlfile config.xml
                            --save-to=c:\Snapshots\snapshot.dtp
    </div>                    </p>                </div></section>        </div>    </div>    <div class="chapter"><h2 id="reporter" data-toc="Performance_Profiling__Profiling_Using_the_Command_Line#reporter">Generating performance reports using the Reporter.exe tool</h2>    <aside class="warning " data-title="" rel="reporter" id="8cd69549">        <p id="26d8587d">The <span class="filepath">Reporter.exe</span> tool does NOT work with snapshots taken using the            <a href="Concurrency_Profiling_Timeline_.html">Timeline</a>            profiling type.        </p>    </aside>    <p id="3ecb9853">        The <span class="filepath">Reporter.exe</span> tool can work in two modes:        <ul class="list _ul"><li class="list__item" id="983cd73b"><p>                <a href="#perf_report">Getting performance data for particular methods</a>.                <br>                The resulting XML report gets data on execution time and number of calls for particular methods.            </p></li><li class="list__item" id="b4a3f6ac"><p>                <a href="#diff_report">Comparing snapshots</a>.                <br>                The resulting XML report gets data on differences in execution time and number of calls for                particular methods. This mode can be especially useful for comparing performance data you get in                a latest build against some reference snapshot.            </p></li></ul>    </p>    <p id="a98a2355">        Regardless of the mode you choose, you should specify method names that        should be added to the report.    </p>    <div class="chapter"><h3 id="ad4d60b0">1. Specifying methods for the report</h3>    <p id="3f38ae28">        The list of methods that must be added into a report is defined by an XML pattern file.    </p>    <section class="procedure-steps"><h3 id="da0e39de">To create a pattern file</h3><ol class="list _decimal"><li class="list__item" id="54d85e6e"><p>            In an editor of your choice, create a blank XML file.        </p></li><li class="list__item" id="17e6d7b1">            <p id="d19754d7">                Write the list of methods that must be added to the report as shown in the example below.                <div class="code-block" data-lang="markup">
        &lt;Patterns&gt;
           &lt;Pattern PrintCallstacks = "MethodNameOnly"&gt;Method1&lt;/Pattern&gt;
           &lt;Pattern&gt;Method2&lt;/Pattern&gt;
        &lt;/Patterns&gt;
                    </div>                where            </p>            <ul class="list _ul"><li class="list__item" id="1177da75"><p>                    <code class="code">Method1</code>                    and <code class="code">Method2</code> -  a regular expression that matches names (not                    substrings of names)                    of the methods you want to get the performance data for.                    Note that if a method name contains special characters, you should escape them with the                    backslash<code class="code">\</code>symbol. For example, <code class="code">MyMethod\+MySubMethod</code>.                </p></li><li class="list__item" id="pcs">                    <p id="7d190c51">                        <code class="code">PrintCallstacks</code>                        - optional attribute that allows including call stack data in reports                        (an example of such a report is shown <a href="#pcs_example">below</a>).                        There are two available values for <code class="code">PrintCallstacks</code>:                    </p>                    <ul class="list _ul"><li class="list__item" id="417f4571"><p>                            <code class="code">Full</code>                            - fully qualified method names will be shown in the call stack.                        </p></li><li class="list__item" id="d65aaa16"><p>                            <code class="code">MethodNameOnly</code>                            - only method names (without namespace and class names) will be shown in the call stack.                        </p></li></ul>                </li></ul>        </li><li class="list__item" id="b4ad94c2"><p>            Save the file.        </p></li></ol></section>    </div>    <div class="chapter"><h3 id="perf_report">2a. Generating a performance report</h3>    <section class="procedure-steps"><h3 id="12344526">To generate a performance report</h3><div id="2fa057ee"><p>            In the command line, run the following command:            <div class="code-block" data-lang="bash">Reporter.exe report &lt;path_to_snapshot&gt; --pattern=&lt;path_to_pattern&gt; --save-to=&lt;path_to_report&gt;
    </div>            where            <br>            <code class="code">&lt;path_to_snapshot&gt;</code>            - path to the source snapshot file.            <br>            <code class="code">&lt;path_to_pattern&gt;</code>            - path to the XML pattern file which contains names of the methods added to the report.            <br>            <code class="code">&lt;path_to_report&gt;</code>            - path to the resulting report file.            <br>                                                                    </p></div></section>    <p id="de32af00">For example:</p>    <div class="code-block" data-lang="bash">Reporter.exe report c:\Snapshots\snapshot.dtp --pattern=pattern.xml --save-to=c:\Reports\report.xml
    </div>    <div class="chapter"><h4 id="f02f83ec">Report Example</h4>    <div class="code-block" data-lang="markup">
&lt;Report&gt;
   &lt;Info&gt;
      &lt;Snapshot IndexFile="C:\snapshot1.dtp" Executable="C:\Temp\ConsoleAppTest.exe"
        CommandLine="C:\Temp\ConsoleAppTest.exe" /&gt;
   &lt;/Info&gt;

   &lt;Function FQN="Tests.Method1" TotalTime="500" OwnTime="100" Calls="1" /&gt;
   &lt;Function FQN="Tests.Method2" TotalTime="400" OwnTime="200" Calls="10" /&gt;
&lt;/Report&gt;
    </div>    <p id="a16e6fab">        where        <br>        <code class="code">FQN</code>        - full method name.        <br>        <code class="code">TotalTime</code>        - execution time of the method's call subtree.        <br>        <code class="code">OwnTime</code>        - method's own execution time.        <br>        <code class="code">Calls</code>        - number of calls.    </p>    <p id="896a7b99">        If a <a href="#pcs"><code class="code">PrintCallstacks</code></a> attribute was        specified for a particular <code class="code">Pattern</code> in an XML pattern file, the report will contain        additional call stack data. For example, <code class="code">&lt;Pattern PrintCallstacks = "MethodNameOnly"&gt;</code>        was specified for some <code class="code">GetFileNames</code> function. In this case, the corresponding        <code class="code">Function</code>        node in the resulting report will contain an additional <code class="code">Instance</code> subnode        with a call stack:        <div class="code-block" data-lang="markup">
&lt;Function Id="0x0020000C" FQN="MyApplication.MainWindow.GetFileNames" TotalTime="12520" OwnTime="0" Calls="1740" Instances="1"&gt;
   &lt;Instance CallStack="Main/Run/Run/RunInternal/RunDispatcher/PushFrame/PushFrameImpl/OnClick/RaiseEvent/RaiseEventImpl/InvokeHandlersImpl/InvokeHandler/btnSelectFiles_Click/GetFileNames" TotalTime="12520" OwnTime="0" Calls="1740" /&gt;
&lt;/Function&gt;
        </div>    </p>        <aside class="note " data-title="" rel="896a7b99" id="dacfef09">            <p id="ff34c1b0">                In case you want to distinguish overloaded methods in a report, run                <code class="code">Reporter.exe</code> with the <code class="code">--save-signature</code> argument.            </p>        </aside>    </div>    </div>    <div class="chapter"><h3 id="diff_report">2b. Generating a report on snapshots differences</h3>    <section class="procedure-steps"><h3 id="32d64f7b">To compare two snapshots and generate report on differences</h3><div id="28870726"><p>            In the command line, run the following command:            <div class="code-block" data-lang="bash">Reporter.exe compare &lt;path_to_snapshot1&gt; &lt;path_to_snapshot2&gt;
                --pattern=&lt;path_to_pattern&gt; --save-to=&lt;path_to_report&gt;</div>            where            <br>            <code class="code">&lt;path_to_snapshot1&gt;</code>            - path to the reference snapshot file.            <br>            <code class="code">&lt;path_to_snapshot2&gt;</code>            - path to the second snapshot file.            <br>            <code class="code">&lt;path_to_pattern&gt;</code>            - path to the XML pattern file which contains names of the methods added to the report.            <br>            <code class="code">&lt;path_to_report&gt;</code>            - path to the resulting report file.            <br>        </p></div></section>    <p id="53c9ec7c">For example:</p>    <div class="code-block" data-lang="bash">Reporter.exe compare c:\Snapshots\base_snapshot.dtp c:\Snapshots\snapshot.dtp
        --pattern=pattern.xml --save-to=c:\Reports\report.xml
    </div>    <p id="c2589bfb">        The resulting report file is similar to the one you get in the "reporting" mode with the only difference:        all fields will contain not the absolute time or number of calls values but their delta between the snapshots.        Depending on the delta sign, the values will start with either <code class="code">+</code> or <code class="code">-</code> prefix.    </p>    </div>    </div>    <div class="last-modified" data-skip-index="skip">Last modified: 19 September 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Viewing_Collected_Snapshots.html">Basic Operations with Snapshots</a><a class="navigation-links__next" href="Configuring_Profiling_Session.html">Configuring Profiling Session</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>