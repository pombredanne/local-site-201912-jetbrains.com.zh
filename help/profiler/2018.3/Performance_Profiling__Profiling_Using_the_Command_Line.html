<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta name="robots" content="noindex"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/help/app/v2/analytics.js"></script><meta charset="UTF-8"><title>Working with dotTrace Command-Line Profiler - Help | dotTrace</title><link rel="stylesheet" href="/help/app/v2/app.css"></head><body data-id="Performance_Profiling__Profiling_Using_the_Command_Line" data-disqus-id="Performance_Profiling__Profiling_Using_the_Command_Line_dt"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search dotTrace Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>dotTrace 2018.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="secondary" value="rs">ReSharper 2.x/IntelliJ IDEA</option><option data-group="primary" value="vs" selected>Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="false"><h1 data-toc="Performance_Profiling__Profiling_Using_the_Command_Line" id="Performance_Profiling__Profiling_Using_the_Command_Line.xml">Working with dotTrace Command-Line Profiler</h1>    <p id="df7f5c03">        Sometimes it is necessary to automate the process of gathering performance snapshots, for example, if you        want to make profiling a part of your continuous integration builds        (e.g., this can be a build step that performs profiling of your integration tests).        For this purpose, dotTrace comes bundled        with a couple of command-line tools (located in the dotTrace installation directory):    </p>    <ul class="list _ul"><li class="list__item" id="5865c009"><p>            <span class="filepath">ConsoleProfiler.exe</span>:            <a href="#console_profiler">profiles applications</a>            and takes performance snapshots.        </p></li><li class="list__item" id="f47a0fc2"><p>            <span class="filepath">Reporter.exe</span>:            <a href="#reporter">analyzes a snapshot</a>            or            <a href="#diff_report">compares a pair of snapshots</a>            and            <a href="#perf_report">generates an XML report</a>            with performance data.        </p></li></ul>    <p id="c0cc4e1a">        The tools are also distributed as a separate <a href="/profiler/download/" data-external="true" target="_blank" rel="noopener noreferrer"><span>zip archive</span></a>*        and as a        <a href="https://www.nuget.org/packages/JetBrains.dotTrace.CommandLineTools/" data-external="true" target="_blank" rel="noopener noreferrer"><span>NuGet package</span></a>.        Note that the tools are free of charge and do not require any license keys.    </p>    <aside class="note " data-title="" rel="c0cc4e1a" id="3966fe5f">        <p id="e094cb30">            * If your domain policy is to treat the files downloaded from the Internet as unsafe,            unblock the zip archive using the <span class="control">Unblock</span> button            in file properties.        </p>    </aside>    <div class="chapter"><h2 id="console_profiler" data-toc="Performance_Profiling__Profiling_Using_the_Command_Line#console_profiler">Profiling applications using the ConsoleProfiler.exe tool</h2>        <section class="procedure-steps"><h2 id="5cfbbe68">To profile an application using the command-line tool</h2><ul class="list "><li class="list__item" id="60db3162">                <p id="3f330ee9">                    Depending on your profiling scenario, run <span class="filepath">ConsoleProfiler.exe</span> with the options you need.                For example:                </p>                <ul class="list _ul"><li class="list__item" id="1ac2940f"><p>                        To run and profile a standalone application                        <span class="filepath">App.exe</span>                        using the Timeline profiling type:                        <div class="code-block" data-lang="Shell"><code class="code-block__wrapper">ConsoleProfiler.exe start --save-to<span class="o">=</span>c:<span class="se">\S</span>napshots<span class="se">\s</span>napshot.dtp
    --profiling-type<span class="o">=</span>Timeline c:<span class="se">\M</span>yApp<span class="se">\A</span>pp.exe</code></div>                    </p></li><li class="list__item" id="17772aa8"><p>                        To run and profile a standalone application                        <span class="filepath">App.exe</span> (using the default Sampling profiling type)                        and control the session using the <a href="Profiling_Guidelines__Advanced_Profiling_Using_dotTrace_API.html">profiling API</a>:                        <div class="code-block" data-lang="Shell"><code class="code-block__wrapper">ConsoleProfiler.exe start --save-to<span class="o">=</span>c:<span class="se">\S</span>napshots<span class="se">\s</span>napshot.dtp
c:<span class="se">\M</span>yApp<span class="se">\A</span>pp.exe --use-api</code></div>                    </p></li><li class="list__item" id="4bb126ba"><p>                        To attach to a running application with <code class="code" data-lang="Java">PID=1234</code> and profile it using                        the sampling profiling type:                        <div class="code-block" data-lang="Shell"><code class="code-block__wrapper">ConsoleProfiler.exe attach --save-to<span class="o">=</span>c:<span class="se">\S</span>napshots<span class="se">\s</span>napshot.dtp</code></div>                    </p></li><li class="list__item" id="79e79bb5"><p>                        To see the full list of available options, run the tool without any arguments:                        <div class="code-block" data-lang="Shell"><code class="code-block__wrapper">ConsoleProfiler.exe</code></div>                    </p></li></ul>            </li></ul></section>        <p id="ac2857c0">            After the profiled application finishes working, the <span class="control">ConsoleProfiler.exe</span> tool will            automatically            save a performance snapshot.        </p>        <aside class="note " data-title="" rel="ac2857c0" id="e5ae6cf8">            <p id="3e1176ea">Snapshots are saved in the raw format.</p>        </aside>        <div class="chapter"><h3 id="97eab838">ConsoleProfiler.exe exit code</h3>            <p id="02fe0852">By default, if the tool finishes its work successfully, its exit code is                <code class="code" data-lang="Java">0</code>. This may be inconvenient in some cases. For example, if you run the tool on a CI server,                you may need to get the exit code of the profiled application (e.g., a unit test runner).                To make <span class="filepath">ConsoleProfiler.exe</span> return the exit code of the                profiling target, use the <code class="code" data-lang="Java">--propagate-exit-code</code> argument.            </p>            <p id="1720f17b">For example:                <div class="code-block" data-lang="Shell"><code class="code-block__wrapper">ConsoleProfiler.exe start --save-to<span class="o">=</span>c:<span class="se">\S</span>napshots<span class="se">\s</span>napshot.dtp
    --profiling-type<span class="o">=</span>Sampling c:<span class="se">\M</span>yApp<span class="se">\A</span>pp.exe --propagate-exit-code</code></div>            </p>        </div>        <div class="chapter"><h3 id="c55ceb4b">(Optional) Configuring profiling using an XML file</h3>            <p id="0b7c562b">                In the                <a href="#console_profiler">section above</a>, we have provided the profiling configuration                (profiling target, profiling method, and so on)                as the <span class="filepath">ConsoleProfiler.exe</span> arguments. If for some reason, you do not want to configure                a session this way, you can provide the configuration in an XML file.            </p>            <p id="ecdd7fcd">                To simplify file creation, you can use                the <span class="filepath">Configuration2Xml32.exe</span> (and the 64-bit version <span class="filepath">Configuration2Xml64.exe</span>)                tool.                This tool allows you to create the XML configuration file using the familiar user interface of the dotTrace Home                window.            </p>            <section class="procedure-steps"><h2 id="a2116f93">To create or modify a configuration file using Configuration2Xml</h2><ol class="list _decimal"><li class="list__item" id="b0acc557"><p>Run the <span class="filepath">Configuration2Xml32.exe</span> or <span class="filepath">Configuration2Xml64.exe</span> tool which is                    located in the dotTrace installation directory (by default,                    <span class="filepath">C:\Users\[username]\AppData\Local\JetBrains\Installations\dotTrace[N]</span>).                </p></li><li class="list__item" id="f4a73b19"><p>                    To create a new profiling configuration, select the <span data-skip-index="skip" class="menupath">Create New Config</span> menu.                    <br>                    To modify an existing profiling configuration, select <span data-skip-index="skip" class="menupath">Open Config</span>.                </p></li><li class="list__item" id="8cd30aba"><p>Specify profiling options as                    <a href="Configuring_Profiling_Session.html">you normally do</a>                    in the dotTrace Home window.                </p></li><li class="list__item" id="85d2d662"><p>Click <span class="control">Save</span> and specify the file name and path for the configuration file.                </p></li><li class="list__item" id="ef348a32"><p>Click <span class="control">Save</span>.                </p></li></ol></section>            <section class="procedure-steps"><h2 id="cd662b09">To run the profiling session configured via an XML file</h2><ul class="list "><li class="list__item" id="e97cba12">                    <p id="4e8c7b60">                        Run the following command                        in the command line:                        <div class="code-block" data-lang="Shell"><code class="code-block__wrapper">ConsoleProfiler.exe xmlfile &lt;path_to_config&gt; --save-to<span class="o">=</span>&lt;path_to_snapshot&gt;</code></div>                        where                        <br>                        <code class="code" data-lang="Java">&lt;path_to_config&gt;</code>                        - path to the XML configuration file.                        <br>                        <code class="code" data-lang="Java">&lt;path_to_snapshot&gt;</code>                        - path to the resulting snapshot file. Note that you can specify                        either the full path (including the snapshot file name) or only the path to the directory                        (without                        the file name). In the latter case, the snapshot file will get a random name.                    </p>                    <p id="50b683fd">For example:</p>                    <p id="e680fe98">                        <div class="code-block" data-lang="Shell"><code class="code-block__wrapper">ConsoleProfiler.exe xmlfile config.xml
                            --save-to<span class="o">=</span>c:<span class="se">\S</span>napshots<span class="se">\s</span>napshot.dtp</code></div>                    </p>                </li></ul></section>        </div>    </div>    <div class="chapter"><h2 id="reporter" data-toc="Performance_Profiling__Profiling_Using_the_Command_Line#reporter">Generating performance reports using the Reporter.exe tool</h2>    <aside class="warning " data-title="" rel="reporter" id="642a5491">        <p id="330cf0f0">The <span class="filepath">Reporter.exe</span> tool does NOT work with snapshots taken using the            <a href="Concurrency_Profiling_Timeline_.html">Timeline</a>            profiling type.        </p>    </aside>    <p id="35e525e6">        The <span class="filepath">Reporter.exe</span> tool can work in two modes:        <ul class="list _ul"><li class="list__item" id="72cfcc0a"><p>                <a href="#perf_report">Getting performance data for particular methods</a>.                <br>                The resulting XML report gets data on execution time and number of calls for particular methods.            </p></li><li class="list__item" id="53c84aec"><p>                <a href="#diff_report">Comparing snapshots</a>.                <br>                The resulting XML report gets data on differences in execution time and number of calls for                particular methods. This mode can be especially useful for comparing performance data you get in                a latest build against some reference snapshot.            </p></li></ul>    </p>    <p id="cacfc87e">        Regardless of the mode you choose, you should specify method names that        should be added to the report.    </p>    <div class="chapter"><h3 id="b14b2539">1. Specifying methods for the report</h3>    <p id="dc67825a">        The list of methods that must be added into a report is defined by an XML pattern file.    </p>    <section class="procedure-steps"><h2 id="796961c5">To create a pattern file</h2><ol class="list _decimal"><li class="list__item" id="5727dacf"><p>            In an editor of your choice, create a blank XML file.        </p></li><li class="list__item" id="cfd6639f">            <p id="451039b6">                Write the list of methods that must be added to the report as shown in the example below.                <div class="code-block" data-lang="XML"><code class="code-block__wrapper"><span class="nt">&lt;Patterns&gt;</span>
   <span class="nt">&lt;Pattern</span> <span class="na">PrintCallstacks =</span> <span class="s">&quot;MethodNameOnly&quot;</span><span class="nt">&gt;</span>Method1<span class="nt">&lt;/Pattern&gt;</span>
   <span class="nt">&lt;Pattern&gt;</span>Method2<span class="nt">&lt;/Pattern&gt;</span>
<span class="nt">&lt;/Patterns&gt;</span></code></div>                where            </p>            <ul class="list _ul"><li class="list__item" id="6a35d319"><p>                    <code class="code" data-lang="Java">Method1</code>                    and <code class="code" data-lang="Java">Method2</code> -  a regular expression that matches names (not                    substrings of names)                    of the methods you want to get the performance data for.                    Note that if a method name contains special characters, you should escape them with the                    backslash<code class="code" data-lang="Java">\</code>symbol. For example, <code class="code" data-lang="Java">MyMethod\+MySubMethod</code>.                </p></li><li class="list__item" id="pcs">                    <p id="3f9c51b2">                        <code class="code" data-lang="Java">PrintCallstacks</code>                        - optional attribute that allows including call stack data in reports                        (an example of such a report is shown <a href="#pcs_example">below</a>).                        There are two available values for <code class="code" data-lang="Java">PrintCallstacks</code>:                    </p>                    <ul class="list _ul"><li class="list__item" id="63aa5e40"><p>                            <code class="code" data-lang="Java">Full</code>                            - fully qualified method names will be shown in the call stack.                        </p></li><li class="list__item" id="71d1e131"><p>                            <code class="code" data-lang="Java">MethodNameOnly</code>                            - only method names (without namespace and class names) will be shown in the call stack.                        </p></li></ul>                </li></ul>        </li><li class="list__item" id="a4e0864d"><p>            Save the file.        </p></li></ol></section>    </div>    <div class="chapter"><h3 id="perf_report">2a. Generating a performance report</h3>    <section class="procedure-steps"><h2 id="f3b21897">To generate a performance report</h2><ul class="list "><li class="list__item" id="29d165fb"><p>            In the command line, run the following command:            <div class="code-block" data-lang="Shell"><code class="code-block__wrapper">Reporter.exe report &lt;path_to_snapshot&gt; --pattern<span class="o">=</span>&lt;path_to_pattern&gt; --save-to<span class="o">=</span>&lt;path_to_report&gt;</code></div>            where            <br>            <code class="code" data-lang="Java">&lt;path_to_snapshot&gt;</code>            - path to the source snapshot file.            <br>            <code class="code" data-lang="Java">&lt;path_to_pattern&gt;</code>            - path to the XML pattern file which contains names of the methods added to the report.            <br>            <code class="code" data-lang="Java">&lt;path_to_report&gt;</code>            - path to the resulting report file.            <br>                                                                    </p></li></ul></section>    <p id="93ee759e">For example:</p>    <div class="code-block" data-lang="Shell"><code class="code-block__wrapper">Reporter.exe report c:<span class="se">\S</span>napshots<span class="se">\s</span>napshot.dtp --pattern<span class="o">=</span>pattern.xml --save-to<span class="o">=</span>c:<span class="se">\R</span>eports<span class="se">\r</span>eport.xml</code></div>    <div class="chapter"><h4 id="fa2966c2">Report Example</h4>    <div class="code-block" data-lang="XML"><code class="code-block__wrapper"><span class="nt">&lt;Report&gt;</span>
   <span class="nt">&lt;Info&gt;</span>
      <span class="nt">&lt;Snapshot</span> <span class="na">IndexFile=</span><span class="s">&quot;C:\snapshot1.dtp&quot;</span> <span class="na">Executable=</span><span class="s">&quot;C:\Temp\ConsoleAppTest.exe&quot;</span>
        <span class="na">CommandLine=</span><span class="s">&quot;C:\Temp\ConsoleAppTest.exe&quot;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/Info&gt;</span>

   <span class="nt">&lt;Function</span> <span class="na">FQN=</span><span class="s">&quot;Tests.Method1&quot;</span> <span class="na">TotalTime=</span><span class="s">&quot;500&quot;</span> <span class="na">OwnTime=</span><span class="s">&quot;100&quot;</span> <span class="na">Calls=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;Function</span> <span class="na">FQN=</span><span class="s">&quot;Tests.Method2&quot;</span> <span class="na">TotalTime=</span><span class="s">&quot;400&quot;</span> <span class="na">OwnTime=</span><span class="s">&quot;200&quot;</span> <span class="na">Calls=</span><span class="s">&quot;10&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/Report&gt;</span></code></div>    <p id="a804557a">        where        <br>        <code class="code" data-lang="Java">FQN</code>        - full method name.        <br>        <code class="code" data-lang="Java">TotalTime</code>        - execution time of the method's call subtree.        <br>        <code class="code" data-lang="Java">OwnTime</code>        - method's own execution time.        <br>        <code class="code" data-lang="Java">Calls</code>        - number of calls.    </p>    <p id="9a4eb652">        If a <a href="#pcs"><code class="code" data-lang="Java">PrintCallstacks</code></a> attribute was        specified for a particular <code class="code" data-lang="Java">Pattern</code> in an XML pattern file, the report will contain        additional call stack data. For example, <code class="code" data-lang="Java">&lt;Pattern PrintCallstacks = "MethodNameOnly"&gt;</code>        was specified for some <code class="code" data-lang="Java">GetFileNames</code> function. In this case, the corresponding        <code class="code" data-lang="Java">Function</code>        node in the resulting report will contain an additional <code class="code" data-lang="Java">Instance</code> subnode        with a call stack:        <div class="code-block" data-lang="XML"><code class="code-block__wrapper"><span class="nt">&lt;Function</span> <span class="na">Id=</span><span class="s">&quot;0x0020000C&quot;</span> <span class="na">FQN=</span><span class="s">&quot;MyApplication.MainWindow.GetFileNames&quot;</span> <span class="na">TotalTime=</span><span class="s">&quot;12520&quot;</span> <span class="na">OwnTime=</span><span class="s">&quot;0&quot;</span> <span class="na">Calls=</span><span class="s">&quot;1740&quot;</span> <span class="na">Instances=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;Instance</span> <span class="na">CallStack=</span><span class="s">&quot;Main/Run/Run/RunInternal/RunDispatcher/PushFrame/PushFrameImpl/OnClick/RaiseEvent/RaiseEventImpl/InvokeHandlersImpl/InvokeHandler/btnSelectFiles_Click/GetFileNames&quot;</span> <span class="na">TotalTime=</span><span class="s">&quot;12520&quot;</span> <span class="na">OwnTime=</span><span class="s">&quot;0&quot;</span> <span class="na">Calls=</span><span class="s">&quot;1740&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/Function&gt;</span></code></div>    </p>    </div>    </div>    <div class="chapter"><h3 id="diff_report">2b. Generating a report on snapshots differences</h3>    <section class="procedure-steps"><h2 id="1b3a5a26">To compare two snapshots and generate report on differences</h2><ul class="list "><li class="list__item" id="e0a6b6b3"><p>            In the command line, run the following command:            <div class="code-block" data-lang="Shell"><code class="code-block__wrapper">Reporter.exe compare &lt;path_to_snapshot1&gt; &lt;path_to_snapshot2&gt;
                --pattern<span class="o">=</span>&lt;path_to_pattern&gt; --save-to<span class="o">=</span>&lt;path_to_report&gt;</code></div>            where            <br>            <code class="code" data-lang="Java">&lt;path_to_snapshot1&gt;</code>            - path to the reference snapshot file.            <br>            <code class="code" data-lang="Java">&lt;path_to_snapshot2&gt;</code>            - path to the second snapshot file.            <br>            <code class="code" data-lang="Java">&lt;path_to_pattern&gt;</code>            - path to the XML pattern file which contains names of the methods added to the report.            <br>            <code class="code" data-lang="Java">&lt;path_to_report&gt;</code>            - path to the resulting report file.            <br>        </p></li></ul></section>    <p id="812a4359">For example:</p>    <div class="code-block" data-lang="Shell"><code class="code-block__wrapper">Reporter.exe compare c:<span class="se">\S</span>napshots<span class="se">\b</span>ase_snapshot.dtp c:<span class="se">\S</span>napshots<span class="se">\s</span>napshot.dtp
        --pattern<span class="o">=</span>pattern.xml --save-to<span class="o">=</span>c:<span class="se">\R</span>eports<span class="se">\r</span>eport.xml</code></div>    <p id="f0f2591a">        The resulting report file is similar to the one you get in the "reporting" mode with the only difference:        all fields will contain not the absolute time or number of calls values but their delta between the snapshots.        Depending on the delta sign, the values will start with either <code class="code" data-lang="Java">+</code> or <code class="code" data-lang="Java">-</code> prefix.    </p>    </div>    </div>    <div class="last-modified" data-skip-index="skip">Last modified: 15 March 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Viewing_Collected_Snapshots.html">Basic Operations with Snapshots</a><a class="navigation-links__next" href="Configuring_Profiling_Session.html">Configuring Profiling Session</a></div><section class="seealso" data-skip-index="skip"><div class="seealso__header"><h2>See Also</h2></div><div class="seealso__content"><div class="seealso__col" data-skip-index="skip"><h3>Concepts:</h3><ul class="list"><li class="list__item"><a href="Profiling_Guidelines__Launching_and_Controlling_the_Profiling_Process.html"><span>Controlling Profiling Session</span></a></li><li class="list__item"><a href="Profiling_Guidelines__Profiling_Different_Kinds_of_Applications.html"><span>Application Options</span></a></li></ul></div></div></section></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/help/app/v2/app.js"></script></body></html>