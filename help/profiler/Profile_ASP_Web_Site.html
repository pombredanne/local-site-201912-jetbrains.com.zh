<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta content="&#xA;        ASP.NET performance profiling, performance profiling of web application,&#xA;        performance profile IIS site, IIS server performance profiling&#xA;    " name="description" data-skip-index="skip"><title>Profile Web Application on IIS Server - Help | dotTrace</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Profile_ASP_Web_Site" data-disqus-id="Profile_ASP_Web_Site_dt"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search dotTrace Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>dotTrace 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="secondary" value="rs">ReSharper 2.x/IntelliJ IDEA</option><option data-group="primary" value="vs">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Profile_ASP_Web_Site" id="Profile_ASP_Web_Site.xml">Profile Web Application on IIS Server</h1>                <p id="f8251958">        Typically, determining performance issues in a web application is required when it is already        running on a server. The table summarizes all possible options of profiling the application:    </p>    <div class="table-wrapper"><table class=" wide" width="100%" id="c7c57835"><thead><tr id="0f237120" class="ijRowHead"><th id="9858458f"></th><th id="f171f33c" width="30%"><p>Pros</p></th><th id="cf23f1ac" width="30%"><p>Not cons but features</p></th></tr></thead><tbody><tr id="26a30912" class="ijRowOdd"><td id="643e840f">                <a href="#local-profiling">Local profiling</a>            </td><td id="ada39f1a">                <ul class="list _ul"><li class="list__item" id="2ae997a9"><p>Easy to configure/use: you profile via the dotTrace GUI</p></li></ul>            </td><td id="bb918776">                <ul class="list _ul"><li class="list__item" id="b91ca1e8"><p>                        dotTrace must be installed and run on the server, which may be impossible due to security                        restrictions, absence of GUI, etc                    </p></li></ul>            </td></tr><tr id="5482d883" class="ijRowEven"><td id="14f5ed26">                <a href="#remote-profiling">Remote profiling</a>            </td><td id="dd2ff1c1">                <ul class="list _ul"><li class="list__item" id="a1e06344"><p>                        Easy to configure/use: you profile via the dotTrace GUI                    </p></li><li class="list__item" id="4aad8983"><p>                        Snapshots are automatically uploaded to your local machine                    </p></li></ul>            </td><td id="4ee59bf7">                <ul class="list _ul"><li class="list__item" id="87483890"><p>                        dotTrace remote agent must be installed and run on the server                    </p></li><li class="list__item" id="139f5db0"><p>                        Communication via network is required                    </p></li></ul>            </td></tr><tr id="8f4a1f35" class="ijRowOdd"><td id="7382e79b">                <a href="#profiling-via-console-tools">Profiling via console tools</a>            </td><td id="7fef44f7">                <ul class="list _ul"><li class="list__item" id="cbf1c5c7"><p>                        No network communication required                    </p></li><li class="list__item" id="44dbcc63"><p>                        Ability to create a number of predefined profiling configs and run them on demand                    </p></li></ul>            </td><td id="543ce73b">                <ul class="list _ul"><li class="list__item" id="bc275483"><p>                        The console tools must be copied to and run on the server                    </p></li><li class="list__item" id="ab4157b8"><p>                        Resulting snapshots must be manually copied from the server to the machine with                        dotTrace                    </p></li></ul>            </td></tr></tbody></table></div>    <div class="chapter"><h2 id="local-profiling">Local profiling</h2>        <figure><img alt="Local profiling" title="Local profiling" src="/help/img/dotnet/2019.2/how_to_app_server_local.png" id="2097401d" width="291" height="355"></figure>        <p id="247759a3">            Typically, local profiling is used when you need to profile the app that is hosted right on your            (developer's) machine or on some testing environment, which doesn't impose any security/performance            restrictions.        </p>        <section class="procedure-steps"><h3 id="dt_local">To locally profile a web app hosted on an IIS server</h3><ol class="list _decimal"><li class="list__item" id="68fe22d9"><p>                Install dotTrace on the server.            </p></li><li class="list__item" id="2f7b8021"><p>                <a href="Profiling_Guidelines__Index.html">Run dotTrace as a standalone                    application                </a>.                The dotTrace <span class="control">Home</span> window will open.            </p></li><li class="list__item" id="b4af291e"><p>                In the right panel, select                <span class="control">Profile Local App</span>.            </p></li><li class="list__item" id="26bac3d3"><p>In the central panel, in <span class="control">Profile Application</span>, select                <span class="control">IIS</span>.            </p></li><li class="list__item" id="02e77447"><p>In the right panel, in <span class="control">Application Options</span>, select                <span class="control">Open URL</span>                and specify the URL of the profiled application. If you do not do this, dotTrace will start profiling                of the first running application pool it'll be able to find.            </p></li><li class="list__item" id="cd5a5d38"><p>                In the right panel, in <span class="control">Profiler Options</span>, specify profiling type.                <br>                For more details on                profiler options, refer to the                <a href="Profiler_Options.html">Profiler Options</a>                                section.            </p></li><li class="list__item" id="8c87c52d"><p>                Optionally, if you are going to control profiling session (take snapshots, end session, and so on) using                the API (rather than the <span class="control">Controller</span> window), select                <span class="control">Control profiling via API</span>. For more details on how to control profiling using the                API,                refer to the                <a href="Profiling_Guidelines__Advanced_Profiling_Using_dotTrace_API.html">Controlling Profiling Session Through API</a>                chapter.            </p></li><li class="list__item" id="590c25ea"><p>                Click <span class="control">Run</span>. Note that after you do this, the IIS service and, as a consequence, the                profiled application pool will be restarted.            </p></li><li class="list__item" id="bfa9104b"><p>                    Take snapshots. For more details on how to control profiling session, refer to                    <a href="Profiling_Guidelines__Launching_and_Controlling_the_Profiling_Process.html">Controlling Profiling Session</a>                                        (if you control profiling manually) or to                    <a href="Profiling_Guidelines__Advanced_Profiling_Using_dotTrace_API.html">Controlling Profiling Session Through API</a>                    (if you control profiling using the API).                </p></li><li class="list__item" id="490dc3de"><p>                    After you collect the snapshot(s), click <span class="control">Detach</span> on the                    <span class="control">Controller</span>                    window to detach the profiler from the application pool.                </p></li><li class="list__item" id="57970b12"><p>                    Analyze the collected snapshots either in the                    <a href="Studying_Profiling_Results__Index.html">Performance Viewer</a>                    or                    <a href="Analyzing_Concurrency_Profiling_Results_Timeline_.html">Timeline Viewer</a>                    (depends on the profiling type you select).                    <br>                    Note that it is normal that the snapshots contain large amount of native code.                </p></li></ol></section>    </div>    <div class="chapter"><h2 id="remote-profiling">Remote profiling</h2>        <figure><img alt="Remote profiling" title="Remote profiling" src="/help/img/dotnet/2019.2/how_to_app_server_remote.png" id="7d57af78" width="617" height="351"></figure>        <p id="fc020116">            Remote profiling is the best choice when it comes to a sudden performance drop / memory issue.        </p>        <p id="a891ff89">            How it works: dotTrace is running on your local machine, the remote agent is running on the            server, both communicating via TCP, as easy as that. The best thing about remote profiling is that you still            work with the easy to use dotTrace GUI and the collected snapshots are automatically copied to and            opened in dotTrace.        </p>        <section class="procedure-steps"><h3 id="e27164d1">To remotely profile a web app hosted on an IIS server</h3><ol class="list _decimal"><li class="list__item" id="5c4fe960">                <p id="61cf0a92">On the web server, do the following:                </p>                <ul class="list _ul"><li class="list__item" id="d690772e"><p>Copy the <span class="filepath">RemoteAgent.zip</span> archive from the                        dotTrace installation directory on your local computer                        (by default, <span class="filepath">C:\Users\[username]\AppData\Local\JetBrains\Installations\dotTrace[N]</span>)                        to any directory on the server.                    </p></li><li class="list__item" id="b9d1a0c6"><p>Unpack the archive on the server.</p></li><li class="list__item" id="68d22ebc"><p>Start <span class="filepath">RemoteAgent.exe</span> from the console on the server.                    </p></li><li class="list__item" id="fb7898cc"><p>Ensure that inbound connections to Remote Agent (by default, port 9100) are not blocked by the                        firewall.                    </p></li></ul>            </li><li class="list__item" id="f97cf69f"><p>On the local computer,                <a href="Profiling_Guidelines__Index.html">run dotTrace as a                    standalone                    application                </a>                <span>run dotTrace as a standalone application</span>.                The dotTrace window will open.            </p></li><li class="list__item" id="b5774814"><p>In the right panel, select                                <span class="control">New Session | Profile Remote App</span>.            </p></li><li class="list__item" id="7423af94"><p>In the central panel, specify the address of the remote agent service in                <span class="control">Remote Agent URL</span>.                <br>                By default, the URL is <span class="filepath">net.tcp://[remote_computer_IP_address]:9100/RemoteAgent</span>.            </p></li><li class="list__item" id="c1dca404"><p>Click <span class="control">Connect</span> to establish connection with the remote host.            </p></li><li class="list__item" id="f306634f"><p>In the central panel, in <span class="control">Attach to Running Application</span> select the                <span class="filepath">w3wp.exe</span>                process that corresponds to the app pool running the profiled application.            </p></li><li class="list__item" id="43ab5ff4"><p>                Optionally, if you are going to control profiling session (take snapshots, end session, and so on) using                the API (rather than the <span class="control">Controller</span> window), select                <span class="control">Control profiling via API</span>. For more details on how to control profiling using the                API,                refer to                <a href="Profiling_Guidelines__Advanced_Profiling_Using_dotTrace_API.html">Controlling Profiling Session Through API</a>.            </p></li><li class="list__item" id="04b321fd"><p>                In the right panel, click <span class="control">Run</span>.            </p></li><li class="list__item" id="edf6f1cf"><p>                    Take snapshots. For more details on how to control profiling session, refer to                    <a href="Profiling_Guidelines__Launching_and_Controlling_the_Profiling_Process.html">Controlling Profiling Session</a>                                        (if you control profiling manually) or to                    <a href="Profiling_Guidelines__Advanced_Profiling_Using_dotTrace_API.html">Controlling Profiling Session Through API</a>                    (if you control profiling using the API).                </p></li><li class="list__item" id="fd7298d9"><p>                    After you collect the snapshot(s), click <span class="control">Detach</span> on the                    <span class="control">Controller</span>                    window to detach the profiler from the application pool.                </p></li><li class="list__item" id="a56fc977"><p>                    Analyze the collected snapshots either in the                    <a href="Studying_Profiling_Results__Index.html">Performance Viewer</a>                    or                    <a href="Analyzing_Concurrency_Profiling_Results_Timeline_.html">Timeline Viewer</a>                    (depends on the profiling type you select).                    <br>                    Note that it is normal that the snapshots contain large amount of native code.                </p></li></ol></section>        <figure data-theme="light" id="03d39bd2" width="700"><img class="js-gif" src="/help/img/dotnet/2019.2/remote-profiling.png" data-gif-src="/help/img/dotnet/2019.2/remote-profiling.animated.gif" width="700" style="width:700px;"></figure>    </div>    <div class="chapter"><h2 id="profiling-via-console-tools">Profiling via console tools</h2>        <figure><img alt="Profiling with console tool" title="Profiling with console tool" src="/help/img/dotnet/2019.2/how_to_app_server_console.png" id="bc95198d" width="620" height="356"></figure>        <p id="5c119241">            Console tools are the best if you need to automate profiling: for example, you should profile your web app from            time to time. Another possible scenario is when you don't have access to the server but some other person            does, so you can provide them with profiling tools and a batch file.        </p>        <p id="de030d08">            How does it work? In short, you copy console tools to the server and either run the app under profiling (the            app pool will be restarted) or attach the tool to the running application pool <span class="filepath">w3wp.exe</span>.                    </p>        <section class="procedure-steps"><h3 id="f1ccdab7">To profile a web app on an IIS server using console tools</h3><ol class="list _decimal"><li class="list__item" id="1d4288a0"><p>                Download the                <a href="https://www.jetbrains.com/profiler/download/#section=dottraceclt" data-external="true" target="_blank" rel="noopener noreferrer">zip archive</a>                with the <span class="filepath">ConsoleProfiler.exe</span> tool and copy/unpack it to the server.            </p></li><li class="list__item" id="95550517"><p>                Now, you should start profiling of the application pool that hosts your application: you can either                attach to an already running app pool or start a new one under profiling. Starting the new one doesn't                give you any advantages over attaching, so, we'll take a look only at the latter (you can still find all                the details in <a href="Performance_Profiling__Profiling_Using_the_Command_Line.html#console_profiler">Profiling applications using the ConsoleProfiler.exe tool</a>).                <br>                To attach <span class="filepath">ConsoleProfiler.exe</span> to the running app pool:                <div class="code-block" data-lang="bash">
ConsoleProfiler.exe attach 1234 --save-to=snapshot.dtp
    </div>                where <code class="code">1234</code> is the process ID of the corresponding                <span class="filepath">w3wp.exe</span>                process.            </p></li><li class="list__item" id="07f649ac">                <p id="725ea608">                    When it comes to taking performance snapshots, you have two options:                </p>                <ul class="list _alpha-lower"><li class="list__item" id="35b4dc0a"><p>                        Get a snapshot by timeout:                        <div class="code-block" data-lang="bash">
ConsoleProfiler.exe attach 1234 --save-to=snapshot.dtp --timeout=5m
    </div>                        here the snapshot will be taken after 5 minutes, then the profiler will detach from the process.                        <figure data-theme="light" id="33ce341b" width="672"><img class="js-gif" src="/help/img/dotnet/2019.2/dotTrace-console-tools-attach.png" data-gif-src="/help/img/dotnet/2019.2/dotTrace-console-tools-attach.animated.gif" width="672" style="width:672px;"></figure>                    </p></li><li class="list__item" id="47ec1adb"><p>                        Get a snapshot on process exit. The                        <span class="filepath">ConsoleProfiler.exe</span>                        tool will take a snapshot once the profiled application successfully finishes its work                        (so, if the app is "killed", no snapshot is                        collected). To make this happen, you can, for example,                        <span class="control">Recycle</span>                        the corresponding application pool in the IIS Manager.                        <figure data-theme="light" id="513d56b1" width="772"><img class="js-gif" src="/help/img/dotnet/2019.2/dotTrace-IIS-recycle.png" data-gif-src="/help/img/dotnet/2019.2/dotTrace-IIS-recycle.animated.gif" width="772" style="width:772px;"></figure>                    </p></li></ul>            </li><li class="list__item" id="9c758c2c"><p>                Copy the resulting snapshot to the computer with installed dotTrace and                analyze it either in the                <a href="Studying_Profiling_Results__Index.html">Performance Viewer</a>                or                <a href="Analyzing_Concurrency_Profiling_Results_Timeline_.html">Timeline Viewer</a>                (depends on the profiling type you select).                <br>                Note that it is normal that the snapshots contain large amount of native code.            </p></li></ol></section>            </div>    <div class="last-modified" data-skip-index="skip">Last modified: 19 September 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Profile_Web_Application_on_IIS_Express.html">Profile Web Application in IIS Express</a><a class="navigation-links__next" href="Profile_.NET_Core_Application.html">Profile .NET Core Application</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>