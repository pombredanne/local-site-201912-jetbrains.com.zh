<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>SQL查询-帮助| dotTrace</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="SQL_Client" data-disqus-id="SQL_Client_dt"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索dotTrace帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>dotTrace 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="rs" data-group="secondary">ReSharper 2.x / IntelliJ IDEA</option><option value="vs" data-group="primary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="SQL_Client.xml" data-toc="SQL_Client">SQL查询</h1>    <aside class="warning " rel="SQL_Client.xml" id="7bf9e91e" data-title="">        <p id="1c6228db">已知限制：</p>        <ul class="list _ul"><li class="list__item" id="527a55b7"><p>.NET Core不支持SQL ETW事件：“ <span class="control">SQL查询”</span>过滤器不显示.NET Core应用程序的任何数据。</p></li><li class="list__item" id="7f4b5324"><p>Windows Vista和Windows Server 2008不支持SQL ETW事件：“ <span class="control">SQL查询”</span>过滤器在这些操作系统上不显示任何数据。</p></li></ul>    </aside>    <p id="06c1e2b7"><span class="control">SQL查询</span>事件指示您的应用程序与SQL Server通信的时间间隔。这包括打开和关闭连接，运行命令，执行查询以及其他SQL活动所需的时间。请注意，所有测量都是在客户端执行的-dotTrace测量的是客户端发送请求到接收响应之间的时间。</p>    <p id="0ff49ce2">dotTrace从以下数据提供程序收集SQL数据：</p>    <ul class="list _ul"><li class="list__item" id="2e9a8f40"><p>SQL客户端</p></li><li class="list__item" id="46da91e0"><p>OLE DB *</p></li><li class="list__item" id="318a4bf1"><p>实体框架</p></li><li class="list__item" id="06116163"><p>ODBC *</p></li></ul>    <aside class="note " rel="81de51bb" id="9ad7c0e7" data-title="">        <p id="9bb9617a">* dotTrace收集有关管理命令的有限数据。<br>如果您使用OLE DB，则以下命令将不会显示在<span class="control">SQL查询中：命令</span>子过滤器：</p><ul class="list _ul"><li class="list__item" id="b6b1f991">                    <span class="control">[开放连接]</span>                </li><li class="list__item" id="f048b2f7">                    <span class="control">[关闭连接]</span>                </li></ul>            <br>对于ODBC，这些是：<ul class="list _ul"><li class="list__item" id="c02e477f">                    <span class="control">[开始交易]</span>                </li><li class="list__item" id="f4cb6c07">                    <span class="control">[提交交易]</span>                </li><li class="list__item" id="3ad4ebd5">                    <span class="control">[回滚交易]</span>                </li></ul>            <br>另外，ODBC和OLE DB不提供连接数据，因此，在两种情况下， <span class="control">SQL查询：连接字符串</span>子过滤器将显示<span class="control">[Unknown]</span>而不是连接字符串。<p></p>    </aside>    <p id="debebbea">选择“ <span class="control">SQL查询”</span>事件以分析您的应用如何访问数据。例如，由于SQL Server通信中的瓶颈，Web应用程序可能运行缓慢。在这种情况下，可以使用“ <span class="control">SQL查询”</span>过滤器来确定最慢的查询和运行这些查询的方法。</p>    <p id="9cfae7ba">选择“ <span class="control">SQL查询”</span>事件后，“ <span class="control">过滤器”</span>窗口将包含子过滤器，这些子过滤器可用于优化所得的过滤器： <span class="control">SQL查询：命令</span>和<span class="control">SQL查询：连接字符串</span> 。</p>    <div class="chapter"><h2 id="aeb966d8" data-toc="SQL_Client#aeb966d8">SQL查询：命令</h2>        <p id="2c29ed84">“ <span class="control">SQL查询：命令”</span>子过滤器显示SQL命令之间的SQL操作时间分布：查询，打开和关闭连接命令，等等。使用此子过滤器可以确定特定命令需要花费多少时间。</p>        <figure><img alt="sql客户端命令1" title="sql客户端命令1" src="/help/img/dotnet/2019.2/sql_client_command_1.png" id="a3241bdb" width="350" height="199"></figure>        <p id="3c95352a">            <img alt="位置1" title="位置1" src="/help/img/dotnet/2019.2/pos_1.png" id="87610f0b" width="32" height="32" class="inline-icon-32">命令名称或查询内容。</p>        <p id="a824fca5">            <img alt="位置2" title="位置2" src="/help/img/dotnet/2019.2/pos_2.png" id="8b023d12" width="31" height="31" class="inline-icon-31">对于所有选定线程，SQL命令所花费的总时间总计。<br>        </p>        <p id="2493a577">            <img alt="位置3" title="位置3" src="/help/img/dotnet/2019.2/pos_3.png" id="c81f9f83" width="31" height="30" class="inline-icon-31">在SQL命令上花费的时间相对于总选定时间的百分比。</p>        <section class="procedure-steps"><h3 id="6ff1f676">要应用SQL查询：命令过滤器：</h3><div id="83ff551c"><p>在过滤器中选择所需的SQL命令。</p></div></section>        <p id="94323ee1">选择命令后，其他过滤器将仅显示执行所选命令的时间间隔内的数据。</p>        <figure><img alt="sql客户端命令2" title="sql客户端命令2" src="/help/img/dotnet/2019.2/sql_client_command_2.png" id="1febd5c8" width="351" height="365" align="middle"></figure>    </div>    <div class="chapter"><h2 id="c7bb5c82" data-toc="SQL_Client#c7bb5c82">SQL查询窗口</h2>        <p id="0a44fcd9">如果命令内容太长而无法容纳“ <span class="control">过滤器”</span>窗口，则会按宽度将其截断。要查看该命令的全部内容，请打开“ <span class="control">SQL查询”</span>窗口。该窗口显示与“ <span class="control">SQL查询：命令”</span>过滤器相同的数据，但此外，它允许按内容查找命令并将内容复制到剪贴板。</p>        <figure><img alt="sql查询" title="sql查询" src="/help/img/dotnet/2019.2/sql_queries.png" id="206788d1" width="643" height="456"></figure>        <section class="procedure-steps"><h3 id="87cd214a">打开“ SQL查询”窗口</h3><div id="f5dbc108"><p>请执行以下任一操作：</p><ul class="list _ul"><li class="list__item" id="74cc7834"><p>使用菜单<span class="menupath" data-skip-index="skip">查看| SQL查询</span> 。</p></li><li class="list__item" id="4a4b879b"><p>点击<img alt="主题图标数据表打开屏幕灰色" title="主题图标数据表打开屏幕灰色" src="/help/img/dotnet/2019.2/ThemedIcon.DatailsTableOpen.Screen.[Gray].png" id="e4c13385" width="14" height="14" class="inline-icon-14"> <span class="control">SQL查询：命令</span>过滤器中的按钮。</p></li></ul>            <p></p></div></section>        <p id="6f2d4166">与“ <span class="control">SQL查询：命令”</span>过滤器一样，“ <span class="control">SQL查询”</span>窗口也可以用作SQL命令的过滤器。</p>        <section class="procedure-steps"><h3 id="88c95a19">通过特定命令（查询）应用过滤器</h3><div id="d1657e67"><p>请执行以下任一操作：</p><ul class="list _ul"><li class="list__item" id="cc787842"><p>选择所需的SQL命令。</p></li><li class="list__item" id="744cfe96"><p>双击所需的SQL命令。</p></li><li class="list__item" id="4a234a86"><p>选择所需的SQL命令并按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Enter</span></kbd>                    </p></li><li class="list__item" id="6d8c3066"><p>在所需的SQL命令的上下文菜单中，选择“ <span class="control">选择并清除其他”</span> 。</p></li></ul>            <p></p></div></section>        <section class="procedure-steps"><h3 id="4cf886e4">通过多个命令（查询）应用过滤器</h3><div id="f7a1cfb1"><p>请执行以下任一操作：</p><ul class="list _ul"><li class="list__item" id="bf0535d1"><p>选择所需的SQL命令并按<kbd class="keystroke" data-bypass="true"><span class="keystroke__value">Space</span></kbd> 。</p></li><li class="list__item" id="3862b5d0"><p>在所需的SQL命令的上下文菜单中，选择“ <span class="control">选择为筛选器”</span> 。</p></li></ul>这会将SQL命令添加到选择中。<p></p></div></section>        <section class="procedure-steps"><h3 id="f1e78205">要将命令内容复制到剪贴板</h3><div id="c07d5662"><p>在所需的SQL查询的上下文菜单中，选择<span class="control">复制到剪贴板</span> 。</p></div></section>        <section class="procedure-steps"><h3 id="5babb301">通过内容查找特定的SQL命令（查询）</h3><div id="9636d834"><p>在“ <span class="control">SQL查询”</span>窗口顶部的搜索文本框中，开始键入要查找的命令（查询）内容。键入时，SQL命令的列表会变窄，建议与输入的字符串匹配的命令。</p></div></section>        <p id="5a54bd60">为方便起见，将截断包含多行的大型命令。</p>        <section class="procedure-steps"><h3 id="12c56292">查看截断命令的完整内容</h3><div id="3b2f0ad1"><p>请执行以下任一操作：</p><ul class="list _ul"><li class="list__item" id="5f5fbe3b"><p>单击命令末尾的<span class="control">...</span>按钮。</p></li><li class="list__item" id="e788fc56"><p>在所需的SQL命令的上下文菜单中，选择<span class="control">显示完整查询</span> 。</p></li></ul>            <p></p></div></section>    </div>    <div class="chapter"><h2 id="aa5d4fed" data-toc="SQL_Client#aa5d4fed">SQL查询：连接字符串</h2>        <p id="bf10ad6b"><span class="control">SQL查询：连接字符串</span>子过滤器显示具有特定连接参数的SQL命令之间的<span class="control">SQL查询</span>时间分布。例如，如果您的应用程序与多个SQL Server通信时，此过滤器可能会很有用。</p>        <figure><img alt="sql客户端连接字符串1" title="sql客户端连接字符串1" src="/help/img/dotnet/2019.2/sql_client_connection_string_1.png" id="aca69165" width="348" height="127"></figure>        <p id="4ff3c1cd">            <img alt="位置1" title="位置1" src="/help/img/dotnet/2019.2/pos_1.png" id="81b717a0" width="32" height="32" class="inline-icon-32">连接字符串。</p>        <p id="035f6da3">            <img alt="位置2" title="位置2" src="/help/img/dotnet/2019.2/pos_2.png" id="b91cadf0" width="31" height="31" class="inline-icon-31">具有这些连接参数的所有SQL命令的总时间。<br>        </p>        <p id="e898b874">            <img alt="位置3" title="位置3" src="/help/img/dotnet/2019.2/pos_3.png" id="72b1bd20" width="31" height="30" class="inline-icon-31">相对于总选定时间，使用这些连接参数运行SQL命令所花费的时间百分比。</p>        <section class="procedure-steps"><h3 id="ce4db072">要应用SQL查询：连接字符串过滤器</h3><div id="8a2a6538"><p>在过滤器中选择所需的字符串。</p></div></section>        <p id="3ed561d9">选择连接字符串后，其他筛选器将仅在线程运行带有相应连接参数的SQL命令的时间间隔内显示数据。</p>        <figure><img alt="sql客户端连接字符串2" title="sql客户端连接字符串2" src="/help/img/dotnet/2019.2/sql_client_connection_string_2.png" id="97289289" width="411" height="366" align="middle"></figure>    </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年9月19日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="File_I_O.html">文件操作</a> <a class="navigation-links__next" href="Thread_State.html">线程状态</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>