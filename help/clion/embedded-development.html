<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>STM32CubeMX Projects - Help | CLion</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Embedded_Development" data-breadcrumbs="Build, Run, Debug/Embedded Development/Embedded_Development.xml|STM32CubeMX Projects" data-main-title="STM32CubeMX Projects"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search CLion Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>CLion 2019.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default_for_windows" selected>Default for Windows</option><option data-group="primary" value="primary_default_for_macos">Default for macOS</option><option data-group="primary" value="primary_intellij_idea_classic_macos">IntelliJ IDEA Classic (macOS)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_macos">Eclipse (macOS)</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_sublime_text">Sublime Text</option><option data-group="primary" value="primary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="primary" value="primary_xcode">Xcode</option><option data-group="primary" value="primary_resharper">ReSharper</option><option data-group="primary" value="primary_resharper_macos">ReSharper (macOS)</option><option data-group="secondary" value="secondary_default_for_windows">Default for Windows</option><option data-group="secondary" value="secondary_default_for_macos">Default for macOS</option><option data-group="secondary" value="secondary_intellij_idea_classic">IntelliJ IDEA Classic</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_macos">Eclipse (macOS)</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_sublime_text">Sublime Text</option><option data-group="secondary" value="secondary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="secondary" value="secondary_xcode">Xcode</option><option data-group="secondary" value="secondary_resharper">ReSharper</option><option data-group="secondary" value="secondary_resharper_macos">ReSharper (macOS)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Embedded_Development" id="Embedded_Development.xml">STM32CubeMX Projects</h1>        <p id="fee576dd">For embedded projects that target <a href="https://www.st.com/en/microcontrollers-microprocessors/stm32-32-bit-arm-cortex-mcus.html" data-external="true" target="_blank" rel="noopener noreferrer">STM32</a> boards, CLion provides integration with <a href="https://www.st.com/en/development-tools/stm32cubemx.html" data-external="true" target="_blank" rel="noopener noreferrer">STM32CubeMX</a>. You can open an <span class="filepath">.ioc</span> file generated by CubeMX as project in CLion, and the CMake project structure will be created automatically. Or you can start a new project from scratch in CLion and the project wizard will help you configure it in CubeMX.</p>    <aside data-type="note" class="prompt" data-title="" rel="fee576dd" id="de4592a2"><p>STM32CubeMX support in CLion is a part of the bundled <a href="https://plugins.jetbrains.com/plugin/10115-openocd--stm32cubemx-support-for-arm-embedded-development" data-external="true" target="_blank" rel="noopener noreferrer">OpenOCD + STM32CubeMX</a> plugin. For this reason, project settings and certain steps of the project creation procedure are coupled with <a href="openocd-support.html">OpenOCD</a>. However, STM32CubeMX projects are not limited to be used with OpenOCD only: you can also set up a more generic <a href="embedded-gdb-server.html">Embedded GDB Server</a> run/debug configuration. In the latter case, ignore the OpenOCD-related settings and steps of your project set up.</p></aside>    <section class="procedure-steps"><h3 id="prepare-tools" data-toc="Embedded_Development#prepare-tools">Required tools</h3><div class="tabs" id="d09fccf3"><div class="tabs__content" data-title="All platforms" id="4780164a">                <ol class="list _decimal"><li class="list__item" id="1e63ce3b">                        <p id="e1539f4b">                            <a href="https://www.st.com/en/development-tools/stm32cubemx.html#getsoftware-scroll" data-external="true" target="_blank" rel="noopener noreferrer">STM32CubeMX</a>                        </p>                        <p id="de518fa4">CubeMX is a graphical tool to configure STM32 microcontrollers and generate the corresponding C code. In CubeMX, you can set up both CPU and peripherals, and adjust frequencies and pin modes. It generates a stub project that CLion then converts into a CMake project.</p>                    </li><li class="list__item" id="80b20342"><p id="f45c2c5f">                        <a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm" data-external="true" target="_blank" rel="noopener noreferrer">GNU ARM toolchain</a>                        </p>                       <p id="e33f6393">                           GNU ARM toolchain is a cross-platform set of tools that launches on desktop, while the build result can only run under the target ARM MCU environment.                        After the installation, make sure the toolchain is presented in the system PATH: run <code class="code">arm-none-eabi-gcc</code> from the command line - your system should recognize this command.</p>                    </li></ol>                <p id="4174eba6">In <span data-skip-index="skip" class="menupath">Settings/Preferences | Build, Execution, Deployment | Embedded Development</span>, you can check whether the toolchain was detected correctly and set the path manually if needed. If you don't plan to use OpenOCD, leave the <span class="control">OpenOCD Location</span> field empty.</p>            </div><div class="tabs__content" data-title="Windows-specific" id="0af3c00e">                <ul class="list _ul"><li class="list__item" id="8dd5e5c3"><p>For <span class="control">GNU ARM Toolchain</span>, use version 2019-q3 or 2018-q2 (and earlier). See the <a href="https://bugs.launchpad.net/gcc-arm-embedded/+bug/1810274" data-external="true" target="_blank" rel="noopener noreferrer">issue</a> with 2018-q4.</p></li><li class="list__item" id="35d1b3c9"><p>Only the <span class="control">MinGW</span> and <span class="control">MinGW-w64</span> environments are supported (<a href="https://youtrack.jetbrains.com/issue/CPP-15034" data-external="true" target="_blank" rel="noopener noreferrer">CPP-15034</a>).</p></li></ul>            </div></div></section>    <section class="procedure-steps"><h3 id="open-project" data-toc="Embedded_Development#open-project">Open a project from the .ioc file</h3><ul class="list "><li class="list__item" id="b0f4b3e0">        <p id="0e832a24">If you already have a project that contains an <span class="filepath">.ioc</span> file, call <span data-skip-index="skip" class="menupath">File | Open</span>, select the <span class="filepath">.ioc</span> file, and choose <span class="control">Open as Project</span>. CLion will automatically generate the CMake project structure.</p>        </li></ul></section>        <section class="procedure-steps"><h3 id="new-project" data-toc="Embedded_Development#new-project">Create a new project</h3><p id="cdc578e9">For new projects, you can either start from configuring your MCU and generating code in CubeMX and then <a href="#open-project">open</a> the <span class="filepath">.ioc</span> file in CLion, or you can create a project from scratch as described below.</p><ol class="list _decimal"><li class="list__item" id="create-new">            <p id="77229abe">                In the <span class="control">New Project</span> wizard (<span data-skip-index="skip" class="menupath">File | New Project</span>), select <span class="control">STM32CubeMX</span> as your project type.                CLion will create the <span class="filepath">.ioc</span> file for the default <i id="5c8ba405">STM32F030F4</i> MCU:                <figure><img alt="template new project" title="template new project" src="/help/img/idea/2019.3/cl_embed_defaultproject.png" id="f4ac9a11" width="650" height="442"></figure>            </p>            <p id="2bf4acc6">                The <span class="filepath">.ioc</span> files are CubeMX original project files that contain static initialization settings.                In CLion, this file is read-only and on the current step it is a place-holder for the configuration that will be set up in CubeMX on the next step.            </p>        </li><li class="list__item" id="1a6d3997">            <p id="6194389d">                Now we need to switch to CubeMX to generate the project sources and fill the <span class="filepath">.ioc</span> file. Click the <span class="control">Open with STM32CubeMX</span> link to open CubeMX right from CLion.            </p>        </li><li class="list__item" id="083eaf4c">            <p id="aa2d3889">                In CubeMX, the configuration is already set for the newly created project. Click <span class="control">STM32F030F4Px</span> to invoke the <span class="control">MCU/Board Selector</span> and change the default MCU:                <figure><img alt="changing mcu in cubemx" title="changing mcu in cubemx" src="/help/img/idea/2019.3/cl_embed_cubemx.png" id="2d23763b" width="800" height="1113"></figure>            </p>            <aside data-type="note" class="prompt" data-title="" rel="aa2d3889" id="2d405998"><p>                CubeMX resets the project name when the MCU changes. So we need to provide the name manually in <span class="control">Project Manager</span>, and then accept the suggestion to overwrite the project.            </p></aside>            <p id="8225baae">After the hardware configuration is ready, check that the <span class="control">Toolchain / IDE</span> field is set to <i id="ad1a88a6">SW4STM32</i> and                select <span class="control">Generate Under Root</span>, then click <span class="control">Generate Code</span>:                <figure><img alt="generate code in cubemx" title="generate code in cubemx" src="/help/img/idea/2019.3/cl_embed_cubemx_generate.png" id="bc57ee9c" width="800" height="780"></figure>            </p>        </li><li class="list__item" id="346cc3b9">            <aside data-type="note" class="prompt" data-title="" rel="346cc3b9" id="e53cfe1b"><p>Skip this step (click <span class="control">Cancel</span>) if you don't plan to use OpenOCD.</p></aside>            <p id="12a8f139">                Back in CLion, when the CMake project loading completes, we are prompted to select the board config file. The list of suggestions is taken from the set of board config files shipped with OpenOCD in the <span class="filepath">Openocd-Installation/share/openocd/scripts/board</span> folder:                <figure><img alt="board configs selection dialog" title="board configs selection dialog" src="/help/img/idea/2019.3/cl_embed_bardconfigs.png" id="91a6cc0b" width="387" height="509"></figure>            </p>            <p id="f8a40286">                You will also be able to select the proper board config, including a custom one, later in the settings of the <span class="control">OpenOCD Run/Debug configuration</span>.            </p>            <p id="eccf008e">Click <span class="control">Copy to Project &amp; Use</span> to add the selected board config file to your project tree. You will be able to open and adjust it in the editor.</p>        </li></ol></section>    <section class="procedure-steps"><h3 id="edit-sources" data-toc="Embedded_Development#edit-sources">Edit source code</h3><ul class="list "><li class="list__item" id="841c0476">            <p id="47c5a946">                When you change the MCU configuration in CubeMX and click <span class="control">Generate Code</span>, your CLion project is updated automatically:                <figure><img alt="project update after changes in cubemx" title="project update after changes in cubemx" src="/help/img/idea/2019.3/cl_embed_prjupdate.png" id="84d54d70" width="371" height="150"></figure>            </p>            <p id="09799352">You can also update the project manually: to do this, select <span class="control">Update CMake project with STM32CubeMX</span>  from <span data-skip-index="skip" class="menupath">Tools | CMake</span> on the main menu or from the context menu of the <span class="control">Project View</span>.</p>        </li><li class="list__item" id="c060e4a6">            <p id="0666fa82">While editing the files generated by CubeMX, always enclose your code in the <code class="code">/* USER CODE BEGIN ... */</code> and <code class="code">/* USER CODE END ... */</code> pseudo comments. This will protect your code from being overwritten by CubeMX during code regeneration. Also, consider extracting pieces of code into separate <span class="filepath">.c</span> or <span class="filepath">.h</span> files (see the next point).</p>        </li><li class="list__item" id="57678fda"><p>If you add source or include files, place them in the <span class="filepath">Src</span> and <span class="filepath">Inc</span> directories.</p></li><li class="list__item" id="c595a68b"><p>            CLion regenerates <span class="filepath">CMakeLists.txt</span> from the template every time the project is updated. If you need to make changes in the CMake script (for example, to add external libraries or FPU support), do so in <span class="filepath">CMakeLists_template.txt</span> and then call <span class="control">Update CMake project with STM32CubeMX</span>.        </p></li></ul></section>    <section class="procedure-steps"><h3 id="build" data-toc="Embedded_Development#build">Build a project</h3><p id="36cfa49c">Choose one of the following options:</p><ul class="list "><li class="list__item" id="c7df2125"><p>Run or debug an <a href="openocd-support.html">OpenOCD</a> or <a href="embedded-gdb-server.html">Embedded GDB Server</a> configuration. Both of these configurations include <span class="control">Build</span> as a <span class="control">Before launch</span> step:        <figure><img alt="Build before launch in OpenOCD Download &amp; Run configuration" title="Build before launch in OpenOCD Download &amp; Run configuration" src="/help/img/idea/2019.3/cl_openocd_beforelaunch.png" id="e1444bc6" width="700" height="813"></figure>        </p></li><li class="list__item" id="87e01a90"><p>Use <a href="build-actions.html">Build actions</a> to build the project manually.</p></li></ul></section>     <div class="last-modified" data-skip-index="skip">Last modified: 1 December 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__next" href="openocd-support.html">OpenOCD Support</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>