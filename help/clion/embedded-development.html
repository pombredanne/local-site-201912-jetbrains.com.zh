<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>STM32CubeMX项目-帮助|帮助里昂</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Embedded_Development" data-breadcrumbs="Build, Run, Debug/Embedded Development/Embedded_Development.xml|STM32CubeMX Projects" data-main-title="STM32CubeMX Projects"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索CLion帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>CLion 2019.3帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default_for_windows" data-group="primary" selected>Windows的默认设置</option><option value="primary_default_for_macos" data-group="primary">macOS的默认设置</option><option value="primary_intellij_idea_classic_macos" data-group="primary">IntelliJ IDEA经典版（macOS）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_macos" data-group="primary">Eclipse（macOS）</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_sublime_text" data-group="primary">崇高文字</option><option value="primary_sublime_text_macos" data-group="primary">崇高文字（macOS）</option><option value="primary_xcode" data-group="primary">Xcode</option><option value="primary_resharper" data-group="primary">锐化器</option><option value="primary_resharper_macos" data-group="primary">ReSharper（macOS）</option><option value="secondary_default_for_windows" data-group="secondary">Windows的默认设置</option><option value="secondary_default_for_macos" data-group="secondary">macOS的默认设置</option><option value="secondary_intellij_idea_classic" data-group="secondary">IntelliJ IDEA经典版</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_macos" data-group="secondary">Eclipse（macOS）</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_sublime_text" data-group="secondary">崇高文字</option><option value="secondary_sublime_text_macos" data-group="secondary">崇高文字（macOS）</option><option value="secondary_xcode" data-group="secondary">Xcode</option><option value="secondary_resharper" data-group="secondary">锐化器</option><option value="secondary_resharper_macos" data-group="secondary">ReSharper（macOS）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Embedded_Development.xml" data-toc="Embedded_Development">STM32CubeMX项目</h1>        <p id="fee576dd">对于面向<a href="https://www.st.com/en/microcontrollers-microprocessors/stm32-32-bit-arm-cortex-mcus.html" rel="noopener noreferrer" data-external="true" target="_blank">STM32</a>板的嵌入式项目，CLion提供了与<a href="https://www.st.com/en/development-tools/stm32cubemx.html" rel="noopener noreferrer" data-external="true" target="_blank">STM32CubeMX的</a>集成。您可以在<span class="filepath">CLion</span>中打开由<span class="filepath">CubeMX</span>生成的<span class="filepath">.ioc</span>文件作为项目，然后CMake项目结构将自动创建。或者，您可以在CLion中从头开始新项目，项目向导将帮助您在CubeMX中对其进行配置。</p>    <aside class="prompt" rel="fee576dd" id="de4592a2" data-type="note" data-title=""><p>CLion中的STM32CubeMX支持是捆绑的<a href="https://plugins.jetbrains.com/plugin/10115-openocd--stm32cubemx-support-for-arm-embedded-development" rel="noopener noreferrer" data-external="true" target="_blank">OpenOCD + STM32CubeMX</a>插件的一部分。因此，将项目设置和项目创建过程的某些步骤与<a href="openocd-support.html">OpenOCD</a>结合在一起。但是，STM32CubeMX项目不限于仅与OpenOCD一起使用：您还可以设置更通用的<a href="embedded-gdb-server.html">嵌入式GDB服务器</a>运行/调试配置。在后一种情况下，请忽略与OpenOCD相关的设置以及项目设置步骤。</p></aside>    <section class="procedure-steps"><h3 id="prepare-tools" data-toc="Embedded_Development#prepare-tools">必备工具</h3><div class="tabs" id="d09fccf3"><div class="tabs__content" id="4780164a" data-title="All platforms">                <ol class="list _decimal"><li class="list__item" id="1e63ce3b">                        <p id="e1539f4b">                            <a href="https://www.st.com/en/development-tools/stm32cubemx.html#getsoftware-scroll" rel="noopener noreferrer" data-external="true" target="_blank">STM32CubeMX</a>                        </p>                        <p id="de518fa4">CubeMX是用于配置STM32微控制器并生成相应C代码的图形工具。在CubeMX中，您可以设置CPU和外围设备，并调整频率和引脚模式。它生成一个存根项目，CLion然后将其转换为CMake项目。</p>                    </li><li class="list__item" id="80b20342"><p id="f45c2c5f">                        <a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm" rel="noopener noreferrer" data-external="true" target="_blank">GNU ARM工具链</a>                        </p>                       <p id="e33f6393">GNU ARM工具链是在桌面上启动的跨平台工具集，而构建结果只能在目标ARM MCU环境下运行。安装后，确保工具链显示在系统路径中：run <code class="code">arm-none-eabi-gcc</code>从命令行-您的系统应该可以识别此命令。</p>                    </li></ol>                <p id="4174eba6">在<span class="menupath" data-skip-index="skip">设置/首选项中|构建，执行，部署|嵌入式开发</span> ，您可以检查是否正确检测到工具链，并在需要时手动设置路径。如果您不打算使用OpenOCD，请将“ <span class="control">OpenOCD位置”</span>字段留空。</p>            </div><div class="tabs__content" id="0af3c00e" data-title="Windows-specific">                <ul class="list _ul"><li class="list__item" id="8dd5e5c3"><p>对于<span class="control">GNU ARM工具链</span> ，请使用版本2019-q3或2018-q2（或更早版本）。见<a href="https://bugs.launchpad.net/gcc-arm-embedded/+bug/1810274" rel="noopener noreferrer" data-external="true" target="_blank">问题</a>与2018-Q4。</p></li><li class="list__item" id="35d1b3c9"><p>仅支持<span class="control">MinGW</span>和<span class="control">MinGW-w64</span>环境（ <a href="https://youtrack.jetbrains.com/issue/CPP-15034" rel="noopener noreferrer" data-external="true" target="_blank">CPP-15034</a> ）。</p></li></ul>            </div></div></section>    <section class="procedure-steps"><h3 id="open-project" data-toc="Embedded_Development#open-project">从.ioc文件打开一个项目</h3><ul class="list "><li class="list__item" id="b0f4b3e0">        <p id="0e832a24">如果您已经有一个包含<span class="filepath">.ioc</span>文件的项目，请调用<span class="menupath" data-skip-index="skip">File | File。打开</span> ，选择<span class="filepath">.ioc</span>文件，然后选择<span class="control">打开为项目</span> 。CLion将自动生成CMake项目结构。</p>        </li></ul></section>        <section class="procedure-steps"><h3 id="new-project" data-toc="Embedded_Development#new-project">创建一个新项目</h3><p id="cdc578e9">对于新项目，您可以从配置MCU并在CubeMX中生成代码开始，然后在CLion中<a href="#open-project">打开</a> <span class="filepath">.ioc</span>文件，也可以按如下所述从头开始创建项目。</p><ol class="list _decimal"><li class="list__item" id="create-new">            <p id="77229abe">在“ <span class="control">新建项目”</span>向导（“ <span class="menupath" data-skip-index="skip">文件” |“新建项目”</span> ）中，选择<span class="control">STM32CubeMX</span>作为您的项目类型。CLion将为默认的<i id="5c8ba405">STM32F030F4</i> MCU创建<span class="filepath">.ioc</span>文件：</p><figure><img alt="模板新项目" title="模板新项目" src="/help/img/idea/2019.3/cl_embed_defaultproject.png" id="f4ac9a11" width="650" height="442"></figure>            <p></p>            <p id="2bf4acc6"><span class="filepath">.ioc</span>文件是包含静态初始化设置的CubeMX原始项目文件。在CLion中，此文件为只读文件，在当前步骤中，它是将在下一步在CubeMX中设置的配置的占位符。</p>        </li><li class="list__item" id="1a6d3997">            <p id="6194389d">现在，我们需要切换到CubeMX来生成项目源并填充<span class="filepath">.ioc</span>文件。单击“ <span class="control">使用STM32CubeMX打开”</span>链接以直接从CLion打开CubeMX。</p>        </li><li class="list__item" id="083eaf4c">            <p id="aa2d3889">在CubeMX中，已经为新创建的项目设置了配置。单击<span class="control">STM32F030F4Px</span>调用<span class="control">MCU /板选择器</span>并更改默认MCU：</p><figure><img alt="在cubemx中更改MCU" title="在cubemx中更改MCU" src="/help/img/idea/2019.3/cl_embed_cubemx.png" id="2d23763b" width="800" height="1113"></figure>            <p></p>            <aside class="prompt" rel="aa2d3889" id="2d405998" data-type="note" data-title=""><p>MCU更改时，CubeMX会重置项目名称。因此，我们需要在<span class="control">Project Manager中</span>手动提供名称，然后接受覆盖项目的建议。</p></aside>            <p id="8225baae">准备好硬件配置后，检查“ <span class="control">工具链/ IDE”</span>字段是否设置为<i id="ad1a88a6">SW4STM32</i>并选择“ <span class="control">在根下</span> <span class="control">生成”</span> ，然后单击“ <span class="control">生成代码”</span> ：</p><figure><img alt="在cubemx中生成代码" title="在cubemx中生成代码" src="/help/img/idea/2019.3/cl_embed_cubemx_generate.png" id="bc57ee9c" width="800" height="780"></figure>            <p></p>        </li><li class="list__item" id="346cc3b9">            <aside class="prompt" rel="346cc3b9" id="e53cfe1b" data-type="note" data-title=""><p>如果您不打算使用OpenOCD，请跳过此步骤（单击“ <span class="control">取消”</span> ）。</p></aside>            <p id="12a8f139">回到CLion中，当CMake项目加载完成时，系统会提示我们选择板配置文件。建议列表取自<span class="filepath">Openocd-Installation / share / openocd / scripts / board</span>文件夹中OpenOCD随附的一组板配置文件：</p><figure><img alt="板配置选择对话框" title="板配置选择对话框" src="/help/img/idea/2019.3/cl_embed_bardconfigs.png" id="91a6cc0b" width="387" height="509"></figure>            <p></p>            <p id="f8a40286">稍后，您还可以在<span class="control">OpenOCD运行/调试配置</span>的设置中选择适当的板配置，包括自定义板<span class="control">配置</span> 。</p>            <p id="eccf008e">单击<span class="control">复制到项目并使用</span> ，将选定的电路板配置文件添加到项目树中。您将能够在编辑器中打开和调整它。</p>        </li></ol></section>    <section class="procedure-steps"><h3 id="edit-sources" data-toc="Embedded_Development#edit-sources">编辑源代码</h3><ul class="list "><li class="list__item" id="841c0476">            <p id="47c5a946">当您在CubeMX中更改MCU配置并单击<span class="control">Generate Code时</span> ，您的CLion项目将自动更新：</p><figure><img alt="cubemx更改后的项目更新" title="cubemx更改后的项目更新" src="/help/img/idea/2019.3/cl_embed_prjupdate.png" id="84d54d70" width="371" height="150"></figure>            <p></p>            <p id="09799352">您也可以手动更新项目：为此， <span class="control">请</span>从“ <span class="menupath" data-skip-index="skip">工具” |“</span>选择<span class="control">”</span> <span class="menupath" data-skip-index="skip">|“</span> <span class="control">使用STM32CubeMX更新CMake项目”</span> <span class="menupath" data-skip-index="skip">。 CMake</span>在主菜单上或从<span class="control">项目视图</span>的上下文菜单中。</p>        </li><li class="list__item" id="c060e4a6">            <p id="0666fa82">在编辑CubeMX生成的文件时，请始终将您的代码包含在<code class="code">/* USER CODE BEGIN ... */</code>和<code class="code">/* USER CODE END ... */</code>伪评论。这将保护您的代码在代码重新生成期间不会被CubeMX覆盖。另外，请考虑将代码片段提取到单独的<span class="filepath">.c</span>或<span class="filepath">.h</span>文件中（请参阅下一点）。</p>        </li><li class="list__item" id="57678fda"><p>如果添加源文件或包含文件，请将它们放在<span class="filepath">Src</span>和<span class="filepath">Inc</span>目录中。</p></li><li class="list__item" id="c595a68b"><p>每次更新项目时，CLion都会从模板中重新生成<span class="filepath">CMakeLists.txt</span> 。如果需要在CMake脚本中进行更改（例如，添加外部库或FPU支持），请在<span class="filepath">CMakeLists_template.txt中</span>进行更改，然后<span class="control">使用STM32CubeMX</span>调用<span class="control">Update CMake项目</span> 。</p></li></ul></section>    <section class="procedure-steps"><h3 id="build" data-toc="Embedded_Development#build">建立一个项目</h3><p id="36cfa49c">选择以下选项之一：</p><ul class="list "><li class="list__item" id="c7df2125"><p>运行或调试<a href="openocd-support.html">OpenOCD</a>或<a href="embedded-gdb-server.html">嵌入式GDB服务器</a>配置。这两个配置都包括“作为<span class="control">启动之前</span> <span class="control">构建”</span>步骤：</p><figure><img alt="在OpenOCD下载和运行配置中启动之前进行构建" title="在OpenOCD下载和运行配置中启动之前进行构建" src="/help/img/idea/2019.3/cl_openocd_beforelaunch.png" id="e1444bc6" width="700" height="813"></figure>        <p></p></li><li class="list__item" id="87e01a90"><p>使用“ <a href="build-actions.html">构建”操作</a>来手动构建项目。</p></li></ul></section>     <div class="last-modified" data-skip-index="skip">上次修改时间：2019年12月1日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__next" href="openocd-support.html">OpenOCD支持</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>