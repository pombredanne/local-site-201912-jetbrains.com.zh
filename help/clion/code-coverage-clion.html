<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Code Coverage - Help | CLion</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Code_Coverage_CLion" data-breadcrumbs="Profiling_Tools.xml|Dynamic Code Analysis/Code_Coverage_CLion.xml|Code Coverage" data-main-title="Code Coverage"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search CLion Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>CLion 2019.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default_for_windows" selected>Default for Windows</option><option data-group="primary" value="primary_default_for_macos">Default for macOS</option><option data-group="primary" value="primary_intellij_idea_classic_macos">IntelliJ IDEA Classic (macOS)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_macos">Eclipse (macOS)</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_sublime_text">Sublime Text</option><option data-group="primary" value="primary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="primary" value="primary_xcode">Xcode</option><option data-group="primary" value="primary_resharper">ReSharper</option><option data-group="primary" value="primary_resharper_macos">ReSharper (macOS)</option><option data-group="secondary" value="secondary_default_for_windows">Default for Windows</option><option data-group="secondary" value="secondary_default_for_macos">Default for macOS</option><option data-group="secondary" value="secondary_intellij_idea_classic">IntelliJ IDEA Classic</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_macos">Eclipse (macOS)</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_sublime_text">Sublime Text</option><option data-group="secondary" value="secondary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="secondary" value="secondary_xcode">Xcode</option><option data-group="secondary" value="secondary_resharper">ReSharper</option><option data-group="secondary" value="secondary_resharper_macos">ReSharper (macOS)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Code_Coverage_CLion" id="Code_Coverage_CLion.xml">Code Coverage</h1>   <p id="e4cc789c">In CLion, you can run CMake applications and tests with code coverage measurements. Code coverage results provide the percentage of code lines executed during a run and the number of times a particular line was hit.</p>    <div class="chapter"><h2 id="compiler-plags" data-toc="Code_Coverage_CLion#compiler-plags">Compiler flags for code coverage</h2>        <p id="4c0a3c2a">CLion relies on <a href="https://llvm.org/docs/CommandGuide/llvm-cov.html" data-external="true" target="_blank" rel="noopener noreferrer">llvm-cov</a>/<a href="https://gcc.gnu.org/onlinedocs/gcc/Gcov.html#Gcov" data-external="true" target="_blank" rel="noopener noreferrer">gcov</a> integration to collect and show code coverage data for your code. These tools require that you provide special coverage compiler flags in your <span class="filepath">CMakeLists.txt</span> script. For this, you can use <code class="code">set(CMAKE_CXX_FLAGS "")</code> or other alternatives like the <a href="https://cmake.org/cmake/help/latest/command/add_compile_options.html" data-external="true" target="_blank" rel="noopener noreferrer">add_compile_options</a> command.</p>        <p id="031d17b4">See below the options for the flags depending on your compiler and the coverage tooling you prefer.</p>               <ul class="list _bullets"><li class="list__item" id="14215872">            <p id="094856b4"><span class="control">GCC</span></p>            <p id="50703897"><code class="code">-fprofile-arcs -ftest-coverage</code> or <code class="code">--coverage</code>            </p>            <p id="dc880562">In this case, the <span class="emphasis">gcov</span> tool will be used.</p>        </li><li class="list__item" id="2c963c68">            <p id="29245133"><span class="control">Clang</span></p>            <p id="d6eb1caa">You have two options here:</p>            <ul class="list _bullets"><li class="list__item" id="e2ee76a1"><p>Use the same flags as for GCC to get the gcov-style coverage collected with <a href="https://llvm.org/docs/CommandGuide/llvm-cov.html#llvm-cov-gcov" data-external="true" target="_blank" rel="noopener noreferrer">llvm-cov gcov</a>.</p></li><li class="list__item" id="36f70e1e"><p>Use <code class="code">-fprofile-instr-generate -fcoverage-mapping</code> to invoke the <a href="https://llvm.org/docs/CommandGuide/llvm-profdata.html" data-external="true" target="_blank" rel="noopener noreferrer">Clang’s instrumentation-based profiling</a> which uses a pair of the <code class="code">llvm-profdata merge</code> and <code class="code">llvm-cov export</code> commands.</p></li></ul>        </li></ul>        <aside data-type="note" class="prompt" data-title="" rel="b729d137" id="210394e1"><p>If you get linker errors while building your project with <span class="emphasis">gcov</span> compiler flags, try passing the same flags to the linker through <code class="code">add_link_options</code> or <code class="code">set(CMAKE_EXE_LINKER_FLAGS "")</code>.</p></aside>    </div>    <div class="chapter"><h2 id="run-coverage" data-toc="Code_Coverage_CLion#run-coverage">Running CMake applications or tests with coverage</h2>        <p id="93c9d2a1">After reloading your project with the added flags, you can use the <span class="control">Run with Coverage</span> action for your <a href="run-debug-configuration-application.html">CMake Application</a> and test configurations (<a href="run-debug-configuration-boost-test.html">Boost.Test</a>, <a href="run-debug-configuration-google-test.html">Google Test</a>, or <a href="run-debug-configuration-catch.html">Catch</a>).</p>        <p id="97ae1fa7"><span class="control">Run with Coverage</span> is available from the toolbar next to the configuration switcher and from the gutter menu:</p>        <p id="a5e8915b"><figure><img alt="Run with Coverage" title="Run with Coverage" src="/help/img/idea/2019.3/cl_coverage_configaction.png" id="05f4815a" width="519" height="158"></figure></p>        <p id="3aaabeb8"><figure><img alt="Run with Coverage" title="Run with Coverage" src="/help/img/idea/2019.3/cl_coverage_gutteraction.png" id="c3a7c562" width="519" height="324"></figure></p>    </div>    <div class="chapter"><h2 id="read-results" data-toc="Code_Coverage_CLion#read-results">Reading coverage results</h2>        <ul class="list _bullets"><li class="list__item" id="9fb7dc37"><p>            When coverage data is ready, the Coverage tool window opens up automatically. It shows the percentage of the files per folder and lines per file covered during the launch:            <figure><img alt="Coverage tool window" title="Coverage tool window" src="/help/img/idea/2019.3/cl_coverage_resultstoolwindow.png" id="cbfe005d" width="377" height="718"></figure>        </p></li><li class="list__item" id="fc743db3">            <p id="20c29948">In any file, you can check the gutter indicator and click it next to a particular line to learn how many times it was hit:            <figure><img alt="Coverage line hits" title="Coverage line hits" src="/help/img/idea/2019.3/cl_coverage_linehits.png" id="55e695a5" width="474" height="926"></figure></p>            <p id="769a6525">A line executed fully is marked green. Yellow marker means that it was only partically executed.</p>            <p id="7aab35e7">To modify the colors of coverage highlighting, click <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.settings@2x.png" width="16" alt="icons general settings"> or go to <span data-skip-index="skip" class="menupath">Settings / Preferences | Editor | Color Scheme | General</span> and expand the <span class="control">Line Coverage</span> node.</p>        </li><li class="list__item" id="58918796"><p>            CLion also shows coverage statistics in the Project view:            <figure><img alt="Code coverage results in Project view" title="Code coverage results in Project view" src="/help/img/idea/2019.3/cl_coverage_projectview.png" id="f15c8ba4" width="403" height="260"></figure>        </p></li></ul>    </div>    <div class="chapter"><h2 id="merge-results" data-toc="Code_Coverage_CLion#merge-results">Merging results from several runs</h2>        <p id="ea505564">When you rerun coverage analysis, CLion prompts you to choose how you prefer the new results to be presented:</p>        <figure><img alt="Merging several coverage suites" title="Merging several coverage suites" src="/help/img/idea/2019.3/cl_coverage_severalsuites.png" id="235e1f61" width="657" height="299"></figure>        <p id="f3622a20">            <span class="control">Add to active suites</span> – new results will be added to the previously collected statistics.        </p>        <p id="b36b094b">            <span class="control">Replace active suites</span> – the already collected data will be overwritten.        </p>        <p id="e572c6dc"><span class="control">Do not apply collected coverage data</span> – new results will be ignored.</p>    </div>    <div class="chapter"><h2 id="settings" data-toc="Code_Coverage_CLion#settings">Configure the coverage settings</h2>        <p id="bdc2a944">Code coverage settings are gathered in the <span data-skip-index="skip" class="menupath">Settings / Preferences | Build, Execution, Deployment | Coverage</span>:        <figure><img alt="Code coverage settings" title="Code coverage settings" src="/help/img/idea/2019.3/cl_coverage_settings.png" id="fff4d9ed" width="664" height="750"></figure>        </p>        <p id="cbd3ef2e">In the <span class="control">Tools</span> section, you can provide custom paths to <span class="emphasis">gcov</span> / <span class="emphasis">llvm-cov</span> / <span class="emphasis">llvm-profdata</span>. By default, CLion takes the paths from the <code class="code">PATH</code> environment varible.</p>        <p id="52628cad"><span class="control">Record branch coverage data</span>  - with this option enabled, the compiler-generated branches of code will be taken into account when collecting coverage data. It means that if a code line was expanded by the compiler into a block of several branches, some of which have not been executed (for example, in the case of handling an exception), that line will be marked as partially covered.</p>    </div>    <div class="chapter"><h2 id="troubleshoot-and-limits" data-toc="Code_Coverage_CLion#troubleshoot-and-limits">Troubleshooting and current limitations</h2>        <ul class="list _bullets"><li class="list__item" id="7f711561"><p>If you get empty coverage reports, check whether your <span class="control">compiler version matches the version of gcov / llvm-cov</span> tool (default or custom) that you are using. Keep this in mind when <a href="how-to-switch-compilers-in-clion.html">changing compilers</a> or switching from one <a href="quick-tutorial-on-configuring-clion-on-windows.html">Windows toolchain</a> to another.</p></li><li class="list__item" id="0e8a2ab8"><p>                Code coverage is not yet supported for the <a href="remote-projects-support.html">Remote toolchain</a> (<a href="https://youtrack.jetbrains.com/issue/CPP-17709" data-external="true" target="_blank" rel="noopener noreferrer">CPP-17709</a>).            </p></li></ul>    </div><div class="last-modified" data-skip-index="skip">Last modified: 1 December 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="cpu-profiler.html">Profiler</a><a class="navigation-links__next" href="deploying-applications.html">Deployment</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>