<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>OpenOCD Support - Help | CLion</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="OpenOCD_Support" data-breadcrumbs="Build, Run, Debug/Embedded Development/OpenOCD_Support.xml|OpenOCD Support" data-main-title="OpenOCD Support"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search CLion Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>CLion 2019.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default_for_windows" selected>Default for Windows</option><option data-group="primary" value="primary_default_for_macos">Default for macOS</option><option data-group="primary" value="primary_intellij_idea_classic_macos">IntelliJ IDEA Classic (macOS)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_macos">Eclipse (macOS)</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_sublime_text">Sublime Text</option><option data-group="primary" value="primary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="primary" value="primary_xcode">Xcode</option><option data-group="primary" value="primary_resharper">ReSharper</option><option data-group="primary" value="primary_resharper_macos">ReSharper (macOS)</option><option data-group="secondary" value="secondary_default_for_windows">Default for Windows</option><option data-group="secondary" value="secondary_default_for_macos">Default for macOS</option><option data-group="secondary" value="secondary_intellij_idea_classic">IntelliJ IDEA Classic</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_macos">Eclipse (macOS)</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_sublime_text">Sublime Text</option><option data-group="secondary" value="secondary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="secondary" value="secondary_xcode">Xcode</option><option data-group="secondary" value="secondary_resharper">ReSharper</option><option data-group="secondary" value="secondary_resharper_macos">ReSharper (macOS)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="OpenOCD_Support" id="OpenOCD_Support.xml">OpenOCD Support</h1>    <p id="3bccd874">For embedded targets that allow on-chip debug with <a href="http://openocd.org/" data-external="true" target="_blank" rel="noopener noreferrer">OpenOCD</a> (Open On-Chip Debugger), use the dedicated <span class="control">OpenOCD Download &amp; Run</span> configuration. This configuration works with <span class="control">CMake</span>-based projects, including the case of <a href="embedded-development.html">STM32CubeMX</a> format.</p>        <section class="procedure-steps"><h3 id="tools" data-toc="OpenOCD_Support#tools">Required tools</h3><div class="tabs" id="5b991c75"><div class="tabs__content" data-title="All platforms" id="0eaab1dc">                <ol class="list _decimal"><li class="list__item" id="1b22c7e2">                        <p id="731b8223"><a href="http://openocd.org/getting-openocd/" data-external="true" target="_blank" rel="noopener noreferrer">OpenOCD</a></p>                        <p id="96ac3804">OpenOCD will be used as a flash probe and remote <a href="https://sourceware.org/gdb/onlinedocs/gdb/Server.html" data-external="true" target="_blank" rel="noopener noreferrer">gdbserver</a>.</p>                        <p id="80ce4a25">In <span data-skip-index="skip" class="menupath">Settings/Preferences | Build, Execution, Deployment | Embedded Development</span>, you can check whether the OpenOCD location was detected correctly and set the path manually if needed.</p>                    </li><li class="list__item" id="7f985baf">                        <p id="2d8444b6"><span class="control">Toolchain</span></p>                        <p id="1826c3c8">The OpenOCD Download &amp; Run configuration requires the cross-compiler toolchain to be configured in advance.</p>                                <p id="11ac59d1">For ARM <a href="https://developer.arm.com/ip-products/processors/cortex-m" data-external="true" target="_blank" rel="noopener noreferrer">Cortex-M</a> and <a href="https://developer.arm.com/ip-products/processors/cortex-r" data-external="true" target="_blank" rel="noopener noreferrer">Cortex-R</a> MCUs, install <a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm" data-external="true" target="_blank" rel="noopener noreferrer">GNU ARM toolchain</a>.                                    After the installation, make sure the toolchain is presented in the system PATH: run <code class="code">arm-none-eabi-gcc</code> from the command line, and your system should recognize this command.</p>                                <p id="254a629c">For all other platforms, install the platform-specific toolchain and set up the tools in <span data-skip-index="skip" class="menupath">Settings/Preferences | Build, Execution, Deployment | Toolchain</span> or in your CMake script (take a look at the template <a href="https://github.com/elmot/clion-embedded-arm/blob/master/resources/xyz/elmot/clion/cubemx/tmpl_CMakeLists.txt" data-external="true" target="_blank" rel="noopener noreferrer">CMakeLists.txt</a>).</p>                        <p id="c8b4354c">Also, you need to provide the linker file:  obtain it from your chip vendor or create it manually, and specify through CMake settings.</p>                                <p id="ce46182f">If you are working with an <a href="embedded-development.html">STM32CubeMX project</a>, installing the <a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm" data-external="true" target="_blank" rel="noopener noreferrer">GNU ARM toolchain</a> is a part of the <a href="embedded-development.html#prepare-tools">project set up</a>, and CubeMX generates the linker file automatically.</p>                        <aside data-type="note" class="prompt" data-title="" rel="ce46182f" id="6883302e">                            <p id="c649c53f">OpenOCD Download &amp; Run configuration uses the <span class="control">default</span> toolchain's debugger. Check or change it in the <span class="control">Debugger</span> field of the default toolchain settings in <span data-skip-index="skip" class="menupath">Settings/Preferences | Build, Execution, Deployment | Toolchain</span>.                            </p>                            <p id="314013d1">On macOS, change the default debugger from <span class="control">LLDB</span> to <span class="control">Bundled GDB</span>                            or a custom one with the <span class="control">arm-none-eabi</span> or your platform-specific architecture supported.</p></aside>                     </li></ol>            </div><div class="tabs__content" data-title="Windows-specific" id="853a4787">                <ul class="list _ul"><li class="list__item" id="37ef6540"><p>In addition to the tools required for all platforms, install the <a href="https://www.st.com/content/st_com/en/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-utilities/stsw-link009.html#getsoftware-scroll" data-external="true" target="_blank" rel="noopener noreferrer">ST-LINK/V2 driver</a>.</p></li><li class="list__item" id="96f2aa98"><p>For <span class="control">GNU ARM Toolchain</span>, use version 2019-q3 or 2018-q2 (and earlier). See the <a href="https://bugs.launchpad.net/gcc-arm-embedded/+bug/1810274" data-external="true" target="_blank" rel="noopener noreferrer">issue</a> with 2018-q4.</p></li><li class="list__item" id="b58ed243"><p>Only the <span class="control">MinGW</span> and <span class="control">MinGW-w64</span> environments are supported (<a href="https://youtrack.jetbrains.com/issue/CPP-15034" data-external="true" target="_blank" rel="noopener noreferrer">CPP-15034</a>).</p></li></ul>            </div></div></section>        <section class="procedure-steps"><h3 id="opecocd-debug" data-toc="OpenOCD_Support#opecocd-debug">Create an OpenOCD Download & Run configuration</h3><ol class="list _decimal"><li class="list__item" id="4a670fc5">            <p id="73b60a5c">Go to <span data-skip-index="skip" class="menupath">Run | Edit Configurations</span>, click <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.add@2x.png" width="16" alt="icons general add"> and select <span class="control">OpenOCD Download &amp; Run</span>.</p>            <p id="856f97bd">For STM32CubeMX projects, a configuration of this type is added automatically during the project creation.</p>        </li><li class="list__item" id="e2c12848"><p>In the settings, you can choose the board config file, adjust GDB and Telnet ports, and set up Download/Reset options.            <figure><img alt="openocd run-debug configuration" title="openocd run-debug configuration" src="/help/img/idea/2019.3/cl_embed_openocdconfig.png" id="ac697059" width="700" height="813"></figure></p></li><li class="list__item" id="23ebf9d1">            <p id="a86bf5b0">When setting up the board config file, you can provide the path manually or click <span class="control">Assist</span> and choose from the standard options:                <figure><img alt="board configs selection dialog" title="board configs selection dialog" src="/help/img/idea/2019.3/cl_embed_bardconfigs.png" id="848b5920" width="387" height="509"></figure>            </p>            <p id="1ba95d7d">To adjust the board config file to your needs (for example, when you are working with a non-standard                device or need to keep several config files), click <span class="control">Copy to Project &amp; Use</span>: the                selected file will be copied into your project tree, and you'll be able to open it in the editor and                modify as required.            </p>        </li></ol></section>    <section class="procedure-steps"><h3 id="run-debug" data-toc="OpenOCD_Support#run-debug">Run/debug an OpenOCD Download & Run configuration</h3><ul class="list _bullets"><li class="list__item" id="45bb2e89"><p> When you <span class="control">Run</span><img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.execute@2x.png" width="16" alt="icons actions execute"> this configuration, the compiled firmware is downloaded to the target board, and then the chip is reset. </p></li><li class="list__item" id="9524ec21"><p id="793aeda2">When you <span class="control">Debug</span><img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.startDebugger@2x.png" width="16" alt="icons actions startDebugger">, the firmware is downloaded, the chip is reset, and then the remote debugger is attached to the MCU.</p>                <p id="1f500e2a">                    You can now use all the CLion debugging features for your firmware running on-chip. For example, the following screenshot shows how to randomly light a LED on an STM32L073 Nucleo-64 board:                    <figure><img alt="debug the embedded project" title="debug the embedded project" src="/help/img/idea/2019.3/cl_embed_debug.png" id="4ff5445a" width="850" height="1072"></figure>                </p>                <p id="53f72fb3">Notice the <img class="inline-icon-16" src="/help/img/idea/2019.3/clion-embedded.icons.ResetMcu@2x.png" width="16" alt="MCU reset"> button on the left-hand bar of the Debugger tool window. When pressed, it sends the <a href="http://openocd.org/doc/html/General-Commands.html" data-external="true" target="_blank" rel="noopener noreferrer">chip reset command</a> selected in the <span class="control">Reset</span> option of the configuration settings.</p>            </li></ul></section><div class="last-modified" data-skip-index="skip">Last modified: 1 December 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="embedded-development.html">STM32CubeMX Projects</a><a class="navigation-links__next" href="embedded-gdb-server.html">Embedded GDB Server</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>