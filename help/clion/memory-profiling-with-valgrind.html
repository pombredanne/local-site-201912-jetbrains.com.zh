<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Valgrind Memcheck - Help | CLion</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Memory_Profiling_with_Valgrind" data-breadcrumbs="Profiling_Tools.xml|Dynamic Code Analysis/Memory_Profiling_with_Valgrind.xml|Valgrind Memcheck" data-main-title="Valgrind Memcheck"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search CLion Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>CLion 2019.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default_for_windows" selected>Default for Windows</option><option data-group="primary" value="primary_default_for_macos">Default for macOS</option><option data-group="primary" value="primary_intellij_idea_classic_macos">IntelliJ IDEA Classic (macOS)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_macos">Eclipse (macOS)</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_sublime_text">Sublime Text</option><option data-group="primary" value="primary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="primary" value="primary_xcode">Xcode</option><option data-group="primary" value="primary_resharper">ReSharper</option><option data-group="primary" value="primary_resharper_macos">ReSharper (macOS)</option><option data-group="secondary" value="secondary_default_for_windows">Default for Windows</option><option data-group="secondary" value="secondary_default_for_macos">Default for macOS</option><option data-group="secondary" value="secondary_intellij_idea_classic">IntelliJ IDEA Classic</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_macos">Eclipse (macOS)</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_sublime_text">Sublime Text</option><option data-group="secondary" value="secondary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="secondary" value="secondary_xcode">Xcode</option><option data-group="secondary" value="secondary_resharper">ReSharper</option><option data-group="secondary" value="secondary_resharper_macos">ReSharper (macOS)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 data-toc="Memory_Profiling_with_Valgrind" id="Memory_Profiling_with_Valgrind.xml">Valgrind Memcheck</h1>            <p id="f63fa08d">               <a href="http://valgrind.org/docs/manual/mc-manual.html" data-external="true" target="_blank" rel="noopener noreferrer">Valgrind Memcheck</a> is a tool that                helps identify memory errors in C and C++ code. It can detect                various problems such as memory leaks, invalid memory access, incorrect                freeing of memory, and using undefined values.                </p>            <p id="1cbe6a3b">                Valgrind Memcheck in CLion works on multiple platforms: Linux, macOS, and Windows via <a href="how-to-use-wsl-development-environment-in-clion.html">WSL</a> (see <a href="#valgrind-wsl">Valgrind on WSL</a>).            </p>            <section class="procedure-steps"><h3 id="start" data-toc="Memory_Profiling_with_Valgrind#start">Configure Valgrind</h3><ol class="list _decimal"><li class="list__item" id="4153d017">                    <p id="5671f86b">                        <a href="http://valgrind.org/downloads/?src=www.discoversdk.com" data-external="true" target="_blank" rel="noopener noreferrer">Install</a> Valgrind on your system. After the successful installation, CLion automatically detects                    the Valgrind binary by searching in standard locations defined in the system <code class="code">PATH</code> variable.                    </p>                    <p id="910a8592"> For WSL, you need to install Valgrind on your WSL instance (<code class="code">sudo apt-get install valgrind</code>)                        and provide CLion with the path to the executable (see the next step).</p>                    <p id="caad87af">                    In case of non-standard location of Valgrind, you can point CLion to it explicitly:                    go to <span data-skip-index="skip" class="menupath">Settings / Preferences | Build, Execution, Deployment | Dynamic Analysis Tools | Valgrind</span>                    and specify the path in the <span class="control">Valgrind executable</span> field.</p>                </li><li class="list__item" id="a1789ad6"><p>                    In the same dialog, specify the required                    <a href="http://valgrind.org/docs/manual/mc-manual.html#mc-manual.options" data-external="true" target="_blank" rel="noopener noreferrer">analysis options</a>.                </p></li><li class="list__item" id="6dfbf89d"><p>                    Optionally, configure the list of the                    <a href="http://valgrind.org/docs/manual/manual-core.html#manual-core.suppress" data-external="true" target="_blank" rel="noopener noreferrer">suppression files</a>. For example, you may want to add a non-default suppression file to turn off                    the Valgrind Memcheck checks for some particular libraries. The typical case here,                    for example, would be to suppress OpenSSL or Boost.                </p></li></ol><figure><img alt="Valgrind settings" title="Valgrind settings" src="/help/img/idea/2019.3/cl_valgrindSettings.png" id="b113a8b0" width="850" height="803"></figure></section>    <section class="procedure-steps"><div class="collapse"><div class="collapse__title"><h3 id="valgrind-wsl" data-toc="Memory_Profiling_with_Valgrind#valgrind-wsl">Configure Valgrind on WSL</h3></div><div class="collapse__content"><p id="5f837e2d">To use Valgrind on Windows via WSL, provide the 'subsystem' path to Valgrind, which is <span class="filepath">/usr/bin/valgrind</span> by default, instead of the actual Windows location of the Valgrind binary. However, this path will not be valid until you select the CMake profile connected to the WSL toolchain. For this, do one of the following:</p><ul class="list "><li class="list__item" id="293ceb0a"><p>            Set the WSL toolchain as default. This way, it will automatically connect to the default CMake profile:            <figure><img alt="cl wsl deftoolchain" title="cl wsl deftoolchain" src="/help/img/idea/2019.3/cl_wsl_deftoolchain.png" id="e4751316" width="152" height="281"></figure>        </p></li><li class="list__item" id="f4bbf1df"><p>Create a separate CMake profile, connect it to the WSL toolchain, and select this profile in the configurations switcher:        <figure><img alt="cmake profile for wsl toolchain" title="cmake profile for wsl toolchain" src="/help/img/idea/2019.3/cl_wsl_cmakeprofile.png" id="6b1ffc56" width="850" height="609"></figure>        </p></li></ul></div></div></section>    <section class="procedure-steps"><h3 id="run-target" data-toc="Memory_Profiling_with_Valgrind#run-target">Run targets</h3><p id="722fa762">To run a target (application or test) with Valgrind Memcheck, select the            desired <a href="run-debug-configuration.html">Run/Debug</a> configuration, and then do one of the following:</p><ul class="list "><li class="list__item" id="0468979c"><p>            On the main menu, choose <span data-skip-index="skip" class="menupath">Run | Run 'your_target_name' with Valgrind Memcheck</span> option.        </p></li><li class="list__item" id="b83296d0"><p>            Click the dedicated icon in the Navigation bar:            <figure><img alt="cl Valgrind Run icon" title="cl Valgrind Run icon" src="/help/img/idea/2019.3/cl_Valgrind_Run_icon.png" id="0035ec19" width="390" height="99"></figure>        </p></li><li class="list__item" id="d9ac4088"><p>            Click the <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.actions.execute@2x.png" width="16" alt="icons actions execute"> gutter icon and select            <span class="control">Run 'your_target_name' with Valgrind Memcheck</span> option from the menu:            <figure><img alt="cl runValgrindGutter" title="cl runValgrindGutter" src="/help/img/idea/2019.3/cl_runValgrindGutter.png" id="7f920a2e" width="370" height="196"></figure>        </p></li></ul></section>    <section class="procedure-steps"><h3 id="explore-results" data-toc="Memory_Profiling_with_Valgrind#explore-results">Explore results</h3><ul class="list "><li class="list__item" id="0294f21d"><p>            The left-hand pane of the <span class="control">Valgrind</span> tab in the <a href="run-tool-window.html">Run tool window</a>            represents information of all problems found by Valgrind Memcheck.            Each stack-frame shows the instruction pointer, problematic function name, and (if possible) the source file            where the problem is located:            <figure><img alt="Valgrind Memcheck output" title="Valgrind Memcheck output" src="/help/img/idea/2019.3/cl_valgrind_outputnew.png" id="ab4f6f6c" width="900" height="1046"></figure>        </p></li><li class="list__item" id="0e1cb3fb"><p>            Select a stack-trace of interest. In the right-hand pane, you can view the full stack frame description            of a target stack-trace and the corresponding code preview (when possible).            Press <kbd data-primary_default_for_windows="F4" data-primary_default_for_macos="⌘+Down" data-primary_intellij_idea_classic_macos="F4" data-primary_emacs="F4" data-primary_visual_studio="F4" data-primary_default_for_xwin="F4" data-primary_default_for_gnome="F4" data-primary_default_for_kde="F4" data-primary_eclipse="F12" data-primary_eclipse_macos="F3" data-primary_netbeans="F4" data-primary_sublime_text="F4" data-primary_sublime_text_macos="N/A" data-primary_xcode="⌘+Down" data-primary_resharper="F4" data-primary_resharper_macos="F4" data-secondary_default_for_windows="F4" data-secondary_default_for_macos="⌘↓" data-secondary_intellij_idea_classic="F4" data-secondary_emacs="F4" data-secondary_visual_studio="F4" data-secondary_default_for_xwin="F4" data-secondary_default_for_gnome="F4" data-secondary_default_for_kde="F4" data-secondary_eclipse="F12" data-secondary_eclipse_macos="F3" data-secondary_netbeans="F4" data-secondary_sublime_text="F4" data-secondary_sublime_text_macos="N/A" data-secondary_xcode="⌘↓" data-secondary_resharper="F4" data-secondary_resharper_macos="F4">F4</kbd> to jump back to the source code.        </p></li><li class="list__item" id="59808445"><p>            Right-click the selected item to exclude it from the current results log or suppress the problematic function            by adding a corresponding record to the suppression file.        </p></li></ul></section>        <section class="procedure-steps"><h3 id="export-import" data-toc="Memory_Profiling_with_Valgrind#export-import">Export and import results</h3><ul class="list "><li class="list__item" id="74659c9a"><p>                To export the results, click the <span class="control">Export</span> <img alt="cl valgrindexport b" title="cl valgrindexport b" src="/help/img/idea/2019.3/cl_valgrindexport_b.png" id="d49735db" width="16" height="32" class="inline-icon-16">                icon in the left pane of the <span class="control">Valgrind</span> tab and specify the destination XML file:                <figure><img alt="Export Valgrind results" title="Export Valgrind results" src="/help/img/idea/2019.3/cl_valgrind_export.png" id="44dd463b" width="600" height="1035"></figure>                <span class="control">Note</span> that the Export button is unavailable during execution.            </p></li><li class="list__item" id="7f07be4c"><p>                To import the results, select <span data-skip-index="skip" class="menupath">Run | Import Valgrind XML Results</span> from the main menu and choose the XML file to import from.            </p></li></ul></section><div class="last-modified" data-skip-index="skip">Last modified: 1 December 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="google-sanitizers.html">Google Sanitizers</a><a class="navigation-links__next" href="cpu-profiler.html">Profiler</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>