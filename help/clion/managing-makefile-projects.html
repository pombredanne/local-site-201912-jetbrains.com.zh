<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Managing Makefile Projects - Help | CLion</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Managing_Makefile_projects" data-breadcrumbs="Configure Projects/Project_Models.xml|Project Formats/Managing_Makefile_projects.xml|Managing Makefile Projects" data-main-title="Managing Makefile Projects"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search CLion Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>CLion 2019.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default_for_windows" selected>Default for Windows</option><option data-group="primary" value="primary_default_for_macos">Default for macOS</option><option data-group="primary" value="primary_intellij_idea_classic_macos">IntelliJ IDEA Classic (macOS)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_macos">Eclipse (macOS)</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_sublime_text">Sublime Text</option><option data-group="primary" value="primary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="primary" value="primary_xcode">Xcode</option><option data-group="primary" value="primary_resharper">ReSharper</option><option data-group="primary" value="primary_resharper_macos">ReSharper (macOS)</option><option data-group="secondary" value="secondary_default_for_windows">Default for Windows</option><option data-group="secondary" value="secondary_default_for_macos">Default for macOS</option><option data-group="secondary" value="secondary_intellij_idea_classic">IntelliJ IDEA Classic</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_macos">Eclipse (macOS)</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_sublime_text">Sublime Text</option><option data-group="secondary" value="secondary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="secondary" value="secondary_xcode">Xcode</option><option data-group="secondary" value="secondary_resharper">ReSharper</option><option data-group="secondary" value="secondary_resharper_macos">ReSharper (macOS)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Managing_Makefile_projects" id="Managing_Makefile_projects.xml">Managing Makefile Projects</h1>    <p id="ExampleIntro">Although currently Makefiles are not supported as a project format in CLion, you can use the following workaround to manage Makefile projects with the help of <a href="using-file-watchers.html">File Watchers</a> and <a href="compilation-database.html">compilation database</a>.</p>    <p id="b2264ae6">        The example below shows how to construct a meta build system that monitors changes in Makefiles, then regenerates and reloads the compilation database accordingly. This way, it lets you manage a Makefile project to a full extent from within CLion. Moreover, you can build and run/debug such projects with the help of <a href="custom-build-targets.html">custom build targets</a> and <a href="custom-build-targets.html#custom-rundebug">custom Run/Debug configurations</a>.    </p>    <p>        Suppose we have a simple Makefile project consisting of three modules, <span class="filepath">general</span>, <span class="filepath">io_lib</span>,        and <span class="filepath">math_lib</span>, each stored in a        separate directory that contains a Makefile, and in the root directory, the main Makefile that builds all the targets:        <div class="code-block" data-lang="makefile">
TARGETS = Math Io General
all: $(TARGETS)
Math:
    @$(MAKE) -C math_lib    -f Makefile
Io:
    @$(MAKE) -C io_lib      -f Makefile
General:
    @$(MAKE) -C general     -f Makefile
clean:
    @$(MAKE) -C io_lib      -f Makefile clean
    @$(MAKE) -C math_lib    -f Makefile clean
    @$(MAKE) -C general     -f Makefile clean
        </div>        </p><p id="e79544be">        Now let's take the following steps:</p>    <section class="procedure-steps"><h3 id="create-compdb" data-toc="Managing_Makefile_projects#create-compdb">1. Create a compilation database</h3><ul class="list "><li class="list__item" id="98d52a91"><p>            First of all, we need to create a JSON compilation database for our test project.            The tool we'll use for this is <a href="https://github.com/nickdiego/compiledb-generator" data-external="true" target="_blank" rel="noopener noreferrer">compiledb-generator</a>.            Having installed the tool, we can run <code class="code">compiledb make</code> from the project root            and get the <span class="filepath">compile_commands.json</span> file:            <figure><img alt="cl filewatcher compiledb output" title="cl filewatcher compiledb output" src="/help/img/idea/2019.3/cl_filewatcher_compiledb_output.png" id="19c869c8" width="508" height="88"></figure>        </p></li></ul></section>    <section class="procedure-steps"><h3 id="makefile-plugin" data-toc="Managing_Makefile_projects#makefile-plugin">2. Install the Makefile Support plugin</h3><ul class="list "><li class="list__item" id="3a19ecf5">            <p id="a307082c">                This is an optional step, yet quite helpful for our task: with the <a href="https://plugins.jetbrains.com/plugin/9333-makefile-support" data-external="true" target="_blank" rel="noopener noreferrer">Makefile Support</a> plugin                <a href="managing-plugins.html#repos">installed</a>,                the <span class="control">GNU Makefile</span> file type becomes recognizable in CLion, and we                get the syntax highlighting and editing features for the Makefiles.            </p>        </li></ul></section>    <section class="procedure-steps"><h3 id="compdb" data-toc="Managing_Makefile_projects#compdb">3. Open and configure the compilation database in CLion</h3><ul class="list "><li class="list__item" id="11fc2e91">            <p id="99233eca">The next step is to <a href="compilation-database.html#compdb_load">open the compilation database</a> that we created in step 1 as a project in CLion.            After the import has finished successfully, we can start working with the project files.            <figure><img alt="cl filewatcher compdb" title="cl filewatcher compdb" src="/help/img/idea/2019.3/cl_filewatcher_compdb.png" id="bdecf88f" width="706" height="1230"></figure>            </p>            <p id="d0c8a40d">            To have the project automatically reloaded upon every change in <span class="filepath">compile_command.json</span>, we need to set the <span class="control">Use auto-import</span> checkbox in            <span data-skip-index="skip" class="menupath">Settings / Preferences | Build, Execution, Deployment | Compilation Database</span>:            <figure><img alt="cl filewatcher compdb autoimport" title="cl filewatcher compdb autoimport" src="/help/img/idea/2019.3/cl_filewatcher_compdb_autoimport.png" id="4c4cb1cf" width="634" height="673"></figure>            </p>        </li></ul></section>    <section class="procedure-steps"><h3 id="filewatcher-plugin" data-toc="Managing_Makefile_projects#filewatcher-plugin">4. Install the File Watchers plugin</h3><p id="9eeb3561">Go to <span data-skip-index="skip" class="menupath">Settings / Preferences | Plugins</span>, switch to <span class="control">Marketplace</span>, search for <span class="emphasis">File Watchers</span>, and install the plugin.</p></section>    <section class="procedure-steps"><h3 id="filewatcher" data-toc="Managing_Makefile_projects#filewatcher">5. Create a File Watcher for the Makefiles</h3><ul class="list "><li class="list__item" id="860f0b69">            <p id="6b102cac">Now we can create a File Watcher to follow up the changes in the Makefiles. Let's navigate to <span data-skip-index="skip" class="menupath">Settings / Preferences | Tools | File Watchers</span>, create a new File Watcher and assign it to all the files of <span class="control">GNU Makefile</span> type located            in the project root and subdirectories (note the <code class="code">$ProjectFileDir$</code> macro):                <figure><img alt="cl filewatcher makefile" title="cl filewatcher makefile" src="/help/img/idea/2019.3/cl_filewatcher_makefile.png" id="7a1d2476" width="687" height="1260"></figure></p>        </li></ul></section>    <section class="procedure-steps"><h3 id="change-makefiles" data-toc="Managing_Makefile_projects#change-makefiles">6. Modify the Makefiles</h3><ul class="list "><li class="list__item" id="dc450e69">            <p id="d3162d6d">                Now, let's change something in our Makefiles. We can do this outside the IDE (since                the <span class="control">Trigger the watcher on external changes</span> checkbox is set), or right from the CLion editor.            </p>            <p id="3e2b9f8f">                For example, we can add a new source file to the <span class="filepath">math_lib</span> module                and put it to the list of sources in the corresponding Makefile:                <figure><img alt="cl filewatchers makefilechange example1" title="cl filewatchers makefilechange example1" src="/help/img/idea/2019.3/cl_filewatchers_makefilechange_example1.png" id="32b8b86b" width="698" height="514"></figure>            </p>            <p id="0113f090">                Right after that change, the <span class="control">Makefile_watcher</span> is triggered to run                <code class="code">compiledb -n make</code>.                This command regenerates the compilation database without performing the actual build,                and CLion automatically reloads it so the project gets synchronized with the modified Makefile.            </p>            <p id="b9430765">                Now there are four entries in <span class="filepath">compile_commands.json</span>:                <figure><img alt="cl filewatchers makefilechange example1result" title="cl filewatchers makefilechange example1result" src="/help/img/idea/2019.3/cl_filewatchers_makefilechange_example1result.png" id="5ee0235d" width="582" height="310"></figure>            </p>            <p id="05d261a2">Similarly, if we then decide not to include the                <span class="filepath">io_funcs</span> library into the build, we can remove the <code class="code">Io</code> target from the main Makefile:                <div class="code-block" data-lang="makefile">
                    TARGETS = Math General
                </div>                In response to this change, the <span class="control">Makefile_watcher</span> triggers again, and the compilation database gets reloaded accordingly:                <figure><img alt="cl filewatchers makefilechange example2result" title="cl filewatchers makefilechange example2result" src="/help/img/idea/2019.3/cl_filewatchers_makefilechange_example2result.png" id="d414f407" width="525" height="867"></figure>            </p>        </li></ul></section>    <section class="procedure-steps"><h3 id="global-filewatcher" data-toc="Managing_Makefile_projects#global-filewatcher">7. Make the File Watcher global</h3><ul class="list "><li class="list__item" id="c0140e5b"><p>            The final thing that we might want to do is make the <span class="control">Makefile_watcher</span> global. With this setting enabled, the watcher            becomes available across all projects so we'll easily reuse it for other Makefile applications that we manage in CLion:            <figure><img alt="cl filewatcher global" title="cl filewatcher global" src="/help/img/idea/2019.3/cl_filewatcher_global.png" id="e40450c7" width="614" height="747"></figure>        </p></li></ul></section>    <p id="ending">This way, the combination of a File Watcher and a compilation database creates a mechanism to work with        Make-based projects without leaving CLion to edit the Makefiles or recreate the compilation database manually.        Moreover, you can apply this approach to <span class="control">any build system</span> that has complementary tools for generating compilation databases.</p>    <p id="f32e2da2">        <span class="control"><span class="emphasis">Note</span></span> that currently, in this scheme, CLion reloads the entire compilation database for each change in the Makefile that triggers the File Watcher.        Due to that, you may experience performance problems when applying this workflow to large code bases.    </p><div class="last-modified" data-skip-index="skip">Last modified: 1 December 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="gradle-support.html">Gradle</a><a class="navigation-links__next" href="opening-reopening-and-closing-projects.html">Open and Reopen Projects</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>