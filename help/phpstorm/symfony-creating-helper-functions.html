<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Creating Helper Functions - Help | PhpStorm</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Symfony_creating_helper_functions" data-breadcrumbs="PHP frameworks and external tools/Symfony_support.xml|Symfony/Symfony_creating_helper_functions.xml|Creating Helper Functions" data-main-title="Creating Helper Functions"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search PhpStorm Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>PhpStorm 2019.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default_for_windows" selected>Default for Windows</option><option data-group="primary" value="primary_default_for_macos">Default for macOS</option><option data-group="primary" value="primary_intellij_idea_classic_macos">IntelliJ IDEA Classic (macOS)</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_visual_studio">Visual Studio</option><option data-group="primary" value="primary_default_for_xwin">Default for XWin</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_eclipse_macos">Eclipse (macOS)</option><option data-group="primary" value="primary_netbeans">NetBeans</option><option data-group="primary" value="primary_sublime_text">Sublime Text</option><option data-group="primary" value="primary_sublime_text_macos">Sublime Text (macOS)</option><option data-group="secondary" value="secondary_default_for_windows">Default for Windows</option><option data-group="secondary" value="secondary_default_for_macos">Default for macOS</option><option data-group="secondary" value="secondary_intellij_idea_classic">IntelliJ IDEA Classic</option><option data-group="secondary" value="secondary_emacs">Emacs</option><option data-group="secondary" value="secondary_visual_studio">Visual Studio</option><option data-group="secondary" value="secondary_default_for_xwin">Default for XWin</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_eclipse_macos">Eclipse (macOS)</option><option data-group="secondary" value="secondary_netbeans">NetBeans</option><option data-group="secondary" value="secondary_sublime_text">Sublime Text</option><option data-group="secondary" value="secondary_sublime_text_macos">Sublime Text (macOS)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 data-toc="Symfony_creating_helper_functions" id="Symfony_creating_helper_functions.xml">Creating Helper Functions</h1>    <p id="9e1fd63a">        The Symfony Plugin provides parameter types and return types inference based on their usage with Symfony classes and functions. This lets you create your own helper functions that take or return <a href="symfony-templates.html">a template</a>, <a href="symfony-service-container.html">a service</a>, <a href="symfony-doctrine.html">an entity</a>, <a href="symfony-translations.html">a translation</a>, <a href="symfony-routes.html">a route</a>, <a href="symfony-forms.html">a form</a>, or <a href="symfony-events.html">an event</a>.    </p>    <p id="c4fb4e1f">        As an example, let's create a <code class="code">redirectToRoute</code> function that can be used in controllers. This function will combine the <code class="code">Controller</code> class' <code class="code">redirect</code> and <code class="code">generateUrl</code> function, so that you can easily redirect users to a known route within our application. The code will look as follows:    </p>    <div class="code-block" data-lang="php">
        protected function redirectToRoute($route) {
            return $this-&gt;redirect($this-&gt;generateUrl($route));
        }
    </div>    <p id="34bf93f9">        When we call this function, we will get code completion <kbd data-primary_default_for_windows="Ctrl+Space" data-primary_default_for_macos="Ctrl+Space" data-primary_intellij_idea_classic_macos="Ctrl+Space" data-primary_emacs="Alt+/" data-primary_visual_studio="Ctrl+Space" data-primary_default_for_xwin="Ctrl+Space" data-primary_default_for_gnome="Ctrl+Space" data-primary_default_for_kde="Ctrl+Space" data-primary_eclipse="Ctrl+Space" data-primary_eclipse_macos="Ctrl+Space" data-primary_netbeans="Ctrl+Space" data-primary_sublime_text="Ctrl+Space" data-primary_sublime_text_macos="Ctrl+Space" data-secondary_default_for_windows="⌃Space" data-secondary_default_for_macos="⌃Space" data-secondary_intellij_idea_classic="⌃Space" data-secondary_emacs="⌥/" data-secondary_visual_studio="⌃Space" data-secondary_default_for_xwin="⌃Space" data-secondary_default_for_gnome="⌃Space" data-secondary_default_for_kde="⌃Space" data-secondary_eclipse="⌃Space" data-secondary_eclipse_macos="⌃Space" data-secondary_netbeans="⌃Space" data-secondary_sublime_text="⌃Space" data-secondary_sublime_text_macos="⌃Space">Ctrl+Space</kbd> for the <code class="code">$route</code> and, as well as the ability to navigate to the corresponding declaration <kbd data-primary_default_for_windows="Ctrl+B" data-primary_default_for_macos="⌘+B" data-primary_intellij_idea_classic_macos="⌘+B" data-primary_emacs="Ctrl+Alt+G" data-primary_visual_studio="F12" data-primary_default_for_xwin="Ctrl+B" data-primary_default_for_gnome="Ctrl+B" data-primary_default_for_kde="Ctrl+B" data-primary_eclipse="F3" data-primary_eclipse_macos="F3" data-primary_netbeans="Ctrl+B" data-primary_sublime_text="F12" data-primary_sublime_text_macos="F12" data-secondary_default_for_windows="⌃B" data-secondary_default_for_macos="⌘B" data-secondary_intellij_idea_classic="⌘B" data-secondary_emacs="⌃⌥G" data-secondary_visual_studio="F12" data-secondary_default_for_xwin="⌃B" data-secondary_default_for_gnome="⌃B" data-secondary_default_for_kde="⌃B" data-secondary_eclipse="F3" data-secondary_eclipse_macos="F3" data-secondary_netbeans="⌃B" data-secondary_sublime_text="F12" data-secondary_sublime_text_macos="F12">Ctrl+B</kbd>.    </p>    <figure><img alt="Symfony route name completion in a helper function" title="Symfony route name completion in a helper function" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_route_completion.png" id="a8e10d27" width="811" height="656"></figure>    <p id="69abed85">        Code completion and navigation for the returned <code class="code">$response</code> instance are available, too.    </p>    <figure><img alt="Symfony response name completion in a helper function" title="Symfony response name completion in a helper function" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_response_completion.png" id="d8dbf448" width="581" height="228"></figure>    <p id="ffac2ac2">        The reason both of these work is that the Symfony Plugin infers the <code class="code">$route</code>'s type by analyzing calls and return types for known functions. This type analysis works for most Symfony components (template, service, entity, translation, route, form, or event), but there are cases where it will not work as-is.    </p>    <p id="66541a9f">        Whenever completion and navigation for helper functions that we create ourselves or utilize from a third-party library do not seem to work, the Symfony Plugin comes with a solution: it provides access to some of its internals through the <a href="#method-parameter">Method Parameter</a> and <a href="#signature-types">Signature Types</a> project settings.    </p>    <div class="chapter"><h2 id="method-parameter" data-toc="Symfony_creating_helper_functions#method-parameter">Method Parameter</h2>        <p id="1fd2f027">            Consider the following function, which doesn't use any Symfony-specific functions:        </p>            <div class="code-block" data-lang="php">
            /**
            * Translate route
            *
            * @param $route string Route to translate the URL for
            * @param $locale string Locale to translate into
            */
            protected function translateRoute($route, $locale) {
                // ...
            }
            </div>        <p id="6ce0f06c">            The Symfony Plugin in this case will not be able to figure out that the <code class="code">$route</code> string parameter should hold a route name and provide completion and navigation for it. We can fix this by using any of the following techniques:        </p>        <ul class="list _ul"><li class="list__item" id="c225b28a"><a href="#method-references">Method References</a>            </li><li class="list__item" id="dff6b5ec"><a href="#hashes">Hashes</a>            </li></ul>        <div class="chapter"><h3 id="method-references">Method references</h3>            <p id="ec56ca9f">                To tell the Symfony Plugin about our method, <a name="open_settings"></a>                in the        <a name="settings_dialog"></a>        <span class="control">Settings/Preferences</span> dialog <kbd data-primary_default_for_windows="Ctrl+Alt+S" data-primary_default_for_macos="⌘+Comma" data-primary_intellij_idea_classic_macos="⌘+Comma" data-primary_emacs="Ctrl+Alt+S" data-primary_visual_studio="Alt+F7" data-primary_default_for_xwin="Ctrl+Alt+S" data-primary_default_for_gnome="Ctrl+Alt+S" data-primary_default_for_kde="Ctrl+Alt+S" data-primary_eclipse="Ctrl+Alt+S" data-primary_eclipse_macos="⌘+Comma" data-primary_netbeans="Ctrl+Alt+S" data-primary_sublime_text="Ctrl+Alt+S" data-primary_sublime_text_macos="⌘+Comma" data-secondary_default_for_windows="⌃⌥S" data-secondary_default_for_macos="⌘," data-secondary_intellij_idea_classic="⌘," data-secondary_emacs="⌃⌥S" data-secondary_visual_studio="⌥F7" data-secondary_default_for_xwin="⌃⌥S" data-secondary_default_for_gnome="⌃⌥S" data-secondary_default_for_kde="⌃⌥S" data-secondary_eclipse="⌃⌥S" data-secondary_eclipse_macos="⌘," data-secondary_netbeans="⌃⌥S" data-secondary_sublime_text="⌃⌥S" data-secondary_sublime_text_macos="⌘,">Ctrl+Alt+S</kbd>, navigate to <span data-skip-index="skip" class="menupath">Languages &amp; Frameworks | PHP |                Symfony | Method References</span>. Then, click <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.add@2x.png" width="16" alt="the Add button">                to add a new method parameter registration.            </p>            <figure><img alt="Symfony MethodParameterSetting dialog" title="Symfony MethodParameterSetting dialog" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_method_parameter_setting.png" id="ceb43002" width="500" height="526"></figure>            <p id="6769bba9">                Provide the following:            </p>            <ul class="list _ul"><li class="list__item" id="60fbceda"><p>                    <span class="control">CallTo</span>: The FQN of the class (with leading <code class="code">\</code>) that contains the function.                </p></li><li class="list__item" id="456c0ea0"><p>                    <span class="control">Method</span>: The function name.                </p></li><li class="list__item" id="7e8ece36"><p>                    <span class="control">Index</span>: The index of the parameter that we want to have completion and navigation for.                </p></li><li class="list__item" id="28459e2a"><p>                    <span class="control">Provider</span>: The provider of potential data. This is where we choose the Symfony component we want to accept for our function parameter.                </p></li><li class="list__item" id="2fdaf1d0"><p>                    <span class="control">Contributor</span>: (optional) If our function parameter is an array, and we want completion in the array key or value, we can specify that using these options.                </p></li><li class="list__item" id="7cb60c58"><p>                    <span class="control">ContributorData</span>: (optional) In case we want array value completion, here we can enter the key for which to provide completion and navigation.                </p></li></ul>            Once we apply changes, full completion and navigation support for our helper function's parameters will be available. Since this is a project-level setting, you can <a href="configuring-project-and-ide-settings.html">share it with your team</a>.            <figure><img alt="Symfony method parameter completion in a helper function" title="Symfony method parameter completion in a helper function" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_method_parameter_completion.png" id="85747a22" width="800" height="650"></figure>            <p id="bc7b55aa">                While this technique is powerful, using <a href="#hashes">hints with hashes</a> is probably easier to work with in most situations and does not require sharing your project settings with team members.            </p>        </div>        <div class="chapter"><h3 id="hashes">Hashes</h3>            <p id="7476c17b">                Instead of configuring method parameters in the settings, we can use hinting, similarly to the way we provide PhpStorm with type hints using <a href="phpdoc-comments.html">PHPDoc</a>.            </p>            <p id="683ac15a">                By adding any of the following in the function's PHPDoc block, we can specify the type of data that a given parameter will take:            </p>            <ul class="list _ul"><li class="list__item" id="23d23874">                    <code class="code">#Entity</code>                </li><li class="list__item" id="a4b8a3ed">                    <code class="code">#Service</code>                </li><li class="list__item" id="be671460">                    <code class="code">#FormType</code>                </li><li class="list__item" id="c8ab39b9">                    <code class="code">#Template</code>                </li><li class="list__item" id="b8b7cfae">                    <code class="code">#Route</code>                </li><li class="list__item" id="d80b2101">                    <code class="code">#Class</code>                </li><li class="list__item" id="2187ea9a">                    <code class="code">#TranslationKey</code>                </li><li class="list__item" id="6e8dc78c">                    <code class="code">#TranslationDomain</code>                </li><li class="list__item" id="fc8beb5d">                    <code class="code">#FormOption</code>                </li><li class="list__item" id="a447dbdb">                    <code class="code">#Interface</code>                </li></ul>            <p id="cc5706f8">                The example function with the added hints will look like as follows. Note the <code class="code">#Route</code> in the description for the $route parameter.            </p>            <div class="code-block" data-lang="php">
                /**
                * Translate route
                *
                * @param $route string #Route to translate the URL for
                * @param $locale string Locale to translate into
                */
                protected function translateRoute($route, $locale) {
                    // ...
                }
            </div>            <p id="10c7cad2">                The Symfony Plugin will now index the function correctly and provide completion and navigation for the <code class="code">$route</code> parameter.            </p>            <figure><img alt="Symfony hash parameter completion in a helper function" title="Symfony hash parameter completion in a helper function" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_hash_completion.png" id="b5446bb4" width="800" height="650"></figure>        </div>    </div>    <div class="chapter"><h2 id="signature-types" data-toc="Symfony_creating_helper_functions#signature-types">Signature Types</h2>        <p id="7fded9b3">            Consider a test class, in which we will be writing a test in the <code class="code">testIndex</code> function. The class comes with a helper function that can mock a service registered with our Symfony web application.        </p>        <div class="code-block" data-lang="php">
        class SomeTest extends PHPUnit_Framework_TestCase {
            /**
            * @param $service string #Service to mock
            * @return PHPUnit_Framework_MockObject_MockObject
            */
            protected function getMockService($service) {
                // ... resolve interface from $service ...
                $serviceInterface = '';

                return $this-&gt;getMock($serviceInterface);
            }

            function testIndex() {
                // TODO: our code will go here...
            }
        }
        </div>        <p id="6b78aa3a">            Since we've added the <code class="code">#Service</code> type hint to the <code class="code">$service</code>             parameter of our <code class="code">getMockService</code> function, we now get completion and navigation when calling it.        </p>        <figure><img alt="Symfony mock completion in a helper function" title="Symfony mock completion in a helper function" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_mock_completion_1.png" id="f8b8514f" width="546" height="305"></figure>        <p id="f43c3e5a">            Unfortunately, we don't get completion for our mocked service: only completion for PHPUnit's <code class="code">PHPUnit_Framework_MockObject</code> class is available.        </p>        <figure><img alt="Symfony mock completion in a helper function not available" title="Symfony mock completion in a helper function not available" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_mock_completion_2.png" id="2e92db42" width="453" height="218"></figure>        <p id="2e26914b">            Ideally, invoking completion on the <code class="code">$mock</code> instance would yield all public members of, in this case, the <code class="code">filesystem</code> service. When invoking <code class="code">getMockService</code> with the <code class="code">mailer</code> service name, we would expect it to provide completion based on the public members of the <code class="code">mailer</code> service.        </p>        <p id="e8e39748">            To achieve this, <a name="open_settings"></a>                in the        <a name="settings_dialog"></a>        <span class="control">Settings/Preferences</span> dialog <kbd data-primary_default_for_windows="Ctrl+Alt+S" data-primary_default_for_macos="⌘+Comma" data-primary_intellij_idea_classic_macos="⌘+Comma" data-primary_emacs="Ctrl+Alt+S" data-primary_visual_studio="Alt+F7" data-primary_default_for_xwin="Ctrl+Alt+S" data-primary_default_for_gnome="Ctrl+Alt+S" data-primary_default_for_kde="Ctrl+Alt+S" data-primary_eclipse="Ctrl+Alt+S" data-primary_eclipse_macos="⌘+Comma" data-primary_netbeans="Ctrl+Alt+S" data-primary_sublime_text="Ctrl+Alt+S" data-primary_sublime_text_macos="⌘+Comma" data-secondary_default_for_windows="⌃⌥S" data-secondary_default_for_macos="⌘," data-secondary_intellij_idea_classic="⌘," data-secondary_emacs="⌃⌥S" data-secondary_visual_studio="⌥F7" data-secondary_default_for_xwin="⌃⌥S" data-secondary_default_for_gnome="⌃⌥S" data-secondary_default_for_kde="⌃⌥S" data-secondary_eclipse="⌃⌥S" data-secondary_eclipse_macos="⌘," data-secondary_netbeans="⌃⌥S" data-secondary_sublime_text="⌃⌥S" data-secondary_sublime_text_macos="⌘,">Ctrl+Alt+S</kbd>, navigate to <span data-skip-index="skip" class="menupath">Languages &amp; Frameworks | PHP | Symfony | Type Provider</span>. Then, select the <span class="control">Enable Custom Signature Types</span> checkbox and click <img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.add@2x.png" width="16" alt="the Add button"> to add information about the <code class="code">getMockService</code> function.        </p>        <figure><img alt="Create Symfony helper function custom signature" title="Create Symfony helper function custom signature" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_method_signature_setting.png" id="9acf918f" width="500" height="394"></figure>        <p id="aa70bdda">            Provide the following:        </p>        <ul class="list _ul"><li class="list__item" id="e0c79913"><p>                <span class="control">CallTo</span>: The FQN of the class (with leading <code class="code">\</code>) that contains the function.            </p></li><li class="list__item" id="34730ba2"><p>                <span class="control">Method</span>: The function name.            </p></li><li class="list__item" id="a18286d8"><p>                <span class="control">Index</span>: The index of the parameter that determines the return type.            </p></li><li class="list__item" id="f4b67958"><p>                <span class="control">Provider</span>: The provider of potential data. This is where we choose the Symfony component type that is returned by the function.            </p></li></ul>        <p id="21dbd267">            Once we apply changes, code completion for our <code class="code">$mock</code> variable will be available.        </p>        <figure><img alt="Symfony mock completion in a helper function available" title="Symfony mock completion in a helper function available" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_mock_completion_3.png" id="f1e77258" width="411" height="290"></figure>    </div><div class="last-modified" data-skip-index="skip">Last modified: 29 November 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="symfony-events.html">Events</a><a class="navigation-links__next" href="laravel.html">Laravel</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>