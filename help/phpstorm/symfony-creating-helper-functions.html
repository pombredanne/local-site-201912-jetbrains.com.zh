<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>创建助手功能-帮助|暴风雨</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Symfony_creating_helper_functions" data-breadcrumbs="PHP frameworks and external tools/Symfony_support.xml|Symfony/Symfony_creating_helper_functions.xml|Creating Helper Functions" data-main-title="Creating Helper Functions"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索PhpStorm帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>PhpStorm 2019.3帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default_for_windows" data-group="primary" selected>Windows的默认设置</option><option value="primary_default_for_macos" data-group="primary">macOS的默认设置</option><option value="primary_intellij_idea_classic_macos" data-group="primary">IntelliJ IDEA经典版（macOS）</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_visual_studio" data-group="primary">视觉工作室</option><option value="primary_default_for_xwin" data-group="primary">XWin的默认设置</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_eclipse_macos" data-group="primary">Eclipse（macOS）</option><option value="primary_netbeans" data-group="primary">NetBeans</option><option value="primary_sublime_text" data-group="primary">崇高文字</option><option value="primary_sublime_text_macos" data-group="primary">崇高文字（macOS）</option><option value="secondary_default_for_windows" data-group="secondary">Windows的默认设置</option><option value="secondary_default_for_macos" data-group="secondary">macOS的默认设置</option><option value="secondary_intellij_idea_classic" data-group="secondary">IntelliJ IDEA经典版</option><option value="secondary_emacs" data-group="secondary">埃马克斯</option><option value="secondary_visual_studio" data-group="secondary">视觉工作室</option><option value="secondary_default_for_xwin" data-group="secondary">XWin的默认设置</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_eclipse_macos" data-group="secondary">Eclipse（macOS）</option><option value="secondary_netbeans" data-group="secondary">NetBeans</option><option value="secondary_sublime_text" data-group="secondary">崇高文字</option><option value="secondary_sublime_text_macos" data-group="secondary">崇高文字（macOS）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 id="Symfony_creating_helper_functions.xml" data-toc="Symfony_creating_helper_functions">创建助手功能</h1>    <p id="9e1fd63a">Symfony插件根据对Symfony类和函数的用法来提供参数类型和返回类型推断。这使您可以创建自己的帮助程序函数，这些函数可以使用或返回<a href="symfony-templates.html">模板</a> ， <a href="symfony-service-container.html">服务</a> ， <a href="symfony-doctrine.html">实体</a> ， <a href="symfony-translations.html">翻译</a> ， <a href="symfony-routes.html">路线</a> ， <a href="symfony-forms.html">表单</a>或<a href="symfony-events.html">事件</a> 。</p>    <p id="c4fb4e1f">举例来说，让我们创建一个<code class="code">redirectToRoute</code>可以在控制器中使用的功能。此功能将结合<code class="code">Controller</code>类' <code class="code">redirect</code>和<code class="code">generateUrl</code>功能，以便您可以轻松地将用户重定向到我们应用程序中的已知路由。该代码将如下所示：</p>    <div class="code-block" data-lang="php">受保护的函数redirectToRoute（$ route）{返回$ this-> redirect（$ this-> generateUrl（$ route））; }</div>    <p id="34bf93f9">当我们调用此函数时，我们将获得代码完成<kbd data-primary_default_for_windows="Ctrl+Space" data-primary_default_for_macos="Ctrl+Space" data-primary_intellij_idea_classic_macos="Ctrl+Space" data-primary_emacs="Alt+/" data-primary_visual_studio="Ctrl+Space" data-primary_default_for_xwin="Ctrl+Space" data-primary_default_for_gnome="Ctrl+Space" data-primary_default_for_kde="Ctrl+Space" data-primary_eclipse="Ctrl+Space" data-primary_eclipse_macos="Ctrl+Space" data-primary_netbeans="Ctrl+Space" data-primary_sublime_text="Ctrl+Space" data-primary_sublime_text_macos="Ctrl+Space" data-secondary_default_for_windows="⌃Space" data-secondary_default_for_macos="⌃Space" data-secondary_intellij_idea_classic="⌃Space" data-secondary_emacs="⌥/" data-secondary_visual_studio="⌃Space" data-secondary_default_for_xwin="⌃Space" data-secondary_default_for_gnome="⌃Space" data-secondary_default_for_kde="⌃Space" data-secondary_eclipse="⌃Space" data-secondary_eclipse_macos="⌃Space" data-secondary_netbeans="⌃Space" data-secondary_sublime_text="⌃Space" data-secondary_sublime_text_macos="⌃Space">Ctrl+Space</kbd>为了<code class="code">$route</code>以及导航到相应声明的能力<kbd data-primary_default_for_windows="Ctrl+B" data-primary_default_for_macos="⌘+B" data-primary_intellij_idea_classic_macos="⌘+B" data-primary_emacs="Ctrl+Alt+G" data-primary_visual_studio="F12" data-primary_default_for_xwin="Ctrl+B" data-primary_default_for_gnome="Ctrl+B" data-primary_default_for_kde="Ctrl+B" data-primary_eclipse="F3" data-primary_eclipse_macos="F3" data-primary_netbeans="Ctrl+B" data-primary_sublime_text="F12" data-primary_sublime_text_macos="F12" data-secondary_default_for_windows="⌃B" data-secondary_default_for_macos="⌘B" data-secondary_intellij_idea_classic="⌘B" data-secondary_emacs="⌃⌥G" data-secondary_visual_studio="F12" data-secondary_default_for_xwin="⌃B" data-secondary_default_for_gnome="⌃B" data-secondary_default_for_kde="⌃B" data-secondary_eclipse="F3" data-secondary_eclipse_macos="F3" data-secondary_netbeans="⌃B" data-secondary_sublime_text="F12" data-secondary_sublime_text_macos="F12">Ctrl+B</kbd> 。</p>    <figure><img alt="辅助函数中的Symfony路由名称完成" title="辅助函数中的Symfony路由名称完成" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_route_completion.png" id="a8e10d27" width="811" height="656"></figure>    <p id="69abed85">返回的代码完成和导航<code class="code">$response</code>实例也可用。</p>    <figure><img alt="辅助函数中的Symfony响应名称完成" title="辅助函数中的Symfony响应名称完成" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_response_completion.png" id="d8dbf448" width="581" height="228"></figure>    <p id="ffac2ac2">这两项工作的原因是Symfony插件可以推断出<code class="code">$route</code>通过分析已知函数的调用和返回类型来确定的类型。这种类型分析适用于大多数Symfony组件（模板，服务，实体，翻译，路由，表单或事件），但是在某些情况下它不能按原样工作。</p>    <p id="66541a9f">每当我们自己创建或从第三方库使用的帮助程序功能的完成和导航似乎不起作用时，Symfony插件都会提供一个解决方案：它通过“ <a href="#method-parameter">方法参数”</a>和“ <a href="#signature-types">签名类型”</a>项目设置提供对某些内部组件的访问。 。</p>    <div class="chapter"><h2 id="method-parameter" data-toc="Symfony_creating_helper_functions#method-parameter">方法参数</h2>        <p id="1fd2f027">考虑以下函数，该函数不使用任何特定于Symfony的函数：</p>            <div class="code-block" data-lang="php">/ ** *转换路由* * @param $ route字符串转换URL的路由* @ param $ locale字符串区域设置转换为* /受保护的函数translateRoute（$ route，$ locale）{// ...}</div>        <p id="6ce0f06c">在这种情况下，Symfony插件将无法确定<code class="code">$route</code>字符串参数应包含路线名称，并为其提供完成和导航。我们可以使用以下任何一种技术来解决此问题：</p>        <ul class="list _ul"><li class="list__item" id="c225b28a"><a href="#method-references">方法参考</a>            </li><li class="list__item" id="dff6b5ec"><a href="#hashes">散列</a>            </li></ul>        <div class="chapter"><h3 id="method-references">方法参考</h3>            <p id="ec56ca9f">为了告诉Symfony插件我们的方法， <a name="open_settings"></a>在里面<a name="settings_dialog"></a> <span class="control">设置/首选项</span>对话框<kbd data-primary_default_for_windows="Ctrl+Alt+S" data-primary_default_for_macos="⌘+Comma" data-primary_intellij_idea_classic_macos="⌘+Comma" data-primary_emacs="Ctrl+Alt+S" data-primary_visual_studio="Alt+F7" data-primary_default_for_xwin="Ctrl+Alt+S" data-primary_default_for_gnome="Ctrl+Alt+S" data-primary_default_for_kde="Ctrl+Alt+S" data-primary_eclipse="Ctrl+Alt+S" data-primary_eclipse_macos="⌘+Comma" data-primary_netbeans="Ctrl+Alt+S" data-primary_sublime_text="Ctrl+Alt+S" data-primary_sublime_text_macos="⌘+Comma" data-secondary_default_for_windows="⌃⌥S" data-secondary_default_for_macos="⌘," data-secondary_intellij_idea_classic="⌘," data-secondary_emacs="⌃⌥S" data-secondary_visual_studio="⌥F7" data-secondary_default_for_xwin="⌃⌥S" data-secondary_default_for_gnome="⌃⌥S" data-secondary_default_for_kde="⌃⌥S" data-secondary_eclipse="⌃⌥S" data-secondary_eclipse_macos="⌘," data-secondary_netbeans="⌃⌥S" data-secondary_sublime_text="⌃⌥S" data-secondary_sublime_text_macos="⌘,">Ctrl+Alt+S</kbd> ，导航到<span class="menupath" data-skip-index="skip">语言和框架| PHP | Symfony |方法参考</span> 。然后，点击<img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.add@2x.png" width="16" alt="添加按钮">添加新的方法参数注册。</p>            <figure><img alt="Symfony MethodParameterSetting对话框" title="Symfony MethodParameterSetting对话框" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_method_parameter_setting.png" id="ceb43002" width="500" height="526"></figure>            <p id="6769bba9">提供以下内容：</p>            <ul class="list _ul"><li class="list__item" id="60fbceda"><p>                    <span class="control">CallTo</span> ：班级的FQN（领先<code class="code">\</code> ），其中包含该功能。</p></li><li class="list__item" id="456c0ea0"><p>                    <span class="control">方法</span> ：函数名称。</p></li><li class="list__item" id="7e8ece36"><p>                    <span class="control">Index</span> ：我们要为其完成和导航的参数的索引。</p></li><li class="list__item" id="28459e2a"><p>                    <span class="control">提供者</span> ：潜在数据的提供者。在这里，我们选择要为我们的函数参数接受的Symfony组件。</p></li><li class="list__item" id="2fdaf1d0"><p>                    <span class="control">贡献者</span> ：（可选）如果我们的函数参数是一个数组，并且希望在数组的键或值中完成操作，则可以使用这些选项进行指定。</p></li><li class="list__item" id="7cb60c58"><p>                    <span class="control">ContributorData</span> ：（可选）如果需要数组值完成，则可以在此处输入要提供完成和导航的键。</p></li></ul>一旦应用更改，就可以使用完整的功能以及对我们的助手功能参数的导航支持。由于这是项目级别的设置，因此您可以<a href="configuring-project-and-ide-settings.html">与团队共享</a> 。<figure><img alt="辅助函数中的Symfony方法参数完成" title="辅助函数中的Symfony方法参数完成" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_method_parameter_completion.png" id="85747a22" width="800" height="650"></figure>            <p id="bc7b55aa">尽管此技术功能强大，但在大多数情况下使用<a href="#hashes">带有哈希的提示</a>可能更容易使用，并且不需要与团队成员共享项目设置。</p>        </div>        <div class="chapter"><h3 id="hashes">散列</h3>            <p id="7476c17b">代替在设置中配置方法参数，我们可以使用提示，类似于使用<a href="phpdoc-comments.html">PHPDoc</a>为PhpStorm提供类型提示的方式。</p>            <p id="683ac15a">通过在函数的PHPDoc块中添加以下任何内容，我们可以指定给定参数将采用的数据类型：</p>            <ul class="list _ul"><li class="list__item" id="23d23874">                    <code class="code">#Entity</code>                </li><li class="list__item" id="a4b8a3ed">                    <code class="code">#Service</code>                </li><li class="list__item" id="be671460">                    <code class="code">#FormType</code>                </li><li class="list__item" id="c8ab39b9">                    <code class="code">#Template</code>                </li><li class="list__item" id="b8b7cfae">                    <code class="code">#Route</code>                </li><li class="list__item" id="d80b2101">                    <code class="code">#Class</code>                </li><li class="list__item" id="2187ea9a">                    <code class="code">#TranslationKey</code>                </li><li class="list__item" id="6e8dc78c">                    <code class="code">#TranslationDomain</code>                </li><li class="list__item" id="fc8beb5d">                    <code class="code">#FormOption</code>                </li><li class="list__item" id="a447dbdb">                    <code class="code">#Interface</code>                </li></ul>            <p id="cc5706f8">带有添加提示的示例函数将如下所示。注意<code class="code">#Route</code>在$ route参数的说明中。</p>            <div class="code-block" data-lang="php">/ ** *转换路线* * @param $ route字符串#Route转换* *的URL $ param $ locale字符串区域设置转换为* /受保护的函数translateRoute（$ route，$ locale）{// ...}</div>            <p id="10c7cad2">Symfony插件现在将正确索引该功能，并为该功能提供完成和导航。 <code class="code">$route</code>参数。</p>            <figure><img alt="辅助函数中的Symfony哈希参数完成" title="辅助函数中的Symfony哈希参数完成" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_hash_completion.png" id="b5446bb4" width="800" height="650"></figure>        </div>    </div>    <div class="chapter"><h2 id="signature-types" data-toc="Symfony_creating_helper_functions#signature-types">签名类型</h2>        <p id="7fded9b3">考虑一个测试类，我们将在其中编写一个测试<code class="code">testIndex</code>功能。该类带有一个辅助函数，该函数可以模拟在我们的Symfony Web应用程序中注册的服务。</p>        <div class="code-block" data-lang="php">类SomeTest扩展了PHPUnit_Framework_TestCase {/ ** * @param $ service string #Service进行模拟* @return PHPUnit_Framework_MockObject_MockObject * /受保护的函数getMockService（$ service）{// ...从$ service解析接口...$ serviceInterface ='';返回$ this-> getMock（$ serviceInterface）; } function testIndex（）{// TODO：我们的代码将在这里...}}</div>        <p id="6b78aa3a">由于我们已经添加了<code class="code">#Service</code>输入提示<code class="code">$service</code>我们的参数<code class="code">getMockService</code>函数，现在我们可以在调用它时获得完成和导航。</p>        <figure><img alt="辅助函数中的Symfony模拟完成" title="辅助函数中的Symfony模拟完成" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_mock_completion_1.png" id="f8b8514f" width="546" height="305"></figure>        <p id="f43c3e5a">不幸的是，我们的模拟服务没有完成：只有PHPUnit的完成<code class="code">PHPUnit_Framework_MockObject</code>该课程可用。</p>        <figure><img alt="辅助函数中的Symfony模拟完成不可用" title="辅助函数中的Symfony模拟完成不可用" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_mock_completion_2.png" id="2e92db42" width="453" height="218"></figure>        <p id="2e26914b">理想情况下，在<code class="code">$mock</code>实例将产生所有公共成员，在这种情况下， <code class="code">filesystem</code>服务。调用时<code class="code">getMockService</code>与<code class="code">mailer</code>服务名称，我们希望它会根据<code class="code">mailer</code>服务。</p>        <p id="e8e39748">为了达成这个， <a name="open_settings"></a>在里面<a name="settings_dialog"></a> <span class="control">设置/首选项</span>对话框<kbd data-primary_default_for_windows="Ctrl+Alt+S" data-primary_default_for_macos="⌘+Comma" data-primary_intellij_idea_classic_macos="⌘+Comma" data-primary_emacs="Ctrl+Alt+S" data-primary_visual_studio="Alt+F7" data-primary_default_for_xwin="Ctrl+Alt+S" data-primary_default_for_gnome="Ctrl+Alt+S" data-primary_default_for_kde="Ctrl+Alt+S" data-primary_eclipse="Ctrl+Alt+S" data-primary_eclipse_macos="⌘+Comma" data-primary_netbeans="Ctrl+Alt+S" data-primary_sublime_text="Ctrl+Alt+S" data-primary_sublime_text_macos="⌘+Comma" data-secondary_default_for_windows="⌃⌥S" data-secondary_default_for_macos="⌘," data-secondary_intellij_idea_classic="⌘," data-secondary_emacs="⌃⌥S" data-secondary_visual_studio="⌥F7" data-secondary_default_for_xwin="⌃⌥S" data-secondary_default_for_gnome="⌃⌥S" data-secondary_default_for_kde="⌃⌥S" data-secondary_eclipse="⌃⌥S" data-secondary_eclipse_macos="⌘," data-secondary_netbeans="⌃⌥S" data-secondary_sublime_text="⌃⌥S" data-secondary_sublime_text_macos="⌘,">Ctrl+Alt+S</kbd> ，导航到<span class="menupath" data-skip-index="skip">语言和框架| PHP | Symfony |类型提供者</span> 。然后，选中“ <span class="control">启用自定义签名类型”</span>复选框并单击<img class="inline-icon-16" src="/help/img/idea/2019.3/icons.general.add@2x.png" width="16" alt="添加按钮">添加有关的信息<code class="code">getMockService</code>功能。</p>        <figure><img alt="创建Symfony辅助函数自定义签名" title="创建Symfony辅助函数自定义签名" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_method_signature_setting.png" id="9acf918f" width="500" height="394"></figure>        <p id="aa70bdda">提供以下内容：</p>        <ul class="list _ul"><li class="list__item" id="e0c79913"><p>                <span class="control">CallTo</span> ：班级的FQN（领先<code class="code">\</code> ），其中包含该功能。</p></li><li class="list__item" id="34730ba2"><p>                <span class="control">方法</span> ：函数名称。</p></li><li class="list__item" id="a18286d8"><p>                <span class="control">Index</span> ：确定返回类型的参数的索引。</p></li><li class="list__item" id="f4b67958"><p>                <span class="control">提供者</span> ：潜在数据的提供者。在这里，我们选择函数返回的Symfony组件类型。</p></li></ul>        <p id="21dbd267">一旦应用更改，我们的代码完成<code class="code">$mock</code>变量将可用。</p>        <figure><img alt="可用的辅助函数中的Symfony模拟完成" title="可用的辅助函数中的Symfony模拟完成" src="/help/img/idea/2019.3/ps_symfony_create_helper_function_mock_completion_3.png" id="f1e77258" width="411" height="290"></figure>    </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月29日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="symfony-events.html">活动</a> <a class="navigation-links__next" href="laravel.html">Laravel</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>