<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"></meta><meta name="robots" content="noindex"></meta><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Pytest - Help | PyCharm</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Pytest" data-article-props="&#xA;                {&#xA;                &#xA;            &#34;seeAlso&#34;:[&#xA;            &#xA;                {&#34;title&#34;: &#34;External Links&#34;,&#xA;                 &#34;links&#34;: [&#xA;                &#xA;        {&#34;url&#34;:&#34;https://docs.pytest.org&#34;,&#34;text&#34;:&#34;docs.pytest.org&#34;}&#xA;        {&#34;url&#34;:&#34;https://docs.pytest.org/en/latest/index.html#documentation&#34;,&#34;text&#34;:&#34;Pytest documentation&#34;}&#xA;        {&#34;url&#34;:&#34;https://docs.pytest.org/en/latest/fixture.html#fixture&#34;,&#34;text&#34;:&#34;Pytest fixtures&#34;}&#xA;        {&#34;url&#34;:&#34;https://pytest-bdd.readthedocs.io/en/latest/&#34;,&#34;text&#34;:&#34;pytest-bdd&#34;}&#xA;                    ]},&#xA;                {&#34;title&#34;: &#34;Web Resources&#34;,&#xA;                 &#34;links&#34;: [&#xA;                &#xA;        {&#34;url&#34;:&#34;http://devnet.jetbrains.com/community/python?view=documents&#xA;            &#34;,&#34;text&#34;:&#34;Developer Community&#34;}&#xA;                    ]}&#xA;            ]&#xA;        &#xA;                }&#xA;            "><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search PyCharm Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>PyCharm 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="primary" value="primary_default_for_windows" selected>Default for Windows</option><option data-group="primary" value="primary_intellij_idea_classic_macos">IntelliJ IDEA Classic (macOS)</option><option data-group="primary" value="primary_default_for_gnome">Default for GNOME</option><option data-group="primary" value="primary_default_for_kde">Default for KDE</option><option data-group="primary" value="primary_sublime_text">Sublime Text</option><option data-group="primary" value="primary_eclipse">Eclipse</option><option data-group="primary" value="primary_emacs">Emacs</option><option data-group="primary" value="primary_default_for_xwin_windows">Default for XWin (Windows)</option><option data-group="secondary" value="secondary_default_for_macos">Default for macOS</option><option data-group="secondary" value="secondary_default_for_gnome">Default for GNOME</option><option data-group="secondary" value="secondary_default_for_kde">Default for KDE</option><option data-group="secondary" value="secondary_eclipse">Eclipse</option><option data-group="secondary" value="secondary_default_for_xwin_macos">Default for XWin (macOS)</option><option data-group="secondary" value="secondary_sublime_text_macos">Sublime Text (macOS)</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 data-toc="Pytest" id="Pytest.xml">Pytest</h1>    <p id="734b7572">PyCharm supports <a href="https://docs.pytest.org" data-external="true" target="_blank" rel="noopener noreferrer">pytest</a>, a fully functional testing framework.</p>    <p id="9dd0ec71">The following features are available:</p>    <ul class="list _ul"><li class="list__item" id="54696d44"><p>The dedicated test runner.</p></li><li class="list__item" id="154fc916"><p>Code completion for test subject and pytest fixtures.</p></li><li class="list__item" id="011699ec"><p>Code navigation (except for <a href="navigating-between-test-and-test-subject.html">Navigating between test and test subject</a>).</p></li><li class="list__item" id="77586889"><p>Detailed failing assert reports.</p></li><li class="list__item" id="cf4746a0"><p>Support for Python 2.7 and Python 3.5 and later.</p></li><li class="list__item" id="7fce7d10"><p><a href="performing-tests.html#test-mutliprocessing">Multiprocessing</a> test execution.</p></li></ul><p id="9b20024e">By default, the suggested default test runner is <a href="https://docs.python.org/2/library/unittest.html" data-external="true" target="_blank" rel="noopener noreferrer">unittest</a>. So, to utilize pytest, you need to make it the default test runner first.</p><section class="procedure-steps"><h3 id="enable-pytest" data-toc="Pytest#enable-pytest">Enable Pytest for you project</h3><ol class="list _decimal"><li class="list__item" id="6b776140"><p>Open the <span data-skip-index="skip" class="menupath">Settings/Preferences | Tools | Python Integrated Tools</span> settings dialog as described in <a href="choosing-your-testing-framework.html">Choosing Your Testing Framework</a>.</p></li><li class="list__item" id="75a26192"><p>In the <span class="control">Default test runner</span> field select <span class="control">pytest</span>.    </p></li><li class="list__item" id="9b4bfca2"><p>Click <span class="control">OK</span> to save the settings.</p></li></ol></section>    <p id="9423377c">Now, that pytest is set as the default testing framework, you can create a small test for the        <a href="creating-and-running-your-first-python-project.html#edit-file">Car</a> sample. Let's create        a pytest test to check the <code class="code">brake</code> function.</p><section class="procedure-steps"><h3 id="create-pytest-test" data-toc="Pytest#create-pytest-test">Create a test</h3><ol class="list _decimal"><li class="list__item" id="d0ab0d8d"><p>Create a <a href="creating-and-running-your-first-python-project.html#creating-simple-project">Python project</a>.</p></li><li class="list__item" id="5226699c"><p>From the main menu, click <span class="control">File | New</span>, choose <span class="control">Python file</span>, type <span class="filepath">Car.py</span>, and click <span class="control">OK</span>.</p></li><li class="list__item" id="02ead67b"><p>Copy and paste the        <a href="creating-and-running-your-first-python-project.html#edit-file">Car</a> sample into the <span class="filepath">Car.py</span> file.</p></li><li class="list__item" id="2070a523"><p>Create one more Python file and name it <span class="filepath">test_car_pytest</span>.</p></li><li class="list__item" id="c1d5ebbd"><p>Add the following code to the newly created file. This code sets the initial speed value of <code class="code">Car</code> to        50 and checks if speed gets properly set to 45 after the <code class="code">brake()</code> function execution.</p></li></ol><div class="code-block" data-lang="python">
         from Car import Car


         def test_car_brake():
             car = Car(50)
             car.brake()
             assert car.speed == 45
     </div><p id="b3cfb0f9">Note that PyCharm recognizes the test subject and offers completion for the <code class="code">Car</code> class' instance.</p><figure><img alt="Autocompletion for the test subject" title="Autocompletion for the test subject" src="/help/img/idea/2019.2/py_pytest_autocomplete.png" id="c529ced0" width="300" height="374"></figure><p id="2a603b20">PyCharm detects a function with an <code class="code">assert</code> statement and adds the <span class="control">Run Test</span> icon to the gutter.</p><p id="20f050e9">Although <span class="control">Go To Test Subject</span> and <span class="control">Go To Test</span> commands of the context menu are not supported for pytest, you can    navigate to the tested code in <span class="filepath">Car.py</span> by using the <span class="control">Go To Declaration</span> <kbd data-primary_default_for_windows="Ctrl+B" data-primary_intellij_idea_classic_macos="⌘+B" data-primary_default_for_gnome="Ctrl+B" data-primary_default_for_kde="Ctrl+B" data-primary_sublime_text="F12" data-primary_eclipse="F3" data-primary_emacs="Ctrl+Alt+G" data-primary_default_for_xwin_windows="N/A" data-secondary_default_for_macos="⌘B" data-secondary_default_for_gnome="⌃B" data-secondary_default_for_kde="⌃B" data-secondary_eclipse="F3" data-secondary_default_for_xwin_macos="N/A" data-secondary_sublime_text_macos="F12">Ctrl+B</kbd> command.</p></section><section class="procedure-steps"><h3 id="run-pytest-test" data-toc="Pytest#run-pytest-test">Run a test</h3><ol class="list _decimal"><li class="list__item" id="00a2e091"><p id="215ea484">Click <img class="inline-icon-16" src="/help/img/idea/2019.2/icons.toolwindows.toolWindowRun.svg@2x.png" width="16" alt="Run Test"> to run the test:    <figure><img alt="Run the test" title="Run the test" src="/help/img/idea/2019.2/py_pytest_run_test.png" id="e58953c0" width="250" height="99"></figure></p>    <p id="71182705">Note that PyCharm automatically creates a pytest <a href="run-debug-configuration-py-test.html">Run/Debug</a> configuration:        <figure><img alt="Suggested run/debug configuration for pytest" title="Suggested run/debug configuration for pytest" src="/help/img/idea/2019.2/py_pytest_run_debug_configuration.png" id="17e7f2b3" width="324" height="243"></figure> </p>        <p id="9a9e6dda">Select <span class="control">Run pytest for test_car_pytest</span> to execute the test.</p>    </li><li class="list__item" id="f936c636"><p id="fb5b81f0">Inspect test results:    <figure><img alt="Pytest run" title="Pytest run" src="/help/img/idea/2019.2/py_pytest_results.png" id="0d2dd693" width="800" height="610"></figure>    </p></li><li class="list__item" id="5fe334a1"><p id="f190a246">Alter the <code class="code">assert</code> statement to the following: <code class="code">assert my_car.speed == 4599</code>.</p></li><li class="list__item" id="a19c6074"><p id="36576611">Rerun the test to evaluate the assert failing report:    <figure><img alt="Assert failing report" title="Assert failing report" src="/help/img/idea/2019.2/py_pytest_fail_report.png" id="8ceddf41" width="800" height="608"></figure>    Note that pytest provides an explicit report on the failure.    </p></li></ol></section>    <p id="c436246e">With pytest <i id="f0cdfd88">fixtures</i> you can create small test units that can be reused across the testing module.        All you need is to mark a reusable unit with <code class="code">@pytest.fixture</code>.</p><section class="procedure-steps"><h3 id="pytest-fixtures" data-toc="Pytest#pytest-fixtures">Use fixtures</h3><ol class="list _decimal"><li class="list__item" id="d3c72780">        <p id="ae1c2960">Modify your <code class="code">Car</code> pytest test as follows:            <div class="code-block" data-lang="python">
                    import pytest
                    from Car import Car


                    @pytest.fixture
                    def my_car():
                        return Car(50)


                    def test_car_accelerate(my_car):
                        my_car.accelerate()
                        assert my_car.speed == 55


                    def test_car_brake(my_car):
                        my_car.brake()
                        assert my_car.speed == 45

                </div>        </p>        <p id="a61e619f"><code class="code">my_car()</code> is a fixture function that creates a <code class="code">Car</code> instance with the speed value equal to 50. It is used in          <code class="code">test_car_accelerate</code> and <code class="code">test_car_brake</code> to verify correct execution of the corresponding functions in the <code class="code">Car</code> class.</p>      <p id="ada158de">Note that the <code class="code">my_car</code> fixture is added to the code completion list along with other standard pytest fixtures, such as <code class="code">tempdir</code>.      <figure><img alt="Autocompletion for a pytest fixture" title="Autocompletion for a pytest fixture" src="/help/img/idea/2019.2/py_pytest_fixture_autocomplete.png" id="8bde6e7c" width="700" height="529"></figure>      </p>    </li><li class="list__item" id="44fdd8e1"><p>Click either of the <img class="inline-icon-16" src="/help/img/idea/2019.2/icons.toolwindows.toolWindowRun.svg@2x.png" width="16" alt="Run Test"> icons, or run the entire test module.</p></li></ol><p id="6df1befe">You can enable sharing fixture instances across tests using the <code class="code">scope</code> parameter of the fixture function.    For more information about pytest fixtures, see <a href="https://docs.pytest.org/en/latest/fixture.html#fixture" data-external="true" target="_blank" rel="noopener noreferrer">pytest fixtures documentation</a>.</p></section>    <p id="22290c36">You might want to run your tests on the predefined set of data. PyCharm supports test parametrization implemented in        pytest through <code class="code">@pytest.mark.parametrize</code>.</p>    <section class="procedure-steps"><h3 id="pytest-parametrize" data-toc="Pytest#pytest-parametrize">Apply parametrization</h3><ol class="list _decimal"><li class="list__item" id="3fb7236c"><p>Let us create a set of speed values to test <code class="code">car.accelerate</code> and <code class="code">car.brake</code> functions: <code class="code">speed_data = {45, 50, 55, 100}</code></p></li><li class="list__item" id="903c5a82">            <p id="a9a02f7c">Modify the test code to the following:                <div class="code-block" data-lang="python">
                        import pytest
                        from Car import Car
                        speed_data = {45, 50, 55, 100}


                        @pytest.mark.parametrize("speed_brake", speed_data)
                        def test_car_brake(speed_brake):
                            car = Car(50)
                            car.brake()
                            assert car.speed == speed_brake


                        @pytest.mark.parametrize("speed_accelerate", speed_data)
                        def test_car_accelerate(speed_accelerate):
                            car = Car(50)
                            car.accelerate()
                            assert car.speed == speed_accelerate
                    </div>            </p>            <p id="276b68ce">Note that PyCharm detects the newly created parameters and adds them to the completion list.</p>            <p id="f99377f6">                <figure><img alt="Code completion for pytest.mark.parametrize" title="Code completion for pytest.mark.parametrize" src="/help/img/idea/2019.2/py_pytest_parametrize_completion.png" id="0d5ea5c3" width="500" height="241"></figure>            </p>        </li><li class="list__item" id="f297c277"><p>Run the test for the <code class="code">car.brake()</code> function. You should expect the following test report:            <figure><img alt="Three tests failed and one test passed for the car.brake function" title="Three tests failed and one test passed for the car.brake function" src="/help/img/idea/2019.2/py_pytest_parametrize_test_run.png" id="aae88842" width="800" height="529"></figure>        </p></li></ol><p id="e2e669db">You can also run the test for <code class="code">car.accelerate()</code> function to ensure that it fails for all speed values but 55.            Refer to <a href="https://docs.pytest.org/en/latest/parametrize.html" data-external="true" target="_blank" rel="noopener noreferrer">pytest documentation</a> for more information about parametrized tests.</p></section>    <p id="5305e731">In addition to the mentioned capabilities, pytest supports Behavior-Driven Development (BDD) through <span class="emphasis">pytest_bdd</span>. This is particularly helpful when    you need to quickly record your test using the Gherkin language and utilize beneficial features of pytest, such as <code class="code">fixture</code>.</p>    <section class="procedure-steps"><h3 id="pytest-bdd" data-toc="Pytest#pytest-bdd">Implement test scenarios</h3><ol class="list _decimal"><li class="list__item" id="a3ef4049"><p id="b6607f4a">Let us modify the <code class="code">Car</code> sample to validate the car's speed. Add the following function to the <span class="filepath">Car.py</span> file:</p>            <div class="code-block" data-lang="python">
                def speed_validate(self):
                    return self.speed &lt;= 160
            </div>        </li><li class="list__item" id="4fc004ab">            <p id="c9843cd9">Next, enable <span class="emphasis">pytest-bdd</span> in your project. <a name="open_settings"></a>                In the <span class="control">Settings/Preferences</span> dialog (<kbd data-primary_default_for_windows="Ctrl+Alt+S" data-primary_intellij_idea_classic_macos="⌘+Comma" data-primary_default_for_gnome="Ctrl+Alt+S" data-primary_default_for_kde="Ctrl+Alt+S" data-primary_sublime_text="Ctrl+Alt+S" data-primary_eclipse="Ctrl+Alt+S" data-primary_emacs="Ctrl+Alt+S" data-primary_default_for_xwin_windows="N/A" data-secondary_default_for_macos="⌘," data-secondary_default_for_gnome="⌃⌥S" data-secondary_default_for_kde="⌃⌥S" data-secondary_eclipse="⌃⌥S" data-secondary_default_for_xwin_macos="N/A" data-secondary_sublime_text_macos="⌘,">Ctrl+Alt+S</kbd>), navigate to <span data-skip-index="skip" class="menupath">Languages &amp; Frameworks | BDD</span>,                and from the <span class="control">Preferred BDD framework</span> list select <span class="control">pytest-bdd</span>.</p>        </li><li class="list__item" id="6b3b758c"><p id="8959a866">Create a <span class="filepath">.feature</span> file to record BDD scenarios using the Gherkin language.            Right-click the project root and select <span data-skip-index="skip" class="menupath">New | Gherkin feature file</span>.            In the opened dialog, specify <span class="filepath">car.feature</span> as the filename and click <span class="control">OK</span>.</p></li><li class="list__item" id="f0bafa19">            <p id="7dd5617d">Add the following scenarios to the <span class="filepath">car.feature</span> file:</p>            <div class="code-block" data-lang="actionscript">
                Feature: Speed

                Scenario: Valid speed
                    Given Speed is less than 160
                    When Accelerated
                    Then Speed is valid

                Scenario: Invalid speed
                    Given Speed is more than 160
                    When Accelerated
                    Then Speed is invalid
            </div>          <p id="2acf2b09">Both scenarios validate the speed of the car. The speed is supposed to be valid when it does not exceed the value of 160.              Note the scenario steps are highlighted because they are not defined by this moment.          </p>            <figure><img alt="bdd scenarios" title="bdd scenarios" src="/help/img/idea/2019.2/py_pytest_bdd_feature.png" id="38da9e48" width="400" height="306"></figure>        </li><li class="list__item" id="b0e66e38">            <p id="3755e233">PyCharm enables quick generation of step definitions for the entire feature file. Set cursor on any of the highlighted            steps, click <kbd data-primary_default_for_windows="Ctrl+Shift+A" data-primary_intellij_idea_classic_macos="Shift+⌘+A" data-primary_default_for_gnome="Ctrl+Shift+A" data-primary_default_for_kde="Ctrl+Shift+A" data-primary_sublime_text="Ctrl+Shift+P" data-primary_eclipse="Ctrl+Shift+A" data-primary_emacs="Escape, X" data-primary_default_for_xwin_windows="N/A" data-secondary_default_for_macos="⇧⌘A" data-secondary_default_for_gnome="⌃⇧A" data-secondary_default_for_kde="⌃⇧A" data-secondary_eclipse="⌃⇧A" data-secondary_default_for_xwin_macos="N/A" data-secondary_sublime_text_macos="⇧⌘P">Ctrl+Shift+A</kbd>, and select <span class="control">Create all step definitions</span>. In the opened dialog,                specify the name of the test file (it should start with <span class="control">test</span>), select <span class="control">Python (pytest-bdd)</span> from the <span class="control">File type</span> list, and, if needed,                modify the default file location.</p>            <figure><img alt="step definitions generation" title="step definitions generation" src="/help/img/idea/2019.2/py_pytest_bdd_step_definitions.png" id="e416f235" width="550" height="231"></figure>            <p id="08660d55">Inspect the <span class="filepath">test_car_pytest_bdd_fixture.py</span> file. It contains all required <code class="code">import</code> statements and definitions for            each scenario steps.</p>         </li><li class="list__item" id="39066223">            <p id="2f7a5251">Let us modify the test file to use a pytest fixture for a <code class="code">Car</code> object and to add more test logic:</p>            <div class="code-block" data-lang="python">
                from pytest_bdd import scenario, given, when, then
                import pytest
                from Car import Car


                @pytest.fixture
                def my_car():
                    return Car()


                @scenario('car.feature', 'Valid speed')
                def test_speed_valid():
                    pass


                @scenario('car.feature', 'Invalid speed')
                def test_speed_invalid():
                    pass


                @given("Speed is less than 160")
                def set_valid_speed(my_car):
                    my_car.speed = 50


                @given("Speed is more than 160")
                def set_invalid_speed(my_car):
                    my_car.speed = 100


                @when("Accelerated")
                def car_accelerate(my_car):
                    my_car.accelerate()


                @then("Speed is valid")
                def success(my_car):
                    assert my_car.speed_validate()


                @then("Speed is invalid")
                def fail(my_car):
                    assert not my_car.speed_validate()

            </div>         </li><li class="list__item" id="402f42cd">             <p id="4c354dab">Run the test by creating the corresponding <a href="run-debug-configuration-py-test.html">Run/Debug</a> configuration.                 You can also run either of the scenarios using the <span class="control">Run</span> icon <img class="inline-icon-16" src="/help/img/idea/2019.2/icons.toolwindows.toolWindowRun.svg@2x.png" width="16" alt="Run icon"> in the gutter.</p>         </li><li class="list__item" id="99227223">            <p id="5662eb06">Inspect the test run results.</p>            <figure><img alt="pytest-bdd results" title="pytest-bdd results" src="/help/img/idea/2019.2/py_pytest_bdd_results.png" id="4d708755" width="900" height="306"></figure>            <p id="309d5dd6">In our example, we have the <code class="code">test_speed_valid</code> test passed and the <code class="code">test_speed_invalid</code>                test failed.</p>        </li></ol></section>    <div class="last-modified" data-skip-index="skip">Last modified: 6 November 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="testing-frameworks.html">Testing Frameworks</a><a class="navigation-links__next" href="tox-support.html">Tox Support</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>