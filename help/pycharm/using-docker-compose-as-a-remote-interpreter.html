<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="/resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>使用Docker Compose配置远程解释器-帮助|帮助PyCharm</title><link rel="stylesheet" href="/resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="add_interpreter_docker_compose" data-article-props="
                {
                
            " seeals=":[=" titl=":=" languages,="" frameworks="" and="" technologie=",=" link=":=" ur=":" templates.html#debu="," tex=":" to="" debug="" a="" django="" templat="}=" web="" resource=",=" http:="" ="" devnet.jetbrains.com="" community="" python?view="documents" developer="" communit="}="><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索PyCharm帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>PyCharm 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="primary_default_for_windows" data-group="primary" selected>Windows的默认设置</option><option value="primary_intellij_idea_classic_macos" data-group="primary">IntelliJ IDEA经典版（macOS）</option><option value="primary_default_for_gnome" data-group="primary">GNOME的默认设置</option><option value="primary_default_for_kde" data-group="primary">KDE的默认值</option><option value="primary_sublime_text" data-group="primary">崇高文字</option><option value="primary_eclipse" data-group="primary">日食</option><option value="primary_emacs" data-group="primary">埃马克斯</option><option value="primary_default_for_xwin_windows" data-group="primary">XWin的默认设置（Windows）</option><option value="secondary_default_for_macos" data-group="secondary">macOS的默认设置</option><option value="secondary_default_for_gnome" data-group="secondary">GNOME的默认设置</option><option value="secondary_default_for_kde" data-group="secondary">KDE的默认值</option><option value="secondary_eclipse" data-group="secondary">日食</option><option value="secondary_default_for_xwin_macos" data-group="secondary">XWin的默认设置（macOS）</option><option value="secondary_sublime_text_macos" data-group="secondary">崇高文字（macOS）</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 id="Using_Docker_Compose_as_a_Remote_Interpreter.xml" data-toc="add_interpreter_docker_compose">使用Docker Compose配置远程解释器</h1>        <a name="edition"></a>     <aside class="warning " rel="Using_Docker_Compose_as_a_Remote_Interpreter.xml" id="97256b1e" data-title=""><p>仅<b id="8b2d4d64" origin="intellij-platform">专业</b>版支持此功能。该版本是商业版本，它提供了一组出色的功能：有关更多详细信息，请参见<a href="/pycharm/features/editions_comparison_matrix.html" rel="noopener noreferrer" data-external="true" target="_blank">比较矩阵</a> 。</p></aside>                <div class="chapter"><h2 id="prereq" data-toc="add_interpreter_docker_compose#prereq">先决条件</h2>            <p id="9824c3d3">确保满足以下先决条件：</p>                                    <ul class="list _ul"><li class="list__item" id="e60fc8c7">                    <p id="66a4402d">您的网络连接稳定。</p>                    <a name="docker-internet-requirement"></a>            <p id="25d0a9c4">要使用Docker进行操作，您需要在计算机上使用<a href="https://hub.docker.com/_/busybox" rel="noopener noreferrer" data-external="true" target="_blank">busybox</a>映像。确保您具有稳定的Internet连接，以便PyCharm可以下载并运行<code class="code">busybox:latest</code> 。成功配置Docker后，您可以脱机。</p>                    </li><li class="list__item" id="33f1977c">                    <p id="d3ec77d0">Docker已安装。您可以在各种平台上安装Docker，但是在这里我们将使用<a href="https://docs.docker.com/docker-for-windows/" rel="noopener noreferrer" data-external="true" target="_blank">Windows</a>安装。</p>                    <p id="9f678c74">请注意，您可能想在不同的平台上重复本教程。然后将Docker安装用于<a href="https://docs.docker.com/docker-for-mac/" rel="noopener noreferrer" data-external="true" target="_blank">macOS</a>和<a href="https://docs.docker.com/engine/installation/linux/ubuntu/" rel="noopener noreferrer" data-external="true" target="_blank">Linux</a> （Ubuntu，也提供其他与发行版相关的说明）。</p>                </li><li class="list__item" id="285bbed4"><a name="prereq_plural"></a>                        <p id="1135b46d">在开始使用Docker之前，请确保已启用Docker集成和Python Docker插件。插件与PyCharm捆绑在一起，并且默认情况下已激活。如果未激活插件，请在“ <a href="plugins-settings.html">插件”</a>页面上启用它们<a name="open_settings"></a> <span class="control">设置/首选项</span>对话框（ <kbd data-primary_default_for_windows="Ctrl+Alt+S" data-primary_intellij_idea_classic_macos="⌘+Comma" data-primary_default_for_gnome="Ctrl+Alt+S" data-primary_default_for_kde="Ctrl+Alt+S" data-primary_sublime_text="Ctrl+Alt+S" data-primary_eclipse="Ctrl+Alt+S" data-primary_emacs="Ctrl+Alt+S" data-primary_default_for_xwin_windows="N/A" data-secondary_default_for_macos="⌘," data-secondary_default_for_gnome="⌃⌥S" data-secondary_default_for_kde="⌃⌥S" data-secondary_eclipse="⌃⌥S" data-secondary_default_for_xwin_macos="N/A" data-secondary_sublime_text_macos="⌘,">Ctrl+Alt+S</kbd> ），如“ <a href="managing-plugins.html">管理插件”中所述</a> 。</p>        <p id="fd1fd809">如果您正在使用Windows的Docker，请在Docker设置的`` <span class="control">常规''</span>部分中启用<span class="control">tcp：// localhost：2375上没有TLS</span>选项的<span class="control">Expose守护程序</span> 。</p>                    </li></ul>        </div>        <div class="chapter"><h2 id="example" data-toc="add_interpreter_docker_compose#example">准备一个例子</h2>                            <p id="e8698bff">我们实际上可以重复使用与Docker <a href="using-docker-as-a-remote-interpreter.html#example">相同的示例</a> ，但是对于Docker Compose来说，这没有意义-太简单了...</p>                <p id="efe3c7ab">为了显示Docker Compose应用程序的实际示例，我们将使用Django应用程序和在单独容器中运行的PostgreSQL数据库。<a href="https://github.com/ErnstHaagsman/djangodocker" rel="noopener noreferrer" data-external="true" target="_blank">从GitHub获取项目，</a>然后在PyCharm中打开它（ <span class="menupath" data-skip-index="skip">File | Open</span> ）。</p>                <p id="1701b56f">对于这个Django应用程序，我们应该创建两个容器：一个用于数据库，另一个用于应用程序本身。我们将使用Docker Compose将两个容器链接在一起。</p>                                </div>        <div class="chapter"><h2 id="dockerfile" data-toc="add_interpreter_docker_compose#dockerfile">为Docker和Docker Compose添加文件</h2>            <p id="1f3d1f5d">在“项目”工具窗口中，右键单击项目根目录，然后选择“ <span class="menupath" data-skip-index="skip">新建” |“新建”。文件</span> <kbd data-primary_default_for_windows="Alt+Insert" data-primary_intellij_idea_classic_macos="Ctrl+N" data-primary_default_for_gnome="Alt+Insert" data-primary_default_for_kde="Alt+Insert" data-primary_sublime_text="Alt+Insert" data-primary_eclipse="Alt+Insert" data-primary_emacs="Alt+Insert" data-primary_default_for_xwin_windows="N/A" data-secondary_default_for_macos="⌘N" data-secondary_default_for_gnome="N/A" data-secondary_default_for_kde="N/A" data-secondary_eclipse="N/A" data-secondary_default_for_xwin_macos="N/A" data-secondary_sublime_text_macos="⌘N">Alt+Insert</kbd> ，输入文件名（此处为<span class="filepath">Dockerfile</span> ），然后输入以下代码：</p>            <div class="code-block" data-lang="shell">从python：3.6 WORKDIR / app＃首先复制需求，我们确保Docker将缓存＃已安装的需求，而不是在每个构建版本上重新安装它们。COPY requirements.txt /app/requirements.txt RUN pip install -r requirements.txt ＃现在复制我们的代码，然后运行COPY。 / app EXPOSE 8000 CMD [“ python”，“ manage.py”，“ runserver”，“ 0.0.0.0:8000”]</div>                        <p id="docker-compose">接下来，对<span class="filepath">docker-compose.yml</span>文件重复相同的步骤，然后输入以下代码：</p>            <div class="code-block" data-lang="yaml">版本：“ 2”服务：网络：构建：。端口：-“ 8000：8000”卷：-。：/应用链接：-db db：图像：“ postgres：9.6”端口：-“ 5432：5432”环境：POSTGRES_PASSWORD：hunter2</div>                        <p id="d7fa9255">让我们看一下<span class="filepath">docker-compose.yml</span>文件。该文件定义了2个服务： <code class="code">web</code>和<code class="code">db</code> ，并将它们链接在一起。</p>                    </div>        <div class="chapter"><h2 id="configuring-docker" data-toc="add_interpreter_docker_compose#configuring-docker">配置Docker</h2>            <p id="a60bfd54">现在我们已经准备好示例，让我们配置Docker。</p>            <p id="d640d3b7">为此，请打开“设置”对话框（ <kbd data-primary_default_for_windows="Ctrl+Alt+S" data-primary_intellij_idea_classic_macos="⌘+Comma" data-primary_default_for_gnome="Ctrl+Alt+S" data-primary_default_for_kde="Ctrl+Alt+S" data-primary_sublime_text="Ctrl+Alt+S" data-primary_eclipse="Ctrl+Alt+S" data-primary_emacs="Ctrl+Alt+S" data-primary_default_for_xwin_windows="N/A" data-secondary_default_for_macos="⌘," data-secondary_default_for_gnome="⌃⌥S" data-secondary_default_for_kde="⌃⌥S" data-secondary_eclipse="⌃⌥S" data-secondary_default_for_xwin_macos="N/A" data-secondary_sublime_text_macos="⌘,">Ctrl+Alt+S</kbd>或点击<img class="inline-icon-16" src="/help/img/idea/2019.2/icons.general.settings.svg@2x.png" width="16" alt="设定值"> （在主工具栏上），然后单击<span class="control">Build，Execution，Deployment</span>节点下的<a href="docker-connection-settings.html">Docker页面</a> 。请点击<img class="inline-icon-16" src="/help/img/idea/2019.2/icons.general.add.svg@2x.png" width="16" alt="添加一个Docker服务器">创建一个Docker服务器。</p>            <p id="207961dd">接受建议的默认值：</p>            <figure><img alt="Docker设置" title="Docker设置" src="/help/img/idea/2019.2/py_docker_settings.png" id="9d94e050" width="700" height="930"></figure>                        <p id="3ac7bf2d">对于macOS，选择<span class="control">Docker for Mac</span>连接到Docker守护程序。</p>            <figure><img alt="Docker设置" title="Docker设置" src="/help/img/idea/2019.2/py_docker_settings_mac.png" id="3ba794e1" width="700" height="970"></figure>            <aside class="note " rel="3ba794e1" id="f8fa23f2" data-title=""><p><span class="control">路径映射</span>设置在Linux上不可用。因此，如果要将虚拟机上的某些目录映射到本地Linux机器上的某些路径，则必须手动执行。</p></aside>            <p id="67070169">接下来，应用更改。</p>        </div>        <div class="chapter"><h2 id="docker-compose-remote" data-toc="add_interpreter_docker_compose#docker-compose-remote">将Docker Compose配置为远程解释器</h2>            <p id="8c895881">现在让我们基于Docker-Compose定义一个远程解释器。</p>                                                                        <a name="python-installation"></a>        <p id="bd29c29d">确保已在计算机上下载并安装了<a href="https://www.python.org/downloads/" rel="noopener noreferrer" data-external="true" target="_blank">Python</a> 。</p>                    <p id="70483822">通过以下两种方式打开“ <span class="control">添加Python解释器”</span>对话框：</p>                <ul class="list _ul"><li class="list__item" id="45efa5d1"><p>当您在<span class="control">编辑器中时</span> ，最方便的方法是使用<span>状态栏中</span>的<span class="control">Python Interpreter</span>小部件。单击小部件，然后选择<span class="menupath" data-skip-index="skip">添加解释器...</span></p></li><li class="list__item" id="07f84a2f"><p id="b9a1c0e7">如果在“ <span class="control">设置/首选项”</span>对话框中<kbd data-primary_default_for_windows="Ctrl+Alt+S" data-primary_intellij_idea_classic_macos="⌘+Comma" data-primary_default_for_gnome="Ctrl+Alt+S" data-primary_default_for_kde="Ctrl+Alt+S" data-primary_sublime_text="Ctrl+Alt+S" data-primary_eclipse="Ctrl+Alt+S" data-primary_emacs="Ctrl+Alt+S" data-primary_default_for_xwin_windows="N/A" data-secondary_default_for_macos="⌘," data-secondary_default_for_gnome="⌃⌥S" data-secondary_default_for_kde="⌃⌥S" data-secondary_eclipse="⌃⌥S" data-secondary_default_for_xwin_macos="N/A" data-secondary_sublime_text_macos="⌘,">Ctrl+Alt+S</kbd> ，选择<span class="menupath" data-skip-index="skip">项目<project name="">|项目口译员</project></span> 。点击<img class="inline-icon-16" src="/help/img/idea/2019.2/icons.general.gearPlain.svg@2x.png" width="16" alt="配置项目解释器">图标，然后选择<span class="control">添加</span> 。</p></li></ul>                <a name="add_docker-compose"></a>                    <p id="d0ad08bf">在打开的对话框中，选择<span class="control">Docker Compose</span>选项，从下拉列表中选择Docker服务器Docker Compose服务（此处<code class="code">web</code> ），配置文件（此处<code class="code">docker-compose.yml</code> ）和图片名称（此处<code class="code">python</code> ）。</p>                    <p id="5da93eec">为什么选择<code class="code">web</code> ？通过以下事实解释了这一选择：在配置了基于Docker-Compose的解释器之后，我们将能够创建常规运行配置，这将改变我们选择的容器的行为。因此，如果要调试容器中的代码，则应在此处选择该代码。撰写文件中的所有其他容器将始终与此容器一起启动，但是您将无法通过PyCharm影响它们的行为-它们将始终像您使用以下命令启动它们一样<code class="code">docker-compose up</code>从命令行。</p>                    <p id="3b3ca6eb">接下来，等待PyCharm启动Docker-Compose配置以进行扫描和编制索引：</p>                                        <figure><img alt="配置远程Python解释器" title="配置远程Python解释器" src="/help/img/idea/2019.2/py_docker_as_remote.png" id="8bcefdfc" width="700" height="1106"></figure>                                                                    </div>        <div class="chapter"><h2 id="tw" data-toc="add_interpreter_docker_compose#tw">使用Docker工具窗口</h2>            <p id="f95c559e">既然我们已经<a href="#configuring-docker">配置了Docker</a> ，那么<span class="control">服务</span>工具窗口按钮将出现在PyCharm主窗口的底部。单击此按钮，查看您的容器正在运行：</p>            <figure><img alt="Docker视窗" title="Docker视窗" src="/help/img/idea/2019.2/py_docker_running_container.png" id="80d427ce" width="700" height="706"></figure>                    </div>        <div class="chapter"><h2 id="db_Settings" data-toc="add_interpreter_docker_compose#db_Settings">配置数据库凭证</h2>            <p id="c68e5617">修改<code class="code">DATABASES</code> Django项目中<span class="filepath">settings.py</span>文件的“部分”以添加数据库配置详细信息：</p>            <div class="code-block" data-lang="python">数据库= {'默认'：{'引擎'：'django.db.backends.postgresql'，'NAME'：'postgres'，'USER'：'postgres'，'PASSWORD'：'hunter2'，'HOST'： 'D b' } }</div>        </div>        <div class="chapter"><h2 id="run" data-toc="add_interpreter_docker_compose#run">在Docker-Compose下运行您的应用程序</h2>            <p id="a2962ec4">首先，在执行Django应用程序时，我们必须运行迁移。</p>                            <p id="3b26b62c">为此，选择“ <span class="menupath" data-skip-index="skip">工具” |“工具”。运行“ manage.py”任务</span>并输入<code class="code">migrate</code> ：</p>                <figure><img alt="manage.py任务正在Docker中运行" title="manage.py任务正在Docker中运行" src="/help/img/idea/2019.2/py_docker_run_manage_py_task.png" id="0350ae6f" width="700" height="798"></figure>                <p id="19af93f3">（有关详细信息，请参见<a href="running-manage-py.html">manage.py实用程序的运行任务</a> 。）</p>                <p id="9daf46ea">接下来，创建一个普通的Django服务器运行/调试配置。为此，请从主菜单中选择<span class="menupath" data-skip-index="skip">“运行” |“运行”。编辑配置...</span> ；在打开的对话框中，单击<img class="inline-icon-16" src="/help/img/idea/2019.2/icons.general.add.svg@2x.png" width="16" alt="为Django服务器添加运行/调试配置">然后选择<span class="control">Django Server</span> ：</p>                <figure><img alt="Django服务器的运行/调试配置" title="Django服务器的运行/调试配置" src="/help/img/idea/2019.2/py_docker_run_django_server_docker_compose.png" id="049ca43f" width="700" height="1498"></figure>                <p id="2359d93d">                    <span class="emphasis">您唯一需要注意的是，必须将<span class="control">Host</span>字段设置为<span class="filepath">0.0.0.0-</span>以确保我们侦听来自Docker容器外部的请求。</span>                </p>                <p id="aaf959c3">启动此配置（ <span class="menupath" data-skip-index="skip">Run | Run'RunDjangoApp'</span> ）：</p>                <figure><img alt="Docker撰写运行" title="Docker撰写运行" src="/help/img/idea/2019.2/py_docker_compose_run.png" id="4c59ca1d" width="700" height="378"></figure>                <p id="1">要在网络浏览器中查看输出，请访问<a href="http://localhost:8000" rel="noopener noreferrer" data-external="true" target="_blank">http：// localhost：8000</a> （在地址栏中，将<span class="filepath">0.0.0.0</span>更改为<span class="filepath">localhost</span> ）：</p><aside class="tip sideblock" rel="1" id="4ae0331a" data-title="">                    <p id="13ce6fe8">如果您使用的是Docker Machine，请改用该计算机的IP地址。</p>                </aside>                <figure><img alt="Django应用程序输出" title="Django应用程序输出" src="/help/img/idea/2019.2/py_docker_django_app_result.png" id="97ffbba5" width="700" height="289"></figure>                                                </div>                <div class="chapter"><h2 id="summary" data-toc="add_interpreter_docker_compose#summary">摘要</h2>            <p id="fee51a2d">让我们总结一下在PyCharm的帮助下所做的事情：</p>            <ul class="list _ul"><li class="list__item" id="296f938a"><p>我们从GitHub下载了Django应用程序并打开了它。</p></li><li class="list__item" id="91074bc7"><p>我们向项目添加了特定的Docker Compose文件。</p></li><li class="list__item" id="c70b1128"><p>我们基于Docker Compose配置了一个远程解释器。</p></li><li class="list__item" id="b7282d3b"><p>我们在Docker Compose容器中运行Django应用程序。</p></li></ul>        </div>            <div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月6日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="using-docker-as-a-remote-interpreter.html">使用Docker</a> <a class="navigation-links__next" href="installing-uninstalling-and-upgrading-packages.html">安装，卸载和升级软件包</a> <a class="navigation-links__prev" href="using-docker-as-a-remote-interpreter.html">配置远程解释</a> <a class="navigation-links__next" href="installing-uninstalling-and-upgrading-packages.html">器</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="/resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>