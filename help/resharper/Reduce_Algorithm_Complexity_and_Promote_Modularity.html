<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Reduce algorithm complexity and promote modularity - Help | ReSharper</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Reduce_Algorithm_Complexity_and_Promote_Modularity" data-article-props="&#xA;                {&#xA;                &#xA;            &#34;seeAlso&#34;:[&#xA;            &#xA;                {&#34;title&#34;: &#34;Concepts&#34;,&#xA;                 &#34;links&#34;: [&#xA;                &#xA;        {&#34;url&#34;:&#34;Refactor_This.html&#34;,&#34;text&#34;:&#34;Refactor This&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Refactorings__Index.html&#34;,&#34;text&#34;:&#34;Refactorings&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Refactorings__Move__Type_to_Another_Type.html&#34;,&#34;text&#34;:&#34;Move to Another Type refactoring&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Refactorings__Extract_Method.html&#34;,&#34;text&#34;:&#34;Extract Method refactoring&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Refactorings__Extract_Superclass.html&#34;,&#34;text&#34;:&#34;Extract Superclass refactoring&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Code_Analysis__Quick-Fixes.html&#34;,&#34;text&#34;:&#34;Quick-Fixes for Code Issues&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Coding_Assistance__Context_Actions.html&#34;,&#34;text&#34;:&#34;Context Actions&#34;}&#xA;    &#xA;                    ]}&#xA;            ]&#xA;        &#xA;                }&#xA;            " data-disqus-id="Reduce_Algorithm_Complexity_and_Promote_Modularity_10"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>ReSharper 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="secondary" value="rs">ReSharper 2.x/IntelliJ IDEA</option><option data-group="primary" value="vs">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 data-toc="Reduce_Algorithm_Complexity_and_Promote_Modularity" id="Reduce_Algorithm_Complexity_and_Promote_Modularity.xml">Reduce algorithm complexity and promote modularity</h1>    <p id="7d38f9bd">        Just about every developer has found himself in a situation where they had a complicated algorithm in a single,        virtually unreadable method, that was entangled together with other methods in a class. For example, say you        have a general-purpose class for solving equations:    </p>    <div class="code-block" data-lang="csharp">
public class EquationSolvers
{
  public static Tuple&lt;double, double&gt; Quadratic(double a, double b, double c)
  {
    double disc = b*b - 4*a*c;
    if (disc &lt; 0)
      throw new ArgumentException("Cannot solve equation with complex roots");
    double sqrt = Math.Sqrt(disc);
    return new Tuple&lt;double, double&gt;(
      (-b + sqrt) / (2 * a), (-b - sqrt) / (2 * a));
  }

  // other solvers here
}
    </div>    <p id="bc63f46c">        The above equation solver is hard-coded, meaning that to substitute a different solver, you would have to        manually replace each instance. Let’s start by taking it out into a separate class. To do this, we use the        <a href="Refactorings__Move__Type_to_Another_Type.html">Move to Another Type refactoring</a> <kbd data-rs="F6" data-vs="Ctrl+R,O">F6</kbd>:    </p>    <figure><img alt="Modularity with ReSharper" title="Modularity with ReSharper" src="/help/img/dotnet/2019.2/cookbook_modularity1.png" id="3b6818bd" width="592" height="317"></figure>    <p id="600e7f15">        Then, we need to specify the class to move the method to.        In order to separate concerns better, we pick a separate class called        <code class="code">QuadraticEquationSolver</code>        for this:    </p>    <figure><img alt="Modularity with ReSharper" title="Modularity with ReSharper" src="/help/img/dotnet/2019.2/cookbook_modularity2.png" id="6a26c659" width="655" height="346"></figure>    <p id="6d203663">        Now that the method has been moved, let’s try taking the discriminant out to a separate calculation.        This is easy — we select the discriminant calculation and invoke the        <a href="Refactorings__Extract_Method.html">Extract Method refactoring</a> <kbd data-rs="Ctrl+Alt+M" data-vs="Ctrl+R,M">Ctrl+Alt+M</kbd>:    </p>    <figure><img alt="Modularity with ReSharper" title="Modularity with ReSharper" src="/help/img/dotnet/2019.2/cookbook_modularity3.png" id="6b0d6450" width="598" height="230"></figure>    <p id="f8762f7e">        Now, all we need to do is to give the new method a name:    </p>    <figure><img alt="Modularity with ReSharper" title="Modularity with ReSharper" src="/help/img/dotnet/2019.2/cookbook_modularity4.png" id="9caf10fb" width="672" height="592"></figure>    <p id="341aec66">And it’s done:</p><div class="code-block" data-lang="csharp">
private static double CalculateDiscriminant(double a, double b, double c)
{
    return b * b - 4 * a * c;
}
</div>    <p id="2d3364b4">        Now, let’s suppose that, after a while, we find a safer solver for quadratic equations. To factor it into the        program, we’ll first need to create an abstract base class        <code class="code">QuadraticEquationSolverBase</code>. We use the        <a href="Refactorings__Extract_Superclass.html">Extract Superclass refactoring</a> refactoring available in the        <span class="control">Refactor This</span> menu        <kbd data-rs="Ctrl+Shift+R" data-vs="Ctrl+Shift+R">Ctrl+Shift+R</kbd>:    </p>    <figure><img alt="Modularity with ReSharper" title="Modularity with ReSharper" src="/help/img/dotnet/2019.2/cookbook_modularity5.png" id="d95b40cd" width="591" height="308"></figure>    <p id="9928a8df">        In the dialog that shows up, we get to pick which members will be promoted upwards. We only want the        <code class="code">CalculateDiscriminant</code>        method:    </p>    <figure><img alt="Modularity with ReSharper" title="Modularity with ReSharper" src="/help/img/dotnet/2019.2/cookbook_modularity6.png" id="bd226577" width="655" height="399"></figure>    <p id="4510bc0c">        We add an abstract definition of the        <code class="code">Calculate()</code>        method (previously called        <code class="code">Quadratic()</code>) and end up with the        following base class:    </p><div class="code-block" data-lang="csharp">
public abstract class QuadraticEquationSolverBase
{
  protected double CalculateDiscriminant(double a, double b, double c)
  {
    return b*b - 4*a*c;
  }
  public abstract Tuple&lt;double, double&gt; Calculate(double a, double b, double c);
}
</div>    <p id="d66960dd">        We also got rid of the        <code class="code">static</code>        keyword anywhere with the assumption that the implementations of        <code class="code">QuadraticEquationSolverBase</code>        will be handled by a lifetime manager within our code. Consequently, ReSharper        reminds us to add the        <code class="code">override</code> keyword to the renamed        <code class="code">Calculate</code> method in our QuadraticEquationSolver class:    </p>    <figure><img alt="Modularity with ReSharper" title="Modularity with ReSharper" src="/help/img/dotnet/2019.2/cookbook_modularity7.png" id="41ed7588" width="622" height="161"></figure>    <p id="dccef267">        Now, let’s say we found a safer version of the quadratic equation solver. Let’s implement it. First, we use the        <span class="control">Create derived type</span>        <a href="Coding_Assistance__Context_Actions.html">context action</a>        on our base class:    </p>    <p id="5d2032ff">        Then, we are asked to implement members on this type, which we do:    </p>    <p id="86beef22">        Finally, we provide an implementation, making use of the base class’        <code class="code">CalculateDiscriminant()</code>        method:    </p><div class="code-block" data-lang="csharp">
class SafeQuadraticEquationSolver : QuadraticEquationSolverBase
{
  public override Tuple&lt;double, double&gt;  Calculate(double a, double b, double c)
  {
    double disc = CalculateDiscriminant(a, b, c);
    if (disc &lt; 0)
      throw new ArgumentException("Cannot solve equation with complex roots");
    double q = -0.5*(b + Math.Sign(b)*disc);
    return new Tuple&lt;double, double&gt; (q/a, c/q);
  }
}
</div>    <p id="d2c7740f">        And we’re done! Now the quadratic equation solver can be easily used, with its configuration and instantiation        typically handled by an IoC container.    </p>    <div class="last-modified" data-skip-index="skip">Last modified: 18 November 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Quickly_introduce_using_statements_and_try_catch_blocks.html">Quickly introduce using statements and try...catch blocks</a><a class="navigation-links__next" href="Reorder_code_without_the_copypaste_fuss.html">Reorder code without the copy-paste fuss</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>