<html lang="en-US" ><head>
    <meta charset="UTF-8">
    <title>/ ReSharper开发指南</title>
    <link rel="stylesheet" href="/help/resharper/sdk/app/app.css">
    <link rel="shortcut icon" href="/help/resharper/sdk/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-57x57.png" sizes="57x57">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-60x60.png" sizes="60x60">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-72x72.png" sizes="72x72">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-114x114.png" sizes="114x114">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-120x120.png" sizes="120x120">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-144x144.png" sizes="144x144">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-152x152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-180x180.png" sizes="180x180">
    <link rel="mask-icon" href="/help/resharper/sdk/apple-mask-icon.svg" color="black">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-square70x70logo" content="/help/resharper/sdk/mstile-70x70.png">
    <meta name="msapplication-TileImage" content="/help/resharper/sdk/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="/help/resharper/sdk/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/help/resharper/sdk/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/help/resharper/sdk/mstile-310x310.png">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Documentation for writing extensions for ReSharper">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.jetbrains.com/help/resharper/sdk//Platform/Logging/AdvancedConfiguration.html">
    <meta property="og:site_name" content="JetBrains ReSharper">
    <meta property="og:title" content="">
    <meta property="og:description" content="Documentation for writing extensions for ReSharper">
    <meta property="og:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png">
    <meta property="article:modified_time" content="2016-01-07T00:33:04+00:00">
    <!-- <meta property="article:section" content="" /> 
    <meta property="article:tag" content="" /> -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@JBPlatform">
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="Documentation for writing extensions for ReSharper">
    <meta name="twitter:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png">
    <meta class="swiftype" name="product" data-type="string" content="/help/resharper/sdk/">
<link rel="stylesheet" href="/help/resharper/sdk/app/styles.css"></head>
<body  data-id="Platform/Logging/AdvancedConfiguration">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label class="search-box__label" for="search-box__input">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="搜索ReSharper DevGuide">
                    </label>
                    <div class="search-box__clear" title="明确"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="//youtrack.jetbrains.com/issues/IJSDK" data-bypass="true">发送反馈</a></p>
                <p>©2000–2018 <a href="//www.jetbrains.com">JetBrains</a> sro<br>版权所有。</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper开发指南</h3>
                
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">
                    <div class="navigation-links _top" data-swiftype-index="false">
                        
                        
                    </div>
                    <a href="https://github.com/JetBrains/resharper-devguide/edit/master/Platform/Logging/AdvancedConfiguration.md" class="page-link-to-github" rel="noopener noreferrer" title="在GitHub上编辑此页面" data-bypass="true" target="_blank"><i class="github-icon"></i> <span class="text">编辑页面</span></a> <a name="advanced-configuration" class="elem-anchor"></a>
<h1>进阶设定<a href="#advanced-configuration" class="anchor-link"><span></span></a></h1>

<p>尽管可以在命令行上启用日志记录，但是指定配置文件可以使日志记录更加灵活。该文件是一个名为<code class="code highlight language-text">LogConfiguration.xml</code> ，应在中创建<code class="code highlight language-text">%LOCALAPPDATA%\JetBrains\{HostFullIdentifier}\v{WaveVersion}</code> 。</p>

<aside class="note">
  <p>的<code class="code highlight language-text">{HostFullIdentifier}</code>是当前主机的安装文件夹的名称，例如<code class="code highlight language-text">ReSharperPlatformVs12</code>适用于Visual Studio 2013。可以在“ <a href="/help/resharper/sdk/Extensions/Deployment/InstallProcess/HostIdentifiers.html"><span>主机标识符</span></a> ”部分中找到更多详细信息。同样， <code class="code highlight language-text">{WaveVersion}</code>是<a href="/help/resharper/sdk/Extensions/PlatformVersioning.html"><span>ReSharper Platform Wave</span></a>的版本，例如<code class="code highlight language-text">v05</code>对于ReSharper 10.0或<code class="code highlight language-text">v04</code>适用于ReSharper 9.2。</p>
</aside>

<p>在<a href="/help/resharper/sdk/Extensions/Deployment/LocalInstallation/ExperimentalInstance.html"><span>Visual Studio</span></a>的<a href="/help/resharper/sdk/Extensions/Deployment/LocalInstallation/ExperimentalInstance.html"><span>实验实例中</span></a>运行ReSharper Platform时，日志记录子系统还将查找名为<code class="code highlight language-text">LogConfiguration.Debug.xml</code> ，为调试实验实例中的扩展程序提供了单独的配置。首先寻找该文件，如果不存在，则<code class="code highlight language-text">LogConfiguration.xml</code>文件代替。</p>

<aside class="tip">
  <p>一个单独的日志文件也可以用于测试。测试主机使用“ Tests”作为主机标识符，并使用“ Test”作为文件名中的子配置后缀，这意味着测试将查找名为<code class="code highlight language-text">LogConfiguration.Test.xml</code>在里面<code class="code highlight language-text">%LOCALAPPDATA%\JetBrains\Tests\v{WaveVersion}</code>夹。如果该文件不存在，它将寻找<code class="code highlight language-text">LogConfiguration.xml</code>在同一文件夹中。</p>
</aside>

<p>设置日志文件的最佳方法是通过“ <a href="/help/resharper/sdk/Platform/Logging.html#logging-options-page"><span>日志记录选项”页</span></a> ， <a href="/help/resharper/sdk/Platform/Logging.html#logging-options-page"><span>该页</span></a>仅在“ <a href="/help/resharper/sdk/Extensions/InternalMode.html"><span>内部模式”下</span></a>可见。</p>

<p>文件格式非常简单：</p>

<div class="code-block" data-lang="xml"><code class="code-block__wrapper"><span class="nt"><configuration></span> <span class="nt"><appender</span> <span class="na">name=</span><span class="s">"file"</span> <span class="na">class=</span><span class="s">"JetBrains.Util.Logging.FileLogEventListener"</span><span class="nt">></span> <span class="nt"><arg></span>c:\logs\resharper-{date}.log<span class="nt"></arg></span> <span class="nt"></appender></span> <span class="nt"><root</span> <span class="na">level=</span><span class="s">"VERBOSE"</span><span class="nt">></span> <span class="nt"><appender-ref></span>file<span class="nt"></appender-ref></span> <span class="nt"></root></span> <span class="nt"><logger</span> <span class="na">name=</span><span class="s">"JetBrains.Platform.Util"</span> <span class="na">level=</span><span class="s">"OFF"</span> <span class="nt">/></span> <span class="nt"><logger</span> <span class="na">name=</span><span class="s">"JetBrains.DataFlow"</span> <span class="na">level=</span><span class="s">"TRACE"</span> <span class="na">additivity=</span><span class="s">"false"</span><span class="nt">></span> <span class="nt"><appender-ref></span>file<span class="nt"></appender-ref></span> <span class="nt"></logger></span> <span class="nt"></configuration></span></code></div>

<p>的<code class="code highlight language-text">appender</code>元素定义了一个添加程序/监听器，该类是侦听事件并输出事件的类。</p>

<ul>
  <li><code class="code highlight language-text">name</code> -的<code class="code highlight language-text">name</code>属性是必需的，以便稍后可以在文件中引用该追加程序。</li>
  <li><code class="code highlight language-text">class</code> -的<code class="code highlight language-text">class</code> attribute是appender类的完全限定类型名称。该类必须实现<code class="code highlight language-text">ILogEventListener</code>接口。</li>
  <li><code class="code highlight language-text">pattern</code> -的<code class="code highlight language-text">pattern</code>属性（未显示）定义了一种模式，可用于定义消息的输出模式。有关更多详细信息，请参见<a href="#appender-patterns"><span>下文</span></a> 。</li>
  <li><code class="code highlight language-text">arg</code> -的<code class="code highlight language-text">arg</code>元素用于将参数传递给附加程序的构造函数。多个孩子<code class="code highlight language-text">arg</code>元素是允许的，并作为字符串按原样传递给附加程序。由附加器来解释参数值。例如， <code class="code highlight language-text">FileLogEventListener</code>将用值替换当前日期<code class="code highlight language-text">C:\logs\resharer-{date}.log</code> 。</li>
</ul>

<p>的<code class="code highlight language-text">root</code>元素定义了适用于所有类别的日志记录级别和附加程序，除非另有覆盖。这是设置平台日志记录详细信息的默认方法。</p>

<ul>
  <li><code class="code highlight language-text">level</code> -这是记录级别，以文本形式。请参阅<a href="/help/resharper/sdk/Platform/Logging.html#logging-levels"><span>此处</span></a>以获取日志记录级别列表。</li>
  <li><code class="code highlight language-text">appender-ref</code> -的<code class="code highlight language-text">appender-ref</code>子元素指定用于记录事件的附加程序的名称。需要在以下位置创建附加程序<code class="code highlight language-text">appender</code>文件开头的元素。</li>
</ul>

<p>的<code class="code highlight language-text">logger</code>元素定义日志记录级别和用于类别的附加程序。创建记录器时，代码可以指定类别，通常是名称空间。这允许针对平台的不同部分以不同的方式配置日志记录。例如， <code class="code highlight language-text">JetBrains.Platform.Util</code>类别可以设置为<code class="code highlight language-text">OFF</code>禁用组件中的所有日志记录<code class="code highlight language-text">JetBrains.Platform.Util</code>命名空间，或<code class="code highlight language-text">JetBrains.DataFlow</code>可以将名称空间配置为输出到其他文件，并在不同的日志记录级别捕获事件。</p>

<ul>
  <li><code class="code highlight language-text">name</code> -的<code class="code highlight language-text">name</code>需要属性来指定要配置的类别。</li>
  <li><code class="code highlight language-text">level</code> -的<code class="code highlight language-text">level</code>属性允许覆盖<code class="code highlight language-text">root</code>日志记录级别。</li>
  <li><code class="code highlight language-text">additivity</code> -的<code class="code highlight language-text">additivity</code> attribute是一个布尔值，用于控制是否将先前声明的附加程序也用于此类别。默认值为<code class="code highlight language-text">true</code> 。</li>
  <li><code class="code highlight language-text">appender-ref</code> -的<code class="code highlight language-text">appender-ref</code>子元素可用于指定一个或多个将用于输出日志事件的附加程序。可以指定多个元素。必须在以下位置指定所有附加程序<code class="code highlight language-text">appender</code>文件开头的元素。</li>
</ul>

<p>ReSharper平台将自动获取对文件的更改，而无需重新启动。</p>

<a name="built-in-appenders" class="elem-anchor"></a>
<h3>内置附件<a href="#built-in-appenders" class="anchor-link"><span></span></a></h3>

<p>ReSharper平台附带了许多附加程序：</p>

<ul>
  <li><code class="code highlight language-text">JetBrains.Util.Logging.DebugOutputLogEventListener</code>使用以下命令将日志事件输出到连接的调试器<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa363362.aspx" rel="noopener noreferrer" data-external="true" target="_blank"><span><code class="code highlight language-text">OutputDebugString</code></span></a>方法。
    <ul>
      <li>它可以接受一个字符串参数，该参数定义在每个事件之前要输出的前缀。</li>
    </ul>
  </li>
  <li><code class="code highlight language-text">JetBrains.Util.Logging.FileLogEventListener</code>将日志事件输出到文件。
    <ul>
      <li>它需要一个字符串参数指定文件路径。它将处理字符串并替换特殊变量以使日志文件唯一。
        <ul>
          <li><code class="code highlight language-text">{pid}</code> -进程ID</li>
          <li><code class="code highlight language-text">{pname}</code> -进程名称</li>
          <li><code class="code highlight language-text">{temp}</code> -通往的完整路径<code class="code highlight language-text">%TEMP%</code>夹。</li>
          <li><code class="code highlight language-text">{date}</code> -当前日期。</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><code class="code highlight language-text">JetBrains.Util.Logging.MessageBoxListener</code>当事件的消息与给定的正则表达式匹配时，将显示一个消息框。
    <ul>
      <li>它需要两个字符串参数。第一个是必须与事件消息匹配的正则表达式。第二个是事件匹配时要显示的文本。</li>
    </ul>
  </li>
  <li><code class="code highlight language-text">LogEventListener</code>是一个将调用给定的监听器<code class="code highlight language-text">Action<LogEvent></code>记录事件时。它不打算从配置文件中使用，而是从代码中使用。</li>
  <li><code class="code highlight language-text">TextWriterLogEventListener</code>也旨在由代码使用，将事件写入给定<code class="code highlight language-text">TextWriter</code> 。</li>
  <li><code class="code highlight language-text">ConsoleToolLogger</code> ， <code class="code highlight language-text">MsBuildToolLogger</code>和<code class="code highlight language-text">TeamCityToolLogger</code>在命令行中，作为MSBuild任务或在Team City中运行时，命令行工具都使用它们来记录事件。它们由控制台主机自动配置。</li>
</ul>

<a name="appender-patterns" class="elem-anchor"></a>
<h3>追加模式<a href="#appender-patterns" class="anchor-link"><span></span></a></h3>

<p>的<code class="code highlight language-text">pattern</code>的属性<code class="code highlight language-text">appender</code>元素可用于格式化日志消息。控制序列以百分比符号开头<code class="code highlight language-text">%</code>可用于替代参数，例如<code class="code highlight language-text">%L</code>用日志级别替换。</p>

<ul>
  <li><code class="code highlight language-text">%d</code> -日期。接受大括号中的option参数。例如<code class="code highlight language-text">%d{hh:mm:ss}</code></li>
  <li><code class="code highlight language-text">%m</code> - 原始信息。</li>
  <li><code class="code highlight language-text">%M</code> -消息，包括堆栈跟踪的异常（如果存在）。</li>
  <li><code class="code highlight language-text">%e</code> -短暂的例外。</li>
  <li><code class="code highlight language-text">%E</code> -长期例外。</li>
  <li><code class="code highlight language-text">%n</code> - 新队。</li>
  <li><code class="code highlight language-text">%l</code> -日志级别的第一个字符，例如<code class="code highlight language-text">V</code>对于<code class="code highlight language-text">VERBOSE</code> 。</li>
  <li><code class="code highlight language-text">%L</code> -日志级别。</li>
  <li><code class="code highlight language-text">%c</code> -类别（即名称空间）。在花括号中接受可选参数以限制名称空间段的长度，例如<code class="code highlight language-text">%c{2}</code>将输出类别<code class="code highlight language-text">A.B.C.D</code>如<code class="code highlight language-text">C.D</code> 。</li>
  <li><code class="code highlight language-text">%t</code> -线程ID。</li>
  <li><code class="code highlight language-text">%T</code> -线程名称。</li>
  <li><code class="code highlight language-text">%p</code> -进程ID。</li>
  <li><code class="code highlight language-text">%P</code> -进程名称。</li>
</ul>

<p>同样，可以在百分比符号和控制字符之间指定参数的宽度，例如<code class="code highlight language-text">%{min}.{max}c</code>将确保输出值至少<code class="code highlight language-text">{min}</code>字符和最多<code class="code highlight language-text">{max}</code> 。如果字符少于<code class="code highlight language-text">{min}</code> ，该文本右对齐（用前导空格填充）。通过为指定负数<code class="code highlight language-text">{min}</code> ，则该文本左对齐（后缀空格）。</p>



                    <div class="navigation-links _bottom" data-swiftype-index="false">
                        
                        
                    </div>
                    <div class="last-modified">上次修改时间：2016年1月7日</div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>

<script src="/help/resharper/sdk/app/app.js" data-baseurl="/help/resharper/sdk/"></script>




</body></html>