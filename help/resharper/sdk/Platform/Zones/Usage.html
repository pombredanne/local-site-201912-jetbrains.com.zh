


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>Usage / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/help/resharper/sdk/app/app.css">
    <link rel="shortcut icon" href="/help/resharper/sdk/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="57x57" href="/help/resharper/sdk/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/help/resharper/sdk/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/help/resharper/sdk/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/help/resharper/sdk/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/help/resharper/sdk/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/help/resharper/sdk/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/help/resharper/sdk/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/help/resharper/sdk/apple-touch-icon-180x180.png">
    <link rel="mask-icon" href="/help/resharper/sdk/apple-mask-icon.svg" color="black">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-square70x70logo" content="/help/resharper/sdk/mstile-70x70.png">
    <meta name="msapplication-TileImage" content="/help/resharper/sdk/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="/help/resharper/sdk/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/help/resharper/sdk/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/help/resharper/sdk/mstile-310x310.png">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Documentation for writing extensions for ReSharper" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.jetbrains.com/help/resharper/sdk//Platform/Zones/Usage.html" />
    <meta property="og:site_name" content="JetBrains ReSharper" />
    <meta property="og:title" content="Usage" />
    <meta property="og:description" content="Documentation for writing extensions for ReSharper" />
    <meta property="og:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png" />
    <meta property="article:modified_time" content="2017-07-10T19:28:42+00:00" />
    <!-- <meta property="article:section" content="" /> 
    <meta property="article:tag" content="" /> -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@JBPlatform" />
    <meta name="twitter:title" content="Usage" />
    <meta name="twitter:description" content="Documentation for writing extensions for ReSharper" />
    <meta name="twitter:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png" />
    <meta class="swiftype" name="product" data-type="string" content="/help/resharper/sdk/"></meta>
<link  rel="stylesheet" href="/help/resharper/sdk/app/styles.css"></head>
<body data-id="Platform/Zones/Usage">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a data-bypass="true" href="//youtrack.jetbrains.com/issues/IJSDK">Send feedback</a></p>
                <p>&copy; 2000&ndash;2018 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">
                    <div class="navigation-links _top" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/Platform/Zones/Implementation.html">Implementation</a>
                        <a class="navigation-links__next" href="/Platform/Zones/FeaturesProducts.html">Features and Products</a>
                    </div>
                    <a data-bypass="true" href="https://github.com/JetBrains/resharper-devguide/edit/master/Platform/Zones/Usage.md" class="page-link-to-github" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub">
                        <i class="github-icon"></i>
                        <span class="text">Edit page</span>
                    </a>

                    <h1>Usage</h1>
                    <p>Each component must be marked as belonging to one or more zones before it will be added to the Component Model. Zones are declared with zone definition types, and zone markers are used to associate components with zone definitions.</p>

<a name="zone-definitions" class="elem-anchor"></a>
<h2>Zone definitions<a href="#zone-definitions" class="anchor-link"><span></span></a></h2>

<p>A zone is declared by a type implementing the empty <code class="code highlight language-text">IZone</code> marker interface, and decorated with the <code class="code highlight language-text">[ZoneDefinition]</code> attribute. The type can be a class or an interface, with no significance attached to the choice, although it has implications on inheritance. The simplest definition declares a zone with no dependencies:</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="na">[ZoneDefinition]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">ISimpleZone</span> <span class="p">:</span> <span class="n">IZone</span>
<span class="p">{</span>
<span class="p">}</span>
</code></div>

<p>Zone definitions are hierarchical, and can specify dependencies on other zones that are required in order for that zone to work. For example, the <code class="code highlight language-text">IPsiLanguageZone</code> requires the <code class="code highlight language-text">PsiFeaturesImplZone</code> which in turn requires the <code class="code highlight language-text">ITextControlsZone</code>, <code class="code highlight language-text">IProjectModelZone</code> and <code class="code highlight language-text">IDocumentModelZone</code>. Any component that requires the <code class="code highlight language-text">IPsiLanguageZone</code> implicitly also requires all of its dependencies. All zone definitions in this dependency hierarchy must be active for the component to be added to the Component Model.</p>

<p>The above example declares a zone with no dependencies - all components that belong to this zone can be instantiated without requiring any other zone to be active.</p>

<p>Dependencies can be defined either by inheritance or by implementing the <code class="code highlight language-text">IRequire&lt;TZone&gt;</code> interface. The two methods are essentially the same, except inheritance also implies that depending zones are automatically activated. This is discussed in more detail in the <a href="Activation.html"><span>Activation</span></a> section. Generally speaking, unless there is an “is-a” relationship between zones (e.g. <code class="code highlight language-text">ILanguageCSharpZone</code> is-a <code class="code highlight language-text">IPsiLanguageZone</code>) dependencies should be implemented with the <code class="code highlight language-text">IRequire&lt;TZone&gt;</code> marker interface. The two approaches can be mixed, as appropriate.</p>

<p>If a zone definition is expected to be inherited, it makes sense to implement it as an interface. In this way, the inheriting zone definition has the ability to inherit from multiple zones. If the base zone definition is a class, the inheriting zone definition can only inherit a single zone.</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="na">[ZoneDefinition]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IMyZone</span> <span class="p">:</span> <span class="n">IZone</span><span class="p">,</span> <span class="n">IRequire</span><span class="p">&lt;</span><span class="n">NavigationZone</span><span class="p">&gt;</span>
<span class="p">{</span>
<span class="p">}</span>
</code></div>

<p>This example states that <code class="code highlight language-text">IMyZone</code> has a dependency on <code class="code highlight language-text">NavigationZone</code> (and transitively, on anything that <code class="code highlight language-text">NavigationZone</code> depends on, such as the PSI, results lists and options dialogs).</p>

<p>A zone definition has to be activated before it can be used. Typically, the owning product will be responsible for activating all of the zones in the product. For example, the <code class="code highlight language-text">ReSharperZonesActivator</code> activates all zones used by ReSharper. When creating an extension that just consumes zones, activation is not needed, as the consumed zones will already be activated (or not, in which case the extension should not, and will not be loaded). However, if the extension creates zone definitions, it must activate them. This can be done either with explicitly with an activator class, or via the <code class="code highlight language-text">ZoneFlags.AutoEnable</code> parameter to the <code class="code highlight language-text">ZoneDefinitionAttribute</code> constructor. More details, including the differences between the approaches, can be found in the <a href="Activation.html"><span>Activation</span></a> guide.</p>

<a name="zone-markers" class="elem-anchor"></a>
<h2>Zone markers<a href="#zone-markers" class="anchor-link"><span></span></a></h2>

<p>Zone markers are used to declare that a component belongs to one or more zones. This means that the component can only be instantiated if all of those zones (and transitively, all dependent zones) are active in the product.</p>

<p>A zone marker is a class that has been decorated with the <code class="code highlight language-text">[ZoneMarker]</code> attribute, and <strong>must</strong> be named <code class="code highlight language-text">ZoneMarker</code>, or have a name that ends <code class="code highlight language-text">_ZoneMarker</code>. All dependencies are listed either by implementing the <code class="code highlight language-text">IRequire&lt;TZone&gt;</code> interface, or by passing the zone definitions to the <code class="code highlight language-text">ZoneMarkerAttribute</code> constructor. There is no difference in the approach.</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="k">namespace</span> <span class="nn">Foo.Bar</span>
<span class="p">{</span>
  <span class="p">[</span><span class="n">ZoneMarker</span><span class="p">]</span>
  <span class="k">public</span> <span class="k">class</span> <span class="nc">ZoneMarker</span> <span class="p">:</span> <span class="n">IRequire</span><span class="p">&lt;</span><span class="n">IMyZone</span><span class="p">&gt;</span>
  <span class="p">{</span>
  <span class="p">}</span>

  <span class="c1">// or...</span>
  <span class="c1">// [ZoneMarker(typeof(IMyZone))]</span>
  <span class="c1">// public class ZoneMarker</span>
  <span class="c1">// {</span>
  <span class="c1">// }</span>
<span class="p">}</span>
</code></div>

<p>This example declares that the <code class="code highlight language-text">Foo.Bar</code> namespace belongs to the <code class="code highlight language-text">IMyZone</code> zone. All components in the <code class="code highlight language-text">Foo.Bar</code> namespace and below (e.g. both <code class="code highlight language-text">Foo.Bar.ThisComponent</code> and <code class="code highlight language-text">Foo.Bar.Baz.Quux.ThatComponent</code>) require the <code class="code highlight language-text">IMyZone</code> zone, and all of its dependencies to be active, or they do not get added to the Component Model.</p>

<p>Multiple dependencies can be applied to the zone marker, meaning the components in the zone require multiple zones for their implementation. For example, a JavaScript unit test runner will require both the <code class="code highlight language-text">IUnitTestingZone</code> and the <code class="code highlight language-text">ILanguageJavaScriptZone</code>.</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="k">namespace</span> <span class="nn">Foo.Bar.JavaScriptTestRunner</span>
<span class="p">{</span>
  <span class="p">[</span><span class="n">ZoneMarker</span><span class="p">]</span>
  <span class="k">public</span> <span class="k">class</span> <span class="nc">ZoneMarker</span> <span class="p">:</span> <span class="n">IRequire</span><span class="p">&lt;</span><span class="n">IUnitTestingZone</span><span class="p">&gt;,</span> <span class="n">IRequire</span><span class="p">&lt;</span><span class="n">ILanguageJavaScriptZone</span><span class="p">&gt;</span>
  <span class="p">{</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></div>

<p>Creating a zone marker with multiple dependencies can be considered an “anonymous” or “implicit” zone, made up of the listed dependencies, rather than explicitly defined with a zone definition class. Typically, this should only be used when the components that make up the zone are only to be used for end user facing features. There is no need for an explicit zone definition, because nobody needs to depend on these components and therefore include the zone in an <code class="code highlight language-text">IRequire&lt;TZone&gt;</code>.</p>

<p>However, if the components are expected to be used by another zone (that is, the feature is an internal, code facing feature) then a zone definition should be created that encapsulates the dependencies. The zone marker should then only require this single, new zone definition, and no others. This gives depending code a zone definition it can require. Failure to do this means error prone repetition of zone dependencies in the dependent zones.</p>

<p>Put another way, consider the dependencies of a zone to be an implementation detail. Do not require depending code to know your dependencies in order to consume your components - provide a zone definition.</p>

<a name="class-zone-marker" class="elem-anchor"></a>
<h3>Class zone marker<a href="#class-zone-marker" class="anchor-link"><span></span></a></h3>

<p>The <code class="code highlight language-text">ZoneMarker</code> class and <code class="code highlight language-text">[ZoneMarker]</code> attribute apply to all types in a namespace. It is possible to apply a single class to a zone, by applying the <code class="code highlight language-text">[ZoneMarker]</code> attribute directly to a component class. Usage is exactly the same, either specify dependencies as parameters to the <code class="code highlight language-text">[ZoneMarker]</code> constructor, or implement <code class="code highlight language-text">IRequire&lt;TZone&gt;</code> directly on the component for each dependency.</p>

<p>Generally speaking, most registration will use <code class="code highlight language-text">ZoneMarker</code> classes to apply a zone to all components in a namespace.</p>

<a name="empty-zone-marker" class="elem-anchor"></a>
<h3>Empty zone marker<a href="#empty-zone-marker" class="anchor-link"><span></span></a></h3>

<p>A namespace can be marked with an empty zone marker, meaning it is zone aware, but does not require any other zone.</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="k">namespace</span> <span class="nn">Foo.Bar</span>
<span class="p">{</span>
  <span class="p">[</span><span class="n">ZoneMarker</span><span class="p">]</span>
  <span class="k">public</span> <span class="k">class</span> <span class="nc">ZoneMarker</span>
  <span class="p">{</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></div>

<p>All components in the <code class="code highlight language-text">Foo.Bar</code> namespace and below are now zone aware, but do not require any other zones to be active. The component model filter will always allow these components through the zone filter. They are assumed to be infrastructure components, that is, essential to the correct running of the product, and always required.</p>

<a name="example" class="elem-anchor"></a>
<h3>Example<a href="#example" class="anchor-link"><span></span></a></h3>

<p>When creating the component containers, the Component Model applies the zone filter to every part, and checks that each part belongs to one or more active zone. It will walk the namespace segments of the type name of the part, and check for zones at each level. If there are any zones attached to that namespace, then all zones must be active, or the part is not included in the container. The filter will walk every segment in the namespace, and all zones in all namespace segments must be active, or the part is not included. If there are no zones specified for the part, it is not included.</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="c1">// The namespace of the zone definition is irrelevant</span>
<span class="na">[ZoneDefinition]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="nc">IMyZone</span> <span class="p">:</span> <span class="n">IDependentZone</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">namespace</span> <span class="nn">Foo.Bar</span>
<span class="p">{</span>
  <span class="p">[</span><span class="n">ZoneMarker</span><span class="p">]</span>
  <span class="k">public</span> <span class="k">class</span> <span class="nc">ZoneMarker</span> <span class="p">:</span> <span class="n">IZone</span><span class="p">,</span> <span class="n">IRequire</span><span class="p">&lt;</span><span class="n">IMyZone</span><span class="p">&gt;</span>
  <span class="p">{</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">namespace</span> <span class="nn">Foo.Bar.Baz</span>
<span class="p">{</span>
  <span class="p">[</span><span class="n">ShellComponent</span><span class="p">]</span>
  <span class="k">public</span> <span class="k">class</span> <span class="nc">MyComponent</span>
  <span class="p">{</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></div>

<p>Given the code above, when evaluating the <code class="code highlight language-text">MyComponent</code> part type, the filter will:</p>

<ul>
  <li>Look for any zones at the <code class="code highlight language-text">Foo</code> namespace. None are defined, so continue.</li>
  <li>Look for any zones at the <code class="code highlight language-text">Foo.Bar</code> namespace. The <code class="code highlight language-text">Foo.Bar.ZoneMarker</code> class has applied the <code class="code highlight language-text">IMyZone</code> zone to this namespace.
    <ul>
      <li>The <code class="code highlight language-text">Foo.Bar.ZoneMarker</code> class has applied the <code class="code highlight language-text">IMyZone</code> zone to this namespace.</li>
      <li>The transitive dependency <code class="code highlight language-text">IDependentZone</code> is automatically also applied to this namespace.</li>
      <li>If <code class="code highlight language-text">IMyZone</code> is not active, the part is immediately rejected, and <code class="code highlight language-text">MyComponent</code> is not included in the container.</li>
      <li>Perform the same check for <code class="code highlight language-text">IDependentZone</code>. It must be active, or the component is rejected.</li>
    </ul>
  </li>
  <li>Look for any zones in the <code class="code highlight language-text">Foo.Bar.Baz</code> namespace. None are defined, so continue.</li>
  <li>There are no more namespace segments. Because zones were encountered (and since the component hasn’t already been rejected), the part is included in the container. If no zones were encountered, the part is rejected.</li>
</ul>



                    <div class="navigation-links _bottom" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/Platform/Zones/Implementation.html">Implementation</a>
                        <a class="navigation-links__next" href="/Platform/Zones/FeaturesProducts.html">Features and Products</a>
                    </div>
                    <div class="last-modified">
                        Last modified: 10 July 2017
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>

<script src="/help/resharper/sdk/app/app.js" data-baseurl="/help/resharper/sdk/"></script>

</body>
</html>

