<html lang="en-US" ><head>
    <meta charset="UTF-8">
    <title>/ ReSharper开发指南</title>
    <link rel="stylesheet" href="/help/resharper/sdk/app/app.css">
    <link rel="shortcut icon" href="/help/resharper/sdk/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-57x57.png" sizes="57x57">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-60x60.png" sizes="60x60">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-72x72.png" sizes="72x72">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-114x114.png" sizes="114x114">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-120x120.png" sizes="120x120">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-144x144.png" sizes="144x144">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-152x152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-180x180.png" sizes="180x180">
    <link rel="mask-icon" href="/help/resharper/sdk/apple-mask-icon.svg" color="black">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-square70x70logo" content="/help/resharper/sdk/mstile-70x70.png">
    <meta name="msapplication-TileImage" content="/help/resharper/sdk/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="/help/resharper/sdk/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/help/resharper/sdk/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/help/resharper/sdk/mstile-310x310.png">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Documentation for writing extensions for ReSharper">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.jetbrains.com/help/resharper/sdk//Platform/Shell/Icons/ConsumingIcons.html">
    <meta property="og:site_name" content="JetBrains ReSharper">
    <meta property="og:title" content="">
    <meta property="og:description" content="Documentation for writing extensions for ReSharper">
    <meta property="og:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png">
    <meta property="article:modified_time" content="2016-03-26T00:43:24+00:00">
    <!-- <meta property="article:section" content="" /> 
    <meta property="article:tag" content="" /> -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@JBPlatform">
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="Documentation for writing extensions for ReSharper">
    <meta name="twitter:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png">
    <meta class="swiftype" name="product" data-type="string" content="/help/resharper/sdk/">
<link rel="stylesheet" href="/help/resharper/sdk/app/styles.css"></head>
<body  data-id="Platform/Shell/Icons/ConsumingIcons">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label class="search-box__label" for="search-box__input">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="搜索ReSharper DevGuide">
                    </label>
                    <div class="search-box__clear" title="明确"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="//youtrack.jetbrains.com/issues/IJSDK" data-bypass="true">发送反馈</a></p>
                <p>©2000–2018 <a href="//www.jetbrains.com">JetBrains</a> sro<br>版权所有。</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper开发指南</h3>
                
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">
                    <div class="navigation-links _top" data-swiftype-index="false">
                        
                        
                    </div>
                    <a href="https://github.com/JetBrains/resharper-devguide/edit/master/Platform/Shell/Icons/ConsumingIcons.md" class="page-link-to-github" rel="noopener noreferrer" title="在GitHub上编辑此页面" data-bypass="true" target="_blank"><i class="github-icon"></i> <span class="text">编辑页面</span></a> <a name="consuming-icons" class="elem-anchor"></a>
<h1>消费图标<a href="#consuming-icons" class="anchor-link"><span></span></a></h1>

<p>ReSharper提供了多种使用图标的方式，从WPF控件以显示图标，到API以获取与Windows Forms兼容的位图或WPF。 <code class="code highlight language-text">ImageSource</code> 。</p>

<p>API的主要入口点是<code class="code highlight language-text">IThemedIconManager</code>接口，可以将其作为构造函数参数导入到<code class="code highlight language-text">[ShellComponent]</code>要么<code class="code highlight language-text">[SolutionComponent]</code> 。它提供以下成员：</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="k">public</span> <span class="k">interface</span> <span class="nc">IThemedIconManager</span> <span class="p">{</span> <span class="n">IProperty</span><span class="p"><</span><span class="n">IconTheme</span><span class="p">></span> <span class="n">CurrentIconTheme</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span> <span class="n">ThemedIconManagerIcons</span> <span class="n">Icons</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span> <span class="n">IThemedIconManagerRawApi</span> <span class="nf">GetRawApi</span><span class="p">();</span> <span class="p">}</span></code></div>

<p>的<code class="code highlight language-text">CurrentIconTheme</code>属性将返回一个可观察的属性，其中包含当前的图标主题，可以检索该主题以进行检查或订阅，以了解主题何时更改。有关更多详细信息，请参见<a href="/help/resharper/sdk/Platform/Shell/Theming/Icons.html"><span>图标主题部分</span></a> 。 <code class="code highlight language-text">IconTheme</code> 。</p>

<p>的<code class="code highlight language-text">GetRawApi</code>该方法仅供内部使用。</p>

<p>Icons属性返回的实例<code class="code highlight language-text">ThemedIconManagerIcons</code> ，可以用来获取<code class="code highlight language-text">ThemedIconLoader</code> ，而后者又负责加载和缓存图像。</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="kt">var</span> <span class="n">loader</span> <span class="p">=</span> <span class="n">manager</span><span class="p">.</span><span class="n">Icons</span><span class="p">[</span><span class="n">myIconId</span><span class="p">];</span></code></div>

<p>一旦你有一个<code class="code highlight language-text">ThemedIconLoader</code> ，以下属性将检索位图和<code class="code highlight language-text">ImageSource</code> ，它可以基于当前主题，也可以是一个实时的，可观察的属性，可以在主题更改时更新。</p>

<ul>
  <li><strong><code class="code highlight language-text">CurrentGdipBitmapScreenDpi</code></strong>返回一个<code class="code highlight language-text">System.Drawing.Bitmap</code>用于当前主题的图标，用于Windows窗体。该图标将在当前屏幕DPI上呈现，因此将在高DPI情况下正常工作。建议超过<code class="code highlight language-text">CurrentGdipBitmap96</code>属性，该图标在96 DPI时呈现图标，在高DPI时看起来效果不佳。</li>
  <li><strong><code class="code highlight language-text">LiveGdiBitmapScreenDpi</code></strong>返回一个可观察的<code class="code highlight language-text">IProperty<Bitmap></code>当主题更改时，它将通知新值。位图在屏幕DPI处呈现，因此应优先考虑<code class="code highlight language-text">LiveGdipBitmap96</code>仅以96 DPI渲染，而在高DPI时效果不佳。</li>
  <li><strong><code class="code highlight language-text">CurrentImageSource</code></strong>返回WPF <code class="code highlight language-text">ImageSource</code>当前主题的图标。这可以是矢量图像，也可以是在WPF窗口中使用时可以正确呈现的位图。</li>
  <li><strong><code class="code highlight language-text">LiveImageSource</code></strong>返回一个可观察的<code class="code highlight language-text">IProperty<ImageSource></code>由于主题更改，每当图片更改时，图片都会更新。</li>
</ul>

<a name="wpf-controls" class="elem-anchor"></a>
<h2>WPF控件<a href="#wpf-controls" class="anchor-link"><span></span></a></h2>

<p>的<code class="code highlight language-text">ThemedIconViewImage</code> class是从中派生的WPF元素<code class="code highlight language-text">Image</code> ，可以用作替换产品。它将设置从图标ID到<code class="code highlight language-text">Source</code>属性。如果图标ID更改，或者ID代表的图标更改（由于主题更改），则绑定会自动更新<code class="code highlight language-text">Source</code>属性，并显示新图像。</p>

<p>图标ID可以在构造函数中指定，也可以通过设置<code class="code highlight language-text">IconId</code>属性。或者，可以将图标ID绑定到<code class="code highlight language-text">DataContext</code>属性，允许自动更新：</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="k">public</span> <span class="n">UIElement</span> <span class="nf">GetThemedIconViewImage</span><span class="p">(</span><span class="n">Lifetime</span> <span class="n">lifetime</span><span class="p">,</span> <span class="n">IProperty</span><span class="p"><</span><span class="n">IconId</span><span class="p">></span> <span class="n">liveIconId</span><span class="p">)</span> <span class="p">{</span> <span class="kt">var</span> <span class="n">image</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ThemedIconViewImage</span><span class="p">();</span> <span class="c1">// Wire up the live icon ID property to push the value into the DataContext,</span> <span class="c1">// which in turn causes the correctly themed icon to be displayed. The</span> <span class="c1">// property binding is automatically cleared when the Lifetime terminates</span> <span class="n">liveIconId</span><span class="p">.</span><span class="nf">FlowInto</span><span class="p">(</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">DataContextProperty</span><span class="p">);</span> <span class="k">return</span> <span class="n">image</span><span class="p">;</span> <span class="p">}</span></code></div>

<p>如果使用已编译图标，则ReSharper将提供<code class="code highlight language-text">ThemedIcon</code>标记扩展提供实时绑定到<code class="code highlight language-text">Image</code>元素的<code class="code highlight language-text">Source</code>属性。有关详情，请参见下文。</p>

<a name="using-compiled-icons" class="elem-anchor"></a>
<h2>使用已编译的图标<a href="#using-compiled-icons" class="anchor-link"><span></span></a></h2>

<p>最常见的图标类型是已编译图标，已编译为资源并嵌入到程序集中。编译后的图标由的实例标识<code class="code highlight language-text">CompiledIconId</code>类型。通常，这些图标ID实例是自动生成的，可以作为<code class="code highlight language-text">Id</code>以图标命名的类的静态属性，其本身实现为以图标组命名的嵌套类。</p>

<p>例如，您可以使用以下方法获取“待办事宜浏览器”选项页面的图标ID：</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="kt">var</span> <span class="n">iconId</span> <span class="p">=</span> <span class="n">TodoItemsThemedIcons</span><span class="p">.</span><span class="n">TodoOptions</span><span class="p">.</span><span class="n">Id</span><span class="p">;</span></code></div>

<p>还可以使用WPF将已编译图标绑定到WPF中的图像源。 <code class="code highlight language-text">ThemedIcon</code>标记扩展。该扩展将创建一个实时绑定，当由已编译图标ID表示的图标发生更改时（通常是响应主题更改），该绑定会自动更新图像。</p>

<div class="code-block" data-lang="xml"><code class="code-block__wrapper"><span class="nt"><Image</span> <span class="na">Source=</span><span class="s">"{icons:ThemedIcon myres:TodoItemsThemedIcons+TodoOptions}"</span> <span class="nt">/></span></code></div>

<p>请注意，扩展名的参数是保存<code class="code highlight language-text">CompiledIconId</code>实例，而不是<code class="code highlight language-text">Id</code>属性。这是因为XAML需要编译时值，而不是运行时实例。</p>

<p>在属性中引用图标时，也需要类似的要求，例如<code class="code highlight language-text">OptionsPageAttribute</code> ：</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="na">[OptionsPage(PageId, "To-do items", typeof(TodoItemsThemedIcons.ToDoItemsPage))]</span> <span class="k">public</span> <span class="k">class</span> <span class="nc">TodoItemsPage</span> <span class="p">:</span> <span class="n">IOptionsPage</span> <span class="p">{</span> <span class="c1">// ...</span> <span class="p">}</span></code></div>

<p>的<code class="code highlight language-text">OptionsPageAttribute</code>类转换<code class="code highlight language-text">Type</code>到<code class="code highlight language-text">IconId</code>使用<code class="code highlight language-text">CompiledIconClassAttribute.TryGetCompiledIconClassId</code>静态方法：</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="kt">var</span> <span class="n">iconId</span> <span class="p">=</span> <span class="n">CompiledIconClassAttribute</span><span class="p">.</span><span class="nf">TryGetCompiledIconClassId</span><span class="p">(</span><span class="n">typeOfIcon</span><span class="p">,</span> <span class="n">OnError</span><span class="p">.</span><span class="n">LogException</span><span class="p">);</span></code></div>

<p>一旦<code class="code highlight language-text">IconId</code>众所周知，上面讨论的标准图标加载器API可用于获取位图或<code class="code highlight language-text">ImageSource</code> 。快捷方式是使用<code class="code highlight language-text">GetIcon</code>扩展方法<code class="code highlight language-text">IThemedIconManager</code>返回一个<code class="code highlight language-text">ThemedIconLoader</code>可以用来获取图标图像。</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="n">IProperty</span><span class="p"><</span><span class="n">ImageSource</span><span class="p">></span> <span class="n">liveImage</span> <span class="p">=</span> <span class="n">themedIconManager</span><span class="p">.</span><span class="n">GetIcon</span><span class="p"><</span><span class="n">TodoItemsThemedIcons</span><span class="p">.</span><span class="n">ToDoItemsPage</span><span class="p">>().</span><span class="n">LiveImageSource</span><span class="p">;</span></code></div>

<a name="discovering-compiled-icons" class="elem-anchor"></a>
<h2>发现已编译的图标<a href="#discovering-compiled-icons" class="anchor-link"><span></span></a></h2>

<p>ReSharper附带了1000多个已编译的图标，因此查找要使用的图标可能很棘手。大量图标不打算由扩展使用-它们是工具窗口，操作或与扩展无关的其他UI元素的图标。建议在可能的情况下创建自己的图标，但是如果您想重复使用现有的图标，请确保将它们用于相同的目的（例如，请勿使用“单元测试通过”图标来表示扩展成功） 。</p>

<p>如果您想重复使用现有的图标，则可以使用内部功能，该功能可以浏览在<code class="code highlight language-text">ThemedIconManager</code> 。在内部模式下启动ReSharper，然后使用ReSharper→内部→Windows→显示主题图标菜单选项。打开的工具窗口将以平铺视图，平面列表或按所有者分组显示所有可用图标。此分组选项非常有用，因为它将按图标的所有者对图标进行分组-对于已编译的图标，这将指示已编译的图标ID类的名称（名称实际上是“图标包的名称” ”或包含图标定义的XAML文件，但该名称通常与图标ID类名称相同或非常相似）。</p>

<p>当显示为平面列表或分组列表时，这些图标是可搜索的，并且键入一个值将过滤掉与搜索文本不匹配的所有图标。</p>

<a name="psi-symbols" class="elem-anchor"></a>
<h2>PSI符号<a href="#psi-symbols" class="anchor-link"><span></span></a></h2>

<p>虽然可以使用图标管理器来获取PSI元素（例如类，方法或参数）的图标，但强烈建议使用<code class="code highlight language-text">PsiIconManager</code>类代替。有关更多详细信息，请参见<a href="/help/resharper/sdk/PSI/Icons.html"><span>PSI中的图标</span></a>部分。</p>



                    <div class="navigation-links _bottom" data-swiftype-index="false">
                        
                        
                    </div>
                    <div class="last-modified">上次修改时间：2016年3月26日</div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>

<script src="/help/resharper/sdk/app/app.js" data-baseurl="/help/resharper/sdk/"></script>




</body></html>