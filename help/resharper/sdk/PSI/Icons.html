<html lang="en-US" ><head>
    <meta charset="UTF-8">
    <title>PSI图标/ ReSharper DevGuide</title>
    <link rel="stylesheet" href="/help/resharper/sdk/app/app.css">
    <link rel="shortcut icon" href="/help/resharper/sdk/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-57x57.png" sizes="57x57">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-60x60.png" sizes="60x60">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-72x72.png" sizes="72x72">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-114x114.png" sizes="114x114">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-120x120.png" sizes="120x120">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-144x144.png" sizes="144x144">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-152x152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-180x180.png" sizes="180x180">
    <link rel="mask-icon" href="/help/resharper/sdk/apple-mask-icon.svg" color="black">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-square70x70logo" content="/help/resharper/sdk/mstile-70x70.png">
    <meta name="msapplication-TileImage" content="/help/resharper/sdk/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="/help/resharper/sdk/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/help/resharper/sdk/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/help/resharper/sdk/mstile-310x310.png">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Documentation for writing extensions for ReSharper">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.jetbrains.com/help/resharper/sdk//PSI/Icons.html">
    <meta property="og:site_name" content="JetBrains ReSharper">
    <meta property="og:title" content="PSI Icons">
    <meta property="og:description" content="Documentation for writing extensions for ReSharper">
    <meta property="og:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png">
    <meta property="article:modified_time" content="2017-07-10T19:28:42+00:00">
    <!-- <meta property="article:section" content="" /> 
    <meta property="article:tag" content="" /> -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@JBPlatform">
    <meta name="twitter:title" content="PSI Icons">
    <meta name="twitter:description" content="Documentation for writing extensions for ReSharper">
    <meta name="twitter:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png">
    <meta class="swiftype" name="product" data-type="string" content="/help/resharper/sdk/">
<link rel="stylesheet" href="/help/resharper/sdk/app/styles.css"></head>
<body  data-id="PSI/Icons">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label class="search-box__label" for="search-box__input">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="搜索ReSharper DevGuide">
                    </label>
                    <div class="search-box__clear" title="明确"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="//youtrack.jetbrains.com/issues/IJSDK" data-bypass="true">发送反馈</a></p>
                <p>©2000–2018 <a href="//www.jetbrains.com">JetBrains</a> sro<br>版权所有。</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper开发指南</h3>
                
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">
                    <div class="navigation-links _top" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/PSI/Caching.html">缓存</a> <a class="navigation-links__next" href="/Features/Analysis.html">分析</a>
                    </div>
                    <a href="https://github.com/JetBrains/resharper-devguide/edit/master/PSI/Icons.md" class="page-link-to-github" rel="noopener noreferrer" title="在GitHub上编辑此页面" data-bypass="true" target="_blank">
                        <i class="github-icon"></i> <span class="text">编辑页面</span>
                    </a>

                    <h1>PSI图标</h1>
                    <p>PSI需要能够显示图标，以帮助在完成，导航或查找使用结果列表中识别代码元素。PSI可以显示不同的图标以区分类，构造函数，方法，参数等。它还可以显示CSS类ID，HTML元素和单元测试元素的特定图标。</p>

<p>虽然<a href="/help/resharper/sdk/Platform/Shell/Icons.html"><span>Shell提供了<code class="code highlight language-text">ThemedIconManager</code>类</span></a>以加载和创建图标，它是一个低级别的API。除了显式加载外，它不提供获取类图标的任何方法<code class="code highlight language-text">PsiSymbolsThemedIcons.Class.Id</code> 。PSI提供<code class="code highlight language-text">PsiIconManager</code>检索特定声明元素的图标。</p>

<p>的<code class="code highlight language-text">PsiIconManager</code>提供以下方法和属性：</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">PsiIconManager</span> <span class="p">{</span> <span class="k">public</span> <span class="k">abstract</span> <span class="n">IconId</span> <span class="nf">GetDummyImage</span><span class="p">();</span> <span class="k">public</span> <span class="k">abstract</span> <span class="n">IconId</span> <span class="nf">GetImage</span><span class="p">(</span><span class="n">IDeclaredElement</span> <span class="n">element</span><span class="p">,</span> <span class="n">PsiLanguageType</span> <span class="n">language</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">drawExtensions</span><span class="p">);</span> <span class="k">public</span> <span class="k">abstract</span> <span class="n">IconId</span> <span class="nf">GetImage</span><span class="p">(</span><span class="n">DeclaredElementType</span> <span class="n">elementType</span><span class="p">);</span> <span class="k">public</span> <span class="k">abstract</span> <span class="n">IconId</span> <span class="nf">GetImage</span><span class="p">(</span><span class="n">DeclaredElementType</span> <span class="n">elementType</span><span class="p">,</span> <span class="n">PsiIconExtension</span> <span class="n">extensions</span><span class="p">);</span> <span class="k">public</span> <span class="k">abstract</span> <span class="n">IconId</span> <span class="nf">AttachExtensions</span><span class="p">(</span><span class="n">IconId</span> <span class="n">image</span><span class="p">,</span> <span class="n">PsiIconExtension</span> <span class="n">extensions</span><span class="p">);</span> <span class="k">public</span> <span class="k">abstract</span> <span class="n">IconId</span> <span class="n">KeywordIcon</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// ...</span> <span class="p">}</span></code></div>

<p>的<code class="code highlight language-text">PsiIconExtension</code> type是基于标志的枚举，它提供修饰符，例如public，private，internal或abstract，virtual，static等。这些修饰符用于创建复合图标，基本图标代表元素与另一个元素叠加代表修饰符的图标。</p>

<ul>
  <li>
    <p><strong><code class="code highlight language-text">GetDummyImage</code></strong>返回一个虚拟的占位符图像，如果图标管理器无法返回更特定的图像，将使用该图像。使用模式通常为：</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="kt">var</span> <span class="n">iconId</span> <span class="p">=</span> <span class="n">manager</span><span class="p">.</span><span class="nf">GetImage</span><span class="p">(</span><span class="n">CLRDeclaredElementType</span><span class="p">.</span><span class="n">CONSTRUCTOR</span><span class="p">)</span> <span class="p">??</span> <span class="n">manager</span><span class="p">.</span><span class="nf">GetDummyImage</span><span class="p">();</span></code></div>
  </li>
  <li>
    <p><strong><code class="code highlight language-text">GetImage</code></strong>提供一些重载。第一个以<code class="code highlight language-text">IDeclaredElement</code> ，并将返回特定于该元素的图标，例如，给定一个用于类声明的元素，该方法将返回一个<code class="code highlight language-text">IconId</code>用于类图标。的<code class="code highlight language-text">drawExtensions</code>如果使用元素的修饰符（公共，私有，抽象等）修改图标，则parameter为true。</p>

    <p>其他重载使用的实例<code class="code highlight language-text">DeclaredElementType</code> ，这是一个元数据类，它描述了如何显示各种声明的元素类型，包括可显示的名称和使用的图标。ReSharper附带了几个描述元素类型的类，例如<code class="code highlight language-text">CSharpDeclaredElement</code> ， <code class="code highlight language-text">CssDeclaredElementType</code>要么<code class="code highlight language-text">WebConfigDeclaredElementType</code> 。每个类都有几个提供元素类型实例的静态字段，例如<code class="code highlight language-text">WebConfigDeclaredElementType.WEB_CONFIG_TAG_NAME</code> 。</p>
  </li>
  <li>
    <p><strong><code class="code highlight language-text">AttachExtensions</code></strong>会将预期的修饰符叠加层添加到传递的图标上，将其标记为私有，受保护，抽象，静态等。</p>
  </li>
  <li>
    <p><strong><code class="code highlight language-text">KeywordIcon</code></strong>只需返回<code class="code highlight language-text">IconId</code>代表关键字的图标。</p>
  </li>
</ul>

<p>通常，图标管理器会在以下情况下返回图标： <code class="code highlight language-text">GetImage</code>叫做。如果返回<code class="code highlight language-text">null</code> ，请使用传回的图片<code class="code highlight language-text">GetDummyImage</code>代替。</p>

<a name="extending-the-icon-manager" class="elem-anchor"></a>
<h2>扩展图标管理器<a href="#extending-the-icon-manager" class="anchor-link"><span></span></a></h2>

<p>默认情况下，图标管理器将尝试为给定的声明元素返回特定的图标。如果找不到，它将返回元素的图标<code class="code highlight language-text">DeclaredElementType</code> 。为了找到一个特定的图标，它要求一个可扩展的图标提供程序集合，它们全部实现了<code class="code highlight language-text">IDeclaredElementIconProvider</code>接口：</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="k">public</span> <span class="k">interface</span> <span class="nc">IDeclaredElementIconProvider</span> <span class="p">{</span> <span class="n">IconId</span> <span class="nf">GetImageId</span><span class="p">(</span><span class="n">IDeclaredElement</span> <span class="n">declaredElement</span><span class="p">,</span> <span class="n">PsiLanguageType</span> <span class="n">languageType</span><span class="p">,</span> <span class="k">out</span> <span class="kt">bool</span> <span class="n">canApplyExtensions</span><span class="p">);</span> <span class="p">}</span></code></div>

<p>ReSharper附带了许多特定于语言的提供程序，例如C＃提供程序，它检查所声明的元素是否为C＃扩展方法，indexer属性或finalizer（否则将所有这些分类为简单方法），然后返回在每种情况下都有一个特定的图标。如果元素不是其中之一，则返回null。它也返回<code class="code highlight language-text">true</code>在里面<code class="code highlight language-text">canApplyExtensions</code>参数，指示该元素可以具有基于<code class="code highlight language-text">PsiIconExtension</code> 。</p>

<p>此外，ReSharper附带了一个颜色图标提供程序，该提供程序可识别属于颜色属性的类型成员，并返回一个<code class="code highlight language-text">ColorIconId</code>匹配。该提供者返回<code class="code highlight language-text">false</code>在<code class="code highlight language-text">canApplyExtensions</code> 。ReSharper还附带了一个单元测试图标提供程序，该提供程序将检查声明的元素是否是单元测试的一部分，并返回适当的单元测试图标。</p>

<p>可以通过创建实现以下内容的类来扩展该集合<code class="code highlight language-text">IDeclaredElementIconProvider</code>并饰以<code class="code highlight language-text">[DeclaredElementIconProvider]</code>属性。这会将类的范围限定为PSI共享的组件生存期（即与<code class="code highlight language-text">ShellComponent</code> ）。班级是否需要缩短寿命，例如<code class="code highlight language-text">[SolutionComponent]</code> ，可以打电话<code class="code highlight language-text">PsiIconManager.AddExtension</code>在提供者的构造函数中，传入它自己的<code class="code highlight language-text">Lifetime</code>进行清理。单元测试图标提供程序执行此操作，因为它取决于具有解决方案生命周期范围的组件。</p>

<p>的<code class="code highlight language-text">IDeclaredElementIconExtensionProvider</code>可以实施以扩展决定将哪些修改器应用于图标（私有，公共等）的过程。班级应以<code class="code highlight language-text">[DeclaredElementIconExtensionProvider]</code>属性，也可以通过调用进行注册<code class="code highlight language-text">PsiIconManager.AddExtension</code>如果组件有不同的使用寿命要求。该提供程序当前针对CLR和C ++元素实现。</p>

<a name="loading-icons-manually" class="elem-anchor"></a>
<h2>手动加载图标<a href="#loading-icons-manually" class="anchor-link"><span></span></a></h2>

<p>不建议直接加载图标，但可以在<a href="/help/resharper/sdk/Platform/Shell/Icons/ConsumingIcons.html"><span><code class="code highlight language-text">ThemedIconManager</code></span></a> 。只需使用在<code class="code highlight language-text">PsiSymbolsThemedIcons</code>类和使用<a href="/help/resharper/sdk/Platform/Shell/Icons/IconTypes.html#composite-icons"><span><code class="code highlight language-text">CompositeIconId.Compose</code></span></a>应用修饰符的方法。在其他类别中有特定于语言的图标，例如<code class="code highlight language-text">PsiCssThemedIcons</code>要么<code class="code highlight language-text">PsiBuildScriptsThemedIcons</code> 。</p>

<p>的<code class="code highlight language-text">PsiIconManager</code>提供了一种更灵活和可扩展的方式来获取正确的图标。</p>


                    <div class="navigation-links _bottom" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/PSI/Caching.html">缓存</a> <a class="navigation-links__next" href="/Features/Analysis.html">分析</a>
                    </div>
                    <div class="last-modified">上次修改时间：2017年7月10日</div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>

<script src="/help/resharper/sdk/app/app.js" data-baseurl="/help/resharper/sdk/"></script>




</body></html>