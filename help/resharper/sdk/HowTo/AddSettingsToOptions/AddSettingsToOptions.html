<html lang="en-US" ><head>
    <meta charset="UTF-8">
    <title>将设置添加到ReShaper选项/ ReSharper DevGuide</title>
    <link rel="stylesheet" href="/help/resharper/sdk/app/app.css">
    <link rel="shortcut icon" href="/help/resharper/sdk/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-57x57.png" sizes="57x57">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-60x60.png" sizes="60x60">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-72x72.png" sizes="72x72">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-114x114.png" sizes="114x114">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-120x120.png" sizes="120x120">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-144x144.png" sizes="144x144">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-152x152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-180x180.png" sizes="180x180">
    <link rel="mask-icon" href="/help/resharper/sdk/apple-mask-icon.svg" color="black">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-square70x70logo" content="/help/resharper/sdk/mstile-70x70.png">
    <meta name="msapplication-TileImage" content="/help/resharper/sdk/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="/help/resharper/sdk/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/help/resharper/sdk/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/help/resharper/sdk/mstile-310x310.png">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Documentation for writing extensions for ReSharper">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.jetbrains.com/help/resharper/sdk//HowTo/AddSettingsToOptions/AddSettingsToOptions.html">
    <meta property="og:site_name" content="JetBrains ReSharper">
    <meta property="og:title" content="Add Settings to ReShaper Options">
    <meta property="og:description" content="Documentation for writing extensions for ReSharper">
    <meta property="og:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png">
    <meta property="article:modified_time" content="2017-07-12T17:27:26+00:00">
    <!-- <meta property="article:section" content="" /> 
    <meta property="article:tag" content="" /> -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@JBPlatform">
    <meta name="twitter:title" content="Add Settings to ReShaper Options">
    <meta name="twitter:description" content="Documentation for writing extensions for ReSharper">
    <meta name="twitter:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png">
    <meta class="swiftype" name="product" data-type="string" content="/help/resharper/sdk/">
<link rel="stylesheet" href="/help/resharper/sdk/app/styles.css"></head>
<body  data-id="HowTo/AddSettingsToOptions/AddSettingsToOptions">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label class="search-box__label" for="search-box__input">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="搜索ReSharper DevGuide">
                    </label>
                    <div class="search-box__clear" title="明确"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="//youtrack.jetbrains.com/issues/IJSDK" data-bypass="true">发送反馈</a></p>
                <p>©2000–2018 <a href="//www.jetbrains.com">JetBrains</a> sro<br>版权所有。</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper开发指南</h3>
                
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">
                    <div class="navigation-links _top" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/HowTo/CreateToolWindows.html">创建工具Windows</a> <a class="navigation-links__next" href="/HowTo/WorkWithColorThemes.html">使用颜色主题</a>
                    </div>
                    <a href="https://github.com/JetBrains/resharper-devguide/edit/master/HowTo/AddSettingsToOptions/AddSettingsToOptions.md" class="page-link-to-github" rel="noopener noreferrer" title="在GitHub上编辑此页面" data-bypass="true" target="_blank">
                        <i class="github-icon"></i> <span class="text">编辑页面</span>
                    </a>

                    <h1>将设置添加到ReShaper选项</h1>
                    <p><strong>您应该事先知道：</strong></p>
<ul>
  <li><a href="/help/resharper/sdk/HowTo/WorkWithLifetime.html"><span>一生</span></a></li>
  <li><a href="/help/resharper/sdk/HowTo/WorkWithIProperty.html"><span>知识产权</span></a></li>
</ul>

<p><strong>例子：</strong></p>
<ul>
  <li><a href="https://github.com/JetBrains/sample-resharper-plugin/blob/master/SampleReSharperPlugin/src/Options/OptionsPage.cs" rel="noopener noreferrer" data-external="true" target="_blank"><span>OptionsPage.cs</span></a></li>
  <li><a href="https://github.com/JetBrains/sample-resharper-plugin/blob/master/SampleReSharperPlugin/src/Options/Ui/OptionsPageViewModel.cs" rel="noopener noreferrer" data-external="true" target="_blank"><span>OptionsPageViewModel.xaml</span></a></li>
</ul>

<p>ReSharper设置基于键值。设置就像洋葱一样-它们具有层次并且自上而下应用：</p>
<ol>
  <li><strong>预定义设置</strong> ：ReSharper随附的设置（可以在下一级进行修改）。</li>
  <li><strong>计算机级设置</strong> ：设置存储在用户的文件中<code class="code highlight language-text">Localappdata</code> 。ReSharper的所有实例都可以访问此级别。</li>
  <li><strong>解决方案级别</strong> ：设置存储在解决方案旁边的文件中：<ul>
      <li><em>.sln.dotSettings</em> ：团队共享的设置。该文件应存储在VCS中。</li>
      <li><em>.sln.dotSettings.user</em> ：私人用户设置。在这里，您可以存储例如最后的单元测试会话，屏幕上某些对话框的位置等等。因此，这些是特定于此特定解决方案的设置，否则，它们进入计算机级别。</li>
    </ul>
  </li>
  <li><strong>项目级</strong> ：设置存储在项目旁边的文件中。这些设置可以包括例如特定的命名规则。
    <ul>
      <li><em>.csproj.dotSettings</em> ：团队共享的设置。</li>
      <li><em>.csproj.dotSettings.user</em> ：私人用户设置。</li>
    </ul>
  </li>
</ol>

<a name="adding-a-setting" class="elem-anchor"></a>
<h2>添加设置<a href="#adding-a-setting" class="anchor-link"><span></span></a></h2>
<p>要创建一个简单的设置，您应该从<code class="code highlight language-text">SimpleOptionsPage</code>并用<code class="code highlight language-text">OptionsPage</code>属性：</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="na">[OptionsPage(Pid, "Sample R# Plugin", typeof(FeaturesEnvironmentOptionsThemedIcons.CodeInspections), ParentId = ToolsPage.PID)]</span> <span class="k">public</span> <span class="k">class</span> <span class="nc">OptionsPage</span> <span class="p">:</span> <span class="n">SimpleOptionsPage</span> <span class="p">{</span> <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">Pid</span> <span class="p">=</span> <span class="s">"MyPluginOptions"</span><span class="p">;</span> <span class="k">public</span> <span class="nf">OptionsPage</span><span class="p">([</span><span class="n">NotNull</span><span class="p">]</span> <span class="n">Lifetime</span> <span class="n">lifetime</span><span class="p">,</span> <span class="p">[</span><span class="n">NotNull</span><span class="p">]</span> <span class="n">OptionsSettingsSmartContext</span> <span class="n">optionsSettingsSmartContext</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">optionsSettingsSmartContext</span><span class="p">)</span> <span class="p">{</span> <span class="n">IProperty</span><span class="p"><</span><span class="kt">bool</span><span class="p">></span> <span class="n">checkMe</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Property</span><span class="p"><</span><span class="kt">bool</span><span class="p">>(</span><span class="n">lifetime</span><span class="p">,</span> <span class="s">"MyOptionsPage::SomeOption"</span><span class="p">);</span> <span class="n">checkMe</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span> <span class="n">optionsSettingsSmartContext</span><span class="p">.</span><span class="n">StoreOptionsTransactionContext</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span> <span class="p">(</span><span class="n">MySettingsKey</span> <span class="n">key</span><span class="p">)</span> <span class="p">=></span> <span class="n">key</span><span class="p">.</span><span class="n">CheckMe</span><span class="p">));</span> <span class="n">checkMe</span><span class="p">.</span><span class="n">Change</span><span class="p">.</span><span class="nf">Advise</span><span class="p">(</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">a</span> <span class="p">=></span> <span class="p">{</span> <span class="k">if</span> <span class="p">(!</span><span class="n">a</span><span class="p">.</span><span class="n">HasNew</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span> <span class="n">optionsSettingsSmartContext</span><span class="p">.</span><span class="n">StoreOptionsTransactionContext</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span> <span class="p">(</span><span class="n">MySettingsKey</span> <span class="n">key</span><span class="p">)</span> <span class="p">=></span> <span class="n">key</span><span class="p">.</span><span class="n">CheckMe</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">New</span><span class="p">);</span> <span class="p">});</span> <span class="nf">AddBoolOption</span><span class="p">((</span><span class="n">MySettingsKey</span> <span class="n">key</span><span class="p">)</span> <span class="p">=></span> <span class="n">key</span><span class="p">.</span><span class="n">CheckMe</span><span class="p">,</span> <span class="s">"Sample bool option"</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span> <span class="na">[SettingsKey(typeof(EnvironmentSettings), "My settings")]</span> <span class="k">public</span> <span class="k">class</span> <span class="nc">MySettingsKey</span> <span class="p">{</span> <span class="p">[</span><span class="nf">SettingsEntry</span><span class="p">(</span><span class="k">false</span><span class="p">,</span> <span class="s">"Check Me"</span><span class="p">)]</span> <span class="k">public</span> <span class="kt">bool</span> <span class="n">CheckMe</span><span class="p">;</span> <span class="p">}</span></code></div>

<a name="notes" class="elem-anchor"></a>
<h3>笔记<a href="#notes" class="anchor-link"><span></span></a></h3>

<p><img src="setting-resharper-options.png" alt="掠夺者选择权"></p>

<ul>
  <li>的<code class="code highlight language-text">OptionsPage</code>属性告诉ReSharper这是ReSharper设置集成点。</li>
  <li><code class="code highlight language-text">"Sample R# Plugin"</code>传递给属性的是选项组的名称。</li>
  <li><code class="code highlight language-text">AddBoolOption</code>将“ <strong>样本布尔选项”</strong>复选框添加到“ <strong>选项”</strong>页面。</li>
  <li><code class="code highlight language-text">MySettingsKey</code>是描述将用于访问您的设置的键的类。</li>
  <li>的<code class="code highlight language-text">CheckMe</code>字段表示将用于访问设置值的设置存储条目。</li>
</ul>

<a name="reading-a-setting-value" class="elem-anchor"></a>
<h2>读取设定值<a href="#reading-a-setting-value" class="anchor-link"><span></span></a></h2>
<p>要访问设置值，可以使用<code class="code highlight language-text">ISettingStore</code>零件：</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="k">public</span> <span class="k">class</span> <span class="nc">OptionsPageViewModel</span><span class="p">:</span> <span class="n">AAutomation</span> <span class="p">{</span> <span class="k">public</span> <span class="n">IProperty</span><span class="p"><</span><span class="kt">string</span><span class="p">></span> <span class="n">Text</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="k">public</span> <span class="nf">OptionsPageViewModel</span><span class="p">(</span><span class="n">Lifetime</span> <span class="n">lifetime</span><span class="p">,</span> <span class="n">ISettingsStore</span> <span class="n">settingsStore</span><span class="p">)</span> <span class="p">{</span> <span class="n">Text</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Property</span><span class="p"><</span><span class="kt">string</span><span class="p">>(</span><span class="n">lifetime</span><span class="p">,</span> <span class="s">"OptionsExampleViewModel.Text"</span><span class="p">);</span> <span class="kt">var</span> <span class="n">checkMeOption</span> <span class="p">=</span> <span class="n">settingsStore</span><span class="p">.</span><span class="nf">BindToContextLive</span><span class="p">(</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">ContextRange</span><span class="p">.</span><span class="n">ApplicationWide</span><span class="p">)</span> <span class="p">.</span><span class="nf">GetValueProperty</span><span class="p">(</span><span class="n">lifetime</span><span class="p">,</span> <span class="p">(</span><span class="n">MySettingsKey</span> <span class="n">key</span><span class="p">)</span> <span class="p">=></span> <span class="n">key</span><span class="p">.</span><span class="n">CheckMe</span><span class="p">);</span> <span class="n">checkMeOption</span><span class="p">.</span><span class="n">Change</span><span class="p">.</span><span class="nf">Advise_HasNew</span><span class="p">(</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">v</span> <span class="p">=></span> <span class="p">{</span> <span class="n">Text</span><span class="p">.</span><span class="n">Value</span> <span class="p">=</span> <span class="n">v</span><span class="p">.</span><span class="n">New</span> <span class="p">?</span> <span class="s">"checked"</span> <span class="p">:</span> <span class="s">"not checked"</span><span class="p">;</span> <span class="p">});</span> <span class="p">}</span> <span class="p">}</span></code></div>

<a name="notes-1" class="elem-anchor"></a>
<h3>笔记<a href="#notes-1" class="anchor-link"><span></span></a></h3>
<ul>
  <li><code class="code highlight language-text">BindToContextLive</code>设置用于读取和写入值的上下文：在我们的示例中，它是<code class="code highlight language-text">ApplicationWide</code> 。如果<code class="code highlight language-text">ContextRange.Smart</code>是否指定了上下文，将取决于用户的设置编辑模式（请参阅本节顶部的设置层）。</li>
</ul>


                    <div class="navigation-links _bottom" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/HowTo/CreateToolWindows.html">创建工具Windows</a> <a class="navigation-links__next" href="/HowTo/WorkWithColorThemes.html">使用颜色主题</a>
                    </div>
                    <div class="last-modified">上次修改时间：2017年7月12日</div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>

<script src="/help/resharper/sdk/app/app.js" data-baseurl="/help/resharper/sdk/"></script>




</body></html>