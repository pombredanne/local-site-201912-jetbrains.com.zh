<html lang="en-US" ><head>
    <meta charset="UTF-8">
    <title>导航代码/ ReSharper DevGuide</title>
    <link rel="stylesheet" href="/help/resharper/sdk/app/app.css">
    <link rel="shortcut icon" href="/help/resharper/sdk/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-57x57.png" sizes="57x57">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-60x60.png" sizes="60x60">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-72x72.png" sizes="72x72">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-114x114.png" sizes="114x114">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-120x120.png" sizes="120x120">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-144x144.png" sizes="144x144">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-152x152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="/help/resharper/sdk/apple-touch-icon-180x180.png" sizes="180x180">
    <link rel="mask-icon" href="/help/resharper/sdk/apple-mask-icon.svg" color="black">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-square70x70logo" content="/help/resharper/sdk/mstile-70x70.png">
    <meta name="msapplication-TileImage" content="/help/resharper/sdk/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="/help/resharper/sdk/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/help/resharper/sdk/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/help/resharper/sdk/mstile-310x310.png">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Documentation for writing extensions for ReSharper">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.jetbrains.com/help/resharper/sdk//HowTo/NavigateCode/NavigateCode.html">
    <meta property="og:site_name" content="JetBrains ReSharper">
    <meta property="og:title" content="Navigate Code">
    <meta property="og:description" content="Documentation for writing extensions for ReSharper">
    <meta property="og:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png">
    <meta property="article:modified_time" content="2017-07-12T17:27:26+00:00">
    <!-- <meta property="article:section" content="" /> 
    <meta property="article:tag" content="" /> -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@JBPlatform">
    <meta name="twitter:title" content="Navigate Code">
    <meta name="twitter:description" content="Documentation for writing extensions for ReSharper">
    <meta name="twitter:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png">
    <meta class="swiftype" name="product" data-type="string" content="/help/resharper/sdk/">
<link rel="stylesheet" href="/help/resharper/sdk/app/styles.css"></head>
<body  data-id="HowTo/NavigateCode/NavigateCode">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label class="search-box__label" for="search-box__input">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="搜索ReSharper DevGuide">
                    </label>
                    <div class="search-box__clear" title="明确"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="//youtrack.jetbrains.com/issues/IJSDK" data-bypass="true">发送反馈</a></p>
                <p>©2000–2018 <a href="//www.jetbrains.com">JetBrains</a> sro<br>版权所有。</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper开发指南</h3>
                
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">
                    <div class="navigation-links _top" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/HowTo/WorkWithIProperty.html">使用IProperty</a> <a class="navigation-links__next" href="/HowTo/CreateMenuItemsUsingActions.html">使用操作创建菜单项</a>
                    </div>
                    <a href="https://github.com/JetBrains/resharper-devguide/edit/master/HowTo/NavigateCode/NavigateCode.md" class="page-link-to-github" rel="noopener noreferrer" title="在GitHub上编辑此页面" data-bypass="true" target="_blank">
                        <i class="github-icon"></i> <span class="text">编辑页面</span>
                    </a>

                    <h1>导航代码</h1>
                    <p>ReSharper提供两种类型的导航：</p>
<ul>
  <li><strong>上下文相关</strong> ：导航目标以某种方式与插入符号下的元素相关（ <strong>导航至声明</strong>等）。看到：<ul>
      <li><a href="AddYourNavigationActionToNavigateToMenu.html"><span>将导航操作添加到“导航至”菜单</span></a></li>
    </ul>
  </li>
  <li><strong>全局</strong> ：任何导航目标（ <strong>转到所有内容</strong>等）。</li>
</ul>

<p>导航任务可以分为两个步骤：</p>
<ul>
  <li>找到导航目标（特定的代码元素）。例如，在上下文导航的情况下，您应该首先获取当前插入符号位置下的树节点，然后找到相关的代码元素-导航目标（例如，声明，特定用法等）。看到：<ul>
      <li><a href="GetTreeNodeUnderCaret.html"><span>在插入符下获取树节点</span></a></li>
      <li><a href="GetTreeNodeByFullName.html"><span>通过完整的CLR名称获取树节点</span></a></li>
      <li><a href="GetTreeNodeByReference.html"><span>通过引用获取树节点</span></a></li>
      <li><a href="UseManualNavigation.html"><span>使用手动导航</span></a></li>
    </ul>
  </li>
  <li>将插入符号移动到目标代码元素。看到：<ul>
      <li><a href="NavigateToParticularTreeNode.html"><span>导航到特定树节点</span></a></li>
    </ul>
  </li>
</ul>

<p>在查看有关如何执行导航的SDK示例之前， <strong>强烈建议</strong>您在本节下面熟悉ReSharper的项目模型和PSI基础。同样值得一看的是<a href="GetTreeNodeByFullName.html"><span>通过全CLR名称获取树节点</span></a>中的示例（此代码可在项目模型和PSI实体中有效运行）。</p>

<a name="project-model-basics" class="elem-anchor"></a>
<h2>项目模型基础<a href="#project-model-basics" class="anchor-link"><span></span></a></h2>
<p>项目模型是一种API，它允许使用在Visual Studio中构成解决方案的实体：解决方案本身，项目，文件夹和文件。</p>

<p>主要的项目模型元素是：</p>
<ul>
  <li><code class="code highlight language-text">ISolution</code> ：在Visual Studio中加载解决方案时创建的解决方案表示形式。这是项目模型的根元素，通常与Visual Studio的<strong>解决方案资源管理器中</strong>的<strong>解决</strong>方案节点相对应。 <code class="code highlight language-text">ISolution</code>提供了许多有用的界面，可用于处理项目模型的其他元素，甚至可以使用PSI（例如，请参见<code class="code highlight language-text">ISolution.GetPsiServices()</code> ）。</li>
  <li><code class="code highlight language-text">IProject</code> ：项目和解决方案文件夹表示形式，提供用于获取项目文件，项目文件夹和某些特定人员（例如，模块到项目的引用）的界面。 <code class="code highlight language-text">IProject</code>也有一些方法可以让您降低到PSI级别，例如<code class="code highlight language-text">GetPsiModules()</code>要么<code class="code highlight language-text">GetPsiSourceFileInProject()</code> 。有几种项目（ <code class="code highlight language-text">IProject.Kind</code>属性）：解决方案文件夹，网站，常规项目，其他文件项目。</li>
  <li><code class="code highlight language-text">IProjectFolder</code> ：项目文件夹表示形式。</li>
  <li><code class="code highlight language-text">IProjectFile</code> ：项目中文件的表示。提供用于与其他相关项目模型元素（例如， <code class="code highlight language-text">GetDependentFiles()</code>获取相关的项目文件。</li>
</ul>

<p>其他重要元素：</p>
<ul>
  <li><code class="code highlight language-text">IPsiModule</code> ：一个编译单元。通常，对于C＃类库， <code class="code highlight language-text">IPsiModule</code>对应于已编译的<em>.dll</em>文件（因此，它大致相当于<code class="code highlight language-text">IProject</code> ）。</li>
  <li><code class="code highlight language-text">IPsiSourceFile</code> ：一种抽象，表示具有必须编译的源代码的文件，即包含在编译单元中的文件（ <code class="code highlight language-text">IPsiModule</code> ）。在一个简单的例子中，它相当于<code class="code highlight language-text">IProjectFile</code> 。 <code class="code highlight language-text">IPsiSourceFile</code>允许您获取表示文件的PSI语法树的<a href="#psi-basics"><span>IFile</span></a> 。因此，这是您通往PSI级别的桥梁。</li>
</ul>

<p>为什么ReSharper如果已经拥有这两个实体，为什么需要<code class="code highlight language-text">IProject</code>和<code class="code highlight language-text">IProjectFile</code> ？问题在于，一个项目可以被编译成多个模块，也可以被编译成多个模块。 <code class="code highlight language-text">IProjectFile</code>可以用多个源文件表示。为了更好地理解，请考虑以下示例。说，我们有一个简单的Web项目，名为<code class="code highlight language-text">WebApp</code> ：</p>

<p><img src="project-model-example.png" alt="项目模型示例"></p>

<p>在这里，单个项目被编译为三个模块。每个<em>.cs</em>文件都有两个<code class="code highlight language-text">IPsiSourceFile</code>与之相关联。</p>

<p>因此，如果您100％确定项目文件仅由一个源文件表示，则可以获得一个实例。 <code class="code highlight language-text">IPsiSourceFile</code>通过调用<code class="code highlight language-text">IProjectFile.ToSourceFile()</code>方法。它将返回<code class="code highlight language-text">FirstOrDefault()</code> PSI源文件集合中的元素。否则，全部拿走<code class="code highlight language-text">IPsiSourceFile</code> （s）通过致电<code class="code highlight language-text">ToSourceFiles()</code> 。</p>

<p>从获取模块<code class="code highlight language-text">IProject</code> ， 使用<code class="code highlight language-text">IProject.GetAllModules()</code>方法。</p>

<a name="psi-basics" class="elem-anchor"></a>
<h2>PSI基础<a href="#psi-basics" class="anchor-link"><span></span></a></h2>
<p>PSI（程序结构接口）是用于使用代码语法树（源代码的树表示）的API。PSI的主要元素是：</p>
<ul>
  <li><code class="code highlight language-text">IFile</code> ：用于从<a href="#project-model-basics"><span>IPsiSourceFile</span></a>构建PSI语法树的<a href="#project-model-basics"><span>抽象</span></a> 。一个源文件可能包含许多<code class="code highlight language-text">IFile</code> （s）：一个主节点，多个辅助节点（在主节点上使用相同的PSI节点构建）和注入的PSI（例如，在进行语言注入时，例如包含带有JS代码的变量的C＃文件）。获得<code class="code highlight language-text">IFile</code>从源文件中，使用<code class="code highlight language-text">IPsiSourceFile.GetPsiFile()</code>方法。</li>
  <li><code class="code highlight language-text">ITreeNode</code> ：语法树的最基本元素。树的任何元素都是树节点（实现<code class="code highlight language-text">ITreeNode</code>接口）。例如，即使是一个封闭的分号或两个单词之间的空格也是树节点。</li>
  <li><code class="code highlight language-text">IReference</code> ：将语义模型附加到树节点的抽象。例如，表达<code class="code highlight language-text">i = 1</code>有参考<code class="code highlight language-text">i</code> （一个实现了<code class="code highlight language-text">IReferenceExpression</code> ）解析为<code class="code highlight language-text">IDeclaredElement</code> （请参见下文），即某些属性，字段或局部变量。您可以在重构或上下文操作中使用此引用，以导航到引用的代码元素，依此类推。一些节点还具有特定的命名引用（取决于节点类型）。ITreeNode接口提供了GetAllReferences方法，该方法返回所有节点引用。</li>
  <li>
    <p><code class="code highlight language-text">IDeclaredElement</code> ：语义模型的元素。这是一个有意义的代码元素，可以被其他代码元素引用：类声明，属性等。请注意，两者之间存在区别<code class="code highlight language-text">IDeclaration</code>和<code class="code highlight language-text">IDeclaredElement</code> 。 <code class="code highlight language-text">IDeclaredElement</code>是您可以参考的实体，而<code class="code highlight language-text">IDeclaration</code>只是代码中声明发生的地方。例如，您有一个偏类<code class="code highlight language-text">Foo</code>它分为两个不同部分：</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">Foo</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span> <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">Foo</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">}</span></code></div>

    <p>这些声明的两个顶层树节点都实现<code class="code highlight language-text">IDeclaration -> IClassDeclaration</code> 。但是只有一个<code class="code highlight language-text">IDeclaredElement</code>声明通过<code class="code highlight language-text">DeclaredElement</code>财产-阶级<code class="code highlight language-text">Foo</code>在全局名称空间中声明。</p>
  </li>
  <li>其他PSI类型：语法树的特定元素有很多特定的帮助程序类型。例如， <code class="code highlight language-text">IVariableDeclaration</code>和<code class="code highlight language-text">ILocalVariableDeclaration</code> （用于变量声明）， <code class="code highlight language-text">IExpressionStatement</code> （用于表示语句），以及更多。此外，有许多特定于特定语言的类型，因此提供了仅与该语言相关的特定方法。例如， <code class="code highlight language-text">ICSharpDeclaration</code>要么<code class="code highlight language-text">IJavaScriptDynamicProperty</code> 。</li>
</ul>

<p>为了更好地理解，请考虑以下示例：</p>

<p><img src="psi-example.png" alt="psi示例"></p>

<p>请注意，即使未在图片上显示，等号，分号，甚至空格也是语法树的特殊树节点。</p>


                    <div class="navigation-links _bottom" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/HowTo/WorkWithIProperty.html">使用IProperty</a> <a class="navigation-links__next" href="/HowTo/CreateMenuItemsUsingActions.html">使用操作创建菜单项</a>
                    </div>
                    <div class="last-modified">上次修改时间：2017年7月12日</div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>

<script src="/help/resharper/sdk/app/app.js" data-baseurl="/help/resharper/sdk/"></script>




</body></html>