


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>What's New in ReSharper 9.0? / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/help/resharper/sdk/app/app.css">
    <link rel="shortcut icon" href="/help/resharper/sdk/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="57x57" href="/help/resharper/sdk/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/help/resharper/sdk/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/help/resharper/sdk/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/help/resharper/sdk/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/help/resharper/sdk/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/help/resharper/sdk/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/help/resharper/sdk/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/help/resharper/sdk/apple-touch-icon-180x180.png">
    <link rel="mask-icon" href="/help/resharper/sdk/apple-mask-icon.svg" color="black">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-square70x70logo" content="/help/resharper/sdk/mstile-70x70.png">
    <meta name="msapplication-TileImage" content="/help/resharper/sdk/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="/help/resharper/sdk/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/help/resharper/sdk/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/help/resharper/sdk/mstile-310x310.png">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Documentation for writing extensions for ReSharper" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.jetbrains.com/help/resharper/sdk//Extensions/WhatsNew.html" />
    <meta property="og:site_name" content="JetBrains ReSharper" />
    <meta property="og:title" content="What's New in ReSharper 9.0?" />
    <meta property="og:description" content="Documentation for writing extensions for ReSharper" />
    <meta property="og:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png" />
    <meta property="article:modified_time" content="2017-07-10T19:28:42+00:00" />
    <!-- <meta property="article:section" content="" /> 
    <meta property="article:tag" content="" /> -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@JBPlatform" />
    <meta name="twitter:title" content="What's New in ReSharper 9.0?" />
    <meta name="twitter:description" content="Documentation for writing extensions for ReSharper" />
    <meta name="twitter:image" content="https://www.jetbrains.com/help/resharper/sdk/jetbrains.png" />
    <meta class="swiftype" name="product" data-type="string" content="/help/resharper/sdk/"></meta>
<link  rel="stylesheet" href="/help/resharper/sdk/app/styles.css"></head>
<body data-id="Extensions/WhatsNew">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a data-bypass="true" href="//youtrack.jetbrains.com/issues/IJSDK">Send feedback</a></p>
                <p>&copy; 2000&ndash;2018 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">
                    <div class="navigation-links _top" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/Extensions/GettingStarted.html">Getting Started</a>
                        <a class="navigation-links__next" href="/Extensions/DeclarativeExtensions.html">Declarative Extensions</a>
                    </div>
                    <a data-bypass="true" href="https://github.com/JetBrains/resharper-devguide/edit/master/Extensions/WhatsNew.md" class="page-link-to-github" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub">
                        <i class="github-icon"></i>
                        <span class="text">Edit page</span>
                    </a>

                    <h1>What's New in ReSharper 9.0?</h1>
                    <p>This document lists the major changes between ReSharper 8 and ReSharper 9, for extension authors. It is not an exhaustive list, but lists the major breaking changes. Other minor changes may exist. If you wish to update this page, please <a href="https://github.com/JetBrains/resharper-devguide/edit/master/Intro/WhatsNew.md" data-external="true" target="_blank" rel="noopener noreferrer"><span>edit it</span></a>, or <a href="https://github.com/JetBrains/resharper-devguide/issues" data-external="true" target="_blank" rel="noopener noreferrer"><span>submit an issue</span></a>.</p>

<ul id="markdown-toc">
  <li><a href="#zones-and-namespace-refactorings" id="markdown-toc-zones-and-namespace-refactorings"><span>Zones and namespace refactorings</span></a></li>
  <li><a href="#extension-packages" id="markdown-toc-extension-packages"><span>Extension packages</span></a></li>
  <li><a href="#removal-of-plugin-metadata-attributes" id="markdown-toc-removal-of-plugin-metadata-attributes"><span>Removal of plugin metadata attributes</span></a></li>
  <li><a href="#actions" id="markdown-toc-actions"><span>Actions</span></a></li>
  <li><a href="#visual-studio-integration" id="markdown-toc-visual-studio-integration"><span>Visual Studio integration</span></a></li>
  <li><a href="#background-component-instantiation" id="markdown-toc-background-component-instantiation"><span>Background component instantiation</span></a></li>
  <li><a href="#control-flow-interface-renaming" id="markdown-toc-control-flow-interface-renaming"><span>Control Flow interface renaming</span></a></li>
  <li><a href="#search-in-options" id="markdown-toc-search-in-options"><span>Search in options</span></a></li>
  <li><a href="#unit-test-provider-changes" id="markdown-toc-unit-test-provider-changes"><span>Unit test provider changes</span></a>    <ul>
      <li><a href="#unit-test-element-id-changes" id="markdown-toc-unit-test-element-id-changes"><span>Unit test element ID changes</span></a></li>
      <li><a href="#file-and-metadata-explorers" id="markdown-toc-file-and-metadata-explorers"><span>File and metadata explorers</span></a></li>
    </ul>
  </li>
</ul>

<a name="zones-and-namespace-refactorings" class="elem-anchor"></a>
<h2>Zones and namespace refactorings<a href="#zones-and-namespace-refactorings" class="anchor-link"><span></span></a></h2>

<p>ReSharper 9.0 introduces the ReSharper Platform, which is a common binary distribution of the platform used to build ReSharper, dotCover, dotTrace, dotPeek and other .net based JetBrains tools. Zones are a mechanism to partition components into feature sets that can be enabled or disabled, or required by one product, but not another. This is used to stop usage requirements dictating packaging concerns. That is, if a particular language feature is used by product A but not product B, it can still be implemented in a single assembly targeting that language, rather than having to arbitrarily split the assembly into two, one for each shipping assembly.</p>

<p>Components must now declare the zones they require in order to be activated. If any of the required zones are unavailable (due to product support or configuration), the component will also not be available. For example, if a plugin publishes a component that implements a Quick-Fix, it must declare that it requires Quick-Fixes. If the product doesn’t support Quick-Fixes (e.g. dotPeek, or dotTrace), then the component isn’t instantiated. This, coupled with the single binary distribution, means that plugins are now applied to <em>all</em> products, not just ReSharper. If the dependent feature is available, the plugin will load in that product.</p>

<p>Zones are based on namespaces - a zone marker class declares the required zones for all components in that namespace and below. Due to this, many namespaces in ReSharper have been renamed to better reflect the hierarchical classification zones dictate.</p>

<p>Existing plugin authors will have to update their plugins to work with zones. Firstly, many errors will simply be namespace renames. Using ReSharper to automatically import the types from their new namespaces should fix many of these errors. Secondly, the plugin author should add a zone marker class describing the zones required for the plugins functionality. ReSharper provides an internal analysis to help with this.</p>

<p>See the <a href="/help/resharper/sdk/Platform/Zones.html"><span>section on Zones</span></a> for more details.</p>

<a name="extension-packages" class="elem-anchor"></a>
<h2>Extension packages<a href="#extension-packages" class="anchor-link"><span></span></a></h2>

<p>Extensions are now extensions to the ReSharper Platform, instead of extensions to just ReSharper. This requires some changes to the way extensions are packaged, and deployed. They are still NuGet packages, but the layout of the content has changed. Instead of putting the extensions in a root folder called “ReSharper”, plugins, external annotations or settings files should be in a folder called “DotFiles”. When installed, extensions are now installed directly to the product folder, which is now in <code class="code highlight language-text">%LOCALAPPDATA%</code>, rather than <code class="code highlight language-text">C:\Program Files</code>.</p>

<p>See the <a href="/help/resharper/sdk/Extensions/Packaging.html"><span>section on Deployment</span></a> for more details.</p>

<a name="removal-of-plugin-metadata-attributes" class="elem-anchor"></a>
<h2>Removal of plugin metadata attributes<a href="#removal-of-plugin-metadata-attributes" class="anchor-link"><span></span></a></h2>

<p>The <code class="code highlight language-text">[PluginTitle]</code>, <code class="code highlight language-text">[PluginVendor]</code> and <code class="code highlight language-text">[PluginDescription]</code> attributes have been deprecated and removed. The Plugins Options page has also been removed, meaning the only place this information is displayed is in the Extension Manager, which uses similar information from the extension’s package metadata instead. The attributes should be removed.</p>

<p>The ReSharper Platform has changed the way it works with extensions and plugins. Previously, plugins had special treatment from ReSharper - plugins were loaded separately to product assemblies by the Component Model, and were listed in the Plugins Options page. The ReSharper Platform now treats extensions the same as product assemblies - or rather, products are treated the same as extensions. ReSharper, dotCover and dotPeek, etc. are all extensions to the ReSharper Platform. During installation, extensions (1st and 3rd party) are statically registered and are composed at runtime to create a single application. The Extension Manager retrieves extensions and invokes the installer to combine the new extension into the application.</p>

<p>Both the Plugins Options page and the previous version of the Extension Manager allowed for disabling plugins or extensions. This functionality has been removed, in favour of disabling features at the zone level, providing richer control of what can be disabled - an entire product, or one of several features implemented by an extension, be that a 1st party extension like dotTrace, or a 3rd party extension such as a plugin.</p>

<p>A major difference is that this is an opt-in mechanism. In order to allow for disabling a product or a feature, a plugin must advertise a zone as being a product or feature. This is described in the <a href="/help/resharper/sdk/Platform/Zones/FeaturesProducts.html"><span>Features and Products</span></a> section of the <a href="/help/resharper/sdk/Platform/Zones.html"><span>Zones</span></a> guide.</p>

<a name="actions" class="elem-anchor"></a>
<h2>Actions<a href="#actions" class="anchor-link"><span></span></a></h2>

<p>The Action subsystem has been rewritten for this release. The most obvious changes are:</p>

<ul>
  <li><code class="code highlight language-text">IActionHandler</code> is to be replaced by <code class="code highlight language-text">IExecutableAction</code>.</li>
  <li>Each action handler requires a unique ID.</li>
  <li>Bulk actions have been rewritten.</li>
</ul>

<a name="visual-studio-integration" class="elem-anchor"></a>
<h2>Visual Studio integration<a href="#visual-studio-integration" class="anchor-link"><span></span></a></h2>

<p>The move to the shared ReSharper Platform means that Products can now be viewed as extensions of the ReSharper Platform. This changes how Visual Studio integration is handled. Previous versions would create a separate Visual Studio extension for each Product, e.g. ReSharper, dotCover and dotTrace would all be installed into Visual Studio separately, as individual extensions.</p>

<p>Starting with ReSharper 9, there is only one Visual Studio extension - the ReSharper Platform. Products are installed into the ReSharper Platform, and the Platform will update its registration with Visual Studio to make sure all new assemblies are registered with Visual Studio.</p>

<p>This process also applies to extensions, which are treated in exactly the same manner as Products - when installed into the ReSharper Platform, the extensions assemblies are statically registered with Visual Studio. There are two implications of this:</p>

<ol>
  <li>ReSharper extensions can import and export MEF components.</li>
  <li>Extension “live loading” is no longer supported and Visual Studio must always be restarted when an extension is installed.</li>
  <li>Actions implemented by extensions will remember shortcut assignments and customisations. This fixes <a href="http://youtrack.jetbrains.com/issue/RSRP-246461" data-external="true" target="_blank" rel="noopener noreferrer"><span>RSRP-246461</span></a> and <a href="http://youtrack.jetbrains.com/issue/RSRP-337038" data-external="true" target="_blank" rel="noopener noreferrer"><span>RSRP-337038</span></a>.</li>
</ol>

<p>It is strongly recommended to prefer ReSharper abstractions over MEF interfaces wherever possible, as this allows for extensions to be used outside of Visual Studio.</p>

<a name="background-component-instantiation" class="elem-anchor"></a>
<h2>Background component instantiation<a href="#background-component-instantiation" class="anchor-link"><span></span></a></h2>

<p>Starting with ReSharper 9.0, the Component Model will no longer immediately create components during application startup, but will instead defer creation until the application becomes idle. This has a very positive impact on application startup performance.</p>

<p>More specifically, any classes marked with attributes such as <code class="code highlight language-text">[ShellComponent]</code> and <code class="code highlight language-text">[SolutionComponent]</code> are no longer created immediately, as the parts container is composed (e.g. application startup, or solution load), but are queued up to the current thread’s <code class="code highlight language-text">Dispatcher</code>, at <code class="code highlight language-text">Background</code> priority. The components are still created on the main thread, as in previous versions, and all dependencies are still created first.</p>

<p>One implication of this change is that the application can now be up and running before all of the components in the container have been created. Previous versions would create the whole container before allowing the application to continue running. There may be cases where a component should be created in a more timely manner. For example, the Visual Studio integration needs to be created and hooked up before the application can continue. In this case, the component can require “instant” activation, in which case the component (and all of the components required to satisfy constructor dependencies) are created immediately rather than scheduled:</p>

<div class="code-block" data-lang="csharp"><code class="code-block__wrapper"><span class="na">[ShellComponent(Requirement = InstantiationRequirement.Instant)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">ImmediateComponent</span>
<span class="p">{</span>
<span class="p">}</span>
</code></div>

<p>See the <a href="/help/resharper/sdk/Platform/ComponentModel.html"><span>Component Model section</span></a> for more details.</p>

<p>Note that this only applies when the ReSharper platform is hosted in Visual Studio. Standalone products will always instantiate components immediately.</p>

<a name="control-flow-interface-renaming" class="elem-anchor"></a>
<h2>Control Flow interface renaming<a href="#control-flow-interface-renaming" class="anchor-link"><span></span></a></h2>

<p>The control flow graph interfaces have been renamed to correct spelling:</p>

<ul>
  <li><code class="code highlight language-text">IControlFlowGraf</code> -&gt; <code class="code highlight language-text">IControlFlowGraph</code></li>
  <li><code class="code highlight language-text">IControlFlowRib</code> -&gt; <code class="code highlight language-text">IControlFlowEdge</code></li>
</ul>

<p>Also, the language specific interfaces have been renamed:</p>

<ul>
  <li><code class="code highlight language-text">ICSharpControlFlowGraf</code> -&gt; <code class="code highlight language-text">ICSharpControlFlowGraph</code> and <code class="code highlight language-text">ICSharpControlFlowRib</code> -&gt; <code class="code highlight language-text">ICSharpControlFlowEdge</code></li>
  <li><code class="code highlight language-text">IVBControlFlowGraf</code> -&gt; <code class="code highlight language-text">IVBControlFlowGraph</code> and <code class="code highlight language-text">IVBControlFlowRib</code> -&gt; <code class="code highlight language-text">IVBControlFlowEdge</code></li>
  <li><code class="code highlight language-text">IJsControlFlowGraf</code> -&gt; <code class="code highlight language-text">IJsControlFlowGraph</code> and <code class="code highlight language-text">IJavaScriptControlFlowRib</code> -&gt; <code class="code highlight language-text">IJsControlFlowEdge</code></li>
</ul>

<p>The <code class="code highlight language-text">IControlFlowBuilder</code> and <code class="code highlight language-text">ControlFlowBuilder</code> provide language agnostic methods to create a control flow graph.</p>

<a name="search-in-options" class="elem-anchor"></a>
<h2>Search in options<a href="#search-in-options" class="anchor-link"><span></span></a></h2>

<p>Options pages are now searchable. To implement in your own options page, either implement <code class="code highlight language-text">ISearchablePage</code>, or derive from <code class="code highlight language-text">SimpleOptionsPage</code>. Highlighting results is implemented automatically for XAML pages, as long as the page sets the attached property <code class="code highlight language-text">SearchablePageBehavior.SearchFilter="True"</code> on the root control of the page, while also setting the <code class="code highlight language-text">DataContext</code> of the root control to the implementation of <code class="code highlight language-text">ISearchablePage</code>.</p>

<a name="unit-test-provider-changes" class="elem-anchor"></a>
<h2>Unit test provider changes<a href="#unit-test-provider-changes" class="anchor-link"><span></span></a></h2>

<a name="unit-test-element-id-changes" class="elem-anchor"></a>
<h3>Unit test element ID changes<a href="#unit-test-element-id-changes" class="anchor-link"><span></span></a></h3>

<p>The ID for unit test elements is no longer a simple string ID. This change is to support multiple providers in the same project (e.g. mixing nunit and xunit tests), and also to allow for tests with the same fully qualified class or method name in the same solution. This is especially important for Shared Projects.</p>

<p>Instead of the ID being a simple string, it is now a <code class="code highlight language-text">UnitTestElementId</code> instance, which is a value type (multiple instances can be considered equal if the fields are all equal). It is comprised of three values - the test provider (e.g. nunit, xunit), a <code class="code highlight language-text">PersistentProjectId</code>, which is usually a GUID in the <code class="code highlight language-text">.csproj</code> file, and the old string ID of the element. The string ID of the element can be the fully qualified name of the class or method - taking all three values into account allows for uniqueness of IDs.</p>

<p>The persistent project ID can be retrieved by calling <code class="code highlight language-text">IProject.GetPersistentId()</code>.</p>

<a name="file-and-metadata-explorers" class="elem-anchor"></a>
<h3>File and metadata explorers<a href="#file-and-metadata-explorers" class="anchor-link"><span></span></a></h3>

<p>The <code class="code highlight language-text">IUnitTestMetadataExplorer</code>, <code class="code highlight language-text">IUnitTestFileExplorer</code> and the <code class="code highlight language-text">ExploreExternal</code> and <code class="code highlight language-text">ExploreSolution</code> methods on the <code class="code highlight language-text">IUnitTestProvider</code> interface have been merged into a single interface, <code class="code highlight language-text">IUnitTestElementSource</code>. This should be implemented as a <code class="code highlight language-text">[SolutionComponent]</code>. It provides a direct replacement for the above mentioned interfaces and methods, allowing for unit test discovery from PSI syntax trees or assembly IL metadata. The <code class="code highlight language-text">IUnitTestElementSource.ExploreSolution</code> method allows for discovery of test elements via other, non-prescribed means, perhaps by examining the solution for non-project files, or looking for project files that don’t have a PSI syntax tree.</p>

<p>The implementation of the interface can defer to the existing implementations of <code class="code highlight language-text">IUnitTestMetadataExplorer</code> or <code class="code highlight language-text">IUnitTestFileExplorer</code>, with minor alterations. The <code class="code highlight language-text">UnitTestElementConsumer</code> delegate has been replaced with a more flexible <code class="code highlight language-text">IUnitTestElementsObserver</code>, and the <code class="code highlight language-text">MetadataElementsSource</code> class provides infrastructure for loading assembly IL metadata and calling an <code class="code highlight language-text">ExploreAssembly</code>-like method.</p>



                    <div class="navigation-links _bottom" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/Extensions/GettingStarted.html">Getting Started</a>
                        <a class="navigation-links__next" href="/Extensions/DeclarativeExtensions.html">Declarative Extensions</a>
                    </div>
                    <div class="last-modified">
                        Last modified: 10 July 2017
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>

<script src="/help/resharper/sdk/app/app.js" data-baseurl="/help/resharper/sdk/"></script>

</body>
</html>

