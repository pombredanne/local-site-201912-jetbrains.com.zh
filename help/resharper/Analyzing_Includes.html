<html lang="en-US" ><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>分析包括-帮助|锐化器</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body  data-id="Analyzing_Includes" data-disqus-id="Analyzing_Includes_10"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label class="search-box__label" for="search-box__input"><input type="text" class="search-box__input" id="search-box__input" placeholder="搜索ReSharper帮助"></label><div class="search-box__clear" title="明确"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">发送反馈</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>ReSharper 2019.2帮助</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">按键图：</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option value="rs" data-group="secondary">ReSharper 2.x / IntelliJ IDEA</option><option value="vs" data-group="primary">视觉工作室</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 id="Analyzing_Includes.xml" data-toc="Analyzing_Includes">分析包括</h1>    <p id="c5950270">        <a name="CppIncludesProfilerInCurrentProject"></a> <span class="menupath" data-skip-index="skip">ReSharper |检查分析当前项目中的内容</span>          <br>        <a name="CppIncludesProfilerInSolution"></a> <span class="menupath" data-skip-index="skip">ReSharper |检查分析解决方案中包含的内容</span>      </p>    <p id="2afe61ce">由庞大的include层次结构导致的较长构建时间是大型现实C ++项目中的最大问题之一。ReSharper具有一些功能，可帮助您优化设计时间。例如，它将<a href="Code_Analysis_in_CPP.html#remove_include">标记为未使用</a> <code class="code">#include</code>指令或自动为未解析的名称创建前向声明，而不是在标头中包含必需的声明。</p>    <p id="5a8eaca4">为了更系统地解决包含层次结构问题，ReSharper提供了<span class="emphasis">Includes Analyzer</span> ，这是一种代码检查工具，可帮助您查找和消除不必要的标头依赖性。</p>    <div class="chapter"><h2 id="how-is-it-helpful" data-toc="Analyzing_Includes#how-is-it-helpful">有什么帮助？</h2>        <p id="9578532c">一个典型的项目可能包含数千个<code class="code">#include</code>指令，尚不清楚其中哪些值得研究。包括分析器尝试根据添加到总编译工作量中的代码行数来估计每个头文件对构建时间的贡献。虽然这不是一个精确的指标，但它是查找并优先考虑包含最多的头文件的优先级的起点。</p>        <p id="3e044136">在确定潜在影响最大的标头依赖项之后，您可以尝试通过标准方法一一摆脱它们，例如：</p>        <ul class="list _ul"><li class="list__item" id="d74433d9"><p>尽可能使用<a href="http://www.gotw.ca/publications/mill04.htm" rel="noopener noreferrer" data-external="true" target="_blank">前向声明</a> ，</p></li><li class="list__item" id="c24c8346"><p>删除不必要的<code class="code">#include</code>指令，</p></li><li class="list__item" id="1c73dbf0"><p>应用<a href="http://en.cppreference.com/w/cpp/language/pimpl" rel="noopener noreferrer" data-external="true" target="_blank">Pimpl习惯用法</a> ，</p></li><li class="list__item" id="e402dca3"><p>将较大的头文件分割为较小的头文件。</p></li></ul>        <p id="b92b1574">Includes Analyzer的一个重要限制是ReSharper实际上并未运行完整的预处理阶段以加快分析过程。这意味着行数实际上并不包含宏扩展的结果，并且包含后卫的行数也不会得到处理。相反，ReSharper假定每个头文件都以include保护或#pragma一旦指令开始，并在任何源文件中最多包含一次。同一标头的每个连续包含均不会计入其贡献的行数，这意味着有时您可能会在内部树节点旁边遇到<span class="emphasis">包含的Times</span>和其他等于零的度量。</p>    </div>    <div class="chapter"><h2 id="starting-the-analysis" data-toc="Analyzing_Includes#starting-the-analysis">开始分析</h2>        <p id="8514e1cb">要开始分析，请调用<span class="menupath" data-skip-index="skip">ReSharper |检查</span>从主菜单中<span class="menupath" data-skip-index="skip">分析“包含于...”</span>操作，或从“解决方案资源管理器”上下文菜单中选择“ <span class="control">分析包含</span> ”。</p>        <p id="0c2d80d1">ReSharper将分析给定范围内的文件，并在专用工具窗口中显示报告，您可以在其中浏览文件之间的依赖关系。<span class="control">Includes分析</span>窗口提供了两个单独的视图<span class="control">Includes</span>和<span class="control">Includers</span> ，这两个视图<span class="control">均以</span>树的形式包括依赖关系，其中每个节点对应于一个文件。您可以通过相应的工具栏按钮在这些视图之间切换，也可以从上下文菜单导航到另一个视图中的相同文件。</p>    </div>    <div class="chapter"><h2 id="includees-view" data-toc="Analyzing_Includes#includees-view">包括视图</h2>        <p id="91c0cc0b"><span class="control">Includes</span>视图可帮助您了解顶级树节点中的头文件对直接或间接包含它的所有源文件贡献了多少行代码。此视图中的子节点代表包含父节点文件的文件。考虑对整个<a href="https://github.com/catchorg/Catch2" rel="noopener noreferrer" data-external="true" target="_blank">Catch2</a>解决方案的以下分析：</p>        <figure><img alt="ReSharper包括分析-包括视图" title="ReSharper包括分析-包括视图" src="/help/img/dotnet/2019.2/IncludesAnalyzerIncludees.png" id="e3e8ece1" width="636" height="317"></figure>        <p id="7bd099a6">树中的每个节点都有三个指标：</p>        <ul class="list _ul"><li class="list__item" id="762cdbc2"><p>                <span class="emphasis">包含的时间</span>显示了通过当前节点的路径，顶级节点中的头文件中包含多少个源文件。在上面的示例中， <span class="filepath">catch_common.h总共</span>被包含在75个源文件中，其中26 <span class="filepath">个</span>通过以下方式包含<span class="filepath">catch_common.h：</span> <code class="code">#include "catch_common.h"</code> <span class="filepath">catch_tag_alias_autoregistrar.h中的</span>指令。</p></li><li class="list__item" id="0432196e"><p>                <span class="emphasis">行贡献</span>显示顶级节点中的头文件本身通过到当前节点的路径<span class="emphasis">贡献</span>了多少行代码，而没有传递包含的文件。 <span class="filepath">catch_common.h总共</span>贡献了4,050行代码，是75（包括它的源文件的数量）乘以54（文件中代码的行数量）的<span class="filepath">乘积</span> 。在总共4,050行中，有1,404行是由于<code class="code">#include "catch_common.h"</code>在<span class="filepath">catch_tag_alias_autoregistrar.h中</span> 。</p></li><li class="list__item" id="348c7e7f"><p>                <span class="emphasis">包含行贡献</span>与<span class="emphasis">行贡献</span>相似，但是此度量标准考虑了传递到顶级节点文件中的所有标头。例如<span class="filepath">catch_common.h</span>以及其中包含的标头在整个解决方案的编译期间总共贡献了2,654,938行。这些行中的1,017,626条是由于<code class="code">#include "catch_common.h"</code>在<code class="code">catch_tag_alias_autoregistrar.h</code> 。<span class="emphasis">包含行贡献</span>是默认的，可以说是最有用的排序标准。</p></li></ul>    </div>    <div class="chapter"><h2 id="includers-view" data-toc="Analyzing_Includes#includers-view">包含者检视</h2>        <p id="922f1be0">所述<span class="control">Includers</span>视图类似于<span class="control">Includees</span>视图，但是以相反的方式起作用：树中的子节点表示被包括到从父节点的文件中的文件。</p>        <figure><img alt="ReSharper包含分析-包含者视图" title="ReSharper包含分析-包含者视图" src="/help/img/dotnet/2019.2/IncludesAnalyzerIncluders.png" id="54994c34" width="636" height="317"></figure>        <p id="2d7c1c33">此视图显示在顶级节点中的文件中可传递地包含多少行代码，就像它已被编译为独立的源文件一样（例如<span class="filepath">catch_common.h</span>以及其中包含的所有标头包含42365行代码），带来了27,046 <code class="code">#include<string>)</code> 。该视图提供的指标是</p>        <ul class="list _ul"><li class="list__item" id="55b15632"><p>                <span class="emphasis">包含计数</span> （包含文件的数量），</p></li><li class="list__item" id="dda8ce79"><p>                <span class="emphasis">行数</span> （文件本身的大小），</p></li><li class="list__item" id="064f91be"><p>                <span class="emphasis">行数（包括行数）</span> （文件的大小以及包含的所有头文件的大小）。</p></li></ul>    </div>    <div class="chapter"><h2 id="options" data-toc="Analyzing_Includes#options">选件</h2>        <p id="bc545a09">除了导航控件和刷新按钮之外，“包含分析”窗口中的工具栏还允许您更改两个选项：</p>        <ul class="list _ul"><li class="list__item" id="848a801b"><p>                <span class="emphasis">仅显示属于某个项目的根节点</span>将隐藏与不属于任何项目的文件相对应的顶级树节点。如果您只想集中解决方案中的标头，这是一种筛选库文件的快速方法。</p></li><li class="list__item" id="a6450fe4"><p>默认情况下，ReSharper在分析过程中会跳过空白行和注释。<span class="emphasis">计数空白行和注释行</span>按钮使您可以更改此行为。</p></li></ul>    </div><div class="last-modified" data-skip-index="skip">上次修改时间：2019年11月18日</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Navigation_in_CPP.html">导航和搜索</a> <a class="navigation-links__next" href="Refactorings_for_CPP.html">重构</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>