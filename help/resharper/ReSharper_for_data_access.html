<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>ReSharper for Data Access - Help | ReSharper</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="ReSharper_for_data_access" data-article-props="&#xA;                {&#xA;                &#xA;            &#34;seeAlso&#34;:[&#xA;            &#xA;                {&#34;title&#34;: &#34;Concepts&#34;,&#xA;                 &#34;links&#34;: [&#xA;                &#xA;        {&#34;url&#34;:&#34;Refactorings__Index.html&#34;,&#34;text&#34;:&#34;Refactorings&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Code_Generation__Index.html&#34;,&#34;text&#34;:&#34;Code Generation&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Code_Analysis__Quick-Fixes.html&#34;,&#34;text&#34;:&#34;Quick-Fixes for Code Issues&#34;}&#xA;    &#xA;                    ]}&#xA;            ]&#xA;        &#xA;                }&#xA;            " data-disqus-id="ReSharper_for_data_access_10"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>ReSharper 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="secondary" value="rs">ReSharper 2.x/IntelliJ IDEA</option><option data-group="primary" value="vs">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 data-toc="ReSharper_for_data_access" id="ReSharper_for_data_access.xml">ReSharper for Data Access</h1>    <p id="24acb20b">        Regardless of which database and driver/ORM you use, the tasks for setting up data access in you application are        very similar. From the creation of your entities, to the setting up of your repository, ReSharper is there to        help you get the job done better and faster.    </p>    <div class="chapter"><h2 id="entity-creation" data-toc="ReSharper_for_data_access#entity-creation">Entity Creation</h2>        <p id="44fd79cf">            Entities are at the core of working with data access, as they store the data from your database.            There are many ways to create an entity quickly in ReSharper.            One way is to use the            <kbd data-rs="Alt+Insert" data-vs="Alt+Insert">Alt+Insert</kbd>            shortcut in the Solution Explorer, which will give you the familiar            <span class="control">Generate</span>            menu with the list of available            <a href="Templates__Template_Basics__Template_Types.html#file">file templates</a>:        </p>        <figure><img alt="'ReSharper for data access' tutorial" title="'ReSharper for data access' tutorial" src="/help/img/dotnet/2019.2/data_access1.png" id="102190ab" width="261" height="200"></figure>        <p id="9bef0fd9">            Choosing            <span class="control">Class</span>            in the above menu, you get prompted to give the class a name:        </p>        <figure><img alt="'ReSharper for data access' tutorial" title="'ReSharper for data access' tutorial" src="/help/img/dotnet/2019.2/data_access2.png" id="28297d57" width="336" height="120"></figure>        <p id="25e7a871">            And you automatically get a class called            <code class="code">Person</code>            in a file called            <span class="filepath">Person.cs</span>.        </p>        <p id="67d9da38">            As an alternative, you can get ReSharper to infer the class name and its members from usage.            For example, you can type in a class invocation and then press            <kbd data-rs="Alt+Enter" data-vs="Alt+Enter">Alt+Enter</kbd>            to            <a href="Code_Generation__Generating_Code_from_Usage.html">generate</a>            the class:        </p>        <figure><img alt="'ReSharper for data access' tutorial" title="'ReSharper for data access' tutorial" src="/help/img/dotnet/2019.2/data_access3.png" id="1fc9be2f" width="220" height="143"></figure>        <p id="ab354e37">            In much the same manner, ReSharper can help you generate class members.            For example, you can try to assign a property called            <code class="code">Name</code> and ReSharper will offer the option to create the property:        </p>        <figure><img alt="'ReSharper for data access' tutorial" title="'ReSharper for data access' tutorial" src="/help/img/dotnet/2019.2/data_access4.png" id="8f44c572" width="179" height="138"></figure>        <p id="c25997a5">            ReSharper correctly guesses the type, but lets you change it:        </p>        <figure><img alt="'ReSharper for data access' tutorial" title="'ReSharper for data access' tutorial" src="/help/img/dotnet/2019.2/data_access5.png" id="7290d1ca" width="256" height="73"></figure>        <p id="df83b9f6">            Another way to build your entity is to use            <a href="Templates__Template_Basics__Template_Types.html#live">live templates</a>.            Since ReSharper automatically imported the Visual Studio templates upon installation, you can use,            for example, the            <a href="Reference__Templates_Explorer__Live_Templates_CSHARP.html#Live_prop_CSHARP">prop</a>            template to quickly add properties to your entity:        </p>        <figure><img alt="'ReSharper for data access' tutorial" title="'ReSharper for data access' tutorial" src="/help/img/dotnet/2019.2/data_access6.png" id="5cd3bfd5" width="262" height="89"></figure>    </div>    <div class="chapter"><h2 id="entity-build-up" data-toc="ReSharper_for_data_access#entity-build-up">Entity Build-Up</h2>        <p id="955cf89d">            Though in many cases you’ll want to keep your entities as simple as possible,            there are situations when you need to add additional features to your entities.            For example, an initializing constructor makes your entity easier to use.            Luckily, for an occasion such as this, we have ReSharper’s            <a href="Generating_Type_Members.html">Generate Menu</a>            <kbd data-rs="Alt+Insert" data-vs="Alt+Insert">Alt+Insert</kbd>.            This menu lets you add various features to your existing type.        </p>        <p id="323f4231">            Let’s say you want to add a fully initializing constructor to our Person type. To do so, press            <kbd data-rs="Alt+Insert" data-vs="Alt+Insert">Alt+Insert</kbd>            while in the class, and choose            <code class="code">Constructor</code>:        </p>        <figure><img alt="ReSharper for Data Access" title="ReSharper for Data Access" src="/help/img/dotnet/2019.2/cookbook_create_type.png" id="68a9313d" width="277" height="286"></figure>        <p id="c2a58f7c">            You will be presented with a dialog asking which properties you want to initialize:        </p>        <figure><img alt="ReSharper for Data Access" title="ReSharper for Data Access" src="/help/img/dotnet/2019.2/cookbook_create_type1.png" id="2a545963" width="466" height="400"></figure>        <p id="3a9f3e35">            And if you pick all the properties and press            <code class="code">Finish</code>, your class will acquire the following generated constructor:        </p><div class="code-block" data-lang="csharp">
public Person(string name, int age)
{
  Name = name;
  Age = age;
}
</div>        <p id="ed91f7a7">            If you want your entity to be comparable and easily hostable in collections such as            <code class="code">HashSet&lt;T&gt;</code>, you need to implement equality members – a difficult task to get right!            Luckily, once again, ReSharper’s            <span class="control">Generate</span>            menu has a            <a href="Code_Generation__Equality_Members.html">corresponding option</a>, which lets you implement:        </p>        <ul class="list _ul"><li class="list__item" id="65ddcae9"><p>                Equality operators                <code class="code">==</code> and                <code class="code">!=</code>            </p></li><li class="list__item" id="519b9bf0"><p>                Correct                <code class="code">Equals()</code> overloads and – optionally – the                <code class="code">IEquatable&lt;T&gt;</code>                interface            </p></li><li class="list__item" id="391b0e71"><p>                A good                <code class="code">GetHashCode()</code>                method            </p></li></ul>        <p id="e677209c">            You can trust ReSharper to take special care with all your properties – it will perform all the right null            checks, and will do property comparisons either with            <code class="code">Equals()</code> or            <code class="code">==</code> depending on types being compared.        </p>        <p id="7de90558">            One last example (there are many more options available) is the automatic creation of a            <code class="code">ToString()</code> method.            Once again, you get to choose which properties take part, and after you do, ReSharper produces a neat            implementation:        </p><div class="code-block" data-lang="csharp">
public override string ToString()
{
  return string.Format("Name: {0}, Age: {1}", Name, Age);
}
</div>        <p id="3a0c6873">            Note that these features are available to you even if your ORM has built the basic entity classes            for you.            Since the generated classes are typically partial, nothing prevents you from creating another part of            the class and running Generate actions on it.        </p>    </div>    <div class="chapter"><h2 id="infrastructure" data-toc="ReSharper_for_data_access#infrastructure">Infrastructure</h2>        <p id="d8fa65a0">            After you have prepared your entities, it is time to set up the infrastructure useful for working with the            database. The specifics of this depend on the ORM or driver you use, of course, but here we’ll look at the            use of NoRM and MongoDB.        </p>        <p id="2acb875f">            Say you’re starting out with the following code:        </p><div class="code-block" data-lang="csharp">
void AddPerson()
{
  using (var m = new Mongo("personnel", "localhost", "27017", string.Empty))
  {
    var coll = m.GetCollection&lt;Person&gt;("people");

    var p = new Person("Jack", 20);
    coll.Insert(p);
  }
}
</div>        <p id="0b9fe51d">            The first thing we can do is refactor out the database connection data.            To do that, let’s use ReSharper’s            <a href="Refactor_This.html">Refactor This</a> shortcut            <kbd data-rs="Ctrl+Shift+R" data-vs="Ctrl+Shift+R">Ctrl+Shift+R</kbd>                        with the            <code class="code">new</code> statement selected and choose the            <a href="Refactorings__Extract_Method.html">Extract Method</a>            option:        </p>        <figure><img alt="'ReSharper for data access' tutorial" title="'ReSharper for data access' tutorial" src="/help/img/dotnet/2019.2/data_access7.png" id="348e26b9" width="552" height="177"></figure>        <p id="e3d896e3">            Consequently, ReSharper offers you the options for configuring the method. Let’s call it            <code class="code">GetDatabase()</code>:        </p>        <figure><img alt="'ReSharper for data access' tutorial" title="'ReSharper for data access' tutorial" src="/help/img/dotnet/2019.2/data_access8.png" id="e23f157f" width="655" height="592"></figure>        <p id="35f1f024">            And here’s what ReSharper produces:        </p><div class="code-block" data-lang="csharp">
private static Mongo GetDatabase()
{
  return new Mongo("personnel", "localhost", "27017", string.Empty);
}
</div>        <p id="b1882f86">            With the original call replaced by            <code class="code">GetDatabase()</code> of course.        </p>    </div>    <div class="last-modified" data-skip-index="skip">Last modified: 18 November 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="ReSharper_for_Universal_Apps.html">ReSharper for Universal Apps and Windows Phone</a><a class="navigation-links__next" href="ReSharper_for_VSTO.html">ReSharper for VSTO</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>