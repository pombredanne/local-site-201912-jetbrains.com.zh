<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><meta content="noindex" name="robots"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><meta content="&#xA;        External annotations. Using JetBrains annotations (ReSharper annotations) on compiled libraries.&#xA;    " name="description" data-skip-index="skip"><title>External Annotations - Help | ReSharper</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Code_Analysis__External_Annotations" data-breadcrumbs="Code_Analysis__Index.xml|Code Analysis/Finding_Code_Issues.xml|Find Code Issues with Code Inspection/Code_Analysis__Code_Annotations.xml|Use Annotations to Refine Code Inspection/Code_Analysis__External_Annotations.xml|External Annotations" data-main-title="External Annotations" data-article-props="&#xA;                {&#xA;                &#xA;            &#34;seeAlso&#34;:[&#xA;            &#xA;                {&#34;title&#34;: &#34;Concepts&#34;,&#xA;                 &#34;links&#34;: [&#xA;                &#xA;        {&#34;url&#34;:&#34;Code_Analysis__Index.html&#34;,&#34;text&#34;:&#34;Code Analysis&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Code_Analysis__Code_Annotations.html&#34;,&#34;text&#34;:&#34;Use Annotations to Refine Code Inspection&#34;}&#xA;    &#xA;                    ]},&#xA;                {&#34;title&#34;: &#34;Procedures&#34;,&#xA;                 &#34;links&#34;: [&#xA;                &#xA;        {&#34;url&#34;:&#34;Code_Analysis__Annotations_in_Source_Code.html&#34;,&#34;text&#34;:&#34;Annotations in Source Code&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Code_Analysis__String_Formatting_Methods.html&#34;,&#34;text&#34;:&#34;Code Analysis and Helpers for String Literals&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Code_Analysis__Value_Analysis.html&#34;,&#34;text&#34;:&#34;Value and Nullability Analysis&#34;}&#xA;    &#xA;                    ]},&#xA;                {&#34;title&#34;: &#34;Reference&#34;,&#xA;                 &#34;links&#34;: [&#xA;                &#xA;        {&#34;url&#34;:&#34;Reference__Code_Annotation_Attributes.html&#34;,&#34;text&#34;:&#34;Code Annotation Attributes&#34;}&#xA;    &#xA;                    ]}&#xA;            ]&#xA;        &#xA;                }&#xA;            " data-disqus-id="Code_Analysis__External_Annotations_10"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>ReSharper 2019.3 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="secondary" value="rs">ReSharper 2.x/IntelliJ IDEA</option><option data-group="primary" value="vs">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 data-toc="Code_Analysis__External_Annotations" id="Code_Analysis__External_Annotations.xml">External Annotations</h1>        <div class="chapter"><h2 id="how_it_works" data-toc="Code_Analysis__External_Annotations#how_it_works">How it works</h2>        <p id="892de33a">            If you are using an external library, whose sources are not available to you,            it does not seem feasible to use the attributes there for specifying code annotations.        </p>        <p id="6b4cb4ee">            In this case, you can use            <i id="14ea2abc">External Annotations</i>, which allow you to complement the already compiled entities with attributes            recognized by ReSharper's code analysis engine.            External annotations let you 'cheat' the engine, by making it see the attributes            (for methods, parameters and other declarations),            which were not declared at the time the library was compiled.        </p>        <p id="f6aeaa4a">            External annotations are specified in XML files.            When loading solution, ReSharper looks for specifically named XML files in specific locations and            reads annotations from there.            These XML files have a structure similar to XmlDoc.            For example, to annotate the method            <code class="code">XmlReader.Create(Stream input)</code>            from the assembly            <code class="code">System.Xml</code>            of .NET Framework 4.0, with the            <code class="code">NotNull</code>            contracts, the XML file would look as follows:        </p>        <div class="code-block" data-lang="markup">
&lt;assembly name="System.Xml, Version=4.0.0.0"&gt;
    &lt;!--The attribute name contains the assembly name. If you don't specify the version,
    this file's attributes will be applied to all versions of the assemblies of that name --&gt;
    &lt;member name="M:System.Xml.XmlReader.Create(System.IO.Stream)"&gt;
        &lt;!--This shows the name of the member whose attributes are complemented;
        the notation is the same as XmlDoc --&gt;
        &lt;attribute ctor="M:JetBrains.Annotations.NotNullAttribute.#ctor" /&gt;
            &lt;!--attribute constructor names are also specified using XmlDoc notation --&gt;
        &lt;parameter name="input"&gt;
            &lt;attribute ctor="M:JetBrains.Annotations.NotNullAttribute.#ctor" /&gt;
        &lt;/parameter&gt;
    &lt;/member&gt;
&lt;/assembly&gt;</div>    </div>    <div class="chapter"><h2 id="jb" data-toc="Code_Analysis__External_Annotations#jb">JetBrains external annotations</h2>        <p id="d54fabf2">            The approach described above was used to annotate a huge amount of symbols in the .NET Framework Class            Library, as well as in other frequently used libraries.            External annotations for these libraries are installed with ReSharper to ensure better code analysis.            Some features (for example, ASP.NET MVC 5.2 support) are also rely on external annotations.        </p>        <p id="71eff904">            The source code of JetBrains external annotations is available under the MIT license on GitHub:            <a href="https://github.com/JetBrains/ExternalAnnotations" data-external="true" target="_blank" rel="noopener noreferrer">https://github.com/JetBrains/ExternalAnnotations</a>.            You are welcome to contribute to this repository or use it as an example for your own external annotations.        </p>    </div>    <div class="chapter"><h2 id="creating" data-toc="Code_Analysis__External_Annotations#creating">Create external annotations</h2>        <p id="89995bbd">            You can create external annotations to specify contracts for any compiled assembly.            To make sure ReSharper recognizes the XML file with external annotations, this file should be named            <span class="filepath">[Assembly.Name].ExternalAnnotations.xml</span>.            Depending on how you are going to use the annotated binaries, you can create annotations files in            the following places:        </p>        <ul class="list _ul"><li class="list__item" id="05cab1a6"><p>                If you are going to publish some binaries (for example, via NuGet), place the annotations                <span class="filepath">[Assembly.Name].ExternalAnnotations.xml</span> file in the same folder where the annotated                <span class="filepath">[Assembly.Name].dll</span>                file is located.            </p></li><li class="list__item" id="4241b830">                <p id="e8c2b13e">                    If you want to annotate some binaries included in your project, place the annotations                    files for each assembly in the                    <span class="filepath">ExternalAnnotations</span>                    folder next to the project or solution file.                </p>                <p id="f7f79690">                    When you put an annotations file in this folder,                    the file should be named after the assembly name, that is                    <span class="filepath">[Assembly.Name].xml</span>.                    It can also be in a subfolder of                    <span class="filepath">ExternalAnnotations</span>, but that folder must have the assembly name, that is                    <span class="filepath">ExternalAnnotations/[Assembly.Name]/[AnyName].xml</span>                </p>                <p id="0086a87d">                    This way you can also keep the annotations                    <span>under a VCS</span>                    so that your team could benefit from them.                </p>            </li></ul>        <aside data-type="tip" class="prompt" data-title="" rel="ae16f068" id="fd912db0">            <p id="c874045b">                You can use ReSharper annotations as a reference when creating your own annotations.                To study ReSharper external annotations, look at XML files in subdirectories of the                <span class="filepath">[ReSharper installation directory]\ExternalAnnotations</span> directory.            </p>        </aside>        <p id="79eb55a4">            To illustrate creating external annotations, imagine that you use a            <span class="filepath">TestLib</span> assembly that has            <code class="code">MyTestClass</code> class with            <code class="code">static string ReverseString(String inputString)</code> method.            Suppose, that from the assembly documentation,            you know that the method is pure and never returns null, and its parameter should never be null.        </p>        <p id="16c9dd52">            Initially, ReSharper is not aware of how            <code class="code">ReverseString</code> works, and therefore it finds no problems in the following code:        </p>        <figure><img alt="External annotations" title="External annotations" src="/help/img/dotnet/2019.3/external_annotations_0.png" id="0356e88e" width="370" height="59"></figure>        <section class="procedure-steps"><h3 id="9b5b039a">To create external annotations for a compiled assembly</h3><ol class="list _decimal"><li class="list__item" id="86e9fee9"><p>                Locate the                <span class="filepath">TestLib.dll</span> on your file system and create a file named                <span class="filepath">TestLib.ExternalAnnotations.xml</span> either in the same folder or in the                <span class="filepath">ExternalAnnotations</span> folder next to the project or solution file where                <span class="filepath">TestLib.dll</span> is referenced.            </p></li><li class="list__item" id="7b2eea67"><p>                Open                <span class="filepath">TestLib.ExternalAnnotations.xml</span> for editing and type in the following:                <div class="code-block" data-lang="markup">&lt;assembly name="TestLib"&gt;
    &lt;member name="M:TestLib.MyTestClass.ReverseString(System.String)"&gt;
        &lt;attribute ctor="M:JetBrains.Annotations.NotNullAttribute.#ctor" /&gt;
        &lt;attribute ctor="M:JetBrains.Annotations.PureAttribute.#ctor" /&gt;
        &lt;parameter name="inputString"&gt;
            &lt;attribute ctor="M:JetBrains.Annotations.NotNullAttribute.#ctor" /&gt;
        &lt;/parameter&gt;
    &lt;/member&gt;
&lt;/assembly&gt;</div>            </p></li><li class="list__item" id="6f9e9ed7"><p>                Reload your solution.                                                Now ReSharper detects incorrect usage of                <code class="code">ReverseString</code> and highlights the problem with the null parameter:                <figure><img alt="External annotations" title="External annotations" src="/help/img/dotnet/2019.3/external_annotations_1.png" id="8cf7b043" width="540" height="72"></figure>                ... and the unnecessary check of the return value:                <figure><img alt="External annotations" title="External annotations" src="/help/img/dotnet/2019.3/external_annotations_2.png" id="e4212e8d" width="380" height="85"></figure>            </p></li><li class="list__item" id="a2785dae"><p>                To see, which external annotations are applied to a library symbol, you can use the                <a href="Coding_Assistance__Quick_Documentation.html">Quick Documentation</a> feature. Just press                <kbd data-rs="Ctrl+Q" data-vs="Ctrl+Shift+F1">Ctrl+Q</kbd>                                over the symbol to study its attributes.                In our case, we can see that                <code class="code">ReverseString</code> is annotated with                <code class="code">[NotNull]</code> and                <code class="code">[Pure]</code> attributes and the parameter is annotated with                <code class="code">[NotNull]</code>:                <figure><img alt="Viewing quick documentation" title="Viewing quick documentation" src="/help/img/dotnet/2019.3/attributes_quick_doc.png" id="351ff6cf" width="445" height="180"></figure>                The grey color of the attributes means that they come not from assembly code, but from external annotations.            </p></li></ol></section>        <aside data-type="tip" class="prompt" data-title="" rel="9b5b039a" id="698db46e">            <p id="a92acb23">                To get the correct symbol IDs for the                <code class="code">name</code> attributes in your annotations, use the                <a href="Copying_Symbol_Information_to_Clipboard.html#xml">Copy XML-Doc ID to Clipboard</a>                command on original symbols.            </p>        </aside>    </div>        <div class="chapter"><h2 id="distributing" data-toc="Code_Analysis__External_Annotations#distributing">Distribute external annotations</h2>        <p id="98a26eaf">            Another case of using external annotations is publishing external annotations for a library that you            distribute, or for any library you like.            In this case, the users of your library who also use ReSharper or Rider,            will get more suggestions and fixes.        </p>        <p id="1b38dd9a">            External annotations for libraries can be published on and installed from            <a href="https://resharper-plugins.jetbrains.com/packages?q=Tags:&#34;annotations&#34;" data-external="true" target="_blank" rel="noopener noreferrer">ReSharper gallery</a> as NuGet packages.            To learn more about packaging external annotations, see            <a href="https://www.jetbrains.com/resharper/devguide/" data-external="true" target="_blank" rel="noopener noreferrer">ReSharper plugin development guide</a>.        </p>    </div>    <div class="last-modified" data-skip-index="skip">Last modified: 28 November 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Code_Analysis__Annotations_in_Source_Code.html">Annotations in Source Code</a><a class="navigation-links__next" href="Contract_Annotations.html">Contract Annotations</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>