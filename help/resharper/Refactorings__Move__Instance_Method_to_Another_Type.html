<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Move Instance Method refactoring - Help | ReSharper</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Refactorings__Move__Instance_Method_to_Another_Type" data-article-props="&#xA;                {&#xA;                &#xA;            &#34;seeAlso&#34;:[&#xA;            &#xA;                {&#34;title&#34;: &#34;Procedures&#34;,&#xA;                 &#34;links&#34;: [&#xA;                &#xA;        {&#34;url&#34;:&#34;Refactorings__Move__Type_to_Another_Type.html&#34;,&#34;text&#34;:&#34;Move to Another Type refactoring&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Refactorings__Pull_Members_Up.html&#34;,&#34;text&#34;:&#34;Pull Members Up refactoring&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Refactorings__Push_Members_Down.html&#34;,&#34;text&#34;:&#34;Push Members Down refactoring&#34;}&#xA;    &#xA;                    ]}&#xA;            ]&#xA;        &#xA;                }&#xA;            " data-disqus-id="Refactorings__Move__Instance_Method_to_Another_Type_10"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>ReSharper 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="secondary" value="rs">ReSharper 2.x/IntelliJ IDEA</option><option data-group="primary" value="vs">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 data-toc="Refactorings__Move__Instance_Method_to_Another_Type" id="Refactorings__Move__Instance_Method_to_Another_Type.xml">Move Instance Method refactoring</h1>            <a name="%actionId%"></a>    <p id="0d1c8a54">      <span data-skip-index="skip" class="menupath">ReSharper | Refactor | Move…</span>      <br>      <kbd data-rs="F6" data-vs="Ctrl+R,O">F6</kbd>      <br>      <code class="code">ReSharper_Move</code>    </p>      <p id="eb41f2ba">        This refactoring allows you to move an instance (non-static) method to another type.        In contrast to        <a href="Refactorings__Move__Type_to_Another_Type.html">moving static members</a>,        instance method cannot be moved to just any type.        The list of potential target types includes types of the method parameters and        types of fields in the current type.        If the method uses other class members, the refactoring will pass the source class as a parameter.        It will also change access rights of non-public members and encapsulate fields into public properties,        if necessary.        All usages of the method are updated automatically.    </p>    <p id="167befd5">        This refactoring may be helpful if you see that the logic of a method fits better into another type, which        is passed as the method parameter or a field.    </p>    <p id="59d19c06">        In the example below, we apply the refactoring to the        <code class="code">LogDrawing</code> instance method to move it to the        <code class="code">Logger</code> class.        The private        <code class="code">pivot</code> field, which is used in the method is automatically encapsulated into the corresponding        property:    </p>    <div class="table-wrapper"><table class="  _layout-fixed" width="100%" id="1ae384bc"><thead><tr id="193b7057" class="ijRowHead"><th id="b15f4451"><p>Before refactoring</p></th><th id="50ac0141"><p>After refactoring</p></th></tr></thead><tbody><tr id="d257df81" class="ijRowOdd"><td id="ea7d15bd">                <div class="code-block" data-lang="csharp">
class Shape
{
  private Point pivot;

  private void LogDrawing(Logger logger)
  {
    var msg =
      $"Shape is drawn at" +
      $" {pivot.X}, {pivot.Y}";
    logger.Log(msg);
  }
}

class Logger
{
  public void Log(string msg)
  {
    // log the message
  }
}
                </div>            </td><td id="dfb646b9">                <div class="code-block" data-lang="csharp">
class Shape
{
  private Point pivot;

  public Point Pivot
  {
    set { pivot = value; }
    get { return pivot; }
  }
}

class Logger
{
  public void Log(string msg)
  {
    // log the message
  }

  private void LogDrawing(Shape shape)
  {
    var msg =
      $"Shape is drawn at" +
      $" {shape.Pivot.X}, {shape.Pivot.Y}";
    this.Log(msg);
  }
}
                </div>            </td></tr></tbody></table></div>    <section class="procedure-steps"><h3 id="47e8fab8">To move an instance method</h3><a name="step_select_method"></a><ol class="list _decimal"><li class="list__item" id="6a126bb9"><p>            Place the caret at the declaration or a usage of an instance method in the editor,            or select it in the            <a href="Reference__Windows__File_Structure_Window.html">File Structure window</a>.        </p></li><li class="list__item" id="445f62e4">            <p id="0eb89189">                Do one of the following:            </p>            <ul class="list _ul"><li class="list__item" id="59359078"><p>                    Press                    <kbd data-rs="F6" data-vs="Ctrl+R,O">F6</kbd>.                </p></li><li class="list__item" id="b8fc8f4e"><p>                    Press                    <kbd data-rs="Ctrl+Shift+R" data-vs="Ctrl+Shift+R">Ctrl+Shift+R</kbd>                    and then choose                    <span class="control">Move Instance Method</span>                </p></li><li class="list__item" id="2560742d"><p>                    Right-click and choose                    <span class="control">Refactor | Move Instance Method</span>                    in the context menu.                </p></li><li class="list__item" id="beedd600"><p>                    Choose                    <a name="%actionId%"></a>    <span data-skip-index="skip" class="menupath">ReSharper | Refactor | Move…</span>                      in the main menu.                </p></li></ul>            <p id="faa7e830">                                    The                    <span class="control">Move Instance Method</span>                    dialog will open.                            </p>        </li><li class="list__item" id="f74cb7ee"><p>            Select the destination type.        </p></li><li class="list__item" id="e5554791"><p>            To apply the refactoring, click            <span class="control">Next</span>.        </p></li><li class="list__item" id="53537256">            <p id="7825e763">                If no conflicts are found, ReSharper performs the refactoring immediately.                Otherwise, it prompts you to                <a href="Refactorings__Resolving_Conflicts_in_Refactorings.html">resolve conflicts</a>.            </p>                    </li></ol></section>    <figure><img alt="ReSharper. Move Instance Method refactoring" title="ReSharper. Move Instance Method refactoring" src="/help/img/dotnet/2019.2/Refactorings__Move__Instance_Method_to_Another_Type.png" id="73e52e4e" width="641" height="361"></figure>    <a name="supported_in"></a>        <a name="supported_in_csharp"></a>            <p id="52919edc">                This feature is                <a href="Introduction__Feature_Map.html">supported</a>                in the following languages and technologies:            </p>            <div class="table-wrapper"><table class=" wide" width="100%" id="2241808d"><thead><tr id="b1c3930a" class="ijRowHead"><th id="f565eeb3">                                <a href="ReSharper_by_Language__CSharp.html"><img alt="Language: C#" title="Language: C#" src="/help/img/dotnet/2019.2/ThemedIcon.Csharp.Print.[Gray].png" id="e9fac304" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="ad507ffb">                                <a href="ReSharper_by_Language__Visual_Basic.html"><img alt="Language: VB.NET" title="Language: VB.NET" src="/help/img/dotnet/2019.2/ThemedIcon.Vbasic.Print.[Gray].png" id="4ed6bae2" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="50a4a3ae">                                <a href="ReSharper_by_Language_CPP.html"><img alt="Language: C++" title="Language: C++" src="/help/img/dotnet/2019.2/ThemedIcon.CppSource.Print.[SymbolsVs11Gray].png" id="0be388a5" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="346d5188">                                <a href="ReSharper_by_Language__HTML.html"><img alt="Language: HTML" title="Language: HTML" src="/help/img/dotnet/2019.2/ThemedIcon.Html.Print.[Gray].png" id="d8fde76d" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="6c7e030c">                                <a href="Web_Development__Index.html"><img alt="Language: ASP.NET" title="Language: ASP.NET" src="/help/img/dotnet/2019.2/ThemedIcon.AspNet.Print.[Gray].png" id="4dbc27a6" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="b857a396">                                <a href="Web_Development__ASP.NET_MVC.html"><img alt="Language: Razor" title="Language: Razor" src="/help/img/dotnet/2019.2/ThemedIcon.Razor.Print.[Gray].png" id="26b37fae" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="221e6391">                                <a href="ReSharper_by_Language__JavaScript.html"><img alt="Language: JavaScript" title="Language: JavaScript" src="/help/img/dotnet/2019.2/ThemedIcon.Js.Print.[Gray].png" id="cabcaec8" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="2f1f760d">                                <a href="ReSharper_by_Language__TypeScript.html"><img alt="Language: TypeScript" title="Language: TypeScript" src="/help/img/dotnet/2019.2/ThemedIcon.TsOptionPage.Print.[Gray].png" id="6b9d67c5" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="01c3db4d">                                <a href="ReSharper_by_Language__CSS.html"><img alt="Language: CSS" title="Language: CSS" src="/help/img/dotnet/2019.2/ThemedIcon.Css.Print.[Gray].png" id="653176ff" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="30fe17fd">                                <a href="ReSharper_by_Language__XML.html"><img alt="Language: XML" title="Language: XML" src="/help/img/dotnet/2019.2/ThemedIcon.XmlFile.Print.[Gray].png" id="81ad71bc" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="eeb78ad3">                                <a href="Languages_XAML.html"><img alt="Language: XAML" title="Language: XAML" src="/help/img/dotnet/2019.2/ThemedIcon.Xaml.Print.[Gray].png" id="423ac801" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="7e0c49af">                                <a href="Resources__Index.html"><img alt="Language: Resx" title="Language: Resx" src="/help/img/dotnet/2019.2/ThemedIcon.Localization.Print.[Gray].png" id="3a9e789b" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="176eaa2d">                                <a href="ReSharper_by_Language__MSBuild.html"><img alt="Language: Build Scripts" title="Language: Build Scripts" src="/help/img/dotnet/2019.2/ThemedIcon.BuildScripts.Print.[Gray].png" id="28171984" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="16e57d30">                                <a href="ReSharper_by_Language_Protobuf.html"><img alt="Language: Protobuf" title="Language: Protobuf" src="/help/img/dotnet/2019.2/ThemedIcon.ProtobufOptionPage.Print.[Gray].png" id="c12a8f70" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="fc2a96aa">                                <a href="ReSharper_by_Language_JSON.html"><img alt="Language: JSON" title="Language: JSON" src="/help/img/dotnet/2019.2/ThemedIcon.Json.Print.[Gray].png" id="80449fa7" width="25" height="25" class="inline-icon-25"></a>                            </th></tr></thead><tbody><tr id="56add8ef" class="ijRowOdd"><td id="01f8faa2">            <img alt="Feature is available" title="Feature is available" src="/help/img/dotnet/2019.2/check.svg" id="feb4f68c" width="17" height="12" class="inline-icon-17">                    </td><td id="de033263">            <img alt="Feature is available" title="Feature is available" src="/help/img/dotnet/2019.2/check.svg" id="9feee2e5" width="17" height="12" class="inline-icon-17">                    </td><td id="f5f9cee1">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="3ed4046b" width="12" height="12" class="inline-icon-12">        </td><td id="ac08f0b5">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="0abfaa4d" width="12" height="12" class="inline-icon-12">        </td><td id="13d828ae">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="1a70e6cf" width="12" height="12" class="inline-icon-12">        </td><td id="db41489e">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="aa33c136" width="12" height="12" class="inline-icon-12">        </td><td id="101c1dbf">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="145b1acc" width="12" height="12" class="inline-icon-12">        </td><td id="68913db2">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="b65b914a" width="12" height="12" class="inline-icon-12">        </td><td id="4a7db1af">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="533ee452" width="12" height="12" class="inline-icon-12">        </td><td id="7b60f009">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="c3ac5237" width="12" height="12" class="inline-icon-12">        </td><td id="8b86637a">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="ae965c25" width="12" height="12" class="inline-icon-12">        </td><td id="7c36e234">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="47aede98" width="12" height="12" class="inline-icon-12">        </td><td id="9d5fa9cb">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="8567a38d" width="12" height="12" class="inline-icon-12">        </td><td id="b8036561">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="8c8743f4" width="12" height="12" class="inline-icon-12">        </td><td id="1bde0cd5">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="42050622" width="12" height="12" class="inline-icon-12">        </td></tr></tbody></table></div>                <p id="191212ca">            The instructions and examples given here address the use of the feature in C#.            For details specific to other languages, see corresponding topics in the            <a href="ReSharper_by_Language__Index.html">ReSharper by Language</a>            section.        </p>        <div class="last-modified" data-skip-index="skip">Last modified: 18 November 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Move_Refactorings.html">Move refactorings</a><a class="navigation-links__next" href="Refactorings__Move__Type_to_Another_File.html">Move Type to Another File</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>