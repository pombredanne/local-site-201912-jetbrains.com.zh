<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-US"><head><meta charset="UTF-8"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','GTM-5P98');
                    </script><script src="//resources.jetbrains.com/storage/help-app/v3/analytics.js"></script><title>Extract Class refactoring - Help | ReSharper</title><link rel="stylesheet" href="//resources.jetbrains.com/storage/help-app/v3/app.css"></head><body data-id="Refactorings__Extract_Class" data-article-props="&#xA;                {&#xA;                &#xA;            &#34;seeAlso&#34;:[&#xA;            &#xA;                {&#34;title&#34;: &#34;Procedures&#34;,&#xA;                 &#34;links&#34;: [&#xA;                &#xA;        {&#34;url&#34;:&#34;ReSharper_by_Language__Visual_Basic__Refactorings.html&#34;,&#34;text&#34;:&#34;Refactorings for Visual Basic .NET&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Refactorings__Extract_Superclass.html&#34;,&#34;text&#34;:&#34;Extract Superclass refactoring&#34;}&#xA;    ,&#xA;        {&#34;url&#34;:&#34;Refactorings__Index.html&#34;,&#34;text&#34;:&#34;Refactorings&#34;}&#xA;    &#xA;                    ]}&#xA;            ]&#xA;        &#xA;                }&#xA;            " data-disqus-id="Refactorings__Extract_Class_10"><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P98" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="wrapper"><section class="panel _nav" data-skip-index="skip"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper Help"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"></menu></div><div class="container _footer panel__footer"><p><a href="#">Send feedback</a></p></div></nav></section><main class="panel _main"><header class="panel__header" data-skip-index="skip"><div class="container"><h3>ReSharper 2019.2 Help</h3><div class="shortcuts-switcher" data-skip-index="skip"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1"><option data-group="secondary" value="rs">ReSharper 2.x/IntelliJ IDEA</option><option data-group="primary" value="vs">Visual Studio</option></select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="active"><h1 data-toc="Refactorings__Extract_Class" id="Refactorings__Extract_Class.xml">Extract Class refactoring</h1>                        <a name="%actionId%"></a>    <p id="7c3970c2">      <span data-skip-index="skip" class="menupath">ReSharper | Refactor | Extract | Extract Class…</span>      <br>      <code class="code">ReSharper_ExtractClass</code>    </p>      <p id="97fe333d">        This refactoring allows you to extract members of an existing class to a new class.        For example, this refactoring can be helpful if you need to replace a single class that is responsible for        multiple tasks with several classes each having a single responsibility.    </p>    <p id="ef44b844">        ReSharper will automatically create a reference field that will provide access to the newly created class.        If necessary, you can also leave the extracted members in the original class as copies or so that the        implementation is delegated to the same members in the new class.    </p>    <a name="reverse"></a>        <aside data-type="tip" class="prompt" data-title="" rel="Refactorings__Extract_Class.xml" id="c2cfc7d0">            <p id="83654bf0">                The reverse functionality is available with the                <a href="Refactorings__Inline_Class.html">Inline Class refactoring</a>                refactoring.            </p>        </aside>        <p id="1d5ca3b6">        In the example below, we extract the        <code class="code">LogError</code>        method into the new        <code class="code">Logger</code>        class    </p>    <div class="table-wrapper"><table class="  _layout-fixed" width="100%" id="bdcd0894"><thead><tr id="d29dd900" class="ijRowHead"><th id="4d724e88"><p>Before refactoring</p></th><th id="22f26847"><p>After refactoring</p></th></tr></thead><tbody><tr id="1bb0f17e" class="ijRowOdd"><td id="0e3740ed">                <div class="code-block" data-lang="csharp">
abstract class Shape
{
  public void Draw()
  {
    try
    {
      // draw
    }
    catch (Exception e)
    {
      LogError(e);
    }
  }

  public static void LogError(Exception e)
  {
    File.WriteAllText(@"c:\Errors\Exception.txt",
      e.ToString());
  }
}
                </div>            </td><td id="d8ee42fe">                <div class="code-block" data-lang="csharp">
class Logger
{
  public static void LogError(Exception e)
  {
    File.WriteAllText(@"c:\Errors\Exception.txt",
      e.ToString());
  }
}

abstract class Shape
{
  public void Draw()
  {
    try
    {
      // draw
    }
    catch (Exception e)
    {
      Logger.LogError(e);
    }
  }
}
                </div>            </td></tr></tbody></table></div>    <section class="procedure-steps"><h3 id="4850117f">To extract a class</h3><a name="step_select_source_items"></a><ol class="list _decimal"><li class="list__item" id="37e61aca">            <p id="6afe5158">                Select a class in one of the following ways:            </p>            <ul class="list _ul"><li class="list__item" id="e36b68ea"><p>                    In the editor, set the caret at the name of a class.                </p></li><li class="list__item" id="9f0dae55"><p>                    Select a class                                        in the Solution Explorer.                </p></li><li class="list__item" id="8dd8c5c4"><p>                    Select                    a class                                        in the                    <a href="Reference__Windows__File_Structure_Window.html">File Structure window</a>.                </p></li><li class="list__item" id="9f8913b8"><p>                    Select                    a class                                        in the Class View.                </p></li><li class="list__item" id="65bc65d1"><p>                    Select a class in the Object Browser.                </p></li><li class="list__item" id="789cd89f"><p>                    Select                    a class                                                            in the                    <a href="Exploring_Type_Dependency_Graph.html">type dependency diagram</a>.                </p></li></ul>                                </li><li class="list__item" id="83e6d678">            <p id="1ef37ea3">                Do one of the following:            </p>            <ul class="list _ul"><li class="list__item" id="0d9a1a53"><p>                    Press                    <kbd data-rs="Ctrl+Shift+R" data-vs="Ctrl+Shift+R">Ctrl+Shift+R</kbd>                    and then choose                    <span class="control">Extract Class</span>                </p></li><li class="list__item" id="d279694e"><p>                    Right-click and choose                    <span class="control">Refactor | Extract Class</span>                    in the context menu.                </p></li><li class="list__item" id="cbff394d"><p>                    Choose                    <a name="%actionId%"></a>    <span data-skip-index="skip" class="menupath">ReSharper | Refactor | Extract | Extract Class…</span>                      in the main menu.                </p></li></ul>            <p id="a19f7784">                                    The                    <span class="control">Extract Class</span>                    dialog will open.                            </p>        </li><li class="list__item" id="step_name_place"><p>            Specify a name for the class and where it should be placed —            in a new file or in the same file as the original type.        </p></li><li class="list__item" id="85b053d4"><p>            Select members to be extracted into the class.            ReSharper suggests to extract all members that use the selected members.            You can recognize the suggested members by the green            <span class="control">Extract</span> label.            You do not have to accept this suggestion, but if you will, you can click            <span class="control">Extract all suggested members</span>            to select all of them.        </p></li><li class="list__item" id="4fe37e0e"><p>            As soon as you select a member, it gets the selector in the            <span class="control">Source class member</span> column.            If you want the member to be directly available in the current class,            click this selector and choose            <span class="control">Create delegating wrapper</span> for methods and properties or            <span class="control">Create copy</span> for properties and fields.        </p></li><li class="list__item" id="2a7eb5be"><p>            If you are extracting a non-public member, which is used by other members that you do not extract,            ReSharper warns you that these usages will not work if the extracted member is left non-public.            You can either select the dependent members by clicking            <span class="control">Extract all suggested members</span>            or click the warning icon and choose one of the suggested fixes:            <figure><img alt="ReSharper: Extract Class refactoring" title="ReSharper: Extract Class refactoring" src="/help/img/dotnet/2019.2/Extract_Class_non_public.png" id="4937fd00" width="334" height="169"></figure>        </p></li><li class="list__item" id="8e164a46"><p>            To apply the refactoring, click            <span class="control">Next</span>.        </p></li><li class="list__item" id="4832aa68">            <p id="02b603ae">                If no conflicts are found, ReSharper performs the refactoring immediately.                Otherwise, it prompts you to                <a href="Refactorings__Resolving_Conflicts_in_Refactorings.html">resolve conflicts</a>.            </p>                    </li></ol></section>    <figure><img alt="ReSharper. Extract class refactoring" title="ReSharper. Extract class refactoring" src="/help/img/dotnet/2019.2/Extract_Class_dialog.png" id="7cc998b9" width="655" height="442"></figure>    <a name="supported_in"></a>        <a name="supported_in_csharp"></a>            <p id="1f307dbb">                This feature is                <a href="Introduction__Feature_Map.html">supported</a>                in the following languages and technologies:            </p>            <div class="table-wrapper"><table class=" wide" width="100%" id="cd9aa75e"><thead><tr id="52c76d3b" class="ijRowHead"><th id="5c5311e3">                                <a href="ReSharper_by_Language__CSharp.html"><img alt="Language: C#" title="Language: C#" src="/help/img/dotnet/2019.2/ThemedIcon.Csharp.Print.[Gray].png" id="f5e78472" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="ede088a6">                                <a href="ReSharper_by_Language__Visual_Basic.html"><img alt="Language: VB.NET" title="Language: VB.NET" src="/help/img/dotnet/2019.2/ThemedIcon.Vbasic.Print.[Gray].png" id="cdbc52d4" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="40f22383">                                <a href="ReSharper_by_Language_CPP.html"><img alt="Language: C++" title="Language: C++" src="/help/img/dotnet/2019.2/ThemedIcon.CppSource.Print.[SymbolsVs11Gray].png" id="a168647f" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="50bb07dd">                                <a href="ReSharper_by_Language__HTML.html"><img alt="Language: HTML" title="Language: HTML" src="/help/img/dotnet/2019.2/ThemedIcon.Html.Print.[Gray].png" id="2ba8a501" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="5532c738">                                <a href="Web_Development__Index.html"><img alt="Language: ASP.NET" title="Language: ASP.NET" src="/help/img/dotnet/2019.2/ThemedIcon.AspNet.Print.[Gray].png" id="e3693f7d" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="4be79f64">                                <a href="Web_Development__ASP.NET_MVC.html"><img alt="Language: Razor" title="Language: Razor" src="/help/img/dotnet/2019.2/ThemedIcon.Razor.Print.[Gray].png" id="ef6b3a84" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="e38d0ab2">                                <a href="ReSharper_by_Language__JavaScript.html"><img alt="Language: JavaScript" title="Language: JavaScript" src="/help/img/dotnet/2019.2/ThemedIcon.Js.Print.[Gray].png" id="12acec3e" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="af8ce2dd">                                <a href="ReSharper_by_Language__TypeScript.html"><img alt="Language: TypeScript" title="Language: TypeScript" src="/help/img/dotnet/2019.2/ThemedIcon.TsOptionPage.Print.[Gray].png" id="de2ae997" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="f5a1f99d">                                <a href="ReSharper_by_Language__CSS.html"><img alt="Language: CSS" title="Language: CSS" src="/help/img/dotnet/2019.2/ThemedIcon.Css.Print.[Gray].png" id="6c592489" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="d13748b5">                                <a href="ReSharper_by_Language__XML.html"><img alt="Language: XML" title="Language: XML" src="/help/img/dotnet/2019.2/ThemedIcon.XmlFile.Print.[Gray].png" id="c2e36f2c" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="6d5a06c9">                                <a href="Languages_XAML.html"><img alt="Language: XAML" title="Language: XAML" src="/help/img/dotnet/2019.2/ThemedIcon.Xaml.Print.[Gray].png" id="3e0f223a" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="a8f96fb1">                                <a href="Resources__Index.html"><img alt="Language: Resx" title="Language: Resx" src="/help/img/dotnet/2019.2/ThemedIcon.Localization.Print.[Gray].png" id="7e7ba058" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="514eebb6">                                <a href="ReSharper_by_Language__MSBuild.html"><img alt="Language: Build Scripts" title="Language: Build Scripts" src="/help/img/dotnet/2019.2/ThemedIcon.BuildScripts.Print.[Gray].png" id="d6ced2e0" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="983ec48c">                                <a href="ReSharper_by_Language_Protobuf.html"><img alt="Language: Protobuf" title="Language: Protobuf" src="/help/img/dotnet/2019.2/ThemedIcon.ProtobufOptionPage.Print.[Gray].png" id="5ebe7f1b" width="25" height="25" class="inline-icon-25"></a>                            </th><th id="725bc33d">                                <a href="ReSharper_by_Language_JSON.html"><img alt="Language: JSON" title="Language: JSON" src="/help/img/dotnet/2019.2/ThemedIcon.Json.Print.[Gray].png" id="78549e05" width="25" height="25" class="inline-icon-25"></a>                            </th></tr></thead><tbody><tr id="bd5869df" class="ijRowOdd"><td id="2b0b1413">            <img alt="Feature is available" title="Feature is available" src="/help/img/dotnet/2019.2/check.svg" id="eeba9e0b" width="17" height="12" class="inline-icon-17">                    </td><td id="70e969c7">            <img alt="Feature is available" title="Feature is available" src="/help/img/dotnet/2019.2/check.svg" id="cd42a89e" width="17" height="12" class="inline-icon-17">                    </td><td id="a41bedb7">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="3d8b9d42" width="12" height="12" class="inline-icon-12">        </td><td id="9871e6cd">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="7657c5c0" width="12" height="12" class="inline-icon-12">        </td><td id="15929ace">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="9aa41b87" width="12" height="12" class="inline-icon-12">        </td><td id="a5c65794">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="56d07a83" width="12" height="12" class="inline-icon-12">        </td><td id="43415358">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="64c15922" width="12" height="12" class="inline-icon-12">        </td><td id="8f4aa07b">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="ebc4a271" width="12" height="12" class="inline-icon-12">        </td><td id="e5246718">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="9f86eae1" width="12" height="12" class="inline-icon-12">        </td><td id="09b03ab7">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="67fdcb72" width="12" height="12" class="inline-icon-12">        </td><td id="1f3c03ce">            <img alt="Feature is available" title="Feature is available" src="/help/img/dotnet/2019.2/check.svg" id="0d8b3663" width="17" height="12" class="inline-icon-17">                    </td><td id="d6902d72">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="424c4aca" width="12" height="12" class="inline-icon-12">        </td><td id="75988ee7">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="857e5184" width="12" height="12" class="inline-icon-12">        </td><td id="45f167fa">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="599b2ded" width="12" height="12" class="inline-icon-12">        </td><td id="3196dc97">                        <img alt="Feature is not available" title="Feature is not available" src="/help/img/dotnet/2019.2/cross.svg" id="b4dd14c4" width="12" height="12" class="inline-icon-12">        </td></tr></tbody></table></div>                <p id="0d825a69">            The instructions and examples given here address the use of the feature in C#.            For details specific to other languages, see corresponding topics in the            <a href="ReSharper_by_Language__Index.html">ReSharper by Language</a>            section.        </p>        <div class="last-modified" data-skip-index="skip">Last modified: 18 November 2019 </div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom" data-skip-index="skip"><a class="navigation-links__prev" href="Refactorings__Encapsulate_Field.html">Encapsulate Field</a><a class="navigation-links__next" href="Refactorings__Extract_Interface.html">Extract Interface</a></div></article><div id="disqus_thread" data-skip-index="skip"></div></div></section></main></div><script src="//resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>